/*! For license information please see 0.4fcd9331646d87b188d9.js.LICENSE.txt */
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[0],{"1dm5":function(e,t,r){(function(t){var r;var r;(function(t){if(true){e.exports=t()}else{var r}})((function(){var e,a,n;return function(){function e(t,a,n){function i(s,l){if(!a[s]){if(!t[s]){var u="function"==typeof r&&r;if(!l&&u)return r(s,!0);if(o)return o(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var f=a[s]={exports:{}};t[s][0].call(f.exports,(function(e){var r=t[s][1][e];return i(r||e)}),f,f.exports,e,t,a,n)}return a[s].exports}for(var o="function"==typeof r&&r,s=0;s<n.length;s++)i(n[s]);return i}return e}()({1:[function(e,t,r){"use strict";var a=e("../src/lib");var n={"X,X div":'direction:ltr;font-family:"Open Sans",verdana,arial,sans-serif;margin:0;padding:0;',"X input,X button":'font-family:"Open Sans",verdana,arial,sans-serif;',"X input:focus,X button:focus":"outline:none;","X a":"text-decoration:none;","X a:hover":"text-decoration:none;","X .crisp":"shape-rendering:crispEdges;","X .user-select-none":"-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;-o-user-select:none;user-select:none;","X svg":"overflow:hidden;","X svg a":"fill:#447adb;","X svg a:hover":"fill:#3c6dc5;","X .main-svg":"position:absolute;top:0;left:0;pointer-events:none;","X .main-svg .draglayer":"pointer-events:all;","X .cursor-default":"cursor:default;","X .cursor-pointer":"cursor:pointer;","X .cursor-crosshair":"cursor:crosshair;","X .cursor-move":"cursor:move;","X .cursor-col-resize":"cursor:col-resize;","X .cursor-row-resize":"cursor:row-resize;","X .cursor-ns-resize":"cursor:ns-resize;","X .cursor-ew-resize":"cursor:ew-resize;","X .cursor-sw-resize":"cursor:sw-resize;","X .cursor-s-resize":"cursor:s-resize;","X .cursor-se-resize":"cursor:se-resize;","X .cursor-w-resize":"cursor:w-resize;","X .cursor-e-resize":"cursor:e-resize;","X .cursor-nw-resize":"cursor:nw-resize;","X .cursor-n-resize":"cursor:n-resize;","X .cursor-ne-resize":"cursor:ne-resize;","X .cursor-grab":"cursor:-webkit-grab;cursor:grab;","X .modebar":"position:absolute;top:2px;right:2px;","X .ease-bg":"-webkit-transition:background-color .3s ease 0s;-moz-transition:background-color .3s ease 0s;-ms-transition:background-color .3s ease 0s;-o-transition:background-color .3s ease 0s;transition:background-color .3s ease 0s;","X .modebar--hover>:not(.watermark)":"opacity:0;-webkit-transition:opacity .3s ease 0s;-moz-transition:opacity .3s ease 0s;-ms-transition:opacity .3s ease 0s;-o-transition:opacity .3s ease 0s;transition:opacity .3s ease 0s;","X:hover .modebar--hover .modebar-group":"opacity:1;","X .modebar-group":"float:left;display:inline-block;box-sizing:border-box;padding-left:8px;position:relative;vertical-align:middle;white-space:nowrap;","X .modebar-btn":"position:relative;font-size:16px;padding:3px 4px;height:22px;cursor:pointer;line-height:normal;box-sizing:border-box;","X .modebar-btn svg":"position:relative;top:2px;","X .modebar.vertical":"display:flex;flex-direction:column;flex-wrap:wrap;align-content:flex-end;max-height:100%;","X .modebar.vertical svg":"top:-1px;","X .modebar.vertical .modebar-group":"display:block;float:none;padding-left:0px;padding-bottom:8px;","X .modebar.vertical .modebar-group .modebar-btn":"display:block;text-align:center;","X [data-title]:before,X [data-title]:after":"position:absolute;-webkit-transform:translate3d(0, 0, 0);-moz-transform:translate3d(0, 0, 0);-ms-transform:translate3d(0, 0, 0);-o-transform:translate3d(0, 0, 0);transform:translate3d(0, 0, 0);display:none;opacity:0;z-index:1001;pointer-events:none;top:110%;right:50%;","X [data-title]:hover:before,X [data-title]:hover:after":"display:block;opacity:1;","X [data-title]:before":'content:"";position:absolute;background:transparent;border:6px solid transparent;z-index:1002;margin-top:-12px;border-bottom-color:#69738a;margin-right:-6px;',"X [data-title]:after":"content:attr(data-title);background:#69738a;color:#fff;padding:8px 10px;font-size:12px;line-height:12px;white-space:nowrap;margin-right:-18px;border-radius:2px;","X .vertical [data-title]:before,X .vertical [data-title]:after":"top:0%;right:200%;","X .vertical [data-title]:before":"border:6px solid transparent;border-left-color:#69738a;margin-top:8px;margin-right:-30px;","X .select-outline":"fill:none;stroke-width:1;shape-rendering:crispEdges;","X .select-outline-1":"stroke:#fff;","X .select-outline-2":"stroke:#000;stroke-dasharray:2px 2px;",Y:'font-family:"Open Sans",verdana,arial,sans-serif;position:fixed;top:50px;right:20px;z-index:10000;font-size:10pt;max-width:180px;',"Y p":"margin:0;","Y .notifier-note":"min-width:180px;max-width:250px;border:1px solid #fff;z-index:3000;margin:0;background-color:#8c97af;background-color:rgba(140,151,175,.9);color:#fff;padding:10px;overflow-wrap:break-word;word-wrap:break-word;-ms-hyphens:auto;-webkit-hyphens:auto;hyphens:auto;","Y .notifier-close":"color:#fff;opacity:.8;float:right;padding:0 5px;background:none;border:none;font-size:20px;font-weight:bold;line-height:20px;","Y .notifier-close:hover":"color:#444;text-decoration:none;cursor:pointer;"};for(var i in n){var o=i.replace(/^,/," ,").replace(/X/g,".js-plotly-plot .plotly").replace(/Y/g,".plotly-notifier");a.addStyleRule(o,n[i])}},{"../src/lib":787}],2:[function(e,t,r){"use strict";t.exports=e("../src/transforms/aggregate")},{"../src/transforms/aggregate":1383}],3:[function(e,t,r){"use strict";t.exports=e("../src/traces/bar")},{"../src/traces/bar":933}],4:[function(e,t,r){"use strict";t.exports=e("../src/traces/barpolar")},{"../src/traces/barpolar":946}],5:[function(e,t,r){"use strict";t.exports=e("../src/traces/box")},{"../src/traces/box":956}],6:[function(e,t,r){"use strict";t.exports=e("../src/components/calendars")},{"../src/components/calendars":648}],7:[function(e,t,r){"use strict";t.exports=e("../src/traces/candlestick")},{"../src/traces/candlestick":965}],8:[function(e,t,r){"use strict";t.exports=e("../src/traces/carpet")},{"../src/traces/carpet":984}],9:[function(e,t,r){"use strict";t.exports=e("../src/traces/choropleth")},{"../src/traces/choropleth":998}],10:[function(e,t,r){"use strict";t.exports=e("../src/traces/choroplethmapbox")},{"../src/traces/choroplethmapbox":1005}],11:[function(e,t,r){"use strict";t.exports=e("../src/traces/cone")},{"../src/traces/cone":1011}],12:[function(e,t,r){"use strict";t.exports=e("../src/traces/contour")},{"../src/traces/contour":1026}],13:[function(e,t,r){"use strict";t.exports=e("../src/traces/contourcarpet")},{"../src/traces/contourcarpet":1037}],14:[function(e,t,r){"use strict";t.exports=e("../src/core")},{"../src/core":765}],15:[function(e,t,r){"use strict";t.exports=e("../src/traces/densitymapbox")},{"../src/traces/densitymapbox":1045}],16:[function(e,t,r){"use strict";t.exports=e("../src/transforms/filter")},{"../src/transforms/filter":1384}],17:[function(e,t,r){"use strict";t.exports=e("../src/traces/funnel")},{"../src/traces/funnel":1055}],18:[function(e,t,r){"use strict";t.exports=e("../src/traces/funnelarea")},{"../src/traces/funnelarea":1064}],19:[function(e,t,r){"use strict";t.exports=e("../src/transforms/groupby")},{"../src/transforms/groupby":1385}],20:[function(e,t,r){"use strict";t.exports=e("../src/traces/heatmap")},{"../src/traces/heatmap":1077}],21:[function(e,t,r){"use strict";t.exports=e("../src/traces/heatmapgl")},{"../src/traces/heatmapgl":1087}],22:[function(e,t,r){"use strict";t.exports=e("../src/traces/histogram")},{"../src/traces/histogram":1099}],23:[function(e,t,r){"use strict";t.exports=e("../src/traces/histogram2d")},{"../src/traces/histogram2d":1105}],24:[function(e,t,r){"use strict";t.exports=e("../src/traces/histogram2dcontour")},{"../src/traces/histogram2dcontour":1109}],25:[function(e,t,r){"use strict";t.exports=e("../src/traces/icicle")},{"../src/traces/icicle":1115}],26:[function(e,t,r){"use strict";t.exports=e("../src/traces/image")},{"../src/traces/image":1128}],27:[function(e,t,r){"use strict";var a=e("./core");a.register([e("./bar"),e("./box"),e("./heatmap"),e("./histogram"),e("./histogram2d"),e("./histogram2dcontour"),e("./contour"),e("./scatterternary"),e("./violin"),e("./funnel"),e("./waterfall"),e("./image"),e("./pie"),e("./sunburst"),e("./treemap"),e("./icicle"),e("./funnelarea"),e("./scatter3d"),e("./surface"),e("./isosurface"),e("./volume"),e("./mesh3d"),e("./cone"),e("./streamtube"),e("./scattergeo"),e("./choropleth"),e("./scattergl"),e("./splom"),e("./pointcloud"),e("./heatmapgl"),e("./parcoords"),e("./parcats"),e("./scattermapbox"),e("./choroplethmapbox"),e("./densitymapbox"),e("./sankey"),e("./indicator"),e("./table"),e("./carpet"),e("./scattercarpet"),e("./contourcarpet"),e("./ohlc"),e("./candlestick"),e("./scatterpolar"),e("./scatterpolargl"),e("./barpolar"),e("./aggregate"),e("./filter"),e("./groupby"),e("./sort"),e("./calendars")]);t.exports=a},{"./aggregate":2,"./bar":3,"./barpolar":4,"./box":5,"./calendars":6,"./candlestick":7,"./carpet":8,"./choropleth":9,"./choroplethmapbox":10,"./cone":11,"./contour":12,"./contourcarpet":13,"./core":14,"./densitymapbox":15,"./filter":16,"./funnel":17,"./funnelarea":18,"./groupby":19,"./heatmap":20,"./heatmapgl":21,"./histogram":22,"./histogram2d":23,"./histogram2dcontour":24,"./icicle":25,"./image":26,"./indicator":28,"./isosurface":29,"./mesh3d":30,"./ohlc":31,"./parcats":32,"./parcoords":33,"./pie":34,"./pointcloud":35,"./sankey":36,"./scatter3d":37,"./scattercarpet":38,"./scattergeo":39,"./scattergl":40,"./scattermapbox":41,"./scatterpolar":42,"./scatterpolargl":43,"./scatterternary":44,"./sort":45,"./splom":46,"./streamtube":47,"./sunburst":48,"./surface":49,"./table":50,"./treemap":51,"./violin":52,"./volume":53,"./waterfall":54}],28:[function(e,t,r){"use strict";t.exports=e("../src/traces/indicator")},{"../src/traces/indicator":1136}],29:[function(e,t,r){"use strict";t.exports=e("../src/traces/isosurface")},{"../src/traces/isosurface":1142}],30:[function(e,t,r){"use strict";t.exports=e("../src/traces/mesh3d")},{"../src/traces/mesh3d":1147}],31:[function(e,t,r){"use strict";t.exports=e("../src/traces/ohlc")},{"../src/traces/ohlc":1152}],32:[function(e,t,r){"use strict";t.exports=e("../src/traces/parcats")},{"../src/traces/parcats":1161}],33:[function(e,t,r){"use strict";t.exports=e("../src/traces/parcoords")},{"../src/traces/parcoords":1171}],34:[function(e,t,r){"use strict";t.exports=e("../src/traces/pie")},{"../src/traces/pie":1182}],35:[function(e,t,r){"use strict";t.exports=e("../src/traces/pointcloud")},{"../src/traces/pointcloud":1191}],36:[function(e,t,r){"use strict";t.exports=e("../src/traces/sankey")},{"../src/traces/sankey":1197}],37:[function(e,t,r){"use strict";t.exports=e("../src/traces/scatter3d")},{"../src/traces/scatter3d":1235}],38:[function(e,t,r){"use strict";t.exports=e("../src/traces/scattercarpet")},{"../src/traces/scattercarpet":1242}],39:[function(e,t,r){"use strict";t.exports=e("../src/traces/scattergeo")},{"../src/traces/scattergeo":1250}],40:[function(e,t,r){"use strict";t.exports=e("../src/traces/scattergl")},{"../src/traces/scattergl":1263}],41:[function(e,t,r){"use strict";t.exports=e("../src/traces/scattermapbox")},{"../src/traces/scattermapbox":1273}],42:[function(e,t,r){"use strict";t.exports=e("../src/traces/scatterpolar")},{"../src/traces/scatterpolar":1281}],43:[function(e,t,r){"use strict";t.exports=e("../src/traces/scatterpolargl")},{"../src/traces/scatterpolargl":1288}],44:[function(e,t,r){"use strict";t.exports=e("../src/traces/scatterternary")},{"../src/traces/scatterternary":1296}],45:[function(e,t,r){"use strict";t.exports=e("../src/transforms/sort")},{"../src/transforms/sort":1387}],46:[function(e,t,r){"use strict";t.exports=e("../src/traces/splom")},{"../src/traces/splom":1305}],47:[function(e,t,r){"use strict";t.exports=e("../src/traces/streamtube")},{"../src/traces/streamtube":1313}],48:[function(e,t,r){"use strict";t.exports=e("../src/traces/sunburst")},{"../src/traces/sunburst":1321}],49:[function(e,t,r){"use strict";t.exports=e("../src/traces/surface")},{"../src/traces/surface":1330}],50:[function(e,t,r){"use strict";t.exports=e("../src/traces/table")},{"../src/traces/table":1338}],51:[function(e,t,r){"use strict";t.exports=e("../src/traces/treemap")},{"../src/traces/treemap":1349}],52:[function(e,t,r){"use strict";t.exports=e("../src/traces/violin")},{"../src/traces/violin":1362}],53:[function(e,t,r){"use strict";t.exports=e("../src/traces/volume")},{"../src/traces/volume":1370}],54:[function(e,t,r){"use strict";t.exports=e("../src/traces/waterfall")},{"../src/traces/waterfall":1378}],55:[function(e,t,r){"use strict";t.exports=l;var a=e("turntable-camera-controller");var n=e("orbit-camera-controller");var i=e("matrix-camera-controller");function o(e,t){this._controllerNames=Object.keys(e);this._controllerList=this._controllerNames.map((function(t){return e[t]}));this._mode=t;this._active=e[t];if(!this._active){this._mode="turntable";this._active=e.turntable}this.modes=this._controllerNames;this.computedMatrix=this._active.computedMatrix;this.computedEye=this._active.computedEye;this.computedUp=this._active.computedUp;this.computedCenter=this._active.computedCenter;this.computedRadius=this._active.computedRadius}var s=o.prototype;s.flush=function(e){var t=this._controllerList;for(var r=0;r<t.length;++r){t[r].flush(e)}};s.idle=function(e){var t=this._controllerList;for(var r=0;r<t.length;++r){t[r].idle(e)}};s.lookAt=function(e,t,r,a){var n=this._controllerList;for(var i=0;i<n.length;++i){n[i].lookAt(e,t,r,a)}};s.rotate=function(e,t,r,a){var n=this._controllerList;for(var i=0;i<n.length;++i){n[i].rotate(e,t,r,a)}};s.pan=function(e,t,r,a){var n=this._controllerList;for(var i=0;i<n.length;++i){n[i].pan(e,t,r,a)}};s.translate=function(e,t,r,a){var n=this._controllerList;for(var i=0;i<n.length;++i){n[i].translate(e,t,r,a)}};s.setMatrix=function(e,t){var r=this._controllerList;for(var a=0;a<r.length;++a){r[a].setMatrix(e,t)}};s.setDistanceLimits=function(e,t){var r=this._controllerList;for(var a=0;a<r.length;++a){r[a].setDistanceLimits(e,t)}};s.setDistance=function(e,t){var r=this._controllerList;for(var a=0;a<r.length;++a){r[a].setDistance(e,t)}};s.recalcMatrix=function(e){this._active.recalcMatrix(e)};s.getDistance=function(e){return this._active.getDistance(e)};s.getDistanceLimits=function(e){return this._active.getDistanceLimits(e)};s.lastT=function(){return this._active.lastT()};s.setMode=function(e){if(e===this._mode){return}var t=this._controllerNames.indexOf(e);if(t<0){return}var r=this._active;var a=this._controllerList[t];var n=Math.max(r.lastT(),a.lastT());r.recalcMatrix(n);a.setMatrix(n,r.computedMatrix);this._active=a;this._mode=e;this.computedMatrix=this._active.computedMatrix;this.computedEye=this._active.computedEye;this.computedUp=this._active.computedUp;this.computedCenter=this._active.computedCenter;this.computedRadius=this._active.computedRadius};s.getMode=function(){return this._mode};function l(e){e=e||{};var t=e.eye||[0,0,1];var r=e.center||[0,0,0];var s=e.up||[0,1,0];var l=e.distanceLimits||[0,Infinity];var u=e.mode||"turntable";var c=a();var f=n();var h=i();c.setDistanceLimits(l[0],l[1]);c.lookAt(0,t,r,s);f.setDistanceLimits(l[0],l[1]);f.lookAt(0,t,r,s);h.setDistanceLimits(l[0],l[1]);h.lookAt(0,t,r,s);return new o({turntable:c,orbit:f,matrix:h},u)}},{"matrix-camera-controller":457,"orbit-camera-controller":478,"turntable-camera-controller":587}],56:[function(t,r,a){(function(n,i){typeof a==="object"&&typeof r!=="undefined"?i(a,t("d3-array"),t("d3-collection"),t("d3-shape"),t("elementary-circuits-directed-graph")):typeof e==="function"&&e.amd?e(["exports","d3-array","d3-collection","d3-shape","elementary-circuits-directed-graph"],i):i(n.d3=n.d3||{},n.d3,n.d3,n.d3,null)})(this,(function(e,t,r,a,n){"use strict";n=n&&n.hasOwnProperty("default")?n["default"]:n;function i(e){return e.target.depth}function o(e){return e.depth}function s(e,t){return t-1-e.height}function l(e,t){return e.sourceLinks.length?e.depth:t-1}function u(e){return e.targetLinks.length?e.depth:e.sourceLinks.length?t.min(e.sourceLinks,i)-1:0}function c(e){return function(){return e}}var f=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function h(e,t){return v(e.source,t.source)||e.index-t.index}function p(e,t){return v(e.target,t.target)||e.index-t.index}function v(e,t){if(e.partOfCycle===t.partOfCycle){return e.y0-t.y0}else{if(e.circularLinkType==="top"||t.circularLinkType==="bottom"){return-1}else{return 1}}}function d(e){return e.value}function m(e){return(e.y0+e.y1)/2}function g(e){return m(e.source)}function y(e){return m(e.target)}function x(e){return e.index}function b(e){return e.nodes}function _(e){return e.links}function w(e,t){var r=e.get(t);if(!r)throw new Error("missing: "+t);return r}function T(e,t){return t(e)}var k=25;var M=10;var A=.3;function S(){var e=0,a=0,n=1,i=1,o=24,s,u=x,T=l,S=b,C=_,I=32,O=2,z,R=null;function F(){var e={nodes:S.apply(null,arguments),links:C.apply(null,arguments)};B(e);E(e,u,R);N(e);V(e);L(e,u);H(e,I,u);q(e);var t=4;for(var r=0;r<t;r++){Z(e,i,u);J(e,i,u);Y(e,a,i,u);Z(e,i,u);J(e,i,u)}ee(e,a,i);D(e,O,i,u);return e}F.nodeId=function(e){return arguments.length?(u=typeof e==="function"?e:c(e),F):u};F.nodeAlign=function(e){return arguments.length?(T=typeof e==="function"?e:c(e),F):T};F.nodeWidth=function(e){return arguments.length?(o=+e,F):o};F.nodePadding=function(e){return arguments.length?(s=+e,F):s};F.nodes=function(e){return arguments.length?(S=typeof e==="function"?e:c(e),F):S};F.links=function(e){return arguments.length?(C=typeof e==="function"?e:c(e),F):C};F.size=function(t){return arguments.length?(e=a=0,n=+t[0],i=+t[1],F):[n-e,i-a]};F.extent=function(t){return arguments.length?(e=+t[0][0],n=+t[1][0],a=+t[0][1],i=+t[1][1],F):[[e,a],[n,i]]};F.iterations=function(e){return arguments.length?(I=+e,F):I};F.circularLinkGap=function(e){return arguments.length?(O=+e,F):O};F.nodePaddingRatio=function(e){return arguments.length?(z=+e,F):z};F.sortNodes=function(e){return arguments.length?(R=e,F):R};F.update=function(e){L(e,u);q(e);e.links.forEach((function(e){if(e.circular){e.circularLinkType=e.y0+e.y1<i?"top":"bottom";e.source.circularLinkType=e.circularLinkType;e.target.circularLinkType=e.circularLinkType}}));Z(e,i,u,false);J(e,i,u);D(e,O,i,u);return e};function B(e){e.nodes.forEach((function(e,t){e.index=t;e.sourceLinks=[];e.targetLinks=[]}));var t=r.map(e.nodes,u);e.links.forEach((function(e,r){e.index=r;var a=e.source;var n=e.target;if((typeof a==="undefined"?"undefined":f(a))!=="object"){a=e.source=w(t,a)}if((typeof n==="undefined"?"undefined":f(n))!=="object"){n=e.target=w(t,n)}a.sourceLinks.push(e);n.targetLinks.push(e)}));return e}function N(e){e.nodes.forEach((function(e){e.partOfCycle=false;e.value=Math.max(t.sum(e.sourceLinks,d),t.sum(e.targetLinks,d));e.sourceLinks.forEach((function(t){if(t.circular){e.partOfCycle=true;e.circularLinkType=t.circularLinkType}}));e.targetLinks.forEach((function(t){if(t.circular){e.partOfCycle=true;e.circularLinkType=t.circularLinkType}}))}))}function j(e){var r=0,a=0,n=0,i=0;var o=t.max(e.nodes,(function(e){return e.column}));e.links.forEach((function(e){if(e.circular){if(e.circularLinkType=="top"){r=r+e.width}else{a=a+e.width}if(e.target.column==0){i=i+e.width}if(e.source.column==o){n=n+e.width}}}));r=r>0?r+k+M:r;a=a>0?a+k+M:a;n=n>0?n+k+M:n;i=i>0?i+k+M:i;return{top:r,bottom:a,left:i,right:n}}function U(r,s){var l=t.max(r.nodes,(function(e){return e.column}));var u=n-e;var c=i-a;var f=u+s.right+s.left;var h=c+s.top+s.bottom;var p=u/f;var v=c/h;e=e*p+s.left;n=s.right==0?n:n*p;a=a*v+s.top;i=i*v;r.nodes.forEach((function(t){t.x0=e+t.column*((n-e-o)/l);t.x1=t.x0+o}));return v}function V(e){var t,r,a;for(t=e.nodes,r=[],a=0;t.length;++a,t=r,r=[]){t.forEach((function(e){e.depth=a;e.sourceLinks.forEach((function(e){if(r.indexOf(e.target)<0&&!e.circular){r.push(e.target)}}))}))}for(t=e.nodes,r=[],a=0;t.length;++a,t=r,r=[]){t.forEach((function(e){e.height=a;e.targetLinks.forEach((function(e){if(r.indexOf(e.source)<0&&!e.circular){r.push(e.source)}}))}))}e.nodes.forEach((function(e){e.column=Math.floor(T.call(null,e,a))}))}function H(e,n,o){var l=r.nest().key((function(e){return e.column})).sortKeys(t.ascending).entries(e.nodes).map((function(e){return e.values}));f(o);p();for(var u=1,c=n;c>0;--c){h(u*=.99,o);p()}function f(r){if(z){var n=Infinity;l.forEach((function(e){var t=i*z/(e.length+1);n=t<n?t:n}));s=n}var o=t.min(l,(function(e){return(i-a-(e.length-1)*s)/t.sum(e,d)}));o=o*A;e.links.forEach((function(e){e.width=e.value*o}));var u=j(e);var c=U(e,u);o=o*c;e.links.forEach((function(e){e.width=e.value*o}));l.forEach((function(e){var t=e.length;e.forEach((function(e,n){if(e.depth==l.length-1&&t==1){e.y0=i/2-e.value*o;e.y1=e.y0+e.value*o}else if(e.depth==0&&t==1){e.y0=i/2-e.value*o;e.y1=e.y0+e.value*o}else if(e.partOfCycle){if(P(e,r)==0){e.y0=i/2+n;e.y1=e.y0+e.value*o}else if(e.circularLinkType=="top"){e.y0=a+n;e.y1=e.y0+e.value*o}else{e.y0=i-e.value*o-n;e.y1=e.y0+e.value*o}}else{if(u.top==0||u.bottom==0){e.y0=(i-a)/t*n;e.y1=e.y0+e.value*o}else{e.y0=(i-a)/2-t/2+n;e.y1=e.y0+e.value*o}}}))}))}function h(e,r){var a=l.length;l.forEach((function(n){var o=n.length;var s=n[0].depth;n.forEach((function(n){var l;if(n.sourceLinks.length||n.targetLinks.length){if(n.partOfCycle&&P(n,r)>0);else if(s==0&&o==1){l=n.y1-n.y0;n.y0=i/2-l/2;n.y1=i/2+l/2}else if(s==a-1&&o==1){l=n.y1-n.y0;n.y0=i/2-l/2;n.y1=i/2+l/2}else{var u=0;var c=t.mean(n.sourceLinks,y);var f=t.mean(n.targetLinks,g);if(c&&f){u=(c+f)/2}else{u=c||f}var h=(u-m(n))*e;n.y0+=h;n.y1+=h}}}))}))}function p(){l.forEach((function(e){var t,r,n=a,o=e.length,l;e.sort(v);for(l=0;l<o;++l){t=e[l];r=n-t.y0;if(r>0){t.y0+=r;t.y1+=r}n=t.y1+s}r=n-s-i;if(r>0){n=t.y0-=r,t.y1-=r;for(l=o-2;l>=0;--l){t=e[l];r=t.y1+s-n;if(r>0)t.y0-=r,t.y1-=r;n=t.y0}}}))}}function q(e){e.nodes.forEach((function(e){e.sourceLinks.sort(p);e.targetLinks.sort(h)}));e.nodes.forEach((function(e){var t=e.y0;var r=t;var a=e.y1;var n=a;e.sourceLinks.forEach((function(e){if(e.circular){e.y0=a-e.width/2;a=a-e.width}else{e.y0=t+e.width/2;t+=e.width}}));e.targetLinks.forEach((function(e){if(e.circular){e.y1=n-e.width/2;n=n-e.width}else{e.y1=r+e.width/2;r+=e.width}}))}))}return F}function E(e,t,r){var a=0;if(r===null){var i=[];for(var o=0;o<e.links.length;o++){var s=e.links[o];var l=s.source.index;var u=s.target.index;if(!i[l])i[l]=[];if(!i[u])i[u]=[];if(i[l].indexOf(u)===-1)i[l].push(u)}var c=n(i);c.sort((function(e,t){return e.length-t.length}));var f={};for(o=0;o<c.length;o++){var h=c[o];var p=h.slice(-2);if(!f[p[0]])f[p[0]]={};f[p[0]][p[1]]=true}e.links.forEach((function(e){var t=e.target.index;var r=e.source.index;if(t===r||f[r]&&f[r][t]){e.circular=true;e.circularLinkID=a;a=a+1}else{e.circular=false}}))}else{e.links.forEach((function(e){if(e.source[r]<e.target[r]){e.circular=false}else{e.circular=true;e.circularLinkID=a;a=a+1}}))}}function L(e,t){var r=0;var a=0;e.links.forEach((function(n){if(n.circular){if(n.source.circularLinkType||n.target.circularLinkType){n.circularLinkType=n.source.circularLinkType?n.source.circularLinkType:n.target.circularLinkType}else{n.circularLinkType=r<a?"top":"bottom"}if(n.circularLinkType=="top"){r=r+1}else{a=a+1}e.nodes.forEach((function(e){if(T(e,t)==T(n.source,t)||T(e,t)==T(n.target,t)){e.circularLinkType=n.circularLinkType}}))}}));e.links.forEach((function(e){if(e.circular){if(e.source.circularLinkType==e.target.circularLinkType){e.circularLinkType=e.source.circularLinkType}if($(e,t)){e.circularLinkType=e.source.circularLinkType}}}))}function C(e){var t=Math.abs(e.y1-e.y0);var r=Math.abs(e.target.x0-e.source.x1);return Math.atan(r/t)}function I(e,t){if(e.source.column<t.target.column){return false}else if(e.target.column>t.source.column){return false}else{return true}}function P(e,t){var r=0;e.sourceLinks.forEach((function(e){r=e.circular&&!$(e,t)?r+1:r}));var a=0;e.targetLinks.forEach((function(e){a=e.circular&&!$(e,t)?a+1:a}));return r+a}function O(e){var t=e.source.sourceLinks;var r=0;t.forEach((function(e){r=e.circular?r+1:r}));var a=e.target.targetLinks;var n=0;a.forEach((function(e){n=e.circular?n+1:n}));if(r>1||n>1){return false}else{return true}}function z(e,t,r){e.sort(F);e.forEach((function(a,n){var i=0;if($(a,r)&&O(a)){a.circularPathData.verticalBuffer=i+a.width/2}else{var o=0;for(o;o<n;o++){if(I(e[n],e[o])){var s=e[o].circularPathData.verticalBuffer+e[o].width/2+t;i=s>i?s:i}}a.circularPathData.verticalBuffer=i+a.width/2}}));return e}function D(e,r,n,i){var o=5;var s=t.min(e.links,(function(e){return e.source.y0}));e.links.forEach((function(e){if(e.circular){e.circularPathData={}}}));var l=e.links.filter((function(e){return e.circularLinkType=="top"}));z(l,r,i);var u=e.links.filter((function(e){return e.circularLinkType=="bottom"}));z(u,r,i);e.links.forEach((function(t){if(t.circular){t.circularPathData.arcRadius=t.width+M;t.circularPathData.leftNodeBuffer=o;t.circularPathData.rightNodeBuffer=o;t.circularPathData.sourceWidth=t.source.x1-t.source.x0;t.circularPathData.sourceX=t.source.x0+t.circularPathData.sourceWidth;t.circularPathData.targetX=t.target.x0;t.circularPathData.sourceY=t.y0;t.circularPathData.targetY=t.y1;if($(t,i)&&O(t)){t.circularPathData.leftSmallArcRadius=M+t.width/2;t.circularPathData.leftLargeArcRadius=M+t.width/2;t.circularPathData.rightSmallArcRadius=M+t.width/2;t.circularPathData.rightLargeArcRadius=M+t.width/2;if(t.circularLinkType=="bottom"){t.circularPathData.verticalFullExtent=t.source.y1+k+t.circularPathData.verticalBuffer;t.circularPathData.verticalLeftInnerExtent=t.circularPathData.verticalFullExtent-t.circularPathData.leftLargeArcRadius;t.circularPathData.verticalRightInnerExtent=t.circularPathData.verticalFullExtent-t.circularPathData.rightLargeArcRadius}else{t.circularPathData.verticalFullExtent=t.source.y0-k-t.circularPathData.verticalBuffer;t.circularPathData.verticalLeftInnerExtent=t.circularPathData.verticalFullExtent+t.circularPathData.leftLargeArcRadius;t.circularPathData.verticalRightInnerExtent=t.circularPathData.verticalFullExtent+t.circularPathData.rightLargeArcRadius}}else{var l=t.source.column;var u=t.circularLinkType;var c=e.links.filter((function(e){return e.source.column==l&&e.circularLinkType==u}));if(t.circularLinkType=="bottom"){c.sort(N)}else{c.sort(B)}var f=0;c.forEach((function(e,a){if(e.circularLinkID==t.circularLinkID){t.circularPathData.leftSmallArcRadius=M+t.width/2+f;t.circularPathData.leftLargeArcRadius=M+t.width/2+a*r+f}f=f+e.width}));l=t.target.column;c=e.links.filter((function(e){return e.target.column==l&&e.circularLinkType==u}));if(t.circularLinkType=="bottom"){c.sort(U)}else{c.sort(j)}f=0;c.forEach((function(e,a){if(e.circularLinkID==t.circularLinkID){t.circularPathData.rightSmallArcRadius=M+t.width/2+f;t.circularPathData.rightLargeArcRadius=M+t.width/2+a*r+f}f=f+e.width}));if(t.circularLinkType=="bottom"){t.circularPathData.verticalFullExtent=Math.max(n,t.source.y1,t.target.y1)+k+t.circularPathData.verticalBuffer;t.circularPathData.verticalLeftInnerExtent=t.circularPathData.verticalFullExtent-t.circularPathData.leftLargeArcRadius;t.circularPathData.verticalRightInnerExtent=t.circularPathData.verticalFullExtent-t.circularPathData.rightLargeArcRadius}else{t.circularPathData.verticalFullExtent=s-k-t.circularPathData.verticalBuffer;t.circularPathData.verticalLeftInnerExtent=t.circularPathData.verticalFullExtent+t.circularPathData.leftLargeArcRadius;t.circularPathData.verticalRightInnerExtent=t.circularPathData.verticalFullExtent+t.circularPathData.rightLargeArcRadius}}t.circularPathData.leftInnerExtent=t.circularPathData.sourceX+t.circularPathData.leftNodeBuffer;t.circularPathData.rightInnerExtent=t.circularPathData.targetX-t.circularPathData.rightNodeBuffer;t.circularPathData.leftFullExtent=t.circularPathData.sourceX+t.circularPathData.leftLargeArcRadius+t.circularPathData.leftNodeBuffer;t.circularPathData.rightFullExtent=t.circularPathData.targetX-t.circularPathData.rightLargeArcRadius-t.circularPathData.rightNodeBuffer}if(t.circular){t.path=R(t)}else{var h=a.linkHorizontal().source((function(e){var t=e.source.x0+(e.source.x1-e.source.x0);var r=e.y0;return[t,r]})).target((function(e){var t=e.target.x0;var r=e.y1;return[t,r]}));t.path=h(t)}}))}function R(e){var t="";if(e.circularLinkType=="top"){t="M"+e.circularPathData.sourceX+" "+e.circularPathData.sourceY+" "+"L"+e.circularPathData.leftInnerExtent+" "+e.circularPathData.sourceY+" "+"A"+e.circularPathData.leftLargeArcRadius+" "+e.circularPathData.leftSmallArcRadius+" 0 0 0 "+e.circularPathData.leftFullExtent+" "+(e.circularPathData.sourceY-e.circularPathData.leftSmallArcRadius)+" "+"L"+e.circularPathData.leftFullExtent+" "+e.circularPathData.verticalLeftInnerExtent+" "+"A"+e.circularPathData.leftLargeArcRadius+" "+e.circularPathData.leftLargeArcRadius+" 0 0 0 "+e.circularPathData.leftInnerExtent+" "+e.circularPathData.verticalFullExtent+" "+"L"+e.circularPathData.rightInnerExtent+" "+e.circularPathData.verticalFullExtent+" "+"A"+e.circularPathData.rightLargeArcRadius+" "+e.circularPathData.rightLargeArcRadius+" 0 0 0 "+e.circularPathData.rightFullExtent+" "+e.circularPathData.verticalRightInnerExtent+" "+"L"+e.circularPathData.rightFullExtent+" "+(e.circularPathData.targetY-e.circularPathData.rightSmallArcRadius)+" "+"A"+e.circularPathData.rightLargeArcRadius+" "+e.circularPathData.rightSmallArcRadius+" 0 0 0 "+e.circularPathData.rightInnerExtent+" "+e.circularPathData.targetY+" "+"L"+e.circularPathData.targetX+" "+e.circularPathData.targetY}else{t="M"+e.circularPathData.sourceX+" "+e.circularPathData.sourceY+" "+"L"+e.circularPathData.leftInnerExtent+" "+e.circularPathData.sourceY+" "+"A"+e.circularPathData.leftLargeArcRadius+" "+e.circularPathData.leftSmallArcRadius+" 0 0 1 "+e.circularPathData.leftFullExtent+" "+(e.circularPathData.sourceY+e.circularPathData.leftSmallArcRadius)+" "+"L"+e.circularPathData.leftFullExtent+" "+e.circularPathData.verticalLeftInnerExtent+" "+"A"+e.circularPathData.leftLargeArcRadius+" "+e.circularPathData.leftLargeArcRadius+" 0 0 1 "+e.circularPathData.leftInnerExtent+" "+e.circularPathData.verticalFullExtent+" "+"L"+e.circularPathData.rightInnerExtent+" "+e.circularPathData.verticalFullExtent+" "+"A"+e.circularPathData.rightLargeArcRadius+" "+e.circularPathData.rightLargeArcRadius+" 0 0 1 "+e.circularPathData.rightFullExtent+" "+e.circularPathData.verticalRightInnerExtent+" "+"L"+e.circularPathData.rightFullExtent+" "+(e.circularPathData.targetY+e.circularPathData.rightSmallArcRadius)+" "+"A"+e.circularPathData.rightLargeArcRadius+" "+e.circularPathData.rightSmallArcRadius+" 0 0 1 "+e.circularPathData.rightInnerExtent+" "+e.circularPathData.targetY+" "+"L"+e.circularPathData.targetX+" "+e.circularPathData.targetY}return t}function F(e,t){if(V(e)==V(t)){return e.circularLinkType=="bottom"?N(e,t):B(e,t)}else{return V(t)-V(e)}}function B(e,t){return e.y0-t.y0}function N(e,t){return t.y0-e.y0}function j(e,t){return e.y1-t.y1}function U(e,t){return t.y1-e.y1}function V(e){return e.target.column-e.source.column}function H(e){return e.target.x0-e.source.x1}function q(e,t){var r=C(e);var a=H(t)/Math.tan(r);var n=Q(e)=="up"?e.y1+a:e.y1-a;return n}function G(e,t){var r=C(e);var a=H(t)/Math.tan(r);var n=Q(e)=="up"?e.y1-a:e.y1+a;return n}function Y(e,t,r,a){e.links.forEach((function(n){if(n.circular){return}if(n.target.column-n.source.column>1){var i=n.source.column+1;var o=n.target.column-1;var s=1;var l=o-i+1;for(s=1;i<=o;i++,s++){e.nodes.forEach((function(o){if(o.column==i){var u=s/(l+1);var c=Math.pow(1-u,3);var f=3*u*Math.pow(1-u,2);var h=3*Math.pow(u,2)*(1-u);var p=Math.pow(u,3);var v=c*n.y0+f*n.y0+h*n.y1+p*n.y1;var d=v-n.width/2;var m=v+n.width/2;var g;if(d>o.y0&&d<o.y1){g=o.y1-d+10;g=o.circularLinkType=="bottom"?g:-g;o=X(o,g,t,r);e.nodes.forEach((function(e){if(T(e,a)==T(o,a)||e.column!=o.column){return}if(W(o,e)){X(e,g,t,r)}}))}else if(m>o.y0&&m<o.y1){g=m-o.y0+10;o=X(o,g,t,r);e.nodes.forEach((function(e){if(T(e,a)==T(o,a)||e.column!=o.column){return}if(e.y0<o.y1&&e.y1>o.y1){X(e,g,t,r)}}))}else if(d<o.y0&&m>o.y1){g=m-o.y0+10;o=X(o,g,t,r);e.nodes.forEach((function(e){if(T(e,a)==T(o,a)||e.column!=o.column){return}if(e.y0<o.y1&&e.y1>o.y1){X(e,g,t,r)}}))}}}))}}}))}function W(e,t){if(e.y0>t.y0&&e.y0<t.y1){return true}else if(e.y1>t.y0&&e.y1<t.y1){return true}else if(e.y0<t.y0&&e.y1>t.y1){return true}else{return false}}function X(e,t,r,a){if(e.y0+t>=r&&e.y1+t<=a){e.y0=e.y0+t;e.y1=e.y1+t;e.targetLinks.forEach((function(e){e.y1=e.y1+t}));e.sourceLinks.forEach((function(e){e.y0=e.y0+t}))}return e}function Z(e,t,r,a){e.nodes.forEach((function(n){if(a&&n.y+(n.y1-n.y0)>t){n.y=n.y-(n.y+(n.y1-n.y0)-t)}var i=e.links.filter((function(e){return T(e.source,r)==T(n,r)}));var o=i.length;if(o>1){i.sort((function(e,t){if(!e.circular&&!t.circular){if(e.target.column==t.target.column){return e.y1-t.y1}else if(!K(e,t)){return e.y1-t.y1}else{if(e.target.column>t.target.column){var r=G(t,e);return e.y1-r}if(t.target.column>e.target.column){var a=G(e,t);return a-t.y1}}}if(e.circular&&!t.circular){return e.circularLinkType=="top"?-1:1}else if(t.circular&&!e.circular){return t.circularLinkType=="top"?1:-1}if(e.circular&&t.circular){if(e.circularLinkType===t.circularLinkType&&e.circularLinkType=="top"){if(e.target.column===t.target.column){return e.target.y1-t.target.y1}else{return t.target.column-e.target.column}}else if(e.circularLinkType===t.circularLinkType&&e.circularLinkType=="bottom"){if(e.target.column===t.target.column){return t.target.y1-e.target.y1}else{return e.target.column-t.target.column}}else{return e.circularLinkType=="top"?-1:1}}}))}var s=n.y0;i.forEach((function(e){e.y0=s+e.width/2;s=s+e.width}));i.forEach((function(e,t){if(e.circularLinkType=="bottom"){var r=t+1;var a=0;for(r;r<o;r++){a=a+i[r].width}e.y0=n.y1-a-e.width/2}}))}))}function J(e,t,r){e.nodes.forEach((function(t){var a=e.links.filter((function(e){return T(e.target,r)==T(t,r)}));var n=a.length;if(n>1){a.sort((function(e,t){if(!e.circular&&!t.circular){if(e.source.column==t.source.column){return e.y0-t.y0}else if(!K(e,t)){return e.y0-t.y0}else{if(t.source.column<e.source.column){var r=q(t,e);return e.y0-r}if(e.source.column<t.source.column){var a=q(e,t);return a-t.y0}}}if(e.circular&&!t.circular){return e.circularLinkType=="top"?-1:1}else if(t.circular&&!e.circular){return t.circularLinkType=="top"?1:-1}if(e.circular&&t.circular){if(e.circularLinkType===t.circularLinkType&&e.circularLinkType=="top"){if(e.source.column===t.source.column){return e.source.y1-t.source.y1}else{return e.source.column-t.source.column}}else if(e.circularLinkType===t.circularLinkType&&e.circularLinkType=="bottom"){if(e.source.column===t.source.column){return e.source.y1-t.source.y1}else{return t.source.column-e.source.column}}else{return e.circularLinkType=="top"?-1:1}}}))}var i=t.y0;a.forEach((function(e){e.y1=i+e.width/2;i=i+e.width}));a.forEach((function(e,r){if(e.circularLinkType=="bottom"){var i=r+1;var o=0;for(i;i<n;i++){o=o+a[i].width}e.y1=t.y1-o-e.width/2}}))}))}function K(e,t){return Q(e)==Q(t)}function Q(e){return e.y0-e.y1>0?"up":"down"}function $(e,t){return T(e.source,t)==T(e.target,t)}function ee(e,r,a){var n=e.nodes;var i=e.links;var o=false;var s=false;i.forEach((function(e){if(e.circularLinkType=="top"){o=true}else if(e.circularLinkType=="bottom"){s=true}}));if(o==false||s==false){var l=t.min(n,(function(e){return e.y0}));var u=t.max(n,(function(e){return e.y1}));var c=u-l;var f=a-r;var h=f/c;n.forEach((function(e){var t=(e.y1-e.y0)*h;e.y0=(e.y0-l)*h;e.y1=e.y0+t}));i.forEach((function(e){e.y0=(e.y0-l)*h;e.y1=(e.y1-l)*h;e.width=e.width*h}))}}e.sankeyCircular=S;e.sankeyCenter=u;e.sankeyLeft=o;e.sankeyRight=s;e.sankeyJustify=l;Object.defineProperty(e,"__esModule",{value:true})}))},{"d3-array":159,"d3-collection":160,"d3-shape":171,"elementary-circuits-directed-graph":185}],57:[function(t,r,a){(function(n,i){typeof a==="object"&&typeof r!=="undefined"?i(a,t("d3-array"),t("d3-collection"),t("d3-shape")):typeof e==="function"&&e.amd?e(["exports","d3-array","d3-collection","d3-shape"],i):i(n.d3=n.d3||{},n.d3,n.d3,n.d3)})(this,(function(e,t,r,a){"use strict";function n(e){return e.target.depth}function i(e){return e.depth}function o(e,t){return t-1-e.height}function s(e,t){return e.sourceLinks.length?e.depth:t-1}function l(e){return e.targetLinks.length?e.depth:e.sourceLinks.length?t.min(e.sourceLinks,n)-1:0}function u(e){return function(){return e}}function c(e,t){return h(e.source,t.source)||e.index-t.index}function f(e,t){return h(e.target,t.target)||e.index-t.index}function h(e,t){return e.y0-t.y0}function p(e){return e.value}function v(e){return(e.y0+e.y1)/2}function d(e){return v(e.source)*e.value}function m(e){return v(e.target)*e.value}function g(e){return e.index}function y(e){return e.nodes}function x(e){return e.links}function b(e,t){var r=e.get(t);if(!r)throw new Error("missing: "+t);return r}var _=function(){var e=0,a=0,n=1,i=1,o=24,l=8,_=g,w=s,T=y,k=x,M=32,A=2/3;function S(){var e={nodes:T.apply(null,arguments),links:k.apply(null,arguments)};E(e);L(e);C(e);I(e,M);P(e);return e}S.update=function(e){P(e);return e};S.nodeId=function(e){return arguments.length?(_=typeof e==="function"?e:u(e),S):_};S.nodeAlign=function(e){return arguments.length?(w=typeof e==="function"?e:u(e),S):w};S.nodeWidth=function(e){return arguments.length?(o=+e,S):o};S.nodePadding=function(e){return arguments.length?(l=+e,S):l};S.nodes=function(e){return arguments.length?(T=typeof e==="function"?e:u(e),S):T};S.links=function(e){return arguments.length?(k=typeof e==="function"?e:u(e),S):k};S.size=function(t){return arguments.length?(e=a=0,n=+t[0],i=+t[1],S):[n-e,i-a]};S.extent=function(t){return arguments.length?(e=+t[0][0],n=+t[1][0],a=+t[0][1],i=+t[1][1],S):[[e,a],[n,i]]};S.iterations=function(e){return arguments.length?(M=+e,S):M};function E(e){e.nodes.forEach((function(e,t){e.index=t;e.sourceLinks=[];e.targetLinks=[]}));var t=r.map(e.nodes,_);e.links.forEach((function(e,r){e.index=r;var a=e.source,n=e.target;if(typeof a!=="object")a=e.source=b(t,a);if(typeof n!=="object")n=e.target=b(t,n);a.sourceLinks.push(e);n.targetLinks.push(e)}))}function L(e){e.nodes.forEach((function(e){e.value=Math.max(t.sum(e.sourceLinks,p),t.sum(e.targetLinks,p))}))}function C(t){var r,a,i;for(r=t.nodes,a=[],i=0;r.length;++i,r=a,a=[]){r.forEach((function(e){e.depth=i;e.sourceLinks.forEach((function(e){if(a.indexOf(e.target)<0){a.push(e.target)}}))}))}for(r=t.nodes,a=[],i=0;r.length;++i,r=a,a=[]){r.forEach((function(e){e.height=i;e.targetLinks.forEach((function(e){if(a.indexOf(e.source)<0){a.push(e.source)}}))}))}var s=(n-e-o)/(i-1);t.nodes.forEach((function(t){t.x1=(t.x0=e+Math.max(0,Math.min(i-1,Math.floor(w.call(null,t,i))))*s)+o}))}function I(e){var n=r.nest().key((function(e){return e.x0})).sortKeys(t.ascending).entries(e.nodes).map((function(e){return e.values}));u();g();for(var o=1,s=M;s>0;--s){f(o*=.99);g();c(o);g()}function u(){var r=t.max(n,(function(e){return e.length}));var o=A*(i-a)/(r-1);if(l>o)l=o;var s=t.min(n,(function(e){return(i-a-(e.length-1)*l)/t.sum(e,p)}));n.forEach((function(e){e.forEach((function(e,t){e.y1=(e.y0=t)+e.value*s}))}));e.links.forEach((function(e){e.width=e.value*s}))}function c(e){n.forEach((function(r){r.forEach((function(r){if(r.targetLinks.length){var a=(t.sum(r.targetLinks,d)/t.sum(r.targetLinks,p)-v(r))*e;r.y0+=a,r.y1+=a}}))}))}function f(e){n.slice().reverse().forEach((function(r){r.forEach((function(r){if(r.sourceLinks.length){var a=(t.sum(r.sourceLinks,m)/t.sum(r.sourceLinks,p)-v(r))*e;r.y0+=a,r.y1+=a}}))}))}function g(){n.forEach((function(e){var t,r,n=a,o=e.length,s;e.sort(h);for(s=0;s<o;++s){t=e[s];r=n-t.y0;if(r>0)t.y0+=r,t.y1+=r;n=t.y1+l}r=n-l-i;if(r>0){n=t.y0-=r,t.y1-=r;for(s=o-2;s>=0;--s){t=e[s];r=t.y1+l-n;if(r>0)t.y0-=r,t.y1-=r;n=t.y0}}}))}}function P(e){e.nodes.forEach((function(e){e.sourceLinks.sort(f);e.targetLinks.sort(c)}));e.nodes.forEach((function(e){var t=e.y0,r=t;e.sourceLinks.forEach((function(e){e.y0=t+e.width/2,t+=e.width}));e.targetLinks.forEach((function(e){e.y1=r+e.width/2,r+=e.width}))}))}return S};function w(e){return[e.source.x1,e.y0]}function T(e){return[e.target.x0,e.y1]}var k=function(){return a.linkHorizontal().source(w).target(T)};e.sankey=_;e.sankeyCenter=l;e.sankeyLeft=i;e.sankeyRight=o;e.sankeyJustify=s;e.sankeyLinkHorizontal=k;Object.defineProperty(e,"__esModule",{value:true})}))},{"d3-array":159,"d3-collection":160,"d3-shape":171}],58:[function(t,r,a){!function(){var t={version:"3.8.0"};var a=[].slice,n=function(e){return a.call(e)};var i=self.document;function o(e){return e&&(e.ownerDocument||e.document||e).documentElement}function s(e){return e&&(e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView)}if(i){try{n(i.documentElement.childNodes)[0].nodeType}catch(lo){n=function(e){var t=e.length,r=new Array(t);while(t--)r[t]=e[t];return r}}}if(!Date.now)Date.now=function(){return+new Date};if(i){try{i.createElement("DIV").style.setProperty("opacity",0,"")}catch(uo){var l=this.Element.prototype,u=l.setAttribute,c=l.setAttributeNS,f=this.CSSStyleDeclaration.prototype,h=f.setProperty;l.setAttribute=function(e,t){u.call(this,e,t+"")};l.setAttributeNS=function(e,t,r){c.call(this,e,t,r+"")};f.setProperty=function(e,t,r){h.call(this,e,t+"",r)}}}t.ascending=p;function p(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}t.descending=function(e,t){return t<e?-1:t>e?1:t>=e?0:NaN};t.min=function(e,t){var r=-1,a=e.length,n,i;if(arguments.length===1){while(++r<a)if((i=e[r])!=null&&i>=i){n=i;break}while(++r<a)if((i=e[r])!=null&&n>i)n=i}else{while(++r<a)if((i=t.call(e,e[r],r))!=null&&i>=i){n=i;break}while(++r<a)if((i=t.call(e,e[r],r))!=null&&n>i)n=i}return n};t.max=function(e,t){var r=-1,a=e.length,n,i;if(arguments.length===1){while(++r<a)if((i=e[r])!=null&&i>=i){n=i;break}while(++r<a)if((i=e[r])!=null&&i>n)n=i}else{while(++r<a)if((i=t.call(e,e[r],r))!=null&&i>=i){n=i;break}while(++r<a)if((i=t.call(e,e[r],r))!=null&&i>n)n=i}return n};t.extent=function(e,t){var r=-1,a=e.length,n,i,o;if(arguments.length===1){while(++r<a)if((i=e[r])!=null&&i>=i){n=o=i;break}while(++r<a)if((i=e[r])!=null){if(n>i)n=i;if(o<i)o=i}}else{while(++r<a)if((i=t.call(e,e[r],r))!=null&&i>=i){n=o=i;break}while(++r<a)if((i=t.call(e,e[r],r))!=null){if(n>i)n=i;if(o<i)o=i}}return[n,o]};function v(e){return e===null?NaN:+e}function d(e){return!isNaN(e)}t.sum=function(e,t){var r=0,a=e.length,n,i=-1;if(arguments.length===1){while(++i<a)if(d(n=+e[i]))r+=n}else{while(++i<a)if(d(n=+t.call(e,e[i],i)))r+=n}return r};t.mean=function(e,t){var r=0,a=e.length,n,i=-1,o=a;if(arguments.length===1){while(++i<a)if(d(n=v(e[i])))r+=n;else--o}else{while(++i<a)if(d(n=v(t.call(e,e[i],i))))r+=n;else--o}if(o)return r/o};t.quantile=function(e,t){var r=(e.length-1)*t+1,a=Math.floor(r),n=+e[a-1],i=r-a;return i?n+i*(e[a]-n):n};t.median=function(e,r){var a=[],n=e.length,i,o=-1;if(arguments.length===1){while(++o<n)if(d(i=v(e[o])))a.push(i)}else{while(++o<n)if(d(i=v(r.call(e,e[o],o))))a.push(i)}if(a.length)return t.quantile(a.sort(p),.5)};t.variance=function(e,t){var r=e.length,a=0,n,i,o=0,s=-1,l=0;if(arguments.length===1){while(++s<r){if(d(n=v(e[s]))){i=n-a;a+=i/++l;o+=i*(n-a)}}}else{while(++s<r){if(d(n=v(t.call(e,e[s],s)))){i=n-a;a+=i/++l;o+=i*(n-a)}}}if(l>1)return o/(l-1)};t.deviation=function(){var e=t.variance.apply(this,arguments);return e?Math.sqrt(e):e};function m(e){return{left:function(t,r,a,n){if(arguments.length<3)a=0;if(arguments.length<4)n=t.length;while(a<n){var i=a+n>>>1;if(e(t[i],r)<0)a=i+1;else n=i}return a},right:function(t,r,a,n){if(arguments.length<3)a=0;if(arguments.length<4)n=t.length;while(a<n){var i=a+n>>>1;if(e(t[i],r)>0)n=i;else a=i+1}return a}}}var g=m(p);t.bisectLeft=g.left;t.bisect=t.bisectRight=g.right;t.bisector=function(e){return m(e.length===1?function(t,r){return p(e(t),r)}:e)};t.shuffle=function(e,t,r){if((a=arguments.length)<3){r=e.length;if(a<2)t=0}var a=r-t,n,i;while(a){i=Math.random()*a--|0;n=e[a+t],e[a+t]=e[i+t],e[i+t]=n}return e};t.permute=function(e,t){var r=t.length,a=new Array(r);while(r--)a[r]=e[t[r]];return a};t.pairs=function(e){var t=0,r=e.length-1,a,n=e[0],i=new Array(r<0?0:r);while(t<r)i[t]=[a=n,n=e[++t]];return i};t.transpose=function(e){if(!(o=e.length))return[];for(var r=-1,a=t.min(e,y),n=new Array(a);++r<a;){for(var i=-1,o,s=n[r]=new Array(o);++i<o;){s[i]=e[i][r]}}return n};function y(e){return e.length}t.zip=function(){return t.transpose(arguments)};t.keys=function(e){var t=[];for(var r in e)t.push(r);return t};t.values=function(e){var t=[];for(var r in e)t.push(e[r]);return t};t.entries=function(e){var t=[];for(var r in e)t.push({key:r,value:e[r]});return t};t.merge=function(e){var t=e.length,r,a=-1,n=0,i,o;while(++a<t)n+=e[a].length;i=new Array(n);while(--t>=0){o=e[t];r=o.length;while(--r>=0){i[--n]=o[r]}}return i};var x=Math.abs;t.range=function(e,t,r){if(arguments.length<3){r=1;if(arguments.length<2){t=e;e=0}}if((t-e)/r===Infinity)throw new Error("infinite range");var a=[],n=b(x(r)),i=-1,o;e*=n,t*=n,r*=n;if(r<0)while((o=e+r*++i)>t)a.push(o/n);else while((o=e+r*++i)<t)a.push(o/n);return a};function b(e){var t=1;while(e*t%1)t*=10;return t}function _(e,t){for(var r in t){Object.defineProperty(e.prototype,r,{value:t[r],enumerable:false})}}t.map=function(e,t){var r=new w;if(e instanceof w){e.forEach((function(e,t){r.set(e,t)}))}else if(Array.isArray(e)){var a=-1,n=e.length,i;if(arguments.length===1)while(++a<n)r.set(a,e[a]);else while(++a<n)r.set(t.call(e,i=e[a],a),i)}else{for(var o in e)r.set(o,e[o])}return r};function w(){this._=Object.create(null)}var T="__proto__",k="\0";_(w,{has:S,get:function(e){return this._[M(e)]},set:function(e,t){return this._[M(e)]=t},remove:E,keys:L,values:function(){var e=[];for(var t in this._)e.push(this._[t]);return e},entries:function(){var e=[];for(var t in this._)e.push({key:A(t),value:this._[t]});return e},size:C,empty:I,forEach:function(e){for(var t in this._)e.call(this,A(t),this._[t])}});function M(e){return(e+="")===T||e[0]===k?k+e:e}function A(e){return(e+="")[0]===k?e.slice(1):e}function S(e){return M(e)in this._}function E(e){return(e=M(e))in this._&&delete this._[e]}function L(){var e=[];for(var t in this._)e.push(A(t));return e}function C(){var e=0;for(var t in this._)++e;return e}function I(){for(var e in this._)return false;return true}t.nest=function(){var e={},r=[],a=[],n,i;function o(t,a,s){if(s>=r.length)return i?i.call(e,a):n?a.sort(n):a;var l=-1,u=a.length,c=r[s++],f,h,p,v=new w,d;while(++l<u){if(d=v.get(f=c(h=a[l]))){d.push(h)}else{v.set(f,[h])}}if(t){h=t();p=function(e,r){h.set(e,o(t,r,s))}}else{h={};p=function(e,r){h[e]=o(t,r,s)}}v.forEach(p);return h}function s(e,t){if(t>=r.length)return e;var n=[],i=a[t++];e.forEach((function(e,r){n.push({key:e,values:s(r,t)})}));return i?n.sort((function(e,t){return i(e.key,t.key)})):n}e.map=function(e,t){return o(t,e,0)};e.entries=function(e){return s(o(t.map,e,0),0)};e.key=function(t){r.push(t);return e};e.sortKeys=function(t){a[r.length-1]=t;return e};e.sortValues=function(t){n=t;return e};e.rollup=function(t){i=t;return e};return e};t.set=function(e){var t=new P;if(e)for(var r=0,a=e.length;r<a;++r)t.add(e[r]);return t};function P(){this._=Object.create(null)}_(P,{has:S,add:function(e){this._[M(e+="")]=true;return e},remove:E,values:L,size:C,empty:I,forEach:function(e){for(var t in this._)e.call(this,A(t))}});t.behavior={};function O(e){return e}t.rebind=function(e,t){var r=1,a=arguments.length,n;while(++r<a)e[n=arguments[r]]=z(e,t,t[n]);return e};function z(e,t,r){return function(){var a=r.apply(t,arguments);return a===t?e:a}}function D(e,t){if(t in e)return t;t=t.charAt(0).toUpperCase()+t.slice(1);for(var r=0,a=R.length;r<a;++r){var n=R[r]+t;if(n in e)return n}}var R=["webkit","ms","moz","Moz","o","O"];function F(){}t.dispatch=function(){var e=new B,t=-1,r=arguments.length;while(++t<r)e[arguments[t]]=N(e);return e};function B(){}B.prototype.on=function(e,t){var r=e.indexOf("."),a="";if(r>=0){a=e.slice(r+1);e=e.slice(0,r)}if(e)return arguments.length<2?this[e].on(a):this[e].on(a,t);if(arguments.length===2){if(t==null)for(e in this){if(this.hasOwnProperty(e))this[e].on(a,null)}return this}};function N(e){var t=[],r=new w;function a(){var r=t,a=-1,n=r.length,i;while(++a<n)if(i=r[a].on)i.apply(this,arguments);return e}a.on=function(a,n){var i=r.get(a),o;if(arguments.length<2)return i&&i.on;if(i){i.on=null;t=t.slice(0,o=t.indexOf(i)).concat(t.slice(o+1));r.remove(a)}if(n)t.push(r.set(a,{on:n}));return e};return a}t.event=null;function j(){t.event.preventDefault()}function U(){var e=t.event,r;while(r=e.sourceEvent)e=r;return e}function V(e){var r=new B,a=0,n=arguments.length;while(++a<n)r[arguments[a]]=N(r);r.of=function(a,n){return function(i){try{var o=i.sourceEvent=t.event;i.target=e;t.event=i;r[i.type].apply(a,n)}finally{t.event=o}}};return r}t.requote=function(e){return e.replace(H,"\\$&")};var H=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g;var q={}.__proto__?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)e[r]=t[r]};function G(e){q(e,Z);return e}var Y=function(e,t){return t.querySelector(e)},W=function(e,t){return t.querySelectorAll(e)},X=function(e,t){var r=e.matches||e[D(e,"matchesSelector")];X=function(e,t){return r.call(e,t)};return X(e,t)};if(typeof Sizzle==="function"){Y=function(e,t){return Sizzle(e,t)[0]||null};W=Sizzle;X=Sizzle.matchesSelector}t.selection=function(){return t.select(i.documentElement)};var Z=t.selection.prototype=[];Z.select=function(e){var t=[],r,a,n,i;e=J(e);for(var o=-1,s=this.length;++o<s;){t.push(r=[]);r.parentNode=(n=this[o]).parentNode;for(var l=-1,u=n.length;++l<u;){if(i=n[l]){r.push(a=e.call(i,i.__data__,l,o));if(a&&"__data__"in i)a.__data__=i.__data__}else{r.push(null)}}}return G(t)};function J(e){return typeof e==="function"?e:function(){return Y(e,this)}}Z.selectAll=function(e){var t=[],r,a;e=K(e);for(var i=-1,o=this.length;++i<o;){for(var s=this[i],l=-1,u=s.length;++l<u;){if(a=s[l]){t.push(r=n(e.call(a,a.__data__,l,i)));r.parentNode=a}}}return G(t)};function K(e){return typeof e==="function"?e:function(){return W(e,this)}}var Q="http://www.w3.org/1999/xhtml";var $={svg:"http://www.w3.org/2000/svg",xhtml:Q,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};t.ns={prefix:$,qualify:function(e){var t=e.indexOf(":"),r=e;if(t>=0&&(r=e.slice(0,t))!=="xmlns")e=e.slice(t+1);return $.hasOwnProperty(r)?{space:$[r],local:e}:e}};Z.attr=function(e,r){if(arguments.length<2){if(typeof e==="string"){var a=this.node();e=t.ns.qualify(e);return e.local?a.getAttributeNS(e.space,e.local):a.getAttribute(e)}for(r in e)this.each(ee(r,e[r]));return this}return this.each(ee(e,r))};function ee(e,r){e=t.ns.qualify(e);function a(){this.removeAttribute(e)}function n(){this.removeAttributeNS(e.space,e.local)}function i(){this.setAttribute(e,r)}function o(){this.setAttributeNS(e.space,e.local,r)}function s(){var t=r.apply(this,arguments);if(t==null)this.removeAttribute(e);else this.setAttribute(e,t)}function l(){var t=r.apply(this,arguments);if(t==null)this.removeAttributeNS(e.space,e.local);else this.setAttributeNS(e.space,e.local,t)}return r==null?e.local?n:a:typeof r==="function"?e.local?l:s:e.local?o:i}function te(e){return e.trim().replace(/\s+/g," ")}Z.classed=function(e,t){if(arguments.length<2){if(typeof e==="string"){var r=this.node(),a=(e=ae(e)).length,n=-1;if(t=r.classList){while(++n<a)if(!t.contains(e[n]))return false}else{t=r.getAttribute("class");while(++n<a)if(!re(e[n]).test(t))return false}return true}for(t in e)this.each(ne(t,e[t]));return this}return this.each(ne(e,t))};function re(e){return new RegExp("(?:^|\\s+)"+t.requote(e)+"(?:\\s+|$)","g")}function ae(e){return(e+"").trim().split(/^|\s+/)}function ne(e,t){e=ae(e).map(ie);var r=e.length;function a(){var a=-1;while(++a<r)e[a](this,t)}function n(){var a=-1,n=t.apply(this,arguments);while(++a<r)e[a](this,n)}return typeof t==="function"?n:a}function ie(e){var t=re(e);return function(r,a){if(n=r.classList)return a?n.add(e):n.remove(e);var n=r.getAttribute("class")||"";if(a){t.lastIndex=0;if(!t.test(n))r.setAttribute("class",te(n+" "+e))}else{r.setAttribute("class",te(n.replace(t," ")))}}}Z.style=function(e,t,r){var a=arguments.length;if(a<3){if(typeof e!=="string"){if(a<2)t="";for(r in e)this.each(oe(r,e[r],t));return this}if(a<2){var n=this.node();return s(n).getComputedStyle(n,null).getPropertyValue(e)}r=""}return this.each(oe(e,t,r))};function oe(e,t,r){function a(){this.style.removeProperty(e)}function n(){this.style.setProperty(e,t,r)}function i(){var a=t.apply(this,arguments);if(a==null)this.style.removeProperty(e);else this.style.setProperty(e,a,r)}return t==null?a:typeof t==="function"?i:n}Z.property=function(e,t){if(arguments.length<2){if(typeof e==="string")return this.node()[e];for(t in e)this.each(se(t,e[t]));return this}return this.each(se(e,t))};function se(e,t){function r(){delete this[e]}function a(){this[e]=t}function n(){var r=t.apply(this,arguments);if(r==null)delete this[e];else this[e]=r}return t==null?r:typeof t==="function"?n:a}Z.text=function(e){return arguments.length?this.each(typeof e==="function"?function(){var t=e.apply(this,arguments);this.textContent=t==null?"":t}:e==null?function(){this.textContent=""}:function(){this.textContent=e}):this.node().textContent};Z.html=function(e){return arguments.length?this.each(typeof e==="function"?function(){var t=e.apply(this,arguments);this.innerHTML=t==null?"":t}:e==null?function(){this.innerHTML=""}:function(){this.innerHTML=e}):this.node().innerHTML};Z.append=function(e){e=le(e);return this.select((function(){return this.appendChild(e.apply(this,arguments))}))};function le(e){function r(){var t=this.ownerDocument,r=this.namespaceURI;return r===Q&&t.documentElement.namespaceURI===Q?t.createElement(e):t.createElementNS(r,e)}function a(){return this.ownerDocument.createElementNS(e.space,e.local)}return typeof e==="function"?e:(e=t.ns.qualify(e)).local?a:r}Z.insert=function(e,t){e=le(e);t=J(t);return this.select((function(){return this.insertBefore(e.apply(this,arguments),t.apply(this,arguments)||null)}))};Z.remove=function(){return this.each(ue)};function ue(){var e=this.parentNode;if(e)e.removeChild(this)}Z.data=function(e,t){var r=-1,a=this.length,n,i;if(!arguments.length){e=new Array(a=(n=this[0]).length);while(++r<a){if(i=n[r]){e[r]=i.__data__}}return e}function o(e,r){var a,n=e.length,i=r.length,o=Math.min(n,i),c=new Array(i),f=new Array(i),h=new Array(n),p,v;if(t){var d=new w,m=new Array(n),g;for(a=-1;++a<n;){if(p=e[a]){if(d.has(g=t.call(p,p.__data__,a))){h[a]=p}else{d.set(g,p)}m[a]=g}}for(a=-1;++a<i;){if(!(p=d.get(g=t.call(r,v=r[a],a)))){f[a]=ce(v)}else if(p!==true){c[a]=p;p.__data__=v}d.set(g,true)}for(a=-1;++a<n;){if(a in m&&d.get(m[a])!==true){h[a]=e[a]}}}else{for(a=-1;++a<o;){p=e[a];v=r[a];if(p){p.__data__=v;c[a]=p}else{f[a]=ce(v)}}for(;a<i;++a){f[a]=ce(r[a])}for(;a<n;++a){h[a]=e[a]}}f.update=c;f.parentNode=c.parentNode=h.parentNode=e.parentNode;s.push(f);l.push(c);u.push(h)}var s=ve([]),l=G([]),u=G([]);if(typeof e==="function"){while(++r<a){o(n=this[r],e.call(n,n.parentNode.__data__,r))}}else{while(++r<a){o(n=this[r],e)}}l.enter=function(){return s};l.exit=function(){return u};return l};function ce(e){return{__data__:e}}Z.datum=function(e){return arguments.length?this.property("__data__",e):this.property("__data__")};Z.filter=function(e){var t=[],r,a,n;if(typeof e!=="function")e=fe(e);for(var i=0,o=this.length;i<o;i++){t.push(r=[]);r.parentNode=(a=this[i]).parentNode;for(var s=0,l=a.length;s<l;s++){if((n=a[s])&&e.call(n,n.__data__,s,i)){r.push(n)}}}return G(t)};function fe(e){return function(){return X(this,e)}}Z.order=function(){for(var e=-1,t=this.length;++e<t;){for(var r=this[e],a=r.length-1,n=r[a],i;--a>=0;){if(i=r[a]){if(n&&n!==i.nextSibling)n.parentNode.insertBefore(i,n);n=i}}}return this};Z.sort=function(e){e=he.apply(this,arguments);for(var t=-1,r=this.length;++t<r;)this[t].sort(e);return this.order()};function he(e){if(!arguments.length)e=p;return function(t,r){return t&&r?e(t.__data__,r.__data__):!t-!r}}Z.each=function(e){return pe(this,(function(t,r,a){e.call(t,t.__data__,r,a)}))};function pe(e,t){for(var r=0,a=e.length;r<a;r++){for(var n=e[r],i=0,o=n.length,s;i<o;i++){if(s=n[i])t(s,i,r)}}return e}Z.call=function(e){var t=n(arguments);e.apply(t[0]=this,t);return this};Z.empty=function(){return!this.node()};Z.node=function(){for(var e=0,t=this.length;e<t;e++){for(var r=this[e],a=0,n=r.length;a<n;a++){var i=r[a];if(i)return i}}return null};Z.size=function(){var e=0;pe(this,(function(){++e}));return e};function ve(e){q(e,de);return e}var de=[];t.selection.enter=ve;t.selection.enter.prototype=de;de.append=Z.append;de.empty=Z.empty;de.node=Z.node;de.call=Z.call;de.size=Z.size;de.select=function(e){var t=[],r,a,n,i,o;for(var s=-1,l=this.length;++s<l;){n=(i=this[s]).update;t.push(r=[]);r.parentNode=i.parentNode;for(var u=-1,c=i.length;++u<c;){if(o=i[u]){r.push(n[u]=a=e.call(i.parentNode,o.__data__,u,s));a.__data__=o.__data__}else{r.push(null)}}}return G(t)};de.insert=function(e,t){if(arguments.length<2)t=me(this);return Z.insert.call(this,e,t)};function me(e){var t,r;return function(a,n,i){var o=e[i].update,s=o.length,l;if(i!=r)r=i,t=0;if(n>=t)t=n+1;while(!(l=o[t])&&++t<s);return l}}t.select=function(e){var t;if(typeof e==="string"){t=[Y(e,i)];t.parentNode=i.documentElement}else{t=[e];t.parentNode=o(e)}return G([t])};t.selectAll=function(e){var t;if(typeof e==="string"){t=n(W(e,i));t.parentNode=i.documentElement}else{t=n(e);t.parentNode=null}return G([t])};Z.on=function(e,t,r){var a=arguments.length;if(a<3){if(typeof e!=="string"){if(a<2)t=false;for(r in e)this.each(ge(r,e[r],t));return this}if(a<2)return(a=this.node()["__on"+e])&&a._;r=false}return this.each(ge(e,t,r))};function ge(e,r,a){var i="__on"+e,o=e.indexOf("."),s=xe;if(o>0)e=e.slice(0,o);var l=ye.get(e);if(l)e=l,s=be;function u(){var t=this[i];if(t){this.removeEventListener(e,t,t.$);delete this[i]}}function c(){var t=s(r,n(arguments));u.call(this);this.addEventListener(e,this[i]=t,t.$=a);t._=r}function f(){var r=new RegExp("^__on([^.]+)"+t.requote(e)+"$"),a;for(var n in this){if(a=n.match(r)){var i=this[n];this.removeEventListener(a[1],i,i.$);delete this[n]}}}return o?r?c:u:r?F:f}var ye=t.map({mouseenter:"mouseover",mouseleave:"mouseout"});if(i){ye.forEach((function(e){if("on"+e in i)ye.remove(e)}))}function xe(e,r){return function(a){var n=t.event;t.event=a;r[0]=this.__data__;try{e.apply(this,r)}finally{t.event=n}}}function be(e,t){var r=xe(e,t);return function(e){var t=this,a=e.relatedTarget;if(!a||a!==t&&!(a.compareDocumentPosition(t)&8)){r.call(t,e)}}}var _e,we=0;function Te(e){var r=".dragsuppress-"+ ++we,a="click"+r,n=t.select(s(e)).on("touchmove"+r,j).on("dragstart"+r,j).on("selectstart"+r,j);if(_e==null){_e="onselectstart"in e?false:D(e.style,"userSelect")}if(_e){var i=o(e).style,l=i[_e];i[_e]="none"}return function(e){n.on(r,null);if(_e)i[_e]=l;if(e){var t=function(){n.on(a,null)};n.on(a,(function(){j();t()}),true);setTimeout(t,0)}}}t.mouse=function(e){return Me(e,U())};var ke=this.navigator&&/WebKit/.test(this.navigator.userAgent)?-1:0;function Me(e,r){if(r.changedTouches)r=r.changedTouches[0];var a=e.ownerSVGElement||e;if(a.createSVGPoint){var n=a.createSVGPoint();if(ke<0){var i=s(e);if(i.scrollX||i.scrollY){a=t.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important");var o=a[0][0].getScreenCTM();ke=!(o.f||o.e);a.remove()}}if(ke)n.x=r.pageX,n.y=r.pageY;else n.x=r.clientX,n.y=r.clientY;n=n.matrixTransform(e.getScreenCTM().inverse());return[n.x,n.y]}var l=e.getBoundingClientRect();return[r.clientX-l.left-e.clientLeft,r.clientY-l.top-e.clientTop]}t.touch=function(e,t,r){if(arguments.length<3)r=t,t=U().changedTouches;if(t)for(var a=0,n=t.length,i;a<n;++a){if((i=t[a]).identifier===r){return Me(e,i)}}};t.behavior.drag=function(){var e=V(i,"drag","dragstart","dragend"),r=null,a=o(F,t.mouse,s,"mousemove","mouseup"),n=o(Ae,t.touch,O,"touchmove","touchend");function i(){this.on("mousedown.drag",a).on("touchstart.drag",n)}function o(a,n,i,o,s){return function(){var l=this,u=t.event.target.correspondingElement||t.event.target,c=l.parentNode,f=e.of(l,arguments),h=0,p=a(),v=".drag"+(p==null?"":"-"+p),d,m=t.select(i(u)).on(o+v,x).on(s+v,b),g=Te(u),y=n(c,p);if(r){d=r.apply(l,arguments);d=[d.x-y[0],d.y-y[1]]}else{d=[0,0]}f({type:"dragstart"});function x(){var e=n(c,p),t,r;if(!e)return;t=e[0]-y[0];r=e[1]-y[1];h|=t|r;y=e;f({type:"drag",x:e[0]+d[0],y:e[1]+d[1],dx:t,dy:r})}function b(){if(!n(c,p))return;m.on(o+v,null).on(s+v,null);g(h);f({type:"dragend"})}}}i.origin=function(e){if(!arguments.length)return r;r=e;return i};return t.rebind(i,e,"on")};function Ae(){return t.event.changedTouches[0].identifier}t.touches=function(e,t){if(arguments.length<2)t=U().touches;return t?n(t).map((function(t){var r=Me(e,t);r.identifier=t.identifier;return r})):[]};var Se=1e-6,Ee=Se*Se,Le=Math.PI,Ce=2*Le,Ie=Ce-Se,Pe=Le/2,Oe=Le/180,ze=180/Le;function De(e){return e>0?1:e<0?-1:0}function Re(e,t,r){return(t[0]-e[0])*(r[1]-e[1])-(t[1]-e[1])*(r[0]-e[0])}function Fe(e){return e>1?0:e<-1?Le:Math.acos(e)}function Be(e){return e>1?Pe:e<-1?-Pe:Math.asin(e)}function Ne(e){return((e=Math.exp(e))-1/e)/2}function je(e){return((e=Math.exp(e))+1/e)/2}function Ue(e){return((e=Math.exp(2*e))-1)/(e+1)}function Ve(e){return(e=Math.sin(e/2))*e}var He=Math.SQRT2,qe=2,Ge=4;t.interpolateZoom=function(e,t){var r=e[0],a=e[1],n=e[2],i=t[0],o=t[1],s=t[2],l=i-r,u=o-a,c=l*l+u*u,f,h;if(c<Ee){h=Math.log(s/n)/He;f=function(e){return[r+e*l,a+e*u,n*Math.exp(He*e*h)]}}else{var p=Math.sqrt(c),v=(s*s-n*n+Ge*c)/(2*n*qe*p),d=(s*s-n*n-Ge*c)/(2*s*qe*p),m=Math.log(Math.sqrt(v*v+1)-v),g=Math.log(Math.sqrt(d*d+1)-d);h=(g-m)/He;f=function(e){var t=e*h,i=je(m),o=n/(qe*p)*(i*Ue(He*t+m)-Ne(m));return[r+o*l,a+o*u,n*i/je(He*t+m)]}}f.duration=h*1e3;return f};t.behavior.zoom=function(){var e={x:0,y:0,k:1},r,a,n,o=[960,500],l=Ye,u=250,c=0,f="mousedown.zoom",h="mousemove.zoom",p="mouseup.zoom",v,d="touchstart.zoom",m,g=V(w,"zoomstart","zoom","zoomend"),y,x,b,_;if(!Xe){Xe="onwheel"in i?(We=function(){return-t.event.deltaY*(t.event.deltaMode?120:1)},"wheel"):"onmousewheel"in i?(We=function(){return t.event.wheelDelta},"mousewheel"):(We=function(){return-t.event.detail},"MozMousePixelScroll")}function w(e){e.on(f,P).on(Xe+".zoom",z).on("dblclick.zoom",D).on(d,O)}w.event=function(r){r.each((function(){var r=g.of(this,arguments),n=e;if(Xi){t.select(this).transition().each("start.zoom",(function(){e=this.__chart__||{x:0,y:0,k:1};L(r)})).tween("zoom:zoom",(function(){var i=o[0],s=o[1],l=a?a[0]:i/2,u=a?a[1]:s/2,c=t.interpolateZoom([(l-e.x)/e.k,(u-e.y)/e.k,i/e.k],[(l-n.x)/n.k,(u-n.y)/n.k,i/n.k]);return function(t){var a=c(t),n=i/a[2];this.__chart__=e={x:l-a[0]*n,y:u-a[1]*n,k:n};C(r)}})).each("interrupt.zoom",(function(){I(r)})).each("end.zoom",(function(){I(r)}))}else{this.__chart__=e;L(r);C(r);I(r)}}))};w.translate=function(t){if(!arguments.length)return[e.x,e.y];e={x:+t[0],y:+t[1],k:e.k};E();return w};w.scale=function(t){if(!arguments.length)return e.k;e={x:e.x,y:e.y,k:null};M(+t);E();return w};w.scaleExtent=function(e){if(!arguments.length)return l;l=e==null?Ye:[+e[0],+e[1]];return w};w.center=function(e){if(!arguments.length)return n;n=e&&[+e[0],+e[1]];return w};w.size=function(e){if(!arguments.length)return o;o=e&&[+e[0],+e[1]];return w};w.duration=function(e){if(!arguments.length)return u;u=+e;return w};w.x=function(t){if(!arguments.length)return x;x=t;y=t.copy();e={x:0,y:0,k:1};return w};w.y=function(t){if(!arguments.length)return _;_=t;b=t.copy();e={x:0,y:0,k:1};return w};function T(t){return[(t[0]-e.x)/e.k,(t[1]-e.y)/e.k]}function k(t){return[t[0]*e.k+e.x,t[1]*e.k+e.y]}function M(t){e.k=Math.max(l[0],Math.min(l[1],t))}function A(t,r){r=k(r);e.x+=t[0]-r[0];e.y+=t[1]-r[1]}function S(r,n,i,o){r.__chart__={x:e.x,y:e.y,k:e.k};M(Math.pow(2,o));A(a=n,i);r=t.select(r);if(u>0)r=r.transition().duration(u);r.call(w.event)}function E(){if(x)x.domain(y.range().map((function(t){return(t-e.x)/e.k})).map(y.invert));if(_)_.domain(b.range().map((function(t){return(t-e.y)/e.k})).map(b.invert))}function L(e){if(!c++)e({type:"zoomstart"})}function C(t){E();t({type:"zoom",scale:e.k,translate:[e.x,e.y]})}function I(e){if(!--c)e({type:"zoomend"}),a=null}function P(){var e=this,r=g.of(e,arguments),a=0,n=t.select(s(e)).on(h,l).on(p,u),i=T(t.mouse(e)),o=Te(e);Hi.call(e);L(r);function l(){a=1;A(t.mouse(e),i);C(r)}function u(){n.on(h,null).on(p,null);o(a);I(r)}}function O(){var r=this,a=g.of(r,arguments),n={},i=0,o,s=".zoom-"+t.event.changedTouches[0].identifier,l="touchmove"+s,u="touchend"+s,c=[],h=t.select(r),p=Te(r);y();L(a);h.on(f,null).on(d,y);function v(){var a=t.touches(r);o=e.k;a.forEach((function(e){if(e.identifier in n)n[e.identifier]=T(e)}));return a}function y(){var a=t.event.target;t.select(a).on(l,x).on(u,b);c.push(a);var o=t.event.changedTouches;for(var s=0,f=o.length;s<f;++s){n[o[s].identifier]=null}var h=v(),p=Date.now();if(h.length===1){if(p-m<500){var d=h[0];S(r,d,n[d.identifier],Math.floor(Math.log(e.k)/Math.LN2)+1);j()}m=p}else if(h.length>1){var d=h[0],g=h[1],y=d[0]-g[0],_=d[1]-g[1];i=y*y+_*_}}function x(){var e=t.touches(r),s,l,u,c;Hi.call(r);for(var f=0,h=e.length;f<h;++f,c=null){u=e[f];if(c=n[u.identifier]){if(l)break;s=u,l=c}}if(c){var p=(p=u[0]-s[0])*p+(p=u[1]-s[1])*p,v=i&&Math.sqrt(p/i);s=[(s[0]+u[0])/2,(s[1]+u[1])/2];l=[(l[0]+c[0])/2,(l[1]+c[1])/2];M(v*o)}m=null;A(s,l);C(a)}function b(){if(t.event.touches.length){var e=t.event.changedTouches;for(var r=0,i=e.length;r<i;++r){delete n[e[r].identifier]}for(var o in n){return void v()}}t.selectAll(c).on(s,null);h.on(f,P).on(d,O);p();I(a)}}function z(){var i=g.of(this,arguments);if(v)clearTimeout(v);else Hi.call(this),r=T(a=n||t.mouse(this)),L(i);v=setTimeout((function(){v=null;I(i)}),50);j();M(Math.pow(2,We()*.002)*e.k);A(a,r);C(i)}function D(){var r=t.mouse(this),a=Math.log(e.k)/Math.LN2;S(this,r,T(r),t.event.shiftKey?Math.ceil(a)-1:Math.floor(a)+1)}return t.rebind(w,g,"on")};var Ye=[0,Infinity],We,Xe;t.color=Ze;function Ze(){}Ze.prototype.toString=function(){return this.rgb()+""};t.hsl=Je;function Je(e,t,r){return this instanceof Je?void(this.h=+e,this.s=+t,this.l=+r):arguments.length<2?e instanceof Je?new Je(e.h,e.s,e.l):yt(""+e,xt,Je):new Je(e,t,r)}var Ke=Je.prototype=new Ze;Ke.brighter=function(e){e=Math.pow(.7,arguments.length?e:1);return new Je(this.h,this.s,this.l/e)};Ke.darker=function(e){e=Math.pow(.7,arguments.length?e:1);return new Je(this.h,this.s,e*this.l)};Ke.rgb=function(){return Qe(this.h,this.s,this.l)};function Qe(e,t,r){var a,n;e=isNaN(e)?0:(e%=360)<0?e+360:e;t=isNaN(t)?0:t<0?0:t>1?1:t;r=r<0?0:r>1?1:r;n=r<=.5?r*(1+t):r+t-r*t;a=2*r-n;function i(e){if(e>360)e-=360;else if(e<0)e+=360;if(e<60)return a+(n-a)*e/60;if(e<180)return n;if(e<240)return a+(n-a)*(240-e)/60;return a}function o(e){return Math.round(i(e)*255)}return new pt(o(e+120),o(e),o(e-120))}t.hcl=$e;function $e(e,r,a){return this instanceof $e?void(this.h=+e,this.c=+r,this.l=+a):arguments.length<2?e instanceof $e?new $e(e.h,e.c,e.l):e instanceof rt?ut(e.l,e.a,e.b):ut((e=bt((e=t.rgb(e)).r,e.g,e.b)).l,e.a,e.b):new $e(e,r,a)}var et=$e.prototype=new Ze;et.brighter=function(e){return new $e(this.h,this.c,Math.min(100,this.l+at*(arguments.length?e:1)))};et.darker=function(e){return new $e(this.h,this.c,Math.max(0,this.l-at*(arguments.length?e:1)))};et.rgb=function(){return tt(this.h,this.c,this.l).rgb()};function tt(e,t,r){if(isNaN(e))e=0;if(isNaN(t))t=0;return new rt(r,Math.cos(e*=Oe)*t,Math.sin(e)*t)}t.lab=rt;function rt(e,t,r){return this instanceof rt?void(this.l=+e,this.a=+t,this.b=+r):arguments.length<2?e instanceof rt?new rt(e.l,e.a,e.b):e instanceof $e?tt(e.h,e.c,e.l):bt((e=pt(e)).r,e.g,e.b):new rt(e,t,r)}var at=18;var nt=.95047,it=1,ot=1.08883;var st=rt.prototype=new Ze;st.brighter=function(e){return new rt(Math.min(100,this.l+at*(arguments.length?e:1)),this.a,this.b)};st.darker=function(e){return new rt(Math.max(0,this.l-at*(arguments.length?e:1)),this.a,this.b)};st.rgb=function(){return lt(this.l,this.a,this.b)};function lt(e,t,r){var a=(e+16)/116,n=a+t/500,i=a-r/200;n=ct(n)*nt;a=ct(a)*it;i=ct(i)*ot;return new pt(ht(3.2404542*n-1.5371385*a-.4985314*i),ht(-.969266*n+1.8760108*a+.041556*i),ht(.0556434*n-.2040259*a+1.0572252*i))}function ut(e,t,r){return e>0?new $e(Math.atan2(r,t)*ze,Math.sqrt(t*t+r*r),e):new $e(NaN,NaN,e)}function ct(e){return e>.206893034?e*e*e:(e-4/29)/7.787037}function ft(e){return e>.008856?Math.pow(e,1/3):7.787037*e+4/29}function ht(e){return Math.round(255*(e<=.00304?12.92*e:1.055*Math.pow(e,1/2.4)-.055))}t.rgb=pt;function pt(e,t,r){return this instanceof pt?void(this.r=~~e,this.g=~~t,this.b=~~r):arguments.length<2?e instanceof pt?new pt(e.r,e.g,e.b):yt(""+e,pt,Qe):new pt(e,t,r)}function vt(e){return new pt(e>>16,e>>8&255,e&255)}function dt(e){return vt(e)+""}var mt=pt.prototype=new Ze;mt.brighter=function(e){e=Math.pow(.7,arguments.length?e:1);var t=this.r,r=this.g,a=this.b,n=30;if(!t&&!r&&!a)return new pt(n,n,n);if(t&&t<n)t=n;if(r&&r<n)r=n;if(a&&a<n)a=n;return new pt(Math.min(255,t/e),Math.min(255,r/e),Math.min(255,a/e))};mt.darker=function(e){e=Math.pow(.7,arguments.length?e:1);return new pt(e*this.r,e*this.g,e*this.b)};mt.hsl=function(){return xt(this.r,this.g,this.b)};mt.toString=function(){return"#"+gt(this.r)+gt(this.g)+gt(this.b)};function gt(e){return e<16?"0"+Math.max(0,e).toString(16):Math.min(255,e).toString(16)}function yt(e,t,r){var a=0,n=0,i=0,o,s,l;o=/([a-z]+)\((.*)\)/.exec(e=e.toLowerCase());if(o){s=o[2].split(",");switch(o[1]){case"hsl":{return r(parseFloat(s[0]),parseFloat(s[1])/100,parseFloat(s[2])/100)}case"rgb":{return t(wt(s[0]),wt(s[1]),wt(s[2]))}}}if(l=Tt.get(e)){return t(l.r,l.g,l.b)}if(e!=null&&e.charAt(0)==="#"&&!isNaN(l=parseInt(e.slice(1),16))){if(e.length===4){a=(l&3840)>>4;a=a>>4|a;n=l&240;n=n>>4|n;i=l&15;i=i<<4|i}else if(e.length===7){a=(l&16711680)>>16;n=(l&65280)>>8;i=l&255}}return t(a,n,i)}function xt(e,t,r){var a=Math.min(e/=255,t/=255,r/=255),n=Math.max(e,t,r),i=n-a,o,s,l=(n+a)/2;if(i){s=l<.5?i/(n+a):i/(2-n-a);if(e==n)o=(t-r)/i+(t<r?6:0);else if(t==n)o=(r-e)/i+2;else o=(e-t)/i+4;o*=60}else{o=NaN;s=l>0&&l<1?0:o}return new Je(o,s,l)}function bt(e,t,r){e=_t(e);t=_t(t);r=_t(r);var a=ft((.4124564*e+.3575761*t+.1804375*r)/nt),n=ft((.2126729*e+.7151522*t+.072175*r)/it),i=ft((.0193339*e+.119192*t+.9503041*r)/ot);return rt(116*n-16,500*(a-n),200*(n-i))}function _t(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function wt(e){var t=parseFloat(e);return e.charAt(e.length-1)==="%"?Math.round(t*2.55):t}var Tt=t.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});Tt.forEach((function(e,t){Tt.set(e,vt(t))}));function kt(e){return typeof e==="function"?e:function(){return e}}t.functor=kt;t.xhr=Mt(O);function Mt(e){return function(t,r,a){if(arguments.length===2&&typeof r==="function")a=r,r=null;return At(t,r,e,a)}}function At(e,r,a,i){var o={},s=t.dispatch("beforesend","progress","load","error"),l={},u=new XMLHttpRequest,c=null;if(self.XDomainRequest&&!("withCredentials"in u)&&/^(http(s)?:)?\/\//.test(e))u=new XDomainRequest;"onload"in u?u.onload=u.onerror=f:u.onreadystatechange=function(){u.readyState>3&&f()};function f(){var e=u.status,t;if(!e&&Et(u)||e>=200&&e<300||e===304){try{t=a.call(o,u)}catch(lo){s.error.call(o,lo);return}s.load.call(o,t)}else{s.error.call(o,u)}}u.onprogress=function(e){var r=t.event;t.event=e;try{s.progress.call(o,u)}finally{t.event=r}};o.header=function(e,t){e=(e+"").toLowerCase();if(arguments.length<2)return l[e];if(t==null)delete l[e];else l[e]=t+"";return o};o.mimeType=function(e){if(!arguments.length)return r;r=e==null?null:e+"";return o};o.responseType=function(e){if(!arguments.length)return c;c=e;return o};o.response=function(e){a=e;return o};["get","post"].forEach((function(e){o[e]=function(){return o.send.apply(o,[e].concat(n(arguments)))}}));o.send=function(t,a,n){if(arguments.length===2&&typeof a==="function")n=a,a=null;u.open(t,e,true);if(r!=null&&!("accept"in l))l["accept"]=r+",*/*";if(u.setRequestHeader)for(var i in l)u.setRequestHeader(i,l[i]);if(r!=null&&u.overrideMimeType)u.overrideMimeType(r);if(c!=null)u.responseType=c;if(n!=null)o.on("error",n).on("load",(function(e){n(null,e)}));s.beforesend.call(o,u);u.send(a==null?null:a);return o};o.abort=function(){u.abort();return o};t.rebind(o,s,"on");return i==null?o:o.get(St(i))}function St(e){return e.length===1?function(t,r){e(t==null?r:null)}:e}function Et(e){var t=e.responseType;return t&&t!=="text"?e.response:e.responseText}t.dsv=function(e,t){var r=new RegExp('["'+e+"\n]"),a=e.charCodeAt(0);function n(e,r,a){if(arguments.length<3)a=r,r=null;var n=At(e,t,r==null?i:o(r),a);n.row=function(e){return arguments.length?n.response((r=e)==null?i:o(e)):r};return n}function i(e){return n.parse(e.responseText)}function o(e){return function(t){return n.parse(t.responseText,e)}}n.parse=function(e,t){var r;return n.parseRows(e,(function(e,a){if(r)return r(e,a-1);var n=function(t){var r={};var a=e.length;for(var n=0;n<a;++n){r[e[n]]=t[n]}return r};r=t?function(e,r){return t(n(e),r)}:n}))};n.parseRows=function(e,t){var r={},n={},i=[],o=e.length,s=0,l=0,u,c;function f(){if(s>=o)return n;if(c)return c=false,r;var t=s;if(e.charCodeAt(t)===34){var i=t;while(i++<o){if(e.charCodeAt(i)===34){if(e.charCodeAt(i+1)!==34)break;++i}}s=i+2;var l=e.charCodeAt(i+1);if(l===13){c=true;if(e.charCodeAt(i+2)===10)++s}else if(l===10){c=true}return e.slice(t+1,i).replace(/""/g,'"')}while(s<o){var l=e.charCodeAt(s++),u=1;if(l===10)c=true;else if(l===13){c=true;if(e.charCodeAt(s)===10)++s,++u}else if(l!==a)continue;return e.slice(t,s-u)}return e.slice(t)}while((u=f())!==n){var h=[];while(u!==r&&u!==n){h.push(u);u=f()}if(t&&(h=t(h,l++))==null)continue;i.push(h)}return i};n.format=function(t){if(Array.isArray(t[0]))return n.formatRows(t);var r=new P,a=[];t.forEach((function(e){for(var t in e){if(!r.has(t)){a.push(r.add(t))}}}));return[a.map(l).join(e)].concat(t.map((function(t){return a.map((function(e){return l(t[e])})).join(e)}))).join("\n")};n.formatRows=function(e){return e.map(s).join("\n")};function s(t){return t.map(l).join(e)}function l(e){return r.test(e)?'"'+e.replace(/\"/g,'""')+'"':e}return n};t.csv=t.dsv(",","text/csv");t.tsv=t.dsv("\t","text/tab-separated-values");var Lt,Ct,It,Pt,Ot=this[D(this,"requestAnimationFrame")]||function(e){setTimeout(e,17)};t.timer=function(){zt.apply(this,arguments)};function zt(e,t,r){var a=arguments.length;if(a<2)t=0;if(a<3)r=Date.now();var n=r+t,i={c:e,t:n,n:null};if(Ct)Ct.n=i;else Lt=i;Ct=i;if(!It){Pt=clearTimeout(Pt);It=1;Ot(Dt)}return i}function Dt(){var e=Rt(),t=Ft()-e;if(t>24){if(isFinite(t)){clearTimeout(Pt);Pt=setTimeout(Dt,t)}It=0}else{It=1;Ot(Dt)}}t.timer.flush=function(){Rt();Ft()};function Rt(){var e=Date.now(),t=Lt;while(t){if(e>=t.t&&t.c(e-t.t))t.c=null;t=t.n}return e}function Ft(){var e,t=Lt,r=Infinity;while(t){if(t.c){if(t.t<r)r=t.t;t=(e=t).n}else{t=e?e.n=t.n:Lt=t.n}}Ct=e;return r}t.round=function(e,t){return t?Math.round(e*(t=Math.pow(10,t)))/t:Math.round(e)};t.geom={};function Bt(e){return e[0]}function Nt(e){return e[1]}t.geom.hull=function(e){var t=Bt,r=Nt;if(arguments.length)return a(e);function a(e){if(e.length<3)return[];var a=kt(t),n=kt(r),i,o=e.length,s=[],l=[];for(i=0;i<o;i++){s.push([+a.call(this,e[i],i),+n.call(this,e[i],i),i])}s.sort(Ut);for(i=0;i<o;i++)l.push([s[i][0],-s[i][1]]);var u=jt(s),c=jt(l);var f=c[0]===u[0],h=c[c.length-1]===u[u.length-1],p=[];for(i=u.length-1;i>=0;--i)p.push(e[s[u[i]][2]]);for(i=+f;i<c.length-h;++i)p.push(e[s[c[i]][2]]);return p}a.x=function(e){return arguments.length?(t=e,a):t};a.y=function(e){return arguments.length?(r=e,a):r};return a};function jt(e){var t=e.length,r=[0,1],a=2;for(var n=2;n<t;n++){while(a>1&&Re(e[r[a-2]],e[r[a-1]],e[n])<=0)--a;r[a++]=n}return r.slice(0,a)}function Ut(e,t){return e[0]-t[0]||e[1]-t[1]}t.geom.polygon=function(e){q(e,Vt);return e};var Vt=t.geom.polygon.prototype=[];Vt.area=function(){var e=-1,t=this.length,r,a=this[t-1],n=0;while(++e<t){r=a;a=this[e];n+=r[1]*a[0]-r[0]*a[1]}return n*.5};Vt.centroid=function(e){var t=-1,r=this.length,a=0,n=0,i,o=this[r-1],s;if(!arguments.length)e=-1/(6*this.area());while(++t<r){i=o;o=this[t];s=i[0]*o[1]-o[0]*i[1];a+=(i[0]+o[0])*s;n+=(i[1]+o[1])*s}return[a*e,n*e]};Vt.clip=function(e){var t,r=Gt(e),a=-1,n=this.length-Gt(this),i,o,s=this[n-1],l,u,c;while(++a<n){t=e.slice();e.length=0;l=this[a];u=t[(o=t.length-r)-1];i=-1;while(++i<o){c=t[i];if(Ht(c,s,l)){if(!Ht(u,s,l)){e.push(qt(u,c,s,l))}e.push(c)}else if(Ht(u,s,l)){e.push(qt(u,c,s,l))}u=c}if(r)e.push(e[0]);s=l}return e};function Ht(e,t,r){return(r[0]-t[0])*(e[1]-t[1])<(r[1]-t[1])*(e[0]-t[0])}function qt(e,t,r,a){var n=e[0],i=r[0],o=t[0]-n,s=a[0]-i,l=e[1],u=r[1],c=t[1]-l,f=a[1]-u,h=(s*(l-u)-f*(n-i))/(f*o-s*c);return[n+h*o,l+h*c]}function Gt(e){var t=e[0],r=e[e.length-1];return!(t[0]-r[0]||t[1]-r[1])}var Yt,Wt,Xt,Zt=[],Jt,Kt,Qt=[];function $t(){_r(this);this.edge=this.site=this.circle=null}function er(e){var t=Zt.pop()||new $t;t.site=e;return t}function tr(e){fr(e);Xt.remove(e);Zt.push(e);_r(e)}function rr(e){var t=e.circle,r=t.x,a=t.cy,n={x:r,y:a},i=e.P,o=e.N,s=[e];tr(e);var l=i;while(l.circle&&x(r-l.circle.x)<Se&&x(a-l.circle.cy)<Se){i=l.P;s.unshift(l);tr(l);l=i}s.unshift(l);fr(l);var u=o;while(u.circle&&x(r-u.circle.x)<Se&&x(a-u.circle.cy)<Se){o=u.N;s.push(u);tr(u);u=o}s.push(u);fr(u);var c=s.length,f;for(f=1;f<c;++f){u=s[f];l=s[f-1];yr(u.edge,l.site,u.site,n)}l=s[0];u=s[c-1];u.edge=mr(l.site,u.site,null,n);cr(l);cr(u)}function ar(e){var t=e.x,r=e.y,a,n,i,o,s=Xt._;while(s){i=nr(s,r)-t;if(i>Se)s=s.L;else{o=t-ir(s,r);if(o>Se){if(!s.R){a=s;break}s=s.R}else{if(i>-Se){a=s.P;n=s}else if(o>-Se){a=s;n=s.N}else{a=n=s}break}}}var l=er(e);Xt.insert(a,l);if(!a&&!n)return;if(a===n){fr(a);n=er(a.site);Xt.insert(l,n);l.edge=n.edge=mr(a.site,l.site);cr(a);cr(n);return}if(!n){l.edge=mr(a.site,l.site);return}fr(a);fr(n);var u=a.site,c=u.x,f=u.y,h=e.x-c,p=e.y-f,v=n.site,d=v.x-c,m=v.y-f,g=2*(h*m-p*d),y=h*h+p*p,x=d*d+m*m,b={x:(m*y-p*x)/g+c,y:(h*x-d*y)/g+f};yr(n.edge,u,v,b);l.edge=mr(u,e,null,b);n.edge=mr(e,v,null,b);cr(a);cr(n)}function nr(e,t){var r=e.site,a=r.x,n=r.y,i=n-t;if(!i)return a;var o=e.P;if(!o)return-Infinity;r=o.site;var s=r.x,l=r.y,u=l-t;if(!u)return s;var c=s-a,f=1/i-1/u,h=c/u;if(f)return(-h+Math.sqrt(h*h-2*f*(c*c/(-2*u)-l+u/2+n-i/2)))/f+a;return(a+s)/2}function ir(e,t){var r=e.N;if(r)return nr(r,t);var a=e.site;return a.y===t?a.x:Infinity}function or(e){this.site=e;this.edges=[]}or.prototype.prepare=function(){var e=this.edges,t=e.length,r;while(t--){r=e[t].edge;if(!r.b||!r.a)e.splice(t,1)}e.sort(lr);return e.length};function sr(e){var t=e[0][0],r=e[1][0],a=e[0][1],n=e[1][1],i,o,s,l,u=Wt,c=u.length,f,h,p,v,d,m;while(c--){f=u[c];if(!f||!f.prepare())continue;p=f.edges;v=p.length;h=0;while(h<v){m=p[h].end(),s=m.x,l=m.y;d=p[++h%v].start(),i=d.x,o=d.y;if(x(s-i)>Se||x(l-o)>Se){p.splice(h,0,new xr(gr(f.site,m,x(s-t)<Se&&n-l>Se?{x:t,y:x(i-t)<Se?o:n}:x(l-n)<Se&&r-s>Se?{x:x(o-n)<Se?i:r,y:n}:x(s-r)<Se&&l-a>Se?{x:r,y:x(i-r)<Se?o:a}:x(l-a)<Se&&s-t>Se?{x:x(o-a)<Se?i:t,y:a}:null),f.site,null));++v}}}}function lr(e,t){return t.angle-e.angle}function ur(){_r(this);this.x=this.y=this.arc=this.site=this.cy=null}function cr(e){var t=e.P,r=e.N;if(!t||!r)return;var a=t.site,n=e.site,i=r.site;if(a===i)return;var o=n.x,s=n.y,l=a.x-o,u=a.y-s,c=i.x-o,f=i.y-s;var h=2*(l*f-u*c);if(h>=-Ee)return;var p=l*l+u*u,v=c*c+f*f,d=(f*p-u*v)/h,m=(l*v-c*p)/h,f=m+s;var g=Qt.pop()||new ur;g.arc=e;g.site=n;g.x=d+o;g.y=f+Math.sqrt(d*d+m*m);g.cy=f;e.circle=g;var y=null,x=Kt._;while(x){if(g.y<x.y||g.y===x.y&&g.x<=x.x){if(x.L)x=x.L;else{y=x.P;break}}else{if(x.R)x=x.R;else{y=x;break}}}Kt.insert(y,g);if(!y)Jt=g}function fr(e){var t=e.circle;if(t){if(!t.P)Jt=t.N;Kt.remove(t);Qt.push(t);_r(t);e.circle=null}}function hr(e,t,r,a){return function(n){var i=n.a,o=n.b,s=i.x,l=i.y,u=o.x,c=o.y,f=0,h=1,p=u-s,v=c-l,d;d=e-s;if(!p&&d>0)return;d/=p;if(p<0){if(d<f)return;if(d<h)h=d}else if(p>0){if(d>h)return;if(d>f)f=d}d=r-s;if(!p&&d<0)return;d/=p;if(p<0){if(d>h)return;if(d>f)f=d}else if(p>0){if(d<f)return;if(d<h)h=d}d=t-l;if(!v&&d>0)return;d/=v;if(v<0){if(d<f)return;if(d<h)h=d}else if(v>0){if(d>h)return;if(d>f)f=d}d=a-l;if(!v&&d<0)return;d/=v;if(v<0){if(d>h)return;if(d>f)f=d}else if(v>0){if(d<f)return;if(d<h)h=d}if(f>0)n.a={x:s+f*p,y:l+f*v};if(h<1)n.b={x:s+h*p,y:l+h*v};return n}}function pr(e){var t=Yt,r=hr(e[0][0],e[0][1],e[1][0],e[1][1]),a=t.length,n;while(a--){n=t[a];if(!vr(n,e)||!r(n)||x(n.a.x-n.b.x)<Se&&x(n.a.y-n.b.y)<Se){n.a=n.b=null;t.splice(a,1)}}}function vr(e,t){var r=e.b;if(r)return true;var a=e.a,n=t[0][0],i=t[1][0],o=t[0][1],s=t[1][1],l=e.l,u=e.r,c=l.x,f=l.y,h=u.x,p=u.y,v=(c+h)/2,d=(f+p)/2,m,g;if(p===f){if(v<n||v>=i)return;if(c>h){if(!a)a={x:v,y:o};else if(a.y>=s)return;r={x:v,y:s}}else{if(!a)a={x:v,y:s};else if(a.y<o)return;r={x:v,y:o}}}else{m=(c-h)/(p-f);g=d-m*v;if(m<-1||m>1){if(c>h){if(!a)a={x:(o-g)/m,y:o};else if(a.y>=s)return;r={x:(s-g)/m,y:s}}else{if(!a)a={x:(s-g)/m,y:s};else if(a.y<o)return;r={x:(o-g)/m,y:o}}}else{if(f<p){if(!a)a={x:n,y:m*n+g};else if(a.x>=i)return;r={x:i,y:m*i+g}}else{if(!a)a={x:i,y:m*i+g};else if(a.x<n)return;r={x:n,y:m*n+g}}}}e.a=a;e.b=r;return true}function dr(e,t){this.l=e;this.r=t;this.a=this.b=null}function mr(e,t,r,a){var n=new dr(e,t);Yt.push(n);if(r)yr(n,e,t,r);if(a)yr(n,t,e,a);Wt[e.i].edges.push(new xr(n,e,t));Wt[t.i].edges.push(new xr(n,t,e));return n}function gr(e,t,r){var a=new dr(e,null);a.a=t;a.b=r;Yt.push(a);return a}function yr(e,t,r,a){if(!e.a&&!e.b){e.a=a;e.l=t;e.r=r}else if(e.l===r){e.b=a}else{e.a=a}}function xr(e,t,r){var a=e.a,n=e.b;this.edge=e;this.site=t;this.angle=r?Math.atan2(r.y-t.y,r.x-t.x):e.l===t?Math.atan2(n.x-a.x,a.y-n.y):Math.atan2(a.x-n.x,n.y-a.y)}xr.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}};function br(){this._=null}function _r(e){e.U=e.C=e.L=e.R=e.P=e.N=null}br.prototype={insert:function(e,t){var r,a,n;if(e){t.P=e;t.N=e.N;if(e.N)e.N.P=t;e.N=t;if(e.R){e=e.R;while(e.L)e=e.L;e.L=t}else{e.R=t}r=e}else if(this._){e=kr(this._);t.P=null;t.N=e;e.P=e.L=t;r=e}else{t.P=t.N=null;this._=t;r=null}t.L=t.R=null;t.U=r;t.C=true;e=t;while(r&&r.C){a=r.U;if(r===a.L){n=a.R;if(n&&n.C){r.C=n.C=false;a.C=true;e=a}else{if(e===r.R){wr(this,r);e=r;r=e.U}r.C=false;a.C=true;Tr(this,a)}}else{n=a.L;if(n&&n.C){r.C=n.C=false;a.C=true;e=a}else{if(e===r.L){Tr(this,r);e=r;r=e.U}r.C=false;a.C=true;wr(this,a)}}r=e.U}this._.C=false},remove:function(e){if(e.N)e.N.P=e.P;if(e.P)e.P.N=e.N;e.N=e.P=null;var t=e.U,r,a=e.L,n=e.R,i,o;if(!a)i=n;else if(!n)i=a;else i=kr(n);if(t){if(t.L===e)t.L=i;else t.R=i}else{this._=i}if(a&&n){o=i.C;i.C=e.C;i.L=a;a.U=i;if(i!==n){t=i.U;i.U=e.U;e=i.R;t.L=e;i.R=n;n.U=i}else{i.U=t;t=i;e=i.R}}else{o=e.C;e=i}if(e)e.U=t;if(o)return;if(e&&e.C){e.C=false;return}do{if(e===this._)break;if(e===t.L){r=t.R;if(r.C){r.C=false;t.C=true;wr(this,t);r=t.R}if(r.L&&r.L.C||r.R&&r.R.C){if(!r.R||!r.R.C){r.L.C=false;r.C=true;Tr(this,r);r=t.R}r.C=t.C;t.C=r.R.C=false;wr(this,t);e=this._;break}}else{r=t.L;if(r.C){r.C=false;t.C=true;Tr(this,t);r=t.L}if(r.L&&r.L.C||r.R&&r.R.C){if(!r.L||!r.L.C){r.R.C=false;r.C=true;wr(this,r);r=t.L}r.C=t.C;t.C=r.L.C=false;Tr(this,t);e=this._;break}}r.C=true;e=t;t=t.U}while(!e.C);if(e)e.C=false}};function wr(e,t){var r=t,a=t.R,n=r.U;if(n){if(n.L===r)n.L=a;else n.R=a}else{e._=a}a.U=n;r.U=a;r.R=a.L;if(r.R)r.R.U=r;a.L=r}function Tr(e,t){var r=t,a=t.L,n=r.U;if(n){if(n.L===r)n.L=a;else n.R=a}else{e._=a}a.U=n;r.U=a;r.L=a.R;if(r.L)r.L.U=r;a.R=r}function kr(e){while(e.L)e=e.L;return e}function Mr(e,t){var r=e.sort(Ar).pop(),a,n,i;Yt=[];Wt=new Array(e.length);Xt=new br;Kt=new br;while(true){i=Jt;if(r&&(!i||r.y<i.y||r.y===i.y&&r.x<i.x)){if(r.x!==a||r.y!==n){Wt[r.i]=new or(r);ar(r);a=r.x,n=r.y}r=e.pop()}else if(i){rr(i.arc)}else{break}}if(t)pr(t),sr(t);var o={cells:Wt,edges:Yt};Xt=Kt=Yt=Wt=null;return o}function Ar(e,t){return t.y-e.y||t.x-e.x}t.geom.voronoi=function(e){var t=Bt,r=Nt,a=t,n=r,i=Sr;if(e)return o(e);function o(e){var t=new Array(e.length),r=i[0][0],a=i[0][1],n=i[1][0],o=i[1][1];Mr(s(e),i).cells.forEach((function(i,s){var l=i.edges,u=i.site,c=t[s]=l.length?l.map((function(e){var t=e.start();return[t.x,t.y]})):u.x>=r&&u.x<=n&&u.y>=a&&u.y<=o?[[r,o],[n,o],[n,a],[r,a]]:[];c.point=e[s]}));return t}function s(e){return e.map((function(e,t){return{x:Math.round(a(e,t)/Se)*Se,y:Math.round(n(e,t)/Se)*Se,i:t}}))}o.links=function(e){return Mr(s(e)).edges.filter((function(e){return e.l&&e.r})).map((function(t){return{source:e[t.l.i],target:e[t.r.i]}}))};o.triangles=function(e){var t=[];Mr(s(e)).cells.forEach((function(r,a){var n=r.site,i=r.edges.sort(lr),o=-1,s=i.length,l,u,c=i[s-1].edge,f=c.l===n?c.r:c.l;while(++o<s){l=c;u=f;c=i[o].edge;f=c.l===n?c.r:c.l;if(a<u.i&&a<f.i&&Er(n,u,f)<0){t.push([e[a],e[u.i],e[f.i]])}}}));return t};o.x=function(e){return arguments.length?(a=kt(t=e),o):t};o.y=function(e){return arguments.length?(n=kt(r=e),o):r};o.clipExtent=function(e){if(!arguments.length)return i===Sr?null:i;i=e==null?Sr:e;return o};o.size=function(e){if(!arguments.length)return i===Sr?null:i&&i[1];return o.clipExtent(e&&[[0,0],e])};return o};var Sr=[[-1e6,-1e6],[1e6,1e6]];function Er(e,t,r){return(e.x-r.x)*(t.y-e.y)-(e.x-t.x)*(r.y-e.y)}t.geom.delaunay=function(e){return t.geom.voronoi().triangles(e)};t.geom.quadtree=function(e,t,r,a,n){var i=Bt,o=Nt,s;if(s=arguments.length){i=Lr;o=Cr;if(s===3){n=r;a=t;r=t=0}return l(e)}function l(e){var l,u=kt(i),c=kt(o),f,h,p,v,d,m,g,y;if(t!=null){d=t,m=r,g=a,y=n}else{g=y=-(d=m=Infinity);f=[],h=[];v=e.length;if(s)for(p=0;p<v;++p){l=e[p];if(l.x<d)d=l.x;if(l.y<m)m=l.y;if(l.x>g)g=l.x;if(l.y>y)y=l.y;f.push(l.x);h.push(l.y)}else for(p=0;p<v;++p){var b=+u(l=e[p],p),_=+c(l,p);if(b<d)d=b;if(_<m)m=_;if(b>g)g=b;if(_>y)y=_;f.push(b);h.push(_)}}var w=g-d,T=y-m;if(w>T)y=m+w;else g=d+T;function k(e,t,r,a,n,i,o,s){if(isNaN(r)||isNaN(a))return;if(e.leaf){var l=e.x,u=e.y;if(l!=null){if(x(l-r)+x(u-a)<.01){M(e,t,r,a,n,i,o,s)}else{var c=e.point;e.x=e.y=e.point=null;M(e,c,l,u,n,i,o,s);M(e,t,r,a,n,i,o,s)}}else{e.x=r,e.y=a,e.point=t}}else{M(e,t,r,a,n,i,o,s)}}function M(e,t,r,a,n,i,o,s){var l=(n+o)*.5,u=(i+s)*.5,c=r>=l,f=a>=u,h=f<<1|c;e.leaf=false;e=e.nodes[h]||(e.nodes[h]=Ir());if(c)n=l;else o=l;if(f)i=u;else s=u;k(e,t,r,a,n,i,o,s)}var A=Ir();A.add=function(e){k(A,e,+u(e,++p),+c(e,p),d,m,g,y)};A.visit=function(e){Pr(e,A,d,m,g,y)};A.find=function(e){return Or(A,e[0],e[1],d,m,g,y)};p=-1;if(t==null){while(++p<v){k(A,e[p],f[p],h[p],d,m,g,y)}--p}else e.forEach(A.add);f=h=e=l=null;return A}l.x=function(e){return arguments.length?(i=e,l):i};l.y=function(e){return arguments.length?(o=e,l):o};l.extent=function(e){if(!arguments.length)return t==null?null:[[t,r],[a,n]];if(e==null)t=r=a=n=null;else t=+e[0][0],r=+e[0][1],a=+e[1][0],n=+e[1][1];return l};l.size=function(e){if(!arguments.length)return t==null?null:[a-t,n-r];if(e==null)t=r=a=n=null;else t=r=0,a=+e[0],n=+e[1];return l};return l};function Lr(e){return e.x}function Cr(e){return e.y}function Ir(){return{leaf:true,nodes:[],point:null,x:null,y:null}}function Pr(e,t,r,a,n,i){if(!e(t,r,a,n,i)){var o=(r+n)*.5,s=(a+i)*.5,l=t.nodes;if(l[0])Pr(e,l[0],r,a,o,s);if(l[1])Pr(e,l[1],o,a,n,s);if(l[2])Pr(e,l[2],r,s,o,i);if(l[3])Pr(e,l[3],o,s,n,i)}}function Or(e,t,r,a,n,i,o){var s=Infinity,l;(function e(u,c,f,h,p){if(c>i||f>o||h<a||p<n)return;if(v=u.point){var v,d=t-u.x,m=r-u.y,g=d*d+m*m;if(g<s){var y=Math.sqrt(s=g);a=t-y,n=r-y;i=t+y,o=r+y;l=v}}var x=u.nodes,b=(c+h)*.5,_=(f+p)*.5,w=t>=b,T=r>=_;for(var k=T<<1|w,M=k+4;k<M;++k){if(u=x[k&3])switch(k&3){case 0:e(u,c,f,b,_);break;case 1:e(u,b,f,h,_);break;case 2:e(u,c,_,b,p);break;case 3:e(u,b,_,h,p);break}}})(e,a,n,i,o);return l}t.interpolateRgb=zr;function zr(e,r){e=t.rgb(e);r=t.rgb(r);var a=e.r,n=e.g,i=e.b,o=r.r-a,s=r.g-n,l=r.b-i;return function(e){return"#"+gt(Math.round(a+o*e))+gt(Math.round(n+s*e))+gt(Math.round(i+l*e))}}t.interpolateObject=Dr;function Dr(e,t){var r={},a={},n;for(n in e){if(n in t){r[n]=jr(e[n],t[n])}else{a[n]=e[n]}}for(n in t){if(!(n in e)){a[n]=t[n]}}return function(e){for(n in r)a[n]=r[n](e);return a}}t.interpolateNumber=Rr;function Rr(e,t){e=+e,t=+t;return function(r){return e*(1-r)+t*r}}t.interpolateString=Fr;function Fr(e,t){var r=Br.lastIndex=Nr.lastIndex=0,a,n,i,o=-1,s=[],l=[];e=e+"",t=t+"";while((a=Br.exec(e))&&(n=Nr.exec(t))){if((i=n.index)>r){i=t.slice(r,i);if(s[o])s[o]+=i;else s[++o]=i}if((a=a[0])===(n=n[0])){if(s[o])s[o]+=n;else s[++o]=n}else{s[++o]=null;l.push({i:o,x:Rr(a,n)})}r=Nr.lastIndex}if(r<t.length){i=t.slice(r);if(s[o])s[o]+=i;else s[++o]=i}return s.length<2?l[0]?(t=l[0].x,function(e){return t(e)+""}):function(){return t}:(t=l.length,function(e){for(var r=0,a;r<t;++r)s[(a=l[r]).i]=a.x(e);return s.join("")})}var Br=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Nr=new RegExp(Br.source,"g");t.interpolate=jr;function jr(e,r){var a=t.interpolators.length,n;while(--a>=0&&!(n=t.interpolators[a](e,r)));return n}t.interpolators=[function(e,t){var r=typeof t;return(r==="string"?Tt.has(t.toLowerCase())||/^(#|rgb\(|hsl\()/i.test(t)?zr:Fr:t instanceof Ze?zr:Array.isArray(t)?Ur:r==="object"&&isNaN(t)?Dr:Rr)(e,t)}];t.interpolateArray=Ur;function Ur(e,t){var r=[],a=[],n=e.length,i=t.length,o=Math.min(e.length,t.length),s;for(s=0;s<o;++s)r.push(jr(e[s],t[s]));for(;s<n;++s)a[s]=e[s];for(;s<i;++s)a[s]=t[s];return function(e){for(s=0;s<o;++s)a[s]=r[s](e);return a}}var Vr=function(){return O};var Hr=t.map({linear:Vr,poly:Kr,quad:function(){return Xr},cubic:function(){return Zr},sin:function(){return Qr},exp:function(){return $r},circle:function(){return ea},elastic:ta,back:ra,bounce:function(){return aa}});var qr=t.map({in:O,out:Yr,"in-out":Wr,"out-in":function(e){return Wr(Yr(e))}});t.ease=function(e){var t=e.indexOf("-"),r=t>=0?e.slice(0,t):e,n=t>=0?e.slice(t+1):"in";r=Hr.get(r)||Vr;n=qr.get(n)||O;return Gr(n(r.apply(null,a.call(arguments,1))))};function Gr(e){return function(t){return t<=0?0:t>=1?1:e(t)}}function Yr(e){return function(t){return 1-e(1-t)}}function Wr(e){return function(t){return.5*(t<.5?e(2*t):2-e(2-2*t))}}function Xr(e){return e*e}function Zr(e){return e*e*e}function Jr(e){if(e<=0)return 0;if(e>=1)return 1;var t=e*e,r=t*e;return 4*(e<.5?r:3*(e-t)+r-.75)}function Kr(e){return function(t){return Math.pow(t,e)}}function Qr(e){return 1-Math.cos(e*Pe)}function $r(e){return Math.pow(2,10*(e-1))}function ea(e){return 1-Math.sqrt(1-e*e)}function ta(e,t){var r;if(arguments.length<2)t=.45;if(arguments.length)r=t/Ce*Math.asin(1/e);else e=1,r=t/4;return function(a){return 1+e*Math.pow(2,-10*a)*Math.sin((a-r)*Ce/t)}}function ra(e){if(!e)e=1.70158;return function(t){return t*t*((e+1)*t-e)}}function aa(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375}t.interpolateHcl=na;function na(e,r){e=t.hcl(e);r=t.hcl(r);var a=e.h,n=e.c,i=e.l,o=r.h-a,s=r.c-n,l=r.l-i;if(isNaN(s))s=0,n=isNaN(n)?r.c:n;if(isNaN(o))o=0,a=isNaN(a)?r.h:a;else if(o>180)o-=360;else if(o<-180)o+=360;return function(e){return tt(a+o*e,n+s*e,i+l*e)+""}}t.interpolateHsl=ia;function ia(e,r){e=t.hsl(e);r=t.hsl(r);var a=e.h,n=e.s,i=e.l,o=r.h-a,s=r.s-n,l=r.l-i;if(isNaN(s))s=0,n=isNaN(n)?r.s:n;if(isNaN(o))o=0,a=isNaN(a)?r.h:a;else if(o>180)o-=360;else if(o<-180)o+=360;return function(e){return Qe(a+o*e,n+s*e,i+l*e)+""}}t.interpolateLab=oa;function oa(e,r){e=t.lab(e);r=t.lab(r);var a=e.l,n=e.a,i=e.b,o=r.l-a,s=r.a-n,l=r.b-i;return function(e){return lt(a+o*e,n+s*e,i+l*e)+""}}t.interpolateRound=sa;function sa(e,t){t-=e;return function(r){return Math.round(e+t*r)}}t.transform=function(e){var r=i.createElementNS(t.ns.prefix.svg,"g");return(t.transform=function(e){if(e!=null){r.setAttribute("transform",e);var t=r.transform.baseVal.consolidate()}return new la(t?t.matrix:ha)})(e)};function la(e){var t=[e.a,e.b],r=[e.c,e.d],a=ca(t),n=ua(t,r),i=ca(fa(r,t,-n))||0;if(t[0]*r[1]<r[0]*t[1]){t[0]*=-1;t[1]*=-1;a*=-1;n*=-1}this.rotate=(a?Math.atan2(t[1],t[0]):Math.atan2(-r[0],r[1]))*ze;this.translate=[e.e,e.f];this.scale=[a,i];this.skew=i?Math.atan2(n,i)*ze:0}la.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};function ua(e,t){return e[0]*t[0]+e[1]*t[1]}function ca(e){var t=Math.sqrt(ua(e,e));if(t){e[0]/=t;e[1]/=t}return t}function fa(e,t,r){e[0]+=r*t[0];e[1]+=r*t[1];return e}var ha={a:1,b:0,c:0,d:1,e:0,f:0};t.interpolateTransform=ya;function pa(e){return e.length?e.pop()+",":""}function va(e,t,r,a){if(e[0]!==t[0]||e[1]!==t[1]){var n=r.push("translate(",null,",",null,")");a.push({i:n-4,x:Rr(e[0],t[0])},{i:n-2,x:Rr(e[1],t[1])})}else if(t[0]||t[1]){r.push("translate("+t+")")}}function da(e,t,r,a){if(e!==t){if(e-t>180)t+=360;else if(t-e>180)e+=360;a.push({i:r.push(pa(r)+"rotate(",null,")")-2,x:Rr(e,t)})}else if(t){r.push(pa(r)+"rotate("+t+")")}}function ma(e,t,r,a){if(e!==t){a.push({i:r.push(pa(r)+"skewX(",null,")")-2,x:Rr(e,t)})}else if(t){r.push(pa(r)+"skewX("+t+")")}}function ga(e,t,r,a){if(e[0]!==t[0]||e[1]!==t[1]){var n=r.push(pa(r)+"scale(",null,",",null,")");a.push({i:n-4,x:Rr(e[0],t[0])},{i:n-2,x:Rr(e[1],t[1])})}else if(t[0]!==1||t[1]!==1){r.push(pa(r)+"scale("+t+")")}}function ya(e,r){var a=[],n=[];e=t.transform(e),r=t.transform(r);va(e.translate,r.translate,a,n);da(e.rotate,r.rotate,a,n);ma(e.skew,r.skew,a,n);ga(e.scale,r.scale,a,n);e=r=null;return function(e){var t=-1,r=n.length,i;while(++t<r)a[(i=n[t]).i]=i.x(e);return a.join("")}}function xa(e,t){t=(t-=e=+e)||1/t;return function(r){return(r-e)/t}}function ba(e,t){t=(t-=e=+e)||1/t;return function(r){return Math.max(0,Math.min(1,(r-e)/t))}}t.layout={};t.layout.bundle=function(){return function(e){var t=[],r=-1,a=e.length;while(++r<a)t.push(_a(e[r]));return t}};function _a(e){var t=e.source,r=e.target,a=Ta(t,r),n=[t];while(t!==a){t=t.parent;n.push(t)}var i=n.length;while(r!==a){n.splice(i,0,r);r=r.parent}return n}function wa(e){var t=[],r=e.parent;while(r!=null){t.push(e);e=r;r=r.parent}t.push(e);return t}function Ta(e,t){if(e===t)return e;var r=wa(e),a=wa(t),n=r.pop(),i=a.pop(),o=null;while(n===i){o=n;n=r.pop();i=a.pop()}return o}t.layout.chord=function(){var e={},r,a,n,i,o=0,s,l,u;function c(){var e={},c=[],h=t.range(i),p=[],v,d,m,g,y;r=[];a=[];v=0,g=-1;while(++g<i){d=0,y=-1;while(++y<i){d+=n[g][y]}c.push(d);p.push(t.range(i));v+=d}if(s){h.sort((function(e,t){return s(c[e],c[t])}))}if(l){p.forEach((function(e,t){e.sort((function(e,r){return l(n[t][e],n[t][r])}))}))}v=(Ce-o*i)/v;d=0,g=-1;while(++g<i){m=d,y=-1;while(++y<i){var x=h[g],b=p[x][y],_=n[x][b],w=d,T=d+=_*v;e[x+"-"+b]={index:x,subindex:b,startAngle:w,endAngle:T,value:_}}a[x]={index:x,startAngle:m,endAngle:d,value:c[x]};d+=o}g=-1;while(++g<i){y=g-1;while(++y<i){var k=e[g+"-"+y],M=e[y+"-"+g];if(k.value||M.value){r.push(k.value<M.value?{source:M,target:k}:{source:k,target:M})}}}if(u)f()}function f(){r.sort((function(e,t){return u((e.source.value+e.target.value)/2,(t.source.value+t.target.value)/2)}))}e.matrix=function(t){if(!arguments.length)return n;i=(n=t)&&n.length;r=a=null;return e};e.padding=function(t){if(!arguments.length)return o;o=t;r=a=null;return e};e.sortGroups=function(t){if(!arguments.length)return s;s=t;r=a=null;return e};e.sortSubgroups=function(t){if(!arguments.length)return l;l=t;r=null;return e};e.sortChords=function(t){if(!arguments.length)return u;u=t;if(r)f();return e};e.chords=function(){if(!r)c();return r};e.groups=function(){if(!a)c();return a};return e};t.layout.force=function(){var e={},r=t.dispatch("start","tick","end"),a,n=[1,1],i,o,s=.9,l=La,u=Ca,c=-30,f=Ia,h=.1,p=.64,v=[],d=[],m,g,y;function x(e){return function(t,r,a,n){if(t.point!==e){var i=t.cx-e.x,o=t.cy-e.y,s=n-r,l=i*i+o*o;if(s*s/p<l){if(l<f){var u=t.charge/l;e.px-=i*u;e.py-=o*u}return true}if(t.point&&l&&l<f){var u=t.pointCharge/l;e.px-=i*u;e.py-=o*u}}return!t.charge}}e.tick=function(){if((o*=.99)<.005){a=null;r.end({type:"end",alpha:o=0});return true}var e=v.length,i=d.length,l,u,f,p,b,_,w,T,k;for(u=0;u<i;++u){f=d[u];p=f.source;b=f.target;T=b.x-p.x;k=b.y-p.y;if(_=T*T+k*k){_=o*g[u]*((_=Math.sqrt(_))-m[u])/_;T*=_;k*=_;b.x-=T*(w=p.weight+b.weight?p.weight/(p.weight+b.weight):.5);b.y-=k*w;p.x+=T*(w=1-w);p.y+=k*w}}if(w=o*h){T=n[0]/2;k=n[1]/2;u=-1;if(w)while(++u<e){f=v[u];f.x+=(T-f.x)*w;f.y+=(k-f.y)*w}}if(c){Ea(l=t.geom.quadtree(v),o,y);u=-1;while(++u<e){if(!(f=v[u]).fixed){l.visit(x(f))}}}u=-1;while(++u<e){f=v[u];if(f.fixed){f.x=f.px;f.y=f.py}else{f.x-=(f.px-(f.px=f.x))*s;f.y-=(f.py-(f.py=f.y))*s}}r.tick({type:"tick",alpha:o})};e.nodes=function(t){if(!arguments.length)return v;v=t;return e};e.links=function(t){if(!arguments.length)return d;d=t;return e};e.size=function(t){if(!arguments.length)return n;n=t;return e};e.linkDistance=function(t){if(!arguments.length)return l;l=typeof t==="function"?t:+t;return e};e.distance=e.linkDistance;e.linkStrength=function(t){if(!arguments.length)return u;u=typeof t==="function"?t:+t;return e};e.friction=function(t){if(!arguments.length)return s;s=+t;return e};e.charge=function(t){if(!arguments.length)return c;c=typeof t==="function"?t:+t;return e};e.chargeDistance=function(t){if(!arguments.length)return Math.sqrt(f);f=t*t;return e};e.gravity=function(t){if(!arguments.length)return h;h=+t;return e};e.theta=function(t){if(!arguments.length)return Math.sqrt(p);p=t*t;return e};e.alpha=function(t){if(!arguments.length)return o;t=+t;if(o){if(t>0){o=t}else{a.c=null,a.t=NaN,a=null;r.end({type:"end",alpha:o=0})}}else if(t>0){r.start({type:"start",alpha:o=t});a=zt(e.tick)}return e};e.start=function(){var t,r=v.length,a=d.length,i=n[0],o=n[1],s,f;for(t=0;t<r;++t){(f=v[t]).index=t;f.weight=0}for(t=0;t<a;++t){f=d[t];if(typeof f.source=="number")f.source=v[f.source];if(typeof f.target=="number")f.target=v[f.target];++f.source.weight;++f.target.weight}for(t=0;t<r;++t){f=v[t];if(isNaN(f.x))f.x=h("x",i);if(isNaN(f.y))f.y=h("y",o);if(isNaN(f.px))f.px=f.x;if(isNaN(f.py))f.py=f.y}m=[];if(typeof l==="function")for(t=0;t<a;++t)m[t]=+l.call(this,d[t],t);else for(t=0;t<a;++t)m[t]=l;g=[];if(typeof u==="function")for(t=0;t<a;++t)g[t]=+u.call(this,d[t],t);else for(t=0;t<a;++t)g[t]=u;y=[];if(typeof c==="function")for(t=0;t<r;++t)y[t]=+c.call(this,v[t],t);else for(t=0;t<r;++t)y[t]=c;function h(e,n){if(!s){s=new Array(r);for(l=0;l<r;++l){s[l]=[]}for(l=0;l<a;++l){var i=d[l];s[i.source.index].push(i.target);s[i.target.index].push(i.source)}}var o=s[t],l=-1,u=o.length,c;while(++l<u)if(!isNaN(c=o[l][e]))return c;return Math.random()*n}return e.resume()};e.resume=function(){return e.alpha(.1)};e.stop=function(){return e.alpha(0)};e.drag=function(){if(!i)i=t.behavior.drag().origin(O).on("dragstart.force",ka).on("drag.force",b).on("dragend.force",Ma);if(!arguments.length)return i;this.on("mouseover.force",Aa).on("mouseout.force",Sa).call(i)};function b(r){r.px=t.event.x,r.py=t.event.y;e.resume()}return t.rebind(e,r,"on")};function ka(e){e.fixed|=2}function Ma(e){e.fixed&=~6}function Aa(e){e.fixed|=4;e.px=e.x,e.py=e.y}function Sa(e){e.fixed&=~4}function Ea(e,t,r){var a=0,n=0;e.charge=0;if(!e.leaf){var i=e.nodes,o=i.length,s=-1,l;while(++s<o){l=i[s];if(l==null)continue;Ea(l,t,r);e.charge+=l.charge;a+=l.charge*l.cx;n+=l.charge*l.cy}}if(e.point){if(!e.leaf){e.point.x+=Math.random()-.5;e.point.y+=Math.random()-.5}var u=t*r[e.point.index];e.charge+=e.pointCharge=u;a+=u*e.point.x;n+=u*e.point.y}e.cx=a/e.charge;e.cy=n/e.charge}var La=20,Ca=1,Ia=Infinity;t.layout.hierarchy=function(){var e=Fa,t=Da,r=Ra;function a(n){var i=[n],o=[],s;n.depth=0;while((s=i.pop())!=null){o.push(s);if((u=t.call(a,s,s.depth))&&(l=u.length)){var l,u,c;while(--l>=0){i.push(c=u[l]);c.parent=s;c.depth=s.depth+1}if(r)s.value=0;s.children=u}else{if(r)s.value=+r.call(a,s,s.depth)||0;delete s.children}}za(n,(function(t){var a,n;if(e&&(a=t.children))a.sort(e);if(r&&(n=t.parent))n.value+=t.value}));return o}a.sort=function(t){if(!arguments.length)return e;e=t;return a};a.children=function(e){if(!arguments.length)return t;t=e;return a};a.value=function(e){if(!arguments.length)return r;r=e;return a};a.revalue=function(e){if(r){Oa(e,(function(e){if(e.children)e.value=0}));za(e,(function(e){var t;if(!e.children)e.value=+r.call(a,e,e.depth)||0;if(t=e.parent)t.value+=e.value}))}return e};return a};function Pa(e,r){t.rebind(e,r,"sort","children","value");e.nodes=e;e.links=Ba;return e}function Oa(e,t){var r=[e];while((e=r.pop())!=null){t(e);if((n=e.children)&&(a=n.length)){var a,n;while(--a>=0)r.push(n[a])}}}function za(e,t){var r=[e],a=[];while((e=r.pop())!=null){a.push(e);if((o=e.children)&&(i=o.length)){var n=-1,i,o;while(++n<i)r.push(o[n])}}while((e=a.pop())!=null){t(e)}}function Da(e){return e.children}function Ra(e){return e.value}function Fa(e,t){return t.value-e.value}function Ba(e){return t.merge(e.map((function(e){return(e.children||[]).map((function(t){return{source:e,target:t}}))})))}t.layout.partition=function(){var e=t.layout.hierarchy(),r=[1,1];function a(e,t,r,n){var i=e.children;e.x=t;e.y=e.depth*n;e.dx=r;e.dy=n;if(i&&(s=i.length)){var o=-1,s,l,u;r=e.value?r/e.value:0;while(++o<s){a(l=i[o],t,u=l.value*r,n);t+=u}}}function n(e){var t=e.children,r=0;if(t&&(i=t.length)){var a=-1,i;while(++a<i)r=Math.max(r,n(t[a]))}return 1+r}function i(t,i){var o=e.call(this,t,i);a(o[0],0,r[0],r[1]/n(o[0]));return o}i.size=function(e){if(!arguments.length)return r;r=e;return i};return Pa(i,e)};t.layout.pie=function(){var e=Number,r=Na,a=0,n=Ce,i=0;function o(s){var l=s.length,u=s.map((function(t,r){return+e.call(o,t,r)})),c=+(typeof a==="function"?a.apply(this,arguments):a),f=(typeof n==="function"?n.apply(this,arguments):n)-c,h=Math.min(Math.abs(f)/l,+(typeof i==="function"?i.apply(this,arguments):i)),p=h*(f<0?-1:1),v=t.sum(u),d=v?(f-l*p)/v:0,m=t.range(l),g=[],y;if(r!=null)m.sort(r===Na?function(e,t){return u[t]-u[e]}:function(e,t){return r(s[e],s[t])});m.forEach((function(e){g[e]={data:s[e],value:y=u[e],startAngle:c,endAngle:c+=y*d+p,padAngle:h}}));return g}o.value=function(t){if(!arguments.length)return e;e=t;return o};o.sort=function(e){if(!arguments.length)return r;r=e;return o};o.startAngle=function(e){if(!arguments.length)return a;a=e;return o};o.endAngle=function(e){if(!arguments.length)return n;n=e;return o};o.padAngle=function(e){if(!arguments.length)return i;i=e;return o};return o};var Na={};t.layout.stack=function(){var e=O,r=Ga,a=Ya,n=Va,i=ja,o=Ua;function s(l,u){if(!(d=l.length))return l;var c=l.map((function(t,r){return e.call(s,t,r)}));var f=c.map((function(e){return e.map((function(e,t){return[i.call(s,e,t),o.call(s,e,t)]}))}));var h=r.call(s,f,u);c=t.permute(c,h);f=t.permute(f,h);var p=a.call(s,f,u);var v=c[0].length,d,m,g,y;for(g=0;g<v;++g){n.call(s,c[0][g],y=p[g],f[0][g][1]);for(m=1;m<d;++m){n.call(s,c[m][g],y+=f[m-1][g][1],f[m][g][1])}}return l}s.values=function(t){if(!arguments.length)return e;e=t;return s};s.order=function(e){if(!arguments.length)return r;r=typeof e==="function"?e:Ha.get(e)||Ga;return s};s.offset=function(e){if(!arguments.length)return a;a=typeof e==="function"?e:qa.get(e)||Ya;return s};s.x=function(e){if(!arguments.length)return i;i=e;return s};s.y=function(e){if(!arguments.length)return o;o=e;return s};s.out=function(e){if(!arguments.length)return n;n=e;return s};return s};function ja(e){return e.x}function Ua(e){return e.y}function Va(e,t,r){e.y0=t;e.y=r}var Ha=t.map({"inside-out":function(e){var r=e.length,a,n,i=e.map(Wa),o=e.map(Xa),s=t.range(r).sort((function(e,t){return i[e]-i[t]})),l=0,u=0,c=[],f=[];for(a=0;a<r;++a){n=s[a];if(l<u){l+=o[n];c.push(n)}else{u+=o[n];f.push(n)}}return f.reverse().concat(c)},reverse:function(e){return t.range(e.length).reverse()},default:Ga});var qa=t.map({silhouette:function(e){var t=e.length,r=e[0].length,a=[],n=0,i,o,s,l=[];for(o=0;o<r;++o){for(i=0,s=0;i<t;i++)s+=e[i][o][1];if(s>n)n=s;a.push(s)}for(o=0;o<r;++o){l[o]=(n-a[o])/2}return l},wiggle:function(e){var t=e.length,r=e[0],a=r.length,n,i,o,s,l,u,c,f,h,p=[];p[0]=f=h=0;for(i=1;i<a;++i){for(n=0,s=0;n<t;++n)s+=e[n][i][1];for(n=0,l=0,c=r[i][0]-r[i-1][0];n<t;++n){for(o=0,u=(e[n][i][1]-e[n][i-1][1])/(2*c);o<n;++o){u+=(e[o][i][1]-e[o][i-1][1])/c}l+=u*e[n][i][1]}p[i]=f-=s?l/s*c:0;if(f<h)h=f}for(i=0;i<a;++i)p[i]-=h;return p},expand:function(e){var t=e.length,r=e[0].length,a=1/t,n,i,o,s=[];for(i=0;i<r;++i){for(n=0,o=0;n<t;n++)o+=e[n][i][1];if(o)for(n=0;n<t;n++)e[n][i][1]/=o;else for(n=0;n<t;n++)e[n][i][1]=a}for(i=0;i<r;++i)s[i]=0;return s},zero:Ya});function Ga(e){return t.range(e.length)}function Ya(e){var t=-1,r=e[0].length,a=[];while(++t<r)a[t]=0;return a}function Wa(e){var t=1,r=0,a=e[0][1],n,i=e.length;for(;t<i;++t){if((n=e[t][1])>a){r=t;a=n}}return r}function Xa(e){return e.reduce(Za,0)}function Za(e,t){return e+t[1]}t.layout.histogram=function(){var e=true,r=Number,a=Qa,n=Ja;function i(i,o){var s=[],l=i.map(r,this),u=a.call(this,l,o),c=n.call(this,u,l,o),f,o=-1,h=l.length,p=c.length-1,v=e?1:1/h,d;while(++o<p){f=s[o]=[];f.dx=c[o+1]-(f.x=c[o]);f.y=0}if(p>0){o=-1;while(++o<h){d=l[o];if(d>=u[0]&&d<=u[1]){f=s[t.bisect(c,d,1,p)-1];f.y+=v;f.push(i[o])}}}return s}i.value=function(e){if(!arguments.length)return r;r=e;return i};i.range=function(e){if(!arguments.length)return a;a=kt(e);return i};i.bins=function(e){if(!arguments.length)return n;n=typeof e==="number"?function(t){return Ka(t,e)}:kt(e);return i};i.frequency=function(t){if(!arguments.length)return e;e=!!t;return i};return i};function Ja(e,t){return Ka(e,Math.ceil(Math.log(t.length)/Math.LN2+1))}function Ka(e,t){var r=-1,a=+e[0],n=(e[1]-a)/t,i=[];while(++r<=t)i[r]=n*r+a;return i}function Qa(e){return[t.min(e),t.max(e)]}t.layout.pack=function(){var e=t.layout.hierarchy().sort($a),r=0,a=[1,1],n;function i(t,i){var o=e.call(this,t,i),s=o[0],l=a[0],u=a[1],c=n==null?Math.sqrt:typeof n==="function"?n:function(){return n};s.x=s.y=0;za(s,(function(e){e.r=+c(e.value)}));za(s,an);if(r){var f=r*(n?1:Math.max(2*s.r/l,2*s.r/u))/2;za(s,(function(e){e.r+=f}));za(s,an);za(s,(function(e){e.r-=f}))}sn(s,l/2,u/2,n?1:1/Math.max(2*s.r/l,2*s.r/u));return o}i.size=function(e){if(!arguments.length)return a;a=e;return i};i.radius=function(e){if(!arguments.length)return n;n=e==null||typeof e==="function"?e:+e;return i};i.padding=function(e){if(!arguments.length)return r;r=+e;return i};return Pa(i,e)};function $a(e,t){return e.value-t.value}function en(e,t){var r=e._pack_next;e._pack_next=t;t._pack_prev=e;t._pack_next=r;r._pack_prev=t}function tn(e,t){e._pack_next=t;t._pack_prev=e}function rn(e,t){var r=t.x-e.x,a=t.y-e.y,n=e.r+t.r;return.999*n*n>r*r+a*a}function an(e){if(!(t=e.children)||!(h=t.length))return;var t,r=Infinity,a=-Infinity,n=Infinity,i=-Infinity,o,s,l,u,c,f,h;function p(e){r=Math.min(e.x-e.r,r);a=Math.max(e.x+e.r,a);n=Math.min(e.y-e.r,n);i=Math.max(e.y+e.r,i)}t.forEach(nn);o=t[0];o.x=-o.r;o.y=0;p(o);if(h>1){s=t[1];s.x=s.r;s.y=0;p(s);if(h>2){l=t[2];ln(o,s,l);p(l);en(o,l);o._pack_prev=l;en(l,s);s=o._pack_next;for(u=3;u<h;u++){ln(o,s,l=t[u]);var v=0,d=1,m=1;for(c=s._pack_next;c!==s;c=c._pack_next,d++){if(rn(c,l)){v=1;break}}if(v==1){for(f=o._pack_prev;f!==c._pack_prev;f=f._pack_prev,m++){if(rn(f,l)){break}}}if(v){if(d<m||d==m&&s.r<o.r)tn(o,s=c);else tn(o=f,s);u--}else{en(o,l);s=l;p(l)}}}}var g=(r+a)/2,y=(n+i)/2,x=0;for(u=0;u<h;u++){l=t[u];l.x-=g;l.y-=y;x=Math.max(x,l.r+Math.sqrt(l.x*l.x+l.y*l.y))}e.r=x;t.forEach(on)}function nn(e){e._pack_next=e._pack_prev=e}function on(e){delete e._pack_next;delete e._pack_prev}function sn(e,t,r,a){var n=e.children;e.x=t+=a*e.x;e.y=r+=a*e.y;e.r*=a;if(n){var i=-1,o=n.length;while(++i<o)sn(n[i],t,r,a)}}function ln(e,t,r){var a=e.r+r.r,n=t.x-e.x,i=t.y-e.y;if(a&&(n||i)){var o=t.r+r.r,s=n*n+i*i;o*=o;a*=a;var l=.5+(a-o)/(2*s),u=Math.sqrt(Math.max(0,2*o*(a+s)-(a-=s)*a-o*o))/(2*s);r.x=e.x+l*n+u*i;r.y=e.y+l*i-u*n}else{r.x=e.x+a;r.y=e.y}}t.layout.tree=function(){var e=t.layout.hierarchy().sort(null).value(null),r=un,a=[1,1],n=null;function i(t,i){var u=e.call(this,t,i),f=u[0],h=o(f);za(h,s),h.parent.m=-h.z;Oa(h,l);if(n)Oa(f,c);else{var p=f,v=f,d=f;Oa(f,(function(e){if(e.x<p.x)p=e;if(e.x>v.x)v=e;if(e.depth>d.depth)d=e}));var m=r(p,v)/2-p.x,g=a[0]/(v.x+r(v,p)/2+m),y=a[1]/(d.depth||1);Oa(f,(function(e){e.x=(e.x+m)*g;e.y=e.depth*y}))}return u}function o(e){var t={A:null,children:[e]},r=[t],a;while((a=r.pop())!=null){for(var n=a.children,i,o=0,s=n.length;o<s;++o){r.push((n[o]=i={_:n[o],parent:a,children:(i=n[o].children)&&i.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:o}).a=i)}}return t.children[0]}function s(e){var t=e.children,a=e.parent.children,n=e.i?a[e.i-1]:null;if(t.length){pn(e);var i=(t[0].z+t[t.length-1].z)/2;if(n){e.z=n.z+r(e._,n._);e.m=e.z-i}else{e.z=i}}else if(n){e.z=n.z+r(e._,n._)}e.parent.A=u(e,n,e.parent.A||a[0])}function l(e){e._.x=e.z+e.parent.m;e.m+=e.parent.m}function u(e,t,a){if(t){var n=e,i=e,o=t,s=n.parent.children[0],l=n.m,u=i.m,c=o.m,f=s.m,h;while(o=fn(o),n=cn(n),o&&n){s=cn(s);i=fn(i);i.a=e;h=o.z+c-n.z-l+r(o._,n._);if(h>0){hn(vn(o,e,a),e,h);l+=h;u+=h}c+=o.m;l+=n.m;f+=s.m;u+=i.m}if(o&&!fn(i)){i.t=o;i.m+=c-u}if(n&&!cn(s)){s.t=n;s.m+=l-f;a=e}}return a}function c(e){e.x*=a[0];e.y=e.depth*a[1]}i.separation=function(e){if(!arguments.length)return r;r=e;return i};i.size=function(e){if(!arguments.length)return n?null:a;n=(a=e)==null?c:null;return i};i.nodeSize=function(e){if(!arguments.length)return n?a:null;n=(a=e)==null?null:c;return i};return Pa(i,e)};function un(e,t){return e.parent==t.parent?1:2}function cn(e){var t=e.children;return t.length?t[0]:e.t}function fn(e){var t=e.children,r;return(r=t.length)?t[r-1]:e.t}function hn(e,t,r){var a=r/(t.i-e.i);t.c-=a;t.s+=r;e.c+=a;t.z+=r;t.m+=r}function pn(e){var t=0,r=0,a=e.children,n=a.length,i;while(--n>=0){i=a[n];i.z+=t;i.m+=t;t+=i.s+(r+=i.c)}}function vn(e,t,r){return e.a.parent===t.parent?e.a:r}t.layout.cluster=function(){var e=t.layout.hierarchy().sort(null).value(null),r=un,a=[1,1],n=false;function i(t,i){var o=e.call(this,t,i),s=o[0],l,u=0;za(s,(function(e){var t=e.children;if(t&&t.length){e.x=mn(t);e.y=dn(t)}else{e.x=l?u+=r(e,l):0;e.y=0;l=e}}));var c=gn(s),f=yn(s),h=c.x-r(c,f)/2,p=f.x+r(f,c)/2;za(s,n?function(e){e.x=(e.x-s.x)*a[0];e.y=(s.y-e.y)*a[1]}:function(e){e.x=(e.x-h)/(p-h)*a[0];e.y=(1-(s.y?e.y/s.y:1))*a[1]});return o}i.separation=function(e){if(!arguments.length)return r;r=e;return i};i.size=function(e){if(!arguments.length)return n?null:a;n=(a=e)==null;return i};i.nodeSize=function(e){if(!arguments.length)return n?a:null;n=(a=e)!=null;return i};return Pa(i,e)};function dn(e){return 1+t.max(e,(function(e){return e.y}))}function mn(e){return e.reduce((function(e,t){return e+t.x}),0)/e.length}function gn(e){var t=e.children;return t&&t.length?gn(t[0]):e}function yn(e){var t=e.children,r;return t&&(r=t.length)?yn(t[r-1]):e}t.layout.treemap=function(){var e=t.layout.hierarchy(),r=Math.round,a=[1,1],n=null,i=xn,o=false,s,l="squarify",u=.5*(1+Math.sqrt(5));function c(e,t){var r=-1,a=e.length,n,i;while(++r<a){i=(n=e[r]).value*(t<0?0:t);n.area=isNaN(i)||i<=0?0:i}}function f(e){var t=e.children;if(t&&t.length){var r=i(e),a=[],n=t.slice(),o,s=Infinity,u,h=l==="slice"?r.dx:l==="dice"?r.dy:l==="slice-dice"?e.depth&1?r.dy:r.dx:Math.min(r.dx,r.dy),d;c(n,r.dx*r.dy/e.value);a.area=0;while((d=n.length)>0){a.push(o=n[d-1]);a.area+=o.area;if(l!=="squarify"||(u=p(a,h))<=s){n.pop();s=u}else{a.area-=a.pop().area;v(a,h,r,false);h=Math.min(r.dx,r.dy);a.length=a.area=0;s=Infinity}}if(a.length){v(a,h,r,true);a.length=a.area=0}t.forEach(f)}}function h(e){var t=e.children;if(t&&t.length){var r=i(e),a=t.slice(),n,o=[];c(a,r.dx*r.dy/e.value);o.area=0;while(n=a.pop()){o.push(n);o.area+=n.area;if(n.z!=null){v(o,n.z?r.dx:r.dy,r,!a.length);o.length=o.area=0}}t.forEach(h)}}function p(e,t){var r=e.area,a,n=0,i=Infinity,o=-1,s=e.length;while(++o<s){if(!(a=e[o].area))continue;if(a<i)i=a;if(a>n)n=a}r*=r;t*=t;return r?Math.max(t*n*u/r,r/(t*i*u)):Infinity}function v(e,t,a,n){var i=-1,o=e.length,s=a.x,l=a.y,u=t?r(e.area/t):0,c;if(t==a.dx){if(n||u>a.dy)u=a.dy;while(++i<o){c=e[i];c.x=s;c.y=l;c.dy=u;s+=c.dx=Math.min(a.x+a.dx-s,u?r(c.area/u):0)}c.z=true;c.dx+=a.x+a.dx-s;a.y+=u;a.dy-=u}else{if(n||u>a.dx)u=a.dx;while(++i<o){c=e[i];c.x=s;c.y=l;c.dx=u;l+=c.dy=Math.min(a.y+a.dy-l,u?r(c.area/u):0)}c.z=false;c.dy+=a.y+a.dy-l;a.x+=u;a.dx-=u}}function d(t){var r=s||e(t),n=r[0];n.x=n.y=0;if(n.value)n.dx=a[0],n.dy=a[1];else n.dx=n.dy=0;if(s)e.revalue(n);c([n],n.dx*n.dy/n.value);(s?h:f)(n);if(o)s=r;return r}d.size=function(e){if(!arguments.length)return a;a=e;return d};d.padding=function(e){if(!arguments.length)return n;function t(t){var r=e.call(d,t,t.depth);return r==null?xn(t):bn(t,typeof r==="number"?[r,r,r,r]:r)}function r(t){return bn(t,e)}var a;i=(n=e)==null?xn:(a=typeof e)==="function"?t:a==="number"?(e=[e,e,e,e],r):r;return d};d.round=function(e){if(!arguments.length)return r!=Number;r=e?Math.round:Number;return d};d.sticky=function(e){if(!arguments.length)return o;o=e;s=null;return d};d.ratio=function(e){if(!arguments.length)return u;u=e;return d};d.mode=function(e){if(!arguments.length)return l;l=e+"";return d};return Pa(d,e)};function xn(e){return{x:e.x,y:e.y,dx:e.dx,dy:e.dy}}function bn(e,t){var r=e.x+t[3],a=e.y+t[0],n=e.dx-t[1]-t[3],i=e.dy-t[0]-t[2];if(n<0){r+=n/2;n=0}if(i<0){a+=i/2;i=0}return{x:r,y:a,dx:n,dy:i}}t.random={normal:function(e,t){var r=arguments.length;if(r<2)t=1;if(r<1)e=0;return function(){var r,a,n;do{r=Math.random()*2-1;a=Math.random()*2-1;n=r*r+a*a}while(!n||n>1);return e+t*r*Math.sqrt(-2*Math.log(n)/n)}},logNormal:function(){var e=t.random.normal.apply(t,arguments);return function(){return Math.exp(e())}},bates:function(e){var r=t.random.irwinHall(e);return function(){return r()/e}},irwinHall:function(e){return function(){for(var t=0,r=0;r<e;r++)t+=Math.random();return t}}};t.scale={};function _n(e){var t=e[0],r=e[e.length-1];return t<r?[t,r]:[r,t]}function wn(e){return e.rangeExtent?e.rangeExtent():_n(e.range())}function Tn(e,t,r,a){var n=r(e[0],e[1]),i=a(t[0],t[1]);return function(e){return i(n(e))}}function kn(e,t){var r=0,a=e.length-1,n=e[r],i=e[a],o;if(i<n){o=r,r=a,a=o;o=n,n=i,i=o}e[r]=t.floor(n);e[a]=t.ceil(i);return e}function Mn(e){return e?{floor:function(t){return Math.floor(t/e)*e},ceil:function(t){return Math.ceil(t/e)*e}}:An}var An={floor:O,ceil:O};function Sn(e,r,a,n){var i=[],o=[],s=0,l=Math.min(e.length,r.length)-1;if(e[l]<e[0]){e=e.slice().reverse();r=r.slice().reverse()}while(++s<=l){i.push(a(e[s-1],e[s]));o.push(n(r[s-1],r[s]))}return function(r){var a=t.bisect(e,r,1,l)-1;return o[a](i[a](r))}}t.scale.linear=function(){return En([0,1],[0,1],jr,false)};function En(e,t,r,a){var n,i;function o(){var o=Math.min(e.length,t.length)>2?Sn:Tn,l=a?ba:xa;n=o(e,t,l,r);i=o(t,e,l,jr);return s}function s(e){return n(e)}s.invert=function(e){return i(e)};s.domain=function(t){if(!arguments.length)return e;e=t.map(Number);return o()};s.range=function(e){if(!arguments.length)return t;t=e;return o()};s.rangeRound=function(e){return s.range(e).interpolate(sa)};s.clamp=function(e){if(!arguments.length)return a;a=e;return o()};s.interpolate=function(e){if(!arguments.length)return r;r=e;return o()};s.ticks=function(t){return Pn(e,t)};s.tickFormat=function(t,r){return d3_scale_linearTickFormat(e,t,r)};s.nice=function(t){Cn(e,t);return o()};s.copy=function(){return En(e,t,r,a)};return o()}function Ln(e,r){return t.rebind(e,r,"range","rangeRound","interpolate","clamp")}function Cn(e,t){kn(e,Mn(In(e,t)[2]));kn(e,Mn(In(e,t)[2]));return e}function In(e,t){if(t==null)t=10;var r=_n(e),a=r[1]-r[0],n=Math.pow(10,Math.floor(Math.log(a/t)/Math.LN10)),i=t/a*n;if(i<=.15)n*=10;else if(i<=.35)n*=5;else if(i<=.75)n*=2;r[0]=Math.ceil(r[0]/n)*n;r[1]=Math.floor(r[1]/n)*n+n*.5;r[2]=n;return r}function Pn(e,r){return t.range.apply(t,In(e,r))}var On={s:1,g:1,p:1,r:1,e:1};function zn(e){return-Math.floor(Math.log(e)/Math.LN10+.01)}function Dn(e,t){var r=zn(t[2]);return e in On?Math.abs(r-zn(Math.max(x(t[0]),x(t[1]))))+ +(e!=="e"):r-(e==="%")*2}t.scale.log=function(){return Rn(t.scale.linear().domain([0,1]),10,true,[1,10])};function Rn(e,t,r,a){function n(e){return(r?Math.log(e<0?0:e):-Math.log(e>0?0:-e))/Math.log(t)}function i(e){return r?Math.pow(t,e):-Math.pow(t,-e)}function o(t){return e(n(t))}o.invert=function(t){return i(e.invert(t))};o.domain=function(t){if(!arguments.length)return a;r=t[0]>=0;e.domain((a=t.map(Number)).map(n));return o};o.base=function(r){if(!arguments.length)return t;t=+r;e.domain(a.map(n));return o};o.nice=function(){var t=kn(a.map(n),r?Math:Fn);e.domain(t);a=t.map(i);return o};o.ticks=function(){var e=_n(a),o=[],s=e[0],l=e[1],u=Math.floor(n(s)),c=Math.ceil(n(l)),f=t%1?2:t;if(isFinite(c-u)){if(r){for(;u<c;u++)for(var h=1;h<f;h++)o.push(i(u)*h);o.push(i(u))}else{o.push(i(u));for(;u++<c;)for(var h=f-1;h>0;h--)o.push(i(u)*h)}for(u=0;o[u]<s;u++){}for(c=o.length;o[c-1]>l;c--){}o=o.slice(u,c)}return o};o.copy=function(){return Rn(e.copy(),t,r,a)};return Ln(o,e)}var Fn={floor:function(e){return-Math.ceil(-e)},ceil:function(e){return-Math.floor(-e)}};t.scale.pow=function(){return Bn(t.scale.linear(),1,[0,1])};function Bn(e,t,r){var a=Nn(t),n=Nn(1/t);function i(t){return e(a(t))}i.invert=function(t){return n(e.invert(t))};i.domain=function(t){if(!arguments.length)return r;e.domain((r=t.map(Number)).map(a));return i};i.ticks=function(e){return Pn(r,e)};i.tickFormat=function(e,t){return d3_scale_linearTickFormat(r,e,t)};i.nice=function(e){return i.domain(Cn(r,e))};i.exponent=function(o){if(!arguments.length)return t;a=Nn(t=o);n=Nn(1/t);e.domain(r.map(a));return i};i.copy=function(){return Bn(e.copy(),t,r)};return Ln(i,e)}function Nn(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}t.scale.sqrt=function(){return t.scale.pow().exponent(.5)};t.scale.ordinal=function(){return jn([],{t:"range",a:[[]]})};function jn(e,r){var a,n,i;function o(t){return n[((a.get(t)||(r.t==="range"?a.set(t,e.push(t)):NaN))-1)%n.length]}function s(r,a){return t.range(e.length).map((function(e){return r+a*e}))}o.domain=function(t){if(!arguments.length)return e;e=[];a=new w;var n=-1,i=t.length,s;while(++n<i)if(!a.has(s=t[n]))a.set(s,e.push(s));return o[r.t].apply(o,r.a)};o.range=function(e){if(!arguments.length)return n;n=e;i=0;r={t:"range",a:arguments};return o};o.rangePoints=function(t,a){if(arguments.length<2)a=0;var l=t[0],u=t[1],c=e.length<2?(l=(l+u)/2,0):(u-l)/(e.length-1+a);n=s(l+c*a/2,c);i=0;r={t:"rangePoints",a:arguments};return o};o.rangeRoundPoints=function(t,a){if(arguments.length<2)a=0;var l=t[0],u=t[1],c=e.length<2?(l=u=Math.round((l+u)/2),0):(u-l)/(e.length-1+a)|0;n=s(l+Math.round(c*a/2+(u-l-(e.length-1+a)*c)/2),c);i=0;r={t:"rangeRoundPoints",a:arguments};return o};o.rangeBands=function(t,a,l){if(arguments.length<2)a=0;if(arguments.length<3)l=a;var u=t[1]<t[0],c=t[u-0],f=t[1-u],h=(f-c)/(e.length-a+2*l);n=s(c+h*l,h);if(u)n.reverse();i=h*(1-a);r={t:"rangeBands",a:arguments};return o};o.rangeRoundBands=function(t,a,l){if(arguments.length<2)a=0;if(arguments.length<3)l=a;var u=t[1]<t[0],c=t[u-0],f=t[1-u],h=Math.floor((f-c)/(e.length-a+2*l));n=s(c+Math.round((f-c-(e.length-a)*h)/2),h);if(u)n.reverse();i=Math.round(h*(1-a));r={t:"rangeRoundBands",a:arguments};return o};o.rangeBand=function(){return i};o.rangeExtent=function(){return _n(r.a[0])};o.copy=function(){return jn(e,r)};return o.domain(e)}t.scale.category10=function(){return t.scale.ordinal().range(Un)};t.scale.category20=function(){return t.scale.ordinal().range(Vn)};t.scale.category20b=function(){return t.scale.ordinal().range(Hn)};t.scale.category20c=function(){return t.scale.ordinal().range(qn)};var Un=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(dt);var Vn=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(dt);var Hn=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(dt);var qn=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(dt);t.scale.quantile=function(){return Gn([],[])};function Gn(e,r){var a;function n(){var n=0,o=r.length;a=[];while(++n<o)a[n-1]=t.quantile(e,n/o);return i}function i(e){if(!isNaN(e=+e))return r[t.bisect(a,e)]}i.domain=function(t){if(!arguments.length)return e;e=t.map(v).filter(d).sort(p);return n()};i.range=function(e){if(!arguments.length)return r;r=e;return n()};i.quantiles=function(){return a};i.invertExtent=function(t){t=r.indexOf(t);return t<0?[NaN,NaN]:[t>0?a[t-1]:e[0],t<a.length?a[t]:e[e.length-1]]};i.copy=function(){return Gn(e,r)};return n()}t.scale.quantize=function(){return Yn(0,1,[0,1])};function Yn(e,t,r){var a,n;function i(t){return r[Math.max(0,Math.min(n,Math.floor(a*(t-e))))]}function o(){a=r.length/(t-e);n=r.length-1;return i}i.domain=function(r){if(!arguments.length)return[e,t];e=+r[0];t=+r[r.length-1];return o()};i.range=function(e){if(!arguments.length)return r;r=e;return o()};i.invertExtent=function(t){t=r.indexOf(t);t=t<0?NaN:t/a+e;return[t,t+1/a]};i.copy=function(){return Yn(e,t,r)};return o()}t.scale.threshold=function(){return Wn([.5],[0,1])};function Wn(e,r){function a(a){if(a<=a)return r[t.bisect(e,a)]}a.domain=function(t){if(!arguments.length)return e;e=t;return a};a.range=function(e){if(!arguments.length)return r;r=e;return a};a.invertExtent=function(t){t=r.indexOf(t);return[e[t-1],e[t]]};a.copy=function(){return Wn(e,r)};return a}t.scale.identity=function(){return Xn([0,1])};function Xn(e){function t(e){return+e}t.invert=t;t.domain=t.range=function(r){if(!arguments.length)return e;e=r.map(t);return t};t.ticks=function(t){return Pn(e,t)};t.tickFormat=function(t,r){return d3_scale_linearTickFormat(e,t,r)};t.copy=function(){return Xn(e)};return t}t.svg={};function Zn(){return 0}t.svg.arc=function(){var e=Kn,t=Qn,r=Zn,a=Jn,n=$n,i=ei,o=ti;function s(){var s=Math.max(0,+e.apply(this,arguments)),u=Math.max(0,+t.apply(this,arguments)),c=n.apply(this,arguments)-Pe,f=i.apply(this,arguments)-Pe,h=Math.abs(f-c),p=c>f?0:1;if(u<s)v=u,u=s,s=v;if(h>=Ie)return l(u,p)+(s?l(s,1-p):"")+"Z";var v,d,m,g,y=0,x=0,b,_,w,T,k,M,A,S,E=[];if(g=(+o.apply(this,arguments)||0)/2){m=a===Jn?Math.sqrt(s*s+u*u):+a.apply(this,arguments);if(!p)x*=-1;if(u)x=Be(m/u*Math.sin(g));if(s)y=Be(m/s*Math.sin(g))}if(u){b=u*Math.cos(c+x);_=u*Math.sin(c+x);w=u*Math.cos(f-x);T=u*Math.sin(f-x);var L=Math.abs(f-c-2*x)<=Le?0:1;if(x&&ri(b,_,w,T)===p^L){var C=(c+f)/2;b=u*Math.cos(C);_=u*Math.sin(C);w=T=null}}else{b=_=0}if(s){k=s*Math.cos(f-y);M=s*Math.sin(f-y);A=s*Math.cos(c+y);S=s*Math.sin(c+y);var I=Math.abs(c-f+2*y)<=Le?0:1;if(y&&ri(k,M,A,S)===1-p^I){var P=(c+f)/2;k=s*Math.cos(P);M=s*Math.sin(P);A=S=null}}else{k=M=0}if(h>Se&&(v=Math.min(Math.abs(u-s)/2,+r.apply(this,arguments)))>.001){d=s<u^p?0:1;var O=v,z=v;if(h<Le){var D=A==null?[k,M]:w==null?[b,_]:qt([b,_],[A,S],[w,T],[k,M]),R=b-D[0],F=_-D[1],B=w-D[0],N=T-D[1],j=1/Math.sin(Math.acos((R*B+F*N)/(Math.sqrt(R*R+F*F)*Math.sqrt(B*B+N*N)))/2),U=Math.sqrt(D[0]*D[0]+D[1]*D[1]);z=Math.min(v,(s-U)/(j-1));O=Math.min(v,(u-U)/(j+1))}if(w!=null){var V=ai(A==null?[k,M]:[A,S],[b,_],u,O,p),H=ai([w,T],[k,M],u,O,p);if(v===O){E.push("M",V[0],"A",O,",",O," 0 0,",d," ",V[1],"A",u,",",u," 0 ",1-p^ri(V[1][0],V[1][1],H[1][0],H[1][1]),",",p," ",H[1],"A",O,",",O," 0 0,",d," ",H[0])}else{E.push("M",V[0],"A",O,",",O," 0 1,",d," ",H[0])}}else{E.push("M",b,",",_)}if(A!=null){var q=ai([b,_],[A,S],s,-z,p),G=ai([k,M],w==null?[b,_]:[w,T],s,-z,p);if(v===z){E.push("L",G[0],"A",z,",",z," 0 0,",d," ",G[1],"A",s,",",s," 0 ",p^ri(G[1][0],G[1][1],q[1][0],q[1][1]),",",1-p," ",q[1],"A",z,",",z," 0 0,",d," ",q[0])}else{E.push("L",G[0],"A",z,",",z," 0 0,",d," ",q[0])}}else{E.push("L",k,",",M)}}else{E.push("M",b,",",_);if(w!=null)E.push("A",u,",",u," 0 ",L,",",p," ",w,",",T);E.push("L",k,",",M);if(A!=null)E.push("A",s,",",s," 0 ",I,",",1-p," ",A,",",S)}E.push("Z");return E.join("")}function l(e,t){return"M0,"+e+"A"+e+","+e+" 0 1,"+t+" 0,"+-e+"A"+e+","+e+" 0 1,"+t+" 0,"+e}s.innerRadius=function(t){if(!arguments.length)return e;e=kt(t);return s};s.outerRadius=function(e){if(!arguments.length)return t;t=kt(e);return s};s.cornerRadius=function(e){if(!arguments.length)return r;r=kt(e);return s};s.padRadius=function(e){if(!arguments.length)return a;a=e==Jn?Jn:kt(e);return s};s.startAngle=function(e){if(!arguments.length)return n;n=kt(e);return s};s.endAngle=function(e){if(!arguments.length)return i;i=kt(e);return s};s.padAngle=function(e){if(!arguments.length)return o;o=kt(e);return s};s.centroid=function(){var r=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,a=(+n.apply(this,arguments)+ +i.apply(this,arguments))/2-Pe;return[Math.cos(a)*r,Math.sin(a)*r]};return s};var Jn="auto";function Kn(e){return e.innerRadius}function Qn(e){return e.outerRadius}function $n(e){return e.startAngle}function ei(e){return e.endAngle}function ti(e){return e&&e.padAngle}function ri(e,t,r,a){return(e-r)*t-(t-a)*e>0?0:1}function ai(e,t,r,a,n){var i=e[0]-t[0],o=e[1]-t[1],s=(n?a:-a)/Math.sqrt(i*i+o*o),l=s*o,u=-s*i,c=e[0]+l,f=e[1]+u,h=t[0]+l,p=t[1]+u,v=(c+h)/2,d=(f+p)/2,m=h-c,g=p-f,y=m*m+g*g,x=r-a,b=c*p-h*f,_=(g<0?-1:1)*Math.sqrt(Math.max(0,x*x*y-b*b)),w=(b*g-m*_)/y,T=(-b*m-g*_)/y,k=(b*g+m*_)/y,M=(-b*m+g*_)/y,A=w-v,S=T-d,E=k-v,L=M-d;if(A*A+S*S>E*E+L*L)w=k,T=M;return[[w-l,T-u],[w*r/x,T*r/x]]}function ni(){return true}function ii(e){var t=Bt,r=Nt,a=ni,n=si,i=n.key,o=.7;function s(i){var s=[],l=[],u=-1,c=i.length,f,h=kt(t),p=kt(r);function v(){s.push("M",n(e(l),o))}while(++u<c){if(a.call(this,f=i[u],u)){l.push([+h.call(this,f,u),+p.call(this,f,u)])}else if(l.length){v();l=[]}}if(l.length)v();return s.length?s.join(""):null}s.x=function(e){if(!arguments.length)return t;t=e;return s};s.y=function(e){if(!arguments.length)return r;r=e;return s};s.defined=function(e){if(!arguments.length)return a;a=e;return s};s.interpolate=function(e){if(!arguments.length)return i;if(typeof e==="function")i=n=e;else i=(n=oi.get(e)||si).key;return s};s.tension=function(e){if(!arguments.length)return o;o=e;return s};return s}t.svg.line=function(){return ii(O)};var oi=t.map({linear:si,"linear-closed":li,step:ui,"step-before":ci,"step-after":fi,basis:gi,"basis-open":yi,"basis-closed":xi,bundle:bi,cardinal:vi,"cardinal-open":hi,"cardinal-closed":pi,monotone:Li});oi.forEach((function(e,t){t.key=e;t.closed=/-closed$/.test(e)}));function si(e){return e.length>1?e.join("L"):e+"Z"}function li(e){return e.join("L")+"Z"}function ui(e){var t=0,r=e.length,a=e[0],n=[a[0],",",a[1]];while(++t<r)n.push("H",(a[0]+(a=e[t])[0])/2,"V",a[1]);if(r>1)n.push("H",a[0]);return n.join("")}function ci(e){var t=0,r=e.length,a=e[0],n=[a[0],",",a[1]];while(++t<r)n.push("V",(a=e[t])[1],"H",a[0]);return n.join("")}function fi(e){var t=0,r=e.length,a=e[0],n=[a[0],",",a[1]];while(++t<r)n.push("H",(a=e[t])[0],"V",a[1]);return n.join("")}function hi(e,t){return e.length<4?si(e):e[1]+di(e.slice(1,-1),mi(e,t))}function pi(e,t){return e.length<3?li(e):e[0]+di((e.push(e[0]),e),mi([e[e.length-2]].concat(e,[e[1]]),t))}function vi(e,t){return e.length<3?si(e):e[0]+di(e,mi(e,t))}function di(e,t){if(t.length<1||e.length!=t.length&&e.length!=t.length+2){return si(e)}var r=e.length!=t.length,a="",n=e[0],i=e[1],o=t[0],s=o,l=1;if(r){a+="Q"+(i[0]-o[0]*2/3)+","+(i[1]-o[1]*2/3)+","+i[0]+","+i[1];n=e[1];l=2}if(t.length>1){s=t[1];i=e[l];l++;a+="C"+(n[0]+o[0])+","+(n[1]+o[1])+","+(i[0]-s[0])+","+(i[1]-s[1])+","+i[0]+","+i[1];for(var u=2;u<t.length;u++,l++){i=e[l];s=t[u];a+="S"+(i[0]-s[0])+","+(i[1]-s[1])+","+i[0]+","+i[1]}}if(r){var c=e[l];a+="Q"+(i[0]+s[0]*2/3)+","+(i[1]+s[1]*2/3)+","+c[0]+","+c[1]}return a}function mi(e,t){var r=[],a=(1-t)/2,n,i=e[0],o=e[1],s=1,l=e.length;while(++s<l){n=i;i=o;o=e[s];r.push([a*(o[0]-n[0]),a*(o[1]-n[1])])}return r}function gi(e){if(e.length<3)return si(e);var t=1,r=e.length,a=e[0],n=a[0],i=a[1],o=[n,n,n,(a=e[1])[0]],s=[i,i,i,a[1]],l=[n,",",i,"L",_i(ki,o),",",_i(ki,s)];e.push(e[r-1]);while(++t<=r){a=e[t];o.shift();o.push(a[0]);s.shift();s.push(a[1]);Mi(l,o,s)}e.pop();l.push("L",a);return l.join("")}function yi(e){if(e.length<4)return si(e);var t=[],r=-1,a=e.length,n,i=[0],o=[0];while(++r<3){n=e[r];i.push(n[0]);o.push(n[1])}t.push(_i(ki,i)+","+_i(ki,o));--r;while(++r<a){n=e[r];i.shift();i.push(n[0]);o.shift();o.push(n[1]);Mi(t,i,o)}return t.join("")}function xi(e){var t,r=-1,a=e.length,n=a+4,i,o=[],s=[];while(++r<4){i=e[r%a];o.push(i[0]);s.push(i[1])}t=[_i(ki,o),",",_i(ki,s)];--r;while(++r<n){i=e[r%a];o.shift();o.push(i[0]);s.shift();s.push(i[1]);Mi(t,o,s)}return t.join("")}function bi(e,t){var r=e.length-1;if(r){var a=e[0][0],n=e[0][1],i=e[r][0]-a,o=e[r][1]-n,s=-1,l,u;while(++s<=r){l=e[s];u=s/r;l[0]=t*l[0]+(1-t)*(a+u*i);l[1]=t*l[1]+(1-t)*(n+u*o)}}return gi(e)}function _i(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}var wi=[0,2/3,1/3,0],Ti=[0,1/3,2/3,0],ki=[0,1/6,2/3,1/6];function Mi(e,t,r){e.push("C",_i(wi,t),",",_i(wi,r),",",_i(Ti,t),",",_i(Ti,r),",",_i(ki,t),",",_i(ki,r))}function Ai(e,t){return(t[1]-e[1])/(t[0]-e[0])}function Si(e){var t=0,r=e.length-1,a=[],n=e[0],i=e[1],o=a[0]=Ai(n,i);while(++t<r){a[t]=(o+(o=Ai(n=i,i=e[t+1])))/2}a[t]=o;return a}function Ei(e){var t=[],r,a,n,i,o=Si(e),s=-1,l=e.length-1;while(++s<l){r=Ai(e[s],e[s+1]);if(x(r)<Se){o[s]=o[s+1]=0}else{a=o[s]/r;n=o[s+1]/r;i=a*a+n*n;if(i>9){i=r*3/Math.sqrt(i);o[s]=i*a;o[s+1]=i*n}}}s=-1;while(++s<=l){i=(e[Math.min(l,s+1)][0]-e[Math.max(0,s-1)][0])/(6*(1+o[s]*o[s]));t.push([i||0,o[s]*i||0])}return t}function Li(e){return e.length<3?si(e):e[0]+di(e,Ei(e))}t.svg.line.radial=function(){var e=ii(Ci);e.radius=e.x,delete e.x;e.angle=e.y,delete e.y;return e};function Ci(e){var t,r=-1,a=e.length,n,i;while(++r<a){t=e[r];n=t[0];i=t[1]-Pe;t[0]=n*Math.cos(i);t[1]=n*Math.sin(i)}return e}function Ii(e){var t=Bt,r=Bt,a=0,n=Nt,i=ni,o=si,s=o.key,l=o,u="L",c=.7;function f(s){var f=[],h=[],p=[],v=-1,d=s.length,m,g=kt(t),y=kt(a),x=t===r?function(){return _}:kt(r),b=a===n?function(){return w}:kt(n),_,w;function T(){f.push("M",o(e(p),c),u,l(e(h.reverse()),c),"Z")}while(++v<d){if(i.call(this,m=s[v],v)){h.push([_=+g.call(this,m,v),w=+y.call(this,m,v)]);p.push([+x.call(this,m,v),+b.call(this,m,v)])}else if(h.length){T();h=[];p=[]}}if(h.length)T();return f.length?f.join(""):null}f.x=function(e){if(!arguments.length)return r;t=r=e;return f};f.x0=function(e){if(!arguments.length)return t;t=e;return f};f.x1=function(e){if(!arguments.length)return r;r=e;return f};f.y=function(e){if(!arguments.length)return n;a=n=e;return f};f.y0=function(e){if(!arguments.length)return a;a=e;return f};f.y1=function(e){if(!arguments.length)return n;n=e;return f};f.defined=function(e){if(!arguments.length)return i;i=e;return f};f.interpolate=function(e){if(!arguments.length)return s;if(typeof e==="function")s=o=e;else s=(o=oi.get(e)||si).key;l=o.reverse||o;u=o.closed?"M":"L";return f};f.tension=function(e){if(!arguments.length)return c;c=e;return f};return f}ci.reverse=fi;fi.reverse=ci;t.svg.area=function(){return Ii(O)};t.svg.area.radial=function(){var e=Ii(Ci);e.radius=e.x,delete e.x;e.innerRadius=e.x0,delete e.x0;e.outerRadius=e.x1,delete e.x1;e.angle=e.y,delete e.y;e.startAngle=e.y0,delete e.y0;e.endAngle=e.y1,delete e.y1;return e};function Pi(e){return e.source}function Oi(e){return e.target}t.svg.chord=function(){var e=Pi,t=Oi,r=zi,a=$n,n=ei;function i(r,a){var n=o(this,e,r,a),i=o(this,t,r,a);return"M"+n.p0+l(n.r,n.p1,n.a1-n.a0)+(s(n,i)?u(n.r,n.p1,n.r,n.p0):u(n.r,n.p1,i.r,i.p0)+l(i.r,i.p1,i.a1-i.a0)+u(i.r,i.p1,n.r,n.p0))+"Z"}function o(e,t,i,o){var s=t.call(e,i,o),l=r.call(e,s,o),u=a.call(e,s,o)-Pe,c=n.call(e,s,o)-Pe;return{r:l,a0:u,a1:c,p0:[l*Math.cos(u),l*Math.sin(u)],p1:[l*Math.cos(c),l*Math.sin(c)]}}function s(e,t){return e.a0==t.a0&&e.a1==t.a1}function l(e,t,r){return"A"+e+","+e+" 0 "+ +(r>Le)+",1 "+t}function u(e,t,r,a){return"Q 0,0 "+a}i.radius=function(e){if(!arguments.length)return r;r=kt(e);return i};i.source=function(t){if(!arguments.length)return e;e=kt(t);return i};i.target=function(e){if(!arguments.length)return t;t=kt(e);return i};i.startAngle=function(e){if(!arguments.length)return a;a=kt(e);return i};i.endAngle=function(e){if(!arguments.length)return n;n=kt(e);return i};return i};function zi(e){return e.radius}t.svg.diagonal=function(){var e=Pi,t=Oi,r=Di;function a(a,n){var i=e.call(this,a,n),o=t.call(this,a,n),s=(i.y+o.y)/2,l=[i,{x:i.x,y:s},{x:o.x,y:s},o];l=l.map(r);return"M"+l[0]+"C"+l[1]+" "+l[2]+" "+l[3]}a.source=function(t){if(!arguments.length)return e;e=kt(t);return a};a.target=function(e){if(!arguments.length)return t;t=kt(e);return a};a.projection=function(e){if(!arguments.length)return r;r=e;return a};return a};function Di(e){return[e.x,e.y]}t.svg.diagonal.radial=function(){var e=t.svg.diagonal(),r=Di,a=e.projection;e.projection=function(e){return arguments.length?a(Ri(r=e)):r};return e};function Ri(e){return function(){var t=e.apply(this,arguments),r=t[0],a=t[1]-Pe;return[r*Math.cos(a),r*Math.sin(a)]}}t.svg.symbol=function(){var e=Bi,t=Fi;function r(r,a){return(ji.get(e.call(this,r,a))||Ni)(t.call(this,r,a))}r.type=function(t){if(!arguments.length)return e;e=kt(t);return r};r.size=function(e){if(!arguments.length)return t;t=kt(e);return r};return r};function Fi(){return 64}function Bi(){return"circle"}function Ni(e){var t=Math.sqrt(e/Le);return"M0,"+t+"A"+t+","+t+" 0 1,1 0,"+-t+"A"+t+","+t+" 0 1,1 0,"+t+"Z"}var ji=t.map({circle:Ni,cross:function(e){var t=Math.sqrt(e/5)/2;return"M"+-3*t+","+-t+"H"+-t+"V"+-3*t+"H"+t+"V"+-t+"H"+3*t+"V"+t+"H"+t+"V"+3*t+"H"+-t+"V"+t+"H"+-3*t+"Z"},diamond:function(e){var t=Math.sqrt(e/(2*Vi)),r=t*Vi;return"M0,"+-t+"L"+r+",0"+" 0,"+t+" "+-r+",0"+"Z"},square:function(e){var t=Math.sqrt(e)/2;return"M"+-t+","+-t+"L"+t+","+-t+" "+t+","+t+" "+-t+","+t+"Z"},"triangle-down":function(e){var t=Math.sqrt(e/Ui),r=t*Ui/2;return"M0,"+r+"L"+t+","+-r+" "+-t+","+-r+"Z"},"triangle-up":function(e){var t=Math.sqrt(e/Ui),r=t*Ui/2;return"M0,"+-r+"L"+t+","+r+" "+-t+","+r+"Z"}});t.svg.symbolTypes=ji.keys();var Ui=Math.sqrt(3),Vi=Math.tan(30*Oe);Z.transition=function(e){var t=Xi||++Wi,r=Qi(e),a=[],n,i,o=Zi||{time:Date.now(),ease:Jr,delay:0,duration:250};for(var s=-1,l=this.length;++s<l;){a.push(n=[]);for(var u=this[s],c=-1,f=u.length;++c<f;){if(i=u[c])$i(i,c,r,t,o);n.push(i)}}return Gi(a,r,t)};Z.interrupt=function(e){return this.each(e==null?Hi:qi(Qi(e)))};var Hi=qi(Qi());function qi(e){return function(){var t,r,a;if((t=this[e])&&(a=t[r=t.active])){a.timer.c=null;a.timer.t=NaN;if(--t.count)delete t[r];else delete this[e];t.active+=.5;a.event&&a.event.interrupt.call(this,this.__data__,a.index)}}}function Gi(e,t,r){q(e,Yi);e.namespace=t;e.id=r;return e}var Yi=[],Wi=0,Xi,Zi;Yi.call=Z.call;Yi.empty=Z.empty;Yi.node=Z.node;Yi.size=Z.size;t.transition=function(e,r){return e&&e.transition?Xi?e.transition(r):e:t.selection().transition(e)};t.transition.prototype=Yi;Yi.select=function(e){var t=this.id,r=this.namespace,a=[],n,i,o;e=J(e);for(var s=-1,l=this.length;++s<l;){a.push(n=[]);for(var u=this[s],c=-1,f=u.length;++c<f;){if((o=u[c])&&(i=e.call(o,o.__data__,c,s))){if("__data__"in o)i.__data__=o.__data__;$i(i,c,r,t,o[r][t]);n.push(i)}else{n.push(null)}}}return Gi(a,r,t)};Yi.selectAll=function(e){var t=this.id,r=this.namespace,a=[],n,i,o,s,l;e=K(e);for(var u=-1,c=this.length;++u<c;){for(var f=this[u],h=-1,p=f.length;++h<p;){if(o=f[h]){l=o[r][t];i=e.call(o,o.__data__,h,u);a.push(n=[]);for(var v=-1,d=i.length;++v<d;){if(s=i[v])$i(s,v,r,t,l);n.push(s)}}}}return Gi(a,r,t)};Yi.filter=function(e){var t=[],r,a,n;if(typeof e!=="function")e=fe(e);for(var i=0,o=this.length;i<o;i++){t.push(r=[]);for(var a=this[i],s=0,l=a.length;s<l;s++){if((n=a[s])&&e.call(n,n.__data__,s,i)){r.push(n)}}}return Gi(t,this.namespace,this.id)};Yi.tween=function(e,t){var r=this.id,a=this.namespace;if(arguments.length<2)return this.node()[a][r].tween.get(e);return pe(this,t==null?function(t){t[a][r].tween.remove(e)}:function(n){n[a][r].tween.set(e,t)})};function Ji(e,t,r,a){var n=e.id,i=e.namespace;return pe(e,typeof r==="function"?function(e,o,s){e[i][n].tween.set(t,a(r.call(e,e.__data__,o,s)))}:(r=a(r),function(e){e[i][n].tween.set(t,r)}))}Yi.attr=function(e,r){if(arguments.length<2){for(r in e)this.attr(r,e[r]);return this}var a=e=="transform"?ya:jr,n=t.ns.qualify(e);function i(){this.removeAttribute(n)}function o(){this.removeAttributeNS(n.space,n.local)}function s(e){return e==null?i:(e+="",function(){var t=this.getAttribute(n),r;return t!==e&&(r=a(t,e),function(e){this.setAttribute(n,r(e))})})}function l(e){return e==null?o:(e+="",function(){var t=this.getAttributeNS(n.space,n.local),r;return t!==e&&(r=a(t,e),function(e){this.setAttributeNS(n.space,n.local,r(e))})})}return Ji(this,"attr."+e,r,n.local?l:s)};Yi.attrTween=function(e,r){var a=t.ns.qualify(e);function n(e,t){var n=r.call(this,e,t,this.getAttribute(a));return n&&function(e){this.setAttribute(a,n(e))}}function i(e,t){var n=r.call(this,e,t,this.getAttributeNS(a.space,a.local));return n&&function(e){this.setAttributeNS(a.space,a.local,n(e))}}return this.tween("attr."+e,a.local?i:n)};Yi.style=function(e,t,r){var a=arguments.length;if(a<3){if(typeof e!=="string"){if(a<2)t="";for(r in e)this.style(r,e[r],t);return this}r=""}function n(){this.style.removeProperty(e)}function i(t){return t==null?n:(t+="",function(){var a=s(this).getComputedStyle(this,null).getPropertyValue(e),n;return a!==t&&(n=jr(a,t),function(t){this.style.setProperty(e,n(t),r)})})}return Ji(this,"style."+e,t,i)};Yi.styleTween=function(e,t,r){if(arguments.length<3)r="";function a(a,n){var i=t.call(this,a,n,s(this).getComputedStyle(this,null).getPropertyValue(e));return i&&function(t){this.style.setProperty(e,i(t),r)}}return this.tween("style."+e,a)};Yi.text=function(e){return Ji(this,"text",e,Ki)};function Ki(e){if(e==null)e="";return function(){this.textContent=e}}Yi.remove=function(){var e=this.namespace;return this.each("end.transition",(function(){var t;if(this[e].count<2&&(t=this.parentNode))t.removeChild(this)}))};Yi.ease=function(e){var r=this.id,a=this.namespace;if(arguments.length<1)return this.node()[a][r].ease;if(typeof e!=="function")e=t.ease.apply(t,arguments);return pe(this,(function(t){t[a][r].ease=e}))};Yi.delay=function(e){var t=this.id,r=this.namespace;if(arguments.length<1)return this.node()[r][t].delay;return pe(this,typeof e==="function"?function(a,n,i){a[r][t].delay=+e.call(a,a.__data__,n,i)}:(e=+e,function(a){a[r][t].delay=e}))};Yi.duration=function(e){var t=this.id,r=this.namespace;if(arguments.length<1)return this.node()[r][t].duration;return pe(this,typeof e==="function"?function(a,n,i){a[r][t].duration=Math.max(1,e.call(a,a.__data__,n,i))}:(e=Math.max(1,e),function(a){a[r][t].duration=e}))};Yi.each=function(e,r){var a=this.id,n=this.namespace;if(arguments.length<2){var i=Zi,o=Xi;try{Xi=a;pe(this,(function(t,r,i){Zi=t[n][a];e.call(t,t.__data__,r,i)}))}finally{Zi=i;Xi=o}}else{pe(this,(function(i){var o=i[n][a];(o.event||(o.event=t.dispatch("start","end","interrupt"))).on(e,r)}))}return this};Yi.transition=function(){var e=this.id,t=++Wi,r=this.namespace,a=[],n,i,o,s;for(var l=0,u=this.length;l<u;l++){a.push(n=[]);for(var i=this[l],c=0,f=i.length;c<f;c++){if(o=i[c]){s=o[r][e];$i(o,c,r,t,{time:s.time,ease:s.ease,delay:s.delay+s.duration,duration:s.duration})}n.push(o)}}return Gi(a,r,t)};function Qi(e){return e==null?"__transition__":"__transition_"+e+"__"}function $i(e,t,r,a,n){var i=e[r]||(e[r]={active:0,count:0}),o=i[a],s,l,u,c,f;function h(e){var t=o.delay;l.t=t+s;if(t<=e)return p(e-t);l.c=p}function p(r){var n=i.active,h=i[n];if(h){h.timer.c=null;h.timer.t=NaN;--i.count;delete i[n];h.event&&h.event.interrupt.call(e,e.__data__,h.index)}for(var p in i){if(+p<a){var d=i[p];d.timer.c=null;d.timer.t=NaN;--i.count;delete i[p]}}l.c=v;zt((function(){if(l.c&&v(r||1)){l.c=null;l.t=NaN}return 1}),0,s);i.active=a;o.event&&o.event.start.call(e,e.__data__,t);f=[];o.tween.forEach((function(r,a){if(a=a.call(e,e.__data__,t)){f.push(a)}}));c=o.ease;u=o.duration}function v(n){var s=n/u,l=c(s),h=f.length;while(h>0){f[--h].call(e,l)}if(s>=1){o.event&&o.event.end.call(e,e.__data__,t);if(--i.count)delete i[a];else delete e[r];return 1}}if(!o){s=n.time;l=zt(h,0,s);o=i[a]={tween:new w,time:s,timer:l,delay:n.delay,duration:n.duration,ease:n.ease,index:t};n=null;++i.count}}t.svg.axis=function(){var e=t.scale.linear(),r=eo,a=6,i=6,o=3,s=[10],l=null,u;function c(n){n.each((function(){var n=t.select(this);var c=this.__chart__||e,f=this.__chart__=e.copy();var h=l==null?f.ticks?f.ticks.apply(f,s):f.domain():l,p=u==null?f.tickFormat?f.tickFormat.apply(f,s):O:u,v=n.selectAll(".tick").data(h,f),d=v.enter().insert("g",".domain").attr("class","tick").style("opacity",Se),m=t.transition(v.exit()).style("opacity",Se).remove(),g=t.transition(v.order()).style("opacity",1),y=Math.max(a,0)+o,x;var b=wn(f),_=n.selectAll(".domain").data([0]),w=(_.enter().append("path").attr("class","domain"),t.transition(_));d.append("line");d.append("text");var T=d.select("line"),k=g.select("line"),M=v.select("text").text(p),A=d.select("text"),S=g.select("text"),E=r==="top"||r==="left"?-1:1,L,C,I,P;if(r==="bottom"||r==="top"){x=ro,L="x",I="y",C="x2",P="y2";M.attr("dy",E<0?"0em":".71em").style("text-anchor","middle");w.attr("d","M"+b[0]+","+E*i+"V0H"+b[1]+"V"+E*i)}else{x=ao,L="y",I="x",C="y2",P="x2";M.attr("dy",".32em").style("text-anchor",E<0?"end":"start");w.attr("d","M"+E*i+","+b[0]+"H0V"+b[1]+"H"+E*i)}T.attr(P,E*a);A.attr(I,E*y);k.attr(C,0).attr(P,E*a);S.attr(L,0).attr(I,E*y);if(f.rangeBand){var z=f,D=z.rangeBand()/2;c=f=function(e){return z(e)+D}}else if(c.rangeBand){c=f}else{m.call(x,f,c)}d.call(x,c,f);g.call(x,f,f)}))}c.scale=function(t){if(!arguments.length)return e;e=t;return c};c.orient=function(e){if(!arguments.length)return r;r=e in to?e+"":eo;return c};c.ticks=function(){if(!arguments.length)return s;s=n(arguments);return c};c.tickValues=function(e){if(!arguments.length)return l;l=e;return c};c.tickFormat=function(e){if(!arguments.length)return u;u=e;return c};c.tickSize=function(e){var t=arguments.length;if(!t)return a;a=+e;i=+arguments[t-1];return c};c.innerTickSize=function(e){if(!arguments.length)return a;a=+e;return c};c.outerTickSize=function(e){if(!arguments.length)return i;i=+e;return c};c.tickPadding=function(e){if(!arguments.length)return o;o=+e;return c};c.tickSubdivide=function(){return arguments.length&&c};return c};var eo="bottom",to={top:1,right:1,bottom:1,left:1};function ro(e,t,r){e.attr("transform",(function(e){var a=t(e);return"translate("+(isFinite(a)?a:r(e))+",0)"}))}function ao(e,t,r){e.attr("transform",(function(e){var a=t(e);return"translate(0,"+(isFinite(a)?a:r(e))+")"}))}t.svg.brush=function(){var e=V(h,"brushstart","brush","brushend"),r=null,a=null,n=[0,0],i=[0,0],o,l,u=true,c=true,f=io[0];function h(e){e.each((function(){var e=t.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",m).on("touchstart.brush",m);var n=e.selectAll(".background").data([0]);n.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair");e.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var i=e.selectAll(".resize").data(f,O);i.exit().remove();i.enter().append("g").attr("class",(function(e){return"resize "+e})).style("cursor",(function(e){return no[e]})).append("rect").attr("x",(function(e){return/[ew]$/.test(e)?-3:null})).attr("y",(function(e){return/^[ns]/.test(e)?-3:null})).attr("width",6).attr("height",6).style("visibility","hidden");i.style("display",h.empty()?"none":null);var o=t.transition(e),s=t.transition(n),l;if(r){l=wn(r);s.attr("x",l[0]).attr("width",l[1]-l[0]);v(o)}if(a){l=wn(a);s.attr("y",l[0]).attr("height",l[1]-l[0]);d(o)}p(o)}))}h.event=function(r){r.each((function(){var r=e.of(this,arguments),a={x:n,y:i,i:o,j:l},s=this.__chart__||a;this.__chart__=a;if(Xi){t.select(this).transition().each("start.brush",(function(){o=s.i;l=s.j;n=s.x;i=s.y;r({type:"brushstart"})})).tween("brush:brush",(function(){var e=Ur(n,a.x),t=Ur(i,a.y);o=l=null;return function(o){n=a.x=e(o);i=a.y=t(o);r({type:"brush",mode:"resize"})}})).each("end.brush",(function(){o=a.i;l=a.j;r({type:"brush",mode:"resize"});r({type:"brushend"})}))}else{r({type:"brushstart"});r({type:"brush",mode:"resize"});r({type:"brushend"})}}))};function p(e){e.selectAll(".resize").attr("transform",(function(e){return"translate("+n[+/e$/.test(e)]+","+i[+/^s/.test(e)]+")"}))}function v(e){e.select(".extent").attr("x",n[0]);e.selectAll(".extent,.n>rect,.s>rect").attr("width",n[1]-n[0])}function d(e){e.select(".extent").attr("y",i[0]);e.selectAll(".extent,.e>rect,.w>rect").attr("height",i[1]-i[0])}function m(){var f=this,m=t.select(t.event.target),g=e.of(f,arguments),y=t.select(f),x=m.datum(),b=!/^(n|s)$/.test(x)&&r,_=!/^(e|w)$/.test(x)&&a,w=m.classed("extent"),T=Te(f),k,M=t.mouse(f),A;var S=t.select(s(f)).on("keydown.brush",C).on("keyup.brush",I);if(t.event.changedTouches){S.on("touchmove.brush",P).on("touchend.brush",z)}else{S.on("mousemove.brush",P).on("mouseup.brush",z)}y.interrupt().selectAll("*").interrupt();if(w){M[0]=n[0]-M[0];M[1]=i[0]-M[1]}else if(x){var E=+/w$/.test(x),L=+/^n/.test(x);A=[n[1-E]-M[0],i[1-L]-M[1]];M[0]=n[E];M[1]=i[L]}else if(t.event.altKey)k=M.slice();y.style("pointer-events","none").selectAll(".resize").style("display",null);t.select("body").style("cursor",m.style("cursor"));g({type:"brushstart"});P();function C(){if(t.event.keyCode==32){if(!w){k=null;M[0]-=n[1];M[1]-=i[1];w=2}j()}}function I(){if(t.event.keyCode==32&&w==2){M[0]+=n[1];M[1]+=i[1];w=0;j()}}function P(){var e=t.mouse(f),o=false;if(A){e[0]+=A[0];e[1]+=A[1]}if(!w){if(t.event.altKey){if(!k)k=[(n[0]+n[1])/2,(i[0]+i[1])/2];M[0]=n[+(e[0]<k[0])];M[1]=i[+(e[1]<k[1])]}else k=null}if(b&&O(e,r,0)){v(y);o=true}if(_&&O(e,a,1)){d(y);o=true}if(o){p(y);g({type:"brush",mode:w?"move":"resize"})}}function O(e,t,r){var a=wn(t),s=a[0],f=a[1],h=M[r],p=r?i:n,v=p[1]-p[0],d,m;if(w){s-=h;f-=v+h}d=(r?c:u)?Math.max(s,Math.min(f,e[r])):e[r];if(w){m=(d+=h)+v}else{if(k)h=Math.max(s,Math.min(f,2*k[r]-d));if(h<d){m=d;d=h}else{m=h}}if(p[0]!=d||p[1]!=m){if(r)l=null;else o=null;p[0]=d;p[1]=m;return true}}function z(){P();y.style("pointer-events","all").selectAll(".resize").style("display",h.empty()?"none":null);t.select("body").style("cursor",null);S.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null);T();g({type:"brushend"})}}h.x=function(e){if(!arguments.length)return r;r=e;f=io[!r<<1|!a];return h};h.y=function(e){if(!arguments.length)return a;a=e;f=io[!r<<1|!a];return h};h.clamp=function(e){if(!arguments.length)return r&&a?[u,c]:r?u:a?c:null;if(r&&a)u=!!e[0],c=!!e[1];else if(r)u=!!e;else if(a)c=!!e;return h};h.extent=function(e){var t,s,u,c,f;if(!arguments.length){if(r){if(o){t=o[0],s=o[1]}else{t=n[0],s=n[1];if(r.invert)t=r.invert(t),s=r.invert(s);if(s<t)f=t,t=s,s=f}}if(a){if(l){u=l[0],c=l[1]}else{u=i[0],c=i[1];if(a.invert)u=a.invert(u),c=a.invert(c);if(c<u)f=u,u=c,c=f}}return r&&a?[[t,u],[s,c]]:r?[t,s]:a&&[u,c]}if(r){t=e[0],s=e[1];if(a)t=t[0],s=s[0];o=[t,s];if(r.invert)t=r(t),s=r(s);if(s<t)f=t,t=s,s=f;if(t!=n[0]||s!=n[1])n=[t,s]}if(a){u=e[0],c=e[1];if(r)u=u[1],c=c[1];l=[u,c];if(a.invert)u=a(u),c=a(c);if(c<u)f=u,u=c,c=f;if(u!=i[0]||c!=i[1])i=[u,c]}return h};h.clear=function(){if(!h.empty()){n=[0,0],i=[0,0];o=l=null}return h};h.empty=function(){return!!r&&n[0]==n[1]||!!a&&i[0]==i[1]};return t.rebind(h,e,"on")};var no={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"};var io=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]];t.text=Mt((function(e){return e.responseText}));t.json=function(e,t){return At(e,"application/json",oo,t)};function oo(e){return JSON.parse(e.responseText)}t.html=function(e,t){return At(e,"text/html",so,t)};function so(e){var t=i.createRange();t.selectNode(i.body);return t.createContextualFragment(e.responseText)}t.xml=Mt((function(e){return e.responseXML}));if(typeof e==="function"&&e.amd)this.d3=t,e(t);else if(typeof r==="object"&&r.exports)r.exports=t;else this.d3=t}.apply(self)},{}],59:[function(e,t,r){"use strict";t.exports=e("./quad")},{"./quad":60}],60:[function(e,t,r){"use strict";var a=e("binary-search-bounds");var n=e("clamp");var i=e("parse-rect");var o=e("array-bounds");var s=e("pick-by-alias");var l=e("defined");var u=e("flatten-vertex-data");var c=e("is-obj");var f=e("dtype");var h=e("math-log2");var p=1073741824;t.exports=function e(t,r){if(!r){r={}}t=u(t,"float64");r=s(r,{bounds:"range bounds dataBox databox",maxDepth:"depth maxDepth maxdepth level maxLevel maxlevel levels",dtype:"type dtype format out dst output destination"});var n=l(r.maxDepth,255);var d=l(r.bounds,o(t,2));if(d[0]===d[2]){d[2]++}if(d[1]===d[3]){d[3]++}var m=v(t,d);var g=t.length>>>1;var y;if(!r.dtype){r.dtype="array"}if(typeof r.dtype==="string"){y=new(f(r.dtype))(g)}else if(r.dtype){y=r.dtype;if(Array.isArray(y)){y.length=g}}for(var x=0;x<g;++x){y[x]=x}var b=[];var _=[];var w=[];var T=[];C(0,0,1,y,0,1);var k=0;for(var M=0;M<b.length;M++){var A=b[M];if(y.set){y.set(A,k)}else{for(var S=0,E=A.length;S<E;S++){y[S+k]=A[S]}}var L=k+b[M].length;T[M]=[k,L];k=L}y.range=I;return y;function C(e,t,r,a,i,o){if(!a.length){return null}var s=b[i]||(b[i]=[]);var l=w[i]||(w[i]=[]);var u=_[i]||(_[i]=[]);var c=s.length;i++;if(i>n||o>p){for(var f=0;f<a.length;f++){s.push(a[f]);l.push(o);u.push(null,null,null,null)}return c}s.push(a[0]);l.push(o);if(a.length<=1){u.push(null,null,null,null);return c}var h=r*.5;var v=e+h,d=t+h;var g=[],y=[],x=[],T=[];for(var k=1,M=a.length;k<M;k++){var A=a[k],S=m[A*2],E=m[A*2+1];S<v?E<d?g.push(A):y.push(A):E<d?x.push(A):T.push(A)}o<<=2;u.push(C(e,t,h,g,i,o),C(e,d,h,y,i,o+1),C(v,t,h,x,i,o+2),C(v,d,h,T,i,o+3));return c}function I(){var e=[],r=arguments.length;while(r--)e[r]=arguments[r];var a;if(c(e[e.length-1])){var n=e.pop();if(!e.length&&(n.x!=null||n.l!=null||n.left!=null)){e=[n];a={}}a=s(n,{level:"level maxLevel",d:"d diam diameter r radius px pxSize pixel pixelSize maxD size minSize",lod:"lod details ranges offsets"})}else{a={}}if(!e.length){e=d}var o=i.apply(void 0,e);var u=[Math.min(o.x,o.x+o.width),Math.min(o.y,o.y+o.height),Math.max(o.x,o.x+o.width),Math.max(o.y,o.y+o.height)];var f=u[0];var p=u[1];var m=u[2];var g=u[3];var y=v([f,p,m,g],d);var x=y[0];var w=y[1];var T=y[2];var k=y[3];var M=l(a.level,b.length);if(a.d!=null){var A;if(typeof a.d==="number"){A=[a.d,a.d]}else if(a.d.length){A=a.d}M=Math.min(Math.max(Math.ceil(-h(Math.abs(A[0])/(d[2]-d[0]))),Math.ceil(-h(Math.abs(A[1])/(d[3]-d[1])))),M)}M=Math.min(M,b.length);if(a.lod){return P(x,w,T,k,M)}var S=[];E(0,0,1,0,0,1);function E(e,r,a,n,i,o){if(i===null||o===null){return}var s=e+a;var l=r+a;if(x>s||w>l||T<e||k<r){return}if(n>=M){return}if(i===o){return}var u=b[n];if(o===undefined){o=u.length}for(var c=i;c<o;c++){var h=u[c];var v=t[h*2];var d=t[h*2+1];if(v>=f&&v<=m&&d>=p&&d<=g){S.push(h)}}var y=_[n];var A=y[i*4+0];var C=y[i*4+1];var I=y[i*4+2];var P=y[i*4+3];var O=L(y,i+1);var z=a*.5;var D=n+1;E(e,r,z,D,A,C||I||P||O);E(e,r+z,z,D,C,I||P||O);E(e+z,r,z,D,I,P||O);E(e+z,r+z,z,D,P,O)}function L(e,t){var r=null,a=0;while(r===null){r=e[t*4+a];a++;if(a>e.length){return null}}return r}return S}function P(e,t,r,n,i){var o=[];for(var s=0;s<i;s++){var l=w[s];var u=T[s][0];var c=O(e,t,s);var f=O(r,n,s);var h=a.ge(l,c);var p=a.gt(l,f,h,l.length-1);o[s]=[h+u,p+u]}return o}function O(e,t,r){var a=1;var n=.5,i=.5;var o=.5;for(var s=0;s<r;s++){a<<=2;a+=e<n?t<i?0:1:t<i?2:3;o*=.5;n+=e<n?-o:o;i+=t<i?-o:o}return a}};function v(e,t){var r=t[0];var a=t[1];var i=t[2];var o=t[3];var s=1/(i-r);var l=1/(o-a);var u=new Array(e.length);for(var c=0,f=e.length/2;c<f;c++){u[2*c]=n((e[2*c]-r)*s,0,1);u[2*c+1]=n((e[2*c+1]-a)*l,0,1)}return u}},{"array-bounds":76,"binary-search-bounds":103,clamp:126,defined:176,dtype:181,"flatten-vertex-data":248,"is-obj":446,"math-log2":456,"parse-rect":481,"pick-by-alias":485}],61:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});var a=e("@turf/meta");var n=6378137;function i(e){return a.geomReduce(e,(function(e,t){return e+o(t)}),0)}r.default=i;function o(e){var t=0;var r;switch(e.type){case"Polygon":return s(e.coordinates);case"MultiPolygon":for(r=0;r<e.coordinates.length;r++){t+=s(e.coordinates[r])}return t;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}function s(e){var t=0;if(e&&e.length>0){t+=Math.abs(l(e[0]));for(var r=1;r<e.length;r++){t-=Math.abs(l(e[r]))}}return t}function l(e){var t;var r;var a;var i;var o;var s;var l;var c=0;var f=e.length;if(f>2){for(l=0;l<f;l++){if(l===f-2){i=f-2;o=f-1;s=0}else if(l===f-1){i=f-1;o=0;s=1}else{i=l;o=l+1;s=l+2}t=e[i];r=e[o];a=e[s];c+=(u(a[0])-u(t[0]))*Math.sin(u(r[1]))}c=c*n*n/2}return c}function u(e){return e*Math.PI/180}},{"@turf/meta":63}],62:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});r.earthRadius=6371008.8;r.factors={centimeters:r.earthRadius*100,centimetres:r.earthRadius*100,degrees:r.earthRadius/111325,feet:r.earthRadius*3.28084,inches:r.earthRadius*39.37,kilometers:r.earthRadius/1e3,kilometres:r.earthRadius/1e3,meters:r.earthRadius,metres:r.earthRadius,miles:r.earthRadius/1609.344,millimeters:r.earthRadius*1e3,millimetres:r.earthRadius*1e3,nauticalmiles:r.earthRadius/1852,radians:1,yards:r.earthRadius*1.0936};r.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/r.earthRadius,yards:1.0936133};r.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function a(e,t,r){if(r===void 0){r={}}var a={type:"Feature"};if(r.id===0||r.id){a.id=r.id}if(r.bbox){a.bbox=r.bbox}a.properties=t||{};a.geometry=e;return a}r.feature=a;function n(e,t,r){if(r===void 0){r={}}switch(e){case"Point":return i(t).geometry;case"LineString":return u(t).geometry;case"Polygon":return s(t).geometry;case"MultiPoint":return p(t).geometry;case"MultiLineString":return h(t).geometry;case"MultiPolygon":return v(t).geometry;default:throw new Error(e+" is invalid")}}r.geometry=n;function i(e,t,r){if(r===void 0){r={}}if(!e){throw new Error("coordinates is required")}if(!Array.isArray(e)){throw new Error("coordinates must be an Array")}if(e.length<2){throw new Error("coordinates must be at least 2 numbers long")}if(!M(e[0])||!M(e[1])){throw new Error("coordinates must contain numbers")}var n={type:"Point",coordinates:e};return a(n,t,r)}r.point=i;function o(e,t,r){if(r===void 0){r={}}return f(e.map((function(e){return i(e,t)})),r)}r.points=o;function s(e,t,r){if(r===void 0){r={}}for(var n=0,i=e;n<i.length;n++){var o=i[n];if(o.length<4){throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.")}for(var s=0;s<o[o.length-1].length;s++){if(o[o.length-1][s]!==o[0][s]){throw new Error("First and last Position are not equivalent.")}}}var l={type:"Polygon",coordinates:e};return a(l,t,r)}r.polygon=s;function l(e,t,r){if(r===void 0){r={}}return f(e.map((function(e){return s(e,t)})),r)}r.polygons=l;function u(e,t,r){if(r===void 0){r={}}if(e.length<2){throw new Error("coordinates must be an array of two or more positions")}var n={type:"LineString",coordinates:e};return a(n,t,r)}r.lineString=u;function c(e,t,r){if(r===void 0){r={}}return f(e.map((function(e){return u(e,t)})),r)}r.lineStrings=c;function f(e,t){if(t===void 0){t={}}var r={type:"FeatureCollection"};if(t.id){r.id=t.id}if(t.bbox){r.bbox=t.bbox}r.features=e;return r}r.featureCollection=f;function h(e,t,r){if(r===void 0){r={}}var n={type:"MultiLineString",coordinates:e};return a(n,t,r)}r.multiLineString=h;function p(e,t,r){if(r===void 0){r={}}var n={type:"MultiPoint",coordinates:e};return a(n,t,r)}r.multiPoint=p;function v(e,t,r){if(r===void 0){r={}}var n={type:"MultiPolygon",coordinates:e};return a(n,t,r)}r.multiPolygon=v;function d(e,t,r){if(r===void 0){r={}}var n={type:"GeometryCollection",geometries:e};return a(n,t,r)}r.geometryCollection=d;function m(e,t){if(t===void 0){t=0}if(t&&!(t>=0)){throw new Error("precision must be a positive number")}var r=Math.pow(10,t||0);return Math.round(e*r)/r}r.round=m;function g(e,t){if(t===void 0){t="kilometers"}var a=r.factors[t];if(!a){throw new Error(t+" units is invalid")}return e*a}r.radiansToLength=g;function y(e,t){if(t===void 0){t="kilometers"}var a=r.factors[t];if(!a){throw new Error(t+" units is invalid")}return e/a}r.lengthToRadians=y;function x(e,t){return _(y(e,t))}r.lengthToDegrees=x;function b(e){var t=e%360;if(t<0){t+=360}return t}r.bearingToAzimuth=b;function _(e){var t=e%(2*Math.PI);return t*180/Math.PI}r.radiansToDegrees=_;function w(e){var t=e%360;return t*Math.PI/180}r.degreesToRadians=w;function T(e,t,r){if(t===void 0){t="kilometers"}if(r===void 0){r="kilometers"}if(!(e>=0)){throw new Error("length must be a positive number")}return g(y(e,t),r)}r.convertLength=T;function k(e,t,a){if(t===void 0){t="meters"}if(a===void 0){a="kilometers"}if(!(e>=0)){throw new Error("area must be a positive number")}var n=r.areaFactors[t];if(!n){throw new Error("invalid original units")}var i=r.areaFactors[a];if(!i){throw new Error("invalid final units")}return e/n*i}r.convertArea=k;function M(e){return!isNaN(e)&&e!==null&&!Array.isArray(e)}r.isNumber=M;function A(e){return!!e&&e.constructor===Object}r.isObject=A;function S(e){if(!e){throw new Error("bbox is required")}if(!Array.isArray(e)){throw new Error("bbox must be an Array")}if(e.length!==4&&e.length!==6){throw new Error("bbox must be an Array of 4 or 6 numbers")}e.forEach((function(e){if(!M(e)){throw new Error("bbox must only contain numbers")}}))}r.validateBBox=S;function E(e){if(!e){throw new Error("id is required")}if(["string","number"].indexOf(typeof e)===-1){throw new Error("id must be a number or a string")}}r.validateId=E},{}],63:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});var a=e("@turf/helpers");function n(e,t,r){if(e===null)return;var a,i,o,s,l,u,c,f=0,h=0,p,v=e.type,d=v==="FeatureCollection",m=v==="Feature",g=d?e.features.length:1;for(var y=0;y<g;y++){c=d?e.features[y].geometry:m?e.geometry:e;p=c?c.type==="GeometryCollection":false;l=p?c.geometries.length:1;for(var x=0;x<l;x++){var b=0;var _=0;s=p?c.geometries[x]:c;if(s===null)continue;u=s.coordinates;var w=s.type;f=r&&(w==="Polygon"||w==="MultiPolygon")?1:0;switch(w){case null:break;case"Point":if(t(u,h,y,b,_)===false)return false;h++;b++;break;case"LineString":case"MultiPoint":for(a=0;a<u.length;a++){if(t(u[a],h,y,b,_)===false)return false;h++;if(w==="MultiPoint")b++}if(w==="LineString")b++;break;case"Polygon":case"MultiLineString":for(a=0;a<u.length;a++){for(i=0;i<u[a].length-f;i++){if(t(u[a][i],h,y,b,_)===false)return false;h++}if(w==="MultiLineString")b++;if(w==="Polygon")_++}if(w==="Polygon")b++;break;case"MultiPolygon":for(a=0;a<u.length;a++){_=0;for(i=0;i<u[a].length;i++){for(o=0;o<u[a][i].length-f;o++){if(t(u[a][i][o],h,y,b,_)===false)return false;h++}_++}b++}break;case"GeometryCollection":for(a=0;a<s.geometries.length;a++)if(n(s.geometries[a],t,r)===false)return false;break;default:throw new Error("Unknown Geometry Type")}}}}function i(e,t,r,a){var i=r;n(e,(function(e,a,n,o,s){if(a===0&&r===undefined)i=e;else i=t(i,e,a,n,o,s)}),a);return i}function o(e,t){var r;switch(e.type){case"FeatureCollection":for(r=0;r<e.features.length;r++){if(t(e.features[r].properties,r)===false)break}break;case"Feature":t(e.properties,0);break}}function s(e,t,r){var a=r;o(e,(function(e,n){if(n===0&&r===undefined)a=e;else a=t(a,e,n)}));return a}function l(e,t){if(e.type==="Feature"){t(e,0)}else if(e.type==="FeatureCollection"){for(var r=0;r<e.features.length;r++){if(t(e.features[r],r)===false)break}}}function u(e,t,r){var a=r;l(e,(function(e,n){if(n===0&&r===undefined)a=e;else a=t(a,e,n)}));return a}function c(e){var t=[];n(e,(function(e){t.push(e)}));return t}function f(e,t){var r,a,n,i,o,s,l,u,c,f,h=0,p=e.type==="FeatureCollection",v=e.type==="Feature",d=p?e.features.length:1;for(r=0;r<d;r++){s=p?e.features[r].geometry:v?e.geometry:e;u=p?e.features[r].properties:v?e.properties:{};c=p?e.features[r].bbox:v?e.bbox:undefined;f=p?e.features[r].id:v?e.id:undefined;l=s?s.type==="GeometryCollection":false;o=l?s.geometries.length:1;for(n=0;n<o;n++){i=l?s.geometries[n]:s;if(i===null){if(t(null,h,u,c,f)===false)return false;continue}switch(i.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(t(i,h,u,c,f)===false)return false;break}case"GeometryCollection":{for(a=0;a<i.geometries.length;a++){if(t(i.geometries[a],h,u,c,f)===false)return false}break}default:throw new Error("Unknown Geometry Type")}}h++}}function h(e,t,r){var a=r;f(e,(function(e,n,i,o,s){if(n===0&&r===undefined)a=e;else a=t(a,e,n,i,o,s)}));return a}function p(e,t){f(e,(function(e,r,n,i,o){var s=e===null?null:e.type;switch(s){case null:case"Point":case"LineString":case"Polygon":if(t(a.feature(e,n,{bbox:i,id:o}),r,0)===false)return false;return}var l;switch(s){case"MultiPoint":l="Point";break;case"MultiLineString":l="LineString";break;case"MultiPolygon":l="Polygon";break}for(var u=0;u<e.coordinates.length;u++){var c=e.coordinates[u];var f={type:l,coordinates:c};if(t(a.feature(f,n),r,u)===false)return false}}))}function v(e,t,r){var a=r;p(e,(function(e,n,i){if(n===0&&i===0&&r===undefined)a=e;else a=t(a,e,n,i)}));return a}function d(e,t){p(e,(function(e,r,i){var o=0;if(!e.geometry)return;var s=e.geometry.type;if(s==="Point"||s==="MultiPoint")return;var l;var u=0;var c=0;var f=0;if(n(e,(function(n,s,h,p,v){if(l===undefined||r>u||p>c||v>f){l=n;u=r;c=p;f=v;o=0;return}var d=a.lineString([l,n],e.properties);if(t(d,r,i,v,o)===false)return false;o++;l=n}))===false)return false}))}function m(e,t,r){var a=r;var n=false;d(e,(function(e,i,o,s,l){if(n===false&&r===undefined)a=e;else a=t(a,e,i,o,s,l);n=true}));return a}function g(e,t){if(!e)throw new Error("geojson is required");p(e,(function(e,r,n){if(e.geometry===null)return;var i=e.geometry.type;var o=e.geometry.coordinates;switch(i){case"LineString":if(t(e,r,n,0,0)===false)return false;break;case"Polygon":for(var s=0;s<o.length;s++){if(t(a.lineString(o[s],e.properties),r,n,s)===false)return false}break}}))}function y(e,t,r){var a=r;g(e,(function(e,n,i,o){if(n===0&&r===undefined)a=e;else a=t(a,e,n,i,o)}));return a}function x(e,t){t=t||{};if(!a.isObject(t))throw new Error("options is invalid");var r=t.featureIndex||0;var n=t.multiFeatureIndex||0;var i=t.geometryIndex||0;var o=t.segmentIndex||0;var s=t.properties;var l;switch(e.type){case"FeatureCollection":if(r<0)r=e.features.length+r;s=s||e.features[r].properties;l=e.features[r].geometry;break;case"Feature":s=s||e.properties;l=e.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":l=e;break;default:throw new Error("geojson is invalid")}if(l===null)return null;var u=l.coordinates;switch(l.type){case"Point":case"MultiPoint":return null;case"LineString":if(o<0)o=u.length+o-1;return a.lineString([u[o],u[o+1]],s,t);case"Polygon":if(i<0)i=u.length+i;if(o<0)o=u[i].length+o-1;return a.lineString([u[i][o],u[i][o+1]],s,t);case"MultiLineString":if(n<0)n=u.length+n;if(o<0)o=u[n].length+o-1;return a.lineString([u[n][o],u[n][o+1]],s,t);case"MultiPolygon":if(n<0)n=u.length+n;if(i<0)i=u[n].length+i;if(o<0)o=u[n][i].length-o-1;return a.lineString([u[n][i][o],u[n][i][o+1]],s,t)}throw new Error("geojson is invalid")}function b(e,t){t=t||{};if(!a.isObject(t))throw new Error("options is invalid");var r=t.featureIndex||0;var n=t.multiFeatureIndex||0;var i=t.geometryIndex||0;var o=t.coordIndex||0;var s=t.properties;var l;switch(e.type){case"FeatureCollection":if(r<0)r=e.features.length+r;s=s||e.features[r].properties;l=e.features[r].geometry;break;case"Feature":s=s||e.properties;l=e.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":l=e;break;default:throw new Error("geojson is invalid")}if(l===null)return null;var u=l.coordinates;switch(l.type){case"Point":return a.point(u,s,t);case"MultiPoint":if(n<0)n=u.length+n;return a.point(u[n],s,t);case"LineString":if(o<0)o=u.length+o;return a.point(u[o],s,t);case"Polygon":if(i<0)i=u.length+i;if(o<0)o=u[i].length+o;return a.point(u[i][o],s,t);case"MultiLineString":if(n<0)n=u.length+n;if(o<0)o=u[n].length+o;return a.point(u[n][o],s,t);case"MultiPolygon":if(n<0)n=u.length+n;if(i<0)i=u[n].length+i;if(o<0)o=u[n][i].length-o;return a.point(u[n][i][o],s,t)}throw new Error("geojson is invalid")}r.coordEach=n;r.coordReduce=i;r.propEach=o;r.propReduce=s;r.featureEach=l;r.featureReduce=u;r.coordAll=c;r.geomEach=f;r.geomReduce=h;r.flattenEach=p;r.flattenReduce=v;r.segmentEach=d;r.segmentReduce=m;r.lineEach=g;r.lineReduce=y;r.findSegment=x;r.findPoint=b},{"@turf/helpers":62}],64:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});var a=e("@turf/meta");function n(e){var t=[Infinity,Infinity,-Infinity,-Infinity];a.coordEach(e,(function(e){if(t[0]>e[0]){t[0]=e[0]}if(t[1]>e[1]){t[1]=e[1]}if(t[2]<e[0]){t[2]=e[0]}if(t[3]<e[1]){t[3]=e[1]}}));return t}n["default"]=n;r.default=n},{"@turf/meta":66}],65:[function(e,t,r){arguments[4][62][0].apply(r,arguments)},{dup:62}],66:[function(e,t,r){arguments[4][63][0].apply(r,arguments)},{"@turf/helpers":65,dup:63}],67:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});var a=e("@turf/meta");var n=e("@turf/helpers");function i(e,t){if(t===void 0){t={}}var r=0;var i=0;var o=0;a.coordEach(e,(function(e){r+=e[0];i+=e[1];o++}));return n.point([r/o,i/o],t.properties)}r.default=i},{"@turf/helpers":68,"@turf/meta":69}],68:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});r.earthRadius=6371008.8;r.factors={centimeters:r.earthRadius*100,centimetres:r.earthRadius*100,degrees:r.earthRadius/111325,feet:r.earthRadius*3.28084,inches:r.earthRadius*39.37,kilometers:r.earthRadius/1e3,kilometres:r.earthRadius/1e3,meters:r.earthRadius,metres:r.earthRadius,miles:r.earthRadius/1609.344,millimeters:r.earthRadius*1e3,millimetres:r.earthRadius*1e3,nauticalmiles:r.earthRadius/1852,radians:1,yards:r.earthRadius/1.0936};r.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/r.earthRadius,yards:1/1.0936};r.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function a(e,t,r){if(r===void 0){r={}}var a={type:"Feature"};if(r.id===0||r.id){a.id=r.id}if(r.bbox){a.bbox=r.bbox}a.properties=t||{};a.geometry=e;return a}r.feature=a;function n(e,t,r){if(r===void 0){r={}}switch(e){case"Point":return i(t).geometry;case"LineString":return u(t).geometry;case"Polygon":return s(t).geometry;case"MultiPoint":return p(t).geometry;case"MultiLineString":return h(t).geometry;case"MultiPolygon":return v(t).geometry;default:throw new Error(e+" is invalid")}}r.geometry=n;function i(e,t,r){if(r===void 0){r={}}var n={type:"Point",coordinates:e};return a(n,t,r)}r.point=i;function o(e,t,r){if(r===void 0){r={}}return f(e.map((function(e){return i(e,t)})),r)}r.points=o;function s(e,t,r){if(r===void 0){r={}}for(var n=0,i=e;n<i.length;n++){var o=i[n];if(o.length<4){throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.")}for(var s=0;s<o[o.length-1].length;s++){if(o[o.length-1][s]!==o[0][s]){throw new Error("First and last Position are not equivalent.")}}}var l={type:"Polygon",coordinates:e};return a(l,t,r)}r.polygon=s;function l(e,t,r){if(r===void 0){r={}}return f(e.map((function(e){return s(e,t)})),r)}r.polygons=l;function u(e,t,r){if(r===void 0){r={}}if(e.length<2){throw new Error("coordinates must be an array of two or more positions")}var n={type:"LineString",coordinates:e};return a(n,t,r)}r.lineString=u;function c(e,t,r){if(r===void 0){r={}}return f(e.map((function(e){return u(e,t)})),r)}r.lineStrings=c;function f(e,t){if(t===void 0){t={}}var r={type:"FeatureCollection"};if(t.id){r.id=t.id}if(t.bbox){r.bbox=t.bbox}r.features=e;return r}r.featureCollection=f;function h(e,t,r){if(r===void 0){r={}}var n={type:"MultiLineString",coordinates:e};return a(n,t,r)}r.multiLineString=h;function p(e,t,r){if(r===void 0){r={}}var n={type:"MultiPoint",coordinates:e};return a(n,t,r)}r.multiPoint=p;function v(e,t,r){if(r===void 0){r={}}var n={type:"MultiPolygon",coordinates:e};return a(n,t,r)}r.multiPolygon=v;function d(e,t,r){if(r===void 0){r={}}var n={type:"GeometryCollection",geometries:e};return a(n,t,r)}r.geometryCollection=d;function m(e,t){if(t===void 0){t=0}if(t&&!(t>=0)){throw new Error("precision must be a positive number")}var r=Math.pow(10,t||0);return Math.round(e*r)/r}r.round=m;function g(e,t){if(t===void 0){t="kilometers"}var a=r.factors[t];if(!a){throw new Error(t+" units is invalid")}return e*a}r.radiansToLength=g;function y(e,t){if(t===void 0){t="kilometers"}var a=r.factors[t];if(!a){throw new Error(t+" units is invalid")}return e/a}r.lengthToRadians=y;function x(e,t){return _(y(e,t))}r.lengthToDegrees=x;function b(e){var t=e%360;if(t<0){t+=360}return t}r.bearingToAzimuth=b;function _(e){var t=e%(2*Math.PI);return t*180/Math.PI}r.radiansToDegrees=_;function w(e){var t=e%360;return t*Math.PI/180}r.degreesToRadians=w;function T(e,t,r){if(t===void 0){t="kilometers"}if(r===void 0){r="kilometers"}if(!(e>=0)){throw new Error("length must be a positive number")}return g(y(e,t),r)}r.convertLength=T;function k(e,t,a){if(t===void 0){t="meters"}if(a===void 0){a="kilometers"}if(!(e>=0)){throw new Error("area must be a positive number")}var n=r.areaFactors[t];if(!n){throw new Error("invalid original units")}var i=r.areaFactors[a];if(!i){throw new Error("invalid final units")}return e/n*i}r.convertArea=k;function M(e){return!isNaN(e)&&e!==null&&!Array.isArray(e)&&!/^\s*$/.test(e)}r.isNumber=M;function A(e){return!!e&&e.constructor===Object}r.isObject=A;function S(e){if(!e){throw new Error("bbox is required")}if(!Array.isArray(e)){throw new Error("bbox must be an Array")}if(e.length!==4&&e.length!==6){throw new Error("bbox must be an Array of 4 or 6 numbers")}e.forEach((function(e){if(!M(e)){throw new Error("bbox must only contain numbers")}}))}r.validateBBox=S;function E(e){if(!e){throw new Error("id is required")}if(["string","number"].indexOf(typeof e)===-1){throw new Error("id must be a number or a string")}}r.validateId=E;function L(){throw new Error("method has been renamed to `radiansToDegrees`")}r.radians2degrees=L;function C(){throw new Error("method has been renamed to `degreesToRadians`")}r.degrees2radians=C;function I(){throw new Error("method has been renamed to `lengthToDegrees`")}r.distanceToDegrees=I;function P(){throw new Error("method has been renamed to `lengthToRadians`")}r.distanceToRadians=P;function O(){throw new Error("method has been renamed to `radiansToLength`")}r.radiansToDistance=O;function z(){throw new Error("method has been renamed to `bearingToAzimuth`")}r.bearingToAngle=z;function D(){throw new Error("method has been renamed to `convertLength`")}r.convertDistance=D},{}],69:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});var a=e("@turf/helpers");function n(e,t,r){if(e===null)return;var a,i,o,s,l,u,c,f=0,h=0,p,v=e.type,d=v==="FeatureCollection",m=v==="Feature",g=d?e.features.length:1;for(var y=0;y<g;y++){c=d?e.features[y].geometry:m?e.geometry:e;p=c?c.type==="GeometryCollection":false;l=p?c.geometries.length:1;for(var x=0;x<l;x++){var b=0;var _=0;s=p?c.geometries[x]:c;if(s===null)continue;u=s.coordinates;var w=s.type;f=r&&(w==="Polygon"||w==="MultiPolygon")?1:0;switch(w){case null:break;case"Point":if(t(u,h,y,b,_)===false)return false;h++;b++;break;case"LineString":case"MultiPoint":for(a=0;a<u.length;a++){if(t(u[a],h,y,b,_)===false)return false;h++;if(w==="MultiPoint")b++}if(w==="LineString")b++;break;case"Polygon":case"MultiLineString":for(a=0;a<u.length;a++){for(i=0;i<u[a].length-f;i++){if(t(u[a][i],h,y,b,_)===false)return false;h++}if(w==="MultiLineString")b++;if(w==="Polygon")_++}if(w==="Polygon")b++;break;case"MultiPolygon":for(a=0;a<u.length;a++){_=0;for(i=0;i<u[a].length;i++){for(o=0;o<u[a][i].length-f;o++){if(t(u[a][i][o],h,y,b,_)===false)return false;h++}_++}b++}break;case"GeometryCollection":for(a=0;a<s.geometries.length;a++)if(n(s.geometries[a],t,r)===false)return false;break;default:throw new Error("Unknown Geometry Type")}}}}function i(e,t,r,a){var i=r;n(e,(function(e,a,n,o,s){if(a===0&&r===undefined)i=e;else i=t(i,e,a,n,o,s)}),a);return i}function o(e,t){var r;switch(e.type){case"FeatureCollection":for(r=0;r<e.features.length;r++){if(t(e.features[r].properties,r)===false)break}break;case"Feature":t(e.properties,0);break}}function s(e,t,r){var a=r;o(e,(function(e,n){if(n===0&&r===undefined)a=e;else a=t(a,e,n)}));return a}function l(e,t){if(e.type==="Feature"){t(e,0)}else if(e.type==="FeatureCollection"){for(var r=0;r<e.features.length;r++){if(t(e.features[r],r)===false)break}}}function u(e,t,r){var a=r;l(e,(function(e,n){if(n===0&&r===undefined)a=e;else a=t(a,e,n)}));return a}function c(e){var t=[];n(e,(function(e){t.push(e)}));return t}function f(e,t){var r,a,n,i,o,s,l,u,c,f,h=0,p=e.type==="FeatureCollection",v=e.type==="Feature",d=p?e.features.length:1;for(r=0;r<d;r++){s=p?e.features[r].geometry:v?e.geometry:e;u=p?e.features[r].properties:v?e.properties:{};c=p?e.features[r].bbox:v?e.bbox:undefined;f=p?e.features[r].id:v?e.id:undefined;l=s?s.type==="GeometryCollection":false;o=l?s.geometries.length:1;for(n=0;n<o;n++){i=l?s.geometries[n]:s;if(i===null){if(t(null,h,u,c,f)===false)return false;continue}switch(i.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(t(i,h,u,c,f)===false)return false;break}case"GeometryCollection":{for(a=0;a<i.geometries.length;a++){if(t(i.geometries[a],h,u,c,f)===false)return false}break}default:throw new Error("Unknown Geometry Type")}}h++}}function h(e,t,r){var a=r;f(e,(function(e,n,i,o,s){if(n===0&&r===undefined)a=e;else a=t(a,e,n,i,o,s)}));return a}function p(e,t){f(e,(function(e,r,n,i,o){var s=e===null?null:e.type;switch(s){case null:case"Point":case"LineString":case"Polygon":if(t(a.feature(e,n,{bbox:i,id:o}),r,0)===false)return false;return}var l;switch(s){case"MultiPoint":l="Point";break;case"MultiLineString":l="LineString";break;case"MultiPolygon":l="Polygon";break}for(var u=0;u<e.coordinates.length;u++){var c=e.coordinates[u];var f={type:l,coordinates:c};if(t(a.feature(f,n),r,u)===false)return false}}))}function v(e,t,r){var a=r;p(e,(function(e,n,i){if(n===0&&i===0&&r===undefined)a=e;else a=t(a,e,n,i)}));return a}function d(e,t){p(e,(function(e,r,i){var o=0;if(!e.geometry)return;var s=e.geometry.type;if(s==="Point"||s==="MultiPoint")return;var l;var u=0;var c=0;var f=0;if(n(e,(function(n,s,h,p,v){if(l===undefined||r>u||p>c||v>f){l=n;u=r;c=p;f=v;o=0;return}var d=a.lineString([l,n],e.properties);if(t(d,r,i,v,o)===false)return false;o++;l=n}))===false)return false}))}function m(e,t,r){var a=r;var n=false;d(e,(function(e,i,o,s,l){if(n===false&&r===undefined)a=e;else a=t(a,e,i,o,s,l);n=true}));return a}function g(e,t){if(!e)throw new Error("geojson is required");p(e,(function(e,r,n){if(e.geometry===null)return;var i=e.geometry.type;var o=e.geometry.coordinates;switch(i){case"LineString":if(t(e,r,n,0,0)===false)return false;break;case"Polygon":for(var s=0;s<o.length;s++){if(t(a.lineString(o[s],e.properties),r,n,s)===false)return false}break}}))}function y(e,t,r){var a=r;g(e,(function(e,n,i,o){if(n===0&&r===undefined)a=e;else a=t(a,e,n,i,o)}));return a}function x(e,t){t=t||{};if(!a.isObject(t))throw new Error("options is invalid");var r=t.featureIndex||0;var n=t.multiFeatureIndex||0;var i=t.geometryIndex||0;var o=t.segmentIndex||0;var s=t.properties;var l;switch(e.type){case"FeatureCollection":if(r<0)r=e.features.length+r;s=s||e.features[r].properties;l=e.features[r].geometry;break;case"Feature":s=s||e.properties;l=e.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":l=e;break;default:throw new Error("geojson is invalid")}if(l===null)return null;var u=l.coordinates;switch(l.type){case"Point":case"MultiPoint":return null;case"LineString":if(o<0)o=u.length+o-1;return a.lineString([u[o],u[o+1]],s,t);case"Polygon":if(i<0)i=u.length+i;if(o<0)o=u[i].length+o-1;return a.lineString([u[i][o],u[i][o+1]],s,t);case"MultiLineString":if(n<0)n=u.length+n;if(o<0)o=u[n].length+o-1;return a.lineString([u[n][o],u[n][o+1]],s,t);case"MultiPolygon":if(n<0)n=u.length+n;if(i<0)i=u[n].length+i;if(o<0)o=u[n][i].length-o-1;return a.lineString([u[n][i][o],u[n][i][o+1]],s,t)}throw new Error("geojson is invalid")}function b(e,t){t=t||{};if(!a.isObject(t))throw new Error("options is invalid");var r=t.featureIndex||0;var n=t.multiFeatureIndex||0;var i=t.geometryIndex||0;var o=t.coordIndex||0;var s=t.properties;var l;switch(e.type){case"FeatureCollection":if(r<0)r=e.features.length+r;s=s||e.features[r].properties;l=e.features[r].geometry;break;case"Feature":s=s||e.properties;l=e.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":l=e;break;default:throw new Error("geojson is invalid")}if(l===null)return null;var u=l.coordinates;switch(l.type){case"Point":return a.point(u,s,t);case"MultiPoint":if(n<0)n=u.length+n;return a.point(u[n],s,t);case"LineString":if(o<0)o=u.length+o;return a.point(u[o],s,t);case"Polygon":if(i<0)i=u.length+i;if(o<0)o=u[i].length+o;return a.point(u[i][o],s,t);case"MultiLineString":if(n<0)n=u.length+n;if(o<0)o=u[n].length+o;return a.point(u[n][o],s,t);case"MultiPolygon":if(n<0)n=u.length+n;if(i<0)i=u[n].length+i;if(o<0)o=u[n][i].length-o;return a.point(u[n][i][o],s,t)}throw new Error("geojson is invalid")}r.coordEach=n;r.coordReduce=i;r.propEach=o;r.propReduce=s;r.featureEach=l;r.featureReduce=u;r.coordAll=c;r.geomEach=f;r.geomReduce=h;r.flattenEach=p;r.flattenReduce=v;r.segmentEach=d;r.segmentReduce=m;r.lineEach=g;r.lineReduce=y;r.findSegment=x;r.findPoint=b},{"@turf/helpers":68}],70:[function(e,t,r){"use strict";var a=typeof WeakMap==="undefined"?e("weak-map"):WeakMap;var n=e("gl-buffer");var i=e("gl-vao");var o=new a;function s(e){var t=o.get(e);var r=t&&(t._triangleBuffer.handle||t._triangleBuffer.buffer);if(!r||!e.isBuffer(r)){var a=n(e,new Float32Array([-1,-1,-1,4,4,-1]));t=i(e,[{buffer:a,type:e.FLOAT,size:2}]);t._triangleBuffer=a;o.set(e,t)}t.bind();e.drawArrays(e.TRIANGLES,0,3);t.unbind()}t.exports=s},{"gl-buffer":261,"gl-vao":353,"weak-map":609}],71:[function(e,t,r){t.exports=a;function a(e){var t=0;var r=0;var a=0;var n=0;return e.map((function(e){e=e.slice();var i=e[0];var o=i.toUpperCase();if(i!=o){e[0]=o;switch(i){case"a":e[6]+=a;e[7]+=n;break;case"v":e[1]+=n;break;case"h":e[1]+=a;break;default:for(var s=1;s<e.length;){e[s++]+=a;e[s++]+=n}}}switch(o){case"Z":a=t;n=r;break;case"H":a=e[1];break;case"V":n=e[1];break;case"M":a=t=e[1];n=r=e[2];break;default:a=e[e.length-2];n=e[e.length-1]}return e}))}},{}],72:[function(e,t,r){var a=e("pad-left");t.exports=n;function n(e,t,r){t=typeof t==="number"?t:1;r=r||": ";var n=e.split(/\r?\n/);var i=String(n.length+t-1).length;return n.map((function(e,n){var o=n+t;var s=String(o).length;var l=a(o,i-s);return l+r+e})).join("\n")}},{"pad-left":479}],73:[function(e,t,r){"use strict";t.exports=i;var a=e("robust-orientation");function n(e,t){var r=new Array(t+1);for(var n=0;n<e.length;++n){r[n]=e[n]}for(var n=0;n<=e.length;++n){for(var i=e.length;i<=t;++i){var o=new Array(t);for(var s=0;s<t;++s){o[s]=Math.pow(i+1-n,s)}r[i]=o}var l=a.apply(void 0,r);if(l){return true}}return false}function i(e){var t=e.length;if(t===0){return[]}if(t===1){return[0]}var r=e[0].length;var a=[e[0]];var i=[0];for(var o=1;o<t;++o){a.push(e[o]);if(!n(a,r)){a.pop();continue}i.push(o);if(i.length===r+1){return i}}return i}},{"robust-orientation":534}],74:[function(e,t,r){"use strict";t.exports=i;var a=e("delaunay-triangulate");var n=e("circumradius");function i(e,t){return a(t).filter((function(r){var a=new Array(r.length);for(var i=0;i<r.length;++i){a[i]=t[r[i]]}return n(a)*e<1}))}},{circumradius:125,"delaunay-triangulate":177}],75:[function(e,t,r){t.exports=i;var a=e("alpha-complex");var n=e("simplicial-complex-boundary");function i(e,t){return n(a(e,t))}},{"alpha-complex":74,"simplicial-complex-boundary":542}],76:[function(e,t,r){"use strict";t.exports=a;function a(e,t){if(!e||e.length==null)throw Error("Argument should be an array");if(t==null)t=1;else t=Math.floor(t);var r=Array(t*2);for(var a=0;a<t;a++){var n=-Infinity,i=Infinity,o=a,s=e.length;for(;o<s;o+=t){if(e[o]>n)n=e[o];if(e[o]<i)i=e[o]}r[a]=i;r[t+a]=n}return r}},{}],77:[function(e,t,r){"use strict";t.exports=function(e,t,r){if(typeof Array.prototype.findIndex==="function"){return e.findIndex(t,r)}if(typeof t!=="function"){throw new TypeError("predicate must be a function")}var a=Object(e);var n=a.length;if(n===0){return-1}for(var i=0;i<n;i++){if(t.call(r,a[i],i,a)){return i}}return-1}},{}],78:[function(e,t,r){"use strict";var a=e("array-bounds");t.exports=n;function n(e,t,r){if(!e||e.length==null)throw Error("Argument should be an array");if(t==null)t=1;if(r==null)r=a(e,t);for(var n=0;n<t;n++){var i=r[t+n],o=r[n],s=n,l=e.length;if(i===Infinity&&o===-Infinity){for(s=n;s<l;s+=t){e[s]=e[s]===i?1:e[s]===o?0:.5}}else if(i===Infinity){for(s=n;s<l;s+=t){e[s]=e[s]===i?1:0}}else if(o===-Infinity){for(s=n;s<l;s+=t){e[s]=e[s]===o?0:1}}else{var u=i-o;for(s=n;s<l;s+=t){if(!isNaN(e[s])){e[s]=u===0?.5:(e[s]-o)/u}}}}return e}},{"array-bounds":76}],79:[function(e,t,r){t.exports=function e(t,r){var a=typeof t==="number",n=typeof r==="number";if(a&&!n){r=t;t=0}else if(!a&&!n){t=0;r=0}t=t|0;r=r|0;var i=r-t;if(i<0)throw new Error("array length must be positive");var o=new Array(i);for(var s=0,l=t;s<i;s++,l++)o[s]=l;return o}},{}],80:[function(e,r,a){(function(t){(function(){"use strict";var a=e("object-assign");function n(e,t){if(e===t){return 0}var r=e.length;var a=t.length;for(var n=0,i=Math.min(r,a);n<i;++n){if(e[n]!==t[n]){r=e[n];a=t[n];break}}if(r<a){return-1}if(a<r){return 1}return 0}function i(e){if(t.Buffer&&typeof t.Buffer.isBuffer==="function"){return t.Buffer.isBuffer(e)}return!!(e!=null&&e._isBuffer)}var o=e("util/");var s=Object.prototype.hasOwnProperty;var l=Array.prototype.slice;var u=function(){return function e(){}.name==="foo"}();function c(e){return Object.prototype.toString.call(e)}function f(e){if(i(e)){return false}if(typeof t.ArrayBuffer!=="function"){return false}if(typeof ArrayBuffer.isView==="function"){return ArrayBuffer.isView(e)}if(!e){return false}if(e instanceof DataView){return true}if(e.buffer&&e.buffer instanceof ArrayBuffer){return true}return false}var h=r.exports=x;var p=/\s*function\s+([^\(\s]*)\s*/;function v(e){if(!o.isFunction(e)){return}if(u){return e.name}var t=e.toString();var r=t.match(p);return r&&r[1]}h.AssertionError=function e(t){this.name="AssertionError";this.actual=t.actual;this.expected=t.expected;this.operator=t.operator;if(t.message){this.message=t.message;this.generatedMessage=false}else{this.message=g(this);this.generatedMessage=true}var r=t.stackStartFunction||y;if(Error.captureStackTrace){Error.captureStackTrace(this,r)}else{var a=new Error;if(a.stack){var n=a.stack;var i=v(r);var o=n.indexOf("\n"+i);if(o>=0){var s=n.indexOf("\n",o+1);n=n.substring(s+1)}this.stack=n}}};o.inherits(h.AssertionError,Error);function d(e,t){if(typeof e==="string"){return e.length<t?e:e.slice(0,t)}else{return e}}function m(e){if(u||!o.isFunction(e)){return o.inspect(e)}var t=v(e);var r=t?": "+t:"";return"[Function"+r+"]"}function g(e){return d(m(e.actual),128)+" "+e.operator+" "+d(m(e.expected),128)}function y(e,t,r,a,n){throw new h.AssertionError({message:r,actual:e,expected:t,operator:a,stackStartFunction:n})}h.fail=y;function x(e,t){if(!e)y(e,true,t,"==",h.ok)}h.ok=x;h.equal=function e(t,r,a){if(t!=r)y(t,r,a,"==",h.equal)};h.notEqual=function e(t,r,a){if(t==r){y(t,r,a,"!=",h.notEqual)}};h.deepEqual=function e(t,r,a){if(!b(t,r,false)){y(t,r,a,"deepEqual",h.deepEqual)}};h.deepStrictEqual=function e(t,r,a){if(!b(t,r,true)){y(t,r,a,"deepStrictEqual",h.deepStrictEqual)}};function b(e,t,r,a){if(e===t){return true}else if(i(e)&&i(t)){return n(e,t)===0}else if(o.isDate(e)&&o.isDate(t)){return e.getTime()===t.getTime()}else if(o.isRegExp(e)&&o.isRegExp(t)){return e.source===t.source&&e.global===t.global&&e.multiline===t.multiline&&e.lastIndex===t.lastIndex&&e.ignoreCase===t.ignoreCase}else if((e===null||typeof e!=="object")&&(t===null||typeof t!=="object")){return r?e===t:e==t}else if(f(e)&&f(t)&&c(e)===c(t)&&!(e instanceof Float32Array||e instanceof Float64Array)){return n(new Uint8Array(e.buffer),new Uint8Array(t.buffer))===0}else if(i(e)!==i(t)){return false}else{a=a||{actual:[],expected:[]};var s=a.actual.indexOf(e);if(s!==-1){if(s===a.expected.indexOf(t)){return true}}a.actual.push(e);a.expected.push(t);return w(e,t,r,a)}}function _(e){return Object.prototype.toString.call(e)=="[object Arguments]"}function w(e,t,r,a){if(e===null||e===undefined||t===null||t===undefined)return false;if(o.isPrimitive(e)||o.isPrimitive(t))return e===t;if(r&&Object.getPrototypeOf(e)!==Object.getPrototypeOf(t))return false;var n=_(e);var i=_(t);if(n&&!i||!n&&i)return false;if(n){e=l.call(e);t=l.call(t);return b(e,t,r)}var s=E(e);var u=E(t);var c,f;if(s.length!==u.length)return false;s.sort();u.sort();for(f=s.length-1;f>=0;f--){if(s[f]!==u[f])return false}for(f=s.length-1;f>=0;f--){c=s[f];if(!b(e[c],t[c],r,a))return false}return true}h.notDeepEqual=function e(t,r,a){if(b(t,r,false)){y(t,r,a,"notDeepEqual",h.notDeepEqual)}};h.notDeepStrictEqual=T;function T(e,t,r){if(b(e,t,true)){y(e,t,r,"notDeepStrictEqual",T)}}h.strictEqual=function e(t,r,a){if(t!==r){y(t,r,a,"===",h.strictEqual)}};h.notStrictEqual=function e(t,r,a){if(t===r){y(t,r,a,"!==",h.notStrictEqual)}};function k(e,t){if(!e||!t){return false}if(Object.prototype.toString.call(t)=="[object RegExp]"){return t.test(e)}try{if(e instanceof t){return true}}catch(r){}if(Error.isPrototypeOf(t)){return false}return t.call({},e)===true}function M(e){var t;try{e()}catch(r){t=r}return t}function A(e,t,r,a){var n;if(typeof t!=="function"){throw new TypeError('"block" argument must be a function')}if(typeof r==="string"){a=r;r=null}n=M(t);a=(r&&r.name?" ("+r.name+").":".")+(a?" "+a:".");if(e&&!n){y(n,r,"Missing expected exception"+a)}var i=typeof a==="string";var s=!e&&o.isError(n);var l=!e&&n&&!r;if(s&&i&&k(n,r)||l){y(n,r,"Got unwanted exception"+a)}if(e&&n&&r&&!k(n,r)||!e&&n){throw n}}h.throws=function(e,t,r){A(true,e,t,r)};h.doesNotThrow=function(e,t,r){A(false,e,t,r)};h.ifError=function(e){if(e)throw e};function S(e,t){if(!e)y(e,true,t,"==",S)}h.strict=a(S,h,{equal:h.strictEqual,deepEqual:h.deepStrictEqual,notEqual:h.notStrictEqual,notDeepEqual:h.notDeepStrictEqual});h.strict.strict=h.strict;var E=Object.keys||function(e){var t=[];for(var r in e){if(s.call(e,r))t.push(r)}return t}}).call(this)}).call(this,typeof t!=="undefined"?t:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"object-assign":476,"util/":83}],81:[function(e,t,r){if(typeof Object.create==="function"){t.exports=function e(t,r){t.super_=r;t.prototype=Object.create(r.prototype,{constructor:{value:t,enumerable:false,writable:true,configurable:true}})}}else{t.exports=function e(t,r){t.super_=r;var a=function(){};a.prototype=r.prototype;t.prototype=new a;t.prototype.constructor=t}}},{}],82:[function(e,t,r){t.exports=function e(t){return t&&typeof t==="object"&&typeof t.copy==="function"&&typeof t.fill==="function"&&typeof t.readUInt8==="function"}},{}],83:[function(e,r,a){(function(t,r){(function(){var n=/%[sdj%]/g;a.format=function(e){if(!w(e)){var t=[];for(var r=0;r<arguments.length;r++){t.push(s(arguments[r]))}return t.join(" ")}var r=1;var a=arguments;var i=a.length;var o=String(e).replace(n,(function(e){if(e==="%%")return"%";if(r>=i)return e;switch(e){case"%s":return String(a[r++]);case"%d":return Number(a[r++]);case"%j":try{return JSON.stringify(a[r++])}catch(t){return"[Circular]"}default:return e}}));for(var l=a[r];r<i;l=a[++r]){if(x(l)||!A(l)){o+=" "+l}else{o+=" "+s(l)}}return o};a.deprecate=function(e,n){if(k(r.process)){return function(){return a.deprecate(e,n).apply(this,arguments)}}if(t.noDeprecation===true){return e}var i=false;function o(){if(!i){if(t.throwDeprecation){throw new Error(n)}else if(t.traceDeprecation){console.trace(n)}else{console.error(n)}i=true}return e.apply(this,arguments)}return o};var i={};var o;a.debuglog=function(e){if(k(o))o=t.env.NODE_DEBUG||"";e=e.toUpperCase();if(!i[e]){if(new RegExp("\\b"+e+"\\b","i").test(o)){var r=t.pid;i[e]=function(){var t=a.format.apply(a,arguments);console.error("%s %d: %s",e,r,t)}}else{i[e]=function(){}}}return i[e]};function s(e,t){var r={seen:[],stylize:u};if(arguments.length>=3)r.depth=arguments[2];if(arguments.length>=4)r.colors=arguments[3];if(y(t)){r.showHidden=t}else if(t){a._extend(r,t)}if(k(r.showHidden))r.showHidden=false;if(k(r.depth))r.depth=2;if(k(r.colors))r.colors=false;if(k(r.customInspect))r.customInspect=true;if(r.colors)r.stylize=l;return f(r,e,r.depth)}a.inspect=s;s.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]};s.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function l(e,t){var r=s.styles[t];if(r){return"["+s.colors[r][0]+"m"+e+"["+s.colors[r][1]+"m"}else{return e}}function u(e,t){return e}function c(e){var t={};e.forEach((function(e,r){t[e]=true}));return t}function f(e,t,r){if(e.customInspect&&t&&L(t.inspect)&&t.inspect!==a.inspect&&!(t.constructor&&t.constructor.prototype===t)){var n=t.inspect(r,e);if(!w(n)){n=f(e,n,r)}return n}var i=h(e,t);if(i){return i}var o=Object.keys(t);var s=c(o);if(e.showHidden){o=Object.getOwnPropertyNames(t)}if(E(t)&&(o.indexOf("message")>=0||o.indexOf("description")>=0)){return p(t)}if(o.length===0){if(L(t)){var l=t.name?": "+t.name:"";return e.stylize("[Function"+l+"]","special")}if(M(t)){return e.stylize(RegExp.prototype.toString.call(t),"regexp")}if(S(t)){return e.stylize(Date.prototype.toString.call(t),"date")}if(E(t)){return p(t)}}var u="",y=false,x=["{","}"];if(g(t)){y=true;x=["[","]"]}if(L(t)){var b=t.name?": "+t.name:"";u=" [Function"+b+"]"}if(M(t)){u=" "+RegExp.prototype.toString.call(t)}if(S(t)){u=" "+Date.prototype.toUTCString.call(t)}if(E(t)){u=" "+p(t)}if(o.length===0&&(!y||t.length==0)){return x[0]+u+x[1]}if(r<0){if(M(t)){return e.stylize(RegExp.prototype.toString.call(t),"regexp")}else{return e.stylize("[Object]","special")}}e.seen.push(t);var _;if(y){_=v(e,t,r,s,o)}else{_=o.map((function(a){return d(e,t,r,s,a,y)}))}e.seen.pop();return m(_,u,x)}function h(e,t){if(k(t))return e.stylize("undefined","undefined");if(w(t)){var r="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(r,"string")}if(_(t))return e.stylize(""+t,"number");if(y(t))return e.stylize(""+t,"boolean");if(x(t))return e.stylize("null","null")}function p(e){return"["+Error.prototype.toString.call(e)+"]"}function v(e,t,r,a,n){var i=[];for(var o=0,s=t.length;o<s;++o){if(D(t,String(o))){i.push(d(e,t,r,a,String(o),true))}else{i.push("")}}n.forEach((function(n){if(!n.match(/^\d+$/)){i.push(d(e,t,r,a,n,true))}}));return i}function d(e,t,r,a,n,i){var o,s,l;l=Object.getOwnPropertyDescriptor(t,n)||{value:t[n]};if(l.get){if(l.set){s=e.stylize("[Getter/Setter]","special")}else{s=e.stylize("[Getter]","special")}}else{if(l.set){s=e.stylize("[Setter]","special")}}if(!D(a,n)){o="["+n+"]"}if(!s){if(e.seen.indexOf(l.value)<0){if(x(r)){s=f(e,l.value,null)}else{s=f(e,l.value,r-1)}if(s.indexOf("\n")>-1){if(i){s=s.split("\n").map((function(e){return"  "+e})).join("\n").substr(2)}else{s="\n"+s.split("\n").map((function(e){return"   "+e})).join("\n")}}}else{s=e.stylize("[Circular]","special")}}if(k(o)){if(i&&n.match(/^\d+$/)){return s}o=JSON.stringify(""+n);if(o.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)){o=o.substr(1,o.length-2);o=e.stylize(o,"name")}else{o=o.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'");o=e.stylize(o,"string")}}return o+": "+s}function m(e,t,r){var a=0;var n=e.reduce((function(e,t){a++;if(t.indexOf("\n")>=0)a++;return e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0);if(n>60){return r[0]+(t===""?"":t+"\n ")+" "+e.join(",\n  ")+" "+r[1]}return r[0]+t+" "+e.join(", ")+" "+r[1]}function g(e){return Array.isArray(e)}a.isArray=g;function y(e){return typeof e==="boolean"}a.isBoolean=y;function x(e){return e===null}a.isNull=x;function b(e){return e==null}a.isNullOrUndefined=b;function _(e){return typeof e==="number"}a.isNumber=_;function w(e){return typeof e==="string"}a.isString=w;function T(e){return typeof e==="symbol"}a.isSymbol=T;function k(e){return e===void 0}a.isUndefined=k;function M(e){return A(e)&&I(e)==="[object RegExp]"}a.isRegExp=M;function A(e){return typeof e==="object"&&e!==null}a.isObject=A;function S(e){return A(e)&&I(e)==="[object Date]"}a.isDate=S;function E(e){return A(e)&&(I(e)==="[object Error]"||e instanceof Error)}a.isError=E;function L(e){return typeof e==="function"}a.isFunction=L;function C(e){return e===null||typeof e==="boolean"||typeof e==="number"||typeof e==="string"||typeof e==="symbol"||typeof e==="undefined"}a.isPrimitive=C;a.isBuffer=e("./support/isBuffer");function I(e){return Object.prototype.toString.call(e)}function P(e){return e<10?"0"+e.toString(10):e.toString(10)}var O=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function z(){var e=new Date;var t=[P(e.getHours()),P(e.getMinutes()),P(e.getSeconds())].join(":");return[e.getDate(),O[e.getMonth()],t].join(" ")}a.log=function(){console.log("%s - %s",z(),a.format.apply(a,arguments))};a.inherits=e("inherits");a._extend=function(e,t){if(!t||!A(t))return e;var r=Object.keys(t);var a=r.length;while(a--){e[r[a]]=t[r[a]]}return e};function D(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}).call(this)}).call(this,e("_process"),typeof t!=="undefined"?t:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./support/isBuffer":82,_process:514,inherits:81}],84:[function(e,t,r){t.exports=function e(t){return atob(t)}},{}],85:[function(e,t,r){"use strict";t.exports=i;var a=e("robust-linear-solve");function n(e){var t=0;for(var r=0;r<e.length;++r){t+=e[r]}return t}function i(e,t){var r=t.length;var i=new Array(r+1);for(var o=0;o<r;++o){var s=new Array(r+1);for(var l=0;l<=r;++l){s[l]=e[l][o]}i[o]=s}i[r]=new Array(r+1);for(var o=0;o<=r;++o){i[r][o]=1}var u=new Array(r+1);for(var o=0;o<r;++o){u[o]=t[o]}u[r]=1;var c=a(i,u);var f=n(c[r+1]);if(f===0){f=1}var h=new Array(r+1);for(var o=0;o<=r;++o){h[o]=n(c[o])/f}return h}},{"robust-linear-solve":533}],86:[function(e,t,r){"use strict";r.byteLength=c;r.toByteArray=h;r.fromByteArray=d;var a=[];var n=[];var i=typeof Uint8Array!=="undefined"?Uint8Array:Array;var o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var s=0,l=o.length;s<l;++s){a[s]=o[s];n[o.charCodeAt(s)]=s}n["-".charCodeAt(0)]=62;n["_".charCodeAt(0)]=63;function u(e){var t=e.length;if(t%4>0){throw new Error("Invalid string. Length must be a multiple of 4")}var r=e.indexOf("=");if(r===-1)r=t;var a=r===t?0:4-r%4;return[r,a]}function c(e){var t=u(e);var r=t[0];var a=t[1];return(r+a)*3/4-a}function f(e,t,r){return(t+r)*3/4-r}function h(e){var t;var r=u(e);var a=r[0];var o=r[1];var s=new i(f(e,a,o));var l=0;var c=o>0?a-4:a;var h;for(h=0;h<c;h+=4){t=n[e.charCodeAt(h)]<<18|n[e.charCodeAt(h+1)]<<12|n[e.charCodeAt(h+2)]<<6|n[e.charCodeAt(h+3)];s[l++]=t>>16&255;s[l++]=t>>8&255;s[l++]=t&255}if(o===2){t=n[e.charCodeAt(h)]<<2|n[e.charCodeAt(h+1)]>>4;s[l++]=t&255}if(o===1){t=n[e.charCodeAt(h)]<<10|n[e.charCodeAt(h+1)]<<4|n[e.charCodeAt(h+2)]>>2;s[l++]=t>>8&255;s[l++]=t&255}return s}function p(e){return a[e>>18&63]+a[e>>12&63]+a[e>>6&63]+a[e&63]}function v(e,t,r){var a;var n=[];for(var i=t;i<r;i+=3){a=(e[i]<<16&16711680)+(e[i+1]<<8&65280)+(e[i+2]&255);n.push(p(a))}return n.join("")}function d(e){var t;var r=e.length;var n=r%3;var i=[];var o=16383;for(var s=0,l=r-n;s<l;s+=o){i.push(v(e,s,s+o>l?l:s+o))}if(n===1){t=e[r-1];i.push(a[t>>2]+a[t<<4&63]+"==")}else if(n===2){t=(e[r-2]<<8)+e[r-1];i.push(a[t>>10]+a[t>>4&63]+a[t<<2&63]+"=")}return i.join("")}},{}],87:[function(e,t,r){"use strict";var a=e("./lib/rationalize");t.exports=n;function n(e,t){return a(e[0].mul(t[1]).add(t[0].mul(e[1])),e[1].mul(t[1]))}},{"./lib/rationalize":97}],88:[function(e,t,r){"use strict";t.exports=a;function a(e,t){return e[0].mul(t[1]).cmp(t[0].mul(e[1]))}},{}],89:[function(e,t,r){"use strict";var a=e("./lib/rationalize");t.exports=n;function n(e,t){return a(e[0].mul(t[1]),e[1].mul(t[0]))}},{"./lib/rationalize":97}],90:[function(e,t,r){"use strict";var a=e("./is-rat");var n=e("./lib/is-bn");var i=e("./lib/num-to-bn");var o=e("./lib/str-to-bn");var s=e("./lib/rationalize");var l=e("./div");t.exports=u;function u(e,t){if(a(e)){if(t){return l(e,u(t))}return[e[0].clone(),e[1].clone()]}var r=0;var c,f;if(n(e)){c=e.clone()}else if(typeof e==="string"){c=o(e)}else if(e===0){return[i(0),i(1)]}else if(e===Math.floor(e)){c=i(e)}else{while(e!==Math.floor(e)){e=e*Math.pow(2,256);r-=256}c=i(e)}if(a(t)){c.mul(t[1]);f=t[0].clone()}else if(n(t)){f=t.clone()}else if(typeof t==="string"){f=o(t)}else if(!t){f=i(1)}else if(t===Math.floor(t)){f=i(t)}else{while(t!==Math.floor(t)){t=t*Math.pow(2,256);r+=256}f=i(t)}if(r>0){c=c.ushln(r)}else if(r<0){f=f.ushln(-r)}return s(c,f)}},{"./div":89,"./is-rat":91,"./lib/is-bn":95,"./lib/num-to-bn":96,"./lib/rationalize":97,"./lib/str-to-bn":98}],91:[function(e,t,r){"use strict";var a=e("./lib/is-bn");t.exports=n;function n(e){return Array.isArray(e)&&e.length===2&&a(e[0])&&a(e[1])}},{"./lib/is-bn":95}],92:[function(e,t,r){"use strict";var a=e("bn.js");t.exports=n;function n(e){return e.cmp(new a(0))}},{"bn.js":106}],93:[function(e,t,r){"use strict";var a=e("./bn-sign");t.exports=n;function n(e){var t=e.length;var r=e.words;var n=0;if(t===1){n=r[0]}else if(t===2){n=r[0]+r[1]*67108864}else{for(var i=0;i<t;i++){var o=r[i];n+=o*Math.pow(67108864,i)}}return a(e)*n}},{"./bn-sign":92}],94:[function(e,t,r){"use strict";var a=e("double-bits");var n=e("bit-twiddle").countTrailingZeros;t.exports=i;function i(e){var t=n(a.lo(e));if(t<32){return t}var r=n(a.hi(e));if(r>20){return 52}return r+32}},{"bit-twiddle":104,"double-bits":179}],95:[function(e,t,r){"use strict";var a=e("bn.js");t.exports=n;function n(e){return e&&typeof e==="object"&&Boolean(e.words)}},{"bn.js":106}],96:[function(e,t,r){"use strict";var a=e("bn.js");var n=e("double-bits");t.exports=i;function i(e){var t=n.exponent(e);if(t<52){return new a(e)}else{return new a(e*Math.pow(2,52-t)).ushln(t-52)}}},{"bn.js":106,"double-bits":179}],97:[function(e,t,r){"use strict";var a=e("./num-to-bn");var n=e("./bn-sign");t.exports=i;function i(e,t){var r=n(e);var i=n(t);if(r===0){return[a(0),a(1)]}if(i===0){return[a(0),a(0)]}if(i<0){e=e.neg();t=t.neg()}var o=e.gcd(t);if(o.cmpn(1)){return[e.div(o),t.div(o)]}return[e,t]}},{"./bn-sign":92,"./num-to-bn":96}],98:[function(e,t,r){"use strict";var a=e("bn.js");t.exports=n;function n(e){return new a(e)}},{"bn.js":106}],99:[function(e,t,r){"use strict";var a=e("./lib/rationalize");t.exports=n;function n(e,t){return a(e[0].mul(t[0]),e[1].mul(t[1]))}},{"./lib/rationalize":97}],100:[function(e,t,r){"use strict";var a=e("./lib/bn-sign");t.exports=n;function n(e){return a(e[0])*a(e[1])}},{"./lib/bn-sign":92}],101:[function(e,t,r){"use strict";var a=e("./lib/rationalize");t.exports=n;function n(e,t){return a(e[0].mul(t[1]).sub(e[1].mul(t[0])),e[1].mul(t[1]))}},{"./lib/rationalize":97}],102:[function(e,t,r){"use strict";var a=e("./lib/bn-to-num");var n=e("./lib/ctz");t.exports=i;function i(e){var t=e[0];var r=e[1];if(t.cmpn(0)===0){return 0}var i=t.abs().divmod(r.abs());var o=i.div;var s=a(o);var l=i.mod;var u=t.negative!==r.negative?-1:1;if(l.cmpn(0)===0){return u*s}if(s){var c=n(s)+4;var f=a(l.ushln(c).divRound(r));return u*(s+f*Math.pow(2,-c))}else{var h=r.bitLength()-l.bitLength()+53;var f=a(l.ushln(h).divRound(r));if(h<1023){return u*f*Math.pow(2,-h)}f*=Math.pow(2,-1023);return u*f*Math.pow(2,1023-h)}}},{"./lib/bn-to-num":93,"./lib/ctz":94}],103:[function(e,t,r){"use strict";function a(e,t,r,a,n){var i=n+1;while(a<=n){var o=a+n>>>1,s=e[o];var l=r!==undefined?r(s,t):s-t;if(l>=0){i=o;n=o-1}else{a=o+1}}return i}function n(e,t,r,a,n){var i=n+1;while(a<=n){var o=a+n>>>1,s=e[o];var l=r!==undefined?r(s,t):s-t;if(l>0){i=o;n=o-1}else{a=o+1}}return i}function i(e,t,r,a,n){var i=a-1;while(a<=n){var o=a+n>>>1,s=e[o];var l=r!==undefined?r(s,t):s-t;if(l<0){i=o;a=o+1}else{n=o-1}}return i}function o(e,t,r,a,n){var i=a-1;while(a<=n){var o=a+n>>>1,s=e[o];var l=r!==undefined?r(s,t):s-t;if(l<=0){i=o;a=o+1}else{n=o-1}}return i}function s(e,t,r,a,n){while(a<=n){var i=a+n>>>1,o=e[i];var s=r!==undefined?r(o,t):o-t;if(s===0){return i}if(s<=0){a=i+1}else{n=i-1}}return-1}function l(e,t,r,a,n,i){if(typeof r==="function"){return i(e,t,r,a===undefined?0:a|0,n===undefined?e.length-1:n|0)}return i(e,t,undefined,r===undefined?0:r|0,a===undefined?e.length-1:a|0)}t.exports={ge:function(e,t,r,n,i){return l(e,t,r,n,i,a)},gt:function(e,t,r,a,i){return l(e,t,r,a,i,n)},lt:function(e,t,r,a,n){return l(e,t,r,a,n,i)},le:function(e,t,r,a,n){return l(e,t,r,a,n,o)},eq:function(e,t,r,a,n){return l(e,t,r,a,n,s)}}},{}],104:[function(e,t,r){"use strict";"use restrict";var a=32;r.INT_BITS=a;r.INT_MAX=2147483647;r.INT_MIN=-1<<a-1;r.sign=function(e){return(e>0)-(e<0)};r.abs=function(e){var t=e>>a-1;return(e^t)-t};r.min=function(e,t){return t^(e^t)&-(e<t)};r.max=function(e,t){return e^(e^t)&-(e<t)};r.isPow2=function(e){return!(e&e-1)&&!!e};r.log2=function(e){var t,r;t=(e>65535)<<4;e>>>=t;r=(e>255)<<3;e>>>=r;t|=r;r=(e>15)<<2;e>>>=r;t|=r;r=(e>3)<<1;e>>>=r;t|=r;return t|e>>1};r.log10=function(e){return e>=1e9?9:e>=1e8?8:e>=1e7?7:e>=1e6?6:e>=1e5?5:e>=1e4?4:e>=1e3?3:e>=100?2:e>=10?1:0};r.popCount=function(e){e=e-(e>>>1&1431655765);e=(e&858993459)+(e>>>2&858993459);return(e+(e>>>4)&252645135)*16843009>>>24};function n(e){var t=32;e&=-e;if(e)t--;if(e&65535)t-=16;if(e&16711935)t-=8;if(e&252645135)t-=4;if(e&858993459)t-=2;if(e&1431655765)t-=1;return t}r.countTrailingZeros=n;r.nextPow2=function(e){e+=e===0;--e;e|=e>>>1;e|=e>>>2;e|=e>>>4;e|=e>>>8;e|=e>>>16;return e+1};r.prevPow2=function(e){e|=e>>>1;e|=e>>>2;e|=e>>>4;e|=e>>>8;e|=e>>>16;return e-(e>>>1)};r.parity=function(e){e^=e>>>16;e^=e>>>8;e^=e>>>4;e&=15;return 27030>>>e&1};var i=new Array(256);(function(e){for(var t=0;t<256;++t){var r=t,a=t,n=7;for(r>>>=1;r;r>>>=1){a<<=1;a|=r&1;--n}e[t]=a<<n&255}})(i);r.reverse=function(e){return i[e&255]<<24|i[e>>>8&255]<<16|i[e>>>16&255]<<8|i[e>>>24&255]};r.interleave2=function(e,t){e&=65535;e=(e|e<<8)&16711935;e=(e|e<<4)&252645135;e=(e|e<<2)&858993459;e=(e|e<<1)&1431655765;t&=65535;t=(t|t<<8)&16711935;t=(t|t<<4)&252645135;t=(t|t<<2)&858993459;t=(t|t<<1)&1431655765;return e|t<<1};r.deinterleave2=function(e,t){e=e>>>t&1431655765;e=(e|e>>>1)&858993459;e=(e|e>>>2)&252645135;e=(e|e>>>4)&16711935;e=(e|e>>>16)&65535;return e<<16>>16};r.interleave3=function(e,t,r){e&=1023;e=(e|e<<16)&4278190335;e=(e|e<<8)&251719695;e=(e|e<<4)&3272356035;e=(e|e<<2)&1227133513;t&=1023;t=(t|t<<16)&4278190335;t=(t|t<<8)&251719695;t=(t|t<<4)&3272356035;t=(t|t<<2)&1227133513;e|=t<<1;r&=1023;r=(r|r<<16)&4278190335;r=(r|r<<8)&251719695;r=(r|r<<4)&3272356035;r=(r|r<<2)&1227133513;return e|r<<2};r.deinterleave3=function(e,t){e=e>>>t&1227133513;e=(e|e>>>2)&3272356035;e=(e|e>>>4)&251719695;e=(e|e>>>8)&4278190335;e=(e|e>>>16)&1023;return e<<22>>22};r.nextCombination=function(e){var t=e|e-1;return t+1|(~t&-~t)-1>>>n(e)+1}},{}],105:[function(e,t,r){"use strict";var a=e("clamp");t.exports=i;var n=1e20;function i(e,t){if(!t)t={};var r=t.cutoff==null?.25:t.cutoff;var i=t.radius==null?8:t.radius;var s=t.channel||0;var l,u,c,f,h,p,v,d,m,g,y;if(ArrayBuffer.isView(e)||Array.isArray(e)){if(!t.width||!t.height)throw Error("For raw data width and height should be provided by options");l=t.width,u=t.height;f=e;if(!t.stride)p=Math.floor(e.length/l/u);else p=t.stride}else{if(window.HTMLCanvasElement&&e instanceof window.HTMLCanvasElement){d=e;v=d.getContext("2d");l=d.width,u=d.height;m=v.getImageData(0,0,l,u);f=m.data;p=4}else if(window.CanvasRenderingContext2D&&e instanceof window.CanvasRenderingContext2D){d=e.canvas;v=e;l=d.width,u=d.height;m=v.getImageData(0,0,l,u);f=m.data;p=4}else if(window.ImageData&&e instanceof window.ImageData){m=e;l=e.width,u=e.height;f=m.data;p=4}}c=Math.max(l,u);if(window.Uint8ClampedArray&&f instanceof window.Uint8ClampedArray||window.Uint8Array&&f instanceof window.Uint8Array){h=f;f=Array(l*u);for(g=0,y=h.length;g<y;g++){f[g]=h[g*p+s]/255}}else{if(p!==1)throw Error("Raw data can have only 1 value per pixel")}var x=Array(l*u);var b=Array(l*u);var _=Array(c);var w=Array(c);var T=Array(c+1);var k=Array(c);for(g=0,y=l*u;g<y;g++){var M=f[g];x[g]=M===1?0:M===0?n:Math.pow(Math.max(0,.5-M),2);b[g]=M===1?n:M===0?0:Math.pow(Math.max(0,M-.5),2)}o(x,l,u,_,w,k,T);o(b,l,u,_,w,k,T);var A=window.Float32Array?new Float32Array(l*u):new Array(l*u);for(g=0,y=l*u;g<y;g++){A[g]=a(1-((x[g]-b[g])/i+r),0,1)}return A}function o(e,t,r,a,n,i,o){for(var l=0;l<t;l++){for(var u=0;u<r;u++){a[u]=e[u*t+l]}s(a,n,i,o,r);for(u=0;u<r;u++){e[u*t+l]=n[u]}}for(u=0;u<r;u++){for(l=0;l<t;l++){a[l]=e[u*t+l]}s(a,n,i,o,t);for(l=0;l<t;l++){e[u*t+l]=Math.sqrt(n[l])}}}function s(e,t,r,a,i){r[0]=0;a[0]=-n;a[1]=+n;for(var o=1,s=0;o<i;o++){var l=(e[o]+o*o-(e[r[s]]+r[s]*r[s]))/(2*o-2*r[s]);while(l<=a[s]){s--;l=(e[o]+o*o-(e[r[s]]+r[s]*r[s]))/(2*o-2*r[s])}s++;r[s]=o;a[s]=l;a[s+1]=+n}for(o=0,s=0;o<i;o++){while(a[s+1]<o)s++;t[o]=(o-r[s])*(o-r[s])+e[r[s]]}}},{clamp:126}],106:[function(e,t,r){(function(t,r){"use strict";function a(e,t){if(!e)throw new Error(t||"Assertion failed")}function n(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype;e.prototype=new r;e.prototype.constructor=e}function i(e,t,r){if(i.isBN(e)){return e}this.negative=0;this.words=null;this.length=0;this.red=null;if(e!==null){if(t==="le"||t==="be"){r=t;t=10}this._init(e||0,t||10,r||"be")}}if(typeof t==="object"){t.exports=i}else{r.BN=i}i.BN=i;i.wordSize=26;var o;try{o=e("buffer").Buffer}catch(A){}i.isBN=function e(t){if(t instanceof i){return true}return t!==null&&typeof t==="object"&&t.constructor.wordSize===i.wordSize&&Array.isArray(t.words)};i.max=function e(t,r){if(t.cmp(r)>0)return t;return r};i.min=function e(t,r){if(t.cmp(r)<0)return t;return r};i.prototype._init=function e(t,r,n){if(typeof t==="number"){return this._initNumber(t,r,n)}if(typeof t==="object"){return this._initArray(t,r,n)}if(r==="hex"){r=16}a(r===(r|0)&&r>=2&&r<=36);t=t.toString().replace(/\s+/g,"");var i=0;if(t[0]==="-"){i++}if(r===16){this._parseHex(t,i)}else{this._parseBase(t,r,i)}if(t[0]==="-"){this.negative=1}this.strip();if(n!=="le")return;this._initArray(this.toArray(),r,n)};i.prototype._initNumber=function e(t,r,n){if(t<0){this.negative=1;t=-t}if(t<67108864){this.words=[t&67108863];this.length=1}else if(t<4503599627370496){this.words=[t&67108863,t/67108864&67108863];this.length=2}else{a(t<9007199254740992);this.words=[t&67108863,t/67108864&67108863,1];this.length=3}if(n!=="le")return;this._initArray(this.toArray(),r,n)};i.prototype._initArray=function e(t,r,n){a(typeof t.length==="number");if(t.length<=0){this.words=[0];this.length=1;return this}this.length=Math.ceil(t.length/3);this.words=new Array(this.length);for(var i=0;i<this.length;i++){this.words[i]=0}var o,s;var l=0;if(n==="be"){for(i=t.length-1,o=0;i>=0;i-=3){s=t[i]|t[i-1]<<8|t[i-2]<<16;this.words[o]|=s<<l&67108863;this.words[o+1]=s>>>26-l&67108863;l+=24;if(l>=26){l-=26;o++}}}else if(n==="le"){for(i=0,o=0;i<t.length;i+=3){s=t[i]|t[i+1]<<8|t[i+2]<<16;this.words[o]|=s<<l&67108863;this.words[o+1]=s>>>26-l&67108863;l+=24;if(l>=26){l-=26;o++}}}return this.strip()};function s(e,t,r){var a=0;var n=Math.min(e.length,r);for(var i=t;i<n;i++){var o=e.charCodeAt(i)-48;a<<=4;if(o>=49&&o<=54){a|=o-49+10}else if(o>=17&&o<=22){a|=o-17+10}else{a|=o&15}}return a}i.prototype._parseHex=function e(t,r){this.length=Math.ceil((t.length-r)/6);this.words=new Array(this.length);for(var a=0;a<this.length;a++){this.words[a]=0}var n,i;var o=0;for(a=t.length-6,n=0;a>=r;a-=6){i=s(t,a,a+6);this.words[n]|=i<<o&67108863;this.words[n+1]|=i>>>26-o&4194303;o+=24;if(o>=26){o-=26;n++}}if(a+6!==r){i=s(t,r,a+6);this.words[n]|=i<<o&67108863;this.words[n+1]|=i>>>26-o&4194303}this.strip()};function l(e,t,r,a){var n=0;var i=Math.min(e.length,r);for(var o=t;o<i;o++){var s=e.charCodeAt(o)-48;n*=a;if(s>=49){n+=s-49+10}else if(s>=17){n+=s-17+10}else{n+=s}}return n}i.prototype._parseBase=function e(t,r,a){this.words=[0];this.length=1;for(var n=0,i=1;i<=67108863;i*=r){n++}n--;i=i/r|0;var o=t.length-a;var s=o%n;var u=Math.min(o,o-s)+a;var c=0;for(var f=a;f<u;f+=n){c=l(t,f,f+n,r);this.imuln(i);if(this.words[0]+c<67108864){this.words[0]+=c}else{this._iaddn(c)}}if(s!==0){var h=1;c=l(t,f,t.length,r);for(f=0;f<s;f++){h*=r}this.imuln(h);if(this.words[0]+c<67108864){this.words[0]+=c}else{this._iaddn(c)}}};i.prototype.copy=function e(t){t.words=new Array(this.length);for(var r=0;r<this.length;r++){t.words[r]=this.words[r]}t.length=this.length;t.negative=this.negative;t.red=this.red};i.prototype.clone=function e(){var t=new i(null);this.copy(t);return t};i.prototype._expand=function e(t){while(this.length<t){this.words[this.length++]=0}return this};i.prototype.strip=function e(){while(this.length>1&&this.words[this.length-1]===0){this.length--}return this._normSign()};i.prototype._normSign=function e(){if(this.length===1&&this.words[0]===0){this.negative=0}return this};i.prototype.inspect=function e(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var u=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"];var c=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5];var f=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];i.prototype.toString=function e(t,r){t=t||10;r=r|0||1;var n;if(t===16||t==="hex"){n="";var i=0;var o=0;for(var s=0;s<this.length;s++){var l=this.words[s];var h=((l<<i|o)&16777215).toString(16);o=l>>>24-i&16777215;if(o!==0||s!==this.length-1){n=u[6-h.length]+h+n}else{n=h+n}i+=2;if(i>=26){i-=26;s--}}if(o!==0){n=o.toString(16)+n}while(n.length%r!==0){n="0"+n}if(this.negative!==0){n="-"+n}return n}if(t===(t|0)&&t>=2&&t<=36){var p=c[t];var v=f[t];n="";var d=this.clone();d.negative=0;while(!d.isZero()){var m=d.modn(v).toString(t);d=d.idivn(v);if(!d.isZero()){n=u[p-m.length]+m+n}else{n=m+n}}if(this.isZero()){n="0"+n}while(n.length%r!==0){n="0"+n}if(this.negative!==0){n="-"+n}return n}a(false,"Base should be between 2 and 36")};i.prototype.toNumber=function e(){var t=this.words[0];if(this.length===2){t+=this.words[1]*67108864}else if(this.length===3&&this.words[2]===1){t+=4503599627370496+this.words[1]*67108864}else if(this.length>2){a(false,"Number can only safely store up to 53 bits")}return this.negative!==0?-t:t};i.prototype.toJSON=function e(){return this.toString(16)};i.prototype.toBuffer=function e(t,r){a(typeof o!=="undefined");return this.toArrayLike(o,t,r)};i.prototype.toArray=function e(t,r){return this.toArrayLike(Array,t,r)};i.prototype.toArrayLike=function e(t,r,n){var i=this.byteLength();var o=n||Math.max(1,i);a(i<=o,"byte array longer than desired length");a(o>0,"Requested array length <= 0");this.strip();var s=r==="le";var l=new t(o);var u,c;var f=this.clone();if(!s){for(c=0;c<o-i;c++){l[c]=0}for(c=0;!f.isZero();c++){u=f.andln(255);f.iushrn(8);l[o-c-1]=u}}else{for(c=0;!f.isZero();c++){u=f.andln(255);f.iushrn(8);l[c]=u}for(;c<o;c++){l[c]=0}}return l};if(Math.clz32){i.prototype._countBits=function e(t){return 32-Math.clz32(t)}}else{i.prototype._countBits=function e(t){var r=t;var a=0;if(r>=4096){a+=13;r>>>=13}if(r>=64){a+=7;r>>>=7}if(r>=8){a+=4;r>>>=4}if(r>=2){a+=2;r>>>=2}return a+r}}i.prototype._zeroBits=function e(t){if(t===0)return 26;var r=t;var a=0;if((r&8191)===0){a+=13;r>>>=13}if((r&127)===0){a+=7;r>>>=7}if((r&15)===0){a+=4;r>>>=4}if((r&3)===0){a+=2;r>>>=2}if((r&1)===0){a++}return a};i.prototype.bitLength=function e(){var t=this.words[this.length-1];var r=this._countBits(t);return(this.length-1)*26+r};function h(e){var t=new Array(e.bitLength());for(var r=0;r<t.length;r++){var a=r/26|0;var n=r%26;t[r]=(e.words[a]&1<<n)>>>n}return t}i.prototype.zeroBits=function e(){if(this.isZero())return 0;var t=0;for(var r=0;r<this.length;r++){var a=this._zeroBits(this.words[r]);t+=a;if(a!==26)break}return t};i.prototype.byteLength=function e(){return Math.ceil(this.bitLength()/8)};i.prototype.toTwos=function e(t){if(this.negative!==0){return this.abs().inotn(t).iaddn(1)}return this.clone()};i.prototype.fromTwos=function e(t){if(this.testn(t-1)){return this.notn(t).iaddn(1).ineg()}return this.clone()};i.prototype.isNeg=function e(){return this.negative!==0};i.prototype.neg=function e(){return this.clone().ineg()};i.prototype.ineg=function e(){if(!this.isZero()){this.negative^=1}return this};i.prototype.iuor=function e(t){while(this.length<t.length){this.words[this.length++]=0}for(var r=0;r<t.length;r++){this.words[r]=this.words[r]|t.words[r]}return this.strip()};i.prototype.ior=function e(t){a((this.negative|t.negative)===0);return this.iuor(t)};i.prototype.or=function e(t){if(this.length>t.length)return this.clone().ior(t);return t.clone().ior(this)};i.prototype.uor=function e(t){if(this.length>t.length)return this.clone().iuor(t);return t.clone().iuor(this)};i.prototype.iuand=function e(t){var r;if(this.length>t.length){r=t}else{r=this}for(var a=0;a<r.length;a++){this.words[a]=this.words[a]&t.words[a]}this.length=r.length;return this.strip()};i.prototype.iand=function e(t){a((this.negative|t.negative)===0);return this.iuand(t)};i.prototype.and=function e(t){if(this.length>t.length)return this.clone().iand(t);return t.clone().iand(this)};i.prototype.uand=function e(t){if(this.length>t.length)return this.clone().iuand(t);return t.clone().iuand(this)};i.prototype.iuxor=function e(t){var r;var a;if(this.length>t.length){r=this;a=t}else{r=t;a=this}for(var n=0;n<a.length;n++){this.words[n]=r.words[n]^a.words[n]}if(this!==r){for(;n<r.length;n++){this.words[n]=r.words[n]}}this.length=r.length;return this.strip()};i.prototype.ixor=function e(t){a((this.negative|t.negative)===0);return this.iuxor(t)};i.prototype.xor=function e(t){if(this.length>t.length)return this.clone().ixor(t);return t.clone().ixor(this)};i.prototype.uxor=function e(t){if(this.length>t.length)return this.clone().iuxor(t);return t.clone().iuxor(this)};i.prototype.inotn=function e(t){a(typeof t==="number"&&t>=0);var r=Math.ceil(t/26)|0;var n=t%26;this._expand(r);if(n>0){r--}for(var i=0;i<r;i++){this.words[i]=~this.words[i]&67108863}if(n>0){this.words[i]=~this.words[i]&67108863>>26-n}return this.strip()};i.prototype.notn=function e(t){return this.clone().inotn(t)};i.prototype.setn=function e(t,r){a(typeof t==="number"&&t>=0);var n=t/26|0;var i=t%26;this._expand(n+1);if(r){this.words[n]=this.words[n]|1<<i}else{this.words[n]=this.words[n]&~(1<<i)}return this.strip()};i.prototype.iadd=function e(t){var r;if(this.negative!==0&&t.negative===0){this.negative=0;r=this.isub(t);this.negative^=1;return this._normSign()}else if(this.negative===0&&t.negative!==0){t.negative=0;r=this.isub(t);t.negative=1;return r._normSign()}var a,n;if(this.length>t.length){a=this;n=t}else{a=t;n=this}var i=0;for(var o=0;o<n.length;o++){r=(a.words[o]|0)+(n.words[o]|0)+i;this.words[o]=r&67108863;i=r>>>26}for(;i!==0&&o<a.length;o++){r=(a.words[o]|0)+i;this.words[o]=r&67108863;i=r>>>26}this.length=a.length;if(i!==0){this.words[this.length]=i;this.length++}else if(a!==this){for(;o<a.length;o++){this.words[o]=a.words[o]}}return this};i.prototype.add=function e(t){var r;if(t.negative!==0&&this.negative===0){t.negative=0;r=this.sub(t);t.negative^=1;return r}else if(t.negative===0&&this.negative!==0){this.negative=0;r=t.sub(this);this.negative=1;return r}if(this.length>t.length)return this.clone().iadd(t);return t.clone().iadd(this)};i.prototype.isub=function e(t){if(t.negative!==0){t.negative=0;var r=this.iadd(t);t.negative=1;return r._normSign()}else if(this.negative!==0){this.negative=0;this.iadd(t);this.negative=1;return this._normSign()}var a=this.cmp(t);if(a===0){this.negative=0;this.length=1;this.words[0]=0;return this}var n,i;if(a>0){n=this;i=t}else{n=t;i=this}var o=0;for(var s=0;s<i.length;s++){r=(n.words[s]|0)-(i.words[s]|0)+o;o=r>>26;this.words[s]=r&67108863}for(;o!==0&&s<n.length;s++){r=(n.words[s]|0)+o;o=r>>26;this.words[s]=r&67108863}if(o===0&&s<n.length&&n!==this){for(;s<n.length;s++){this.words[s]=n.words[s]}}this.length=Math.max(this.length,s);if(n!==this){this.negative=1}return this.strip()};i.prototype.sub=function e(t){return this.clone().isub(t)};function p(e,t,r){r.negative=t.negative^e.negative;var a=e.length+t.length|0;r.length=a;a=a-1|0;var n=e.words[0]|0;var i=t.words[0]|0;var o=n*i;var s=o&67108863;var l=o/67108864|0;r.words[0]=s;for(var u=1;u<a;u++){var c=l>>>26;var f=l&67108863;var h=Math.min(u,t.length-1);for(var p=Math.max(0,u-e.length+1);p<=h;p++){var v=u-p|0;n=e.words[v]|0;i=t.words[p]|0;o=n*i+f;c+=o/67108864|0;f=o&67108863}r.words[u]=f|0;l=c|0}if(l!==0){r.words[u]=l|0}else{r.length--}return r.strip()}var v=function e(t,r,a){var n=t.words;var i=r.words;var o=a.words;var s=0;var l;var u;var c;var f=n[0]|0;var h=f&8191;var p=f>>>13;var v=n[1]|0;var d=v&8191;var m=v>>>13;var g=n[2]|0;var y=g&8191;var x=g>>>13;var b=n[3]|0;var _=b&8191;var w=b>>>13;var T=n[4]|0;var k=T&8191;var M=T>>>13;var A=n[5]|0;var S=A&8191;var E=A>>>13;var L=n[6]|0;var C=L&8191;var I=L>>>13;var P=n[7]|0;var O=P&8191;var z=P>>>13;var D=n[8]|0;var R=D&8191;var F=D>>>13;var B=n[9]|0;var N=B&8191;var j=B>>>13;var U=i[0]|0;var V=U&8191;var H=U>>>13;var q=i[1]|0;var G=q&8191;var Y=q>>>13;var W=i[2]|0;var X=W&8191;var Z=W>>>13;var J=i[3]|0;var K=J&8191;var Q=J>>>13;var $=i[4]|0;var ee=$&8191;var te=$>>>13;var re=i[5]|0;var ae=re&8191;var ne=re>>>13;var ie=i[6]|0;var oe=ie&8191;var se=ie>>>13;var le=i[7]|0;var ue=le&8191;var ce=le>>>13;var fe=i[8]|0;var he=fe&8191;var pe=fe>>>13;var ve=i[9]|0;var de=ve&8191;var me=ve>>>13;a.negative=t.negative^r.negative;a.length=19;l=Math.imul(h,V);u=Math.imul(h,H);u=u+Math.imul(p,V)|0;c=Math.imul(p,H);var ge=(s+l|0)+((u&8191)<<13)|0;s=(c+(u>>>13)|0)+(ge>>>26)|0;ge&=67108863;l=Math.imul(d,V);u=Math.imul(d,H);u=u+Math.imul(m,V)|0;c=Math.imul(m,H);l=l+Math.imul(h,G)|0;u=u+Math.imul(h,Y)|0;u=u+Math.imul(p,G)|0;c=c+Math.imul(p,Y)|0;var ye=(s+l|0)+((u&8191)<<13)|0;s=(c+(u>>>13)|0)+(ye>>>26)|0;ye&=67108863;l=Math.imul(y,V);u=Math.imul(y,H);u=u+Math.imul(x,V)|0;c=Math.imul(x,H);l=l+Math.imul(d,G)|0;u=u+Math.imul(d,Y)|0;u=u+Math.imul(m,G)|0;c=c+Math.imul(m,Y)|0;l=l+Math.imul(h,X)|0;u=u+Math.imul(h,Z)|0;u=u+Math.imul(p,X)|0;c=c+Math.imul(p,Z)|0;var xe=(s+l|0)+((u&8191)<<13)|0;s=(c+(u>>>13)|0)+(xe>>>26)|0;xe&=67108863;l=Math.imul(_,V);u=Math.imul(_,H);u=u+Math.imul(w,V)|0;c=Math.imul(w,H);l=l+Math.imul(y,G)|0;u=u+Math.imul(y,Y)|0;u=u+Math.imul(x,G)|0;c=c+Math.imul(x,Y)|0;l=l+Math.imul(d,X)|0;u=u+Math.imul(d,Z)|0;u=u+Math.imul(m,X)|0;c=c+Math.imul(m,Z)|0;l=l+Math.imul(h,K)|0;u=u+Math.imul(h,Q)|0;u=u+Math.imul(p,K)|0;c=c+Math.imul(p,Q)|0;var be=(s+l|0)+((u&8191)<<13)|0;s=(c+(u>>>13)|0)+(be>>>26)|0;be&=67108863;l=Math.imul(k,V);u=Math.imul(k,H);u=u+Math.imul(M,V)|0;c=Math.imul(M,H);l=l+Math.imul(_,G)|0;u=u+Math.imul(_,Y)|0;u=u+Math.imul(w,G)|0;c=c+Math.imul(w,Y)|0;l=l+Math.imul(y,X)|0;u=u+Math.imul(y,Z)|0;u=u+Math.imul(x,X)|0;c=c+Math.imul(x,Z)|0;l=l+Math.imul(d,K)|0;u=u+Math.imul(d,Q)|0;u=u+Math.imul(m,K)|0;c=c+Math.imul(m,Q)|0;l=l+Math.imul(h,ee)|0;u=u+Math.imul(h,te)|0;u=u+Math.imul(p,ee)|0;c=c+Math.imul(p,te)|0;var _e=(s+l|0)+((u&8191)<<13)|0;s=(c+(u>>>13)|0)+(_e>>>26)|0;_e&=67108863;l=Math.imul(S,V);u=Math.imul(S,H);u=u+Math.imul(E,V)|0;c=Math.imul(E,H);l=l+Math.imul(k,G)|0;u=u+Math.imul(k,Y)|0;u=u+Math.imul(M,G)|0;c=c+Math.imul(M,Y)|0;l=l+Math.imul(_,X)|0;u=u+Math.imul(_,Z)|0;u=u+Math.imul(w,X)|0;c=c+Math.imul(w,Z)|0;l=l+Math.imul(y,K)|0;u=u+Math.imul(y,Q)|0;u=u+Math.imul(x,K)|0;c=c+Math.imul(x,Q)|0;l=l+Math.imul(d,ee)|0;u=u+Math.imul(d,te)|0;u=u+Math.imul(m,ee)|0;c=c+Math.imul(m,te)|0;l=l+Math.imul(h,ae)|0;u=u+Math.imul(h,ne)|0;u=u+Math.imul(p,ae)|0;c=c+Math.imul(p,ne)|0;var we=(s+l|0)+((u&8191)<<13)|0;s=(c+(u>>>13)|0)+(we>>>26)|0;we&=67108863;l=Math.imul(C,V);u=Math.imul(C,H);u=u+Math.imul(I,V)|0;c=Math.imul(I,H);l=l+Math.imul(S,G)|0;u=u+Math.imul(S,Y)|0;u=u+Math.imul(E,G)|0;c=c+Math.imul(E,Y)|0;l=l+Math.imul(k,X)|0;u=u+Math.imul(k,Z)|0;u=u+Math.imul(M,X)|0;c=c+Math.imul(M,Z)|0;l=l+Math.imul(_,K)|0;u=u+Math.imul(_,Q)|0;u=u+Math.imul(w,K)|0;c=c+Math.imul(w,Q)|0;l=l+Math.imul(y,ee)|0;u=u+Math.imul(y,te)|0;u=u+Math.imul(x,ee)|0;c=c+Math.imul(x,te)|0;l=l+Math.imul(d,ae)|0;u=u+Math.imul(d,ne)|0;u=u+Math.imul(m,ae)|0;c=c+Math.imul(m,ne)|0;l=l+Math.imul(h,oe)|0;u=u+Math.imul(h,se)|0;u=u+Math.imul(p,oe)|0;c=c+Math.imul(p,se)|0;var Te=(s+l|0)+((u&8191)<<13)|0;s=(c+(u>>>13)|0)+(Te>>>26)|0;Te&=67108863;l=Math.imul(O,V);u=Math.imul(O,H);u=u+Math.imul(z,V)|0;c=Math.imul(z,H);l=l+Math.imul(C,G)|0;u=u+Math.imul(C,Y)|0;u=u+Math.imul(I,G)|0;c=c+Math.imul(I,Y)|0;l=l+Math.imul(S,X)|0;u=u+Math.imul(S,Z)|0;u=u+Math.imul(E,X)|0;c=c+Math.imul(E,Z)|0;l=l+Math.imul(k,K)|0;u=u+Math.imul(k,Q)|0;u=u+Math.imul(M,K)|0;c=c+Math.imul(M,Q)|0;l=l+Math.imul(_,ee)|0;u=u+Math.imul(_,te)|0;u=u+Math.imul(w,ee)|0;c=c+Math.imul(w,te)|0;l=l+Math.imul(y,ae)|0;u=u+Math.imul(y,ne)|0;u=u+Math.imul(x,ae)|0;c=c+Math.imul(x,ne)|0;l=l+Math.imul(d,oe)|0;u=u+Math.imul(d,se)|0;u=u+Math.imul(m,oe)|0;c=c+Math.imul(m,se)|0;l=l+Math.imul(h,ue)|0;u=u+Math.imul(h,ce)|0;u=u+Math.imul(p,ue)|0;c=c+Math.imul(p,ce)|0;var ke=(s+l|0)+((u&8191)<<13)|0;s=(c+(u>>>13)|0)+(ke>>>26)|0;ke&=67108863;l=Math.imul(R,V);u=Math.imul(R,H);u=u+Math.imul(F,V)|0;c=Math.imul(F,H);l=l+Math.imul(O,G)|0;u=u+Math.imul(O,Y)|0;u=u+Math.imul(z,G)|0;c=c+Math.imul(z,Y)|0;l=l+Math.imul(C,X)|0;u=u+Math.imul(C,Z)|0;u=u+Math.imul(I,X)|0;c=c+Math.imul(I,Z)|0;l=l+Math.imul(S,K)|0;u=u+Math.imul(S,Q)|0;u=u+Math.imul(E,K)|0;c=c+Math.imul(E,Q)|0;l=l+Math.imul(k,ee)|0;u=u+Math.imul(k,te)|0;u=u+Math.imul(M,ee)|0;c=c+Math.imul(M,te)|0;l=l+Math.imul(_,ae)|0;u=u+Math.imul(_,ne)|0;u=u+Math.imul(w,ae)|0;c=c+Math.imul(w,ne)|0;l=l+Math.imul(y,oe)|0;u=u+Math.imul(y,se)|0;u=u+Math.imul(x,oe)|0;c=c+Math.imul(x,se)|0;l=l+Math.imul(d,ue)|0;u=u+Math.imul(d,ce)|0;u=u+Math.imul(m,ue)|0;c=c+Math.imul(m,ce)|0;l=l+Math.imul(h,he)|0;u=u+Math.imul(h,pe)|0;u=u+Math.imul(p,he)|0;c=c+Math.imul(p,pe)|0;var Me=(s+l|0)+((u&8191)<<13)|0;s=(c+(u>>>13)|0)+(Me>>>26)|0;Me&=67108863;l=Math.imul(N,V);u=Math.imul(N,H);u=u+Math.imul(j,V)|0;c=Math.imul(j,H);l=l+Math.imul(R,G)|0;u=u+Math.imul(R,Y)|0;u=u+Math.imul(F,G)|0;c=c+Math.imul(F,Y)|0;l=l+Math.imul(O,X)|0;u=u+Math.imul(O,Z)|0;u=u+Math.imul(z,X)|0;c=c+Math.imul(z,Z)|0;l=l+Math.imul(C,K)|0;u=u+Math.imul(C,Q)|0;u=u+Math.imul(I,K)|0;c=c+Math.imul(I,Q)|0;l=l+Math.imul(S,ee)|0;u=u+Math.imul(S,te)|0;u=u+Math.imul(E,ee)|0;c=c+Math.imul(E,te)|0;l=l+Math.imul(k,ae)|0;u=u+Math.imul(k,ne)|0;u=u+Math.imul(M,ae)|0;c=c+Math.imul(M,ne)|0;l=l+Math.imul(_,oe)|0;u=u+Math.imul(_,se)|0;u=u+Math.imul(w,oe)|0;c=c+Math.imul(w,se)|0;l=l+Math.imul(y,ue)|0;u=u+Math.imul(y,ce)|0;u=u+Math.imul(x,ue)|0;c=c+Math.imul(x,ce)|0;l=l+Math.imul(d,he)|0;u=u+Math.imul(d,pe)|0;u=u+Math.imul(m,he)|0;c=c+Math.imul(m,pe)|0;l=l+Math.imul(h,de)|0;u=u+Math.imul(h,me)|0;u=u+Math.imul(p,de)|0;c=c+Math.imul(p,me)|0;var Ae=(s+l|0)+((u&8191)<<13)|0;s=(c+(u>>>13)|0)+(Ae>>>26)|0;Ae&=67108863;l=Math.imul(N,G);u=Math.imul(N,Y);u=u+Math.imul(j,G)|0;c=Math.imul(j,Y);l=l+Math.imul(R,X)|0;u=u+Math.imul(R,Z)|0;u=u+Math.imul(F,X)|0;c=c+Math.imul(F,Z)|0;l=l+Math.imul(O,K)|0;u=u+Math.imul(O,Q)|0;u=u+Math.imul(z,K)|0;c=c+Math.imul(z,Q)|0;l=l+Math.imul(C,ee)|0;u=u+Math.imul(C,te)|0;u=u+Math.imul(I,ee)|0;c=c+Math.imul(I,te)|0;l=l+Math.imul(S,ae)|0;u=u+Math.imul(S,ne)|0;u=u+Math.imul(E,ae)|0;c=c+Math.imul(E,ne)|0;l=l+Math.imul(k,oe)|0;u=u+Math.imul(k,se)|0;u=u+Math.imul(M,oe)|0;c=c+Math.imul(M,se)|0;l=l+Math.imul(_,ue)|0;u=u+Math.imul(_,ce)|0;u=u+Math.imul(w,ue)|0;c=c+Math.imul(w,ce)|0;l=l+Math.imul(y,he)|0;u=u+Math.imul(y,pe)|0;u=u+Math.imul(x,he)|0;c=c+Math.imul(x,pe)|0;l=l+Math.imul(d,de)|0;u=u+Math.imul(d,me)|0;u=u+Math.imul(m,de)|0;c=c+Math.imul(m,me)|0;var Se=(s+l|0)+((u&8191)<<13)|0;s=(c+(u>>>13)|0)+(Se>>>26)|0;Se&=67108863;l=Math.imul(N,X);u=Math.imul(N,Z);u=u+Math.imul(j,X)|0;c=Math.imul(j,Z);l=l+Math.imul(R,K)|0;u=u+Math.imul(R,Q)|0;u=u+Math.imul(F,K)|0;c=c+Math.imul(F,Q)|0;l=l+Math.imul(O,ee)|0;u=u+Math.imul(O,te)|0;u=u+Math.imul(z,ee)|0;c=c+Math.imul(z,te)|0;l=l+Math.imul(C,ae)|0;u=u+Math.imul(C,ne)|0;u=u+Math.imul(I,ae)|0;c=c+Math.imul(I,ne)|0;l=l+Math.imul(S,oe)|0;u=u+Math.imul(S,se)|0;u=u+Math.imul(E,oe)|0;c=c+Math.imul(E,se)|0;l=l+Math.imul(k,ue)|0;u=u+Math.imul(k,ce)|0;u=u+Math.imul(M,ue)|0;c=c+Math.imul(M,ce)|0;l=l+Math.imul(_,he)|0;u=u+Math.imul(_,pe)|0;u=u+Math.imul(w,he)|0;c=c+Math.imul(w,pe)|0;l=l+Math.imul(y,de)|0;u=u+Math.imul(y,me)|0;u=u+Math.imul(x,de)|0;c=c+Math.imul(x,me)|0;var Ee=(s+l|0)+((u&8191)<<13)|0;s=(c+(u>>>13)|0)+(Ee>>>26)|0;Ee&=67108863;l=Math.imul(N,K);u=Math.imul(N,Q);u=u+Math.imul(j,K)|0;c=Math.imul(j,Q);l=l+Math.imul(R,ee)|0;u=u+Math.imul(R,te)|0;u=u+Math.imul(F,ee)|0;c=c+Math.imul(F,te)|0;l=l+Math.imul(O,ae)|0;u=u+Math.imul(O,ne)|0;u=u+Math.imul(z,ae)|0;c=c+Math.imul(z,ne)|0;l=l+Math.imul(C,oe)|0;u=u+Math.imul(C,se)|0;u=u+Math.imul(I,oe)|0;c=c+Math.imul(I,se)|0;l=l+Math.imul(S,ue)|0;u=u+Math.imul(S,ce)|0;u=u+Math.imul(E,ue)|0;c=c+Math.imul(E,ce)|0;l=l+Math.imul(k,he)|0;u=u+Math.imul(k,pe)|0;u=u+Math.imul(M,he)|0;c=c+Math.imul(M,pe)|0;l=l+Math.imul(_,de)|0;u=u+Math.imul(_,me)|0;u=u+Math.imul(w,de)|0;c=c+Math.imul(w,me)|0;var Le=(s+l|0)+((u&8191)<<13)|0;s=(c+(u>>>13)|0)+(Le>>>26)|0;Le&=67108863;l=Math.imul(N,ee);u=Math.imul(N,te);u=u+Math.imul(j,ee)|0;c=Math.imul(j,te);l=l+Math.imul(R,ae)|0;u=u+Math.imul(R,ne)|0;u=u+Math.imul(F,ae)|0;c=c+Math.imul(F,ne)|0;l=l+Math.imul(O,oe)|0;u=u+Math.imul(O,se)|0;u=u+Math.imul(z,oe)|0;c=c+Math.imul(z,se)|0;l=l+Math.imul(C,ue)|0;u=u+Math.imul(C,ce)|0;u=u+Math.imul(I,ue)|0;c=c+Math.imul(I,ce)|0;l=l+Math.imul(S,he)|0;u=u+Math.imul(S,pe)|0;u=u+Math.imul(E,he)|0;c=c+Math.imul(E,pe)|0;l=l+Math.imul(k,de)|0;u=u+Math.imul(k,me)|0;u=u+Math.imul(M,de)|0;c=c+Math.imul(M,me)|0;var Ce=(s+l|0)+((u&8191)<<13)|0;s=(c+(u>>>13)|0)+(Ce>>>26)|0;Ce&=67108863;l=Math.imul(N,ae);u=Math.imul(N,ne);u=u+Math.imul(j,ae)|0;c=Math.imul(j,ne);l=l+Math.imul(R,oe)|0;u=u+Math.imul(R,se)|0;u=u+Math.imul(F,oe)|0;c=c+Math.imul(F,se)|0;l=l+Math.imul(O,ue)|0;u=u+Math.imul(O,ce)|0;u=u+Math.imul(z,ue)|0;c=c+Math.imul(z,ce)|0;l=l+Math.imul(C,he)|0;u=u+Math.imul(C,pe)|0;u=u+Math.imul(I,he)|0;c=c+Math.imul(I,pe)|0;l=l+Math.imul(S,de)|0;u=u+Math.imul(S,me)|0;u=u+Math.imul(E,de)|0;c=c+Math.imul(E,me)|0;var Ie=(s+l|0)+((u&8191)<<13)|0;s=(c+(u>>>13)|0)+(Ie>>>26)|0;Ie&=67108863;l=Math.imul(N,oe);u=Math.imul(N,se);u=u+Math.imul(j,oe)|0;c=Math.imul(j,se);l=l+Math.imul(R,ue)|0;u=u+Math.imul(R,ce)|0;u=u+Math.imul(F,ue)|0;c=c+Math.imul(F,ce)|0;l=l+Math.imul(O,he)|0;u=u+Math.imul(O,pe)|0;u=u+Math.imul(z,he)|0;c=c+Math.imul(z,pe)|0;l=l+Math.imul(C,de)|0;u=u+Math.imul(C,me)|0;u=u+Math.imul(I,de)|0;c=c+Math.imul(I,me)|0;var Pe=(s+l|0)+((u&8191)<<13)|0;s=(c+(u>>>13)|0)+(Pe>>>26)|0;Pe&=67108863;l=Math.imul(N,ue);u=Math.imul(N,ce);u=u+Math.imul(j,ue)|0;c=Math.imul(j,ce);l=l+Math.imul(R,he)|0;u=u+Math.imul(R,pe)|0;u=u+Math.imul(F,he)|0;c=c+Math.imul(F,pe)|0;l=l+Math.imul(O,de)|0;u=u+Math.imul(O,me)|0;u=u+Math.imul(z,de)|0;c=c+Math.imul(z,me)|0;var Oe=(s+l|0)+((u&8191)<<13)|0;s=(c+(u>>>13)|0)+(Oe>>>26)|0;Oe&=67108863;l=Math.imul(N,he);u=Math.imul(N,pe);u=u+Math.imul(j,he)|0;c=Math.imul(j,pe);l=l+Math.imul(R,de)|0;u=u+Math.imul(R,me)|0;u=u+Math.imul(F,de)|0;c=c+Math.imul(F,me)|0;var ze=(s+l|0)+((u&8191)<<13)|0;s=(c+(u>>>13)|0)+(ze>>>26)|0;ze&=67108863;l=Math.imul(N,de);u=Math.imul(N,me);u=u+Math.imul(j,de)|0;c=Math.imul(j,me);var De=(s+l|0)+((u&8191)<<13)|0;s=(c+(u>>>13)|0)+(De>>>26)|0;De&=67108863;o[0]=ge;o[1]=ye;o[2]=xe;o[3]=be;o[4]=_e;o[5]=we;o[6]=Te;o[7]=ke;o[8]=Me;o[9]=Ae;o[10]=Se;o[11]=Ee;o[12]=Le;o[13]=Ce;o[14]=Ie;o[15]=Pe;o[16]=Oe;o[17]=ze;o[18]=De;if(s!==0){o[19]=s;a.length++}return a};if(!Math.imul){v=p}function d(e,t,r){r.negative=t.negative^e.negative;r.length=e.length+t.length;var a=0;var n=0;for(var i=0;i<r.length-1;i++){var o=n;n=0;var s=a&67108863;var l=Math.min(i,t.length-1);for(var u=Math.max(0,i-e.length+1);u<=l;u++){var c=i-u;var f=e.words[c]|0;var h=t.words[u]|0;var p=f*h;var v=p&67108863;o=o+(p/67108864|0)|0;v=v+s|0;s=v&67108863;o=o+(v>>>26)|0;n+=o>>>26;o&=67108863}r.words[i]=s;a=o;o=n}if(a!==0){r.words[i]=a}else{r.length--}return r.strip()}function m(e,t,r){var a=new g;return a.mulp(e,t,r)}i.prototype.mulTo=function e(t,r){var a;var n=this.length+t.length;if(this.length===10&&t.length===10){a=v(this,t,r)}else if(n<63){a=p(this,t,r)}else if(n<1024){a=d(this,t,r)}else{a=m(this,t,r)}return a};function g(e,t){this.x=e;this.y=t}g.prototype.makeRBT=function e(t){var r=new Array(t);var a=i.prototype._countBits(t)-1;for(var n=0;n<t;n++){r[n]=this.revBin(n,a,t)}return r};g.prototype.revBin=function e(t,r,a){if(t===0||t===a-1)return t;var n=0;for(var i=0;i<r;i++){n|=(t&1)<<r-i-1;t>>=1}return n};g.prototype.permute=function e(t,r,a,n,i,o){for(var s=0;s<o;s++){n[s]=r[t[s]];i[s]=a[t[s]]}};g.prototype.transform=function e(t,r,a,n,i,o){this.permute(o,t,r,a,n,i);for(var s=1;s<i;s<<=1){var l=s<<1;var u=Math.cos(2*Math.PI/l);var c=Math.sin(2*Math.PI/l);for(var f=0;f<i;f+=l){var h=u;var p=c;for(var v=0;v<s;v++){var d=a[f+v];var m=n[f+v];var g=a[f+v+s];var y=n[f+v+s];var x=h*g-p*y;y=h*y+p*g;g=x;a[f+v]=d+g;n[f+v]=m+y;a[f+v+s]=d-g;n[f+v+s]=m-y;if(v!==l){x=u*h-c*p;p=u*p+c*h;h=x}}}}};g.prototype.guessLen13b=function e(t,r){var a=Math.max(r,t)|1;var n=a&1;var i=0;for(a=a/2|0;a;a=a>>>1){i++}return 1<<i+1+n};g.prototype.conjugate=function e(t,r,a){if(a<=1)return;for(var n=0;n<a/2;n++){var i=t[n];t[n]=t[a-n-1];t[a-n-1]=i;i=r[n];r[n]=-r[a-n-1];r[a-n-1]=-i}};g.prototype.normalize13b=function e(t,r){var a=0;for(var n=0;n<r/2;n++){var i=Math.round(t[2*n+1]/r)*8192+Math.round(t[2*n]/r)+a;t[n]=i&67108863;if(i<67108864){a=0}else{a=i/67108864|0}}return t};g.prototype.convert13b=function e(t,r,n,i){var o=0;for(var s=0;s<r;s++){o=o+(t[s]|0);n[2*s]=o&8191;o=o>>>13;n[2*s+1]=o&8191;o=o>>>13}for(s=2*r;s<i;++s){n[s]=0}a(o===0);a((o&~8191)===0)};g.prototype.stub=function e(t){var r=new Array(t);for(var a=0;a<t;a++){r[a]=0}return r};g.prototype.mulp=function e(t,r,a){var n=2*this.guessLen13b(t.length,r.length);var i=this.makeRBT(n);var o=this.stub(n);var s=new Array(n);var l=new Array(n);var u=new Array(n);var c=new Array(n);var f=new Array(n);var h=new Array(n);var p=a.words;p.length=n;this.convert13b(t.words,t.length,s,n);this.convert13b(r.words,r.length,c,n);this.transform(s,o,l,u,n,i);this.transform(c,o,f,h,n,i);for(var v=0;v<n;v++){var d=l[v]*f[v]-u[v]*h[v];u[v]=l[v]*h[v]+u[v]*f[v];l[v]=d}this.conjugate(l,u,n);this.transform(l,u,p,o,n,i);this.conjugate(p,o,n);this.normalize13b(p,n);a.negative=t.negative^r.negative;a.length=t.length+r.length;return a.strip()};i.prototype.mul=function e(t){var r=new i(null);r.words=new Array(this.length+t.length);return this.mulTo(t,r)};i.prototype.mulf=function e(t){var r=new i(null);r.words=new Array(this.length+t.length);return m(this,t,r)};i.prototype.imul=function e(t){return this.clone().mulTo(t,this)};i.prototype.imuln=function e(t){a(typeof t==="number");a(t<67108864);var r=0;for(var n=0;n<this.length;n++){var i=(this.words[n]|0)*t;var o=(i&67108863)+(r&67108863);r>>=26;r+=i/67108864|0;r+=o>>>26;this.words[n]=o&67108863}if(r!==0){this.words[n]=r;this.length++}return this};i.prototype.muln=function e(t){return this.clone().imuln(t)};i.prototype.sqr=function e(){return this.mul(this)};i.prototype.isqr=function e(){return this.imul(this.clone())};i.prototype.pow=function e(t){var r=h(t);if(r.length===0)return new i(1);var a=this;for(var n=0;n<r.length;n++,a=a.sqr()){if(r[n]!==0)break}if(++n<r.length){for(var o=a.sqr();n<r.length;n++,o=o.sqr()){if(r[n]===0)continue;a=a.mul(o)}}return a};i.prototype.iushln=function e(t){a(typeof t==="number"&&t>=0);var r=t%26;var n=(t-r)/26;var i=67108863>>>26-r<<26-r;var o;if(r!==0){var s=0;for(o=0;o<this.length;o++){var l=this.words[o]&i;var u=(this.words[o]|0)-l<<r;this.words[o]=u|s;s=l>>>26-r}if(s){this.words[o]=s;this.length++}}if(n!==0){for(o=this.length-1;o>=0;o--){this.words[o+n]=this.words[o]}for(o=0;o<n;o++){this.words[o]=0}this.length+=n}return this.strip()};i.prototype.ishln=function e(t){a(this.negative===0);return this.iushln(t)};i.prototype.iushrn=function e(t,r,n){a(typeof t==="number"&&t>=0);var i;if(r){i=(r-r%26)/26}else{i=0}var o=t%26;var s=Math.min((t-o)/26,this.length);var l=67108863^67108863>>>o<<o;var u=n;i-=s;i=Math.max(0,i);if(u){for(var c=0;c<s;c++){u.words[c]=this.words[c]}u.length=s}if(s===0){}else if(this.length>s){this.length-=s;for(c=0;c<this.length;c++){this.words[c]=this.words[c+s]}}else{this.words[0]=0;this.length=1}var f=0;for(c=this.length-1;c>=0&&(f!==0||c>=i);c--){var h=this.words[c]|0;this.words[c]=f<<26-o|h>>>o;f=h&l}if(u&&f!==0){u.words[u.length++]=f}if(this.length===0){this.words[0]=0;this.length=1}return this.strip()};i.prototype.ishrn=function e(t,r,n){a(this.negative===0);return this.iushrn(t,r,n)};i.prototype.shln=function e(t){return this.clone().ishln(t)};i.prototype.ushln=function e(t){return this.clone().iushln(t)};i.prototype.shrn=function e(t){return this.clone().ishrn(t)};i.prototype.ushrn=function e(t){return this.clone().iushrn(t)};i.prototype.testn=function e(t){a(typeof t==="number"&&t>=0);var r=t%26;var n=(t-r)/26;var i=1<<r;if(this.length<=n)return false;var o=this.words[n];return!!(o&i)};i.prototype.imaskn=function e(t){a(typeof t==="number"&&t>=0);var r=t%26;var n=(t-r)/26;a(this.negative===0,"imaskn works only with positive numbers");if(this.length<=n){return this}if(r!==0){n++}this.length=Math.min(n,this.length);if(r!==0){var i=67108863^67108863>>>r<<r;this.words[this.length-1]&=i}return this.strip()};i.prototype.maskn=function e(t){return this.clone().imaskn(t)};i.prototype.iaddn=function e(t){a(typeof t==="number");a(t<67108864);if(t<0)return this.isubn(-t);if(this.negative!==0){if(this.length===1&&(this.words[0]|0)<t){this.words[0]=t-(this.words[0]|0);this.negative=0;return this}this.negative=0;this.isubn(t);this.negative=1;return this}return this._iaddn(t)};i.prototype._iaddn=function e(t){this.words[0]+=t;for(var r=0;r<this.length&&this.words[r]>=67108864;r++){this.words[r]-=67108864;if(r===this.length-1){this.words[r+1]=1}else{this.words[r+1]++}}this.length=Math.max(this.length,r+1);return this};i.prototype.isubn=function e(t){a(typeof t==="number");a(t<67108864);if(t<0)return this.iaddn(-t);if(this.negative!==0){this.negative=0;this.iaddn(t);this.negative=1;return this}this.words[0]-=t;if(this.length===1&&this.words[0]<0){this.words[0]=-this.words[0];this.negative=1}else{for(var r=0;r<this.length&&this.words[r]<0;r++){this.words[r]+=67108864;this.words[r+1]-=1}}return this.strip()};i.prototype.addn=function e(t){return this.clone().iaddn(t)};i.prototype.subn=function e(t){return this.clone().isubn(t)};i.prototype.iabs=function e(){this.negative=0;return this};i.prototype.abs=function e(){return this.clone().iabs()};i.prototype._ishlnsubmul=function e(t,r,n){var i=t.length+n;var o;this._expand(i);var s;var l=0;for(o=0;o<t.length;o++){s=(this.words[o+n]|0)+l;var u=(t.words[o]|0)*r;s-=u&67108863;l=(s>>26)-(u/67108864|0);this.words[o+n]=s&67108863}for(;o<this.length-n;o++){s=(this.words[o+n]|0)+l;l=s>>26;this.words[o+n]=s&67108863}if(l===0)return this.strip();a(l===-1);l=0;for(o=0;o<this.length;o++){s=-(this.words[o]|0)+l;l=s>>26;this.words[o]=s&67108863}this.negative=1;return this.strip()};i.prototype._wordDiv=function e(t,r){var a=this.length-t.length;var n=this.clone();var o=t;var s=o.words[o.length-1]|0;var l=this._countBits(s);a=26-l;if(a!==0){o=o.ushln(a);n.iushln(a);s=o.words[o.length-1]|0}var u=n.length-o.length;var c;if(r!=="mod"){c=new i(null);c.length=u+1;c.words=new Array(c.length);for(var f=0;f<c.length;f++){c.words[f]=0}}var h=n.clone()._ishlnsubmul(o,1,u);if(h.negative===0){n=h;if(c){c.words[u]=1}}for(var p=u-1;p>=0;p--){var v=(n.words[o.length+p]|0)*67108864+(n.words[o.length+p-1]|0);v=Math.min(v/s|0,67108863);n._ishlnsubmul(o,v,p);while(n.negative!==0){v--;n.negative=0;n._ishlnsubmul(o,1,p);if(!n.isZero()){n.negative^=1}}if(c){c.words[p]=v}}if(c){c.strip()}n.strip();if(r!=="div"&&a!==0){n.iushrn(a)}return{div:c||null,mod:n}};i.prototype.divmod=function e(t,r,n){a(!t.isZero());if(this.isZero()){return{div:new i(0),mod:new i(0)}}var o,s,l;if(this.negative!==0&&t.negative===0){l=this.neg().divmod(t,r);if(r!=="mod"){o=l.div.neg()}if(r!=="div"){s=l.mod.neg();if(n&&s.negative!==0){s.iadd(t)}}return{div:o,mod:s}}if(this.negative===0&&t.negative!==0){l=this.divmod(t.neg(),r);if(r!=="mod"){o=l.div.neg()}return{div:o,mod:l.mod}}if((this.negative&t.negative)!==0){l=this.neg().divmod(t.neg(),r);if(r!=="div"){s=l.mod.neg();if(n&&s.negative!==0){s.isub(t)}}return{div:l.div,mod:s}}if(t.length>this.length||this.cmp(t)<0){return{div:new i(0),mod:this}}if(t.length===1){if(r==="div"){return{div:this.divn(t.words[0]),mod:null}}if(r==="mod"){return{div:null,mod:new i(this.modn(t.words[0]))}}return{div:this.divn(t.words[0]),mod:new i(this.modn(t.words[0]))}}return this._wordDiv(t,r)};i.prototype.div=function e(t){return this.divmod(t,"div",false).div};i.prototype.mod=function e(t){return this.divmod(t,"mod",false).mod};i.prototype.umod=function e(t){return this.divmod(t,"mod",true).mod};i.prototype.divRound=function e(t){var r=this.divmod(t);if(r.mod.isZero())return r.div;var a=r.div.negative!==0?r.mod.isub(t):r.mod;var n=t.ushrn(1);var i=t.andln(1);var o=a.cmp(n);if(o<0||i===1&&o===0)return r.div;return r.div.negative!==0?r.div.isubn(1):r.div.iaddn(1)};i.prototype.modn=function e(t){a(t<=67108863);var r=(1<<26)%t;var n=0;for(var i=this.length-1;i>=0;i--){n=(r*n+(this.words[i]|0))%t}return n};i.prototype.idivn=function e(t){a(t<=67108863);var r=0;for(var n=this.length-1;n>=0;n--){var i=(this.words[n]|0)+r*67108864;this.words[n]=i/t|0;r=i%t}return this.strip()};i.prototype.divn=function e(t){return this.clone().idivn(t)};i.prototype.egcd=function e(t){a(t.negative===0);a(!t.isZero());var r=this;var n=t.clone();if(r.negative!==0){r=r.umod(t)}else{r=r.clone()}var o=new i(1);var s=new i(0);var l=new i(0);var u=new i(1);var c=0;while(r.isEven()&&n.isEven()){r.iushrn(1);n.iushrn(1);++c}var f=n.clone();var h=r.clone();while(!r.isZero()){for(var p=0,v=1;(r.words[0]&v)===0&&p<26;++p,v<<=1);if(p>0){r.iushrn(p);while(p-- >0){if(o.isOdd()||s.isOdd()){o.iadd(f);s.isub(h)}o.iushrn(1);s.iushrn(1)}}for(var d=0,m=1;(n.words[0]&m)===0&&d<26;++d,m<<=1);if(d>0){n.iushrn(d);while(d-- >0){if(l.isOdd()||u.isOdd()){l.iadd(f);u.isub(h)}l.iushrn(1);u.iushrn(1)}}if(r.cmp(n)>=0){r.isub(n);o.isub(l);s.isub(u)}else{n.isub(r);l.isub(o);u.isub(s)}}return{a:l,b:u,gcd:n.iushln(c)}};i.prototype._invmp=function e(t){a(t.negative===0);a(!t.isZero());var r=this;var n=t.clone();if(r.negative!==0){r=r.umod(t)}else{r=r.clone()}var o=new i(1);var s=new i(0);var l=n.clone();while(r.cmpn(1)>0&&n.cmpn(1)>0){for(var u=0,c=1;(r.words[0]&c)===0&&u<26;++u,c<<=1);if(u>0){r.iushrn(u);while(u-- >0){if(o.isOdd()){o.iadd(l)}o.iushrn(1)}}for(var f=0,h=1;(n.words[0]&h)===0&&f<26;++f,h<<=1);if(f>0){n.iushrn(f);while(f-- >0){if(s.isOdd()){s.iadd(l)}s.iushrn(1)}}if(r.cmp(n)>=0){r.isub(n);o.isub(s)}else{n.isub(r);s.isub(o)}}var p;if(r.cmpn(1)===0){p=o}else{p=s}if(p.cmpn(0)<0){p.iadd(t)}return p};i.prototype.gcd=function e(t){if(this.isZero())return t.abs();if(t.isZero())return this.abs();var r=this.clone();var a=t.clone();r.negative=0;a.negative=0;for(var n=0;r.isEven()&&a.isEven();n++){r.iushrn(1);a.iushrn(1)}do{while(r.isEven()){r.iushrn(1)}while(a.isEven()){a.iushrn(1)}var i=r.cmp(a);if(i<0){var o=r;r=a;a=o}else if(i===0||a.cmpn(1)===0){break}r.isub(a)}while(true);return a.iushln(n)};i.prototype.invm=function e(t){return this.egcd(t).a.umod(t)};i.prototype.isEven=function e(){return(this.words[0]&1)===0};i.prototype.isOdd=function e(){return(this.words[0]&1)===1};i.prototype.andln=function e(t){return this.words[0]&t};i.prototype.bincn=function e(t){a(typeof t==="number");var r=t%26;var n=(t-r)/26;var i=1<<r;if(this.length<=n){this._expand(n+1);this.words[n]|=i;return this}var o=i;for(var s=n;o!==0&&s<this.length;s++){var l=this.words[s]|0;l+=o;o=l>>>26;l&=67108863;this.words[s]=l}if(o!==0){this.words[s]=o;this.length++}return this};i.prototype.isZero=function e(){return this.length===1&&this.words[0]===0};i.prototype.cmpn=function e(t){var r=t<0;if(this.negative!==0&&!r)return-1;if(this.negative===0&&r)return 1;this.strip();var n;if(this.length>1){n=1}else{if(r){t=-t}a(t<=67108863,"Number is too big");var i=this.words[0]|0;n=i===t?0:i<t?-1:1}if(this.negative!==0)return-n|0;return n};i.prototype.cmp=function e(t){if(this.negative!==0&&t.negative===0)return-1;if(this.negative===0&&t.negative!==0)return 1;var r=this.ucmp(t);if(this.negative!==0)return-r|0;return r};i.prototype.ucmp=function e(t){if(this.length>t.length)return 1;if(this.length<t.length)return-1;var r=0;for(var a=this.length-1;a>=0;a--){var n=this.words[a]|0;var i=t.words[a]|0;if(n===i)continue;if(n<i){r=-1}else if(n>i){r=1}break}return r};i.prototype.gtn=function e(t){return this.cmpn(t)===1};i.prototype.gt=function e(t){return this.cmp(t)===1};i.prototype.gten=function e(t){return this.cmpn(t)>=0};i.prototype.gte=function e(t){return this.cmp(t)>=0};i.prototype.ltn=function e(t){return this.cmpn(t)===-1};i.prototype.lt=function e(t){return this.cmp(t)===-1};i.prototype.lten=function e(t){return this.cmpn(t)<=0};i.prototype.lte=function e(t){return this.cmp(t)<=0};i.prototype.eqn=function e(t){return this.cmpn(t)===0};i.prototype.eq=function e(t){return this.cmp(t)===0};i.red=function e(t){return new k(t)};i.prototype.toRed=function e(t){a(!this.red,"Already a number in reduction context");a(this.negative===0,"red works only with positives");return t.convertTo(this)._forceRed(t)};i.prototype.fromRed=function e(){a(this.red,"fromRed works only with numbers in reduction context");return this.red.convertFrom(this)};i.prototype._forceRed=function e(t){this.red=t;return this};i.prototype.forceRed=function e(t){a(!this.red,"Already a number in reduction context");return this._forceRed(t)};i.prototype.redAdd=function e(t){a(this.red,"redAdd works only with red numbers");return this.red.add(this,t)};i.prototype.redIAdd=function e(t){a(this.red,"redIAdd works only with red numbers");return this.red.iadd(this,t)};i.prototype.redSub=function e(t){a(this.red,"redSub works only with red numbers");return this.red.sub(this,t)};i.prototype.redISub=function e(t){a(this.red,"redISub works only with red numbers");return this.red.isub(this,t)};i.prototype.redShl=function e(t){a(this.red,"redShl works only with red numbers");return this.red.shl(this,t)};i.prototype.redMul=function e(t){a(this.red,"redMul works only with red numbers");this.red._verify2(this,t);return this.red.mul(this,t)};i.prototype.redIMul=function e(t){a(this.red,"redMul works only with red numbers");this.red._verify2(this,t);return this.red.imul(this,t)};i.prototype.redSqr=function e(){a(this.red,"redSqr works only with red numbers");this.red._verify1(this);return this.red.sqr(this)};i.prototype.redISqr=function e(){a(this.red,"redISqr works only with red numbers");this.red._verify1(this);return this.red.isqr(this)};i.prototype.redSqrt=function e(){a(this.red,"redSqrt works only with red numbers");this.red._verify1(this);return this.red.sqrt(this)};i.prototype.redInvm=function e(){a(this.red,"redInvm works only with red numbers");this.red._verify1(this);return this.red.invm(this)};i.prototype.redNeg=function e(){a(this.red,"redNeg works only with red numbers");this.red._verify1(this);return this.red.neg(this)};i.prototype.redPow=function e(t){a(this.red&&!t.red,"redPow(normalNum)");this.red._verify1(this);return this.red.pow(this,t)};var y={k256:null,p224:null,p192:null,p25519:null};function x(e,t){this.name=e;this.p=new i(t,16);this.n=this.p.bitLength();this.k=new i(1).iushln(this.n).isub(this.p);this.tmp=this._tmp()}x.prototype._tmp=function e(){var t=new i(null);t.words=new Array(Math.ceil(this.n/13));return t};x.prototype.ireduce=function e(t){var r=t;var a;do{this.split(r,this.tmp);r=this.imulK(r);r=r.iadd(this.tmp);a=r.bitLength()}while(a>this.n);var n=a<this.n?-1:r.ucmp(this.p);if(n===0){r.words[0]=0;r.length=1}else if(n>0){r.isub(this.p)}else{r.strip()}return r};x.prototype.split=function e(t,r){t.iushrn(this.n,0,r)};x.prototype.imulK=function e(t){return t.imul(this.k)};function b(){x.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}n(b,x);b.prototype.split=function e(t,r){var a=4194303;var n=Math.min(t.length,9);for(var i=0;i<n;i++){r.words[i]=t.words[i]}r.length=n;if(t.length<=9){t.words[0]=0;t.length=1;return}var o=t.words[9];r.words[r.length++]=o&a;for(i=10;i<t.length;i++){var s=t.words[i]|0;t.words[i-10]=(s&a)<<4|o>>>22;o=s}o>>>=22;t.words[i-10]=o;if(o===0&&t.length>10){t.length-=10}else{t.length-=9}};b.prototype.imulK=function e(t){t.words[t.length]=0;t.words[t.length+1]=0;t.length+=2;var r=0;for(var a=0;a<t.length;a++){var n=t.words[a]|0;r+=n*977;t.words[a]=r&67108863;r=n*64+(r/67108864|0)}if(t.words[t.length-1]===0){t.length--;if(t.words[t.length-1]===0){t.length--}}return t};function _(){x.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}n(_,x);function w(){x.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}n(w,x);function T(){x.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}n(T,x);T.prototype.imulK=function e(t){var r=0;for(var a=0;a<t.length;a++){var n=(t.words[a]|0)*19+r;var i=n&67108863;n>>>=26;t.words[a]=i;r=n}if(r!==0){t.words[t.length++]=r}return t};i._prime=function e(t){if(y[t])return y[t];var e;if(t==="k256"){e=new b}else if(t==="p224"){e=new _}else if(t==="p192"){e=new w}else if(t==="p25519"){e=new T}else{throw new Error("Unknown prime "+t)}y[t]=e;return e};function k(e){if(typeof e==="string"){var t=i._prime(e);this.m=t.p;this.prime=t}else{a(e.gtn(1),"modulus must be greater than 1");this.m=e;this.prime=null}}k.prototype._verify1=function e(t){a(t.negative===0,"red works only with positives");a(t.red,"red works only with red numbers")};k.prototype._verify2=function e(t,r){a((t.negative|r.negative)===0,"red works only with positives");a(t.red&&t.red===r.red,"red works only with red numbers")};k.prototype.imod=function e(t){if(this.prime)return this.prime.ireduce(t)._forceRed(this);return t.umod(this.m)._forceRed(this)};k.prototype.neg=function e(t){if(t.isZero()){return t.clone()}return this.m.sub(t)._forceRed(this)};k.prototype.add=function e(t,r){this._verify2(t,r);var a=t.add(r);if(a.cmp(this.m)>=0){a.isub(this.m)}return a._forceRed(this)};k.prototype.iadd=function e(t,r){this._verify2(t,r);var a=t.iadd(r);if(a.cmp(this.m)>=0){a.isub(this.m)}return a};k.prototype.sub=function e(t,r){this._verify2(t,r);var a=t.sub(r);if(a.cmpn(0)<0){a.iadd(this.m)}return a._forceRed(this)};k.prototype.isub=function e(t,r){this._verify2(t,r);var a=t.isub(r);if(a.cmpn(0)<0){a.iadd(this.m)}return a};k.prototype.shl=function e(t,r){this._verify1(t);return this.imod(t.ushln(r))};k.prototype.imul=function e(t,r){this._verify2(t,r);return this.imod(t.imul(r))};k.prototype.mul=function e(t,r){this._verify2(t,r);return this.imod(t.mul(r))};k.prototype.isqr=function e(t){return this.imul(t,t.clone())};k.prototype.sqr=function e(t){return this.mul(t,t)};k.prototype.sqrt=function e(t){if(t.isZero())return t.clone();var r=this.m.andln(3);a(r%2===1);if(r===3){var n=this.m.add(new i(1)).iushrn(2);return this.pow(t,n)}var o=this.m.subn(1);var s=0;while(!o.isZero()&&o.andln(1)===0){s++;o.iushrn(1)}a(!o.isZero());var l=new i(1).toRed(this);var u=l.redNeg();var c=this.m.subn(1).iushrn(1);var f=this.m.bitLength();f=new i(2*f*f).toRed(this);while(this.pow(f,c).cmp(u)!==0){f.redIAdd(u)}var h=this.pow(f,o);var p=this.pow(t,o.addn(1).iushrn(1));var v=this.pow(t,o);var d=s;while(v.cmp(l)!==0){var m=v;for(var g=0;m.cmp(l)!==0;g++){m=m.redSqr()}a(g<d);var y=this.pow(h,new i(1).iushln(d-g-1));p=p.redMul(y);h=y.redSqr();v=v.redMul(h);d=g}return p};k.prototype.invm=function e(t){var r=t._invmp(this.m);if(r.negative!==0){r.negative=0;return this.imod(r).redNeg()}else{return this.imod(r)}};k.prototype.pow=function e(t,r){if(r.isZero())return new i(1).toRed(this);if(r.cmpn(1)===0)return t.clone();var a=4;var n=new Array(1<<a);n[0]=new i(1).toRed(this);n[1]=t;for(var o=2;o<n.length;o++){n[o]=this.mul(n[o-1],t)}var s=n[0];var l=0;var u=0;var c=r.bitLength()%26;if(c===0){c=26}for(o=r.length-1;o>=0;o--){var f=r.words[o];for(var h=c-1;h>=0;h--){var p=f>>h&1;if(s!==n[0]){s=this.sqr(s)}if(p===0&&l===0){u=0;continue}l<<=1;l|=p;u++;if(u!==a&&(o!==0||h!==0))continue;s=this.mul(s,n[l]);u=0;l=0}c=26}return s};k.prototype.convertTo=function e(t){var r=t.umod(this.m);return r===t?r.clone():r};k.prototype.convertFrom=function e(t){var r=t.clone();r.red=null;return r};i.mont=function e(t){return new M(t)};function M(e){k.call(this,e);this.shift=this.m.bitLength();if(this.shift%26!==0){this.shift+=26-this.shift%26}this.r=new i(1).iushln(this.shift);this.r2=this.imod(this.r.sqr());this.rinv=this.r._invmp(this.m);this.minv=this.rinv.mul(this.r).isubn(1).div(this.m);this.minv=this.minv.umod(this.r);this.minv=this.r.sub(this.minv)}n(M,k);M.prototype.convertTo=function e(t){return this.imod(t.ushln(this.shift))};M.prototype.convertFrom=function e(t){var r=this.imod(t.mul(this.rinv));r.red=null;return r};M.prototype.imul=function e(t,r){if(t.isZero()||r.isZero()){t.words[0]=0;t.length=1;return t}var a=t.imul(r);var n=a.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m);var i=a.isub(n).iushrn(this.shift);var o=i;if(i.cmp(this.m)>=0){o=i.isub(this.m)}else if(i.cmpn(0)<0){o=i.iadd(this.m)}return o._forceRed(this)};M.prototype.mul=function e(t,r){if(t.isZero()||r.isZero())return new i(0)._forceRed(this);var a=t.mul(r);var n=a.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m);var o=a.isub(n).iushrn(this.shift);var s=o;if(o.cmp(this.m)>=0){s=o.isub(this.m)}else if(o.cmpn(0)<0){s=o.iadd(this.m)}return s._forceRed(this)};M.prototype.invm=function e(t){var r=this.imod(t._invmp(this.m).mul(this.r2));return r._forceRed(this)}})(typeof t==="undefined"||t,this)},{buffer:115}],107:[function(e,t,r){"use strict";t.exports=a;function a(e){var t,r,a;var n=e.length;var i=0;for(t=0;t<n;++t){i+=e[t].length}var o=new Array(i);var s=0;for(t=0;t<n;++t){var l=e[t];var u=l.length;for(r=0;r<u;++r){var c=o[s++]=new Array(u-1);var f=0;for(a=0;a<u;++a){if(a===r){continue}c[f++]=l[a]}if(r&1){var h=c[1];c[1]=c[0];c[0]=h}}}return o}},{}],108:[function(e,t,r){"use strict";t.exports=p;var a=e("typedarray-pool");var n=e("./lib/sweep");var i=e("./lib/intersect");function o(e,t){for(var r=0;r<e;++r){if(!(t[r]<=t[r+e])){return true}}return false}function s(e,t,r,a){var n=0;var i=0;for(var s=0,l=e.length;s<l;++s){var u=e[s];if(o(t,u)){continue}for(var c=0;c<2*t;++c){r[n++]=u[c]}a[i++]=s}return i}function l(e,t,r,o){var l=e.length;var u=t.length;if(l<=0||u<=0){return}var c=e[0].length>>>1;if(c<=0){return}var f;var h=a.mallocDouble(2*c*l);var p=a.mallocInt32(l);l=s(e,c,h,p);if(l>0){if(c===1&&o){n.init(l);f=n.sweepComplete(c,r,0,l,h,p,0,l,h,p)}else{var v=a.mallocDouble(2*c*u);var d=a.mallocInt32(u);u=s(t,c,v,d);if(u>0){n.init(l+u);if(c===1){f=n.sweepBipartite(c,r,0,l,h,p,0,u,v,d)}else{f=i(c,r,o,l,h,p,u,v,d)}a.free(v);a.free(d)}}a.free(h);a.free(p)}return f}var u;function c(e,t){u.push([e,t])}function f(e){u=[];l(e,e,c,true);return u}function h(e,t){u=[];l(e,t,c,false);return u}function p(e,t,r){switch(arguments.length){case 1:return f(e);case 2:if(typeof t==="function"){return l(e,e,t,true)}else{return h(e,t)}case 3:return l(e,t,r,false);default:throw new Error("box-intersect: Invalid arguments")}}},{"./lib/intersect":110,"./lib/sweep":114,"typedarray-pool":601}],109:[function(e,t,r){"use strict";function a(){function e(e,t,r,a,n,i,o,s,l,u,c){var f=2*e;for(var h=a,p=f*a;h<n;++h,p+=f){var v=i[t+p],d=i[t+p+e],m=o[h];e:for(var g=s,y=f*s;g<l;++g,y+=f){var x=u[t+y],b=u[t+y+e],_=c[g];if(b<v||d<x)continue;for(var w=t+1;w<e;++w){var T=i[w+p],k=i[w+e+p],M=u[w+y],A=u[w+e+y];if(k<M||A<T)continue e}var S=r(m,_);if(S!==void 0)return S}}}function t(e,t,r,a,n,i,o,s,l,u,c){var f=2*e;for(var h=s,p=f*s;h<l;++h,p+=f){var v=u[t+p],d=u[t+p+e],m=c[h];e:for(var g=a,y=f*a;g<n;++g,y+=f){var x=i[t+y],b=i[t+y+e],_=o[g];if(d<x||b<v)continue;for(var w=t+1;w<e;++w){var T=i[w+y],k=i[w+e+y],M=u[w+p],A=u[w+e+p];if(k<M||A<T)continue e}var S=r(_,m);if(S!==void 0)return S}}}function r(r,a,n,i,o,s,l,u,c,f,h){if(o-i>c-u){return e(r,a,n,i,o,s,l,u,c,f,h)}else{return t(r,a,n,i,o,s,l,u,c,f,h)}}return r}function n(){function e(e,t,r,a,n,i,o,s,l,u,c){var f=2*e;for(var h=a,p=f*a;h<n;++h,p+=f){var v=i[t+p],d=i[t+p+e],m=o[h];e:for(var g=s,y=f*s;g<l;++g,y+=f){var x=u[t+y],b=c[g];if(x<=v||d<x)continue;for(var _=t+1;_<e;++_){var w=i[_+p],T=i[_+e+p],k=u[_+y],M=u[_+e+y];if(T<k||M<w)continue e}var A=r(b,m);if(A!==void 0)return A}}}function t(e,t,r,a,n,i,o,s,l,u,c){var f=2*e;for(var h=a,p=f*a;h<n;++h,p+=f){var v=i[t+p],d=i[t+p+e],m=o[h];e:for(var g=s,y=f*s;g<l;++g,y+=f){var x=u[t+y],b=c[g];if(x<v||d<x)continue;for(var _=t+1;_<e;++_){var w=i[_+p],T=i[_+e+p],k=u[_+y],M=u[_+e+y];if(T<k||M<w)continue e}var A=r(m,b);if(A!==void 0)return A}}}function r(e,t,r,a,n,i,o,s,l,u,c){var f=2*e;for(var h=s,p=f*s;h<l;++h,p+=f){var v=u[t+p],d=c[h];e:for(var m=a,g=f*a;m<n;++m,g+=f){var y=i[t+g],x=i[t+g+e],b=o[m];if(v<=y||x<v)continue;for(var _=t+1;_<e;++_){var w=i[_+g],T=i[_+e+g],k=u[_+p],M=u[_+e+p];if(T<k||M<w)continue e}var A=r(d,b);if(A!==void 0)return A}}}function a(e,t,r,a,n,i,o,s,l,u,c){var f=2*e;for(var h=s,p=f*s;h<l;++h,p+=f){var v=u[t+p],d=c[h];e:for(var m=a,g=f*a;m<n;++m,g+=f){var y=i[t+g],x=i[t+g+e],b=o[m];if(v<y||x<v)continue;for(var _=t+1;_<e;++_){var w=i[_+g],T=i[_+e+g],k=u[_+p],M=u[_+e+p];if(T<k||M<w)continue e}var A=r(b,d);if(A!==void 0)return A}}}function n(n,i,o,s,l,u,c,f,h,p,v,d){if(u-l>p-h){if(s){return e(n,i,o,l,u,c,f,h,p,v,d)}else{return t(n,i,o,l,u,c,f,h,p,v,d)}}else{if(s){return r(n,i,o,l,u,c,f,h,p,v,d)}else{return a(n,i,o,l,u,c,f,h,p,v,d)}}}return n}function i(e){return e?a():n()}r.partial=i(false);r.full=i(true)},{}],110:[function(e,t,r){"use strict";t.exports=L;var a=e("typedarray-pool");var n=e("bit-twiddle");var i=e("./brute");var o=i.partial;var s=i.full;var l=e("./sweep");var u=e("./median");var c=e("./partition");var f=128;var h=1<<22;var p=1<<22;var v=c("!(lo>=p0)&&!(p1>=hi)");var d=c("lo===p0");var m=c("lo<p0");var g=c("hi<=p0");var y=c("lo<=p0&&p0<=hi");var x=c("lo<p0&&p0<=hi");var b=6;var _=2;var w=1024;var T=a.mallocInt32(w);var k=a.mallocDouble(w);function M(e,t){var r=8*n.log2(t+1)*(e+1)|0;var i=n.nextPow2(b*r);if(T.length<i){a.free(T);T=a.mallocInt32(i)}var o=n.nextPow2(_*r);if(k.length<o){a.free(k);k=a.mallocDouble(o)}}function A(e,t,r,a,n,i,o,s,l){var u=b*e;T[u]=t;T[u+1]=r;T[u+2]=a;T[u+3]=n;T[u+4]=i;T[u+5]=o;var c=_*e;k[c]=s;k[c+1]=l}function S(e,t,r,a,n,i,o,s,l,u,c){var f=2*e;var h=l*f;var p=u[h+t];e:for(var v=n,d=n*f;v<i;++v,d+=f){var m=o[d+t];var g=o[d+t+e];if(p<m||g<p){continue}if(a&&p===m){continue}var y=s[v];for(var x=t+1;x<e;++x){var m=o[d+x];var g=o[d+x+e];var b=u[h+x];var _=u[h+x+e];if(g<b||_<m){continue e}}var w;if(a){w=r(c,y)}else{w=r(y,c)}if(w!==void 0){return w}}}function E(e,t,r,a,n,i,o,s,l,u){var c=2*e;var f=s*c;var h=l[f+t];e:for(var p=a,v=a*c;p<n;++p,v+=c){var d=o[p];if(d===u){continue}var m=i[v+t];var g=i[v+t+e];if(h<m||g<h){continue}for(var y=t+1;y<e;++y){var m=i[v+y];var g=i[v+y+e];var x=l[f+y];var b=l[f+y+e];if(g<x||b<m){continue e}}var _=r(d,u);if(_!==void 0){return _}}}function L(e,t,r,a,n,i,c,w,L){M(e,a+c);var C=0;var I=2*e;var P;A(C++,0,0,a,0,c,r?16:0,-Infinity,Infinity);if(!r){A(C++,0,0,c,0,a,1,-Infinity,Infinity)}while(C>0){C-=1;var O=C*b;var z=T[O];var D=T[O+1];var R=T[O+2];var F=T[O+3];var B=T[O+4];var N=T[O+5];var j=C*_;var U=k[j];var V=k[j+1];var H=N&1;var q=!!(N&16);var G=n;var Y=i;var W=w;var X=L;if(H){G=w;Y=L;W=n;X=i}if(N&2){R=m(e,z,D,R,G,Y,V);if(D>=R){continue}}if(N&4){D=g(e,z,D,R,G,Y,U);if(D>=R){continue}}var Z=R-D;var J=B-F;if(q){if(e*Z*(Z+J)<p){P=l.scanComplete(e,z,t,D,R,G,Y,F,B,W,X);if(P!==void 0){return P}continue}}else{if(e*Math.min(Z,J)<f){P=o(e,z,t,H,D,R,G,Y,F,B,W,X);if(P!==void 0){return P}continue}else if(e*Z*J<h){P=l.scanBipartite(e,z,t,H,D,R,G,Y,F,B,W,X);if(P!==void 0){return P}continue}}var K=v(e,z,D,R,G,Y,U,V);if(D<K){if(e*(K-D)<f){P=s(e,z+1,t,D,K,G,Y,F,B,W,X);if(P!==void 0){return P}}else if(z===e-2){if(H){P=l.sweepBipartite(e,t,F,B,W,X,D,K,G,Y)}else{P=l.sweepBipartite(e,t,D,K,G,Y,F,B,W,X)}if(P!==void 0){return P}}else{A(C++,z+1,D,K,F,B,H,-Infinity,Infinity);A(C++,z+1,F,B,D,K,H^1,-Infinity,Infinity)}}if(K<R){var Q=u(e,z,F,B,W,X);var $=W[I*Q+z];var ee=d(e,z,Q,B,W,X,$);if(ee<B){A(C++,z,K,R,ee,B,(H|4)+(q?16:0),$,V)}if(F<Q){A(C++,z,K,R,F,Q,(H|2)+(q?16:0),U,$)}if(Q+1===ee){if(q){P=E(e,z,t,K,R,G,Y,Q,W,X[Q])}else{P=S(e,z,t,H,K,R,G,Y,Q,W,X[Q])}if(P!==void 0){return P}}else if(Q<ee){var te;if(q){te=y(e,z,K,R,G,Y,$);if(K<te){var re=d(e,z,K,te,G,Y,$);if(z===e-2){if(K<re){P=l.sweepComplete(e,t,K,re,G,Y,Q,ee,W,X);if(P!==void 0){return P}}if(re<te){P=l.sweepBipartite(e,t,re,te,G,Y,Q,ee,W,X);if(P!==void 0){return P}}}else{if(K<re){A(C++,z+1,K,re,Q,ee,16,-Infinity,Infinity)}if(re<te){A(C++,z+1,re,te,Q,ee,0,-Infinity,Infinity);A(C++,z+1,Q,ee,re,te,1,-Infinity,Infinity)}}}}else{if(H){te=x(e,z,K,R,G,Y,$)}else{te=y(e,z,K,R,G,Y,$)}if(K<te){if(z===e-2){if(H){P=l.sweepBipartite(e,t,Q,ee,W,X,K,te,G,Y)}else{P=l.sweepBipartite(e,t,K,te,G,Y,Q,ee,W,X)}}else{A(C++,z+1,K,te,Q,ee,H,-Infinity,Infinity);A(C++,z+1,Q,ee,K,te,H^1,-Infinity,Infinity)}}}}}}}},{"./brute":109,"./median":111,"./partition":112,"./sweep":114,"bit-twiddle":104,"typedarray-pool":601}],111:[function(e,t,r){"use strict";t.exports=s;var a=e("./partition");var n=a("lo<p0");var i=8;function o(e,t,r,a,n,i){var o=2*e;var s=o*(r+1)+t;for(var l=r+1;l<a;++l,s+=o){var u=n[s];for(var c=l,f=o*(l-1);c>r&&n[f+t]>u;--c,f-=o){var h=f;var p=f+o;for(var v=0;v<o;++v,++h,++p){var d=n[h];n[h]=n[p];n[p]=d}var m=i[c];i[c]=i[c-1];i[c-1]=m}}}function s(e,t,r,a,s,l){if(a<=r+1){return r}var u=r;var c=a;var f=a+r>>>1;var h=2*e;var p=f;var v=s[h*f+t];while(u<c){if(c-u<i){o(e,t,u,c,s,l);v=s[h*f+t];break}var d=c-u;var m=Math.random()*d+u|0;var g=s[h*m+t];var y=Math.random()*d+u|0;var x=s[h*y+t];var b=Math.random()*d+u|0;var _=s[h*b+t];if(g<=x){if(_>=x){p=y;v=x}else if(g>=_){p=m;v=g}else{p=b;v=_}}else{if(x>=_){p=y;v=x}else if(_>=g){p=m;v=g}else{p=b;v=_}}var w=h*(c-1);var T=h*p;for(var k=0;k<h;++k,++w,++T){var M=s[w];s[w]=s[T];s[T]=M}var A=l[c-1];l[c-1]=l[p];l[p]=A;p=n(e,t,u,c-1,s,l,v);var w=h*(c-1);var T=h*p;for(var k=0;k<h;++k,++w,++T){var M=s[w];s[w]=s[T];s[T]=M}var A=l[c-1];l[c-1]=l[p];l[p]=A;if(f<p){c=p-1;while(u<c&&s[h*(c-1)+t]===v){c-=1}c+=1}else if(p<f){u=p+1;while(u<c&&s[h*u+t]===v){u+=1}}else{break}}return n(e,t,r,f,s,l,s[h*f+t])}},{"./partition":112}],112:[function(e,t,r){"use strict";t.exports=n;var a={"lo===p0":i,"lo<p0":o,"lo<=p0":s,"hi<=p0":l,"lo<p0&&p0<=hi":c,"lo<=p0&&p0<=hi":u,"!(lo>=p0)&&!(p1>=hi)":f};function n(e){return a[e]}function i(e,t,r,a,n,i,o){for(var s=2*e,l=s*r,u=l,c=r,f=t,h=e+t,p=r;a>p;++p,l+=s){var v=n[l+f];if(v===o)if(c===p)c+=1,u+=s;else{for(var d=0;s>d;++d){var m=n[l+d];n[l+d]=n[u],n[u++]=m}var g=i[p];i[p]=i[c],i[c++]=g}}return c}function o(e,t,r,a,n,i,o){for(var s=2*e,l=s*r,u=l,c=r,f=t,h=e+t,p=r;a>p;++p,l+=s){var v=n[l+f];if(v<o)if(c===p)c+=1,u+=s;else{for(var d=0;s>d;++d){var m=n[l+d];n[l+d]=n[u],n[u++]=m}var g=i[p];i[p]=i[c],i[c++]=g}}return c}function s(e,t,r,a,n,i,o){for(var s=2*e,l=s*r,u=l,c=r,f=t,h=e+t,p=r;a>p;++p,l+=s){var v=n[l+h];if(v<=o)if(c===p)c+=1,u+=s;else{for(var d=0;s>d;++d){var m=n[l+d];n[l+d]=n[u],n[u++]=m}var g=i[p];i[p]=i[c],i[c++]=g}}return c}function l(e,t,r,a,n,i,o){for(var s=2*e,l=s*r,u=l,c=r,f=t,h=e+t,p=r;a>p;++p,l+=s){var v=n[l+h];if(v<=o)if(c===p)c+=1,u+=s;else{for(var d=0;s>d;++d){var m=n[l+d];n[l+d]=n[u],n[u++]=m}var g=i[p];i[p]=i[c],i[c++]=g}}return c}function u(e,t,r,a,n,i,o){for(var s=2*e,l=s*r,u=l,c=r,f=t,h=e+t,p=r;a>p;++p,l+=s){var v=n[l+f],d=n[l+h];if(v<=o&&o<=d)if(c===p)c+=1,u+=s;else{for(var m=0;s>m;++m){var g=n[l+m];n[l+m]=n[u],n[u++]=g}var y=i[p];i[p]=i[c],i[c++]=y}}return c}function c(e,t,r,a,n,i,o){for(var s=2*e,l=s*r,u=l,c=r,f=t,h=e+t,p=r;a>p;++p,l+=s){var v=n[l+f],d=n[l+h];if(v<o&&o<=d)if(c===p)c+=1,u+=s;else{for(var m=0;s>m;++m){var g=n[l+m];n[l+m]=n[u],n[u++]=g}var y=i[p];i[p]=i[c],i[c++]=y}}return c}function f(e,t,r,a,n,i,o,s){for(var l=2*e,u=l*r,c=u,f=r,h=t,p=e+t,v=r;a>v;++v,u+=l){var d=n[u+h],m=n[u+p];if(!(d>=o)&&!(s>=m))if(f===v)f+=1,c+=l;else{for(var g=0;l>g;++g){var y=n[u+g];n[u+g]=n[c],n[c++]=y}var x=i[v];i[v]=i[f],i[f++]=x}}return f}},{}],113:[function(e,t,r){"use strict";t.exports=n;var a=32;function n(e,t){if(t<=4*a){i(0,t-1,e)}else{h(0,t-1,e)}}function i(e,t,r){var a=2*(e+1);for(var n=e+1;n<=t;++n){var i=r[a++];var o=r[a++];var s=n;var l=a-2;while(s-- >e){var u=r[l-2];var c=r[l-1];if(u<i){break}else if(u===i&&c<o){break}r[l]=u;r[l+1]=c;l-=2}r[l]=i;r[l+1]=o}}function o(e,t,r){e*=2;t*=2;var a=r[e];var n=r[e+1];r[e]=r[t];r[e+1]=r[t+1];r[t]=a;r[t+1]=n}function s(e,t,r){e*=2;t*=2;r[e]=r[t];r[e+1]=r[t+1]}function l(e,t,r,a){e*=2;t*=2;r*=2;var n=a[e];var i=a[e+1];a[e]=a[t];a[e+1]=a[t+1];a[t]=a[r];a[t+1]=a[r+1];a[r]=n;a[r+1]=i}function u(e,t,r,a,n){e*=2;t*=2;n[e]=n[t];n[t]=r;n[e+1]=n[t+1];n[t+1]=a}function c(e,t,r){e*=2;t*=2;var a=r[e],n=r[t];if(a<n){return false}else if(a===n){return r[e+1]>r[t+1]}return true}function f(e,t,r,a){e*=2;var n=a[e];if(n<t){return true}else if(n===t){return a[e+1]<r}return false}function h(e,t,r){var n=(t-e+1)/6|0,p=e+n,v=t-n,d=e+t>>1,m=d-n,g=d+n,y=p,x=m,b=d,_=g,w=v,T=e+1,k=t-1,M=0;if(c(y,x,r)){M=y;y=x;x=M}if(c(_,w,r)){M=_;_=w;w=M}if(c(y,b,r)){M=y;y=b;b=M}if(c(x,b,r)){M=x;x=b;b=M}if(c(y,_,r)){M=y;y=_;_=M}if(c(b,_,r)){M=b;b=_;_=M}if(c(x,w,r)){M=x;x=w;w=M}if(c(x,b,r)){M=x;x=b;b=M}if(c(_,w,r)){M=_;_=w;w=M}var A=r[2*x];var S=r[2*x+1];var E=r[2*_];var L=r[2*_+1];var C=2*y;var I=2*b;var P=2*w;var O=2*p;var z=2*d;var D=2*v;for(var R=0;R<2;++R){var F=r[C+R];var B=r[I+R];var N=r[P+R];r[O+R]=F;r[z+R]=B;r[D+R]=N}s(m,e,r);s(g,t,r);for(var j=T;j<=k;++j){if(f(j,A,S,r)){if(j!==T){o(j,T,r)}++T}else{if(!f(j,E,L,r)){while(true){if(!f(k,E,L,r)){if(--k<j){break}continue}else{if(f(k,A,S,r)){l(j,T,k,r);++T;--k}else{o(j,k,r);--k}break}}}}}u(e,T-1,A,S,r);u(t,k+1,E,L,r);if(T-2-e<=a){i(e,T-2,r)}else{h(e,T-2,r)}if(t-(k+2)<=a){i(k+2,t,r)}else{h(k+2,t,r)}if(k-T<=a){i(T,k,r)}else{h(T,k,r)}}},{}],114:[function(e,t,r){"use strict";t.exports={init:d,sweepBipartite:y,sweepComplete:x,scanBipartite:b,scanComplete:_};var a=e("typedarray-pool");var n=e("bit-twiddle");var i=e("./sort");var o=1<<28;var s=1024;var l=a.mallocInt32(s);var u=a.mallocInt32(s);var c=a.mallocInt32(s);var f=a.mallocInt32(s);var h=a.mallocInt32(s);var p=a.mallocInt32(s);var v=a.mallocDouble(s*8);function d(e){var t=n.nextPow2(e);if(l.length<t){a.free(l);l=a.mallocInt32(t)}if(u.length<t){a.free(u);u=a.mallocInt32(t)}if(c.length<t){a.free(c);c=a.mallocInt32(t)}if(f.length<t){a.free(f);f=a.mallocInt32(t)}if(h.length<t){a.free(h);h=a.mallocInt32(t)}if(p.length<t){a.free(p);p=a.mallocInt32(t)}var r=8*t;if(v.length<r){a.free(v);v=a.mallocDouble(r)}}function m(e,t,r,a){var n=t[a];var i=e[r-1];e[n]=i;t[i]=n}function g(e,t,r,a){e[r]=a;t[a]=r}function y(e,t,r,a,n,s,h,p,d,y){var x=0;var b=2*e;var _=e-1;var w=b-1;for(var T=r;T<a;++T){var k=s[T];var M=b*T;v[x++]=n[M+_];v[x++]=-(k+1);v[x++]=n[M+w];v[x++]=k}for(var T=h;T<p;++T){var k=y[T]+o;var A=b*T;v[x++]=d[A+_];v[x++]=-k;v[x++]=d[A+w];v[x++]=k}var S=x>>>1;i(v,S);var E=0;var L=0;for(var T=0;T<S;++T){var C=v[2*T+1]|0;if(C>=o){C=C-o|0;m(c,f,L--,C)}else if(C>=0){m(l,u,E--,C)}else if(C<=-o){C=-C-o|0;for(var I=0;I<E;++I){var P=t(l[I],C);if(P!==void 0){return P}}g(c,f,L++,C)}else{C=-C-1|0;for(var I=0;I<L;++I){var P=t(C,c[I]);if(P!==void 0){return P}}g(l,u,E++,C)}}}function x(e,t,r,a,n,o,s,d,y,x){var b=0;var _=2*e;var w=e-1;var T=_-1;for(var k=r;k<a;++k){var M=o[k]+1<<1;var A=_*k;v[b++]=n[A+w];v[b++]=-M;v[b++]=n[A+T];v[b++]=M}for(var k=s;k<d;++k){var M=x[k]+1<<1;var S=_*k;v[b++]=y[S+w];v[b++]=-M|1;v[b++]=y[S+T];v[b++]=M|1}var E=b>>>1;i(v,E);var L=0;var C=0;var I=0;for(var k=0;k<E;++k){var P=v[2*k+1]|0;var O=P&1;if(k<E-1&&P>>1===v[2*k+3]>>1){O=2;k+=1}if(P<0){var z=-(P>>1)-1;for(var D=0;D<I;++D){var R=t(h[D],z);if(R!==void 0){return R}}if(O!==0){for(var D=0;D<L;++D){var R=t(l[D],z);if(R!==void 0){return R}}}if(O!==1){for(var D=0;D<C;++D){var R=t(c[D],z);if(R!==void 0){return R}}}if(O===0){g(l,u,L++,z)}else if(O===1){g(c,f,C++,z)}else if(O===2){g(h,p,I++,z)}}else{var z=(P>>1)-1;if(O===0){m(l,u,L--,z)}else if(O===1){m(c,f,C--,z)}else if(O===2){m(h,p,I--,z)}}}}function b(e,t,r,a,n,s,c,f,h,p,d,y){var x=0;var b=2*e;var _=t;var w=t+e;var T=1;var k=1;if(a){k=o}else{T=o}for(var M=n;M<s;++M){var A=M+T;var S=b*M;v[x++]=c[S+_];v[x++]=-A;v[x++]=c[S+w];v[x++]=A}for(var M=h;M<p;++M){var A=M+k;var E=b*M;v[x++]=d[E+_];v[x++]=-A}var L=x>>>1;i(v,L);var C=0;for(var M=0;M<L;++M){var I=v[2*M+1]|0;if(I<0){var A=-I;var P=false;if(A>=o){P=!a;A-=o}else{P=!!a;A-=1}if(P){g(l,u,C++,A)}else{var O=y[A];var z=b*A;var D=d[z+t+1];var R=d[z+t+1+e];e:for(var F=0;F<C;++F){var B=l[F];var N=b*B;if(R<c[N+t+1]||c[N+t+1+e]<D){continue}for(var j=t+2;j<e;++j){if(d[z+j+e]<c[N+j]||c[N+j+e]<d[z+j]){continue e}}var U=f[B];var V;if(a){V=r(O,U)}else{V=r(U,O)}if(V!==void 0){return V}}}}else{m(l,u,C--,I-T)}}}function _(e,t,r,a,n,s,u,c,f,h,p){var d=0;var m=2*e;var g=t;var y=t+e;for(var x=a;x<n;++x){var b=x+o;var _=m*x;v[d++]=s[_+g];v[d++]=-b;v[d++]=s[_+y];v[d++]=b}for(var x=c;x<f;++x){var b=x+1;var w=m*x;v[d++]=h[w+g];v[d++]=-b}var T=d>>>1;i(v,T);var k=0;for(var x=0;x<T;++x){var M=v[2*x+1]|0;if(M<0){var b=-M;if(b>=o){l[k++]=b-o}else{b-=1;var A=p[b];var S=m*b;var E=h[S+t+1];var L=h[S+t+1+e];e:for(var C=0;C<k;++C){var I=l[C];var P=u[I];if(P===A){break}var O=m*I;if(L<s[O+t+1]||s[O+t+1+e]<E){continue}for(var z=t+2;z<e;++z){if(h[S+z+e]<s[O+z]||s[O+z+e]<h[S+z]){continue e}}var D=r(P,A);if(D!==void 0){return D}}}}else{var b=M-o;for(var C=k-1;C>=0;--C){if(l[C]===b){for(var z=C+1;z<k;++z){l[z-1]=l[z]}break}}--k}}}},{"./sort":113,"bit-twiddle":104,"typedarray-pool":601}],115:[function(e,t,r){},{}],116:[function(e,t,r){"use strict";var a=typeof Reflect==="object"?Reflect:null;var n=a&&typeof a.apply==="function"?a.apply:function e(t,r,a){return Function.prototype.apply.call(t,r,a)};var i;if(a&&typeof a.ownKeys==="function"){i=a.ownKeys}else if(Object.getOwnPropertySymbols){i=function e(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}}else{i=function e(t){return Object.getOwnPropertyNames(t)}}function o(e){if(console&&console.warn)console.warn(e)}var s=Number.isNaN||function e(t){return t!==t};function l(){l.init.call(this)}t.exports=l;t.exports.once=b;l.EventEmitter=l;l.prototype._events=undefined;l.prototype._eventsCount=0;l.prototype._maxListeners=undefined;var u=10;function c(e){if(typeof e!=="function"){throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}}Object.defineProperty(l,"defaultMaxListeners",{enumerable:true,get:function(){return u},set:function(e){if(typeof e!=="number"||e<0||s(e)){throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".")}u=e}});l.init=function(){if(this._events===undefined||this._events===Object.getPrototypeOf(this)._events){this._events=Object.create(null);this._eventsCount=0}this._maxListeners=this._maxListeners||undefined};l.prototype.setMaxListeners=function e(t){if(typeof t!=="number"||t<0||s(t)){throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".")}this._maxListeners=t;return this};function f(e){if(e._maxListeners===undefined)return l.defaultMaxListeners;return e._maxListeners}l.prototype.getMaxListeners=function e(){return f(this)};l.prototype.emit=function e(t){var r=[];for(var a=1;a<arguments.length;a++)r.push(arguments[a]);var i=t==="error";var o=this._events;if(o!==undefined)i=i&&o.error===undefined;else if(!i)return false;if(i){var s;if(r.length>0)s=r[0];if(s instanceof Error){throw s}var l=new Error("Unhandled error."+(s?" ("+s.message+")":""));l.context=s;throw l}var u=o[t];if(u===undefined)return false;if(typeof u==="function"){n(u,this,r)}else{var c=u.length;var f=g(u,c);for(var a=0;a<c;++a)n(f[a],this,r)}return true};function h(e,t,r,a){var n;var i;var s;c(r);i=e._events;if(i===undefined){i=e._events=Object.create(null);e._eventsCount=0}else{if(i.newListener!==undefined){e.emit("newListener",t,r.listener?r.listener:r);i=e._events}s=i[t]}if(s===undefined){s=i[t]=r;++e._eventsCount}else{if(typeof s==="function"){s=i[t]=a?[r,s]:[s,r]}else if(a){s.unshift(r)}else{s.push(r)}n=f(e);if(n>0&&s.length>n&&!s.warned){s.warned=true;var l=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners "+"added. Use emitter.setMaxListeners() to "+"increase limit");l.name="MaxListenersExceededWarning";l.emitter=e;l.type=t;l.count=s.length;o(l)}}return e}l.prototype.addListener=function e(t,r){return h(this,t,r,false)};l.prototype.on=l.prototype.addListener;l.prototype.prependListener=function e(t,r){return h(this,t,r,true)};function p(){if(!this.fired){this.target.removeListener(this.type,this.wrapFn);this.fired=true;if(arguments.length===0)return this.listener.call(this.target);return this.listener.apply(this.target,arguments)}}function v(e,t,r){var a={fired:false,wrapFn:undefined,target:e,type:t,listener:r};var n=p.bind(a);n.listener=r;a.wrapFn=n;return n}l.prototype.once=function e(t,r){c(r);this.on(t,v(this,t,r));return this};l.prototype.prependOnceListener=function e(t,r){c(r);this.prependListener(t,v(this,t,r));return this};l.prototype.removeListener=function e(t,r){var a,n,i,o,s;c(r);n=this._events;if(n===undefined)return this;a=n[t];if(a===undefined)return this;if(a===r||a.listener===r){if(--this._eventsCount===0)this._events=Object.create(null);else{delete n[t];if(n.removeListener)this.emit("removeListener",t,a.listener||r)}}else if(typeof a!=="function"){i=-1;for(o=a.length-1;o>=0;o--){if(a[o]===r||a[o].listener===r){s=a[o].listener;i=o;break}}if(i<0)return this;if(i===0)a.shift();else{y(a,i)}if(a.length===1)n[t]=a[0];if(n.removeListener!==undefined)this.emit("removeListener",t,s||r)}return this};l.prototype.off=l.prototype.removeListener;l.prototype.removeAllListeners=function e(t){var r,a,n;a=this._events;if(a===undefined)return this;if(a.removeListener===undefined){if(arguments.length===0){this._events=Object.create(null);this._eventsCount=0}else if(a[t]!==undefined){if(--this._eventsCount===0)this._events=Object.create(null);else delete a[t]}return this}if(arguments.length===0){var i=Object.keys(a);var o;for(n=0;n<i.length;++n){o=i[n];if(o==="removeListener")continue;this.removeAllListeners(o)}this.removeAllListeners("removeListener");this._events=Object.create(null);this._eventsCount=0;return this}r=a[t];if(typeof r==="function"){this.removeListener(t,r)}else if(r!==undefined){for(n=r.length-1;n>=0;n--){this.removeListener(t,r[n])}}return this};function d(e,t,r){var a=e._events;if(a===undefined)return[];var n=a[t];if(n===undefined)return[];if(typeof n==="function")return r?[n.listener||n]:[n];return r?x(n):g(n,n.length)}l.prototype.listeners=function e(t){return d(this,t,true)};l.prototype.rawListeners=function e(t){return d(this,t,false)};l.listenerCount=function(e,t){if(typeof e.listenerCount==="function"){return e.listenerCount(t)}else{return m.call(e,t)}};l.prototype.listenerCount=m;function m(e){var t=this._events;if(t!==undefined){var r=t[e];if(typeof r==="function"){return 1}else if(r!==undefined){return r.length}}return 0}l.prototype.eventNames=function e(){return this._eventsCount>0?i(this._events):[]};function g(e,t){var r=new Array(t);for(var a=0;a<t;++a)r[a]=e[a];return r}function y(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}function x(e){var t=new Array(e.length);for(var r=0;r<t.length;++r){t[r]=e[r].listener||e[r]}return t}function b(e,t){return new Promise((function(r,a){function n(){if(i!==undefined){e.removeListener("error",i)}r([].slice.call(arguments))}var i;if(t!=="error"){i=function r(i){e.removeListener(t,n);a(i)};e.once("error",i)}e.once(t,n)}))}},{}],117:[function(e,t,r){(function(t){(function(){"use strict";var t=e("base64-js");var a=e("ieee754");r.Buffer=s;r.SlowBuffer=g;r.INSPECT_MAX_BYTES=50;var n=2147483647;r.kMaxLength=n;s.TYPED_ARRAY_SUPPORT=i();if(!s.TYPED_ARRAY_SUPPORT&&typeof console!=="undefined"&&typeof console.error==="function"){console.error("This browser lacks typed array (Uint8Array) support which is required by "+"`buffer` v5.x. Use `buffer` v4.x if you require old browser support.")}function i(){try{var e=new Uint8Array(1);e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}};return e.foo()===42}catch(t){return false}}Object.defineProperty(s.prototype,"parent",{enumerable:true,get:function(){if(!s.isBuffer(this))return undefined;return this.buffer}});Object.defineProperty(s.prototype,"offset",{enumerable:true,get:function(){if(!s.isBuffer(this))return undefined;return this.byteOffset}});function o(e){if(e>n){throw new RangeError('The value "'+e+'" is invalid for option "size"')}var t=new Uint8Array(e);t.__proto__=s.prototype;return t}function s(e,t,r){if(typeof e==="number"){if(typeof t==="string"){throw new TypeError('The "string" argument must be of type string. Received type number')}return f(e)}return l(e,t,r)}if(typeof Symbol!=="undefined"&&Symbol.species!=null&&s[Symbol.species]===s){Object.defineProperty(s,Symbol.species,{value:null,configurable:true,enumerable:false,writable:false})}s.poolSize=8192;function l(e,t,r){if(typeof e==="string"){return h(e,t)}if(ArrayBuffer.isView(e)){return p(e)}if(e==null){throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, "+"or Array-like Object. Received type "+typeof e)}if(J(e,ArrayBuffer)||e&&J(e.buffer,ArrayBuffer)){return v(e,t,r)}if(typeof e==="number"){throw new TypeError('The "value" argument must not be of type number. Received type number')}var a=e.valueOf&&e.valueOf();if(a!=null&&a!==e){return s.from(a,t,r)}var n=d(e);if(n)return n;if(typeof Symbol!=="undefined"&&Symbol.toPrimitive!=null&&typeof e[Symbol.toPrimitive]==="function"){return s.from(e[Symbol.toPrimitive]("string"),t,r)}throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, "+"or Array-like Object. Received type "+typeof e)}s.from=function(e,t,r){return l(e,t,r)};s.prototype.__proto__=Uint8Array.prototype;s.__proto__=Uint8Array;function u(e){if(typeof e!=="number"){throw new TypeError('"size" argument must be of type number')}else if(e<0){throw new RangeError('The value "'+e+'" is invalid for option "size"')}}function c(e,t,r){u(e);if(e<=0){return o(e)}if(t!==undefined){return typeof r==="string"?o(e).fill(t,r):o(e).fill(t)}return o(e)}s.alloc=function(e,t,r){return c(e,t,r)};function f(e){u(e);return o(e<0?0:m(e)|0)}s.allocUnsafe=function(e){return f(e)};s.allocUnsafeSlow=function(e){return f(e)};function h(e,t){if(typeof t!=="string"||t===""){t="utf8"}if(!s.isEncoding(t)){throw new TypeError("Unknown encoding: "+t)}var r=y(e,t)|0;var a=o(r);var n=a.write(e,t);if(n!==r){a=a.slice(0,n)}return a}function p(e){var t=e.length<0?0:m(e.length)|0;var r=o(t);for(var a=0;a<t;a+=1){r[a]=e[a]&255}return r}function v(e,t,r){if(t<0||e.byteLength<t){throw new RangeError('"offset" is outside of buffer bounds')}if(e.byteLength<t+(r||0)){throw new RangeError('"length" is outside of buffer bounds')}var a;if(t===undefined&&r===undefined){a=new Uint8Array(e)}else if(r===undefined){a=new Uint8Array(e,t)}else{a=new Uint8Array(e,t,r)}a.__proto__=s.prototype;return a}function d(e){if(s.isBuffer(e)){var t=m(e.length)|0;var r=o(t);if(r.length===0){return r}e.copy(r,0,0,t);return r}if(e.length!==undefined){if(typeof e.length!=="number"||K(e.length)){return o(0)}return p(e)}if(e.type==="Buffer"&&Array.isArray(e.data)){return p(e.data)}}function m(e){if(e>=n){throw new RangeError("Attempt to allocate Buffer larger than maximum "+"size: 0x"+n.toString(16)+" bytes")}return e|0}function g(e){if(+e!=e){e=0}return s.alloc(+e)}s.isBuffer=function e(t){return t!=null&&t._isBuffer===true&&t!==s.prototype};s.compare=function e(t,r){if(J(t,Uint8Array))t=s.from(t,t.offset,t.byteLength);if(J(r,Uint8Array))r=s.from(r,r.offset,r.byteLength);if(!s.isBuffer(t)||!s.isBuffer(r)){throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array')}if(t===r)return 0;var a=t.length;var n=r.length;for(var i=0,o=Math.min(a,n);i<o;++i){if(t[i]!==r[i]){a=t[i];n=r[i];break}}if(a<n)return-1;if(n<a)return 1;return 0};s.isEncoding=function e(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return true;default:return false}};s.concat=function e(t,r){if(!Array.isArray(t)){throw new TypeError('"list" argument must be an Array of Buffers')}if(t.length===0){return s.alloc(0)}var a;if(r===undefined){r=0;for(a=0;a<t.length;++a){r+=t[a].length}}var n=s.allocUnsafe(r);var i=0;for(a=0;a<t.length;++a){var o=t[a];if(J(o,Uint8Array)){o=s.from(o)}if(!s.isBuffer(o)){throw new TypeError('"list" argument must be an Array of Buffers')}o.copy(n,i);i+=o.length}return n};function y(e,t){if(s.isBuffer(e)){return e.length}if(ArrayBuffer.isView(e)||J(e,ArrayBuffer)){return e.byteLength}if(typeof e!=="string"){throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. '+"Received type "+typeof e)}var r=e.length;var a=arguments.length>2&&arguments[2]===true;if(!a&&r===0)return 0;var n=false;for(;;){switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return G(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return r*2;case"hex":return r>>>1;case"base64":return X(e).length;default:if(n){return a?-1:G(e).length}t=(""+t).toLowerCase();n=true}}}s.byteLength=y;function x(e,t,r){var a=false;if(t===undefined||t<0){t=0}if(t>this.length){return""}if(r===undefined||r>this.length){r=this.length}if(r<=0){return""}r>>>=0;t>>>=0;if(r<=t){return""}if(!e)e="utf8";while(true){switch(e){case"hex":return D(this,t,r);case"utf8":case"utf-8":return C(this,t,r);case"ascii":return O(this,t,r);case"latin1":case"binary":return z(this,t,r);case"base64":return L(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return R(this,t,r);default:if(a)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase();a=true}}}s.prototype._isBuffer=true;function b(e,t,r){var a=e[t];e[t]=e[r];e[r]=a}s.prototype.swap16=function e(){var t=this.length;if(t%2!==0){throw new RangeError("Buffer size must be a multiple of 16-bits")}for(var r=0;r<t;r+=2){b(this,r,r+1)}return this};s.prototype.swap32=function e(){var t=this.length;if(t%4!==0){throw new RangeError("Buffer size must be a multiple of 32-bits")}for(var r=0;r<t;r+=4){b(this,r,r+3);b(this,r+1,r+2)}return this};s.prototype.swap64=function e(){var t=this.length;if(t%8!==0){throw new RangeError("Buffer size must be a multiple of 64-bits")}for(var r=0;r<t;r+=8){b(this,r,r+7);b(this,r+1,r+6);b(this,r+2,r+5);b(this,r+3,r+4)}return this};s.prototype.toString=function e(){var t=this.length;if(t===0)return"";if(arguments.length===0)return C(this,0,t);return x.apply(this,arguments)};s.prototype.toLocaleString=s.prototype.toString;s.prototype.equals=function e(t){if(!s.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(this===t)return true;return s.compare(this,t)===0};s.prototype.inspect=function e(){var t="";var a=r.INSPECT_MAX_BYTES;t=this.toString("hex",0,a).replace(/(.{2})/g,"$1 ").trim();if(this.length>a)t+=" ... ";return"<Buffer "+t+">"};s.prototype.compare=function e(t,r,a,n,i){if(J(t,Uint8Array)){t=s.from(t,t.offset,t.byteLength)}if(!s.isBuffer(t)){throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. '+"Received type "+typeof t)}if(r===undefined){r=0}if(a===undefined){a=t?t.length:0}if(n===undefined){n=0}if(i===undefined){i=this.length}if(r<0||a>t.length||n<0||i>this.length){throw new RangeError("out of range index")}if(n>=i&&r>=a){return 0}if(n>=i){return-1}if(r>=a){return 1}r>>>=0;a>>>=0;n>>>=0;i>>>=0;if(this===t)return 0;var o=i-n;var l=a-r;var u=Math.min(o,l);var c=this.slice(n,i);var f=t.slice(r,a);for(var h=0;h<u;++h){if(c[h]!==f[h]){o=c[h];l=f[h];break}}if(o<l)return-1;if(l<o)return 1;return 0};function _(e,t,r,a,n){if(e.length===0)return-1;if(typeof r==="string"){a=r;r=0}else if(r>2147483647){r=2147483647}else if(r<-2147483648){r=-2147483648}r=+r;if(K(r)){r=n?0:e.length-1}if(r<0)r=e.length+r;if(r>=e.length){if(n)return-1;else r=e.length-1}else if(r<0){if(n)r=0;else return-1}if(typeof t==="string"){t=s.from(t,a)}if(s.isBuffer(t)){if(t.length===0){return-1}return w(e,t,r,a,n)}else if(typeof t==="number"){t=t&255;if(typeof Uint8Array.prototype.indexOf==="function"){if(n){return Uint8Array.prototype.indexOf.call(e,t,r)}else{return Uint8Array.prototype.lastIndexOf.call(e,t,r)}}return w(e,[t],r,a,n)}throw new TypeError("val must be string, number or Buffer")}function w(e,t,r,a,n){var i=1;var o=e.length;var s=t.length;if(a!==undefined){a=String(a).toLowerCase();if(a==="ucs2"||a==="ucs-2"||a==="utf16le"||a==="utf-16le"){if(e.length<2||t.length<2){return-1}i=2;o/=2;s/=2;r/=2}}function l(e,t){if(i===1){return e[t]}else{return e.readUInt16BE(t*i)}}var u;if(n){var c=-1;for(u=r;u<o;u++){if(l(e,u)===l(t,c===-1?0:u-c)){if(c===-1)c=u;if(u-c+1===s)return c*i}else{if(c!==-1)u-=u-c;c=-1}}}else{if(r+s>o)r=o-s;for(u=r;u>=0;u--){var f=true;for(var h=0;h<s;h++){if(l(e,u+h)!==l(t,h)){f=false;break}}if(f)return u}}return-1}s.prototype.includes=function e(t,r,a){return this.indexOf(t,r,a)!==-1};s.prototype.indexOf=function e(t,r,a){return _(this,t,r,a,true)};s.prototype.lastIndexOf=function e(t,r,a){return _(this,t,r,a,false)};function T(e,t,r,a){r=Number(r)||0;var n=e.length-r;if(!a){a=n}else{a=Number(a);if(a>n){a=n}}var i=t.length;if(a>i/2){a=i/2}for(var o=0;o<a;++o){var s=parseInt(t.substr(o*2,2),16);if(K(s))return o;e[r+o]=s}return o}function k(e,t,r,a){return Z(G(t,e.length-r),e,r,a)}function M(e,t,r,a){return Z(Y(t),e,r,a)}function A(e,t,r,a){return M(e,t,r,a)}function S(e,t,r,a){return Z(X(t),e,r,a)}function E(e,t,r,a){return Z(W(t,e.length-r),e,r,a)}s.prototype.write=function e(t,r,a,n){if(r===undefined){n="utf8";a=this.length;r=0}else if(a===undefined&&typeof r==="string"){n=r;a=this.length;r=0}else if(isFinite(r)){r=r>>>0;if(isFinite(a)){a=a>>>0;if(n===undefined)n="utf8"}else{n=a;a=undefined}}else{throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported")}var i=this.length-r;if(a===undefined||a>i)a=i;if(t.length>0&&(a<0||r<0)||r>this.length){throw new RangeError("Attempt to write outside buffer bounds")}if(!n)n="utf8";var o=false;for(;;){switch(n){case"hex":return T(this,t,r,a);case"utf8":case"utf-8":return k(this,t,r,a);case"ascii":return M(this,t,r,a);case"latin1":case"binary":return A(this,t,r,a);case"base64":return S(this,t,r,a);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return E(this,t,r,a);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase();o=true}}};s.prototype.toJSON=function e(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function L(e,r,a){if(r===0&&a===e.length){return t.fromByteArray(e)}else{return t.fromByteArray(e.slice(r,a))}}function C(e,t,r){r=Math.min(e.length,r);var a=[];var n=t;while(n<r){var i=e[n];var o=null;var s=i>239?4:i>223?3:i>191?2:1;if(n+s<=r){var l,u,c,f;switch(s){case 1:if(i<128){o=i}break;case 2:l=e[n+1];if((l&192)===128){f=(i&31)<<6|l&63;if(f>127){o=f}}break;case 3:l=e[n+1];u=e[n+2];if((l&192)===128&&(u&192)===128){f=(i&15)<<12|(l&63)<<6|u&63;if(f>2047&&(f<55296||f>57343)){o=f}}break;case 4:l=e[n+1];u=e[n+2];c=e[n+3];if((l&192)===128&&(u&192)===128&&(c&192)===128){f=(i&15)<<18|(l&63)<<12|(u&63)<<6|c&63;if(f>65535&&f<1114112){o=f}}}}if(o===null){o=65533;s=1}else if(o>65535){o-=65536;a.push(o>>>10&1023|55296);o=56320|o&1023}a.push(o);n+=s}return P(a)}var I=4096;function P(e){var t=e.length;if(t<=I){return String.fromCharCode.apply(String,e)}var r="";var a=0;while(a<t){r+=String.fromCharCode.apply(String,e.slice(a,a+=I))}return r}function O(e,t,r){var a="";r=Math.min(e.length,r);for(var n=t;n<r;++n){a+=String.fromCharCode(e[n]&127)}return a}function z(e,t,r){var a="";r=Math.min(e.length,r);for(var n=t;n<r;++n){a+=String.fromCharCode(e[n])}return a}function D(e,t,r){var a=e.length;if(!t||t<0)t=0;if(!r||r<0||r>a)r=a;var n="";for(var i=t;i<r;++i){n+=q(e[i])}return n}function R(e,t,r){var a=e.slice(t,r);var n="";for(var i=0;i<a.length;i+=2){n+=String.fromCharCode(a[i]+a[i+1]*256)}return n}s.prototype.slice=function e(t,r){var a=this.length;t=~~t;r=r===undefined?a:~~r;if(t<0){t+=a;if(t<0)t=0}else if(t>a){t=a}if(r<0){r+=a;if(r<0)r=0}else if(r>a){r=a}if(r<t)r=t;var n=this.subarray(t,r);n.__proto__=s.prototype;return n};function F(e,t,r){if(e%1!==0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}s.prototype.readUIntLE=function e(t,r,a){t=t>>>0;r=r>>>0;if(!a)F(t,r,this.length);var n=this[t];var i=1;var o=0;while(++o<r&&(i*=256)){n+=this[t+o]*i}return n};s.prototype.readUIntBE=function e(t,r,a){t=t>>>0;r=r>>>0;if(!a){F(t,r,this.length)}var n=this[t+--r];var i=1;while(r>0&&(i*=256)){n+=this[t+--r]*i}return n};s.prototype.readUInt8=function e(t,r){t=t>>>0;if(!r)F(t,1,this.length);return this[t]};s.prototype.readUInt16LE=function e(t,r){t=t>>>0;if(!r)F(t,2,this.length);return this[t]|this[t+1]<<8};s.prototype.readUInt16BE=function e(t,r){t=t>>>0;if(!r)F(t,2,this.length);return this[t]<<8|this[t+1]};s.prototype.readUInt32LE=function e(t,r){t=t>>>0;if(!r)F(t,4,this.length);return(this[t]|this[t+1]<<8|this[t+2]<<16)+this[t+3]*16777216};s.prototype.readUInt32BE=function e(t,r){t=t>>>0;if(!r)F(t,4,this.length);return this[t]*16777216+(this[t+1]<<16|this[t+2]<<8|this[t+3])};s.prototype.readIntLE=function e(t,r,a){t=t>>>0;r=r>>>0;if(!a)F(t,r,this.length);var n=this[t];var i=1;var o=0;while(++o<r&&(i*=256)){n+=this[t+o]*i}i*=128;if(n>=i)n-=Math.pow(2,8*r);return n};s.prototype.readIntBE=function e(t,r,a){t=t>>>0;r=r>>>0;if(!a)F(t,r,this.length);var n=r;var i=1;var o=this[t+--n];while(n>0&&(i*=256)){o+=this[t+--n]*i}i*=128;if(o>=i)o-=Math.pow(2,8*r);return o};s.prototype.readInt8=function e(t,r){t=t>>>0;if(!r)F(t,1,this.length);if(!(this[t]&128))return this[t];return(255-this[t]+1)*-1};s.prototype.readInt16LE=function e(t,r){t=t>>>0;if(!r)F(t,2,this.length);var a=this[t]|this[t+1]<<8;return a&32768?a|4294901760:a};s.prototype.readInt16BE=function e(t,r){t=t>>>0;if(!r)F(t,2,this.length);var a=this[t+1]|this[t]<<8;return a&32768?a|4294901760:a};s.prototype.readInt32LE=function e(t,r){t=t>>>0;if(!r)F(t,4,this.length);return this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24};s.prototype.readInt32BE=function e(t,r){t=t>>>0;if(!r)F(t,4,this.length);return this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]};s.prototype.readFloatLE=function e(t,r){t=t>>>0;if(!r)F(t,4,this.length);return a.read(this,t,true,23,4)};s.prototype.readFloatBE=function e(t,r){t=t>>>0;if(!r)F(t,4,this.length);return a.read(this,t,false,23,4)};s.prototype.readDoubleLE=function e(t,r){t=t>>>0;if(!r)F(t,8,this.length);return a.read(this,t,true,52,8)};s.prototype.readDoubleBE=function e(t,r){t=t>>>0;if(!r)F(t,8,this.length);return a.read(this,t,false,52,8)};function B(e,t,r,a,n,i){if(!s.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>n||t<i)throw new RangeError('"value" argument is out of bounds');if(r+a>e.length)throw new RangeError("Index out of range")}s.prototype.writeUIntLE=function e(t,r,a,n){t=+t;r=r>>>0;a=a>>>0;if(!n){var i=Math.pow(2,8*a)-1;B(this,t,r,a,i,0)}var o=1;var s=0;this[r]=t&255;while(++s<a&&(o*=256)){this[r+s]=t/o&255}return r+a};s.prototype.writeUIntBE=function e(t,r,a,n){t=+t;r=r>>>0;a=a>>>0;if(!n){var i=Math.pow(2,8*a)-1;B(this,t,r,a,i,0)}var o=a-1;var s=1;this[r+o]=t&255;while(--o>=0&&(s*=256)){this[r+o]=t/s&255}return r+a};s.prototype.writeUInt8=function e(t,r,a){t=+t;r=r>>>0;if(!a)B(this,t,r,1,255,0);this[r]=t&255;return r+1};s.prototype.writeUInt16LE=function e(t,r,a){t=+t;r=r>>>0;if(!a)B(this,t,r,2,65535,0);this[r]=t&255;this[r+1]=t>>>8;return r+2};s.prototype.writeUInt16BE=function e(t,r,a){t=+t;r=r>>>0;if(!a)B(this,t,r,2,65535,0);this[r]=t>>>8;this[r+1]=t&255;return r+2};s.prototype.writeUInt32LE=function e(t,r,a){t=+t;r=r>>>0;if(!a)B(this,t,r,4,4294967295,0);this[r+3]=t>>>24;this[r+2]=t>>>16;this[r+1]=t>>>8;this[r]=t&255;return r+4};s.prototype.writeUInt32BE=function e(t,r,a){t=+t;r=r>>>0;if(!a)B(this,t,r,4,4294967295,0);this[r]=t>>>24;this[r+1]=t>>>16;this[r+2]=t>>>8;this[r+3]=t&255;return r+4};s.prototype.writeIntLE=function e(t,r,a,n){t=+t;r=r>>>0;if(!n){var i=Math.pow(2,8*a-1);B(this,t,r,a,i-1,-i)}var o=0;var s=1;var l=0;this[r]=t&255;while(++o<a&&(s*=256)){if(t<0&&l===0&&this[r+o-1]!==0){l=1}this[r+o]=(t/s>>0)-l&255}return r+a};s.prototype.writeIntBE=function e(t,r,a,n){t=+t;r=r>>>0;if(!n){var i=Math.pow(2,8*a-1);B(this,t,r,a,i-1,-i)}var o=a-1;var s=1;var l=0;this[r+o]=t&255;while(--o>=0&&(s*=256)){if(t<0&&l===0&&this[r+o+1]!==0){l=1}this[r+o]=(t/s>>0)-l&255}return r+a};s.prototype.writeInt8=function e(t,r,a){t=+t;r=r>>>0;if(!a)B(this,t,r,1,127,-128);if(t<0)t=255+t+1;this[r]=t&255;return r+1};s.prototype.writeInt16LE=function e(t,r,a){t=+t;r=r>>>0;if(!a)B(this,t,r,2,32767,-32768);this[r]=t&255;this[r+1]=t>>>8;return r+2};s.prototype.writeInt16BE=function e(t,r,a){t=+t;r=r>>>0;if(!a)B(this,t,r,2,32767,-32768);this[r]=t>>>8;this[r+1]=t&255;return r+2};s.prototype.writeInt32LE=function e(t,r,a){t=+t;r=r>>>0;if(!a)B(this,t,r,4,2147483647,-2147483648);this[r]=t&255;this[r+1]=t>>>8;this[r+2]=t>>>16;this[r+3]=t>>>24;return r+4};s.prototype.writeInt32BE=function e(t,r,a){t=+t;r=r>>>0;if(!a)B(this,t,r,4,2147483647,-2147483648);if(t<0)t=4294967295+t+1;this[r]=t>>>24;this[r+1]=t>>>16;this[r+2]=t>>>8;this[r+3]=t&255;return r+4};function N(e,t,r,a,n,i){if(r+a>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function j(e,t,r,n,i){t=+t;r=r>>>0;if(!i){N(e,t,r,4,34028234663852886e22,-34028234663852886e22)}a.write(e,t,r,n,23,4);return r+4}s.prototype.writeFloatLE=function e(t,r,a){return j(this,t,r,true,a)};s.prototype.writeFloatBE=function e(t,r,a){return j(this,t,r,false,a)};function U(e,t,r,n,i){t=+t;r=r>>>0;if(!i){N(e,t,r,8,17976931348623157e292,-17976931348623157e292)}a.write(e,t,r,n,52,8);return r+8}s.prototype.writeDoubleLE=function e(t,r,a){return U(this,t,r,true,a)};s.prototype.writeDoubleBE=function e(t,r,a){return U(this,t,r,false,a)};s.prototype.copy=function e(t,r,a,n){if(!s.isBuffer(t))throw new TypeError("argument should be a Buffer");if(!a)a=0;if(!n&&n!==0)n=this.length;if(r>=t.length)r=t.length;if(!r)r=0;if(n>0&&n<a)n=a;if(n===a)return 0;if(t.length===0||this.length===0)return 0;if(r<0){throw new RangeError("targetStart out of bounds")}if(a<0||a>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");if(n>this.length)n=this.length;if(t.length-r<n-a){n=t.length-r+a}var i=n-a;if(this===t&&typeof Uint8Array.prototype.copyWithin==="function"){this.copyWithin(r,a,n)}else if(this===t&&a<r&&r<n){for(var o=i-1;o>=0;--o){t[o+r]=this[o+a]}}else{Uint8Array.prototype.set.call(t,this.subarray(a,n),r)}return i};s.prototype.fill=function e(t,r,a,n){if(typeof t==="string"){if(typeof r==="string"){n=r;r=0;a=this.length}else if(typeof a==="string"){n=a;a=this.length}if(n!==undefined&&typeof n!=="string"){throw new TypeError("encoding must be a string")}if(typeof n==="string"&&!s.isEncoding(n)){throw new TypeError("Unknown encoding: "+n)}if(t.length===1){var i=t.charCodeAt(0);if(n==="utf8"&&i<128||n==="latin1"){t=i}}}else if(typeof t==="number"){t=t&255}if(r<0||this.length<r||this.length<a){throw new RangeError("Out of range index")}if(a<=r){return this}r=r>>>0;a=a===undefined?this.length:a>>>0;if(!t)t=0;var o;if(typeof t==="number"){for(o=r;o<a;++o){this[o]=t}}else{var l=s.isBuffer(t)?t:s.from(t,n);var u=l.length;if(u===0){throw new TypeError('The value "'+t+'" is invalid for argument "value"')}for(o=0;o<a-r;++o){this[o+r]=l[o%u]}}return this};var V=/[^+/0-9A-Za-z-_]/g;function H(e){e=e.split("=")[0];e=e.trim().replace(V,"");if(e.length<2)return"";while(e.length%4!==0){e=e+"="}return e}function q(e){if(e<16)return"0"+e.toString(16);return e.toString(16)}function G(e,t){t=t||Infinity;var r;var a=e.length;var n=null;var i=[];for(var o=0;o<a;++o){r=e.charCodeAt(o);if(r>55295&&r<57344){if(!n){if(r>56319){if((t-=3)>-1)i.push(239,191,189);continue}else if(o+1===a){if((t-=3)>-1)i.push(239,191,189);continue}n=r;continue}if(r<56320){if((t-=3)>-1)i.push(239,191,189);n=r;continue}r=(n-55296<<10|r-56320)+65536}else if(n){if((t-=3)>-1)i.push(239,191,189)}n=null;if(r<128){if((t-=1)<0)break;i.push(r)}else if(r<2048){if((t-=2)<0)break;i.push(r>>6|192,r&63|128)}else if(r<65536){if((t-=3)<0)break;i.push(r>>12|224,r>>6&63|128,r&63|128)}else if(r<1114112){if((t-=4)<0)break;i.push(r>>18|240,r>>12&63|128,r>>6&63|128,r&63|128)}else{throw new Error("Invalid code point")}}return i}function Y(e){var t=[];for(var r=0;r<e.length;++r){t.push(e.charCodeAt(r)&255)}return t}function W(e,t){var r,a,n;var i=[];for(var o=0;o<e.length;++o){if((t-=2)<0)break;r=e.charCodeAt(o);a=r>>8;n=r%256;i.push(n);i.push(a)}return i}function X(e){return t.toByteArray(H(e))}function Z(e,t,r,a){for(var n=0;n<a;++n){if(n+r>=t.length||n>=e.length)break;t[n+r]=e[n]}return n}function J(e,t){return e instanceof t||e!=null&&e.constructor!=null&&e.constructor.name!=null&&e.constructor.name===t.name}function K(e){return e!==e}}).call(this)}).call(this,e("buffer").Buffer)},{"base64-js":86,buffer:117,ieee754:437}],118:[function(e,t,r){"use strict";var a=e("./lib/monotone");var n=e("./lib/triangulation");var i=e("./lib/delaunay");var o=e("./lib/filter");t.exports=f;function s(e){return[Math.min(e[0],e[1]),Math.max(e[0],e[1])]}function l(e,t){return e[0]-t[0]||e[1]-t[1]}function u(e){return e.map(s).sort(l)}function c(e,t,r){if(t in e){return e[t]}return r}function f(e,t,r){if(!Array.isArray(t)){r=t||{};t=[]}else{r=r||{};t=t||[]}var s=!!c(r,"delaunay",true);var l=!!c(r,"interior",true);var f=!!c(r,"exterior",true);var h=!!c(r,"infinity",false);if(!l&&!f||e.length===0){return[]}var p=a(e,t);if(s||l!==f||h){var v=n(e.length,u(t));for(var d=0;d<p.length;++d){var m=p[d];v.addTriangle(m[0],m[1],m[2])}if(s){i(e,v)}if(!f){return o(v,-1)}else if(!l){return o(v,1,h)}else if(h){return o(v,0,h)}else{return v.cells()}}else{return p}}},{"./lib/delaunay":119,"./lib/filter":120,"./lib/monotone":121,"./lib/triangulation":122}],119:[function(e,t,r){"use strict";var a=e("robust-in-sphere")[4];var n=e("binary-search-bounds");t.exports=o;function i(e,t,r,n,i,o){var s=t.opposite(n,i);if(s<0){return}if(i<n){var l=n;n=i;i=l;l=o;o=s;s=l}if(t.isConstraint(n,i)){return}if(a(e[n],e[i],e[o],e[s])<0){r.push(n,i)}}function o(e,t){var r=[];var n=e.length;var o=t.stars;for(var s=0;s<n;++s){var l=o[s];for(var u=1;u<l.length;u+=2){var c=l[u];if(c<s){continue}if(t.isConstraint(s,c)){continue}var f=l[u-1],h=-1;for(var p=1;p<l.length;p+=2){if(l[p-1]===c){h=l[p];break}}if(h<0){continue}if(a(e[s],e[c],e[f],e[h])<0){r.push(s,c)}}}while(r.length>0){var c=r.pop();var s=r.pop();var f=-1,h=-1;var l=o[s];for(var v=1;v<l.length;v+=2){var d=l[v-1];var m=l[v];if(d===c){h=m}else if(m===c){f=d}}if(f<0||h<0){continue}if(a(e[s],e[c],e[f],e[h])>=0){continue}t.flip(s,c);i(e,t,r,f,s,h);i(e,t,r,s,h,f);i(e,t,r,h,c,f);i(e,t,r,c,f,h)}}},{"binary-search-bounds":103,"robust-in-sphere":532}],120:[function(e,t,r){"use strict";var a=e("binary-search-bounds");t.exports=u;function n(e,t,r,a,n,i,o){this.cells=e;this.neighbor=t;this.flags=a;this.constraint=r;this.active=n;this.next=i;this.boundary=o}var i=n.prototype;function o(e,t){return e[0]-t[0]||e[1]-t[1]||e[2]-t[2]}i.locate=function(){var e=[0,0,0];return function(t,r,n){var i=t,s=r,l=n;if(r<n){if(r<t){i=r;s=n;l=t}}else if(n<t){i=n;s=t;l=r}if(i<0){return-1}e[0]=i;e[1]=s;e[2]=l;return a.eq(this.cells,e,o)}}();function s(e,t){var r=e.cells();var a=r.length;for(var i=0;i<a;++i){var s=r[i];var l=s[0],u=s[1],c=s[2];if(u<c){if(u<l){s[0]=u;s[1]=c;s[2]=l}}else if(c<l){s[0]=c;s[1]=l;s[2]=u}}r.sort(o);var f=new Array(a);for(var i=0;i<f.length;++i){f[i]=0}var h=[];var p=[];var v=new Array(3*a);var d=new Array(3*a);var m=null;if(t){m=[]}var g=new n(r,v,d,f,h,p,m);for(var i=0;i<a;++i){var s=r[i];for(var y=0;y<3;++y){var l=s[y],u=s[(y+1)%3];var x=v[3*i+y]=g.locate(u,l,e.opposite(u,l));var b=d[3*i+y]=e.isConstraint(l,u);if(x<0){if(b){p.push(i)}else{h.push(i);f[i]=1}if(t){m.push([u,l,-1])}}}}return g}function l(e,t,r){var a=0;for(var n=0;n<e.length;++n){if(t[n]===r){e[a++]=e[n]}}e.length=a;return e}function u(e,t,r){var a=s(e,r);if(t===0){if(r){return a.cells.concat(a.boundary)}else{return a.cells}}var n=1;var i=a.active;var o=a.next;var u=a.flags;var c=a.cells;var f=a.constraint;var h=a.neighbor;while(i.length>0||o.length>0){while(i.length>0){var p=i.pop();if(u[p]===-n){continue}u[p]=n;var v=c[p];for(var d=0;d<3;++d){var m=h[3*p+d];if(m>=0&&u[m]===0){if(f[3*p+d]){o.push(m)}else{i.push(m);u[m]=n}}}}var g=o;o=i;i=g;o.length=0;n=-n}var y=l(c,u,t);if(r){return y.concat(a.boundary)}return y}},{"binary-search-bounds":103}],121:[function(e,t,r){"use strict";var a=e("binary-search-bounds");var n=e("robust-orientation")[3];var i=0;var o=1;var s=2;t.exports=m;function l(e,t,r,a,n){this.a=e;this.b=t;this.idx=r;this.lowerIds=a;this.upperIds=n}function u(e,t,r,a){this.a=e;this.b=t;this.type=r;this.idx=a}function c(e,t){var r=e.a[0]-t.a[0]||e.a[1]-t.a[1]||e.type-t.type;if(r){return r}if(e.type!==i){r=n(e.a,e.b,t.b);if(r){return r}}return e.idx-t.idx}function f(e,t){return n(e.a,e.b,t)}function h(e,t,r,i,o){var s=a.lt(t,i,f);var l=a.gt(t,i,f);for(var u=s;u<l;++u){var c=t[u];var h=c.lowerIds;var p=h.length;while(p>1&&n(r[h[p-2]],r[h[p-1]],i)>0){e.push([h[p-1],h[p-2],o]);p-=1}h.length=p;h.push(o);var v=c.upperIds;var p=v.length;while(p>1&&n(r[v[p-2]],r[v[p-1]],i)<0){e.push([v[p-2],v[p-1],o]);p-=1}v.length=p;v.push(o)}}function p(e,t){var r;if(e.a[0]<t.a[0]){r=n(e.a,e.b,t.a)}else{r=n(t.b,t.a,e.a)}if(r){return r}if(t.b[0]<e.b[0]){r=n(e.a,e.b,t.b)}else{r=n(t.b,t.a,e.b)}return r||e.idx-t.idx}function v(e,t,r){var n=a.le(e,r,p);var i=e[n];var o=i.upperIds;var s=o[o.length-1];i.upperIds=[s];e.splice(n+1,0,new l(r.a,r.b,r.idx,[s],o))}function d(e,t,r){var n=r.a;r.a=r.b;r.b=n;var i=a.eq(e,r,p);var o=e[i];var s=e[i-1];s.upperIds=o.upperIds;e.splice(i,1)}function m(e,t){var r=e.length;var a=t.length;var n=[];for(var f=0;f<r;++f){n.push(new u(e[f],null,i,f))}for(var f=0;f<a;++f){var p=t[f];var m=e[p[0]];var g=e[p[1]];if(m[0]<g[0]){n.push(new u(m,g,s,f),new u(g,m,o,f))}else if(m[0]>g[0]){n.push(new u(g,m,s,f),new u(m,g,o,f))}}n.sort(c);var y=n[0].a[0]-(1+Math.abs(n[0].a[0]))*Math.pow(2,-52);var x=[new l([y,1],[y,0],-1,[],[],[],[])];var b=[];for(var f=0,_=n.length;f<_;++f){var w=n[f];var T=w.type;if(T===i){h(b,x,e,w.a,w.idx)}else if(T===s){v(x,e,w)}else{d(x,e,w)}}return b}},{"binary-search-bounds":103,"robust-orientation":534}],122:[function(e,t,r){"use strict";var a=e("binary-search-bounds");t.exports=s;function n(e,t){this.stars=e;this.edges=t}var i=n.prototype;function o(e,t,r){for(var a=1,n=e.length;a<n;a+=2){if(e[a-1]===t&&e[a]===r){e[a-1]=e[n-2];e[a]=e[n-1];e.length=n-2;return}}}i.isConstraint=function(){var e=[0,0];function t(e,t){return e[0]-t[0]||e[1]-t[1]}return function(r,n){e[0]=Math.min(r,n);e[1]=Math.max(r,n);return a.eq(this.edges,e,t)>=0}}();i.removeTriangle=function(e,t,r){var a=this.stars;o(a[e],t,r);o(a[t],r,e);o(a[r],e,t)};i.addTriangle=function(e,t,r){var a=this.stars;a[e].push(t,r);a[t].push(r,e);a[r].push(e,t)};i.opposite=function(e,t){var r=this.stars[t];for(var a=1,n=r.length;a<n;a+=2){if(r[a]===e){return r[a-1]}}return-1};i.flip=function(e,t){var r=this.opposite(e,t);var a=this.opposite(t,e);this.removeTriangle(e,t,r);this.removeTriangle(t,e,a);this.addTriangle(e,a,r);this.addTriangle(t,r,a)};i.edges=function(){var e=this.stars;var t=[];for(var r=0,a=e.length;r<a;++r){var n=e[r];for(var i=0,o=n.length;i<o;i+=2){t.push([n[i],n[i+1]])}}return t};i.cells=function(){var e=this.stars;var t=[];for(var r=0,a=e.length;r<a;++r){var n=e[r];for(var i=0,o=n.length;i<o;i+=2){var s=n[i];var l=n[i+1];if(r<Math.min(s,l)){t.push([r,s,l])}}}return t};function s(e,t){var r=new Array(e);for(var a=0;a<e;++a){r[a]=[]}return new n(r,t)}},{"binary-search-bounds":103}],123:[function(e,t,r){"use strict";t.exports=a;function a(e){var t=1;for(var r=1;r<e.length;++r){for(var a=0;a<r;++a){if(e[r]<e[a]){t=-t}else if(e[a]===e[r]){return 0}}}return t}},{}],124:[function(e,t,r){"use strict";var a=e("dup");var n=e("robust-linear-solve");function i(e,t){var r=0;var a=e.length;for(var n=0;n<a;++n){r+=e[n]*t[n]}return r}function o(e){var t=e.length;if(t===0){return[]}var r=e[0].length;var o=a([e.length+1,e.length+1],1);var s=a([e.length+1],1);o[t][t]=0;for(var l=0;l<t;++l){for(var u=0;u<=l;++u){o[u][l]=o[l][u]=2*i(e[l],e[u])}s[l]=i(e[l],e[l])}var c=n(o,s);var f=0;var h=c[t+1];for(var l=0;l<h.length;++l){f+=h[l]}var p=new Array(t);for(var l=0;l<t;++l){var h=c[l];var v=0;for(var u=0;u<h.length;++u){v+=h[u]}p[l]=v/f}return p}function s(e){if(e.length===0){return[]}var t=e[0].length;var r=a([t]);var n=o(e);for(var i=0;i<e.length;++i){for(var s=0;s<t;++s){r[s]+=e[i][s]*n[i]}}return r}s.barycenetric=o;t.exports=s},{dup:182,"robust-linear-solve":533}],125:[function(e,t,r){t.exports=n;var a=e("circumcenter");function n(e){var t=a(e);var r=0;for(var n=0;n<e.length;++n){var i=e[n];for(var o=0;o<t.length;++o){r+=Math.pow(i[o]-t[o],2)}}return Math.sqrt(r/e.length)}},{circumcenter:124}],126:[function(e,t,r){t.exports=a;function a(e,t,r){return t<r?e<t?t:e>r?r:e:e<r?r:e>t?t:e}},{}],127:[function(e,t,r){"use strict";t.exports=k;var a=e("union-find");var n=e("box-intersect");var i=e("robust-segment-intersect");var o=e("big-rat");var s=e("big-rat/cmp");var l=e("big-rat/to-float");var u=e("rat-vec");var c=e("nextafter");var f=e("./lib/rat-seg-intersect");function h(e){var t=l(e);return[c(t,-Infinity),c(t,Infinity)]}function p(e,t){var r=new Array(t.length);for(var a=0;a<t.length;++a){var n=t[a];var i=e[n[0]];var o=e[n[1]];r[a]=[c(Math.min(i[0],o[0]),-Infinity),c(Math.min(i[1],o[1]),-Infinity),c(Math.max(i[0],o[0]),Infinity),c(Math.max(i[1],o[1]),Infinity)]}return r}function v(e){var t=new Array(e.length);for(var r=0;r<e.length;++r){var a=e[r];t[r]=[c(a[0],-Infinity),c(a[1],-Infinity),c(a[0],Infinity),c(a[1],Infinity)]}return t}function d(e,t,r){var a=[];n(r,(function(r,n){var o=t[r];var s=t[n];if(o[0]===s[0]||o[0]===s[1]||o[1]===s[0]||o[1]===s[1]){return}var l=e[o[0]];var u=e[o[1]];var c=e[s[0]];var f=e[s[1]];if(i(l,u,c,f)){a.push([r,n])}}));return a}function m(e,t,r,a){var o=[];n(r,a,(function(r,a){var n=t[r];if(n[0]===a||n[1]===a){return}var s=e[a];var l=e[n[0]];var u=e[n[1]];if(i(l,u,s,s)){o.push([r,a])}}));return o}function g(e,t,r,a,n){var i,c;var h=e.map((function(e){return[o(e[0]),o(e[1])]}));for(i=0;i<r.length;++i){var p=r[i];c=p[0];var v=p[1];var d=t[c];var m=t[v];var g=f(u(e[d[0]]),u(e[d[1]]),u(e[m[0]]),u(e[m[1]]));if(!g){continue}var y=e.length;e.push([l(g[0]),l(g[1])]);h.push(g);a.push([c,y],[v,y])}a.sort((function(e,t){if(e[0]!==t[0]){return e[0]-t[0]}var r=h[e[1]];var a=h[t[1]];return s(r[0],a[0])||s(r[1],a[1])}));for(i=a.length-1;i>=0;--i){var x=a[i];c=x[0];var b=t[c];var _=b[0];var w=b[1];var T=e[_];var k=e[w];if((T[0]-k[0]||T[1]-k[1])<0){var M=_;_=w;w=M}b[0]=_;var A=b[1]=x[1];var S;if(n){S=b[2]}while(i>0&&a[i-1][0]===c){var x=a[--i];var E=x[1];if(n){t.push([A,E,S])}else{t.push([A,E])}A=E}if(n){t.push([A,w,S])}else{t.push([A,w])}}return h}function y(e,t,r){var i=t.length;var o=new a(i);var s=[];for(var l=0;l<t.length;++l){var u=t[l];var f=h(u[0]);var p=h(u[1]);s.push([c(f[0],-Infinity),c(p[0],-Infinity),c(f[1],Infinity),c(p[1],Infinity)])}n(s,(function(e,t){o.link(e,t)}));var v=true;var d=new Array(i);for(var l=0;l<i;++l){var m=o.find(l);if(m!==l){v=false;e[m]=[Math.min(e[l][0],e[m][0]),Math.min(e[l][1],e[m][1])]}}if(v){return null}var g=0;for(var l=0;l<i;++l){var m=o.find(l);if(m===l){d[l]=g;e[g++]=e[l]}else{d[l]=-1}}e.length=g;for(var l=0;l<i;++l){if(d[l]<0){d[l]=d[o.find(l)]}}return d}function x(e,t){return e[0]-t[0]||e[1]-t[1]}function b(e,t){var r=e[0]-t[0]||e[1]-t[1];if(r){return r}if(e[2]<t[2]){return-1}else if(e[2]>t[2]){return 1}return 0}function _(e,t,r){if(e.length===0){return}if(t){for(var a=0;a<e.length;++a){var n=e[a];var i=t[n[0]];var o=t[n[1]];n[0]=Math.min(i,o);n[1]=Math.max(i,o)}}else{for(var a=0;a<e.length;++a){var n=e[a];var i=n[0];var o=n[1];n[0]=Math.min(i,o);n[1]=Math.max(i,o)}}if(r){e.sort(b)}else{e.sort(x)}var s=1;for(var a=1;a<e.length;++a){var l=e[a-1];var u=e[a];if(u[0]===l[0]&&u[1]===l[1]&&(!r||u[2]===l[2])){continue}e[s++]=u}e.length=s}function w(e,t,r){var a=y(e,[],v(e));_(t,a,r);return!!a}function T(e,t,r){var a=p(e,t);var n=d(e,t,a);var i=v(e);var o=m(e,t,a,i);var s=g(e,t,n,o,r);var l=y(e,s,i);_(t,l,r);if(!l){return n.length>0||o.length>0}return true}function k(e,t,r){var a;if(r){a=t;var n=new Array(t.length);for(var i=0;i<t.length;++i){var o=t[i];n[i]=[o[0],o[1],r[i]]}t=n}var s=w(e,t,!!r);while(T(e,t,!!r)){s=true}if(!!r&&s){a.length=0;r.length=0;for(var i=0;i<t.length;++i){var o=t[i];a.push([o[0],o[1]]);r.push(o[2])}}return s}},{"./lib/rat-seg-intersect":128,"big-rat":90,"big-rat/cmp":88,"big-rat/to-float":102,"box-intersect":108,nextafter:473,"rat-vec":518,"robust-segment-intersect":537,"union-find":602}],128:[function(e,t,r){"use strict";t.exports=f;var a=e("big-rat/mul");var n=e("big-rat/div");var i=e("big-rat/sub");var o=e("big-rat/sign");var s=e("rat-vec/sub");var l=e("rat-vec/add");var u=e("rat-vec/muls");function c(e,t){return i(a(e[0],t[1]),a(e[1],t[0]))}function f(e,t,r,a){var i=s(t,e);var f=s(a,r);var h=c(i,f);if(o(h)===0){return null}var p=s(e,r);var v=c(f,p);var d=n(v,h);var m=u(i,d);var g=l(e,m);return g}},{"big-rat/div":89,"big-rat/mul":99,"big-rat/sign":100,"big-rat/sub":101,"rat-vec/add":517,"rat-vec/muls":519,"rat-vec/sub":520}],129:[function(e,t,r){"use strict";var a=e("clamp");t.exports=n;t.exports.to=n;t.exports.from=i;function n(e,t){if(t==null)t=true;var r=e[0],n=e[1],i=e[2],o=e[3];if(o==null)o=t?1:255;if(t){r*=255;n*=255;i*=255;o*=255}r=a(r,0,255)&255;n=a(n,0,255)&255;i=a(i,0,255)&255;o=a(o,0,255)&255;var s=r*16777216+(n<<16)+(i<<8)+o;return s}function i(e,t){e=+e;var r=e>>>24;var a=(e&16711680)>>>16;var n=(e&65280)>>>8;var i=e&255;if(t===false)return[r,a,n,i];return[r/255,a/255,n/255,i/255]}},{clamp:126}],130:[function(e,t,r){"use strict";t.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},{}],131:[function(e,t,r){"use strict";var a=e("color-rgba");var n=e("clamp");var i=e("dtype");t.exports=function e(t,r){if(r==="float"||!r)r="array";if(r==="uint")r="uint8";if(r==="uint_clamped")r="uint8_clamped";var s=i(r);var l=new s(4);var e=r!=="uint8"&&r!=="uint8_clamped";if(!t.length||typeof t==="string"){t=a(t);t[0]/=255;t[1]/=255;t[2]/=255}if(o(t)){l[0]=t[0];l[1]=t[1];l[2]=t[2];l[3]=t[3]!=null?t[3]:255;if(e){l[0]/=255;l[1]/=255;l[2]/=255;l[3]/=255}return l}if(!e){l[0]=n(Math.floor(t[0]*255),0,255);l[1]=n(Math.floor(t[1]*255),0,255);l[2]=n(Math.floor(t[2]*255),0,255);l[3]=t[3]==null?255:n(Math.floor(t[3]*255),0,255)}else{l[0]=t[0];l[1]=t[1];l[2]=t[2];l[3]=t[3]!=null?t[3]:1}return l};function o(e){if(e instanceof Uint8Array||e instanceof Uint8ClampedArray)return true;if(Array.isArray(e)&&(e[0]>1||e[0]===0)&&(e[1]>1||e[1]===0)&&(e[2]>1||e[2]===0)&&(!e[3]||e[3]>1))return true;return false}},{clamp:126,"color-rgba":133,dtype:181}],132:[function(e,r,a){(function(t){(function(){"use strict";var a=e("color-name");var n=e("is-plain-obj");var i=e("defined");r.exports=s;var o={red:0,orange:60,yellow:120,green:180,blue:240,purple:300};function s(e){var r,s=[],l=1,u;if(typeof e==="string"){if(a[e]){s=a[e].slice();u="rgb"}else if(e==="transparent"){l=0;u="rgb";s=[0,0,0]}else if(/^#[A-Fa-f0-9]+$/.test(e)){var c=e.slice(1);var f=c.length;var h=f<=4;l=1;if(h){s=[parseInt(c[0]+c[0],16),parseInt(c[1]+c[1],16),parseInt(c[2]+c[2],16)];if(f===4){l=parseInt(c[3]+c[3],16)/255}}else{s=[parseInt(c[0]+c[1],16),parseInt(c[2]+c[3],16),parseInt(c[4]+c[5],16)];if(f===8){l=parseInt(c[6]+c[7],16)/255}}if(!s[0])s[0]=0;if(!s[1])s[1]=0;if(!s[2])s[2]=0;u="rgb"}else if(r=/^((?:rgb|hs[lvb]|hwb|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms)a?)\s*\(([^\)]*)\)/.exec(e)){var p=r[1];var v=p==="rgb";var c=p.replace(/a$/,"");u=c;var f=c==="cmyk"?4:c==="gray"?1:3;s=r[2].trim().split(/\s*,\s*/).map((function(e,t){if(/%$/.test(e)){if(t===f)return parseFloat(e)/100;if(c==="rgb")return parseFloat(e)*255/100;return parseFloat(e)}else if(c[t]==="h"){if(/deg$/.test(e)){return parseFloat(e)}else if(o[e]!==undefined){return o[e]}}return parseFloat(e)}));if(p===c)s.push(1);l=v?1:s[f]===undefined?1:s[f];s=s.slice(0,f)}else if(e.length>10&&/[0-9](?:\s|\/)/.test(e)){s=e.match(/([0-9]+)/g).map((function(e){return parseFloat(e)}));u=e.match(/([a-z])/gi).join("").toLowerCase()}}else if(!isNaN(e)){u="rgb";s=[e>>>16,(e&65280)>>>8,e&255]}else if(n(e)){var d=i(e.r,e.red,e.R,null);if(d!==null){u="rgb";s=[d,i(e.g,e.green,e.G),i(e.b,e.blue,e.B)]}else{u="hsl";s=[i(e.h,e.hue,e.H),i(e.s,e.saturation,e.S),i(e.l,e.lightness,e.L,e.b,e.brightness)]}l=i(e.a,e.alpha,e.opacity,1);if(e.opacity!=null)l/=100}else if(Array.isArray(e)||t.ArrayBuffer&&ArrayBuffer.isView&&ArrayBuffer.isView(e)){s=[e[0],e[1],e[2]];u="rgb";l=e.length===4?e[3]:1}return{space:u,values:s,alpha:l}}}).call(this)}).call(this,typeof t!=="undefined"?t:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"color-name":130,defined:176,"is-plain-obj":447}],133:[function(e,t,r){"use strict";var a=e("color-parse");var n=e("color-space/hsl");var i=e("clamp");t.exports=function e(t){var r,o,s;var l=a(t);if(!l.space)return[];r=Array(3);r[0]=i(l.values[0],0,255);r[1]=i(l.values[1],0,255);r[2]=i(l.values[2],0,255);if(l.space[0]==="h"){r=n.rgb(r)}r.push(i(l.alpha,0,1));return r}},{clamp:126,"color-parse":132,"color-space/hsl":134}],134:[function(e,t,r){"use strict";var a=e("./rgb");t.exports={name:"hsl",min:[0,0,0],max:[360,100,100],channel:["hue","saturation","lightness"],alias:["HSL"],rgb:function(e){var t=e[0]/360,r=e[1]/100,a=e[2]/100,n,i,o,s,l;if(r===0){l=a*255;return[l,l,l]}if(a<.5){i=a*(1+r)}else{i=a+r-a*r}n=2*a-i;s=[0,0,0];for(var u=0;u<3;u++){o=t+1/3*-(u-1);if(o<0){o++}else if(o>1){o--}if(6*o<1){l=n+(i-n)*6*o}else if(2*o<1){l=i}else if(3*o<2){l=n+(i-n)*(2/3-o)*6}else{l=n}s[u]=l*255}return s}};a.hsl=function(e){var t=e[0]/255,r=e[1]/255,a=e[2]/255,n=Math.min(t,r,a),i=Math.max(t,r,a),o=i-n,s,l,u;if(i===n){s=0}else if(t===i){s=(r-a)/o}else if(r===i){s=2+(a-t)/o}else if(a===i){s=4+(t-r)/o}s=Math.min(s*60,360);if(s<0){s+=360}u=(n+i)/2;if(i===n){l=0}else if(u<=.5){l=o/(i+n)}else{l=o/(2-i-n)}return[s,l*100,u*100]}},{"./rgb":135}],135:[function(e,t,r){"use strict";t.exports={name:"rgb",min:[0,0,0],max:[255,255,255],channel:["red","green","blue"],alias:["RGB"]}},{}],136:[function(e,t,r){t.exports={jet:[{index:0,rgb:[0,0,131]},{index:.125,rgb:[0,60,170]},{index:.375,rgb:[5,255,255]},{index:.625,rgb:[255,255,0]},{index:.875,rgb:[250,0,0]},{index:1,rgb:[128,0,0]}],hsv:[{index:0,rgb:[255,0,0]},{index:.169,rgb:[253,255,2]},{index:.173,rgb:[247,255,2]},{index:.337,rgb:[0,252,4]},{index:.341,rgb:[0,252,10]},{index:.506,rgb:[1,249,255]},{index:.671,rgb:[2,0,253]},{index:.675,rgb:[8,0,253]},{index:.839,rgb:[255,0,251]},{index:.843,rgb:[255,0,245]},{index:1,rgb:[255,0,6]}],hot:[{index:0,rgb:[0,0,0]},{index:.3,rgb:[230,0,0]},{index:.6,rgb:[255,210,0]},{index:1,rgb:[255,255,255]}],spring:[{index:0,rgb:[255,0,255]},{index:1,rgb:[255,255,0]}],summer:[{index:0,rgb:[0,128,102]},{index:1,rgb:[255,255,102]}],autumn:[{index:0,rgb:[255,0,0]},{index:1,rgb:[255,255,0]}],winter:[{index:0,rgb:[0,0,255]},{index:1,rgb:[0,255,128]}],bone:[{index:0,rgb:[0,0,0]},{index:.376,rgb:[84,84,116]},{index:.753,rgb:[169,200,200]},{index:1,rgb:[255,255,255]}],copper:[{index:0,rgb:[0,0,0]},{index:.804,rgb:[255,160,102]},{index:1,rgb:[255,199,127]}],greys:[{index:0,rgb:[0,0,0]},{index:1,rgb:[255,255,255]}],yignbu:[{index:0,rgb:[8,29,88]},{index:.125,rgb:[37,52,148]},{index:.25,rgb:[34,94,168]},{index:.375,rgb:[29,145,192]},{index:.5,rgb:[65,182,196]},{index:.625,rgb:[127,205,187]},{index:.75,rgb:[199,233,180]},{index:.875,rgb:[237,248,217]},{index:1,rgb:[255,255,217]}],greens:[{index:0,rgb:[0,68,27]},{index:.125,rgb:[0,109,44]},{index:.25,rgb:[35,139,69]},{index:.375,rgb:[65,171,93]},{index:.5,rgb:[116,196,118]},{index:.625,rgb:[161,217,155]},{index:.75,rgb:[199,233,192]},{index:.875,rgb:[229,245,224]},{index:1,rgb:[247,252,245]}],yiorrd:[{index:0,rgb:[128,0,38]},{index:.125,rgb:[189,0,38]},{index:.25,rgb:[227,26,28]},{index:.375,rgb:[252,78,42]},{index:.5,rgb:[253,141,60]},{index:.625,rgb:[254,178,76]},{index:.75,rgb:[254,217,118]},{index:.875,rgb:[255,237,160]},{index:1,rgb:[255,255,204]}],bluered:[{index:0,rgb:[0,0,255]},{index:1,rgb:[255,0,0]}],rdbu:[{index:0,rgb:[5,10,172]},{index:.35,rgb:[106,137,247]},{index:.5,rgb:[190,190,190]},{index:.6,rgb:[220,170,132]},{index:.7,rgb:[230,145,90]},{index:1,rgb:[178,10,28]}],picnic:[{index:0,rgb:[0,0,255]},{index:.1,rgb:[51,153,255]},{index:.2,rgb:[102,204,255]},{index:.3,rgb:[153,204,255]},{index:.4,rgb:[204,204,255]},{index:.5,rgb:[255,255,255]},{index:.6,rgb:[255,204,255]},{index:.7,rgb:[255,153,255]},{index:.8,rgb:[255,102,204]},{index:.9,rgb:[255,102,102]},{index:1,rgb:[255,0,0]}],rainbow:[{index:0,rgb:[150,0,90]},{index:.125,rgb:[0,0,200]},{index:.25,rgb:[0,25,255]},{index:.375,rgb:[0,152,255]},{index:.5,rgb:[44,255,150]},{index:.625,rgb:[151,255,0]},{index:.75,rgb:[255,234,0]},{index:.875,rgb:[255,111,0]},{index:1,rgb:[255,0,0]}],portland:[{index:0,rgb:[12,51,131]},{index:.25,rgb:[10,136,186]},{index:.5,rgb:[242,211,56]},{index:.75,rgb:[242,143,56]},{index:1,rgb:[217,30,30]}],blackbody:[{index:0,rgb:[0,0,0]},{index:.2,rgb:[230,0,0]},{index:.4,rgb:[230,210,0]},{index:.7,rgb:[255,255,255]},{index:1,rgb:[160,200,255]}],earth:[{index:0,rgb:[0,0,130]},{index:.1,rgb:[0,180,180]},{index:.2,rgb:[40,210,40]},{index:.4,rgb:[230,230,50]},{index:.6,rgb:[120,70,20]},{index:1,rgb:[255,255,255]}],electric:[{index:0,rgb:[0,0,0]},{index:.15,rgb:[30,0,100]},{index:.4,rgb:[120,0,100]},{index:.6,rgb:[160,90,0]},{index:.8,rgb:[230,200,0]},{index:1,rgb:[255,250,220]}],alpha:[{index:0,rgb:[255,255,255,0]},{index:1,rgb:[255,255,255,1]}],viridis:[{index:0,rgb:[68,1,84]},{index:.13,rgb:[71,44,122]},{index:.25,rgb:[59,81,139]},{index:.38,rgb:[44,113,142]},{index:.5,rgb:[33,144,141]},{index:.63,rgb:[39,173,129]},{index:.75,rgb:[92,200,99]},{index:.88,rgb:[170,220,50]},{index:1,rgb:[253,231,37]}],inferno:[{index:0,rgb:[0,0,4]},{index:.13,rgb:[31,12,72]},{index:.25,rgb:[85,15,109]},{index:.38,rgb:[136,34,106]},{index:.5,rgb:[186,54,85]},{index:.63,rgb:[227,89,51]},{index:.75,rgb:[249,140,10]},{index:.88,rgb:[249,201,50]},{index:1,rgb:[252,255,164]}],magma:[{index:0,rgb:[0,0,4]},{index:.13,rgb:[28,16,68]},{index:.25,rgb:[79,18,123]},{index:.38,rgb:[129,37,129]},{index:.5,rgb:[181,54,122]},{index:.63,rgb:[229,80,100]},{index:.75,rgb:[251,135,97]},{index:.88,rgb:[254,194,135]},{index:1,rgb:[252,253,191]}],plasma:[{index:0,rgb:[13,8,135]},{index:.13,rgb:[75,3,161]},{index:.25,rgb:[125,3,168]},{index:.38,rgb:[168,34,150]},{index:.5,rgb:[203,70,121]},{index:.63,rgb:[229,107,93]},{index:.75,rgb:[248,148,65]},{index:.88,rgb:[253,195,40]},{index:1,rgb:[240,249,33]}],warm:[{index:0,rgb:[125,0,179]},{index:.13,rgb:[172,0,187]},{index:.25,rgb:[219,0,170]},{index:.38,rgb:[255,0,130]},{index:.5,rgb:[255,63,74]},{index:.63,rgb:[255,123,0]},{index:.75,rgb:[234,176,0]},{index:.88,rgb:[190,228,0]},{index:1,rgb:[147,255,0]}],cool:[{index:0,rgb:[125,0,179]},{index:.13,rgb:[116,0,218]},{index:.25,rgb:[98,74,237]},{index:.38,rgb:[68,146,231]},{index:.5,rgb:[0,204,197]},{index:.63,rgb:[0,247,146]},{index:.75,rgb:[0,255,88]},{index:.88,rgb:[40,255,8]},{index:1,rgb:[147,255,0]}],"rainbow-soft":[{index:0,rgb:[125,0,179]},{index:.1,rgb:[199,0,180]},{index:.2,rgb:[255,0,121]},{index:.3,rgb:[255,108,0]},{index:.4,rgb:[222,194,0]},{index:.5,rgb:[150,255,0]},{index:.6,rgb:[0,255,55]},{index:.7,rgb:[0,246,150]},{index:.8,rgb:[50,167,222]},{index:.9,rgb:[103,51,235]},{index:1,rgb:[124,0,186]}],bathymetry:[{index:0,rgb:[40,26,44]},{index:.13,rgb:[59,49,90]},{index:.25,rgb:[64,76,139]},{index:.38,rgb:[63,110,151]},{index:.5,rgb:[72,142,158]},{index:.63,rgb:[85,174,163]},{index:.75,rgb:[120,206,163]},{index:.88,rgb:[187,230,172]},{index:1,rgb:[253,254,204]}],cdom:[{index:0,rgb:[47,15,62]},{index:.13,rgb:[87,23,86]},{index:.25,rgb:[130,28,99]},{index:.38,rgb:[171,41,96]},{index:.5,rgb:[206,67,86]},{index:.63,rgb:[230,106,84]},{index:.75,rgb:[242,149,103]},{index:.88,rgb:[249,193,135]},{index:1,rgb:[254,237,176]}],chlorophyll:[{index:0,rgb:[18,36,20]},{index:.13,rgb:[25,63,41]},{index:.25,rgb:[24,91,59]},{index:.38,rgb:[13,119,72]},{index:.5,rgb:[18,148,80]},{index:.63,rgb:[80,173,89]},{index:.75,rgb:[132,196,122]},{index:.88,rgb:[175,221,162]},{index:1,rgb:[215,249,208]}],density:[{index:0,rgb:[54,14,36]},{index:.13,rgb:[89,23,80]},{index:.25,rgb:[110,45,132]},{index:.38,rgb:[120,77,178]},{index:.5,rgb:[120,113,213]},{index:.63,rgb:[115,151,228]},{index:.75,rgb:[134,185,227]},{index:.88,rgb:[177,214,227]},{index:1,rgb:[230,241,241]}],"freesurface-blue":[{index:0,rgb:[30,4,110]},{index:.13,rgb:[47,14,176]},{index:.25,rgb:[41,45,236]},{index:.38,rgb:[25,99,212]},{index:.5,rgb:[68,131,200]},{index:.63,rgb:[114,156,197]},{index:.75,rgb:[157,181,203]},{index:.88,rgb:[200,208,216]},{index:1,rgb:[241,237,236]}],"freesurface-red":[{index:0,rgb:[60,9,18]},{index:.13,rgb:[100,17,27]},{index:.25,rgb:[142,20,29]},{index:.38,rgb:[177,43,27]},{index:.5,rgb:[192,87,63]},{index:.63,rgb:[205,125,105]},{index:.75,rgb:[216,162,148]},{index:.88,rgb:[227,199,193]},{index:1,rgb:[241,237,236]}],oxygen:[{index:0,rgb:[64,5,5]},{index:.13,rgb:[106,6,15]},{index:.25,rgb:[144,26,7]},{index:.38,rgb:[168,64,3]},{index:.5,rgb:[188,100,4]},{index:.63,rgb:[206,136,11]},{index:.75,rgb:[220,174,25]},{index:.88,rgb:[231,215,44]},{index:1,rgb:[248,254,105]}],par:[{index:0,rgb:[51,20,24]},{index:.13,rgb:[90,32,35]},{index:.25,rgb:[129,44,34]},{index:.38,rgb:[159,68,25]},{index:.5,rgb:[182,99,19]},{index:.63,rgb:[199,134,22]},{index:.75,rgb:[212,171,35]},{index:.88,rgb:[221,210,54]},{index:1,rgb:[225,253,75]}],phase:[{index:0,rgb:[145,105,18]},{index:.13,rgb:[184,71,38]},{index:.25,rgb:[186,58,115]},{index:.38,rgb:[160,71,185]},{index:.5,rgb:[110,97,218]},{index:.63,rgb:[50,123,164]},{index:.75,rgb:[31,131,110]},{index:.88,rgb:[77,129,34]},{index:1,rgb:[145,105,18]}],salinity:[{index:0,rgb:[42,24,108]},{index:.13,rgb:[33,50,162]},{index:.25,rgb:[15,90,145]},{index:.38,rgb:[40,118,137]},{index:.5,rgb:[59,146,135]},{index:.63,rgb:[79,175,126]},{index:.75,rgb:[120,203,104]},{index:.88,rgb:[193,221,100]},{index:1,rgb:[253,239,154]}],temperature:[{index:0,rgb:[4,35,51]},{index:.13,rgb:[23,51,122]},{index:.25,rgb:[85,59,157]},{index:.38,rgb:[129,79,143]},{index:.5,rgb:[175,95,130]},{index:.63,rgb:[222,112,101]},{index:.75,rgb:[249,146,66]},{index:.88,rgb:[249,196,65]},{index:1,rgb:[232,250,91]}],turbidity:[{index:0,rgb:[34,31,27]},{index:.13,rgb:[65,50,41]},{index:.25,rgb:[98,69,52]},{index:.38,rgb:[131,89,57]},{index:.5,rgb:[161,112,59]},{index:.63,rgb:[185,140,66]},{index:.75,rgb:[202,174,88]},{index:.88,rgb:[216,209,126]},{index:1,rgb:[233,246,171]}],"velocity-blue":[{index:0,rgb:[17,32,64]},{index:.13,rgb:[35,52,116]},{index:.25,rgb:[29,81,156]},{index:.38,rgb:[31,113,162]},{index:.5,rgb:[50,144,169]},{index:.63,rgb:[87,173,176]},{index:.75,rgb:[149,196,189]},{index:.88,rgb:[203,221,211]},{index:1,rgb:[254,251,230]}],"velocity-green":[{index:0,rgb:[23,35,19]},{index:.13,rgb:[24,64,38]},{index:.25,rgb:[11,95,45]},{index:.38,rgb:[39,123,35]},{index:.5,rgb:[95,146,12]},{index:.63,rgb:[152,165,18]},{index:.75,rgb:[201,186,69]},{index:.88,rgb:[233,216,137]},{index:1,rgb:[255,253,205]}],cubehelix:[{index:0,rgb:[0,0,0]},{index:.07,rgb:[22,5,59]},{index:.13,rgb:[60,4,105]},{index:.2,rgb:[109,1,135]},{index:.27,rgb:[161,0,147]},{index:.33,rgb:[210,2,142]},{index:.4,rgb:[251,11,123]},{index:.47,rgb:[255,29,97]},{index:.53,rgb:[255,54,69]},{index:.6,rgb:[255,85,46]},{index:.67,rgb:[255,120,34]},{index:.73,rgb:[255,157,37]},{index:.8,rgb:[241,191,57]},{index:.87,rgb:[224,220,93]},{index:.93,rgb:[218,241,142]},{index:1,rgb:[227,253,198]}]}},{}],137:[function(e,t,r){"use strict";var a=e("./colorScale");var n=e("lerp");t.exports=i;function i(e){var t,r,i,u,c,f,h,p,v,d,m;if(!e)e={};p=(e.nshades||72)-1;h=e.format||"hex";f=e.colormap;if(!f)f="jet";if(typeof f==="string"){f=f.toLowerCase();if(!a[f]){throw Error(f+" not a supported colorscale")}c=a[f]}else if(Array.isArray(f)){c=f.slice()}else{throw Error("unsupported colormap option",f)}if(c.length>p+1){throw new Error(f+" map requires nshades to be at least size "+c.length)}if(!Array.isArray(e.alpha)){if(typeof e.alpha==="number"){d=[e.alpha,e.alpha]}else{d=[1,1]}}else if(e.alpha.length!==2){d=[1,1]}else{d=e.alpha.slice()}t=c.map((function(e){return Math.round(e.index*p)}));d[0]=Math.min(Math.max(d[0],0),1);d[1]=Math.min(Math.max(d[1],0),1);var g=c.map((function(e,t){var r=c[t].index;var a=c[t].rgb.slice();if(a.length===4&&a[3]>=0&&a[3]<=1){return a}a[3]=d[0]+(d[1]-d[0])*r;return a}));var v=[];for(m=0;m<t.length-1;++m){u=t[m+1]-t[m];r=g[m];i=g[m+1];for(var y=0;y<u;y++){var x=y/u;v.push([Math.round(n(r[0],i[0],x)),Math.round(n(r[1],i[1],x)),Math.round(n(r[2],i[2],x)),n(r[3],i[3],x)])}}v.push(c[c.length-1].rgb.concat(d[1]));if(h==="hex")v=v.map(s);else if(h==="rgbaString")v=v.map(l);else if(h==="float")v=v.map(o);return v}function o(e){return[e[0]/255,e[1]/255,e[2]/255,e[3]]}function s(e){var t,r="#";for(var a=0;a<3;++a){t=e[a];t=t.toString(16);r+=("00"+t).substr(t.length)}return r}function l(e){return"rgba("+e.join(",")+")"}},{"./colorScale":136,lerp:450}],138:[function(e,t,r){"use strict";t.exports=u;var a=e("robust-orientation");var n=e("signum");var i=e("two-sum");var o=e("robust-product");var s=e("robust-sum");function l(e,t,r){var a=i(e[0],-t[0]);var n=i(e[1],-t[1]);var l=i(r[0],-t[0]);var u=i(r[1],-t[1]);var c=s(o(a,l),o(n,u));return c[c.length-1]>=0}function u(e,t,r,i){var o=a(t,r,i);if(o===0){var s=n(a(e,t,r));var u=n(a(e,t,i));if(s===u){if(s===0){var c=l(e,t,r);var f=l(e,t,i);if(c===f){return 0}else if(c){return 1}else{return-1}}return 0}else if(u===0){if(s>0){return-1}else if(l(e,t,i)){return-1}else{return 1}}else if(s===0){if(u>0){return 1}else if(l(e,t,r)){return 1}else{return-1}}return n(u-s)}var h=a(e,t,r);if(h>0){if(o>0&&a(e,t,i)>0){return 1}return-1}else if(h<0){if(o>0||a(e,t,i)>0){return 1}return-1}else{var p=a(e,t,i);if(p>0){return 1}else{if(l(e,t,r)){return 1}else{return-1}}}}},{"robust-orientation":534,"robust-product":535,"robust-sum":539,signum:541,"two-sum":589}],139:[function(e,t,r){t.exports=i;var a=Math.min;function n(e,t){return e-t}function i(e,t){var r=e.length,i=e.length-t.length;if(i){return i}switch(r){case 0:return 0;case 1:return e[0]-t[0];case 2:return e[0]+e[1]-t[0]-t[1]||a(e[0],e[1])-a(t[0],t[1]);case 3:var o=e[0]+e[1],s=t[0]+t[1];i=o+e[2]-(s+t[2]);if(i){return i}var l=a(e[0],e[1]),u=a(t[0],t[1]);return a(l,e[2])-a(u,t[2])||a(l+e[2],o)-a(u+t[2],s);case 4:var c=e[0],f=e[1],h=e[2],p=e[3],v=t[0],d=t[1],m=t[2],g=t[3];return c+f+h+p-(v+d+m+g)||a(c,f,h,p)-a(v,d,m,g,v)||a(c+f,c+h,c+p,f+h,f+p,h+p)-a(v+d,v+m,v+g,d+m,d+g,m+g)||a(c+f+h,c+f+p,c+h+p,f+h+p)-a(v+d+m,v+d+g,v+m+g,d+m+g);default:var y=e.slice().sort(n);var x=t.slice().sort(n);for(var b=0;b<r;++b){i=y[b]-x[b];if(i){return i}}return 0}}},{}],140:[function(e,t,r){"use strict";var a=e("compare-cell");var n=e("cell-orientation");t.exports=i;function i(e,t){return a(e,t)||n(e)-n(t)}},{"cell-orientation":123,"compare-cell":139}],141:[function(e,t,r){"use strict";var a=e("./lib/ch1d");var n=e("./lib/ch2d");var i=e("./lib/chnd");t.exports=o;function o(e){var t=e.length;if(t===0){return[]}else if(t===1){return[[0]]}var r=e[0].length;if(r===0){return[]}else if(r===1){return a(e)}else if(r===2){return n(e)}return i(e,r)}},{"./lib/ch1d":142,"./lib/ch2d":143,"./lib/chnd":144}],142:[function(e,t,r){"use strict";t.exports=a;function a(e){var t=0;var r=0;for(var a=1;a<e.length;++a){if(e[a][0]<e[t][0]){t=a}if(e[a][0]>e[r][0]){r=a}}if(t<r){return[[t],[r]]}else if(t>r){return[[r],[t]]}else{return[[t]]}}},{}],143:[function(e,t,r){"use strict";t.exports=n;var a=e("monotone-convex-hull-2d");function n(e){var t=a(e);var r=t.length;if(r<=2){return[]}var n=new Array(r);var i=t[r-1];for(var o=0;o<r;++o){var s=t[o];n[o]=[i,s];i=s}return n}},{"monotone-convex-hull-2d":458}],144:[function(e,t,r){"use strict";t.exports=s;var a=e("incremental-convex-hull");var n=e("affine-hull");function i(e,t){var r=e.length;var a=new Array(r);for(var n=0;n<t.length;++n){a[n]=e[t[n]]}var i=t.length;for(var n=0;n<r;++n){if(t.indexOf(n)<0){a[i++]=e[n]}}return a}function o(e,t){var r=e.length;var a=t.length;for(var n=0;n<r;++n){var i=e[n];for(var o=0;o<i.length;++o){var s=i[o];if(s<a){i[o]=t[s]}else{s=s-a;for(var l=0;l<a;++l){if(s>=t[l]){s+=1}}i[o]=s}}}return e}function s(e,t){try{return a(e,true)}catch(u){var r=n(e);if(r.length<=t){return[]}var s=i(e,r);var l=a(s,true);return o(l,r)}}},{"affine-hull":73,"incremental-convex-hull":438}],145:[function(e,t,r){t.exports={AFG:"afghan",ALA:"\\b\\wland",ALB:"albania",DZA:"algeria",ASM:"^(?=.*americ).*samoa",AND:"andorra",AGO:"angola",AIA:"anguill?a",ATA:"antarctica",ATG:"antigua",ARG:"argentin",ARM:"armenia",ABW:"^(?!.*bonaire).*\\baruba",AUS:"australia",AUT:"^(?!.*hungary).*austria|\\baustri.*\\bemp",AZE:"azerbaijan",BHS:"bahamas",BHR:"bahrain",BGD:"bangladesh|^(?=.*east).*paki?stan",BRB:"barbados",BLR:"belarus|byelo",BEL:"^(?!.*luxem).*belgium",BLZ:"belize|^(?=.*british).*honduras",BEN:"benin|dahome",BMU:"bermuda",BTN:"bhutan",BOL:"bolivia",BES:"^(?=.*bonaire).*eustatius|^(?=.*carib).*netherlands|\\bbes.?islands",BIH:"herzegovina|bosnia",BWA:"botswana|bechuana",BVT:"bouvet",BRA:"brazil",IOT:"british.?indian.?ocean",BRN:"brunei",BGR:"bulgaria",BFA:"burkina|\\bfaso|upper.?volta",BDI:"burundi",CPV:"verde",KHM:"cambodia|kampuchea|khmer",CMR:"cameroon",CAN:"canada",CYM:"cayman",CAF:"\\bcentral.african.republic",TCD:"\\bchad",CHL:"\\bchile",CHN:"^(?!.*\\bmac)(?!.*\\bhong)(?!.*\\btai)(?!.*\\brep).*china|^(?=.*peo)(?=.*rep).*china",CXR:"christmas",CCK:"\\bcocos|keeling",COL:"colombia",COM:"comoro",COG:"^(?!.*\\bdem)(?!.*\\bd[\\.]?r)(?!.*kinshasa)(?!.*zaire)(?!.*belg)(?!.*l.opoldville)(?!.*free).*\\bcongo",COK:"\\bcook",CRI:"costa.?rica",CIV:"ivoire|ivory",HRV:"croatia",CUB:"\\bcuba",CUW:"^(?!.*bonaire).*\\bcura(c|ç)ao",CYP:"cyprus",CSK:"czechoslovakia",CZE:"^(?=.*rep).*czech|czechia|bohemia",COD:"\\bdem.*congo|congo.*\\bdem|congo.*\\bd[\\.]?r|\\bd[\\.]?r.*congo|belgian.?congo|congo.?free.?state|kinshasa|zaire|l.opoldville|drc|droc|rdc",DNK:"denmark",DJI:"djibouti",DMA:"dominica(?!n)",DOM:"dominican.rep",ECU:"ecuador",EGY:"egypt",SLV:"el.?salvador",GNQ:"guine.*eq|eq.*guine|^(?=.*span).*guinea",ERI:"eritrea",EST:"estonia",ETH:"ethiopia|abyssinia",FLK:"falkland|malvinas",FRO:"faroe|faeroe",FJI:"fiji",FIN:"finland",FRA:"^(?!.*\\bdep)(?!.*martinique).*france|french.?republic|\\bgaul",GUF:"^(?=.*french).*guiana",PYF:"french.?polynesia|tahiti",ATF:"french.?southern",GAB:"gabon",GMB:"gambia",GEO:"^(?!.*south).*georgia",DDR:"german.?democratic.?republic|democratic.?republic.*germany|east.germany",DEU:"^(?!.*east).*germany|^(?=.*\\bfed.*\\brep).*german",GHA:"ghana|gold.?coast",GIB:"gibraltar",GRC:"greece|hellenic|hellas",GRL:"greenland",GRD:"grenada",GLP:"guadeloupe",GUM:"\\bguam",GTM:"guatemala",GGY:"guernsey",GIN:"^(?!.*eq)(?!.*span)(?!.*bissau)(?!.*portu)(?!.*new).*guinea",GNB:"bissau|^(?=.*portu).*guinea",GUY:"guyana|british.?guiana",HTI:"haiti",HMD:"heard.*mcdonald",VAT:"holy.?see|vatican|papal.?st",HND:"^(?!.*brit).*honduras",HKG:"hong.?kong",HUN:"^(?!.*austr).*hungary",ISL:"iceland",IND:"india(?!.*ocea)",IDN:"indonesia",IRN:"\\biran|persia",IRQ:"\\biraq|mesopotamia",IRL:"(^ireland)|(^republic.*ireland)",IMN:"^(?=.*isle).*\\bman",ISR:"israel",ITA:"italy",JAM:"jamaica",JPN:"japan",JEY:"jersey",JOR:"jordan",KAZ:"kazak",KEN:"kenya|british.?east.?africa|east.?africa.?prot",KIR:"kiribati",PRK:"^(?=.*democrat|people|north|d.*p.*.r).*\\bkorea|dprk|korea.*(d.*p.*r)",KWT:"kuwait",KGZ:"kyrgyz|kirghiz",LAO:"\\blaos?\\b",LVA:"latvia",LBN:"lebanon",LSO:"lesotho|basuto",LBR:"liberia",LBY:"libya",LIE:"liechtenstein",LTU:"lithuania",LUX:"^(?!.*belg).*luxem",MAC:"maca(o|u)",MDG:"madagascar|malagasy",MWI:"malawi|nyasa",MYS:"malaysia",MDV:"maldive",MLI:"\\bmali\\b",MLT:"\\bmalta",MHL:"marshall",MTQ:"martinique",MRT:"mauritania",MUS:"mauritius",MYT:"\\bmayotte",MEX:"\\bmexic",FSM:"fed.*micronesia|micronesia.*fed",MCO:"monaco",MNG:"mongolia",MNE:"^(?!.*serbia).*montenegro",MSR:"montserrat",MAR:"morocco|\\bmaroc",MOZ:"mozambique",MMR:"myanmar|burma",NAM:"namibia",NRU:"nauru",NPL:"nepal",NLD:"^(?!.*\\bant)(?!.*\\bcarib).*netherlands",ANT:"^(?=.*\\bant).*(nether|dutch)",NCL:"new.?caledonia",NZL:"new.?zealand",NIC:"nicaragua",NER:"\\bniger(?!ia)",NGA:"nigeria",NIU:"niue",NFK:"norfolk",MNP:"mariana",NOR:"norway",OMN:"\\boman|trucial",PAK:"^(?!.*east).*paki?stan",PLW:"palau",PSE:"palestin|\\bgaza|west.?bank",PAN:"panama",PNG:"papua|new.?guinea",PRY:"paraguay",PER:"peru",PHL:"philippines",PCN:"pitcairn",POL:"poland",PRT:"portugal",PRI:"puerto.?rico",QAT:"qatar",KOR:"^(?!.*d.*p.*r)(?!.*democrat)(?!.*people)(?!.*north).*\\bkorea(?!.*d.*p.*r)",MDA:"moldov|b(a|e)ssarabia",REU:"r(e|é)union",ROU:"r(o|u|ou)mania",RUS:"\\brussia|soviet.?union|u\\.?s\\.?s\\.?r|socialist.?republics",RWA:"rwanda",BLM:"barth(e|é)lemy",SHN:"helena",KNA:"kitts|\\bnevis",LCA:"\\blucia",MAF:"^(?=.*collectivity).*martin|^(?=.*france).*martin(?!ique)|^(?=.*french).*martin(?!ique)",SPM:"miquelon",VCT:"vincent",WSM:"^(?!.*amer).*samoa",SMR:"san.?marino",STP:"\\bs(a|ã)o.?tom(e|é)",SAU:"\\bsa\\w*.?arabia",SEN:"senegal",SRB:"^(?!.*monte).*serbia",SYC:"seychell",SLE:"sierra",SGP:"singapore",SXM:"^(?!.*martin)(?!.*saba).*maarten",SVK:"^(?!.*cze).*slovak",SVN:"slovenia",SLB:"solomon",SOM:"somali",ZAF:"south.africa|s\\\\..?africa",SGS:"south.?georgia|sandwich",SSD:"\\bs\\w*.?sudan",ESP:"spain",LKA:"sri.?lanka|ceylon",SDN:"^(?!.*\\bs(?!u)).*sudan",SUR:"surinam|dutch.?guiana",SJM:"svalbard",SWZ:"swaziland",SWE:"sweden",CHE:"switz|swiss",SYR:"syria",TWN:"taiwan|taipei|formosa|^(?!.*peo)(?=.*rep).*china",TJK:"tajik",THA:"thailand|\\bsiam",MKD:"macedonia|fyrom",TLS:"^(?=.*leste).*timor|^(?=.*east).*timor",TGO:"togo",TKL:"tokelau",TON:"tonga",TTO:"trinidad|tobago",TUN:"tunisia",TUR:"turkey",TKM:"turkmen",TCA:"turks",TUV:"tuvalu",UGA:"uganda",UKR:"ukrain",ARE:"emirates|^u\\.?a\\.?e\\.?$|united.?arab.?em",GBR:"united.?kingdom|britain|^u\\.?k\\.?$",TZA:"tanzania",USA:"united.?states\\b(?!.*islands)|\\bu\\.?s\\.?a\\.?\\b|^\\s*u\\.?s\\.?\\b(?!.*islands)",UMI:"minor.?outlying.?is",URY:"uruguay",UZB:"uzbek",VUT:"vanuatu|new.?hebrides",VEN:"venezuela",VNM:"^(?!.*republic).*viet.?nam|^(?=.*socialist).*viet.?nam",VGB:"^(?=.*\\bu\\.?\\s?k).*virgin|^(?=.*brit).*virgin|^(?=.*kingdom).*virgin",VIR:"^(?=.*\\bu\\.?\\s?s).*virgin|^(?=.*states).*virgin",WLF:"futuna|wallis",ESH:"western.sahara",YEM:"^(?!.*arab)(?!.*north)(?!.*sana)(?!.*peo)(?!.*dem)(?!.*south)(?!.*aden)(?!.*\\bp\\.?d\\.?r).*yemen",YMD:"^(?=.*peo).*yemen|^(?!.*rep)(?=.*dem).*yemen|^(?=.*south).*yemen|^(?=.*aden).*yemen|^(?=.*\\bp\\.?d\\.?r).*yemen",YUG:"yugoslavia",ZMB:"zambia|northern.?rhodesia",EAZ:"zanzibar",ZWE:"zimbabwe|^(?!.*northern).*rhodesia"}},{}],146:[function(e,t,r){t.exports=["xx-small","x-small","small","medium","large","x-large","xx-large","larger","smaller"]},{}],147:[function(e,t,r){t.exports=["normal","condensed","semi-condensed","extra-condensed","ultra-condensed","expanded","semi-expanded","extra-expanded","ultra-expanded"]},{}],148:[function(e,t,r){t.exports=["normal","italic","oblique"]},{}],149:[function(e,t,r){t.exports=["normal","bold","bolder","lighter","100","200","300","400","500","600","700","800","900"]},{}],150:[function(e,t,r){"use strict";t.exports={parse:e("./parse"),stringify:e("./stringify")}},{"./parse":152,"./stringify":153}],151:[function(e,t,r){"use strict";var a=e("css-font-size-keywords");t.exports={isSize:function e(t){return/^[\d\.]/.test(t)||t.indexOf("/")!==-1||a.indexOf(t)!==-1}}},{"css-font-size-keywords":146}],152:[function(e,t,r){"use strict";var a=e("unquote");var n=e("css-global-keywords");var i=e("css-system-font-keywords");var o=e("css-font-weight-keywords");var s=e("css-font-style-keywords");var l=e("css-font-stretch-keywords");var u=e("string-split-by");var c=e("./lib/util").isSize;t.exports=h;var f=h.cache={};function h(e){if(typeof e!=="string")throw new Error("Font argument must be a string.");if(f[e])return f[e];if(e===""){throw new Error("Cannot parse an empty string.")}if(i.indexOf(e)!==-1){return f[e]={system:e}}var t={style:"normal",variant:"normal",weight:"normal",stretch:"normal",lineHeight:"normal",size:"1rem",family:["serif"]};var r=u(e,/\s+/);var h;while(h=r.shift()){if(n.indexOf(h)!==-1){["style","variant","weight","stretch"].forEach((function(e){t[e]=h}));return f[e]=t}if(s.indexOf(h)!==-1){t.style=h;continue}if(h==="normal"||h==="small-caps"){t.variant=h;continue}if(l.indexOf(h)!==-1){t.stretch=h;continue}if(o.indexOf(h)!==-1){t.weight=h;continue}if(c(h)){var v=u(h,"/");t.size=v[0];if(v[1]!=null){t.lineHeight=p(v[1])}else if(r[0]==="/"){r.shift();t.lineHeight=p(r.shift())}if(!r.length){throw new Error("Missing required font-family.")}t.family=u(r.join(" "),/\s*,\s*/).map(a);return f[e]=t}throw new Error("Unknown or unsupported font token: "+h)}throw new Error("Missing required font-size.")}function p(e){var t=parseFloat(e);if(t.toString()===e){return t}return e}},{"./lib/util":151,"css-font-stretch-keywords":147,"css-font-style-keywords":148,"css-font-weight-keywords":149,"css-global-keywords":154,"css-system-font-keywords":155,"string-split-by":574,unquote:604}],153:[function(e,t,r){"use strict";var a=e("pick-by-alias");var n=e("./lib/util").isSize;var i=v(e("css-global-keywords"));var o=v(e("css-system-font-keywords"));var s=v(e("css-font-weight-keywords"));var l=v(e("css-font-style-keywords"));var u=v(e("css-font-stretch-keywords"));var c={normal:1,"small-caps":1};var f={serif:1,"sans-serif":1,monospace:1,cursive:1,fantasy:1,"system-ui":1};var h={style:"normal",variant:"normal",weight:"normal",stretch:"normal",size:"1rem",lineHeight:"normal",family:"serif"};t.exports=function e(t){t=a(t,{style:"style fontstyle fontStyle font-style slope distinction",variant:"variant font-variant fontVariant fontvariant var capitalization",weight:"weight w font-weight fontWeight fontweight",stretch:"stretch font-stretch fontStretch fontstretch width",size:"size s font-size fontSize fontsize height em emSize",lineHeight:"lh line-height lineHeight lineheight leading",family:"font family fontFamily font-family fontfamily type typeface face",system:"system reserved default global"});if(t.system){if(t.system)p(t.system,o);return t.system}p(t.style,l);p(t.variant,c);p(t.weight,s);p(t.stretch,u);if(t.size==null)t.size=h.size;if(typeof t.size==="number")t.size+="px";if(!n)throw Error("Bad size value `"+t.size+"`");if(!t.family)t.family=h.family;if(Array.isArray(t.family)){if(!t.family.length)t.family=[h.family];t.family=t.family.map((function(e){return f[e]?e:'"'+e+'"'})).join(", ")}var r=[];r.push(t.style);if(t.variant!==t.style)r.push(t.variant);if(t.weight!==t.variant&&t.weight!==t.style)r.push(t.weight);if(t.stretch!==t.weight&&t.stretch!==t.variant&&t.stretch!==t.style)r.push(t.stretch);r.push(t.size+(t.lineHeight==null||t.lineHeight==="normal"||t.lineHeight+""==="1"?"":"/"+t.lineHeight));r.push(t.family);return r.filter(Boolean).join(" ")};function p(e,t){if(e&&!t[e]&&!i[e])throw Error("Unknown keyword `"+e+"`");return e}function v(e){var t={};for(var r=0;r<e.length;r++){t[e[r]]=1}return t}},{"./lib/util":151,"css-font-stretch-keywords":147,"css-font-style-keywords":148,"css-font-weight-keywords":149,"css-global-keywords":154,"css-system-font-keywords":155,"pick-by-alias":485}],154:[function(e,t,r){t.exports=["inherit","initial","unset"]},{}],155:[function(e,t,r){t.exports=["caption","icon","menu","message-box","small-caption","status-bar"]},{}],156:[function(e,t,r){"use strict";function a(e,t,r,a,n,i){var o=6*n*n-6*n,s=3*n*n-4*n+1,l=-6*n*n+6*n,u=3*n*n-2*n;if(e.length){if(!i){i=new Array(e.length)}for(var c=e.length-1;c>=0;--c){i[c]=o*e[c]+s*t[c]+l*r[c]+u*a[c]}return i}return o*e+s*t+l*r[c]+u*a}function n(e,t,r,a,n,i){var o=n-1,s=n*n,l=o*o,u=(1+2*n)*l,c=n*l,f=s*(3-2*n),h=s*o;if(e.length){if(!i){i=new Array(e.length)}for(var p=e.length-1;p>=0;--p){i[p]=u*e[p]+c*t[p]+f*r[p]+h*a[p]}return i}return u*e+c*t+f*r+h*a}t.exports=n;t.exports.derivative=a},{}],157:[function(e,t,r){"use strict";var a=e("type/value/is"),n=e("type/value/ensure"),i=e("type/plain-function/ensure"),o=e("es5-ext/object/copy"),s=e("es5-ext/object/normalize-options"),l=e("es5-ext/object/map");var u=Function.prototype.bind,c=Object.defineProperty,f=Object.prototype.hasOwnProperty,h;h=function(e,t,r){var a=n(t)&&i(t.value),s;s=o(t);delete s.writable;delete s.value;s.get=function(){if(!r.overwriteDefinition&&f.call(this,e))return a;t.value=u.call(a,r.resolveContext?r.resolveContext(this):this);c(this,e,t);return this[e]};return s};t.exports=function(e){var t=s(arguments[1]);if(a(t.resolveContext))i(t.resolveContext);return l(e,(function(e,r){return h(r,e,t)}))}},{"es5-ext/object/copy":202,"es5-ext/object/map":210,"es5-ext/object/normalize-options":211,"type/plain-function/ensure":595,"type/value/ensure":599,"type/value/is":600}],158:[function(e,t,r){"use strict";var a=e("type/value/is"),n=e("type/plain-function/is"),i=e("es5-ext/object/assign"),o=e("es5-ext/object/normalize-options"),s=e("es5-ext/string/#/contains");var l=t.exports=function(e,t){var r,n,l,u,c;if(arguments.length<2||typeof e!=="string"){u=t;t=e;e=null}else{u=arguments[2]}if(a(e)){r=s.call(e,"c");n=s.call(e,"e");l=s.call(e,"w")}else{r=l=true;n=false}c={value:t,configurable:r,enumerable:n,writable:l};return!u?c:i(o(u),c)};l.gs=function(e,t,r){var l,u,c,f;if(typeof e!=="string"){c=r;r=t;t=e;e=null}else{c=arguments[3]}if(!a(t)){t=undefined}else if(!n(t)){c=t;t=r=undefined}else if(!a(r)){r=undefined}else if(!n(r)){c=r;r=undefined}if(a(e)){l=s.call(e,"c");u=s.call(e,"e")}else{l=true;u=false}f={get:t,set:r,configurable:l,enumerable:u};return!c?f:i(o(c),f)}},{"es5-ext/object/assign":199,"es5-ext/object/normalize-options":211,"es5-ext/string/#/contains":218,"type/plain-function/is":596,"type/value/is":600}],159:[function(t,r,a){(function(t,n){typeof a==="object"&&typeof r!=="undefined"?n(a):typeof e==="function"&&e.amd?e(["exports"],n):n(t.d3=t.d3||{})})(this,(function(e){"use strict";function t(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function r(e){if(e.length===1)e=a(e);return{left:function(t,r,a,n){if(a==null)a=0;if(n==null)n=t.length;while(a<n){var i=a+n>>>1;if(e(t[i],r)<0)a=i+1;else n=i}return a},right:function(t,r,a,n){if(a==null)a=0;if(n==null)n=t.length;while(a<n){var i=a+n>>>1;if(e(t[i],r)>0)n=i;else a=i+1}return a}}}function a(e){return function(r,a){return t(e(r),a)}}var n=r(t);var i=n.right;var o=n.left;function s(e,t){if(t==null)t=l;var r=0,a=e.length-1,n=e[0],i=new Array(a<0?0:a);while(r<a)i[r]=t(n,n=e[++r]);return i}function l(e,t){return[e,t]}function u(e,t,r){var a=e.length,n=t.length,i=new Array(a*n),o,s,u,c;if(r==null)r=l;for(o=u=0;o<a;++o){for(c=e[o],s=0;s<n;++s,++u){i[u]=r(c,t[s])}}return i}function c(e,t){return t<e?-1:t>e?1:t>=e?0:NaN}function f(e){return e===null?NaN:+e}function h(e,t){var r=e.length,a=0,n=-1,i=0,o,s,l=0;if(t==null){while(++n<r){if(!isNaN(o=f(e[n]))){s=o-i;i+=s/++a;l+=s*(o-i)}}}else{while(++n<r){if(!isNaN(o=f(t(e[n],n,e)))){s=o-i;i+=s/++a;l+=s*(o-i)}}}if(a>1)return l/(a-1)}function p(e,t){var r=h(e,t);return r?Math.sqrt(r):r}function v(e,t){var r=e.length,a=-1,n,i,o;if(t==null){while(++a<r){if((n=e[a])!=null&&n>=n){i=o=n;while(++a<r){if((n=e[a])!=null){if(i>n)i=n;if(o<n)o=n}}}}}else{while(++a<r){if((n=t(e[a],a,e))!=null&&n>=n){i=o=n;while(++a<r){if((n=t(e[a],a,e))!=null){if(i>n)i=n;if(o<n)o=n}}}}}return[i,o]}var d=Array.prototype;var m=d.slice;var g=d.map;function y(e){return function(){return e}}function x(e){return e}function b(e,t,r){e=+e,t=+t,r=(n=arguments.length)<2?(t=e,e=0,1):n<3?1:+r;var a=-1,n=Math.max(0,Math.ceil((t-e)/r))|0,i=new Array(n);while(++a<n){i[a]=e+a*r}return i}var _=Math.sqrt(50),w=Math.sqrt(10),T=Math.sqrt(2);function k(e,t,r){var a,n=-1,i,o,s;t=+t,e=+e,r=+r;if(e===t&&r>0)return[e];if(a=t<e)i=e,e=t,t=i;if((s=M(e,t,r))===0||!isFinite(s))return[];if(s>0){e=Math.ceil(e/s);t=Math.floor(t/s);o=new Array(i=Math.ceil(t-e+1));while(++n<i)o[n]=(e+n)*s}else{e=Math.floor(e*s);t=Math.ceil(t*s);o=new Array(i=Math.ceil(e-t+1));while(++n<i)o[n]=(e-n)/s}if(a)o.reverse();return o}function M(e,t,r){var a=(t-e)/Math.max(0,r),n=Math.floor(Math.log(a)/Math.LN10),i=a/Math.pow(10,n);return n>=0?(i>=_?10:i>=w?5:i>=T?2:1)*Math.pow(10,n):-Math.pow(10,-n)/(i>=_?10:i>=w?5:i>=T?2:1)}function A(e,t,r){var a=Math.abs(t-e)/Math.max(0,r),n=Math.pow(10,Math.floor(Math.log(a)/Math.LN10)),i=a/n;if(i>=_)n*=10;else if(i>=w)n*=5;else if(i>=T)n*=2;return t<e?-n:n}function S(e){return Math.ceil(Math.log(e.length)/Math.LN2)+1}function E(){var e=x,t=v,r=S;function a(a){var n,o=a.length,s,l=new Array(o);for(n=0;n<o;++n){l[n]=e(a[n],n,a)}var u=t(l),c=u[0],f=u[1],h=r(l,c,f);if(!Array.isArray(h)){h=A(c,f,h);h=b(Math.ceil(c/h)*h,f,h)}var p=h.length;while(h[0]<=c)h.shift(),--p;while(h[p-1]>f)h.pop(),--p;var v=new Array(p+1),d;for(n=0;n<=p;++n){d=v[n]=[];d.x0=n>0?h[n-1]:c;d.x1=n<p?h[n]:f}for(n=0;n<o;++n){s=l[n];if(c<=s&&s<=f){v[i(h,s,0,p)].push(a[n])}}return v}a.value=function(t){return arguments.length?(e=typeof t==="function"?t:y(t),a):e};a.domain=function(e){return arguments.length?(t=typeof e==="function"?e:y([e[0],e[1]]),a):t};a.thresholds=function(e){return arguments.length?(r=typeof e==="function"?e:Array.isArray(e)?y(m.call(e)):y(e),a):r};return a}function L(e,t,r){if(r==null)r=f;if(!(a=e.length))return;if((t=+t)<=0||a<2)return+r(e[0],0,e);if(t>=1)return+r(e[a-1],a-1,e);var a,n=(a-1)*t,i=Math.floor(n),o=+r(e[i],i,e),s=+r(e[i+1],i+1,e);return o+(s-o)*(n-i)}function C(e,r,a){e=g.call(e,f).sort(t);return Math.ceil((a-r)/(2*(L(e,.75)-L(e,.25))*Math.pow(e.length,-1/3)))}function I(e,t,r){return Math.ceil((r-t)/(3.5*p(e)*Math.pow(e.length,-1/3)))}function P(e,t){var r=e.length,a=-1,n,i;if(t==null){while(++a<r){if((n=e[a])!=null&&n>=n){i=n;while(++a<r){if((n=e[a])!=null&&n>i){i=n}}}}}else{while(++a<r){if((n=t(e[a],a,e))!=null&&n>=n){i=n;while(++a<r){if((n=t(e[a],a,e))!=null&&n>i){i=n}}}}}return i}function O(e,t){var r=e.length,a=r,n=-1,i,o=0;if(t==null){while(++n<r){if(!isNaN(i=f(e[n])))o+=i;else--a}}else{while(++n<r){if(!isNaN(i=f(t(e[n],n,e))))o+=i;else--a}}if(a)return o/a}function z(e,r){var a=e.length,n=-1,i,o=[];if(r==null){while(++n<a){if(!isNaN(i=f(e[n]))){o.push(i)}}}else{while(++n<a){if(!isNaN(i=f(r(e[n],n,e)))){o.push(i)}}}return L(o.sort(t),.5)}function D(e){var t=e.length,r,a=-1,n=0,i,o;while(++a<t)n+=e[a].length;i=new Array(n);while(--t>=0){o=e[t];r=o.length;while(--r>=0){i[--n]=o[r]}}return i}function R(e,t){var r=e.length,a=-1,n,i;if(t==null){while(++a<r){if((n=e[a])!=null&&n>=n){i=n;while(++a<r){if((n=e[a])!=null&&i>n){i=n}}}}}else{while(++a<r){if((n=t(e[a],a,e))!=null&&n>=n){i=n;while(++a<r){if((n=t(e[a],a,e))!=null&&i>n){i=n}}}}}return i}function F(e,t){var r=t.length,a=new Array(r);while(r--)a[r]=e[t[r]];return a}function B(e,r){if(!(a=e.length))return;var a,n=0,i=0,o,s=e[i];if(r==null)r=t;while(++n<a){if(r(o=e[n],s)<0||r(s,s)!==0){s=o,i=n}}if(r(s,s)===0)return i}function N(e,t,r){var a=(r==null?e.length:r)-(t=t==null?0:+t),n,i;while(a){i=Math.random()*a--|0;n=e[a+t];e[a+t]=e[i+t];e[i+t]=n}return e}function j(e,t){var r=e.length,a=-1,n,i=0;if(t==null){while(++a<r){if(n=+e[a])i+=n}}else{while(++a<r){if(n=+t(e[a],a,e))i+=n}}return i}function U(e){if(!(i=e.length))return[];for(var t=-1,r=R(e,V),a=new Array(r);++t<r;){for(var n=-1,i,o=a[t]=new Array(i);++n<i;){o[n]=e[n][t]}}return a}function V(e){return e.length}function H(){return U(arguments)}e.bisect=i;e.bisectRight=i;e.bisectLeft=o;e.ascending=t;e.bisector=r;e.cross=u;e.descending=c;e.deviation=p;e.extent=v;e.histogram=E;e.thresholdFreedmanDiaconis=C;e.thresholdScott=I;e.thresholdSturges=S;e.max=P;e.mean=O;e.median=z;e.merge=D;e.min=R;e.pairs=s;e.permute=F;e.quantile=L;e.range=b;e.scan=B;e.shuffle=N;e.sum=j;e.ticks=k;e.tickIncrement=M;e.tickStep=A;e.transpose=U;e.variance=h;e.zip=H;Object.defineProperty(e,"__esModule",{value:true})}))},{}],160:[function(t,r,a){(function(t,n){typeof a==="object"&&typeof r!=="undefined"?n(a):typeof e==="function"&&e.amd?e(["exports"],n):n(t.d3=t.d3||{})})(this,(function(e){"use strict";var t="$";function r(){}r.prototype=a.prototype={constructor:r,has:function(e){return t+e in this},get:function(e){return this[t+e]},set:function(e,r){this[t+e]=r;return this},remove:function(e){var r=t+e;return r in this&&delete this[r]},clear:function(){for(var e in this)if(e[0]===t)delete this[e]},keys:function(){var e=[];for(var r in this)if(r[0]===t)e.push(r.slice(1));return e},values:function(){var e=[];for(var r in this)if(r[0]===t)e.push(this[r]);return e},entries:function(){var e=[];for(var r in this)if(r[0]===t)e.push({key:r.slice(1),value:this[r]});return e},size:function(){var e=0;for(var r in this)if(r[0]===t)++e;return e},empty:function(){for(var e in this)if(e[0]===t)return false;return true},each:function(e){for(var r in this)if(r[0]===t)e(this[r],r.slice(1),this)}};function a(e,t){var a=new r;if(e instanceof r)e.each((function(e,t){a.set(t,e)}));else if(Array.isArray(e)){var n=-1,i=e.length,o;if(t==null)while(++n<i)a.set(n,e[n]);else while(++n<i)a.set(t(o=e[n],n,e),o)}else if(e)for(var s in e)a.set(s,e[s]);return a}function n(){var e=[],t=[],r,n,u;function c(t,i,o,s){if(i>=e.length){if(r!=null)t.sort(r);return n!=null?n(t):t}var l=-1,u=t.length,f=e[i++],h,p,v=a(),d,m=o();while(++l<u){if(d=v.get(h=f(p=t[l])+"")){d.push(p)}else{v.set(h,[p])}}v.each((function(e,t){s(m,t,c(e,i,o,s))}));return m}function f(r,a){if(++a>e.length)return r;var i,o=t[a-1];if(n!=null&&a>=e.length)i=r.entries();else i=[],r.each((function(e,t){i.push({key:t,values:f(e,a)})}));return o!=null?i.sort((function(e,t){return o(e.key,t.key)})):i}return u={object:function(e){return c(e,0,i,o)},map:function(e){return c(e,0,s,l)},entries:function(e){return f(c(e,0,s,l),0)},key:function(t){e.push(t);return u},sortKeys:function(r){t[e.length-1]=r;return u},sortValues:function(e){r=e;return u},rollup:function(e){n=e;return u}}}function i(){return{}}function o(e,t,r){e[t]=r}function s(){return a()}function l(e,t,r){e.set(t,r)}function u(){}var c=a.prototype;u.prototype=f.prototype={constructor:u,has:c.has,add:function(e){e+="";this[t+e]=e;return this},remove:c.remove,clear:c.clear,values:c.keys,size:c.size,empty:c.empty,each:c.each};function f(e,t){var r=new u;if(e instanceof u)e.each((function(e){r.add(e)}));else if(e){var a=-1,n=e.length;if(t==null)while(++a<n)r.add(e[a]);else while(++a<n)r.add(t(e[a],a,e))}return r}function h(e){var t=[];for(var r in e)t.push(r);return t}function p(e){var t=[];for(var r in e)t.push(e[r]);return t}function v(e){var t=[];for(var r in e)t.push({key:r,value:e[r]});return t}e.nest=n;e.set=f;e.map=a;e.keys=h;e.values=p;e.entries=v;Object.defineProperty(e,"__esModule",{value:true})}))},{}],161:[function(t,r,a){(function(t,n){typeof a==="object"&&typeof r!=="undefined"?n(a):typeof e==="function"&&e.amd?e(["exports"],n):(t=t||self,n(t.d3=t.d3||{}))})(this,(function(e){"use strict";function t(e,t,r){e.prototype=t.prototype=r;r.constructor=e}function r(e,t){var r=Object.create(e.prototype);for(var a in t)r[a]=t[a];return r}function a(){}var n=.7;var i=1/n;var o="\\s*([+-]?\\d+)\\s*",s="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",l="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",u=/^#([0-9a-f]{3,8})$/,c=new RegExp("^rgb\\("+[o,o,o]+"\\)$"),f=new RegExp("^rgb\\("+[l,l,l]+"\\)$"),h=new RegExp("^rgba\\("+[o,o,o,s]+"\\)$"),p=new RegExp("^rgba\\("+[l,l,l,s]+"\\)$"),v=new RegExp("^hsl\\("+[s,l,l]+"\\)$"),d=new RegExp("^hsla\\("+[s,l,l,s]+"\\)$");var m={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};t(a,b,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:g,formatHex:g,formatHsl:y,formatRgb:x,toString:x});function g(){return this.rgb().formatHex()}function y(){return C(this).formatHsl()}function x(){return this.rgb().formatRgb()}function b(e){var t,r;e=(e+"").trim().toLowerCase();return(t=u.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?_(t):r===3?new M(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?w(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?w(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=c.exec(e))?new M(t[1],t[2],t[3],1):(t=f.exec(e))?new M(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=h.exec(e))?w(t[1],t[2],t[3],t[4]):(t=p.exec(e))?w(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=v.exec(e))?L(t[1],t[2]/100,t[3]/100,1):(t=d.exec(e))?L(t[1],t[2]/100,t[3]/100,t[4]):m.hasOwnProperty(e)?_(m[e]):e==="transparent"?new M(NaN,NaN,NaN,0):null}function _(e){return new M(e>>16&255,e>>8&255,e&255,1)}function w(e,t,r,a){if(a<=0)e=t=r=NaN;return new M(e,t,r,a)}function T(e){if(!(e instanceof a))e=b(e);if(!e)return new M;e=e.rgb();return new M(e.r,e.g,e.b,e.opacity)}function k(e,t,r,a){return arguments.length===1?T(e):new M(e,t,r,a==null?1:a)}function M(e,t,r,a){this.r=+e;this.g=+t;this.b=+r;this.opacity=+a}t(M,k,r(a,{brighter:function(e){e=e==null?i:Math.pow(i,e);return new M(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){e=e==null?n:Math.pow(n,e);return new M(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&(-.5<=this.g&&this.g<255.5)&&(-.5<=this.b&&this.b<255.5)&&(0<=this.opacity&&this.opacity<=1)},hex:A,formatHex:A,formatRgb:S,toString:S}));function A(){return"#"+E(this.r)+E(this.g)+E(this.b)}function S(){var e=this.opacity;e=isNaN(e)?1:Math.max(0,Math.min(1,e));return(e===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(e===1?")":", "+e+")")}function E(e){e=Math.max(0,Math.min(255,Math.round(e)||0));return(e<16?"0":"")+e.toString(16)}function L(e,t,r,a){if(a<=0)e=t=r=NaN;else if(r<=0||r>=1)e=t=NaN;else if(t<=0)e=NaN;return new P(e,t,r,a)}function C(e){if(e instanceof P)return new P(e.h,e.s,e.l,e.opacity);if(!(e instanceof a))e=b(e);if(!e)return new P;if(e instanceof P)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,i=Math.min(t,r,n),o=Math.max(t,r,n),s=NaN,l=o-i,u=(o+i)/2;if(l){if(t===o)s=(r-n)/l+(r<n)*6;else if(r===o)s=(n-t)/l+2;else s=(t-r)/l+4;l/=u<.5?o+i:2-o-i;s*=60}else{l=u>0&&u<1?0:s}return new P(s,l,u,e.opacity)}function I(e,t,r,a){return arguments.length===1?C(e):new P(e,t,r,a==null?1:a)}function P(e,t,r,a){this.h=+e;this.s=+t;this.l=+r;this.opacity=+a}t(P,I,r(a,{brighter:function(e){e=e==null?i:Math.pow(i,e);return new P(this.h,this.s,this.l*e,this.opacity)},darker:function(e){e=e==null?n:Math.pow(n,e);return new P(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,a=r+(r<.5?r:1-r)*t,n=2*r-a;return new M(O(e>=240?e-240:e+120,n,a),O(e,n,a),O(e<120?e+240:e-120,n,a),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&(0<=this.l&&this.l<=1)&&(0<=this.opacity&&this.opacity<=1)},formatHsl:function(){var e=this.opacity;e=isNaN(e)?1:Math.max(0,Math.min(1,e));return(e===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(e===1?")":", "+e+")")}}));function O(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}var z=Math.PI/180;var D=180/Math.PI;var R=18,F=.96422,B=1,N=.82521,j=4/29,U=6/29,V=3*U*U,H=U*U*U;function q(e){if(e instanceof W)return new W(e.l,e.a,e.b,e.opacity);if(e instanceof te)return re(e);if(!(e instanceof M))e=T(e);var t=K(e.r),r=K(e.g),a=K(e.b),n=X((.2225045*t+.7168786*r+.0606169*a)/B),i,o;if(t===r&&r===a)i=o=n;else{i=X((.4360747*t+.3850649*r+.1430804*a)/F);o=X((.0139322*t+.0971045*r+.7141733*a)/N)}return new W(116*n-16,500*(i-n),200*(n-o),e.opacity)}function G(e,t){return new W(e,0,0,t==null?1:t)}function Y(e,t,r,a){return arguments.length===1?q(e):new W(e,t,r,a==null?1:a)}function W(e,t,r,a){this.l=+e;this.a=+t;this.b=+r;this.opacity=+a}t(W,Y,r(a,{brighter:function(e){return new W(this.l+R*(e==null?1:e),this.a,this.b,this.opacity)},darker:function(e){return new W(this.l-R*(e==null?1:e),this.a,this.b,this.opacity)},rgb:function(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,r=isNaN(this.b)?e:e-this.b/200;t=F*Z(t);e=B*Z(e);r=N*Z(r);return new M(J(3.1338561*t-1.6168667*e-.4906146*r),J(-.9787684*t+1.9161415*e+.033454*r),J(.0719453*t-.2289914*e+1.4052427*r),this.opacity)}}));function X(e){return e>H?Math.pow(e,1/3):e/V+j}function Z(e){return e>U?e*e*e:V*(e-j)}function J(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function K(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Q(e){if(e instanceof te)return new te(e.h,e.c,e.l,e.opacity);if(!(e instanceof W))e=q(e);if(e.a===0&&e.b===0)return new te(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*D;return new te(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function $(e,t,r,a){return arguments.length===1?Q(e):new te(r,t,e,a==null?1:a)}function ee(e,t,r,a){return arguments.length===1?Q(e):new te(e,t,r,a==null?1:a)}function te(e,t,r,a){this.h=+e;this.c=+t;this.l=+r;this.opacity=+a}function re(e){if(isNaN(e.h))return new W(e.l,0,0,e.opacity);var t=e.h*z;return new W(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}t(te,ee,r(a,{brighter:function(e){return new te(this.h,this.c,this.l+R*(e==null?1:e),this.opacity)},darker:function(e){return new te(this.h,this.c,this.l-R*(e==null?1:e),this.opacity)},rgb:function(){return re(this).rgb()}}));var ae=-.14861,ne=+1.78277,ie=-.29227,oe=-.90649,se=+1.97294,le=se*oe,ue=se*ne,ce=ne*ie-oe*ae;function fe(e){if(e instanceof pe)return new pe(e.h,e.s,e.l,e.opacity);if(!(e instanceof M))e=T(e);var t=e.r/255,r=e.g/255,a=e.b/255,n=(ce*a+le*t-ue*r)/(ce+le-ue),i=a-n,o=(se*(r-n)-ie*i)/oe,s=Math.sqrt(o*o+i*i)/(se*n*(1-n)),l=s?Math.atan2(o,i)*D-120:NaN;return new pe(l<0?l+360:l,s,n,e.opacity)}function he(e,t,r,a){return arguments.length===1?fe(e):new pe(e,t,r,a==null?1:a)}function pe(e,t,r,a){this.h=+e;this.s=+t;this.l=+r;this.opacity=+a}t(pe,he,r(a,{brighter:function(e){e=e==null?i:Math.pow(i,e);return new pe(this.h,this.s,this.l*e,this.opacity)},darker:function(e){e=e==null?n:Math.pow(n,e);return new pe(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=isNaN(this.h)?0:(this.h+120)*z,t=+this.l,r=isNaN(this.s)?0:this.s*t*(1-t),a=Math.cos(e),n=Math.sin(e);return new M(255*(t+r*(ae*a+ne*n)),255*(t+r*(ie*a+oe*n)),255*(t+r*(se*a)),this.opacity)}}));e.color=b;e.cubehelix=he;e.gray=G;e.hcl=ee;e.hsl=I;e.lab=Y;e.lch=$;e.rgb=k;Object.defineProperty(e,"__esModule",{value:true})}))},{}],162:[function(t,r,a){(function(t,n){typeof a==="object"&&typeof r!=="undefined"?n(a):typeof e==="function"&&e.amd?e(["exports"],n):(t=t||self,n(t.d3=t.d3||{}))})(this,(function(e){"use strict";var t={value:function(){}};function r(){for(var e=0,t=arguments.length,r={},n;e<t;++e){if(!(n=arguments[e]+"")||n in r||/[\s.]/.test(n))throw new Error("illegal type: "+n);r[n]=[]}return new a(r)}function a(e){this._=e}function n(e,t){return e.trim().split(/^|\s+/).map((function(e){var r="",a=e.indexOf(".");if(a>=0)r=e.slice(a+1),e=e.slice(0,a);if(e&&!t.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:r}}))}a.prototype=r.prototype={constructor:a,on:function(e,t){var r=this._,a=n(e+"",r),s,l=-1,u=a.length;if(arguments.length<2){while(++l<u)if((s=(e=a[l]).type)&&(s=i(r[s],e.name)))return s;return}if(t!=null&&typeof t!=="function")throw new Error("invalid callback: "+t);while(++l<u){if(s=(e=a[l]).type)r[s]=o(r[s],e.name,t);else if(t==null)for(s in r)r[s]=o(r[s],e.name,null)}return this},copy:function(){var e={},t=this._;for(var r in t)e[r]=t[r].slice();return new a(e)},call:function(e,t){if((n=arguments.length-2)>0)for(var r=new Array(n),a=0,n,i;a<n;++a)r[a]=arguments[a+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(i=this._[e],a=0,n=i.length;a<n;++a)i[a].value.apply(t,r)},apply:function(e,t,r){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var a=this._[e],n=0,i=a.length;n<i;++n)a[n].value.apply(t,r)}};function i(e,t){for(var r=0,a=e.length,n;r<a;++r){if((n=e[r]).name===t){return n.value}}}function o(e,r,a){for(var n=0,i=e.length;n<i;++n){if(e[n].name===r){e[n]=t,e=e.slice(0,n).concat(e.slice(n+1));break}}if(a!=null)e.push({name:r,value:a});return e}e.dispatch=r;Object.defineProperty(e,"__esModule",{value:true})}))},{}],163:[function(t,r,a){(function(n,i){typeof a==="object"&&typeof r!=="undefined"?i(a,t("d3-quadtree"),t("d3-collection"),t("d3-dispatch"),t("d3-timer")):typeof e==="function"&&e.amd?e(["exports","d3-quadtree","d3-collection","d3-dispatch","d3-timer"],i):i(n.d3=n.d3||{},n.d3,n.d3,n.d3,n.d3)})(this,(function(e,t,r,a,n){"use strict";function i(e,t){var r;if(e==null)e=0;if(t==null)t=0;function a(){var a,n=r.length,i,o=0,s=0;for(a=0;a<n;++a){i=r[a],o+=i.x,s+=i.y}for(o=o/n-e,s=s/n-t,a=0;a<n;++a){i=r[a],i.x-=o,i.y-=s}}a.initialize=function(e){r=e};a.x=function(t){return arguments.length?(e=+t,a):e};a.y=function(e){return arguments.length?(t=+e,a):t};return a}function o(e){return function(){return e}}function s(){return(Math.random()-.5)*1e-6}function l(e){return e.x+e.vx}function u(e){return e.y+e.vy}function c(e){var r,a,n=1,i=1;if(typeof e!=="function")e=o(e==null?1:+e);function c(){var e,o=r.length,c,h,p,v,d,m;for(var g=0;g<i;++g){c=t.quadtree(r,l,u).visitAfter(f);for(e=0;e<o;++e){h=r[e];d=a[h.index],m=d*d;p=h.x+h.vx;v=h.y+h.vy;c.visit(y)}}function y(e,t,r,a,i){var o=e.data,l=e.r,u=d+l;if(o){if(o.index>h.index){var c=p-o.x-o.vx,f=v-o.y-o.vy,g=c*c+f*f;if(g<u*u){if(c===0)c=s(),g+=c*c;if(f===0)f=s(),g+=f*f;g=(u-(g=Math.sqrt(g)))/g*n;h.vx+=(c*=g)*(u=(l*=l)/(m+l));h.vy+=(f*=g)*u;o.vx-=c*(u=1-u);o.vy-=f*u}}return}return t>p+u||a<p-u||r>v+u||i<v-u}}function f(e){if(e.data)return e.r=a[e.data.index];for(var t=e.r=0;t<4;++t){if(e[t]&&e[t].r>e.r){e.r=e[t].r}}}function h(){if(!r)return;var t,n=r.length,i;a=new Array(n);for(t=0;t<n;++t)i=r[t],a[i.index]=+e(i,t,r)}c.initialize=function(e){r=e;h()};c.iterations=function(e){return arguments.length?(i=+e,c):i};c.strength=function(e){return arguments.length?(n=+e,c):n};c.radius=function(t){return arguments.length?(e=typeof t==="function"?t:o(+t),h(),c):e};return c}function f(e){return e.index}function h(e,t){var r=e.get(t);if(!r)throw new Error("missing: "+t);return r}function p(e){var t=f,a=d,n,i=o(30),l,u,c,p,v=1;if(e==null)e=[];function d(e){return 1/Math.min(c[e.source.index],c[e.target.index])}function m(t){for(var r=0,a=e.length;r<v;++r){for(var i=0,o,u,c,f,h,d,m;i<a;++i){o=e[i],u=o.source,c=o.target;f=c.x+c.vx-u.x-u.vx||s();h=c.y+c.vy-u.y-u.vy||s();d=Math.sqrt(f*f+h*h);d=(d-l[i])/d*t*n[i];f*=d,h*=d;c.vx-=f*(m=p[i]);c.vy-=h*m;u.vx+=f*(m=1-m);u.vy+=h*m}}}function g(){if(!u)return;var a,i=u.length,o=e.length,s=r.map(u,t),f;for(a=0,c=new Array(i);a<o;++a){f=e[a],f.index=a;if(typeof f.source!=="object")f.source=h(s,f.source);if(typeof f.target!=="object")f.target=h(s,f.target);c[f.source.index]=(c[f.source.index]||0)+1;c[f.target.index]=(c[f.target.index]||0)+1}for(a=0,p=new Array(o);a<o;++a){f=e[a],p[a]=c[f.source.index]/(c[f.source.index]+c[f.target.index])}n=new Array(o),y();l=new Array(o),x()}function y(){if(!u)return;for(var t=0,r=e.length;t<r;++t){n[t]=+a(e[t],t,e)}}function x(){if(!u)return;for(var t=0,r=e.length;t<r;++t){l[t]=+i(e[t],t,e)}}m.initialize=function(e){u=e;g()};m.links=function(t){return arguments.length?(e=t,g(),m):e};m.id=function(e){return arguments.length?(t=e,m):t};m.iterations=function(e){return arguments.length?(v=+e,m):v};m.strength=function(e){return arguments.length?(a=typeof e==="function"?e:o(+e),y(),m):a};m.distance=function(e){return arguments.length?(i=typeof e==="function"?e:o(+e),x(),m):i};return m}function v(e){return e.x}function d(e){return e.y}var m=10,g=Math.PI*(3-Math.sqrt(5));function y(e){var t,i=1,o=.001,s=1-Math.pow(o,1/300),l=0,u=.6,c=r.map(),f=n.timer(p),h=a.dispatch("tick","end");if(e==null)e=[];function p(){v();h.call("tick",t);if(i<o){f.stop();h.call("end",t)}}function v(r){var a,n=e.length,o;if(r===undefined)r=1;for(var f=0;f<r;++f){i+=(l-i)*s;c.each((function(e){e(i)}));for(a=0;a<n;++a){o=e[a];if(o.fx==null)o.x+=o.vx*=u;else o.x=o.fx,o.vx=0;if(o.fy==null)o.y+=o.vy*=u;else o.y=o.fy,o.vy=0}}return t}function d(){for(var t=0,r=e.length,a;t<r;++t){a=e[t],a.index=t;if(a.fx!=null)a.x=a.fx;if(a.fy!=null)a.y=a.fy;if(isNaN(a.x)||isNaN(a.y)){var n=m*Math.sqrt(t),i=t*g;a.x=n*Math.cos(i);a.y=n*Math.sin(i)}if(isNaN(a.vx)||isNaN(a.vy)){a.vx=a.vy=0}}}function y(t){if(t.initialize)t.initialize(e);return t}d();return t={tick:v,restart:function(){return f.restart(p),t},stop:function(){return f.stop(),t},nodes:function(r){return arguments.length?(e=r,d(),c.each(y),t):e},alpha:function(e){return arguments.length?(i=+e,t):i},alphaMin:function(e){return arguments.length?(o=+e,t):o},alphaDecay:function(e){return arguments.length?(s=+e,t):+s},alphaTarget:function(e){return arguments.length?(l=+e,t):l},velocityDecay:function(e){return arguments.length?(u=1-e,t):1-u},force:function(e,r){return arguments.length>1?(r==null?c.remove(e):c.set(e,y(r)),t):c.get(e)},find:function(t,r,a){var n=0,i=e.length,o,s,l,u,c;if(a==null)a=Infinity;else a*=a;for(n=0;n<i;++n){u=e[n];o=t-u.x;s=r-u.y;l=o*o+s*s;if(l<a)c=u,a=l}return c},on:function(e,r){return arguments.length>1?(h.on(e,r),t):h.on(e)}}}function x(){var e,r,a,n=o(-30),i,l=1,u=Infinity,c=.81;function f(n){var i,o=e.length,s=t.quadtree(e,v,d).visitAfter(p);for(a=n,i=0;i<o;++i)r=e[i],s.visit(m)}function h(){if(!e)return;var t,r=e.length,a;i=new Array(r);for(t=0;t<r;++t)a=e[t],i[a.index]=+n(a,t,e)}function p(e){var t=0,r,a,n=0,o,s,l;if(e.length){for(o=s=l=0;l<4;++l){if((r=e[l])&&(a=Math.abs(r.value))){t+=r.value,n+=a,o+=a*r.x,s+=a*r.y}}e.x=o/n;e.y=s/n}else{r=e;r.x=r.data.x;r.y=r.data.y;do{t+=i[r.data.index]}while(r=r.next)}e.value=t}function m(e,t,n,o){if(!e.value)return true;var f=e.x-r.x,h=e.y-r.y,p=o-t,v=f*f+h*h;if(p*p/c<v){if(v<u){if(f===0)f=s(),v+=f*f;if(h===0)h=s(),v+=h*h;if(v<l)v=Math.sqrt(l*v);r.vx+=f*e.value*a/v;r.vy+=h*e.value*a/v}return true}else if(e.length||v>=u)return;if(e.data!==r||e.next){if(f===0)f=s(),v+=f*f;if(h===0)h=s(),v+=h*h;if(v<l)v=Math.sqrt(l*v)}do{if(e.data!==r){p=i[e.data.index]*a/v;r.vx+=f*p;r.vy+=h*p}}while(e=e.next)}f.initialize=function(t){e=t;h()};f.strength=function(e){return arguments.length?(n=typeof e==="function"?e:o(+e),h(),f):n};f.distanceMin=function(e){return arguments.length?(l=e*e,f):Math.sqrt(l)};f.distanceMax=function(e){return arguments.length?(u=e*e,f):Math.sqrt(u)};f.theta=function(e){return arguments.length?(c=e*e,f):Math.sqrt(c)};return f}function b(e,t,r){var a,n=o(.1),i,s;if(typeof e!=="function")e=o(+e);if(t==null)t=0;if(r==null)r=0;function l(e){for(var n=0,o=a.length;n<o;++n){var l=a[n],u=l.x-t||1e-6,c=l.y-r||1e-6,f=Math.sqrt(u*u+c*c),h=(s[n]-f)*i[n]*e/f;l.vx+=u*h;l.vy+=c*h}}function u(){if(!a)return;var t,r=a.length;i=new Array(r);s=new Array(r);for(t=0;t<r;++t){s[t]=+e(a[t],t,a);i[t]=isNaN(s[t])?0:+n(a[t],t,a)}}l.initialize=function(e){a=e,u()};l.strength=function(e){return arguments.length?(n=typeof e==="function"?e:o(+e),u(),l):n};l.radius=function(t){return arguments.length?(e=typeof t==="function"?t:o(+t),u(),l):e};l.x=function(e){return arguments.length?(t=+e,l):t};l.y=function(e){return arguments.length?(r=+e,l):r};return l}function _(e){var t=o(.1),r,a,n;if(typeof e!=="function")e=o(e==null?0:+e);function i(e){for(var t=0,i=r.length,o;t<i;++t){o=r[t],o.vx+=(n[t]-o.x)*a[t]*e}}function s(){if(!r)return;var i,o=r.length;a=new Array(o);n=new Array(o);for(i=0;i<o;++i){a[i]=isNaN(n[i]=+e(r[i],i,r))?0:+t(r[i],i,r)}}i.initialize=function(e){r=e;s()};i.strength=function(e){return arguments.length?(t=typeof e==="function"?e:o(+e),s(),i):t};i.x=function(t){return arguments.length?(e=typeof t==="function"?t:o(+t),s(),i):e};return i}function w(e){var t=o(.1),r,a,n;if(typeof e!=="function")e=o(e==null?0:+e);function i(e){for(var t=0,i=r.length,o;t<i;++t){o=r[t],o.vy+=(n[t]-o.y)*a[t]*e}}function s(){if(!r)return;var i,o=r.length;a=new Array(o);n=new Array(o);for(i=0;i<o;++i){a[i]=isNaN(n[i]=+e(r[i],i,r))?0:+t(r[i],i,r)}}i.initialize=function(e){r=e;s()};i.strength=function(e){return arguments.length?(t=typeof e==="function"?e:o(+e),s(),i):t};i.y=function(t){return arguments.length?(e=typeof t==="function"?t:o(+t),s(),i):e};return i}e.forceCenter=i;e.forceCollide=c;e.forceLink=p;e.forceManyBody=x;e.forceRadial=b;e.forceSimulation=y;e.forceX=_;e.forceY=w;Object.defineProperty(e,"__esModule",{value:true})}))},{"d3-collection":160,"d3-dispatch":162,"d3-quadtree":170,"d3-timer":175}],164:[function(t,r,a){(function(t,n){typeof a==="object"&&typeof r!=="undefined"?n(a):typeof e==="function"&&e.amd?e(["exports"],n):(t=typeof globalThis!=="undefined"?globalThis:t||self,n(t.d3=t.d3||{}))})(this,(function(e){"use strict";function t(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function r(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,a=e.slice(0,r);return[a.length>1?a[0]+a.slice(2):a,+e.slice(r+1)]}function a(e){return e=r(Math.abs(e)),e?e[1]:NaN}function n(e,t){return function(r,a){var n=r.length,i=[],o=0,s=e[0],l=0;while(n>0&&s>0){if(l+s+1>a)s=Math.max(1,a-l);i.push(r.substring(n-=s,n+s));if((l+=s+1)>a)break;s=e[o=(o+1)%e.length]}return i.reverse().join(t)}}function i(e){return function(t){return t.replace(/[0-9]/g,(function(t){return e[+t]}))}}var o=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function s(e){if(!(t=o.exec(e)))throw new Error("invalid format: "+e);var t;return new l({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}s.prototype=l.prototype;function l(e){this.fill=e.fill===undefined?" ":e.fill+"";this.align=e.align===undefined?">":e.align+"";this.sign=e.sign===undefined?"-":e.sign+"";this.symbol=e.symbol===undefined?"":e.symbol+"";this.zero=!!e.zero;this.width=e.width===undefined?undefined:+e.width;this.comma=!!e.comma;this.precision=e.precision===undefined?undefined:+e.precision;this.trim=!!e.trim;this.type=e.type===undefined?"":e.type+""}l.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===undefined?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===undefined?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function u(e){e:for(var t=e.length,r=1,a=-1,n;r<t;++r){switch(e[r]){case".":a=n=r;break;case"0":if(a===0)a=r;n=r;break;default:if(!+e[r])break e;if(a>0)a=0;break}}return a>0?e.slice(0,a)+e.slice(n+1):e}var c;function f(e,t){var a=r(e,t);if(!a)return e+"";var n=a[0],i=a[1],o=i-(c=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,s=n.length;return o===s?n:o>s?n+new Array(o-s+1).join("0"):o>0?n.slice(0,o)+"."+n.slice(o):"0."+new Array(1-o).join("0")+r(e,Math.max(0,t+o-1))[0]}function h(e,t){var a=r(e,t);if(!a)return e+"";var n=a[0],i=a[1];return i<0?"0."+new Array(-i).join("0")+n:n.length>i+1?n.slice(0,i+1)+"."+n.slice(i+1):n+new Array(i-n.length+2).join("0")}var p={"%":function(e,t){return(e*100).toFixed(t)},b:function(e){return Math.round(e).toString(2)},c:function(e){return e+""},d:t,e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},g:function(e,t){return e.toPrecision(t)},o:function(e){return Math.round(e).toString(8)},p:function(e,t){return h(e*100,t)},r:h,s:f,X:function(e){return Math.round(e).toString(16).toUpperCase()},x:function(e){return Math.round(e).toString(16)}};function v(e){return e}var d=Array.prototype.map,m=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function g(e){var t=e.grouping===undefined||e.thousands===undefined?v:n(d.call(e.grouping,Number),e.thousands+""),r=e.currency===undefined?"":e.currency[0]+"",o=e.currency===undefined?"":e.currency[1]+"",l=e.decimal===undefined?".":e.decimal+"",f=e.numerals===undefined?v:i(d.call(e.numerals,String)),h=e.percent===undefined?"%":e.percent+"",g=e.minus===undefined?"-":e.minus+"",y=e.nan===undefined?"NaN":e.nan+"";function x(e){e=s(e);var a=e.fill,n=e.align,i=e.sign,v=e.symbol,d=e.zero,x=e.width,b=e.comma,_=e.precision,w=e.trim,T=e.type;if(T==="n")b=true,T="g";else if(!p[T])_===undefined&&(_=12),w=true,T="g";if(d||a==="0"&&n==="=")d=true,a="0",n="=";var k=v==="$"?r:v==="#"&&/[boxX]/.test(T)?"0"+T.toLowerCase():"",M=v==="$"?o:/[%p]/.test(T)?h:"";var A=p[T],S=/[defgprs%]/.test(T);_=_===undefined?6:/[gprs]/.test(T)?Math.max(1,Math.min(21,_)):Math.max(0,Math.min(20,_));function E(e){var r=k,o=M,s,h,p;if(T==="c"){o=A(e)+o;e=""}else{e=+e;var v=e<0||1/e<0;e=isNaN(e)?y:A(Math.abs(e),_);if(w)e=u(e);if(v&&+e===0&&i!=="+")v=false;r=(v?i==="("?i:g:i==="-"||i==="("?"":i)+r;o=(T==="s"?m[8+c/3]:"")+o+(v&&i==="("?")":"");if(S){s=-1,h=e.length;while(++s<h){if(p=e.charCodeAt(s),48>p||p>57){o=(p===46?l+e.slice(s+1):e.slice(s))+o;e=e.slice(0,s);break}}}}if(b&&!d)e=t(e,Infinity);var E=r.length+e.length+o.length,L=E<x?new Array(x-E+1).join(a):"";if(b&&d)e=t(L+e,L.length?x-o.length:Infinity),L="";switch(n){case"<":e=r+e+o+L;break;case"=":e=r+L+e+o;break;case"^":e=L.slice(0,E=L.length>>1)+r+e+o+L.slice(E);break;default:e=L+r+e+o;break}return f(e)}E.toString=function(){return e+""};return E}function b(e,t){var r=x((e=s(e),e.type="f",e)),n=Math.max(-8,Math.min(8,Math.floor(a(t)/3)))*3,i=Math.pow(10,-n),o=m[8+n/3];return function(e){return r(i*e)+o}}return{format:x,formatPrefix:b}}var y;x({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"});function x(t){y=g(t);e.format=y.format;e.formatPrefix=y.formatPrefix;return y}function b(e){return Math.max(0,-a(Math.abs(e)))}function _(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(a(t)/3)))*3-a(Math.abs(e)))}function w(e,t){e=Math.abs(e),t=Math.abs(t)-e;return Math.max(0,a(t)-a(e))+1}e.FormatSpecifier=l;e.formatDefaultLocale=x;e.formatLocale=g;e.formatSpecifier=s;e.precisionFixed=b;e.precisionPrefix=_;e.precisionRound=w;Object.defineProperty(e,"__esModule",{value:true})}))},{}],165:[function(t,r,a){(function(n,i){typeof a==="object"&&typeof r!=="undefined"?i(a,t("d3-geo"),t("d3-array")):typeof e==="function"&&e.amd?e(["exports","d3-geo","d3-array"],i):i(n.d3=n.d3||{},n.d3,n.d3)})(this,(function(e,t,r){"use strict";var a=Math.abs;var n=Math.atan;var i=Math.atan2;var o=Math.cos;var s=Math.exp;var l=Math.floor;var u=Math.log;var c=Math.max;var f=Math.min;var h=Math.pow;var p=Math.round;var v=Math.sign||function(e){return e>0?1:e<0?-1:0};var d=Math.sin;var m=Math.tan;var g=1e-6;var y=1e-12;var x=Math.PI;var b=x/2;var _=x/4;var w=Math.SQRT1_2;var T=I(2);var k=I(x);var M=x*2;var A=180/x;var S=x/180;function E(e){return e?e/Math.sin(e):1}function L(e){return e>1?b:e<-1?-b:Math.asin(e)}function C(e){return e>1?0:e<-1?x:Math.acos(e)}function I(e){return e>0?Math.sqrt(e):0}function P(e){e=s(2*e);return(e-1)/(e+1)}function O(e){return(s(e)-s(-e))/2}function z(e){return(s(e)+s(-e))/2}function D(e){return u(e+I(e*e+1))}function R(e){return u(e+I(e*e-1))}function F(e){var t=m(e/2),r=2*u(o(e/2))/(t*t);function n(e,t){var a=o(e),n=o(t),i=d(t),s=n*a,l=-((1-s?u((1+s)/2)/(1-s):-.5)+r/(1+s));return[l*n*d(e),l*i]}n.invert=function(t,n){var s=I(t*t+n*n),l=-e/2,c=50,f;if(!s)return[0,0];do{var h=l/2,p=o(h),v=d(h),m=v/p,y=-u(a(p));l-=f=(2/m*y-r*m-s)/(-y/(v*v)+1-r/(2*p*p))*(p<0?.7:1)}while(a(f)>g&&--c>0);var x=d(l);return[i(t*x,s*o(l)),L(n*x/s)]};return n}function B(){var e=b,r=t.geoProjectionMutator(F),a=r(e);a.radius=function(t){return arguments.length?r(e=t*S):e*A};return a.scale(179.976).clipAngle(147)}function N(e,t){var r=o(t),a=E(C(r*o(e/=2)));return[2*r*d(e)*a,d(t)*a]}N.invert=function(e,t){if(e*e+4*t*t>x*x+g)return;var r=e,n=t,i=25;do{var s=d(r),l=d(r/2),u=o(r/2),c=d(n),f=o(n),h=d(2*n),p=c*c,v=f*f,m=l*l,y=1-v*u*u,b=y?C(f*u)*I(_=1/y):_=0,_,w=2*b*f*l-e,T=b*c-t,k=_*(v*m+b*f*u*p),M=_*(.5*s*h-b*2*c*l),A=_*.25*(h*l-b*c*v*s),S=_*(p*u+b*m*f),E=M*A-S*k;if(!E)break;var L=(T*M-w*S)/E,P=(w*A-T*k)/E;r-=L,n-=P}while((a(L)>g||a(P)>g)&&--i>0);return[r,n]};function j(){return t.geoProjection(N).scale(152.63)}function U(e){var t=d(e),r=o(e),n=e>=0?1:-1,s=m(n*e),l=(1+t-r)/2;function u(e,a){var u=o(a),c=o(e/=2);return[(1+u)*d(e),(n*a>-i(c,s)-.001?0:-n*10)+l+d(a)*r-(1+u)*t*c]}u.invert=function(e,u){var c=0,f=0,h=50;do{var p=o(c),v=d(c),m=o(f),y=d(f),x=1+m,b=x*v-e,_=l+y*r-x*t*p-u,w=x*p/2,T=-v*y,k=t*x*v/2,M=r*m+t*p*y,A=T*k-M*w,S=(_*T-b*M)/A/2,E=(b*k-_*w)/A;if(a(E)>2)E/=2;c-=S,f-=E}while((a(S)>g||a(E)>g)&&--h>0);return n*f>-i(o(c),s)-.001?[c*2,f]:null};return u}function V(){var e=20*S,r=e>=0?1:-1,a=m(r*e),n=t.geoProjectionMutator(U),s=n(e),l=s.stream;s.parallel=function(t){if(!arguments.length)return e*A;a=m((r=(e=t*S)>=0?1:-1)*e);return n(e)};s.stream=function(t){var n=s.rotate(),u=l(t),c=(s.rotate([0,0]),l(t)),f=s.precision();s.rotate(n);u.sphere=function(){c.polygonStart(),c.lineStart();for(var t=r*-180;r*t<180;t+=r*90)c.point(t,r*90);if(e)while(r*(t-=3*r*f)>=-180){c.point(t,r*-i(o(t*S/2),a)*A)}c.lineEnd(),c.polygonEnd()};return u};return s.scale(218.695).center([0,28.0974])}function H(e,t){var r=m(t/2),a=I(1-r*r),n=1+a*o(e/=2),i=d(e)*a/n,s=r/n,l=i*i,u=s*s;return[4/3*i*(3+l-3*u),4/3*s*(3+3*l-u)]}H.invert=function(e,t){e*=3/8,t*=3/8;if(!e&&a(t)>1)return null;var r=e*e,n=t*t,s=1+r+n,l=I((s-I(s*s-4*t*t))/2),u=L(l)/3,c=l?R(a(t/l))/3:D(a(e))/3,f=o(u),h=z(c),p=h*h-f*f;return[v(e)*2*i(O(c)*f,.25-p),v(t)*2*i(h*d(u),.25+p)]};function q(){return t.geoProjection(H).scale(66.1603)}var G=I(8),Y=u(1+T);function W(e,t){var r=a(t);return r<_?[e,u(m(_+t/2))]:[e*o(r)*(2*T-1/d(r)),v(t)*(2*T*(r-_)-u(m(r/2)))]}W.invert=function(e,t){if((c=a(t))<Y)return[e,2*n(s(t))-b];var r=_,i=25,l,c;do{var f=o(r/2),h=m(r/2);r-=l=(G*(r-_)-u(h)-c)/(G-f*f/(2*h))}while(a(l)>y&&--i>0);return[e/(o(r)*(G-1/d(r))),v(t)*r]};function X(){return t.geoProjection(W).scale(112.314)}function Z(e){var r=2*x/e;function s(e,n){var s=t.geoAzimuthalEquidistantRaw(e,n);if(a(e)>b){var l=i(s[1],s[0]),u=I(s[0]*s[0]+s[1]*s[1]),c=r*p((l-b)/r)+b,f=i(d(l-=c),2-o(l));l=c+L(x/u*d(f))-f;s[0]=u*o(l);s[1]=u*d(l)}return s}s.invert=function(e,a){var s=I(e*e+a*a);if(s>b){var l=i(a,e),u=r*p((l-b)/r)+b,c=l>u?-1:1,f=s*o(u-l),h=1/m(c*C((f-x)/I(x*(x-2*f)+s*s)));l=u+2*n((h+c*I(h*h-3))/3);e=s*o(l),a=s*d(l)}return t.geoAzimuthalEquidistantRaw.invert(e,a)};return s}function J(){var e=5,r=t.geoProjectionMutator(Z),a=r(e),n=a.stream,s=.01,l=-o(s*S),u=d(s*S);a.lobes=function(t){return arguments.length?r(e=+t):e};a.stream=function(t){var r=a.rotate(),c=n(t),f=(a.rotate([0,0]),n(t));a.rotate(r);c.sphere=function(){f.polygonStart(),f.lineStart();for(var t=0,r=360/e,a=2*x/e,n=90-180/e,c=b;t<e;++t,n-=r,c-=a){f.point(i(u*o(c),l)*A,L(u*d(c))*A);if(n<-90){f.point(-90,-180-n-s);f.point(-90,-180-n+s)}else{f.point(90,n+s);f.point(90,n-s)}}f.lineEnd(),f.polygonEnd()};return c};return a.scale(87.8076).center([0,17.1875]).clipAngle(180-.001)}function K(e,r){if(arguments.length<2)r=e;if(r===1)return t.geoAzimuthalEqualAreaRaw;if(r===Infinity)return Q;function a(a,n){var i=t.geoAzimuthalEqualAreaRaw(a/r,n);i[0]*=e;return i}a.invert=function(a,n){var i=t.geoAzimuthalEqualAreaRaw.invert(a/e,n);i[0]*=r;return i};return a}function Q(e,t){return[e*o(t)/o(t/=2),2*d(t)]}Q.invert=function(e,t){var r=2*L(t/2);return[e*o(r/2)/o(r),r]};function $(){var e=2,r=t.geoProjectionMutator(K),a=r(e);a.coefficient=function(t){if(!arguments.length)return e;return r(e=+t)};return a.scale(169.529)}function ee(e,t,r){var n=100,i,o,s;r=r===undefined?0:+r;t=+t;do{o=e(r);s=e(r+g);if(o===s)s=o+g;r-=i=-1*g*(o-t)/(o-s)}while(n-- >0&&a(i)>g);return n<0?NaN:r}function te(e,t,r){if(t===undefined)t=40;if(r===undefined)r=y;return function(n,i,o,s){var l,u,c;o=o===undefined?0:+o;s=s===undefined?0:+s;for(var f=0;f<t;f++){var h=e(o,s),p=h[0]-n,v=h[1]-i;if(a(p)<r&&a(v)<r)break;var d=p*p+v*v;if(d>l){o-=u/=2;s-=c/=2;continue}l=d;var m=(o>0?-1:1)*r,g=(s>0?-1:1)*r,y=e(o+m,s),x=e(o,s+g),b=(y[0]-h[0])/m,_=(y[1]-h[1])/m,w=(x[0]-h[0])/g,T=(x[1]-h[1])/g,k=T*b-_*w,M=(a(k)<.5?.5:1)/k;u=(v*w-p*T)*M;c=(p*_-v*b)*M;o+=u;s+=c;if(a(u)<r&&a(c)<r)break}return[o,s]}}function re(){var e=K(1.68,2),t=1.4,r=12;function a(a,n){if(a+n<-t){var i=(a-n+1.6)*(a+n+t)/8;a+=i;n-=.8*i*d(n+x/2)}var s=e(a,n);var l=(1-o(a*n))/r;if(s[1]<0){s[0]*=1+l}if(s[1]>0){s[1]*=1+l/1.5*s[0]*s[0]}return s}a.invert=te(a);return a}function ae(){return t.geoProjection(re()).rotate([-16.5,-42]).scale(176.57).center([7.93,.09])}function ne(e,t){var r=e*d(t),n=30,i;do{t-=i=(t+d(t)-r)/(1+o(t))}while(a(i)>g&&--n>0);return t/2}function ie(e,t,r){function a(a,n){return[e*a*o(n=ne(r,n)),t*d(n)]}a.invert=function(a,n){return n=L(n/t),[a/(e*o(n)),L((2*n+d(2*n))/r)]};return a}var oe=ie(T/b,T,x);function se(){return t.geoProjection(oe).scale(169.529)}var le=2.00276,ue=1.11072;function ce(e,t){var r=ne(x,t);return[le*e/(1/o(t)+ue/o(r)),(t+T*d(r))/le]}ce.invert=function(e,t){var r=le*t,n=t<0?-_:_,i=25,s,l;do{l=r-T*d(n);n-=s=(d(2*n)+2*n-x*d(l))/(2*o(2*n)+2+x*o(l)*T*o(n))}while(a(s)>g&&--i>0);l=r-T*d(n);return[e*(1/o(l)+ue/o(n))/le,l]};function fe(){return t.geoProjection(ce).scale(160.857)}function he(e){var r=0,a=t.geoProjectionMutator(e),n=a(r);n.parallel=function(e){return arguments.length?a(r=e*S):r*A};return n}function pe(e,t){return[e*o(t),t]}pe.invert=function(e,t){return[e/o(t),t]};function ve(){return t.geoProjection(pe).scale(152.63)}function de(e){if(!e)return pe;var t=1/m(e);function r(r,a){var n=t+e-a,i=n?r*o(a)/n:n;return[n*d(i),t-n*o(i)]}r.invert=function(r,a){var n=I(r*r+(a=t-a)*a),s=t+e-n;return[n/o(s)*i(r,a),s]};return r}function me(){return he(de).scale(123.082).center([0,26.1441]).parallel(45)}function ge(e){function t(t,r){var a=b-r,n=a?t*e*d(a)/a:a;return[a*d(n)/e,b-a*o(n)]}t.invert=function(t,r){var a=t*e,n=b-r,o=I(a*a+n*n),s=i(a,n);return[(o?o/d(o):1)*s/e,b-o]};return t}function ye(){var e=.5,r=t.geoProjectionMutator(ge),a=r(e);a.fraction=function(t){return arguments.length?r(e=+t):e};return a.scale(158.837)}var xe=ie(1,4/x,x);function be(){return t.geoProjection(xe).scale(152.63)}function _e(e,t,r,n,s,l){var u=o(l),c;if(a(e)>1||a(l)>1){c=C(r*s+t*n*u)}else{var f=d(e/2),h=d(l/2);c=2*L(I(f*f+t*n*h*h))}return a(c)>g?[c,i(n*d(l),t*s-r*n*u)]:[0,0]}function we(e,t,r){return C((e*e+t*t-r*r)/(2*e*t))}function Te(e){return e-2*x*l((e+x)/(2*x))}function ke(e,t,r){var a=[[e[0],e[1],d(e[1]),o(e[1])],[t[0],t[1],d(t[1]),o(t[1])],[r[0],r[1],d(r[1]),o(r[1])]];for(var n=a[2],i,s=0;s<3;++s,n=i){i=a[s];n.v=_e(i[1]-n[1],n[3],n[2],i[3],i[2],i[0]-n[0]);n.point=[0,0]}var l=we(a[0].v[0],a[2].v[0],a[1].v[0]),u=we(a[0].v[0],a[1].v[0],a[2].v[0]),c=x-l;a[2].point[1]=0;a[0].point[0]=-(a[1].point[0]=a[0].v[0]/2);var f=[a[2].point[0]=a[0].point[0]+a[2].v[0]*o(l),2*(a[0].point[1]=a[1].point[1]=a[2].v[0]*d(l))];function h(e,t){var r=d(t),n=o(t),i=new Array(3),s;for(s=0;s<3;++s){var l=a[s];i[s]=_e(t-l[1],l[3],l[2],n,r,e-l[0]);if(!i[s][0])return l.point;i[s][1]=Te(i[s][1]-l.v[1])}var h=f.slice();for(s=0;s<3;++s){var p=s==2?0:s+1;var v=we(a[s].v[0],i[s][0],i[p][0]);if(i[s][1]<0)v=-v;if(!s){h[0]+=i[s][0]*o(v);h[1]-=i[s][0]*d(v)}else if(s==1){v=u-v;h[0]-=i[s][0]*o(v);h[1]-=i[s][0]*d(v)}else{v=c-v;h[0]+=i[s][0]*o(v);h[1]+=i[s][0]*d(v)}}h[0]/=3,h[1]/=3;return h}return h}function Me(e){return e[0]*=S,e[1]*=S,e}function Ae(){return Se([0,22],[45,22],[22.5,-22]).scale(380).center([22.5,2])}function Se(e,r,a){var n=t.geoCentroid({type:"MultiPoint",coordinates:[e,r,a]}),i=[-n[0],-n[1]],o=t.geoRotation(i),s=ke(Me(o(e)),Me(o(r)),Me(o(a)));s.invert=te(s);var l=t.geoProjection(s).rotate(i),u=l.center;delete l.rotate;l.center=function(e){return arguments.length?u(o(e)):o.invert(u())};return l.clipAngle(90)}function Ee(e,t){var r=I(1-d(t));return[2/k*e*r,k*(1-r)]}Ee.invert=function(e,t){var r=(r=t/k-1)*r;return[r>0?e*I(x/r)/2:0,L(1-r)]};function Le(){return t.geoProjection(Ee).scale(95.6464).center([0,30])}function Ce(e){var t=m(e);function r(e,r){return[e,(e?e/d(e):1)*(d(r)*o(e)-t*o(r))]}r.invert=t?function(e,r){if(e)r*=d(e)/e;var a=o(e);return[e,2*i(I(a*a+t*t-r*r)-a,t-r)]}:function(e,t){return[e,L(e?t*m(e)/e:t)]};return r}function Ie(){return he(Ce).scale(249.828).clipAngle(90)}var Pe=I(3);function Oe(e,t){return[Pe*e*(2*o(2*t/3)-1)/k,Pe*k*d(t/3)]}Oe.invert=function(e,t){var r=3*L(t/(Pe*k));return[k*e/(Pe*(2*o(2*r/3)-1)),r]};function ze(){return t.geoProjection(Oe).scale(156.19)}function De(e){var t=o(e);function r(e,r){return[e*t,d(r)/t]}r.invert=function(e,r){return[e/t,L(r*t)]};return r}function Re(){return he(De).parallel(38.58).scale(195.044)}function Fe(e){var t=o(e);function r(e,r){return[e*t,(1+t)*m(r/2)]}r.invert=function(e,r){return[e/t,n(r/(1+t))*2]};return r}function Be(){return he(Fe).scale(124.75)}function Ne(e,t){var r=I(8/(3*x));return[r*e*(1-a(t)/x),r*t]}Ne.invert=function(e,t){var r=I(8/(3*x)),n=t/r;return[e/(r*(1-a(n)/x)),n]};function je(){return t.geoProjection(Ne).scale(165.664)}function Ue(e,t){var r=I(4-3*d(a(t)));return[2/I(6*x)*e*r,v(t)*I(2*x/3)*(2-r)]}Ue.invert=function(e,t){var r=2-a(t)/I(2*x/3);return[e*I(6*x)/(2*r),v(t)*L((4-r*r)/3)]};function Ve(){return t.geoProjection(Ue).scale(165.664)}function He(e,t){var r=I(x*(4+x));return[2/r*e*(1+I(1-4*t*t/(x*x))),4/r*t]}He.invert=function(e,t){var r=I(x*(4+x))/2;return[e*r/(1+I(1-t*t*(4+x)/(4*x))),t*r/2]};function qe(){return t.geoProjection(He).scale(180.739)}function Ge(e,t){var r=(2+b)*d(t);t/=2;for(var n=0,i=Infinity;n<10&&a(i)>g;n++){var s=o(t);t-=i=(t+d(t)*(s+2)-r)/(2*s*(1+s))}return[2/I(x*(4+x))*e*(1+o(t)),2*I(x/(4+x))*d(t)]}Ge.invert=function(e,t){var r=t*I((4+x)/x)/2,a=L(r),n=o(a);return[e/(2/I(x*(4+x))*(1+n)),L((a+r*(n+2))/(2+b))]};function Ye(){return t.geoProjection(Ge).scale(180.739)}function We(e,t){return[e*(1+o(t))/I(2+x),2*t/I(2+x)]}We.invert=function(e,t){var r=I(2+x),a=t*r/2;return[r*e/(1+o(a)),a]};function Xe(){return t.geoProjection(We).scale(173.044)}function Ze(e,t){var r=(1+b)*d(t);for(var n=0,i=Infinity;n<10&&a(i)>g;n++){t-=i=(t+d(t)-r)/(1+o(t))}r=I(2+x);return[e*(1+o(t))/r,2*t/r]}Ze.invert=function(e,t){var r=1+b,a=I(r/2);return[e*2*a/(1+o(t*=a)),L((t+d(t))/r)]};function Je(){return t.geoProjection(Ze).scale(173.044)}var Ke=3+2*T;function Qe(e,t){var r=d(e/=2),a=o(e),i=I(o(t)),s=o(t/=2),l=d(t)/(s+T*a*i),c=I(2/(1+l*l)),f=I((T*s+(a+r)*i)/(T*s+(a-r)*i));return[Ke*(c*(f-1/f)-2*u(f)),Ke*(c*l*(f+1/f)-2*n(l))]}Qe.invert=function(e,t){if(!(l=H.invert(e/1.2,t*1.065)))return null;var r=l[0],i=l[1],s=20,l;e/=Ke,t/=Ke;do{var h=r/2,p=i/2,v=d(h),m=o(h),y=d(p),x=o(p),_=o(i),k=I(_),M=y/(x+T*m*k),A=M*M,S=I(2/(1+A)),E=T*x+(m+v)*k,L=T*x+(m-v)*k,C=E/L,P=I(C),O=P-1/P,z=P+1/P,D=S*O-2*u(P)-e,R=S*M*z-2*n(M)-t,F=y&&w*k*v*A/y,B=(T*m*x+k)/(2*(x+T*m*k)*(x+T*m*k)*k),N=-.5*M*S*S*S,j=N*F,U=N*B,V=(V=2*x+T*k*(m-v))*V*P,q=(T*m*x*k+_)/V,G=-(T*v*y)/(k*V),Y=O*j-2*q/P+S*(q+q/C),W=O*U-2*G/P+S*(G+G/C),X=M*z*j-2*F/(1+A)+S*z*F+S*M*(q-q/C),Z=M*z*U-2*B/(1+A)+S*z*B+S*M*(G-G/C),J=W*X-Z*Y;if(!J)break;var K=(R*W-D*Z)/J,Q=(D*X-R*Y)/J;r-=K;i=c(-b,f(b,i-Q))}while((a(K)>g||a(Q)>g)&&--s>0);return a(a(i)-b)<g?[0,i]:s&&[r,i]};function $e(){return t.geoProjection(Qe).scale(62.5271)}var et=o(35*S);function tt(e,t){var r=m(t/2);return[e*et*I(1-r*r),(1+et)*r]}tt.invert=function(e,t){var r=t/(1+et);return[e&&e/(et*I(1-r*r)),2*n(r)]};function rt(){return t.geoProjection(tt).scale(137.152)}function at(e,t){var r=t/2,a=o(r);return[2*e/k*o(t)*a*a,k*m(r)]}at.invert=function(e,t){var r=n(t/k),a=o(r),i=2*r;return[e*k/2/(o(i)*a*a),i]};function nt(){return t.geoProjection(at).scale(135.264)}function it(e){var t=1-e,r=i(x,0)[0]-i(-x,0)[0],a=i(0,b)[1]-i(0,-b)[1],n=I(2*a/r);function i(r,a){var n=o(a),i=d(a);return[n/(t+e*n)*r,t*a+e*i]}function s(e,t){var r=i(e,t);return[r[0]*n,r[1]/n]}function l(e){return s(0,e)[1]}s.invert=function(r,a){var i=ee(l,a),s=r/n*(e+t/o(i));return[s,i]};return s}function ot(){var e=.5,r=t.geoProjectionMutator(it),a=r(e);a.alpha=function(t){return arguments.length?r(e=+t):e};return a.scale(168.725)}function st(e){return[e[0]/2,L(m(e[1]/2*S))*A]}function lt(e){return[e[0]*2,2*n(d(e[1]*S))*A]}function ut(e){if(e==null)e=t.geoOrthographic;var r=e(),a=t.geoEquirectangular().scale(A).precision(0).clipAngle(null).translate([0,0]);function n(e){return r(st(e))}if(r.invert)n.invert=function(e){return lt(r.invert(e))};n.stream=function(e){var t=r.stream(e),n=a.stream({point:function(e,r){t.point(e/2,L(m(-r/2*S))*A)},lineStart:function(){t.lineStart()},lineEnd:function(){t.lineEnd()},polygonStart:function(){t.polygonStart()},polygonEnd:function(){t.polygonEnd()}});n.sphere=t.sphere;return n};function i(e){n[e]=function(){return arguments.length?(r[e].apply(r,arguments),n):r[e]()}}n.rotate=function(e){return arguments.length?(a.rotate(e),n):a.rotate()};n.center=function(e){return arguments.length?(r.center(st(e)),n):lt(r.center())};i("angle");i("clipAngle");i("clipExtent");i("fitExtent");i("fitHeight");i("fitSize");i("fitWidth");i("scale");i("translate");i("precision");return n.scale(249.5)}function ct(e,r){var n=2*x/r,s=e*e;function l(r,l){var u=t.geoAzimuthalEquidistantRaw(r,l),c=u[0],f=u[1],h=c*c+f*f;if(h>s){var v=I(h),m=i(f,c),y=n*p(m/n),_=m-y,w=e*o(_),T=(e*d(_)-_*d(w))/(b-w),k=ft(_,T),M=(x-e)/ht(k,w,x);c=v;var A=50,S;do{c-=S=(e+ht(k,w,c)*M-v)/(k(c)*M)}while(a(S)>g&&--A>0);f=_*d(c);if(c<b)f-=T*(c-b);var E=d(y),L=o(y);u[0]=c*L-f*E;u[1]=c*E+f*L}return u}l.invert=function(r,l){var u=r*r+l*l;if(u>s){var c=I(u),f=i(l,r),h=n*p(f/n),v=f-h;r=c*o(v);l=c*d(v);var m=r-b,g=d(r),_=l/g,w=r<b?Infinity:0,T=10;while(true){var k=e*d(_),M=e*o(_),A=d(M),S=b-M,E=(k-_*A)/S,L=ft(_,E);if(a(w)<y||!--T)break;_-=w=(_*g-E*m-l)/(g-m*2*(S*(M+_*k*o(M)-A)-k*(k-_*A))/(S*S))}c=e+ht(L,M,r)*(x-e)/ht(L,M,x);f=h+_;r=c*o(f);l=c*d(f)}return t.geoAzimuthalEquidistantRaw.invert(r,l)};return l}function ft(e,t){return function(r){var a=e*o(r);if(r<b)a-=t;return I(1+a*a)}}function ht(e,t,r){var a=50,n=(r-t)/a,i=e(t)+e(r);for(var o=1,s=t;o<a;++o)i+=2*e(s+=n);return i*.5*n}function pt(){var e=6,r=30*S,a=o(r),n=d(r),s=t.geoProjectionMutator(ct),l=s(r,e),u=l.stream,c=.01,f=-o(c*S),h=d(c*S);l.radius=function(t){if(!arguments.length)return r*A;a=o(r=t*S);n=d(r);return s(r,e)};l.lobes=function(t){if(!arguments.length)return e;return s(r,e=+t)};l.stream=function(t){var r=l.rotate(),s=u(t),c=(l.rotate([0,0]),u(t));l.rotate(r);s.sphere=function(){c.polygonStart(),c.lineStart();for(var t=0,r=2*x/e,s=0;t<e;++t,s-=r){c.point(i(h*o(s),f)*A,L(h*d(s))*A);c.point(i(n*o(s-r/2),a)*A,L(n*d(s-r/2))*A)}c.lineEnd(),c.polygonEnd()};return s};return l.rotate([90,-40]).scale(91.7095).clipAngle(180-.001)}function vt(e,t,r,n,i,s,l,u){if(arguments.length<8)u=0;function c(a,c){if(!c)return[e*a/x,0];var f=c*c,h=e+f*(t+f*(r+f*n)),p=c*(i-1+f*(s-u+f*l)),v=(h*h+p*p)/(2*p),m=a*L(h/v)/x;return[v*d(m),c*(1+f*u)+v*(1-o(m))]}c.invert=function(c,f){var h=x*c/e,p=f,v,m,y=50;do{var b=p*p,_=e+b*(t+b*(r+b*n)),w=p*(i-1+b*(s-u+b*l)),T=_*_+w*w,k=2*w,M=T/k,A=M*M,S=L(_/M)/x,E=h*S,C=_*_,P=(2*t+b*(4*r+b*6*n))*p,O=i+b*(3*s+b*5*l),z=2*(_*P+w*(O-1)),D=2*(O-1),R=(z*k-T*D)/(k*k),F=o(E),B=d(E),N=M*F,j=M*B,U=h/x*(1/I(1-C/A))*(P*M-_*R)/A,V=j-c,H=p*(1+b*u)+M-N-f,q=R*B+N*U,G=N*S,Y=1+R-(R*F-j*U),W=j*S,X=q*W-Y*G;if(!X)break;h-=v=(H*q-V*Y)/X;p-=m=(V*W-H*G)/X}while((a(v)>g||a(m)>g)&&--y>0);return[h,p]};return c}var dt=vt(2.8284,-1.6988,.75432,-.18071,1.76003,-.38914,.042555);function mt(){return t.geoProjection(dt).scale(149.995)}var gt=vt(2.583819,-.835827,.170354,-.038094,1.543313,-.411435,.082742);function yt(){return t.geoProjection(gt).scale(153.93)}var xt=vt(5/6*x,-.62636,-.0344,0,1.3493,-.05524,0,.045);function bt(){return t.geoProjection(xt).scale(130.945)}function _t(e,t){var r=e*e,a=t*t;return[e*(1-.162388*a)*(.87-952426e-9*r*r),t*(1+a/12)]}_t.invert=function(e,t){var r=e,n=t,i=50,o;do{var s=n*n;n-=o=(n*(1+s/12)-t)/(1+s/4)}while(a(o)>g&&--i>0);i=50;e/=1-.162388*s;do{var l=(l=r*r)*l;r-=o=(r*(.87-952426e-9*l)-e)/(.87-.00476213*l)}while(a(o)>g&&--i>0);return[r,n]};function wt(){return t.geoProjection(_t).scale(131.747)}var Tt=vt(2.6516,-.76534,.19123,-.047094,1.36289,-.13965,.031762);function kt(){return t.geoProjection(Tt).scale(131.087)}function Mt(e){var t=e(b,0)[0]-e(-b,0)[0];function r(r,a){var n=r>0?-.5:.5,i=e(r+n*x,a);i[0]-=n*t;return i}if(e.invert)r.invert=function(r,a){var n=r>0?-.5:.5,i=e.invert(r+n*t,a),o=i[0]-n*x;if(o<-x)o+=2*x;else if(o>x)o-=2*x;i[0]=o;return i};return r}function At(e,t){var r=v(e),n=v(t),s=o(t),l=o(e)*s,u=d(e)*s,c=d(n*t);e=a(i(u,c));t=L(l);if(a(e-b)>g)e%=b;var f=St(e>x/4?b-e:e,t);if(e>x/4)c=f[0],f[0]=-f[1],f[1]=-c;return f[0]*=r,f[1]*=-n,f}At.invert=function(e,t){if(a(e)>1)e=v(e)*2-e;if(a(t)>1)t=v(t)*2-t;var r=v(e),n=v(t),s=-r*e,l=-n*t,u=l/s<1,c=Et(u?l:s,u?s:l),f=c[0],h=c[1],p=o(h);if(u)f=-b-f;return[r*(i(d(f)*p,-d(h))+x),n*L(o(f)*p)]};function St(e,t){if(t===b)return[0,0];var r=d(t),n=r*r,i=n*n,s=1+i,l=1+3*i,u=1-i,c=L(1/I(s)),f=u+n*s*c,h=(1-r)/f,p=I(h),v=h*s,m=I(v),y=p*u,_,w;if(e===0)return[0,-(y+n*m)];var T=o(t),k=1/T,M=2*r*T,A=(-3*n+c*l)*M,S=(-f*T-(1-r)*A)/(f*f),E=.5*S/p,C=u*E-2*n*p*M,P=n*s*S+h*l*M,O=-k*M,z=-k*P,D=-2*k*C,R=4*e/x,F;if(e>.222*x||t<x/4&&e>.175*x){_=(y+n*I(v*(1+i)-y*y))/(1+i);if(e>x/4)return[_,_];var B=_,N=.5*_;_=.5*(N+B),w=50;do{var j=I(v-_*_),U=_*(D+O*j)+z*L(_/m)-R;if(!U)break;if(U<0)N=_;else B=_;_=.5*(N+B)}while(a(B-N)>g&&--w>0)}else{_=g,w=25;do{var V=_*_,H=I(v-V),q=D+O*H,G=_*q+z*L(_/m)-R,Y=q+(z-O*V)/H;_-=F=H?G/Y:0}while(a(F)>g&&--w>0)}return[_,-y-n*I(v-_*_)]}function Et(e,t){var r=0,n=1,i=.5,s=50;while(true){var l=i*i,u=I(i),c=L(1/I(1+l)),f=1-l+i*(1+l)*c,h=(1-u)/f,p=I(h),v=h*(1+l),d=p*(1-l),m=v-e*e,g=I(m),b=t+d+i*g;if(a(n-r)<y||--s===0||b===0)break;if(b>0)r=i;else n=i;i=.5*(r+n)}if(!s)return null;var _=L(u),w=o(_),T=1/w,k=2*u*w,M=(-3*i+c*(1+3*l))*k,A=(-f*w-(1-u)*M)/(f*f),S=.5*A/p,E=(1-l)*S-2*i*p*k,C=-2*T*E,P=-T*k,O=-T*(i*(1+l)*A+h*(1+3*l)*k);return[x/4*(e*(C+P*g)+O*L(e/I(v))),_]}function Lt(){return t.geoProjection(Mt(At)).scale(239.75)}function Ct(e,t,r){var a,n,i;if(!e){n=It(t,1-r);return[[0,n[0]/n[1]],[1/n[1],0],[n[2]/n[1],0]]}a=It(e,r);if(!t)return[[a[0],0],[a[1],0],[a[2],0]];n=It(t,1-r);i=n[1]*n[1]+r*a[0]*a[0]*n[0]*n[0];return[[a[0]*n[2]/i,a[1]*a[2]*n[0]*n[1]/i],[a[1]*n[1]/i,-a[0]*a[2]*n[0]*n[2]/i],[a[2]*n[1]*n[2]/i,-r*a[0]*a[1]*n[0]/i]]}function It(e,t){var r,i,l,u,c;if(t<g){u=d(e);i=o(e);r=t*(e-u*i)/4;return[u-r*i,i+r*u,1-t*u*u/2,e-r]}if(t>=1-g){r=(1-t)/4;i=z(e);u=P(e);l=1/i;c=i*O(e);return[u+r*(c-e)/(i*i),l-r*u*l*(c-e),l+r*u*l*(c+e),2*n(s(e))-b+r*(c-e)/i]}var f=[1,0,0,0,0,0,0,0,0],h=[I(t),0,0,0,0,0,0,0,0],p=0;i=I(1-t);c=1;while(a(h[p]/f[p])>g&&p<8){r=f[p++];h[p]=(r-i)/2;f[p]=(r+i)/2;i=I(r*i);c*=2}l=c*f[p]*e;do{u=h[p]*d(i=l)/f[p];l=(L(u)+l)/2}while(--p);return[d(l),u=o(l),u/o(l-i),l]}function Pt(e,t,r){var i=a(e),o=a(t),s=O(o);if(i){var l=1/d(i),u=1/(m(i)*m(i)),c=-(u+r*(s*s*l*l)-1+r),f=(r-1)*u,h=(-c+I(c*c-4*f))/2;return[Ot(n(1/I(h)),r)*v(e),Ot(n(I((h/u-1)/r)),1-r)*v(t)]}return[0,Ot(n(s),1-r)*v(t)]}function Ot(e,t){if(!t)return e;if(t===1)return u(m(e/2+_));var r=1,i=I(1-t),o=I(t);for(var s=0;a(o)>g;s++){if(e%x){var l=n(i*m(e)/r);if(l<0)l+=x;e+=l+~~(e/x)*x}else e+=e;o=(r+i)/2;i=I(r*i);o=((r=o)-i)/2}return e/(h(2,s)*r)}function zt(e,t){var r=(T-1)/(T+1),n=I(1-r*r),i=Ot(b,n*n),l=-1,c=u(m(x/4+a(t)/2)),f=s(l*c)/I(r),h=Dt(f*o(l*e),f*d(l*e)),p=Pt(h[0],h[1],n*n);return[-p[1],(t>=0?1:-1)*(.5*i-p[0])]}function Dt(e,t){var r=e*e,a=t+1,n=1-r-t*t;return[.5*((e>=0?b:-b)-i(n,2*e)),-.25*u(n*n+4*r)+.5*u(a*a+r)]}function Rt(e,t){var r=t[0]*t[0]+t[1]*t[1];return[(e[0]*t[0]+e[1]*t[1])/r,(e[1]*t[0]-e[0]*t[1])/r]}zt.invert=function(e,t){var r=(T-1)/(T+1),a=I(1-r*r),o=Ot(b,a*a),l=-1,c=Ct(.5*o-t,-e,a*a),f=Rt(c[0],c[1]),h=i(f[1],f[0])/l;return[h,2*n(s(.5/l*u(r*f[0]*f[0]+r*f[1]*f[1])))-b]};function Ft(){return t.geoProjection(Mt(zt)).scale(151.496)}function Bt(e){var t=d(e),r=o(e),n=Nt(e);n.invert=Nt(-e);function s(e,i){var s=n(e,i);e=s[0],i=s[1];var l=d(i),u=o(i),c=o(e),f=C(t*l+r*u*c),h=d(f),p=a(h)>g?f/h:1;return[p*r*d(e),(a(e)>b?p:-p)*(t*u-r*l*c)]}s.invert=function(e,r){var a=I(e*e+r*r),s=-d(a),l=o(a),u=a*l,c=-r*s,f=a*t,h=I(u*u+c*c-f*f),p=i(u*f+c*h,c*f-u*h),v=(a>b?-1:1)*i(e*s,a*o(p)*l+r*d(p)*s);return n.invert(v,p)};return s}function Nt(e){var t=d(e),r=o(e);return function(e,a){var n=o(a),s=o(e)*n,l=d(e)*n,u=d(a);return[i(l,s*r-u*t),L(u*r+s*t)]}}function jt(){var e=0,r=t.geoProjectionMutator(Bt),a=r(e),n=a.rotate,i=a.stream,o=t.geoCircle();a.parallel=function(t){if(!arguments.length)return e*A;var n=a.rotate();return r(e=t*S).rotate(n)};a.rotate=function(t){if(!arguments.length)return t=n.call(a),t[1]+=e*A,t;n.call(a,[t[0],t[1]-e*A]);o.center([-t[0],-t[1]]);return a};a.stream=function(e){e=i(e);e.sphere=function(){e.polygonStart();var t=.01,r=o.radius(90-t)().coordinates[0],a=r.length-1,n=-1,i;e.lineStart();while(++n<a)e.point((i=r[n])[0],i[1]);e.lineEnd();r=o.radius(90+t)().coordinates[0];a=r.length-1;e.lineStart();while(--n>=0)e.point((i=r[n])[0],i[1]);e.lineEnd();e.polygonEnd()};return e};return a.scale(79.4187).parallel(45).clipAngle(180-.001)}var Ut=3,Vt=L(1-1/Ut)*A,Ht=De(0);function qt(e){var t=Vt*S,r=Ee(x,t)[0]-Ee(-x,t)[0],n=Ht(0,t)[1],i=Ee(0,t)[1],o=k-i,s=M/e,u=4/M,h=n+o*o*4/M;function p(p,v){var d,m=a(v);if(m>t){var g=f(e-1,c(0,l((p+x)/s)));p+=x*(e-1)/e-g*s;d=Ee(p,m);d[0]=d[0]*M/r-M*(e-1)/(2*e)+g*M/e;d[1]=n+(d[1]-i)*4*o/M;if(v<0)d[1]=-d[1]}else{d=Ht(p,v)}d[0]*=u,d[1]/=h;return d}p.invert=function(t,p){t/=u,p*=h;var v=a(p);if(v>n){var d=f(e-1,c(0,l((t+x)/s)));t=(t+x*(e-1)/e-d*s)*r/M;var m=Ee.invert(t,.25*(v-n)*M/o+i);m[0]-=x*(e-1)/e-d*s;if(p<0)m[1]=-m[1];return m}return Ht.invert(t,p)};return p}function Gt(e,t){return[e,t&1?90-g:Vt]}function Yt(e,t){return[e,t&1?-90+g:-Vt]}function Wt(e){return[e[0]*(1-g),e[1]]}function Xt(e){var t=[].concat(r.range(-180,180+e/2,e).map(Gt),r.range(180,-180-e/2,-e).map(Yt));return{type:"Polygon",coordinates:[e===180?t.map(Wt):t]}}function Zt(){var e=4,r=t.geoProjectionMutator(qt),a=r(e),n=a.stream;a.lobes=function(t){return arguments.length?r(e=+t):e};a.stream=function(r){var i=a.rotate(),o=n(r),s=(a.rotate([0,0]),n(r));a.rotate(i);o.sphere=function(){t.geoStream(Xt(180/e),s)};return o};return a.scale(239.75)}function Jt(e){var t=1+e,r=d(1/t),n=L(r),s=2*I(x/(l=x+4*n*t)),l,u=.5*s*(t+I(e*(2+e))),c=e*e,f=t*t;function h(r,h){var p=1-d(h),v,m;if(p&&p<2){var g=b-h,_=25,w;do{var T=d(g),k=o(g),M=n+i(T,t-k),A=1+f-2*t*k;g-=w=(g-c*n-t*T+A*M-.5*p*l)/(2*t*T*M)}while(a(w)>y&&--_>0);v=s*I(A);m=r*M/x}else{v=s*(e+p);m=r*n/x}return[v*d(m),u-v*o(m)]}h.invert=function(e,r){var a=e*e+(r-=u)*r,o=(1+f-a/(s*s))/(2*t),h=C(o),p=d(h),v=n+i(p,t-o);return[L(e/I(a))*x/v,L(1-2*(h-c*n-t*p+(1+f-2*t*o)*v)/l)]};return h}function Kt(){var e=1,r=t.geoProjectionMutator(Jt),a=r(e);a.ratio=function(t){return arguments.length?r(e=+t):e};return a.scale(167.774).center([0,18.67])}var Qt=.7109889596207567;var $t=.0528035274542;function er(e,t){return t>-Qt?(e=oe(e,t),e[1]+=$t,e):pe(e,t)}er.invert=function(e,t){return t>-Qt?oe.invert(e,t-$t):pe.invert(e,t)};function tr(){return t.geoProjection(er).rotate([-20,-55]).scale(164.263).center([0,-5.4036])}function rr(e,t){return a(t)>Qt?(e=oe(e,t),e[1]-=t>0?$t:-$t,e):pe(e,t)}rr.invert=function(e,t){return a(t)>Qt?oe.invert(e,t+(t>0?$t:-$t)):pe.invert(e,t)};function ar(){return t.geoProjection(rr).scale(152.63)}function nr(e,t,r,a){var n=I(4*x/(2*r+(1+e-t/2)*d(2*r)+(e+t)/2*d(4*r)+t/2*d(6*r))),i=I(a*d(r)*I((1+e*o(2*r)+t*o(4*r))/(1+e+t))),s=r*u(1);function l(r){return I(1+e*o(2*r)+t*o(4*r))}function u(a){var n=a*r;return(2*n+(1+e-t/2)*d(2*n)+(e+t)/2*d(4*n)+t/2*d(6*n))/r}function c(e){return l(e)*d(e)}var f=function(e,t){var a=r*ee(u,s*d(t)/r,t/x);if(isNaN(a))a=r*v(t);var c=n*l(a);return[c*i*e/x*o(a),c/i*d(a)]};f.invert=function(e,t){var a=ee(c,t*i/n);return[e*x/(o(a)*n*i*l(a)),L(r*u(a/r)/s)]};if(r===0){n=I(a/x);f=function(e,t){return[e*n,d(t)/n]};f.invert=function(e,t){return[e/n,L(t*n)]}}return f}function ir(){var e=1,r=0,a=45*S,n=2,i=t.geoProjectionMutator(nr),o=i(e,r,a,n);o.a=function(t){return arguments.length?i(e=+t,r,a,n):e};o.b=function(t){return arguments.length?i(e,r=+t,a,n):r};o.psiMax=function(t){return arguments.length?i(e,r,a=+t*S,n):a*A};o.ratio=function(t){return arguments.length?i(e,r,a,n=+t):n};return o.scale(180.739)}function or(e,t,r,a,n,i,o,s,l,u,c){if(c.nanEncountered){return NaN}var f,h,p,v,d,m,g,y,x,b;f=r-t;h=e(t+f*.25);p=e(r-f*.25);if(isNaN(h)){c.nanEncountered=true;return}if(isNaN(p)){c.nanEncountered=true;return}v=f*(a+4*h+n)/12;d=f*(n+4*p+i)/12;m=v+d;b=(m-o)/15;if(u>l){c.maxDepthCount++;return m+b}else if(Math.abs(b)<s){return m+b}else{g=t+f*.5;y=or(e,t,g,a,h,n,v,s*.5,l,u+1,c);if(isNaN(y)){c.nanEncountered=true;return NaN}x=or(e,g,r,n,p,i,d,s*.5,l,u+1,c);if(isNaN(x)){c.nanEncountered=true;return NaN}return y+x}}function sr(e,t,r,a,n){var i={maxDepthCount:0,nanEncountered:false};if(a===undefined){a=1e-8}if(n===undefined){n=20}var o=e(t);var s=e(.5*(t+r));var l=e(r);var u=(o+4*s+l)*(r-t)/6;var c=or(e,t,r,o,s,l,u,a,n,1,i);return c}function lr(e,t,r){function n(r){return e+(1-e)*h(1-h(r,t),1/t)}function i(e){return sr(n,0,e,1e-4)}var o=1/i(1),s=1e3,l=(1+1e-8)*o,u=[];for(var c=0;c<=s;c++)u.push(i(c/s)*l);function f(e){var t=0,r=s,a=s>>1;do{if(u[a]>e)r=a;else t=a;a=t+r>>1}while(a>t);var n=u[a+1]-u[a];if(n)n=(e-u[a+1])/n;return(a+1+n)/s}var p=2*f(1)/x*o/r;var m=function(e,t){var r=f(a(d(t))),i=n(r)*e;r/=p;return[i,t>=0?r:-r]};m.invert=function(e,t){var r;t*=p;if(a(t)<1)r=v(t)*L(i(a(t))*o);return[e/n(a(t)),r]};return m}function ur(){var e=0,r=2.5,a=1.183136,n=t.geoProjectionMutator(lr),i=n(e,r,a);i.alpha=function(t){return arguments.length?n(e=+t,r,a):e};i.k=function(t){return arguments.length?n(e,r=+t,a):r};i.gamma=function(t){return arguments.length?n(e,r,a=+t):a};return i.scale(152.63)}function cr(e,t){return a(e[0]-t[0])<g&&a(e[1]-t[1])<g}function fr(e,t){var r=-1,a=e.length,n=e[0],i,o,s,l=[];while(++r<a){i=e[r];o=(i[0]-n[0])/t;s=(i[1]-n[1])/t;for(var u=0;u<t;++u)l.push([n[0]+u*o,n[1]+u*s]);n=i}l.push(i);return l}function hr(e){var t=[],a,n,i,o,s,l,u,c=e[0].length;for(u=0;u<c;++u){a=e[0][u];n=a[0][0],i=a[0][1],o=a[1][1];s=a[2][0],l=a[2][1];t.push(fr([[n+g,i+g],[n+g,o-g],[s-g,o-g],[s-g,l+g]],30))}for(u=e[1].length-1;u>=0;--u){a=e[1][u];n=a[0][0],i=a[0][1],o=a[1][1];s=a[2][0],l=a[2][1];t.push(fr([[s-g,l-g],[s-g,o+g],[n+g,o+g],[n+g,i-g]],30))}return{type:"Polygon",coordinates:[r.merge(t)]}}function pr(e,r,a){var n,i;function o(t,a){var n=a<0?-1:+1,i=r[+(a<0)];for(var o=0,s=i.length-1;o<s&&t>i[o][2][0];++o);var l=e(t-i[o][1][0],a);l[0]+=e(i[o][1][0],n*a>n*i[o][0][1]?i[o][0][1]:a)[0];return l}if(a){o.invert=a(o)}else if(e.invert){o.invert=function(t,a){var n=i[+(a<0)],s=r[+(a<0)];for(var l=0,u=n.length;l<u;++l){var c=n[l];if(c[0][0]<=t&&t<c[1][0]&&c[0][1]<=a&&a<c[1][1]){var f=e.invert(t-e(s[l][1][0],0)[0],a);f[0]+=s[l][1][0];return cr(o(f[0],f[1]),[t,a])?f:null}}}}var s=t.geoProjection(o),l=s.stream;s.stream=function(e){var r=s.rotate(),a=l(e),i=(s.rotate([0,0]),l(e));s.rotate(r);a.sphere=function(){t.geoStream(n,i)};return a};s.lobes=function(t){if(!arguments.length)return r.map((function(e){return e.map((function(e){return[[e[0][0]*A,e[0][1]*A],[e[1][0]*A,e[1][1]*A],[e[2][0]*A,e[2][1]*A]]}))}));n=hr(t);r=t.map((function(e){return e.map((function(e){return[[e[0][0]*S,e[0][1]*S],[e[1][0]*S,e[1][1]*S],[e[2][0]*S,e[2][1]*S]]}))}));i=r.map((function(t){return t.map((function(t){var r=e(t[0][0],t[0][1])[0],a=e(t[2][0],t[2][1])[0],n=e(t[1][0],t[0][1])[1],i=e(t[1][0],t[1][1])[1],o;if(n>i)o=n,n=i,i=o;return[[r,n],[a,i]]}))}));return s};if(r!=null)s.lobes(r);return s}var vr=[[[[-180,0],[-100,90],[-40,0]],[[-40,0],[30,90],[180,0]]],[[[-180,0],[-160,-90],[-100,0]],[[-100,0],[-60,-90],[-20,0]],[[-20,0],[20,-90],[80,0]],[[80,0],[140,-90],[180,0]]]];function dr(){return pr(ce,vr).scale(160.857)}var mr=[[[[-180,0],[-100,90],[-40,0]],[[-40,0],[30,90],[180,0]]],[[[-180,0],[-160,-90],[-100,0]],[[-100,0],[-60,-90],[-20,0]],[[-20,0],[20,-90],[80,0]],[[80,0],[140,-90],[180,0]]]];function gr(){return pr(rr,mr).scale(152.63)}var yr=[[[[-180,0],[-100,90],[-40,0]],[[-40,0],[30,90],[180,0]]],[[[-180,0],[-160,-90],[-100,0]],[[-100,0],[-60,-90],[-20,0]],[[-20,0],[20,-90],[80,0]],[[80,0],[140,-90],[180,0]]]];function xr(){return pr(oe,yr).scale(169.529)}var br=[[[[-180,0],[-90,90],[0,0]],[[0,0],[90,90],[180,0]]],[[[-180,0],[-90,-90],[0,0]],[[0,0],[90,-90],[180,0]]]];function _r(){return pr(oe,br).scale(169.529).rotate([20,0])}var wr=[[[[-180,35],[-30,90],[0,35]],[[0,35],[30,90],[180,35]]],[[[-180,-10],[-102,-90],[-65,-10]],[[-65,-10],[5,-90],[77,-10]],[[77,-10],[103,-90],[180,-10]]]];function Tr(){return pr(er,wr,te).rotate([-20,-55]).scale(164.263).center([0,-5.4036])}var kr=[[[[-180,0],[-110,90],[-40,0]],[[-40,0],[0,90],[40,0]],[[40,0],[110,90],[180,0]]],[[[-180,0],[-110,-90],[-40,0]],[[-40,0],[0,-90],[40,0]],[[40,0],[110,-90],[180,0]]]];function Mr(){return pr(pe,kr).scale(152.63).rotate([-20,0])}function Ar(e,t){return[3/M*e*I(x*x/3-t*t),t]}Ar.invert=function(e,t){return[M/3*e/I(x*x/3-t*t),t]};function Sr(){return t.geoProjection(Ar).scale(158.837)}function Er(e){function t(t,r){if(a(a(r)-b)<g)return[0,r<0?-2:2];var n=d(r),i=h((1+n)/(1-n),e/2),s=.5*(i+1/i)+o(t*=e);return[2*d(t)/s,(i-1/i)/s]}t.invert=function(t,r){var n=a(r);if(a(n-2)<g)return t?null:[0,v(r)*b];if(n>2)return null;t/=2,r/=2;var o=t*t,s=r*r,l=2*r/(1+o+s);l=h((1+l)/(1-l),1/e);return[i(2*t,1-o-s)/e,L((l-1)/(l+1))]};return t}function Lr(){var e=.5,r=t.geoProjectionMutator(Er),a=r(e);a.spacing=function(t){return arguments.length?r(e=+t):e};return a.scale(124.75)}var Cr=x/T;function Ir(e,t){return[e*(1+I(o(t)))/2,t/(o(t/2)*o(e/6))]}Ir.invert=function(e,t){var r=a(e),n=a(t),i=g,s=b;if(n<Cr)s*=n/Cr;else i+=6*C(Cr/n);for(var l=0;l<25;l++){var u=d(s),c=I(o(s)),f=d(s/2),h=o(s/2),p=d(i/6),v=o(i/6),m=.5*i*(1+c)-r,y=s/(h*v)-n,x=c?-.25*i*u/c:0,_=.5*(1+c),w=(1+.5*s*f/h)/(h*v),T=s/h*(p/6)/(v*v),k=x*T-w*_,M=(m*T-y*_)/k,A=(y*x-m*w)/k;s-=M;i-=A;if(a(M)<g&&a(A)<g)break}return[e<0?-i:i,t<0?-s:s]};function Pr(){return t.geoProjection(Ir).scale(97.2672)}function Or(e,t){var r=e*e,a=t*t;return[e*(.975534+a*(-.119161+r*-.0143059+a*-.0547009)),t*(1.00384+r*(.0802894+a*-.02855+r*199025e-9)+a*(.0998909+a*-.0491032))]}Or.invert=function(e,t){var r=v(e)*x,n=t/2,i=50;do{var o=r*r,s=n*n,l=r*n,u=r*(.975534+s*(-.119161+o*-.0143059+s*-.0547009))-e,c=n*(1.00384+o*(.0802894+s*-.02855+o*199025e-9)+s*(.0998909+s*-.0491032))-t,f=.975534-s*(.119161+3*o*.0143059+s*.0547009),h=-l*(2*.119161+4*.0547009*s+2*.0143059*o),p=l*(2*.0802894+4*199025e-9*o+2*-.02855*s),d=1.00384+o*(.0802894+199025e-9*o)+s*(3*(.0998909-.02855*o)-5*.0491032*s),m=h*p-d*f,y=(c*h-u*d)/m,b=(u*p-c*f)/m;r-=y,n-=b}while((a(y)>g||a(b)>g)&&--i>0);return i&&[r,n]};function zr(){return t.geoProjection(Or).scale(139.98)}function Dr(e,t){return[d(e)/o(t),m(t)*o(e)]}Dr.invert=function(e,t){var r=e*e,a=t*t,n=a+1,i=r+n,o=e?w*I((i-I(i*i-4*r))/r):1/I(n);return[L(e*o),v(t)*C(o)]};function Rr(){return t.geoProjection(Dr).scale(144.049).clipAngle(90-.001)}function Fr(e){var t=o(e),r=m(_+e/2);function n(n,i){var o=i-e,s=a(o)<g?n*t:a(s=_+i/2)<g||a(a(s)-b)<g?0:n*o/u(m(s)/r);return[s,o]}n.invert=function(n,i){var o,s=i+e;return[a(i)<g?n/t:a(o=_+s/2)<g||a(a(o)-b)<g?0:n*u(m(o)/r)/i,s]};return n}function Br(){return he(Fr).parallel(40).scale(158.837)}function Nr(e,t){return[e,1.25*u(m(_+.4*t))]}Nr.invert=function(e,t){return[e,2.5*n(s(.8*t))-.625*x]};function jr(){return t.geoProjection(Nr).scale(108.318)}function Ur(e){var t=e.length-1;function r(r,a){var n=o(a),i=2/(1+n*o(r)),s=i*n*d(r),l=i*d(a),u=t,c=e[u],f=c[0],h=c[1],p;while(--u>=0){c=e[u];f=c[0]+s*(p=f)-l*h;h=c[1]+s*h+l*p}f=s*(p=f)-l*h;h=s*h+l*p;return[f,h]}r.invert=function(r,s){var l=20,u=r,c=s;do{var f=t,h=e[f],p=h[0],v=h[1],m=0,y=0,x;while(--f>=0){h=e[f];m=p+u*(x=m)-c*y;y=v+u*y+c*x;p=h[0]+u*(x=p)-c*v;v=h[1]+u*v+c*x}m=p+u*(x=m)-c*y;y=v+u*y+c*x;p=u*(x=p)-c*v-r;v=u*v+c*x-s;var b=m*m+y*y,_,w;u-=_=(p*m+v*y)/b;c-=w=(v*m-p*y)/b}while(a(_)+a(w)>g*g&&--l>0);if(l){var T=I(u*u+c*c),k=2*n(T*.5),M=d(k);return[i(u*M,T*o(k)),T?L(c*M/T):0]}};return r}var Vr=[[.9972523,0],[.0052513,-.0041175],[.0074606,.0048125],[-.0153783,-.1968253],[.0636871,-.1408027],[.3660976,-.2937382]],Hr=[[.98879,0],[0,0],[-.050909,0],[0,0],[.075528,0]],qr=[[.984299,0],[.0211642,.0037608],[-.1036018,-.0575102],[-.0329095,-.0320119],[.0499471,.1223335],[.026046,.0899805],[7388e-7,-.1435792],[.0075848,-.1334108],[-.0216473,.0776645],[-.0225161,.0853673]],Gr=[[.9245,0],[0,0],[.01943,0]],Yr=[[.721316,0],[0,0],[-.00881625,-.00617325]];function Wr(){return Qr(Vr,[152,-64]).scale(1400).center([-160.908,62.4864]).clipAngle(30).angle(7.8)}function Xr(){return Qr(Hr,[95,-38]).scale(1e3).clipAngle(55).center([-96.5563,38.8675])}function Zr(){return Qr(qr,[120,-45]).scale(359.513).clipAngle(55).center([-117.474,53.0628])}function Jr(){return Qr(Gr,[-20,-18]).scale(209.091).center([20,16.7214]).clipAngle(82)}function Kr(){return Qr(Yr,[165,10]).scale(250).clipAngle(130).center([-165,-10])}function Qr(e,r){var a=t.geoProjection(Ur(e)).rotate(r).clipAngle(90),n=t.geoRotation(r),i=a.center;delete a.rotate;a.center=function(e){return arguments.length?i(n(e)):n.invert(i())};return a}var $r=I(6),ea=I(7);function ta(e,t){var r=L(7*d(t)/(3*$r));return[$r*e*(2*o(2*r/3)-1)/ea,9*d(r/3)/ea]}ta.invert=function(e,t){var r=3*L(t*ea/9);return[e*ea/($r*(2*o(2*r/3)-1)),L(d(r)*3*$r/7)]};function ra(){return t.geoProjection(ta).scale(164.859)}function aa(e,t){var r=(1+w)*d(t),n=t;for(var i=0,s;i<25;i++){n-=s=(d(n/2)+d(n)-r)/(.5*o(n/2)+o(n));if(a(s)<g)break}return[e*(1+2*o(n)/o(n/2))/(3*T),2*I(3)*d(n/2)/I(2+T)]}aa.invert=function(e,t){var r=t*I(2+T)/(2*I(3)),a=2*L(r);return[3*T*e/(1+2*o(a)/o(a/2)),L((r+d(a))/(1+w))]};function na(){return t.geoProjection(aa).scale(188.209)}function ia(e,t){var r=I(6/(4+x)),n=(1+x/4)*d(t),i=t/2;for(var s=0,l;s<25;s++){i-=l=(i/2+d(i)-n)/(.5+o(i));if(a(l)<g)break}return[r*(.5+o(i))*e/1.5,r*i]}ia.invert=function(e,t){var r=I(6/(4+x)),n=t/r;if(a(a(n)-b)<g)n=n<0?-b:b;return[1.5*e/(r*(.5+o(n))),L((n/2+d(n))/(1+x/4))]};function oa(){return t.geoProjection(ia).scale(166.518)}function sa(e,t){var r=t*t,a=r*r,n=r*a;return[e*(.84719-.13063*r+n*n*(-.04515+.05494*r-.02326*a+.00331*n)),t*(1.01183+a*a*(-.02625+.01926*r-.00396*a))]}sa.invert=function(e,t){var r=t,n=25,i,o,s,l;do{o=r*r;s=o*o;r-=i=(r*(1.01183+s*s*(-.02625+.01926*o-.00396*s))-t)/(1.01183+s*s*(9*-.02625+11*.01926*o+13*-.00396*s))}while(a(i)>y&&--n>0);o=r*r;s=o*o;l=o*s;return[e/(.84719-.13063*o+l*l*(-.04515+.05494*o-.02326*s+.00331*l)),r]};function la(){return t.geoProjection(sa).scale(175.295)}function ua(e,t){return[e*(1+o(t))/2,2*(t-m(t/2))]}ua.invert=function(e,t){var r=t/2;for(var n=0,i=Infinity;n<10&&a(i)>g;++n){var s=o(t/2);t-=i=(t-m(t/2)-r)/(1-.5/(s*s))}return[2*e/(1+o(t)),t]};function ca(){return t.geoProjection(ua).scale(152.63)}var fa=[[[[-180,0],[-90,90],[0,0]],[[0,0],[90,90],[180,0]]],[[[-180,0],[-90,-90],[0,0]],[[0,0],[90,-90],[180,0]]]];function ha(){return pr(K(Infinity),fa).rotate([20,0]).scale(152.63)}function pa(e,t){var r=d(t),n=o(t),i=v(e);if(e===0||a(t)===b)return[0,t];else if(t===0)return[e,0];else if(a(e)===b)return[e*n,b*r];var s=x/(2*e)-2*e/x,l=2*t/x,u=(1-l*l)/(r-l);var c=s*s,f=u*u,h=1+c/f,p=1+f/c;var m=(s*r/u-s/2)/h,g=(f*r/c+u/2)/p,y=m*m+n*n/h,_=g*g-(f*r*r/c+u*r-1)/p;return[b*(m+I(y)*i),b*(g+I(_<0?0:_)*v(-t*s)*i)]}pa.invert=function(e,t){e/=b;t/=b;var r=e*e,a=t*t,n=r+a,i=x*x;return[e?(n-1+I((1-n)*(1-n)+4*r))/(2*e)*b:0,ee((function(e){return n*(x*d(e)-2*e)*x+4*e*e*(t-d(e))+2*x*e-i*t}),0)]};function va(){return t.geoProjection(pa).scale(127.267)}var da=1.0148,ma=.23185,ga=-.14499,ya=.02406,xa=da,ba=5*ma,_a=7*ga,wa=9*ya,Ta=1.790857183;function ka(e,t){var r=t*t;return[e,t*(da+r*r*(ma+r*(ga+ya*r)))]}ka.invert=function(e,t){if(t>Ta)t=Ta;else if(t<-Ta)t=-Ta;var r=t,n;do{var i=r*r;r-=n=(r*(da+i*i*(ma+i*(ga+ya*i)))-t)/(xa+i*i*(ba+i*(_a+wa*i)))}while(a(n)>g);return[e,r]};function Ma(){return t.geoProjection(ka).scale(139.319)}function Aa(e,t){if(a(t)<g)return[e,0];var r=m(t),n=e*d(t);return[d(n)/r,t+(1-o(n))/r]}Aa.invert=function(e,t){if(a(t)<g)return[e,0];var r=e*e+t*t,n=t*.5,i=10,s;do{var l=m(n),u=1/o(n),c=r-2*t*n+n*n;n-=s=(l*c+2*(n-t))/(2+c*u*u+2*(n-t)*l)}while(a(s)>g&&--i>0);l=m(n);return[(a(t)<a(n+1/l)?L(e*l):v(t)*v(e)*(C(a(e*l))+b))/d(n),n]};function Sa(){return t.geoProjection(Aa).scale(103.74)}function Ea(e,t){var r=Ia(e[1],e[0]),a=Ia(t[1],t[0]),n=Oa(r,a),i=Pa(r)/Pa(a);return Ca([1,0,e[0][0],0,1,e[0][1]],Ca([i,0,0,0,i,0],Ca([o(n),d(n),0,-d(n),o(n),0],[1,0,-t[0][0],0,1,-t[0][1]])))}function La(e){var t=1/(e[0]*e[4]-e[1]*e[3]);return[t*e[4],-t*e[1],t*(e[1]*e[5]-e[2]*e[4]),-t*e[3],t*e[0],t*(e[2]*e[3]-e[0]*e[5])]}function Ca(e,t){return[e[0]*t[0]+e[1]*t[3],e[0]*t[1]+e[1]*t[4],e[0]*t[2]+e[1]*t[5]+e[2],e[3]*t[0]+e[4]*t[3],e[3]*t[1]+e[4]*t[4],e[3]*t[2]+e[4]*t[5]+e[5]]}function Ia(e,t){return[e[0]-t[0],e[1]-t[1]]}function Pa(e){return I(e[0]*e[0]+e[1]*e[1])}function Oa(e,t){return i(e[0]*t[1]-e[1]*t[0],e[0]*t[0]+e[1]*t[1])}function za(e,r,a){n(e,{transform:null});function n(e,t){e.edges=Ba(e.face);if(t.face){var r=e.shared=Fa(e.face,t.face),a=Ea(r.map(t.project),r.map(e.project));e.transform=t.transform?Ca(t.transform,a):a;var i=t.edges;for(var o=0,s=i.length;o<s;++o){if(Ra(r[0],i[o][1])&&Ra(r[1],i[o][0]))i[o]=e;if(Ra(r[0],i[o][0])&&Ra(r[1],i[o][1]))i[o]=e}i=e.edges;for(o=0,s=i.length;o<s;++o){if(Ra(r[0],i[o][0])&&Ra(r[1],i[o][1]))i[o]=t;if(Ra(r[0],i[o][1])&&Ra(r[1],i[o][0]))i[o]=t}}else{e.transform=t.transform}if(e.children){e.children.forEach((function(t){n(t,e)}))}return e}function i(e,t){var a=r(e,t),n=a.project([e*A,t*A]),i;if(i=a.transform){return[i[0]*n[0]+i[1]*n[1]+i[2],-(i[3]*n[0]+i[4]*n[1]+i[5])]}n[1]=-n[1];return n}if(Na(e))i.invert=function(t,r){var a=o(e,[t,-r]);return a&&(a[0]*=S,a[1]*=S,a)};function o(e,t){var r=e.project.invert,a=e.transform,n=t;if(a){a=La(a);n=[a[0]*n[0]+a[1]*n[1]+a[2],a[3]*n[0]+a[4]*n[1]+a[5]]}if(r&&e===s(i=r(n)))return i;var i,l=e.children;for(var u=0,c=l&&l.length;u<c;++u){if(i=o(l[u],t))return i}}function s(e){return r(e[0]*S,e[1]*S)}var l=t.geoProjection(i),u=l.stream;l.stream=function(t){var r=l.rotate(),a=u(t),n=(l.rotate([0,0]),u(t));l.rotate(r);a.sphere=function(){n.polygonStart();n.lineStart();Da(n,e);n.lineEnd();n.polygonEnd()};return a};return l.angle(a==null?-30:a*A)}function Da(e,r,n){var i,o=r.edges,s=o.length,l,u={type:"MultiPoint",coordinates:r.face},c=r.face.filter((function(e){return a(e[1])!==90})),f=t.geoBounds({type:"MultiPoint",coordinates:c}),h=false,p=-1,v=f[1][0]-f[0][0];var d=v===180||v===360?[(f[0][0]+f[1][0])/2,(f[0][1]+f[1][1])/2]:t.geoCentroid(u);if(n)while(++p<s){if(o[p]===n)break}++p;for(var m=0;m<s;++m){l=o[(m+p)%s];if(Array.isArray(l)){if(!h){e.point((i=t.geoInterpolate(l[0],d)(g))[0],i[1]);h=true}e.point((i=t.geoInterpolate(l[1],d)(g))[0],i[1])}else{h=false;if(l!==n)Da(e,l,r)}}}function Ra(e,t){return e&&t&&e[0]===t[0]&&e[1]===t[1]}function Fa(e,t){var r,a,n=e.length,i=null;for(var o=0;o<n;++o){r=e[o];for(var s=t.length;--s>=0;){a=t[s];if(r[0]===a[0]&&r[1]===a[1]){if(i)return[i,r];i=r}}}}function Ba(e){var t=e.length,r=[];for(var a=e[t-1],n=0;n<t;++n)r.push([a,a=e[n]]);return r}function Na(e){return e.project.invert||e.children&&e.children.some(Na)}var ja=[[0,90],[-90,0],[0,0],[90,0],[180,0],[0,-90]];var Ua=[[0,2,1],[0,3,2],[5,1,2],[5,2,3],[0,1,4],[0,4,3],[5,4,1],[5,3,4]].map((function(e){return e.map((function(e){return ja[e]}))}));function Va(e){e=e||function(e){var r=t.geoCentroid({type:"MultiPoint",coordinates:e});return t.geoGnomonic().scale(1).translate([0,0]).rotate([-r[0],-r[1]])};var r=Ua.map((function(t){return{face:t,project:e(t)}}));[-1,0,0,1,0,1,4,5].forEach((function(e,t){var a=r[e];a&&(a.children||(a.children=[])).push(r[t])}));return za(r[0],(function(e,t){return r[e<-x/2?t<0?6:4:e<0?t<0?2:0:e<x/2?t<0?3:1:t<0?7:5]})).angle(-30).scale(101.858).center([0,45])}var Ha=2/I(3);function qa(e,t){var r=Ee(e,t);return[r[0]*Ha,r[1]]}qa.invert=function(e,t){return Ee.invert(e/Ha,t)};function Ga(e){e=e||function(e){var r=t.geoCentroid({type:"MultiPoint",coordinates:e});return t.geoProjection(qa).translate([0,0]).scale(1).rotate(r[1]>0?[-r[0],0]:[180-r[0],180])};var r=Ua.map((function(t){return{face:t,project:e(t)}}));[-1,0,0,1,0,1,4,5].forEach((function(e,t){var a=r[e];a&&(a.children||(a.children=[])).push(r[t])}));return za(r[0],(function(e,t){return r[e<-x/2?t<0?6:4:e<0?t<0?2:0:e<x/2?t<0?3:1:t<0?7:5]})).angle(-30).scale(121.906).center([0,48.5904])}function Ya(e){e=e||function(e){var r=e.length===6?t.geoCentroid({type:"MultiPoint",coordinates:e}):e[0];return t.geoGnomonic().scale(1).translate([0,0]).rotate([-r[0],-r[1]])};var r=Ua.map((function(e){var t=e.map(Ja),r=t.length,a=t[r-1],n,i=[];for(var o=0;o<r;++o){n=t[o];i.push(Za([a[0]*.9486832980505138+n[0]*.31622776601683794,a[1]*.9486832980505138+n[1]*.31622776601683794,a[2]*.9486832980505138+n[2]*.31622776601683794]),Za([n[0]*.9486832980505138+a[0]*.31622776601683794,n[1]*.9486832980505138+a[1]*.31622776601683794,n[2]*.9486832980505138+a[2]*.31622776601683794]));a=n}return i}));var a=[];var n=[-1,0,0,1,0,1,4,5];r.forEach((function(e,t){var i=Ua[t],o=i.length,s=a[t]=[];for(var l=0;l<o;++l){r.push([i[l],e[(l*2+2)%(2*o)],e[(l*2+1)%(2*o)]]);n.push(t);s.push(Xa(Ja(e[(l*2+2)%(2*o)]),Ja(e[(l*2+1)%(2*o)])))}}));var i=r.map((function(t){return{project:e(t),face:t}}));n.forEach((function(e,t){var r=i[e];r&&(r.children||(r.children=[])).push(i[t])}));function s(e,t){var r=o(t),n=[r*o(e),r*d(e),d(t)];var s=e<-x/2?t<0?6:4:e<0?t<0?2:0:e<x/2?t<0?3:1:t<0?7:5;var l=a[s];return i[Wa(l[0],n)<0?8+3*s:Wa(l[1],n)<0?8+3*s+1:Wa(l[2],n)<0?8+3*s+2:s]}return za(i[0],s).angle(-30).scale(110.625).center([0,45])}function Wa(e,t){for(var r=0,a=e.length,n=0;r<a;++r)n+=e[r]*t[r];return n}function Xa(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function Za(e){return[i(e[1],e[0])*A,L(c(-1,f(1,e[2])))*A]}function Ja(e){var t=e[0]*S,r=e[1]*S,a=o(r);return[a*o(t),a*d(t),d(r)]}function Ka(){}function Qa(e){if((r=e.length)<4)return false;var t=0,r,a=e[r-1][1]*e[0][0]-e[r-1][0]*e[0][1];while(++t<r)a+=e[t-1][1]*e[t][0]-e[t-1][0]*e[t][1];return a<=0}function $a(e,t){var r=t[0],a=t[1],n=false;for(var i=0,o=e.length,s=o-1;i<o;s=i++){var l=e[i],u=l[0],c=l[1],f=e[s],h=f[0],p=f[1];if(c>a^p>a&&r<(h-u)*(a-c)/(p-c)+u)n=!n}return n}function en(e,t){var r=t.stream,a;if(!r)throw new Error("invalid projection");switch(e&&e.type){case"Feature":a=rn;break;case"FeatureCollection":a=tn;break;default:a=nn;break}return a(e,r)}function tn(e,t){return{type:"FeatureCollection",features:e.features.map((function(e){return rn(e,t)}))}}function rn(e,t){return{type:"Feature",id:e.id,properties:e.properties,geometry:nn(e.geometry,t)}}function an(e,t){return{type:"GeometryCollection",geometries:e.geometries.map((function(e){return nn(e,t)}))}}function nn(e,r){if(!e)return null;if(e.type==="GeometryCollection")return an(e,r);var a;switch(e.type){case"Point":a=ln;break;case"MultiPoint":a=ln;break;case"LineString":a=un;break;case"MultiLineString":a=un;break;case"Polygon":a=cn;break;case"MultiPolygon":a=cn;break;case"Sphere":a=cn;break;default:return null}t.geoStream(e,r(a));return a.result()}var on=[],sn=[];var ln={point:function(e,t){on.push([e,t])},result:function(){var e=!on.length?null:on.length<2?{type:"Point",coordinates:on[0]}:{type:"MultiPoint",coordinates:on};on=[];return e}};var un={lineStart:Ka,point:function(e,t){on.push([e,t])},lineEnd:function(){if(on.length)sn.push(on),on=[]},result:function(){var e=!sn.length?null:sn.length<2?{type:"LineString",coordinates:sn[0]}:{type:"MultiLineString",coordinates:sn};sn=[];return e}};var cn={polygonStart:Ka,lineStart:Ka,point:function(e,t){on.push([e,t])},lineEnd:function(){var e=on.length;if(e){do{on.push(on[0].slice())}while(++e<4);sn.push(on),on=[]}},polygonEnd:Ka,result:function(){if(!sn.length)return null;var e=[],t=[];sn.forEach((function(r){if(Qa(r))e.push([r]);else t.push(r)}));t.forEach((function(t){var r=t[0];e.some((function(e){if($a(e[0],r)){e.push(t);return true}}))||e.push([t])}));sn=[];return!e.length?null:e.length>1?{type:"MultiPolygon",coordinates:e}:{type:"Polygon",coordinates:e[0]}}};function fn(e){var r=e(b,0)[0]-e(-b,0)[0];function n(t,n){var i=a(t)<b,o=e(i?t:t>0?t-x:t+x,n),s=(o[0]-o[1])*w,l=(o[0]+o[1])*w;if(i)return[s,l];var u=r*w,c=s>0^l>0?-1:1;return[c*s-v(l)*u,c*l-v(s)*u]}if(e.invert)n.invert=function(t,n){var i=(t+n)*w,o=(n-t)*w,s=a(i)<.5*r&&a(o)<.5*r;if(!s){var l=r*w,u=i>0^o>0?-1:1,c=-u*t+(o>0?1:-1)*l,f=-u*n+(i>0?1:-1)*l;i=(-c-f)*w;o=(c-f)*w}var h=e.invert(i,o);if(!s)h[0]+=i>0?x:-x;return h};return t.geoProjection(n).rotate([-90,-90,45]).clipAngle(180-.001)}function hn(){return fn(At).scale(176.423)}function pn(){return fn(zt).scale(111.48)}function vn(e,t){if(!(0<=(t=+t)&&t<=20))throw new Error("invalid digits");function r(e){var r=e.length,a=2,n=new Array(r);n[0]=+e[0].toFixed(t);n[1]=+e[1].toFixed(t);while(a<r)n[a]=e[a],++a;return n}function a(e){return e.map(r)}function n(e){var t=r(e[0]);var a=[t];for(var n=1;n<e.length;n++){var i=r(e[n]);if(i.length>2||i[0]!=t[0]||i[1]!=t[1]){a.push(i);t=i}}if(a.length===1&&e.length>1){a.push(r(e[e.length-1]))}return a}function i(e){return e.map(n)}function o(e){if(e==null)return e;var t;switch(e.type){case"GeometryCollection":t={type:"GeometryCollection",geometries:e.geometries.map(o)};break;case"Point":t={type:"Point",coordinates:r(e.coordinates)};break;case"MultiPoint":t={type:e.type,coordinates:a(e.coordinates)};break;case"LineString":t={type:e.type,coordinates:n(e.coordinates)};break;case"MultiLineString":case"Polygon":t={type:e.type,coordinates:i(e.coordinates)};break;case"MultiPolygon":t={type:"MultiPolygon",coordinates:e.coordinates.map(i)};break;default:return e}if(e.bbox!=null)t.bbox=e.bbox;return t}function s(e){var t={type:"Feature",properties:e.properties,geometry:o(e.geometry)};if(e.id!=null)t.id=e.id;if(e.bbox!=null)t.bbox=e.bbox;return t}if(e!=null)switch(e.type){case"Feature":return s(e);case"FeatureCollection":{var l={type:"FeatureCollection",features:e.features.map(s)};if(e.bbox!=null)l.bbox=e.bbox;return l}default:return o(e)}return e}function dn(e){var t=d(e);function r(r,a){var i=t?m(r*t/2)/t:r/2;if(!a)return[2*i,-e];var s=2*n(i*d(a)),l=1/m(a);return[d(s)*l,a+(1-o(s))*l-e]}r.invert=function(r,i){if(a(i+=e)<g)return[t?2*n(t*r/2)/t:r,0];var s=r*r+i*i,l=0,u=10,c;do{var f=m(l),h=1/o(l),p=s-2*i*l+l*l;l-=c=(f*p+2*(l-i))/(2+p*h*h+2*(l-i)*f)}while(a(c)>g&&--u>0);var v=r*(f=m(l)),y=m(a(i)<a(l+1/f)?L(v)*.5:C(v)*.5+x/4)/d(l);return[t?2*n(t*y)/t:2*y,l]};return r}function mn(){return he(dn).scale(131.215)}var gn=[[.9986,-.062],[1,0],[.9986,.062],[.9954,.124],[.99,.186],[.9822,.248],[.973,.31],[.96,.372],[.9427,.434],[.9216,.4958],[.8962,.5571],[.8679,.6176],[.835,.6769],[.7986,.7346],[.7597,.7903],[.7186,.8435],[.6732,.8936],[.6213,.9394],[.5722,.9761],[.5322,1]];gn.forEach((function(e){e[1]*=1.0144}));function yn(e,t){var r=f(18,a(t)*36/x),n=l(r),i=r-n,o=(v=gn[n])[0],s=v[1],u=(v=gn[++n])[0],c=v[1],h=(v=gn[f(19,++n)])[0],p=v[1],v;return[e*(u+i*(h-o)/2+i*i*(h-2*u+o)/2),(t>0?b:-b)*(c+i*(p-s)/2+i*i*(p-2*c+s)/2)]}yn.invert=function(e,t){var r=t/b,n=r*90,i=f(18,a(n/5)),o=c(0,l(i));do{var s=gn[o][1],u=gn[o+1][1],h=gn[f(19,o+2)][1],p=h-s,v=h-2*u+s,d=2*(a(r)-u)/p,m=v/p,g=d*(1-m*d*(1-2*m*d));if(g>=0||o===1){n=(t>=0?5:-5)*(g+i);var x=50,_;do{i=f(18,a(n)/5);o=l(i);g=i-o;s=gn[o][1];u=gn[o+1][1];h=gn[f(19,o+2)][1];n-=(_=(t>=0?b:-b)*(u+g*(h-s)/2+g*g*(h-2*u+s)/2)-t)*A}while(a(_)>y&&--x>0);break}}while(--o>=0);var w=gn[o][0],T=gn[o+1][0],k=gn[f(19,o+2)][0];return[e/(T+g*(k-w)/2+g*g*(k-2*T+w)/2),n*S]};function xn(){return t.geoProjection(yn).scale(152.63)}function bn(e){function t(t,r){var a=o(r),n=(e-1)/(e-a*o(t));return[n*a*d(t),n*d(r)]}t.invert=function(t,r){var a=t*t+r*r,n=I(a),o=(e-I(1-a*(e+1)/(e-1)))/((e-1)/n+n/(e-1));return[i(t*o,n*I(1-o*o)),n?L(r*o/n):0]};return t}function _n(e,t){var r=bn(e);if(!t)return r;var a=o(t),n=d(t);function i(t,i){var o=r(t,i),s=o[1],l=s*n/(e-1)+a;return[o[0]*a/l,s/l]}i.invert=function(t,i){var o=(e-1)/(e-1-i*n);return r.invert(o*t,o*i*a)};return i}function wn(){var e=2,r=0,a=t.geoProjectionMutator(_n),n=a(e,r);n.distance=function(t){if(!arguments.length)return e;return a(e=+t,r)};n.tilt=function(t){if(!arguments.length)return r*A;return a(e,r=t*S)};return n.scale(432.147).clipAngle(C(1/e)*A-1e-6)}var Tn=1e-4,kn=1e4,Mn=-180,An=Mn+Tn,Sn=180,En=Sn-Tn,Ln=-90,Cn=Ln+Tn,In=90,Pn=In-Tn;function On(e){return e.length>0}function zn(e){return Math.floor(e*kn)/kn}function Dn(e){return e===Ln||e===In?[0,e]:[Mn,zn(e)]}function Rn(e){var t=e[0],r=e[1],a=false;if(t<=An)t=Mn,a=true;else if(t>=En)t=Sn,a=true;if(r<=Cn)r=Ln,a=true;else if(r>=Pn)r=In,a=true;return a?[t,r]:e}function Fn(e){return e.map(Rn)}function Bn(e,t,r){for(var a=0,n=e.length;a<n;++a){var i=e[a].slice();r.push({index:-1,polygon:t,ring:i});for(var o=0,s=i.length;o<s;++o){var l=i[o],u=l[0],c=l[1];if(u<=An||u>=En||c<=Cn||c>=Pn){i[o]=Rn(l);for(var f=o+1;f<s;++f){var h=i[f],p=h[0],v=h[1];if(p>An&&p<En&&v>Cn&&v<Pn)break}if(f===o+1)continue;if(o){var d={index:-1,polygon:t,ring:i.slice(0,o+1)};d.ring[d.ring.length-1]=Dn(c);r[r.length-1]=d}else r.pop();if(f>=s)break;r.push({index:-1,polygon:t,ring:i=i.slice(f-1)});i[0]=Dn(i[0][1]);o=-1;s=i.length}}}}function Nn(e){var t,r=e.length;var a={},n={},i,o,s,l,u;for(t=0;t<r;++t){i=e[t];o=i.ring[0];l=i.ring[i.ring.length-1];if(o[0]===l[0]&&o[1]===l[1]){i.polygon.push(i.ring);e[t]=null;continue}i.index=t;a[o]=n[l]=i}for(t=0;t<r;++t){i=e[t];if(i){o=i.ring[0];l=i.ring[i.ring.length-1];s=n[o];u=a[l];delete a[o];delete n[l];if(o[0]===l[0]&&o[1]===l[1]){i.polygon.push(i.ring);continue}if(s){delete n[o];delete a[s.ring[0]];s.ring.pop();e[s.index]=null;i={index:-1,polygon:s.polygon,ring:s.ring.concat(i.ring)};if(s===u){i.polygon.push(i.ring)}else{i.index=r++;e.push(a[i.ring[0]]=n[i.ring[i.ring.length-1]]=i)}}else if(u){delete a[l];delete n[u.ring[u.ring.length-1]];i.ring.pop();i={index:r++,polygon:u.polygon,ring:i.ring.concat(u.ring)};e[u.index]=null;e.push(a[i.ring[0]]=n[i.ring[i.ring.length-1]]=i)}else{i.ring.push(i.ring[0]);i.polygon.push(i.ring)}}}}function jn(e){var t={type:"Feature",geometry:Un(e.geometry)};if(e.id!=null)t.id=e.id;if(e.bbox!=null)t.bbox=e.bbox;if(e.properties!=null)t.properties=e.properties;return t}function Un(e){if(e==null)return e;var t,r,a,n;switch(e.type){case"GeometryCollection":t={type:"GeometryCollection",geometries:e.geometries.map(Un)};break;case"Point":t={type:"Point",coordinates:Rn(e.coordinates)};break;case"MultiPoint":case"LineString":t={type:e.type,coordinates:Fn(e.coordinates)};break;case"MultiLineString":t={type:"MultiLineString",coordinates:e.coordinates.map(Fn)};break;case"Polygon":{var i=[];Bn(e.coordinates,i,r=[]);Nn(r);t={type:"Polygon",coordinates:i};break}case"MultiPolygon":{r=[],a=-1,n=e.coordinates.length;var o=new Array(n);while(++a<n)Bn(e.coordinates[a],o[a]=[],r);Nn(r);t={type:"MultiPolygon",coordinates:o.filter(On)};break}default:return e}if(e.bbox!=null)t.bbox=e.bbox;return t}function Vn(e){if(e==null)return e;switch(e.type){case"Feature":return jn(e);case"FeatureCollection":{var t={type:"FeatureCollection",features:e.features.map(jn)};if(e.bbox!=null)t.bbox=e.bbox;return t}default:return Un(e)}}function Hn(e,t){var r=m(t/2),a=d(_*r);return[e*(.74482-.34588*a*a),1.70711*r]}Hn.invert=function(e,t){var r=t/1.70711,a=d(_*r);return[e/(.74482-.34588*a*a),2*n(r)]};function qn(){return t.geoProjection(Hn).scale(146.153)}function Gn(e,r,a){var n=t.geoInterpolate(r,a),i=n(.5),o=t.geoRotation([-i[0],-i[1]])(r),s=n.distance/2,l=-L(d(o[1]*S)/d(s)),u=[-i[0],-i[1],-(o[0]>0?x-l:l)*A],c=t.geoProjection(e(s)).rotate(u),f=t.geoRotation(u),h=c.center;delete c.rotate;c.center=function(e){return arguments.length?h(f(e)):f.invert(h())};return c.clipAngle(90)}function Yn(e){var r=o(e);function a(e,a){var n=t.geoGnomonicRaw(e,a);n[0]*=r;return n}a.invert=function(e,a){return t.geoGnomonicRaw.invert(e/r,a)};return a}function Wn(){return Xn([-158,21.5],[-77,39]).clipAngle(60).scale(400)}function Xn(e,t){return Gn(Yn,e,t)}function Zn(e){if(!(e*=2))return t.geoAzimuthalEquidistantRaw;var r=-e/2,a=-r,n=e*e,s=m(a),l=.5/d(a);function u(t,i){var s=C(o(i)*o(t-r)),l=C(o(i)*o(t-a)),u=i<0?-1:1;s*=s,l*=l;return[(s-l)/(2*e),u*I(4*n*l-(n-s+l)*(n-s+l))/(2*e)]}u.invert=function(e,t){var n=t*t,u=o(I(n+(f=e+r)*f)),c=o(I(n+(f=e+a)*f)),f,h;return[i(h=u-c,f=(u+c)*s),(t<0?-1:1)*C(I(f*f+h*h)*l)]};return u}function Jn(){return Kn([-158,21.5],[-77,39]).clipAngle(130).scale(122.571)}function Kn(e,t){return Gn(Zn,e,t)}function Qn(e,t){if(a(t)<g)return[e,0];var r=a(t/b),n=L(r);if(a(e)<g||a(a(t)-b)<g)return[0,v(t)*x*m(n/2)];var i=o(n),s=a(x/e-e/x)/2,l=s*s,u=i/(r+i-1),c=u*(2/r-1),f=c*c,h=f+l,p=u-f,d=l+u;return[v(e)*x*(s*p+I(l*p*p-h*(u*u-f)))/h,v(t)*x*(c*d-s*I((l+1)*h-d*d))/h]}Qn.invert=function(e,t){if(a(t)<g)return[e,0];if(a(e)<g)return[0,b*d(2*n(t/x))];var r=(e/=x)*e,i=(t/=x)*t,s=r+i,l=s*s,u=-a(t)*(1+s),c=u-2*i+r,f=-2*u+1+2*i+l,h=i/f+(2*c*c*c/(f*f*f)-9*u*c/(f*f))/27,p=(u-c*c/(3*f))/f,m=2*I(-p/3),y=C(3*h/(p*m))/3;return[x*(s-1+I(1+2*(r-i)+l))/(2*e),v(t)*x*(-m*o(y+x/3)-c/(3*f))]};function $n(){return t.geoProjection(Qn).scale(79.4183)}function ei(e,t){if(a(t)<g)return[e,0];var r=a(t/b),n=L(r);if(a(e)<g||a(a(t)-b)<g)return[0,v(t)*x*m(n/2)];var i=o(n),s=a(x/e-e/x)/2,l=s*s,u=i*(I(1+l)-s*i)/(1+l*r*r);return[v(e)*x*u,v(t)*x*I(1-u*(2*s+u))]}ei.invert=function(e,t){if(!e)return[0,b*d(2*n(t/x))];var r=a(e/x),o=(1-r*r-(t/=x)*t)/(2*r),s=o*o,l=I(s+1);return[v(e)*x*(l-o),v(t)*b*d(2*i(I((1-2*o*r)*(o+l)-r),I(l+o+r)))]};function ti(){return t.geoProjection(ei).scale(79.4183)}function ri(e,t){if(a(t)<g)return[e,0];var r=t/b,n=L(r);if(a(e)<g||a(a(t)-b)<g)return[0,x*m(n/2)];var i=(x/e-e/x)/2,s=r/(1+o(n));return[x*(v(e)*I(i*i+1-s*s)-i),x*s]}ri.invert=function(e,t){if(!t)return[e,0];var r=t/x,a=(x*x*(1-r*r)-e*e)/(2*x*e);return[e?x*(v(e)*I(a*a+1)-a):0,b*d(2*n(r))]};function ai(){return t.geoProjection(ri).scale(79.4183)}function ni(e,t){if(!t)return[e,0];var r=a(t);if(!e||r===b)return[0,t];var n=r/b,i=n*n,o=(8*n-i*(i+2)-5)/(2*i*(n-1)),s=o*o,l=n*o,u=i+s+2*l,c=n+3*o,f=e/b,h=f+1/f,p=v(a(e)-b)*I(h*h-4),d=p*p,m=u*(i+s*d-1)+(1-i)*(i*(c*c+4*s)+12*l*s+4*s*s),g=(p*(u+s-1)+2*I(m))/(4*u+d);return[v(e)*b*g,v(t)*b*I(1+p*a(g)-g*g)]}ni.invert=function(e,t){var r;if(!e||!t)return[e,t];t/=x;var n=v(e)*e/b,i=(n*n-1+4*t*t)/a(n),o=i*i,s=2*t,l=50;do{var u=s*s,c=(8*s-u*(u+2)-5)/(2*u*(s-1)),f=(3*s-u*s-10)/(2*u*s),h=c*c,p=s*c,d=s+c,m=d*d,y=s+3*c,_=m*(u+h*o-1)+(1-u)*(u*(y*y+4*h)+h*(12*p+4*h)),w=-2*d*(4*p*h+(1-4*u+3*u*u)*(1+f)+h*(-6+14*u-o+(-8+8*u-2*o)*f)+p*(-8+12*u+(-10+10*u-o)*f)),T=I(_),k=i*(m+h-1)+2*T-n*(4*m+o),M=i*(2*c*f+2*d*(1+f))+w/T-8*d*(i*(-1+h+m)+2*T)*(1+f)/(o+4*m);s-=r=k/M}while(r>g&&--l>0);return[v(e)*(I(i*i+4)+i)*x/4,b*s]};function ii(){return t.geoProjection(ni).scale(127.16)}function oi(e,t,r,a,n){function s(i,s){var l=r*d(a*s),u=I(1-l*l),c=I(2/(1+u*o(i*=n)));return[e*u*c*d(i),t*l*c]}s.invert=function(o,s){var l=o/e,u=s/t,c=I(l*l+u*u),f=2*L(c/2);return[i(o*m(f),e*c)/n,c&&L(s*d(f)/(t*r*c))/a]};return s}function si(e,t,r,a){var n=x/3;e=c(e,g);t=c(t,g);e=f(e,b);t=f(t,x-g);r=c(r,0);r=f(r,100-g);a=c(a,g);var i=r/100+1;var s=a/100;var l=C(i*o(n))/n,u=d(e)/d(l*b),h=t/x,p=I(s*d(e/2)/d(t/2)),v=p/I(h*u*l),m=1/(p*I(h*u*l));return oi(v,m,u,l,h)}function li(){var e=65*S,r=60*S,a=20,n=200,i=t.geoProjectionMutator(si),o=i(e,r,a,n);o.poleline=function(t){return arguments.length?i(e=+t*S,r,a,n):e*A};o.parallels=function(t){return arguments.length?i(e,r=+t*S,a,n):r*A};o.inflation=function(t){return arguments.length?i(e,r,a=+t,n):a};o.ratio=function(t){return arguments.length?i(e,r,a,n=+t):n};return o.scale(163.775)}function ui(){return li().poleline(65).parallels(60).inflation(0).ratio(200).scale(172.633)}var ci=4*x+3*I(3),fi=2*I(2*x*I(3)/ci);var hi=ie(fi*I(3)/x,fi,ci/6);function pi(){return t.geoProjection(hi).scale(176.84)}function vi(e,t){return[e*I(1-3*t*t/(x*x)),t]}vi.invert=function(e,t){return[e/I(1-3*t*t/(x*x)),t]};function di(){return t.geoProjection(vi).scale(152.63)}function mi(e,t){var r=o(t),a=o(e)*r,n=1-a,s=o(e=i(d(e)*r,-d(t))),l=d(e);r=I(1-a*a);return[l*r-s*n,-s*r-l*n]}mi.invert=function(e,t){var r=(e*e+t*t)/-2,a=I(-r*(2+r)),n=t*r+e*a,o=e*r-t*a,s=I(o*o+n*n);return[i(a*n,s*(1+r)),s?-L(a*o/s):0]};function gi(){return t.geoProjection(mi).rotate([0,-90,45]).scale(124.75).clipAngle(180-.001)}function yi(e,t){var r=N(e,t);return[(r[0]+e/b)/2,(r[1]+t)/2]}yi.invert=function(e,t){var r=e,n=t,i=25;do{var s=o(n),l=d(n),u=d(2*n),c=l*l,f=s*s,h=d(r),p=o(r/2),v=d(r/2),m=v*v,y=1-f*p*p,x=y?C(s*p)*I(_=1/y):_=0,_,w=.5*(2*x*s*v+r/b)-e,T=.5*(x*l+n)-t,k=.5*_*(f*m+x*s*p*c)+.5/b,M=_*(h*u/4-x*l*v),A=.125*_*(u*v-x*l*f*h),S=.5*_*(c*p+x*m*s)+.5,E=M*A-S*k,L=(T*M-w*S)/E,P=(w*A-T*k)/E;r-=L,n-=P}while((a(L)>g||a(P)>g)&&--i>0);return[r,n]};function xi(){return t.geoProjection(yi).scale(158.837)}e.geoNaturalEarth=t.geoNaturalEarth1;e.geoNaturalEarthRaw=t.geoNaturalEarth1Raw;e.geoAiry=B;e.geoAiryRaw=F;e.geoAitoff=j;e.geoAitoffRaw=N;e.geoArmadillo=V;e.geoArmadilloRaw=U;e.geoAugust=q;e.geoAugustRaw=H;e.geoBaker=X;e.geoBakerRaw=W;e.geoBerghaus=J;e.geoBerghausRaw=Z;e.geoBertin1953=ae;e.geoBertin1953Raw=re;e.geoBoggs=fe;e.geoBoggsRaw=ce;e.geoBonne=me;e.geoBonneRaw=de;e.geoBottomley=ye;e.geoBottomleyRaw=ge;e.geoBromley=be;e.geoBromleyRaw=xe;e.geoChamberlin=Se;e.geoChamberlinRaw=ke;e.geoChamberlinAfrica=Ae;e.geoCollignon=Le;e.geoCollignonRaw=Ee;e.geoCraig=Ie;e.geoCraigRaw=Ce;e.geoCraster=ze;e.geoCrasterRaw=Oe;e.geoCylindricalEqualArea=Re;e.geoCylindricalEqualAreaRaw=De;e.geoCylindricalStereographic=Be;e.geoCylindricalStereographicRaw=Fe;e.geoEckert1=je;e.geoEckert1Raw=Ne;e.geoEckert2=Ve;e.geoEckert2Raw=Ue;e.geoEckert3=qe;e.geoEckert3Raw=He;e.geoEckert4=Ye;e.geoEckert4Raw=Ge;e.geoEckert5=Xe;e.geoEckert5Raw=We;e.geoEckert6=Je;e.geoEckert6Raw=Ze;e.geoEisenlohr=$e;e.geoEisenlohrRaw=Qe;e.geoFahey=rt;e.geoFaheyRaw=tt;e.geoFoucaut=nt;e.geoFoucautRaw=at;e.geoFoucautSinusoidal=ot;e.geoFoucautSinusoidalRaw=it;e.geoGilbert=ut;e.geoGingery=pt;e.geoGingeryRaw=ct;e.geoGinzburg4=mt;e.geoGinzburg4Raw=dt;e.geoGinzburg5=yt;e.geoGinzburg5Raw=gt;e.geoGinzburg6=bt;e.geoGinzburg6Raw=xt;e.geoGinzburg8=wt;e.geoGinzburg8Raw=_t;e.geoGinzburg9=kt;e.geoGinzburg9Raw=Tt;e.geoGringorten=Lt;e.geoGringortenRaw=At;e.geoGuyou=Ft;e.geoGuyouRaw=zt;e.geoHammer=$;e.geoHammerRaw=K;e.geoHammerRetroazimuthal=jt;e.geoHammerRetroazimuthalRaw=Bt;e.geoHealpix=Zt;e.geoHealpixRaw=qt;e.geoHill=Kt;e.geoHillRaw=Jt;e.geoHomolosine=ar;e.geoHomolosineRaw=rr;e.geoHufnagel=ir;e.geoHufnagelRaw=nr;e.geoHyperelliptical=ur;e.geoHyperellipticalRaw=lr;e.geoInterrupt=pr;e.geoInterruptedBoggs=dr;e.geoInterruptedHomolosine=gr;e.geoInterruptedMollweide=xr;e.geoInterruptedMollweideHemispheres=_r;e.geoInterruptedSinuMollweide=Tr;e.geoInterruptedSinusoidal=Mr;e.geoKavrayskiy7=Sr;e.geoKavrayskiy7Raw=Ar;e.geoLagrange=Lr;e.geoLagrangeRaw=Er;e.geoLarrivee=Pr;e.geoLarriveeRaw=Ir;e.geoLaskowski=zr;e.geoLaskowskiRaw=Or;e.geoLittrow=Rr;e.geoLittrowRaw=Dr;e.geoLoximuthal=Br;e.geoLoximuthalRaw=Fr;e.geoMiller=jr;e.geoMillerRaw=Nr;e.geoModifiedStereographic=Qr;e.geoModifiedStereographicRaw=Ur;e.geoModifiedStereographicAlaska=Wr;e.geoModifiedStereographicGs48=Xr;e.geoModifiedStereographicGs50=Zr;e.geoModifiedStereographicMiller=Jr;e.geoModifiedStereographicLee=Kr;e.geoMollweide=se;e.geoMollweideRaw=oe;e.geoMtFlatPolarParabolic=ra;e.geoMtFlatPolarParabolicRaw=ta;e.geoMtFlatPolarQuartic=na;e.geoMtFlatPolarQuarticRaw=aa;e.geoMtFlatPolarSinusoidal=oa;e.geoMtFlatPolarSinusoidalRaw=ia;e.geoNaturalEarth2=la;e.geoNaturalEarth2Raw=sa;e.geoNellHammer=ca;e.geoNellHammerRaw=ua;e.geoInterruptedQuarticAuthalic=ha;e.geoNicolosi=va;e.geoNicolosiRaw=pa;e.geoPatterson=Ma;e.geoPattersonRaw=ka;e.geoPolyconic=Sa;e.geoPolyconicRaw=Aa;e.geoPolyhedral=za;e.geoPolyhedralButterfly=Va;e.geoPolyhedralCollignon=Ga;e.geoPolyhedralWaterman=Ya;e.geoProject=en;e.geoGringortenQuincuncial=hn;e.geoPeirceQuincuncial=pn;e.geoPierceQuincuncial=pn;e.geoQuantize=vn;e.geoQuincuncial=fn;e.geoRectangularPolyconic=mn;e.geoRectangularPolyconicRaw=dn;e.geoRobinson=xn;e.geoRobinsonRaw=yn;e.geoSatellite=wn;e.geoSatelliteRaw=_n;e.geoSinuMollweide=tr;e.geoSinuMollweideRaw=er;e.geoSinusoidal=ve;e.geoSinusoidalRaw=pe;e.geoStitch=Vn;e.geoTimes=qn;e.geoTimesRaw=Hn;e.geoTwoPointAzimuthal=Xn;e.geoTwoPointAzimuthalRaw=Yn;e.geoTwoPointAzimuthalUsa=Wn;e.geoTwoPointEquidistant=Kn;e.geoTwoPointEquidistantRaw=Zn;e.geoTwoPointEquidistantUsa=Jn;e.geoVanDerGrinten=$n;e.geoVanDerGrintenRaw=Qn;e.geoVanDerGrinten2=ti;e.geoVanDerGrinten2Raw=ei;e.geoVanDerGrinten3=ai;e.geoVanDerGrinten3Raw=ri;e.geoVanDerGrinten4=ii;e.geoVanDerGrinten4Raw=ni;e.geoWagner=li;e.geoWagner7=ui;e.geoWagnerRaw=si;e.geoWagner4=pi;e.geoWagner4Raw=hi;e.geoWagner6=di;e.geoWagner6Raw=vi;e.geoWiechel=gi;e.geoWiechelRaw=mi;e.geoWinkel3=xi;e.geoWinkel3Raw=yi;Object.defineProperty(e,"__esModule",{value:true})}))},{"d3-array":159,"d3-geo":166}],166:[function(t,r,a){(function(n,i){typeof a==="object"&&typeof r!=="undefined"?i(a,t("d3-array")):typeof e==="function"&&e.amd?e(["exports","d3-array"],i):(n=n||self,i(n.d3=n.d3||{},n.d3))})(this,(function(e,t){"use strict";function r(){return new a}function a(){this.reset()}a.prototype={constructor:a,reset:function(){this.s=this.t=0},add:function(e){i(n,e,this.t);i(this,n.s,this.s);if(this.s)this.t+=n.t;else this.s=n.t},valueOf:function(){return this.s}};var n=new a;function i(e,t,r){var a=e.s=t+r,n=a-t,i=a-n;e.t=t-i+(r-n)}var o=1e-6;var s=1e-12;var l=Math.PI;var u=l/2;var c=l/4;var f=l*2;var h=180/l;var p=l/180;var v=Math.abs;var d=Math.atan;var m=Math.atan2;var g=Math.cos;var y=Math.ceil;var x=Math.exp;var b=Math.log;var _=Math.pow;var w=Math.sin;var T=Math.sign||function(e){return e>0?1:e<0?-1:0};var k=Math.sqrt;var M=Math.tan;function A(e){return e>1?0:e<-1?l:Math.acos(e)}function S(e){return e>1?u:e<-1?-u:Math.asin(e)}function E(e){return(e=w(e/2))*e}function L(){}function C(e,t){if(e&&P.hasOwnProperty(e.type)){P[e.type](e,t)}}var I={Feature:function(e,t){C(e.geometry,t)},FeatureCollection:function(e,t){var r=e.features,a=-1,n=r.length;while(++a<n)C(r[a].geometry,t)}};var P={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates;t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){var r=e.coordinates,a=-1,n=r.length;while(++a<n)e=r[a],t.point(e[0],e[1],e[2])},LineString:function(e,t){O(e.coordinates,t,0)},MultiLineString:function(e,t){var r=e.coordinates,a=-1,n=r.length;while(++a<n)O(r[a],t,0)},Polygon:function(e,t){z(e.coordinates,t)},MultiPolygon:function(e,t){var r=e.coordinates,a=-1,n=r.length;while(++a<n)z(r[a],t)},GeometryCollection:function(e,t){var r=e.geometries,a=-1,n=r.length;while(++a<n)C(r[a],t)}};function O(e,t,r){var a=-1,n=e.length-r,i;t.lineStart();while(++a<n)i=e[a],t.point(i[0],i[1],i[2]);t.lineEnd()}function z(e,t){var r=-1,a=e.length;t.polygonStart();while(++r<a)O(e[r],t,1);t.polygonEnd()}function D(e,t){if(e&&I.hasOwnProperty(e.type)){I[e.type](e,t)}else{C(e,t)}}var R=r();var F=r(),B,N,j,U,V;var H={point:L,lineStart:L,lineEnd:L,polygonStart:function(){R.reset();H.lineStart=q;H.lineEnd=G},polygonEnd:function(){var e=+R;F.add(e<0?f+e:e);this.lineStart=this.lineEnd=this.point=L},sphere:function(){F.add(f)}};function q(){H.point=Y}function G(){W(B,N)}function Y(e,t){H.point=W;B=e,N=t;e*=p,t*=p;j=e,U=g(t=t/2+c),V=w(t)}function W(e,t){e*=p,t*=p;t=t/2+c;var r=e-j,a=r>=0?1:-1,n=a*r,i=g(t),o=w(t),s=V*o,l=U*i+s*g(n),u=s*a*w(n);R.add(m(u,l));j=e,U=i,V=o}function X(e){F.reset();D(e,H);return F*2}function Z(e){return[m(e[1],e[0]),S(e[2])]}function J(e){var t=e[0],r=e[1],a=g(r);return[a*g(t),a*w(t),w(r)]}function K(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function Q(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function $(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function ee(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function te(e){var t=k(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}var re,ae,ne,ie,oe,se,le,ue,ce=r(),fe,he;var pe={point:ve,lineStart:me,lineEnd:ge,polygonStart:function(){pe.point=ye;pe.lineStart=xe;pe.lineEnd=be;ce.reset();H.polygonStart()},polygonEnd:function(){H.polygonEnd();pe.point=ve;pe.lineStart=me;pe.lineEnd=ge;if(R<0)re=-(ne=180),ae=-(ie=90);else if(ce>o)ie=90;else if(ce<-o)ae=-90;he[0]=re,he[1]=ne},sphere:function(){re=-(ne=180),ae=-(ie=90)}};function ve(e,t){fe.push(he=[re=e,ne=e]);if(t<ae)ae=t;if(t>ie)ie=t}function de(e,t){var r=J([e*p,t*p]);if(ue){var a=Q(ue,r),n=[a[1],-a[0],0],i=Q(n,a);te(i);i=Z(i);var o=e-oe,s=o>0?1:-1,l=i[0]*h*s,u,c=v(o)>180;if(c^(s*oe<l&&l<s*e)){u=i[1]*h;if(u>ie)ie=u}else if(l=(l+360)%360-180,c^(s*oe<l&&l<s*e)){u=-i[1]*h;if(u<ae)ae=u}else{if(t<ae)ae=t;if(t>ie)ie=t}if(c){if(e<oe){if(_e(re,e)>_e(re,ne))ne=e}else{if(_e(e,ne)>_e(re,ne))re=e}}else{if(ne>=re){if(e<re)re=e;if(e>ne)ne=e}else{if(e>oe){if(_e(re,e)>_e(re,ne))ne=e}else{if(_e(e,ne)>_e(re,ne))re=e}}}}else{fe.push(he=[re=e,ne=e])}if(t<ae)ae=t;if(t>ie)ie=t;ue=r,oe=e}function me(){pe.point=de}function ge(){he[0]=re,he[1]=ne;pe.point=ve;ue=null}function ye(e,t){if(ue){var r=e-oe;ce.add(v(r)>180?r+(r>0?360:-360):r)}else{se=e,le=t}H.point(e,t);de(e,t)}function xe(){H.lineStart()}function be(){ye(se,le);H.lineEnd();if(v(ce)>o)re=-(ne=180);he[0]=re,he[1]=ne;ue=null}function _e(e,t){return(t-=e)<0?t+360:t}function we(e,t){return e[0]-t[0]}function Te(e,t){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}function ke(e){var t,r,a,n,i,o,s;ie=ne=-(re=ae=Infinity);fe=[];D(e,pe);if(r=fe.length){fe.sort(we);for(t=1,a=fe[0],i=[a];t<r;++t){n=fe[t];if(Te(a,n[0])||Te(a,n[1])){if(_e(a[0],n[1])>_e(a[0],a[1]))a[1]=n[1];if(_e(n[0],a[1])>_e(a[0],a[1]))a[0]=n[0]}else{i.push(a=n)}}for(o=-Infinity,r=i.length-1,t=0,a=i[r];t<=r;a=n,++t){n=i[t];if((s=_e(a[1],n[0]))>o)o=s,re=n[0],ne=a[1]}}fe=he=null;return re===Infinity||ae===Infinity?[[NaN,NaN],[NaN,NaN]]:[[re,ae],[ne,ie]]}var Me,Ae,Se,Ee,Le,Ce,Ie,Pe,Oe,ze,De,Re,Fe,Be,Ne,je;var Ue={sphere:L,point:Ve,lineStart:qe,lineEnd:We,polygonStart:function(){Ue.lineStart=Xe;Ue.lineEnd=Ze},polygonEnd:function(){Ue.lineStart=qe;Ue.lineEnd=We}};function Ve(e,t){e*=p,t*=p;var r=g(t);He(r*g(e),r*w(e),w(t))}function He(e,t,r){++Me;Se+=(e-Se)/Me;Ee+=(t-Ee)/Me;Le+=(r-Le)/Me}function qe(){Ue.point=Ge}function Ge(e,t){e*=p,t*=p;var r=g(t);Be=r*g(e);Ne=r*w(e);je=w(t);Ue.point=Ye;He(Be,Ne,je)}function Ye(e,t){e*=p,t*=p;var r=g(t),a=r*g(e),n=r*w(e),i=w(t),o=m(k((o=Ne*i-je*n)*o+(o=je*a-Be*i)*o+(o=Be*n-Ne*a)*o),Be*a+Ne*n+je*i);Ae+=o;Ce+=o*(Be+(Be=a));Ie+=o*(Ne+(Ne=n));Pe+=o*(je+(je=i));He(Be,Ne,je)}function We(){Ue.point=Ve}function Xe(){Ue.point=Je}function Ze(){Ke(Re,Fe);Ue.point=Ve}function Je(e,t){Re=e,Fe=t;e*=p,t*=p;Ue.point=Ke;var r=g(t);Be=r*g(e);Ne=r*w(e);je=w(t);He(Be,Ne,je)}function Ke(e,t){e*=p,t*=p;var r=g(t),a=r*g(e),n=r*w(e),i=w(t),o=Ne*i-je*n,s=je*a-Be*i,l=Be*n-Ne*a,u=k(o*o+s*s+l*l),c=S(u),f=u&&-c/u;Oe+=f*o;ze+=f*s;De+=f*l;Ae+=c;Ce+=c*(Be+(Be=a));Ie+=c*(Ne+(Ne=n));Pe+=c*(je+(je=i));He(Be,Ne,je)}function Qe(e){Me=Ae=Se=Ee=Le=Ce=Ie=Pe=Oe=ze=De=0;D(e,Ue);var t=Oe,r=ze,a=De,n=t*t+r*r+a*a;if(n<s){t=Ce,r=Ie,a=Pe;if(Ae<o)t=Se,r=Ee,a=Le;n=t*t+r*r+a*a;if(n<s)return[NaN,NaN]}return[m(r,t)*h,S(a/k(n))*h]}function $e(e){return function(){return e}}function et(e,t){function r(r,a){return r=e(r,a),t(r[0],r[1])}if(e.invert&&t.invert)r.invert=function(r,a){return r=t.invert(r,a),r&&e.invert(r[0],r[1])};return r}function tt(e,t){return[v(e)>l?e+Math.round(-e/f)*f:e,t]}tt.invert=tt;function rt(e,t,r){return(e%=f)?t||r?et(nt(e),it(t,r)):nt(e):t||r?it(t,r):tt}function at(e){return function(t,r){return t+=e,[t>l?t-f:t<-l?t+f:t,r]}}function nt(e){var t=at(e);t.invert=at(-e);return t}function it(e,t){var r=g(e),a=w(e),n=g(t),i=w(t);function o(e,t){var o=g(t),s=g(e)*o,l=w(e)*o,u=w(t),c=u*r+s*a;return[m(l*n-c*i,s*r-u*a),S(c*n+l*i)]}o.invert=function(e,t){var o=g(t),s=g(e)*o,l=w(e)*o,u=w(t),c=u*n-l*i;return[m(l*n+u*i,s*r+c*a),S(c*r-s*a)]};return o}function ot(e){e=rt(e[0]*p,e[1]*p,e.length>2?e[2]*p:0);function t(t){t=e(t[0]*p,t[1]*p);return t[0]*=h,t[1]*=h,t}t.invert=function(t){t=e.invert(t[0]*p,t[1]*p);return t[0]*=h,t[1]*=h,t};return t}function st(e,t,r,a,n,i){if(!r)return;var o=g(t),s=w(t),l=a*r;if(n==null){n=t+a*f;i=t-l/2}else{n=lt(o,n);i=lt(o,i);if(a>0?n<i:n>i)n+=a*f}for(var u,c=n;a>0?c>i:c<i;c-=l){u=Z([o,-s*g(c),-s*w(c)]);e.point(u[0],u[1])}}function lt(e,t){t=J(t),t[0]-=e;te(t);var r=A(-t[1]);return((-t[2]<0?-r:r)+f-o)%f}function ut(){var e=$e([0,0]),t=$e(90),r=$e(6),a,n,i={point:o};function o(e,t){a.push(e=n(e,t));e[0]*=h,e[1]*=h}function s(){var o=e.apply(this,arguments),s=t.apply(this,arguments)*p,l=r.apply(this,arguments)*p;a=[];n=rt(-o[0]*p,-o[1]*p,0).invert;st(i,s,l,1);o={type:"Polygon",coordinates:[a]};a=n=null;return o}s.center=function(t){return arguments.length?(e=typeof t==="function"?t:$e([+t[0],+t[1]]),s):e};s.radius=function(e){return arguments.length?(t=typeof e==="function"?e:$e(+e),s):t};s.precision=function(e){return arguments.length?(r=typeof e==="function"?e:$e(+e),s):r};return s}function ct(){var e=[],t;return{point:function(e,r,a){t.push([e,r,a])},lineStart:function(){e.push(t=[])},lineEnd:L,rejoin:function(){if(e.length>1)e.push(e.pop().concat(e.shift()))},result:function(){var r=e;e=[];t=null;return r}}}function ft(e,t){return v(e[0]-t[0])<o&&v(e[1]-t[1])<o}function ht(e,t,r,a){this.x=e;this.z=t;this.o=r;this.e=a;this.v=false;this.n=this.p=null}function pt(e,t,r,a,n){var i=[],s=[],l,u;e.forEach((function(e){if((t=e.length-1)<=0)return;var t,r=e[0],a=e[t],u;if(ft(r,a)){if(!r[2]&&!a[2]){n.lineStart();for(l=0;l<t;++l)n.point((r=e[l])[0],r[1]);n.lineEnd();return}a[0]+=2*o}i.push(u=new ht(r,e,null,true));s.push(u.o=new ht(r,null,u,false));i.push(u=new ht(a,e,null,false));s.push(u.o=new ht(a,null,u,true))}));if(!i.length)return;s.sort(t);vt(i);vt(s);for(l=0,u=s.length;l<u;++l){s[l].e=r=!r}var c=i[0],f,h;while(1){var p=c,v=true;while(p.v)if((p=p.n)===c)return;f=p.z;n.lineStart();do{p.v=p.o.v=true;if(p.e){if(v){for(l=0,u=f.length;l<u;++l)n.point((h=f[l])[0],h[1])}else{a(p.x,p.n.x,1,n)}p=p.n}else{if(v){f=p.p.z;for(l=f.length-1;l>=0;--l)n.point((h=f[l])[0],h[1])}else{a(p.x,p.p.x,-1,n)}p=p.p}p=p.o;f=p.z;v=!v}while(!p.v);n.lineEnd()}}function vt(e){if(!(t=e.length))return;var t,r=0,a=e[0],n;while(++r<t){a.n=n=e[r];n.p=a;a=n}a.n=n=e[0];n.p=a}var dt=r();function mt(e){if(v(e[0])<=l)return e[0];else return T(e[0])*((v(e[0])+l)%f-l)}function gt(e,t){var r=mt(t),a=t[1],n=w(a),i=[w(r),-g(r),0],s=0,h=0;dt.reset();if(n===1)a=u+o;else if(n===-1)a=-u-o;for(var p=0,v=e.length;p<v;++p){if(!(y=(d=e[p]).length))continue;var d,y,x=d[y-1],b=mt(x),_=x[1]/2+c,T=w(_),k=g(_);for(var M=0;M<y;++M,b=E,T=C,k=I,x=A){var A=d[M],E=mt(A),L=A[1]/2+c,C=w(L),I=g(L),P=E-b,O=P>=0?1:-1,z=O*P,D=z>l,R=T*C;dt.add(m(R*O*w(z),k*I+R*g(z)));s+=D?P+O*f:P;if(D^b>=r^E>=r){var F=Q(J(x),J(A));te(F);var B=Q(i,F);te(B);var N=(D^P>=0?-1:1)*S(B[2]);if(a>N||a===N&&(F[0]||F[1])){h+=D^P>=0?1:-1}}}}return(s<-o||s<o&&dt<-o)^h&1}function yt(e,r,a,n){return function(i){var o=r(i),s=ct(),l=r(s),u=false,c,f,h;var p={point:v,lineStart:m,lineEnd:g,polygonStart:function(){p.point=y;p.lineStart=x;p.lineEnd=b;f=[];c=[]},polygonEnd:function(){p.point=v;p.lineStart=m;p.lineEnd=g;f=t.merge(f);var e=gt(c,n);if(f.length){if(!u)i.polygonStart(),u=true;pt(f,bt,e,a,i)}else if(e){if(!u)i.polygonStart(),u=true;i.lineStart();a(null,null,1,i);i.lineEnd()}if(u)i.polygonEnd(),u=false;f=c=null},sphere:function(){i.polygonStart();i.lineStart();a(null,null,1,i);i.lineEnd();i.polygonEnd()}};function v(t,r){if(e(t,r))i.point(t,r)}function d(e,t){o.point(e,t)}function m(){p.point=d;o.lineStart()}function g(){p.point=v;o.lineEnd()}function y(e,t){h.push([e,t]);l.point(e,t)}function x(){l.lineStart();h=[]}function b(){y(h[0][0],h[0][1]);l.lineEnd();var e=l.clean(),t=s.result(),r,a=t.length,n,o,p;h.pop();c.push(h);h=null;if(!a)return;if(e&1){o=t[0];if((n=o.length-1)>0){if(!u)i.polygonStart(),u=true;i.lineStart();for(r=0;r<n;++r)i.point((p=o[r])[0],p[1]);i.lineEnd()}return}if(a>1&&e&2)t.push(t.pop().concat(t.shift()));f.push(t.filter(xt))}return p}}function xt(e){return e.length>1}function bt(e,t){return((e=e.x)[0]<0?e[1]-u-o:u-e[1])-((t=t.x)[0]<0?t[1]-u-o:u-t[1])}var _t=yt((function(){return true}),wt,kt,[-l,-u]);function wt(e){var t=NaN,r=NaN,a=NaN,n;return{lineStart:function(){e.lineStart();n=1},point:function(i,s){var c=i>0?l:-l,f=v(i-t);if(v(f-l)<o){e.point(t,r=(r+s)/2>0?u:-u);e.point(a,r);e.lineEnd();e.lineStart();e.point(c,r);e.point(i,r);n=0}else if(a!==c&&f>=l){if(v(t-a)<o)t-=a*o;if(v(i-c)<o)i-=c*o;r=Tt(t,r,i,s);e.point(a,r);e.lineEnd();e.lineStart();e.point(c,r);n=0}e.point(t=i,r=s);a=c},lineEnd:function(){e.lineEnd();t=r=NaN},clean:function(){return 2-n}}}function Tt(e,t,r,a){var n,i,s=w(e-r);return v(s)>o?d((w(t)*(i=g(a))*w(r)-w(a)*(n=g(t))*w(e))/(n*i*s)):(t+a)/2}function kt(e,t,r,a){var n;if(e==null){n=r*u;a.point(-l,n);a.point(0,n);a.point(l,n);a.point(l,0);a.point(l,-n);a.point(0,-n);a.point(-l,-n);a.point(-l,0);a.point(-l,n)}else if(v(e[0]-t[0])>o){var i=e[0]<t[0]?l:-l;n=r*i/2;a.point(-i,n);a.point(0,n);a.point(i,n)}else{a.point(t[0],t[1])}}function Mt(e){var t=g(e),r=6*p,a=t>0,n=v(t)>o;function i(t,a,n,i){st(i,e,r,n,t,a)}function s(e,r){return g(e)*g(r)>t}function u(e){var t,r,i,o,u;return{lineStart:function(){o=i=false;u=1},point:function(h,p){var v=[h,p],d,m=s(h,p),g=a?m?0:f(h,p):m?f(h+(h<0?l:-l),p):0;if(!t&&(o=i=m))e.lineStart();if(m!==i){d=c(t,v);if(!d||ft(t,d)||ft(v,d))v[2]=1}if(m!==i){u=0;if(m){e.lineStart();d=c(v,t);e.point(d[0],d[1])}else{d=c(t,v);e.point(d[0],d[1],2);e.lineEnd()}t=d}else if(n&&t&&a^m){var y;if(!(g&r)&&(y=c(v,t,true))){u=0;if(a){e.lineStart();e.point(y[0][0],y[0][1]);e.point(y[1][0],y[1][1]);e.lineEnd()}else{e.point(y[1][0],y[1][1]);e.lineEnd();e.lineStart();e.point(y[0][0],y[0][1],3)}}}if(m&&(!t||!ft(t,v))){e.point(v[0],v[1])}t=v,i=m,r=g},lineEnd:function(){if(i)e.lineEnd();t=null},clean:function(){return u|(o&&i)<<1}}}function c(e,r,a){var n=J(e),i=J(r);var s=[1,0,0],u=Q(n,i),c=K(u,u),f=u[0],h=c-f*f;if(!h)return!a&&e;var p=t*c/h,d=-t*f/h,m=Q(s,u),g=ee(s,p),y=ee(u,d);$(g,y);var x=m,b=K(g,x),_=K(x,x),w=b*b-_*(K(g,g)-1);if(w<0)return;var T=k(w),M=ee(x,(-b-T)/_);$(M,g);M=Z(M);if(!a)return M;var A=e[0],S=r[0],E=e[1],L=r[1],C;if(S<A)C=A,A=S,S=C;var I=S-A,P=v(I-l)<o,O=P||I<o;if(!P&&L<E)C=E,E=L,L=C;if(O?P?E+L>0^M[1]<(v(M[0]-A)<o?E:L):E<=M[1]&&M[1]<=L:I>l^(A<=M[0]&&M[0]<=S)){var z=ee(x,(-b+T)/_);$(z,g);return[M,Z(z)]}}function f(t,r){var n=a?e:l-e,i=0;if(t<-n)i|=1;else if(t>n)i|=2;if(r<-n)i|=4;else if(r>n)i|=8;return i}return yt(s,u,i,a?[0,-e]:[-l,e-l])}function At(e,t,r,a,n,i){var o=e[0],s=e[1],l=t[0],u=t[1],c=0,f=1,h=l-o,p=u-s,v;v=r-o;if(!h&&v>0)return;v/=h;if(h<0){if(v<c)return;if(v<f)f=v}else if(h>0){if(v>f)return;if(v>c)c=v}v=n-o;if(!h&&v<0)return;v/=h;if(h<0){if(v>f)return;if(v>c)c=v}else if(h>0){if(v<c)return;if(v<f)f=v}v=a-s;if(!p&&v>0)return;v/=p;if(p<0){if(v<c)return;if(v<f)f=v}else if(p>0){if(v>f)return;if(v>c)c=v}v=i-s;if(!p&&v<0)return;v/=p;if(p<0){if(v>f)return;if(v>c)c=v}else if(p>0){if(v<c)return;if(v<f)f=v}if(c>0)e[0]=o+c*h,e[1]=s+c*p;if(f<1)t[0]=o+f*h,t[1]=s+f*p;return true}var St=1e9,Et=-St;function Lt(e,r,a,n){function i(t,i){return e<=t&&t<=a&&r<=i&&i<=n}function s(t,i,o,s){var u=0,f=0;if(t==null||(u=l(t,o))!==(f=l(i,o))||c(t,i)<0^o>0){do{s.point(u===0||u===3?e:a,u>1?n:r)}while((u=(u+o+4)%4)!==f)}else{s.point(i[0],i[1])}}function l(t,n){return v(t[0]-e)<o?n>0?0:3:v(t[0]-a)<o?n>0?2:1:v(t[1]-r)<o?n>0?1:0:n>0?3:2}function u(e,t){return c(e.x,t.x)}function c(e,t){var r=l(e,1),a=l(t,1);return r!==a?r-a:r===0?t[1]-e[1]:r===1?e[0]-t[0]:r===2?e[1]-t[1]:t[0]-e[0]}return function(o){var l=o,c=ct(),f,h,p,v,d,m,g,y,x,b,_;var w={point:T,lineStart:S,lineEnd:E,polygonStart:M,polygonEnd:A};function T(e,t){if(i(e,t))l.point(e,t)}function k(){var t=0;for(var r=0,a=h.length;r<a;++r){for(var i=h[r],o=1,s=i.length,l=i[0],u,c,f=l[0],p=l[1];o<s;++o){u=f,c=p,l=i[o],f=l[0],p=l[1];if(c<=n){if(p>n&&(f-u)*(n-c)>(p-c)*(e-u))++t}else{if(p<=n&&(f-u)*(n-c)<(p-c)*(e-u))--t}}}return t}function M(){l=c,f=[],h=[],_=true}function A(){var e=k(),r=_&&e,a=(f=t.merge(f)).length;if(r||a){o.polygonStart();if(r){o.lineStart();s(null,null,1,o);o.lineEnd()}if(a){pt(f,u,e,s,o)}o.polygonEnd()}l=o,f=h=p=null}function S(){w.point=L;if(h)h.push(p=[]);b=true;x=false;g=y=NaN}function E(){if(f){L(v,d);if(m&&x)c.rejoin();f.push(c.result())}w.point=T;if(x)l.lineEnd()}function L(t,o){var s=i(t,o);if(h)p.push([t,o]);if(b){v=t,d=o,m=s;b=false;if(s){l.lineStart();l.point(t,o)}}else{if(s&&x)l.point(t,o);else{var u=[g=Math.max(Et,Math.min(St,g)),y=Math.max(Et,Math.min(St,y))],c=[t=Math.max(Et,Math.min(St,t)),o=Math.max(Et,Math.min(St,o))];if(At(u,c,e,r,a,n)){if(!x){l.lineStart();l.point(u[0],u[1])}l.point(c[0],c[1]);if(!s)l.lineEnd();_=false}else if(s){l.lineStart();l.point(t,o);_=false}}}g=t,y=o,x=s}return w}}function Ct(){var e=0,t=0,r=960,a=500,n,i,o;return o={stream:function(o){return n&&i===o?n:n=Lt(e,t,r,a)(i=o)},extent:function(s){return arguments.length?(e=+s[0][0],t=+s[0][1],r=+s[1][0],a=+s[1][1],n=i=null,o):[[e,t],[r,a]]}}}var It=r(),Pt,Ot,zt;var Dt={sphere:L,point:L,lineStart:Rt,lineEnd:L,polygonStart:L,polygonEnd:L};function Rt(){Dt.point=Bt;Dt.lineEnd=Ft}function Ft(){Dt.point=Dt.lineEnd=L}function Bt(e,t){e*=p,t*=p;Pt=e,Ot=w(t),zt=g(t);Dt.point=Nt}function Nt(e,t){e*=p,t*=p;var r=w(t),a=g(t),n=v(e-Pt),i=g(n),o=w(n),s=a*o,l=zt*r-Ot*a*i,u=Ot*r+zt*a*i;It.add(m(k(s*s+l*l),u));Pt=e,Ot=r,zt=a}function jt(e){It.reset();D(e,Dt);return+It}var Ut=[null,null],Vt={type:"LineString",coordinates:Ut};function Ht(e,t){Ut[0]=e;Ut[1]=t;return jt(Vt)}var qt={Feature:function(e,t){return Yt(e.geometry,t)},FeatureCollection:function(e,t){var r=e.features,a=-1,n=r.length;while(++a<n)if(Yt(r[a].geometry,t))return true;return false}};var Gt={Sphere:function(){return true},Point:function(e,t){return Wt(e.coordinates,t)},MultiPoint:function(e,t){var r=e.coordinates,a=-1,n=r.length;while(++a<n)if(Wt(r[a],t))return true;return false},LineString:function(e,t){return Xt(e.coordinates,t)},MultiLineString:function(e,t){var r=e.coordinates,a=-1,n=r.length;while(++a<n)if(Xt(r[a],t))return true;return false},Polygon:function(e,t){return Zt(e.coordinates,t)},MultiPolygon:function(e,t){var r=e.coordinates,a=-1,n=r.length;while(++a<n)if(Zt(r[a],t))return true;return false},GeometryCollection:function(e,t){var r=e.geometries,a=-1,n=r.length;while(++a<n)if(Yt(r[a],t))return true;return false}};function Yt(e,t){return e&&Gt.hasOwnProperty(e.type)?Gt[e.type](e,t):false}function Wt(e,t){return Ht(e,t)===0}function Xt(e,t){var r,a,n;for(var i=0,o=e.length;i<o;i++){a=Ht(e[i],t);if(a===0)return true;if(i>0){n=Ht(e[i],e[i-1]);if(n>0&&r<=n&&a<=n&&(r+a-n)*(1-Math.pow((r-a)/n,2))<s*n)return true}r=a}return false}function Zt(e,t){return!!gt(e.map(Jt),Kt(t))}function Jt(e){return e=e.map(Kt),e.pop(),e}function Kt(e){return[e[0]*p,e[1]*p]}function Qt(e,t){return(e&&qt.hasOwnProperty(e.type)?qt[e.type]:Yt)(e,t)}function $t(e,r,a){var n=t.range(e,r-o,a).concat(r);return function(e){return n.map((function(t){return[e,t]}))}}function er(e,r,a){var n=t.range(e,r-o,a).concat(r);return function(e){return n.map((function(t){return[t,e]}))}}function tr(){var e,r,a,n,i,s,l,u,c=10,f=c,h=90,p=360,d,m,g,x,b=2.5;function _(){return{type:"MultiLineString",coordinates:w()}}function w(){return t.range(y(n/h)*h,a,h).map(g).concat(t.range(y(u/p)*p,l,p).map(x)).concat(t.range(y(r/c)*c,e,c).filter((function(e){return v(e%h)>o})).map(d)).concat(t.range(y(s/f)*f,i,f).filter((function(e){return v(e%p)>o})).map(m))}_.lines=function(){return w().map((function(e){return{type:"LineString",coordinates:e}}))};_.outline=function(){return{type:"Polygon",coordinates:[g(n).concat(x(l).slice(1),g(a).reverse().slice(1),x(u).reverse().slice(1))]}};_.extent=function(e){if(!arguments.length)return _.extentMinor();return _.extentMajor(e).extentMinor(e)};_.extentMajor=function(e){if(!arguments.length)return[[n,u],[a,l]];n=+e[0][0],a=+e[1][0];u=+e[0][1],l=+e[1][1];if(n>a)e=n,n=a,a=e;if(u>l)e=u,u=l,l=e;return _.precision(b)};_.extentMinor=function(t){if(!arguments.length)return[[r,s],[e,i]];r=+t[0][0],e=+t[1][0];s=+t[0][1],i=+t[1][1];if(r>e)t=r,r=e,e=t;if(s>i)t=s,s=i,i=t;return _.precision(b)};_.step=function(e){if(!arguments.length)return _.stepMinor();return _.stepMajor(e).stepMinor(e)};_.stepMajor=function(e){if(!arguments.length)return[h,p];h=+e[0],p=+e[1];return _};_.stepMinor=function(e){if(!arguments.length)return[c,f];c=+e[0],f=+e[1];return _};_.precision=function(t){if(!arguments.length)return b;b=+t;d=$t(s,i,90);m=er(r,e,b);g=$t(u,l,90);x=er(n,a,b);return _};return _.extentMajor([[-180,-90+o],[180,90-o]]).extentMinor([[-180,-80-o],[180,80+o]])}function rr(){return tr()()}function ar(e,t){var r=e[0]*p,a=e[1]*p,n=t[0]*p,i=t[1]*p,o=g(a),s=w(a),l=g(i),u=w(i),c=o*g(r),f=o*w(r),v=l*g(n),d=l*w(n),y=2*S(k(E(i-a)+o*l*E(n-r))),x=w(y);var b=y?function(e){var t=w(e*=y)/x,r=w(y-e)/x,a=r*c+t*v,n=r*f+t*d,i=r*s+t*u;return[m(n,a)*h,m(i,k(a*a+n*n))*h]}:function(){return[r*h,a*h]};b.distance=y;return b}function nr(e){return e}var ir=r(),or=r(),sr,lr,ur,cr;var fr={point:L,lineStart:L,lineEnd:L,polygonStart:function(){fr.lineStart=hr;fr.lineEnd=dr},polygonEnd:function(){fr.lineStart=fr.lineEnd=fr.point=L;ir.add(v(or));or.reset()},result:function(){var e=ir/2;ir.reset();return e}};function hr(){fr.point=pr}function pr(e,t){fr.point=vr;sr=ur=e,lr=cr=t}function vr(e,t){or.add(cr*e-ur*t);ur=e,cr=t}function dr(){vr(sr,lr)}var mr=Infinity,gr=mr,yr=-mr,xr=yr;var br={point:_r,lineStart:L,lineEnd:L,polygonStart:L,polygonEnd:L,result:function(){var e=[[mr,gr],[yr,xr]];yr=xr=-(gr=mr=Infinity);return e}};function _r(e,t){if(e<mr)mr=e;if(e>yr)yr=e;if(t<gr)gr=t;if(t>xr)xr=t}var wr=0,Tr=0,kr=0,Mr=0,Ar=0,Sr=0,Er=0,Lr=0,Cr=0,Ir,Pr,Or,zr;var Dr={point:Rr,lineStart:Fr,lineEnd:jr,polygonStart:function(){Dr.lineStart=Ur;Dr.lineEnd=Vr},polygonEnd:function(){Dr.point=Rr;Dr.lineStart=Fr;Dr.lineEnd=jr},result:function(){var e=Cr?[Er/Cr,Lr/Cr]:Sr?[Mr/Sr,Ar/Sr]:kr?[wr/kr,Tr/kr]:[NaN,NaN];wr=Tr=kr=Mr=Ar=Sr=Er=Lr=Cr=0;return e}};function Rr(e,t){wr+=e;Tr+=t;++kr}function Fr(){Dr.point=Br}function Br(e,t){Dr.point=Nr;Rr(Or=e,zr=t)}function Nr(e,t){var r=e-Or,a=t-zr,n=k(r*r+a*a);Mr+=n*(Or+e)/2;Ar+=n*(zr+t)/2;Sr+=n;Rr(Or=e,zr=t)}function jr(){Dr.point=Rr}function Ur(){Dr.point=Hr}function Vr(){qr(Ir,Pr)}function Hr(e,t){Dr.point=qr;Rr(Ir=Or=e,Pr=zr=t)}function qr(e,t){var r=e-Or,a=t-zr,n=k(r*r+a*a);Mr+=n*(Or+e)/2;Ar+=n*(zr+t)/2;Sr+=n;n=zr*e-Or*t;Er+=n*(Or+e);Lr+=n*(zr+t);Cr+=n*3;Rr(Or=e,zr=t)}function Gr(e){this._context=e}Gr.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){if(this._line===0)this._context.closePath();this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._context.moveTo(e,t);this._point=1;break}case 1:{this._context.lineTo(e,t);break}default:{this._context.moveTo(e+this._radius,t);this._context.arc(e,t,this._radius,0,f);break}}},result:L};var Yr=r(),Wr,Xr,Zr,Jr,Kr;var Qr={point:L,lineStart:function(){Qr.point=$r},lineEnd:function(){if(Wr)ea(Xr,Zr);Qr.point=L},polygonStart:function(){Wr=true},polygonEnd:function(){Wr=null},result:function(){var e=+Yr;Yr.reset();return e}};function $r(e,t){Qr.point=ea;Xr=Jr=e,Zr=Kr=t}function ea(e,t){Jr-=e,Kr-=t;Yr.add(k(Jr*Jr+Kr*Kr));Jr=e,Kr=t}function ta(){this._string=[]}ta.prototype={_radius:4.5,_circle:ra(4.5),pointRadius:function(e){if((e=+e)!==this._radius)this._radius=e,this._circle=null;return this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){if(this._line===0)this._string.push("Z");this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._string.push("M",e,",",t);this._point=1;break}case 1:{this._string.push("L",e,",",t);break}default:{if(this._circle==null)this._circle=ra(this._radius);this._string.push("M",e,",",t,this._circle);break}}},result:function(){if(this._string.length){var e=this._string.join("");this._string=[];return e}else{return null}}};function ra(e){return"m0,"+e+"a"+e+","+e+" 0 1,1 0,"+-2*e+"a"+e+","+e+" 0 1,1 0,"+2*e+"z"}function aa(e,t){var r=4.5,a,n;function i(e){if(e){if(typeof r==="function")n.pointRadius(+r.apply(this,arguments));D(e,a(n))}return n.result()}i.area=function(e){D(e,a(fr));return fr.result()};i.measure=function(e){D(e,a(Qr));return Qr.result()};i.bounds=function(e){D(e,a(br));return br.result()};i.centroid=function(e){D(e,a(Dr));return Dr.result()};i.projection=function(t){return arguments.length?(a=t==null?(e=null,nr):(e=t).stream,i):e};i.context=function(e){if(!arguments.length)return t;n=e==null?(t=null,new ta):new Gr(t=e);if(typeof r!=="function")n.pointRadius(r);return i};i.pointRadius=function(e){if(!arguments.length)return r;r=typeof e==="function"?e:(n.pointRadius(+e),+e);return i};return i.projection(e).context(t)}function na(e){return{stream:ia(e)}}function ia(e){return function(t){var r=new oa;for(var a in e)r[a]=e[a];r.stream=t;return r}}function oa(){}oa.prototype={constructor:oa,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function sa(e,t,r){var a=e.clipExtent&&e.clipExtent();e.scale(150).translate([0,0]);if(a!=null)e.clipExtent(null);D(r,e.stream(br));t(br.result());if(a!=null)e.clipExtent(a);return e}function la(e,t,r){return sa(e,(function(r){var a=t[1][0]-t[0][0],n=t[1][1]-t[0][1],i=Math.min(a/(r[1][0]-r[0][0]),n/(r[1][1]-r[0][1])),o=+t[0][0]+(a-i*(r[1][0]+r[0][0]))/2,s=+t[0][1]+(n-i*(r[1][1]+r[0][1]))/2;e.scale(150*i).translate([o,s])}),r)}function ua(e,t,r){return la(e,[[0,0],t],r)}function ca(e,t,r){return sa(e,(function(r){var a=+t,n=a/(r[1][0]-r[0][0]),i=(a-n*(r[1][0]+r[0][0]))/2,o=-n*r[0][1];e.scale(150*n).translate([i,o])}),r)}function fa(e,t,r){return sa(e,(function(r){var a=+t,n=a/(r[1][1]-r[0][1]),i=-n*r[0][0],o=(a-n*(r[1][1]+r[0][1]))/2;e.scale(150*n).translate([i,o])}),r)}var ha=16,pa=g(30*p);function va(e,t){return+t?ma(e,t):da(e)}function da(e){return ia({point:function(t,r){t=e(t,r);this.stream.point(t[0],t[1])}})}function ma(e,t){function r(a,n,i,s,l,u,c,f,h,p,d,g,y,x){var b=c-a,_=f-n,w=b*b+_*_;if(w>4*t&&y--){var T=s+p,M=l+d,A=u+g,E=k(T*T+M*M+A*A),L=S(A/=E),C=v(v(A)-1)<o||v(i-h)<o?(i+h)/2:m(M,T),I=e(C,L),P=I[0],O=I[1],z=P-a,D=O-n,R=_*z-b*D;if(R*R/w>t||v((b*z+_*D)/w-.5)>.3||s*p+l*d+u*g<pa){r(a,n,i,s,l,u,P,O,C,T/=E,M/=E,A,y,x);x.point(P,O);r(P,O,C,T,M,A,c,f,h,p,d,g,y,x)}}}return function(t){var a,n,i,o,s,l,u,c,f,h,p,v;var d={point:m,lineStart:g,lineEnd:x,polygonStart:function(){t.polygonStart();d.lineStart=b},polygonEnd:function(){t.polygonEnd();d.lineStart=g}};function m(r,a){r=e(r,a);t.point(r[0],r[1])}function g(){c=NaN;d.point=y;t.lineStart()}function y(a,n){var i=J([a,n]),o=e(a,n);r(c,f,u,h,p,v,c=o[0],f=o[1],u=a,h=i[0],p=i[1],v=i[2],ha,t);t.point(c,f)}function x(){d.point=m;t.lineEnd()}function b(){g();d.point=_;d.lineEnd=w}function _(e,t){y(a=e,t),n=c,i=f,o=h,s=p,l=v;d.point=y}function w(){r(c,f,u,h,p,v,n,i,a,o,s,l,ha,t);d.lineEnd=x;x()}return d}}var ga=ia({point:function(e,t){this.stream.point(e*p,t*p)}});function ya(e){return ia({point:function(t,r){var a=e(t,r);return this.stream.point(a[0],a[1])}})}function xa(e,t,r,a,n){function i(i,o){i*=a;o*=n;return[t+e*i,r-e*o]}i.invert=function(i,o){return[(i-t)/e*a,(r-o)/e*n]};return i}function ba(e,t,r,a,n,i){var o=g(i),s=w(i),l=o*e,u=s*e,c=o/e,f=s/e,h=(s*r-o*t)/e,p=(s*t+o*r)/e;function v(e,i){e*=a;i*=n;return[l*e-u*i+t,r-u*e-l*i]}v.invert=function(e,t){return[a*(c*e-f*t+h),n*(p-f*e-c*t)]};return v}function _a(e){return wa((function(){return e}))()}function wa(e){var t,r=150,a=480,n=250,i=0,o=0,s=0,l=0,u=0,c,f=0,v=1,d=1,m=null,g=_t,y=null,x,b,_,w=nr,T=.5,M,A,S,E,L;function C(e){return S(e[0]*p,e[1]*p)}function I(e){e=S.invert(e[0],e[1]);return e&&[e[0]*h,e[1]*h]}C.stream=function(e){return E&&L===e?E:E=ga(ya(c)(g(M(w(L=e)))))};C.preclip=function(e){return arguments.length?(g=e,m=undefined,O()):g};C.postclip=function(e){return arguments.length?(w=e,y=x=b=_=null,O()):w};C.clipAngle=function(e){return arguments.length?(g=+e?Mt(m=e*p):(m=null,_t),O()):m*h};C.clipExtent=function(e){return arguments.length?(w=e==null?(y=x=b=_=null,nr):Lt(y=+e[0][0],x=+e[0][1],b=+e[1][0],_=+e[1][1]),O()):y==null?null:[[y,x],[b,_]]};C.scale=function(e){return arguments.length?(r=+e,P()):r};C.translate=function(e){return arguments.length?(a=+e[0],n=+e[1],P()):[a,n]};C.center=function(e){return arguments.length?(i=e[0]%360*p,o=e[1]%360*p,P()):[i*h,o*h]};C.rotate=function(e){return arguments.length?(s=e[0]%360*p,l=e[1]%360*p,u=e.length>2?e[2]%360*p:0,P()):[s*h,l*h,u*h]};C.angle=function(e){return arguments.length?(f=e%360*p,P()):f*h};C.reflectX=function(e){return arguments.length?(v=e?-1:1,P()):v<0};C.reflectY=function(e){return arguments.length?(d=e?-1:1,P()):d<0};C.precision=function(e){return arguments.length?(M=va(A,T=e*e),O()):k(T)};C.fitExtent=function(e,t){return la(C,e,t)};C.fitSize=function(e,t){return ua(C,e,t)};C.fitWidth=function(e,t){return ca(C,e,t)};C.fitHeight=function(e,t){return fa(C,e,t)};function P(){var e=ba(r,0,0,v,d,f).apply(null,t(i,o)),h=(f?ba:xa)(r,a-e[0],n-e[1],v,d,f);c=rt(s,l,u);A=et(t,h);S=et(c,A);M=va(A,T);return O()}function O(){E=L=null;return C}return function(){t=e.apply(this,arguments);C.invert=t.invert&&I;return P()}}function Ta(e){var t=0,r=l/3,a=wa(e),n=a(t,r);n.parallels=function(e){return arguments.length?a(t=e[0]*p,r=e[1]*p):[t*h,r*h]};return n}function ka(e){var t=g(e);function r(e,r){return[e*t,w(r)/t]}r.invert=function(e,r){return[e/t,S(r*t)]};return r}function Ma(e,t){var r=w(e),a=(r+w(t))/2;if(v(a)<o)return ka(e);var n=1+r*(2*a-r),i=k(n)/a;function s(e,t){var r=k(n-2*a*w(t))/a;return[r*w(e*=a),i-r*g(e)]}s.invert=function(e,t){var r=i-t,o=m(e,v(r))*T(r);if(r*a<0)o-=l*T(e)*T(r);return[o/a,S((n-(e*e+r*r)*a*a)/(2*a))]};return s}function Aa(){return Ta(Ma).scale(155.424).center([0,33.6442])}function Sa(){return Aa().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function Ea(e){var t=e.length;return{point:function(r,a){var n=-1;while(++n<t)e[n].point(r,a)},sphere:function(){var r=-1;while(++r<t)e[r].sphere()},lineStart:function(){var r=-1;while(++r<t)e[r].lineStart()},lineEnd:function(){var r=-1;while(++r<t)e[r].lineEnd()},polygonStart:function(){var r=-1;while(++r<t)e[r].polygonStart()},polygonEnd:function(){var r=-1;while(++r<t)e[r].polygonEnd()}}}function La(){var e,t,r=Sa(),a,n=Aa().rotate([154,0]).center([-2,58.5]).parallels([55,65]),i,s=Aa().rotate([157,0]).center([-3,19.9]).parallels([8,18]),l,u,c={point:function(e,t){u=[e,t]}};function f(e){var t=e[0],r=e[1];return u=null,(a.point(t,r),u)||(i.point(t,r),u)||(l.point(t,r),u)}f.invert=function(e){var t=r.scale(),a=r.translate(),i=(e[0]-a[0])/t,o=(e[1]-a[1])/t;return(o>=.12&&o<.234&&i>=-.425&&i<-.214?n:o>=.166&&o<.234&&i>=-.214&&i<-.115?s:r).invert(e)};f.stream=function(a){return e&&t===a?e:e=Ea([r.stream(t=a),n.stream(a),s.stream(a)])};f.precision=function(e){if(!arguments.length)return r.precision();r.precision(e),n.precision(e),s.precision(e);return h()};f.scale=function(e){if(!arguments.length)return r.scale();r.scale(e),n.scale(e*.35),s.scale(e);return f.translate(r.translate())};f.translate=function(e){if(!arguments.length)return r.translate();var t=r.scale(),u=+e[0],f=+e[1];a=r.translate(e).clipExtent([[u-.455*t,f-.238*t],[u+.455*t,f+.238*t]]).stream(c);i=n.translate([u-.307*t,f+.201*t]).clipExtent([[u-.425*t+o,f+.12*t+o],[u-.214*t-o,f+.234*t-o]]).stream(c);l=s.translate([u-.205*t,f+.212*t]).clipExtent([[u-.214*t+o,f+.166*t+o],[u-.115*t-o,f+.234*t-o]]).stream(c);return h()};f.fitExtent=function(e,t){return la(f,e,t)};f.fitSize=function(e,t){return ua(f,e,t)};f.fitWidth=function(e,t){return ca(f,e,t)};f.fitHeight=function(e,t){return fa(f,e,t)};function h(){e=t=null;return f}return f.scale(1070)}function Ca(e){return function(t,r){var a=g(t),n=g(r),i=e(a*n);return[i*n*w(t),i*w(r)]}}function Ia(e){return function(t,r){var a=k(t*t+r*r),n=e(a),i=w(n),o=g(n);return[m(t*i,a*o),S(a&&r*i/a)]}}var Pa=Ca((function(e){return k(2/(1+e))}));Pa.invert=Ia((function(e){return 2*S(e/2)}));function Oa(){return _a(Pa).scale(124.75).clipAngle(180-.001)}var za=Ca((function(e){return(e=A(e))&&e/w(e)}));za.invert=Ia((function(e){return e}));function Da(){return _a(za).scale(79.4188).clipAngle(180-.001)}function Ra(e,t){return[e,b(M((u+t)/2))]}Ra.invert=function(e,t){return[e,2*d(x(t))-u]};function Fa(){return Ba(Ra).scale(961/f)}function Ba(e){var t=_a(e),r=t.center,a=t.scale,n=t.translate,i=t.clipExtent,o=null,s,u,c;t.scale=function(e){return arguments.length?(a(e),f()):a()};t.translate=function(e){return arguments.length?(n(e),f()):n()};t.center=function(e){return arguments.length?(r(e),f()):r()};t.clipExtent=function(e){return arguments.length?(e==null?o=s=u=c=null:(o=+e[0][0],s=+e[0][1],u=+e[1][0],c=+e[1][1]),f()):o==null?null:[[o,s],[u,c]]};function f(){var r=l*a(),n=t(ot(t.rotate()).invert([0,0]));return i(o==null?[[n[0]-r,n[1]-r],[n[0]+r,n[1]+r]]:e===Ra?[[Math.max(n[0]-r,o),s],[Math.min(n[0]+r,u),c]]:[[o,Math.max(n[1]-r,s)],[u,Math.min(n[1]+r,c)]])}return f()}function Na(e){return M((u+e)/2)}function ja(e,t){var r=g(e),a=e===t?w(e):b(r/g(t))/b(Na(t)/Na(e)),n=r*_(Na(e),a)/a;if(!a)return Ra;function i(e,t){if(n>0){if(t<-u+o)t=-u+o}else{if(t>u-o)t=u-o}var r=n/_(Na(t),a);return[r*w(a*e),n-r*g(a*e)]}i.invert=function(e,t){var r=n-t,i=T(a)*k(e*e+r*r),o=m(e,v(r))*T(r);if(r*a<0)o-=l*T(e)*T(r);return[o/a,2*d(_(n/i,1/a))-u]};return i}function Ua(){return Ta(ja).scale(109.5).parallels([30,30])}function Va(e,t){return[e,t]}Va.invert=Va;function Ha(){return _a(Va).scale(152.63)}function qa(e,t){var r=g(e),a=e===t?w(e):(r-g(t))/(t-e),n=r/a+e;if(v(a)<o)return Va;function i(e,t){var r=n-t,i=a*e;return[r*w(i),n-r*g(i)]}i.invert=function(e,t){var r=n-t,i=m(e,v(r))*T(r);if(r*a<0)i-=l*T(e)*T(r);return[i/a,n-T(a)*k(e*e+r*r)]};return i}function Ga(){return Ta(qa).scale(131.154).center([0,13.9389])}var Ya=1.340264,Wa=-.081106,Xa=893e-6,Za=.003796,Ja=k(3)/2,Ka=12;function Qa(e,t){var r=S(Ja*w(t)),a=r*r,n=a*a*a;return[e*g(r)/(Ja*(Ya+3*Wa*a+n*(7*Xa+9*Za*a))),r*(Ya+Wa*a+n*(Xa+Za*a))]}Qa.invert=function(e,t){var r=t,a=r*r,n=a*a*a;for(var i=0,o,l,u;i<Ka;++i){l=r*(Ya+Wa*a+n*(Xa+Za*a))-t;u=Ya+3*Wa*a+n*(7*Xa+9*Za*a);r-=o=l/u,a=r*r,n=a*a*a;if(v(o)<s)break}return[Ja*e*(Ya+3*Wa*a+n*(7*Xa+9*Za*a))/g(r),S(w(r)/Ja)]};function $a(){return _a(Qa).scale(177.158)}function en(e,t){var r=g(t),a=g(e)*r;return[r*w(e)/a,w(t)/a]}en.invert=Ia(d);function tn(){return _a(en).scale(144.049).clipAngle(60)}function rn(){var e=1,t=0,r=0,a=1,n=1,i=0,o,s,l=null,u,c,f,v=1,d=1,m=ia({point:function(e,t){var r=T([e,t]);this.stream.point(r[0],r[1])}}),y=nr,x,b;function _(){v=e*a;d=e*n;x=b=null;return T}function T(e){var a=e[0]*v,n=e[1]*d;if(i){var l=n*o-a*s;a=a*o+n*s;n=l}return[a+t,n+r]}T.invert=function(e){var a=e[0]-t,n=e[1]-r;if(i){var l=n*o+a*s;a=a*o-n*s;n=l}return[a/v,n/d]};T.stream=function(e){return x&&b===e?x:x=m(y(b=e))};T.postclip=function(e){return arguments.length?(y=e,l=u=c=f=null,_()):y};T.clipExtent=function(e){return arguments.length?(y=e==null?(l=u=c=f=null,nr):Lt(l=+e[0][0],u=+e[0][1],c=+e[1][0],f=+e[1][1]),_()):l==null?null:[[l,u],[c,f]]};T.scale=function(t){return arguments.length?(e=+t,_()):e};T.translate=function(e){return arguments.length?(t=+e[0],r=+e[1],_()):[t,r]};T.angle=function(e){return arguments.length?(i=e%360*p,s=w(i),o=g(i),_()):i*h};T.reflectX=function(e){return arguments.length?(a=e?-1:1,_()):a<0};T.reflectY=function(e){return arguments.length?(n=e?-1:1,_()):n<0};T.fitExtent=function(e,t){return la(T,e,t)};T.fitSize=function(e,t){return ua(T,e,t)};T.fitWidth=function(e,t){return ca(T,e,t)};T.fitHeight=function(e,t){return fa(T,e,t)};return T}function an(e,t){var r=t*t,a=r*r;return[e*(.8707-.131979*r+a*(-.013791+a*(.003971*r-.001529*a))),t*(1.007226+r*(.015085+a*(-.044475+.028874*r-.005916*a)))]}an.invert=function(e,t){var r=t,a=25,n;do{var i=r*r,s=i*i;r-=n=(r*(1.007226+i*(.015085+s*(-.044475+.028874*i-.005916*s)))-t)/(1.007226+i*(.015085*3+s*(-.044475*7+.028874*9*i-.005916*11*s)))}while(v(n)>o&&--a>0);return[e/(.8707+(i=r*r)*(-.131979+i*(-.013791+i*i*i*(.003971-.001529*i)))),r]};function nn(){return _a(an).scale(175.295)}function on(e,t){return[g(t)*w(e),w(t)]}on.invert=Ia(S);function sn(){return _a(on).scale(249.5).clipAngle(90+o)}function ln(e,t){var r=g(t),a=1+g(e)*r;return[r*w(e)/a,w(t)/a]}ln.invert=Ia((function(e){return 2*d(e)}));function un(){return _a(ln).scale(250).clipAngle(142)}function cn(e,t){return[b(M((u+t)/2)),-e]}cn.invert=function(e,t){return[-t,2*d(x(e))-u]};function fn(){var e=Ba(cn),t=e.center,r=e.rotate;e.center=function(e){return arguments.length?t([-e[1],e[0]]):(e=t(),[e[1],-e[0]])};e.rotate=function(e){return arguments.length?r([e[0],e[1],e.length>2?e[2]+90:90]):(e=r(),[e[0],e[1],e[2]-90])};return r([0,0,90]).scale(159.155)}e.geoAlbers=Sa;e.geoAlbersUsa=La;e.geoArea=X;e.geoAzimuthalEqualArea=Oa;e.geoAzimuthalEqualAreaRaw=Pa;e.geoAzimuthalEquidistant=Da;e.geoAzimuthalEquidistantRaw=za;e.geoBounds=ke;e.geoCentroid=Qe;e.geoCircle=ut;e.geoClipAntimeridian=_t;e.geoClipCircle=Mt;e.geoClipExtent=Ct;e.geoClipRectangle=Lt;e.geoConicConformal=Ua;e.geoConicConformalRaw=ja;e.geoConicEqualArea=Aa;e.geoConicEqualAreaRaw=Ma;e.geoConicEquidistant=Ga;e.geoConicEquidistantRaw=qa;e.geoContains=Qt;e.geoDistance=Ht;e.geoEqualEarth=$a;e.geoEqualEarthRaw=Qa;e.geoEquirectangular=Ha;e.geoEquirectangularRaw=Va;e.geoGnomonic=tn;e.geoGnomonicRaw=en;e.geoGraticule=tr;e.geoGraticule10=rr;e.geoIdentity=rn;e.geoInterpolate=ar;e.geoLength=jt;e.geoMercator=Fa;e.geoMercatorRaw=Ra;e.geoNaturalEarth1=nn;e.geoNaturalEarth1Raw=an;e.geoOrthographic=sn;e.geoOrthographicRaw=on;e.geoPath=aa;e.geoProjection=_a;e.geoProjectionMutator=wa;e.geoRotation=ot;e.geoStereographic=un;e.geoStereographicRaw=ln;e.geoStream=D;e.geoTransform=na;e.geoTransverseMercator=fn;e.geoTransverseMercatorRaw=cn;Object.defineProperty(e,"__esModule",{value:true})}))},{"d3-array":159}],167:[function(t,r,a){(function(t,n){typeof a==="object"&&typeof r!=="undefined"?n(a):typeof e==="function"&&e.amd?e(["exports"],n):(t=t||self,n(t.d3=t.d3||{}))})(this,(function(e){"use strict";function t(e,t){return e.parent===t.parent?1:2}function r(e){return e.reduce(a,0)/e.length}function a(e,t){return e+t.x}function n(e){return 1+e.reduce(i,0)}function i(e,t){return Math.max(e,t.y)}function o(e){var t;while(t=e.children)e=t[0];return e}function s(e){var t;while(t=e.children)e=t[t.length-1];return e}function l(){var e=t,a=1,i=1,l=false;function u(t){var u,c=0;t.eachAfter((function(t){var a=t.children;if(a){t.x=r(a);t.y=n(a)}else{t.x=u?c+=e(t,u):0;t.y=0;u=t}}));var f=o(t),h=s(t),p=f.x-e(f,h)/2,v=h.x+e(h,f)/2;return t.eachAfter(l?function(e){e.x=(e.x-t.x)*a;e.y=(t.y-e.y)*i}:function(e){e.x=(e.x-p)/(v-p)*a;e.y=(1-(t.y?e.y/t.y:1))*i})}u.separation=function(t){return arguments.length?(e=t,u):e};u.size=function(e){return arguments.length?(l=false,a=+e[0],i=+e[1],u):l?null:[a,i]};u.nodeSize=function(e){return arguments.length?(l=true,a=+e[0],i=+e[1],u):l?[a,i]:null};return u}function u(e){var t=0,r=e.children,a=r&&r.length;if(!a)t=1;else while(--a>=0)t+=r[a].value;e.value=t}function c(){return this.eachAfter(u)}function f(e){var t=this,r,a=[t],n,i,o;do{r=a.reverse(),a=[];while(t=r.pop()){e(t),n=t.children;if(n)for(i=0,o=n.length;i<o;++i){a.push(n[i])}}}while(a.length);return this}function h(e){var t=this,r=[t],a,n;while(t=r.pop()){e(t),a=t.children;if(a)for(n=a.length-1;n>=0;--n){r.push(a[n])}}return this}function p(e){var t=this,r=[t],a=[],n,i,o;while(t=r.pop()){a.push(t),n=t.children;if(n)for(i=0,o=n.length;i<o;++i){r.push(n[i])}}while(t=a.pop()){e(t)}return this}function v(e){return this.eachAfter((function(t){var r=+e(t.data)||0,a=t.children,n=a&&a.length;while(--n>=0)r+=a[n].value;t.value=r}))}function d(e){return this.eachBefore((function(t){if(t.children){t.children.sort(e)}}))}function m(e){var t=this,r=g(t,e),a=[t];while(t!==r){t=t.parent;a.push(t)}var n=a.length;while(e!==r){a.splice(n,0,e);e=e.parent}return a}function g(e,t){if(e===t)return e;var r=e.ancestors(),a=t.ancestors(),n=null;e=r.pop();t=a.pop();while(e===t){n=e;e=r.pop();t=a.pop()}return n}function y(){var e=this,t=[e];while(e=e.parent){t.push(e)}return t}function x(){var e=[];this.each((function(t){e.push(t)}));return e}function b(){var e=[];this.eachBefore((function(t){if(!t.children){e.push(t)}}));return e}function _(){var e=this,t=[];e.each((function(r){if(r!==e){t.push({source:r.parent,target:r})}}));return t}function w(e,t){var r=new S(e),a=+e.value&&(r.value=e.value),n,i=[r],o,s,l,u;if(t==null)t=k;while(n=i.pop()){if(a)n.value=+n.data.value;if((s=t(n.data))&&(u=s.length)){n.children=new Array(u);for(l=u-1;l>=0;--l){i.push(o=n.children[l]=new S(s[l]));o.parent=n;o.depth=n.depth+1}}}return r.eachBefore(A)}function T(){return w(this).eachBefore(M)}function k(e){return e.children}function M(e){e.data=e.data.data}function A(e){var t=0;do{e.height=t}while((e=e.parent)&&e.height<++t)}function S(e){this.data=e;this.depth=this.height=0;this.parent=null}S.prototype=w.prototype={constructor:S,count:c,each:f,eachAfter:p,eachBefore:h,sum:v,sort:d,path:m,ancestors:y,descendants:x,leaves:b,links:_,copy:T};var E=Array.prototype.slice;function L(e){var t=e.length,r,a;while(t){a=Math.random()*t--|0;r=e[t];e[t]=e[a];e[a]=r}return e}function C(e){var t=0,r=(e=L(E.call(e))).length,a=[],n,i;while(t<r){n=e[t];if(i&&O(i,n))++t;else i=D(a=I(a,n)),t=0}return i}function I(e,t){var r,a;if(z(t,e))return[t];for(r=0;r<e.length;++r){if(P(t,e[r])&&z(F(e[r],t),e)){return[e[r],t]}}for(r=0;r<e.length-1;++r){for(a=r+1;a<e.length;++a){if(P(F(e[r],e[a]),t)&&P(F(e[r],t),e[a])&&P(F(e[a],t),e[r])&&z(B(e[r],e[a],t),e)){return[e[r],e[a],t]}}}throw new Error}function P(e,t){var r=e.r-t.r,a=t.x-e.x,n=t.y-e.y;return r<0||r*r<a*a+n*n}function O(e,t){var r=e.r-t.r+1e-6,a=t.x-e.x,n=t.y-e.y;return r>0&&r*r>a*a+n*n}function z(e,t){for(var r=0;r<t.length;++r){if(!O(e,t[r])){return false}}return true}function D(e){switch(e.length){case 1:return R(e[0]);case 2:return F(e[0],e[1]);case 3:return B(e[0],e[1],e[2])}}function R(e){return{x:e.x,y:e.y,r:e.r}}function F(e,t){var r=e.x,a=e.y,n=e.r,i=t.x,o=t.y,s=t.r,l=i-r,u=o-a,c=s-n,f=Math.sqrt(l*l+u*u);return{x:(r+i+l/f*c)/2,y:(a+o+u/f*c)/2,r:(f+n+s)/2}}function B(e,t,r){var a=e.x,n=e.y,i=e.r,o=t.x,s=t.y,l=t.r,u=r.x,c=r.y,f=r.r,h=a-o,p=a-u,v=n-s,d=n-c,m=l-i,g=f-i,y=a*a+n*n-i*i,x=y-o*o-s*s+l*l,b=y-u*u-c*c+f*f,_=p*v-h*d,w=(v*b-d*x)/(_*2)-a,T=(d*m-v*g)/_,k=(p*x-h*b)/(_*2)-n,M=(h*g-p*m)/_,A=T*T+M*M-1,S=2*(i+w*T+k*M),E=w*w+k*k-i*i,L=-(A?(S+Math.sqrt(S*S-4*A*E))/(2*A):E/S);return{x:a+w+T*L,y:n+k+M*L,r:L}}function N(e,t,r){var a=e.x-t.x,n,i,o=e.y-t.y,s,l,u=a*a+o*o;if(u){i=t.r+r.r,i*=i;l=e.r+r.r,l*=l;if(i>l){n=(u+l-i)/(2*u);s=Math.sqrt(Math.max(0,l/u-n*n));r.x=e.x-n*a-s*o;r.y=e.y-n*o+s*a}else{n=(u+i-l)/(2*u);s=Math.sqrt(Math.max(0,i/u-n*n));r.x=t.x+n*a-s*o;r.y=t.y+n*o+s*a}}else{r.x=t.x+r.r;r.y=t.y}}function j(e,t){var r=e.r+t.r-1e-6,a=t.x-e.x,n=t.y-e.y;return r>0&&r*r>a*a+n*n}function U(e){var t=e._,r=e.next._,a=t.r+r.r,n=(t.x*r.r+r.x*t.r)/a,i=(t.y*r.r+r.y*t.r)/a;return n*n+i*i}function V(e){this._=e;this.next=null;this.previous=null}function H(e){if(!(n=e.length))return 0;var t,r,a,n,i,o,s,l,u,c,f;t=e[0],t.x=0,t.y=0;if(!(n>1))return t.r;r=e[1],t.x=-r.r,r.x=t.r,r.y=0;if(!(n>2))return t.r+r.r;N(r,t,a=e[2]);t=new V(t),r=new V(r),a=new V(a);t.next=a.previous=r;r.next=t.previous=a;a.next=r.previous=t;e:for(s=3;s<n;++s){N(t._,r._,a=e[s]),a=new V(a);l=r.next,u=t.previous,c=r._.r,f=t._.r;do{if(c<=f){if(j(l._,a._)){r=l,t.next=r,r.previous=t,--s;continue e}c+=l._.r,l=l.next}else{if(j(u._,a._)){t=u,t.next=r,r.previous=t,--s;continue e}f+=u._.r,u=u.previous}}while(l!==u.next);a.previous=t,a.next=r,t.next=r.previous=r=a;i=U(t);while((a=a.next)!==r){if((o=U(a))<i){t=a,i=o}}r=t.next}t=[r._],a=r;while((a=a.next)!==r)t.push(a._);a=C(t);for(s=0;s<n;++s)t=e[s],t.x-=a.x,t.y-=a.y;return a.r}function q(e){H(e);return e}function G(e){return e==null?null:Y(e)}function Y(e){if(typeof e!=="function")throw new Error;return e}function W(){return 0}function X(e){return function(){return e}}function Z(e){return Math.sqrt(e.value)}function J(){var e=null,t=1,r=1,a=W;function n(n){n.x=t/2,n.y=r/2;if(e){n.eachBefore(K(e)).eachAfter(Q(a,.5)).eachBefore($(1))}else{n.eachBefore(K(Z)).eachAfter(Q(W,1)).eachAfter(Q(a,n.r/Math.min(t,r))).eachBefore($(Math.min(t,r)/(2*n.r)))}return n}n.radius=function(t){return arguments.length?(e=G(t),n):e};n.size=function(e){return arguments.length?(t=+e[0],r=+e[1],n):[t,r]};n.padding=function(e){return arguments.length?(a=typeof e==="function"?e:X(+e),n):a};return n}function K(e){return function(t){if(!t.children){t.r=Math.max(0,+e(t)||0)}}}function Q(e,t){return function(r){if(a=r.children){var a,n,i=a.length,o=e(r)*t||0,s;if(o)for(n=0;n<i;++n)a[n].r+=o;s=H(a);if(o)for(n=0;n<i;++n)a[n].r-=o;r.r=s+o}}}function $(e){return function(t){var r=t.parent;t.r*=e;if(r){t.x=r.x+e*t.x;t.y=r.y+e*t.y}}}function ee(e){e.x0=Math.round(e.x0);e.y0=Math.round(e.y0);e.x1=Math.round(e.x1);e.y1=Math.round(e.y1)}function te(e,t,r,a,n){var i=e.children,o,s=-1,l=i.length,u=e.value&&(a-t)/e.value;while(++s<l){o=i[s],o.y0=r,o.y1=n;o.x0=t,o.x1=t+=o.value*u}}function re(){var e=1,t=1,r=0,a=false;function n(n){var o=n.height+1;n.x0=n.y0=r;n.x1=e;n.y1=t/o;n.eachBefore(i(t,o));if(a)n.eachBefore(ee);return n}function i(e,t){return function(a){if(a.children){te(a,a.x0,e*(a.depth+1)/t,a.x1,e*(a.depth+2)/t)}var n=a.x0,i=a.y0,o=a.x1-r,s=a.y1-r;if(o<n)n=o=(n+o)/2;if(s<i)i=s=(i+s)/2;a.x0=n;a.y0=i;a.x1=o;a.y1=s}}n.round=function(e){return arguments.length?(a=!!e,n):a};n.size=function(r){return arguments.length?(e=+r[0],t=+r[1],n):[e,t]};n.padding=function(e){return arguments.length?(r=+e,n):r};return n}var ae="$",ne={depth:-1},ie={};function oe(e){return e.id}function se(e){return e.parentId}function le(){var e=oe,t=se;function r(r){var a,n,i=r.length,o,s,l,u=new Array(i),c,f,h={};for(n=0;n<i;++n){a=r[n],l=u[n]=new S(a);if((c=e(a,n,r))!=null&&(c+="")){f=ae+(l.id=c);h[f]=f in h?ie:l}}for(n=0;n<i;++n){l=u[n],c=t(r[n],n,r);if(c==null||!(c+="")){if(o)throw new Error("multiple roots");o=l}else{s=h[ae+c];if(!s)throw new Error("missing: "+c);if(s===ie)throw new Error("ambiguous: "+c);if(s.children)s.children.push(l);else s.children=[l];l.parent=s}}if(!o)throw new Error("no root");o.parent=ne;o.eachBefore((function(e){e.depth=e.parent.depth+1;--i})).eachBefore(A);o.parent=null;if(i>0)throw new Error("cycle");return o}r.id=function(t){return arguments.length?(e=Y(t),r):e};r.parentId=function(e){return arguments.length?(t=Y(e),r):t};return r}function ue(e,t){return e.parent===t.parent?1:2}function ce(e){var t=e.children;return t?t[0]:e.t}function fe(e){var t=e.children;return t?t[t.length-1]:e.t}function he(e,t,r){var a=r/(t.i-e.i);t.c-=a;t.s+=r;e.c+=a;t.z+=r;t.m+=r}function pe(e){var t=0,r=0,a=e.children,n=a.length,i;while(--n>=0){i=a[n];i.z+=t;i.m+=t;t+=i.s+(r+=i.c)}}function ve(e,t,r){return e.a.parent===t.parent?e.a:r}function de(e,t){this._=e;this.parent=null;this.children=null;this.A=null;this.a=this;this.z=0;this.m=0;this.c=0;this.s=0;this.t=null;this.i=t}de.prototype=Object.create(S.prototype);function me(e){var t=new de(e,0),r,a=[t],n,i,o,s;while(r=a.pop()){if(i=r._.children){r.children=new Array(s=i.length);for(o=s-1;o>=0;--o){a.push(n=r.children[o]=new de(i[o],o));n.parent=r}}}(t.parent=new de(null,0)).children=[t];return t}function ge(){var e=ue,t=1,r=1,a=null;function n(n){var s=me(n);s.eachAfter(i),s.parent.m=-s.z;s.eachBefore(o);if(a)n.eachBefore(l);else{var u=n,c=n,f=n;n.eachBefore((function(e){if(e.x<u.x)u=e;if(e.x>c.x)c=e;if(e.depth>f.depth)f=e}));var h=u===c?1:e(u,c)/2,p=h-u.x,v=t/(c.x+h+p),d=r/(f.depth||1);n.eachBefore((function(e){e.x=(e.x+p)*v;e.y=e.depth*d}))}return n}function i(t){var r=t.children,a=t.parent.children,n=t.i?a[t.i-1]:null;if(r){pe(t);var i=(r[0].z+r[r.length-1].z)/2;if(n){t.z=n.z+e(t._,n._);t.m=t.z-i}else{t.z=i}}else if(n){t.z=n.z+e(t._,n._)}t.parent.A=s(t,n,t.parent.A||a[0])}function o(e){e._.x=e.z+e.parent.m;e.m+=e.parent.m}function s(t,r,a){if(r){var n=t,i=t,o=r,s=n.parent.children[0],l=n.m,u=i.m,c=o.m,f=s.m,h;while(o=fe(o),n=ce(n),o&&n){s=ce(s);i=fe(i);i.a=t;h=o.z+c-n.z-l+e(o._,n._);if(h>0){he(ve(o,t,a),t,h);l+=h;u+=h}c+=o.m;l+=n.m;f+=s.m;u+=i.m}if(o&&!fe(i)){i.t=o;i.m+=c-u}if(n&&!ce(s)){s.t=n;s.m+=l-f;a=t}}return a}function l(e){e.x*=t;e.y=e.depth*r}n.separation=function(t){return arguments.length?(e=t,n):e};n.size=function(e){return arguments.length?(a=false,t=+e[0],r=+e[1],n):a?null:[t,r]};n.nodeSize=function(e){return arguments.length?(a=true,t=+e[0],r=+e[1],n):a?[t,r]:null};return n}function ye(e,t,r,a,n){var i=e.children,o,s=-1,l=i.length,u=e.value&&(n-r)/e.value;while(++s<l){o=i[s],o.x0=t,o.x1=a;o.y0=r,o.y1=r+=o.value*u}}var xe=(1+Math.sqrt(5))/2;function be(e,t,r,a,n,i){var o=[],s=t.children,l,u,c=0,f=0,h=s.length,p,v,d=t.value,m,g,y,x,b,_,w;while(c<h){p=n-r,v=i-a;do{m=s[f++].value}while(!m&&f<h);g=y=m;_=Math.max(v/p,p/v)/(d*e);w=m*m*_;b=Math.max(y/w,w/g);for(;f<h;++f){m+=u=s[f].value;if(u<g)g=u;if(u>y)y=u;w=m*m*_;x=Math.max(y/w,w/g);if(x>b){m-=u;break}b=x}o.push(l={value:m,dice:p<v,children:s.slice(c,f)});if(l.dice)te(l,r,a,n,d?a+=v*m/d:i);else ye(l,r,a,d?r+=p*m/d:n,i);d-=m,c=f}return o}var _e=function e(t){function r(e,r,a,n,i){be(t,e,r,a,n,i)}r.ratio=function(t){return e((t=+t)>1?t:1)};return r}(xe);function we(){var e=_e,t=false,r=1,a=1,n=[0],i=W,o=W,s=W,l=W,u=W;function c(e){e.x0=e.y0=0;e.x1=r;e.y1=a;e.eachBefore(f);n=[0];if(t)e.eachBefore(ee);return e}function f(t){var r=n[t.depth],a=t.x0+r,c=t.y0+r,f=t.x1-r,h=t.y1-r;if(f<a)a=f=(a+f)/2;if(h<c)c=h=(c+h)/2;t.x0=a;t.y0=c;t.x1=f;t.y1=h;if(t.children){r=n[t.depth+1]=i(t)/2;a+=u(t)-r;c+=o(t)-r;f-=s(t)-r;h-=l(t)-r;if(f<a)a=f=(a+f)/2;if(h<c)c=h=(c+h)/2;e(t,a,c,f,h)}}c.round=function(e){return arguments.length?(t=!!e,c):t};c.size=function(e){return arguments.length?(r=+e[0],a=+e[1],c):[r,a]};c.tile=function(t){return arguments.length?(e=Y(t),c):e};c.padding=function(e){return arguments.length?c.paddingInner(e).paddingOuter(e):c.paddingInner()};c.paddingInner=function(e){return arguments.length?(i=typeof e==="function"?e:X(+e),c):i};c.paddingOuter=function(e){return arguments.length?c.paddingTop(e).paddingRight(e).paddingBottom(e).paddingLeft(e):c.paddingTop()};c.paddingTop=function(e){return arguments.length?(o=typeof e==="function"?e:X(+e),c):o};c.paddingRight=function(e){return arguments.length?(s=typeof e==="function"?e:X(+e),c):s};c.paddingBottom=function(e){return arguments.length?(l=typeof e==="function"?e:X(+e),c):l};c.paddingLeft=function(e){return arguments.length?(u=typeof e==="function"?e:X(+e),c):u};return c}function Te(e,t,r,a,n){var i=e.children,o,s=i.length,l,u=new Array(s+1);for(u[0]=l=o=0;o<s;++o){u[o+1]=l+=i[o].value}c(0,s,e.value,t,r,a,n);function c(e,t,r,a,n,o,s){if(e>=t-1){var l=i[e];l.x0=a,l.y0=n;l.x1=o,l.y1=s;return}var f=u[e],h=r/2+f,p=e+1,v=t-1;while(p<v){var d=p+v>>>1;if(u[d]<h)p=d+1;else v=d}if(h-u[p-1]<u[p]-h&&e+1<p)--p;var m=u[p]-f,g=r-m;if(o-a>s-n){var y=(a*g+o*m)/r;c(e,p,m,a,n,y,s);c(p,t,g,y,n,o,s)}else{var x=(n*g+s*m)/r;c(e,p,m,a,n,o,x);c(p,t,g,a,x,o,s)}}}function ke(e,t,r,a,n){(e.depth&1?ye:te)(e,t,r,a,n)}var Me=function e(t){function r(e,r,a,n,i){if((o=e._squarify)&&o.ratio===t){var o,s,l,u,c=-1,f,h=o.length,p=e.value;while(++c<h){s=o[c],l=s.children;for(u=s.value=0,f=l.length;u<f;++u)s.value+=l[u].value;if(s.dice)te(s,r,a,n,a+=(i-a)*s.value/p);else ye(s,r,a,r+=(n-r)*s.value/p,i);p-=s.value}}else{e._squarify=o=be(t,e,r,a,n,i);o.ratio=t}}r.ratio=function(t){return e((t=+t)>1?t:1)};return r}(xe);e.cluster=l;e.hierarchy=w;e.pack=J;e.packEnclose=C;e.packSiblings=q;e.partition=re;e.stratify=le;e.tree=ge;e.treemap=we;e.treemapBinary=Te;e.treemapDice=te;e.treemapResquarify=Me;e.treemapSlice=ye;e.treemapSliceDice=ke;e.treemapSquarify=_e;Object.defineProperty(e,"__esModule",{value:true})}))},{}],168:[function(t,r,a){(function(n,i){typeof a==="object"&&typeof r!=="undefined"?i(a,t("d3-color")):typeof e==="function"&&e.amd?e(["exports","d3-color"],i):(n=n||self,i(n.d3=n.d3||{},n.d3))})(this,(function(e,t){"use strict";function r(e,t,r,a,n){var i=e*e,o=i*e;return((1-3*e+3*i-o)*t+(4-6*i+3*o)*r+(1+3*e+3*i-3*o)*a+o*n)/6}function a(e){var t=e.length-1;return function(a){var n=a<=0?a=0:a>=1?(a=1,t-1):Math.floor(a*t),i=e[n],o=e[n+1],s=n>0?e[n-1]:2*i-o,l=n<t-1?e[n+2]:2*o-i;return r((a-n/t)*t,s,i,o,l)}}function n(e){var t=e.length;return function(a){var n=Math.floor(((a%=1)<0?++a:a)*t),i=e[(n+t-1)%t],o=e[n%t],s=e[(n+1)%t],l=e[(n+2)%t];return r((a-n/t)*t,i,o,s,l)}}function i(e){return function(){return e}}function o(e,t){return function(r){return e+r*t}}function s(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(a){return Math.pow(e+a*t,r)}}function l(e,t){var r=t-e;return r?o(e,r>180||r<-180?r-360*Math.round(r/360):r):i(isNaN(e)?t:e)}function u(e){return(e=+e)===1?c:function(t,r){return r-t?s(t,r,e):i(isNaN(t)?r:t)}}function c(e,t){var r=t-e;return r?o(e,r):i(isNaN(e)?t:e)}var f=function e(r){var a=u(r);function n(e,r){var n=a((e=t.rgb(e)).r,(r=t.rgb(r)).r),i=a(e.g,r.g),o=a(e.b,r.b),s=c(e.opacity,r.opacity);return function(t){e.r=n(t);e.g=i(t);e.b=o(t);e.opacity=s(t);return e+""}}n.gamma=e;return n}(1);function h(e){return function(r){var a=r.length,n=new Array(a),i=new Array(a),o=new Array(a),s,l;for(s=0;s<a;++s){l=t.rgb(r[s]);n[s]=l.r||0;i[s]=l.g||0;o[s]=l.b||0}n=e(n);i=e(i);o=e(o);l.opacity=1;return function(e){l.r=n(e);l.g=i(e);l.b=o(e);return l+""}}}var p=h(a);var v=h(n);function d(e,t){if(!t)t=[];var r=e?Math.min(t.length,e.length):0,a=t.slice(),n;return function(i){for(n=0;n<r;++n)a[n]=e[n]*(1-i)+t[n]*i;return a}}function m(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function g(e,t){return(m(t)?d:y)(e,t)}function y(e,t){var r=t?t.length:0,a=e?Math.min(r,e.length):0,n=new Array(a),i=new Array(r),o;for(o=0;o<a;++o)n[o]=S(e[o],t[o]);for(;o<r;++o)i[o]=t[o];return function(e){for(o=0;o<a;++o)i[o]=n[o](e);return i}}function x(e,t){var r=new Date;return e=+e,t=+t,function(a){return r.setTime(e*(1-a)+t*a),r}}function b(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function _(e,t){var r={},a={},n;if(e===null||typeof e!=="object")e={};if(t===null||typeof t!=="object")t={};for(n in t){if(n in e){r[n]=S(e[n],t[n])}else{a[n]=t[n]}}return function(e){for(n in r)a[n]=r[n](e);return a}}var w=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,T=new RegExp(w.source,"g");function k(e){return function(){return e}}function M(e){return function(t){return e(t)+""}}function A(e,t){var r=w.lastIndex=T.lastIndex=0,a,n,i,o=-1,s=[],l=[];e=e+"",t=t+"";while((a=w.exec(e))&&(n=T.exec(t))){if((i=n.index)>r){i=t.slice(r,i);if(s[o])s[o]+=i;else s[++o]=i}if((a=a[0])===(n=n[0])){if(s[o])s[o]+=n;else s[++o]=n}else{s[++o]=null;l.push({i:o,x:b(a,n)})}r=T.lastIndex}if(r<t.length){i=t.slice(r);if(s[o])s[o]+=i;else s[++o]=i}return s.length<2?l[0]?M(l[0].x):k(t):(t=l.length,function(e){for(var r=0,a;r<t;++r)s[(a=l[r]).i]=a.x(e);return s.join("")})}function S(e,r){var a=typeof r,n;return r==null||a==="boolean"?i(r):(a==="number"?b:a==="string"?(n=t.color(r))?(r=n,f):A:r instanceof t.color?f:r instanceof Date?x:m(r)?d:Array.isArray(r)?y:typeof r.valueOf!=="function"&&typeof r.toString!=="function"||isNaN(r)?_:b)(e,r)}function E(e){var t=e.length;return function(r){return e[Math.max(0,Math.min(t-1,Math.floor(r*t)))]}}function L(e,t){var r=l(+e,+t);return function(e){var t=r(e);return t-360*Math.floor(t/360)}}function C(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}var I=180/Math.PI;var P={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function O(e,t,r,a,n,i){var o,s,l;if(o=Math.sqrt(e*e+t*t))e/=o,t/=o;if(l=e*r+t*a)r-=e*l,a-=t*l;if(s=Math.sqrt(r*r+a*a))r/=s,a/=s,l/=s;if(e*a<t*r)e=-e,t=-t,l=-l,o=-o;return{translateX:n,translateY:i,rotate:Math.atan2(t,e)*I,skewX:Math.atan(l)*I,scaleX:o,scaleY:s}}var z,D,R,F;function B(e){if(e==="none")return P;if(!z)z=document.createElement("DIV"),D=document.documentElement,R=document.defaultView;z.style.transform=e;e=R.getComputedStyle(D.appendChild(z),null).getPropertyValue("transform");D.removeChild(z);e=e.slice(7,-1).split(",");return O(+e[0],+e[1],+e[2],+e[3],+e[4],+e[5])}function N(e){if(e==null)return P;if(!F)F=document.createElementNS("http://www.w3.org/2000/svg","g");F.setAttribute("transform",e);if(!(e=F.transform.baseVal.consolidate()))return P;e=e.matrix;return O(e.a,e.b,e.c,e.d,e.e,e.f)}function j(e,t,r,a){function n(e){return e.length?e.pop()+" ":""}function i(e,a,n,i,o,s){if(e!==n||a!==i){var l=o.push("translate(",null,t,null,r);s.push({i:l-4,x:b(e,n)},{i:l-2,x:b(a,i)})}else if(n||i){o.push("translate("+n+t+i+r)}}function o(e,t,r,i){if(e!==t){if(e-t>180)t+=360;else if(t-e>180)e+=360;i.push({i:r.push(n(r)+"rotate(",null,a)-2,x:b(e,t)})}else if(t){r.push(n(r)+"rotate("+t+a)}}function s(e,t,r,i){if(e!==t){i.push({i:r.push(n(r)+"skewX(",null,a)-2,x:b(e,t)})}else if(t){r.push(n(r)+"skewX("+t+a)}}function l(e,t,r,a,i,o){if(e!==r||t!==a){var s=i.push(n(i)+"scale(",null,",",null,")");o.push({i:s-4,x:b(e,r)},{i:s-2,x:b(t,a)})}else if(r!==1||a!==1){i.push(n(i)+"scale("+r+","+a+")")}}return function(t,r){var a=[],n=[];t=e(t),r=e(r);i(t.translateX,t.translateY,r.translateX,r.translateY,a,n);o(t.rotate,r.rotate,a,n);s(t.skewX,r.skewX,a,n);l(t.scaleX,t.scaleY,r.scaleX,r.scaleY,a,n);t=r=null;return function(e){var t=-1,r=n.length,i;while(++t<r)a[(i=n[t]).i]=i.x(e);return a.join("")}}}var U=j(B,"px, ","px)","deg)");var V=j(N,", ",")",")");var H=Math.SQRT2,q=2,G=4,Y=1e-12;function W(e){return((e=Math.exp(e))+1/e)/2}function X(e){return((e=Math.exp(e))-1/e)/2}function Z(e){return((e=Math.exp(2*e))-1)/(e+1)}function J(e,t){var r=e[0],a=e[1],n=e[2],i=t[0],o=t[1],s=t[2],l=i-r,u=o-a,c=l*l+u*u,f,h;if(c<Y){h=Math.log(s/n)/H;f=function(e){return[r+e*l,a+e*u,n*Math.exp(H*e*h)]}}else{var p=Math.sqrt(c),v=(s*s-n*n+G*c)/(2*n*q*p),d=(s*s-n*n-G*c)/(2*s*q*p),m=Math.log(Math.sqrt(v*v+1)-v),g=Math.log(Math.sqrt(d*d+1)-d);h=(g-m)/H;f=function(e){var t=e*h,i=W(m),o=n/(q*p)*(i*Z(H*t+m)-X(m));return[r+o*l,a+o*u,n*i/W(H*t+m)]}}f.duration=h*1e3;return f}function K(e){return function(r,a){var n=e((r=t.hsl(r)).h,(a=t.hsl(a)).h),i=c(r.s,a.s),o=c(r.l,a.l),s=c(r.opacity,a.opacity);return function(e){r.h=n(e);r.s=i(e);r.l=o(e);r.opacity=s(e);return r+""}}}var Q=K(l);var $=K(c);function ee(e,r){var a=c((e=t.lab(e)).l,(r=t.lab(r)).l),n=c(e.a,r.a),i=c(e.b,r.b),o=c(e.opacity,r.opacity);return function(t){e.l=a(t);e.a=n(t);e.b=i(t);e.opacity=o(t);return e+""}}function te(e){return function(r,a){var n=e((r=t.hcl(r)).h,(a=t.hcl(a)).h),i=c(r.c,a.c),o=c(r.l,a.l),s=c(r.opacity,a.opacity);return function(e){r.h=n(e);r.c=i(e);r.l=o(e);r.opacity=s(e);return r+""}}}var re=te(l);var ae=te(c);function ne(e){return function r(a){a=+a;function n(r,n){var i=e((r=t.cubehelix(r)).h,(n=t.cubehelix(n)).h),o=c(r.s,n.s),s=c(r.l,n.l),l=c(r.opacity,n.opacity);return function(e){r.h=i(e);r.s=o(e);r.l=s(Math.pow(e,a));r.opacity=l(e);return r+""}}n.gamma=r;return n}(1)}var ie=ne(l);var oe=ne(c);function se(e,t){var r=0,a=t.length-1,n=t[0],i=new Array(a<0?0:a);while(r<a)i[r]=e(n,n=t[++r]);return function(e){var t=Math.max(0,Math.min(a-1,Math.floor(e*=a)));return i[t](e-t)}}function le(e,t){var r=new Array(t);for(var a=0;a<t;++a)r[a]=e(a/(t-1));return r}e.interpolate=S;e.interpolateArray=g;e.interpolateBasis=a;e.interpolateBasisClosed=n;e.interpolateCubehelix=ie;e.interpolateCubehelixLong=oe;e.interpolateDate=x;e.interpolateDiscrete=E;e.interpolateHcl=re;e.interpolateHclLong=ae;e.interpolateHsl=Q;e.interpolateHslLong=$;e.interpolateHue=L;e.interpolateLab=ee;e.interpolateNumber=b;e.interpolateNumberArray=d;e.interpolateObject=_;e.interpolateRgb=f;e.interpolateRgbBasis=p;e.interpolateRgbBasisClosed=v;e.interpolateRound=C;e.interpolateString=A;e.interpolateTransformCss=U;e.interpolateTransformSvg=V;e.interpolateZoom=J;e.piecewise=se;e.quantize=le;Object.defineProperty(e,"__esModule",{value:true})}))},{"d3-color":161}],169:[function(t,r,a){(function(t,n){typeof a==="object"&&typeof r!=="undefined"?n(a):typeof e==="function"&&e.amd?e(["exports"],n):(t=t||self,n(t.d3=t.d3||{}))})(this,(function(e){"use strict";var t=Math.PI,r=2*t,a=1e-6,n=r-a;function i(){this._x0=this._y0=this._x1=this._y1=null;this._=""}function o(){return new i}i.prototype=o.prototype={constructor:i,moveTo:function(e,t){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)},closePath:function(){if(this._x1!==null){this._x1=this._x0,this._y1=this._y0;this._+="Z"}},lineTo:function(e,t){this._+="L"+(this._x1=+e)+","+(this._y1=+t)},quadraticCurveTo:function(e,t,r,a){this._+="Q"+ +e+","+ +t+","+(this._x1=+r)+","+(this._y1=+a)},bezierCurveTo:function(e,t,r,a,n,i){this._+="C"+ +e+","+ +t+","+ +r+","+ +a+","+(this._x1=+n)+","+(this._y1=+i)},arcTo:function(e,r,n,i,o){e=+e,r=+r,n=+n,i=+i,o=+o;var s=this._x1,l=this._y1,u=n-e,c=i-r,f=s-e,h=l-r,p=f*f+h*h;if(o<0)throw new Error("negative radius: "+o);if(this._x1===null){this._+="M"+(this._x1=e)+","+(this._y1=r)}else if(!(p>a));else if(!(Math.abs(h*u-c*f)>a)||!o){this._+="L"+(this._x1=e)+","+(this._y1=r)}else{var v=n-s,d=i-l,m=u*u+c*c,g=v*v+d*d,y=Math.sqrt(m),x=Math.sqrt(p),b=o*Math.tan((t-Math.acos((m+p-g)/(2*y*x)))/2),_=b/x,w=b/y;if(Math.abs(_-1)>a){this._+="L"+(e+_*f)+","+(r+_*h)}this._+="A"+o+","+o+",0,0,"+ +(h*v>f*d)+","+(this._x1=e+w*u)+","+(this._y1=r+w*c)}},arc:function(e,i,o,s,l,u){e=+e,i=+i,o=+o,u=!!u;var c=o*Math.cos(s),f=o*Math.sin(s),h=e+c,p=i+f,v=1^u,d=u?s-l:l-s;if(o<0)throw new Error("negative radius: "+o);if(this._x1===null){this._+="M"+h+","+p}else if(Math.abs(this._x1-h)>a||Math.abs(this._y1-p)>a){this._+="L"+h+","+p}if(!o)return;if(d<0)d=d%r+r;if(d>n){this._+="A"+o+","+o+",0,1,"+v+","+(e-c)+","+(i-f)+"A"+o+","+o+",0,1,"+v+","+(this._x1=h)+","+(this._y1=p)}else if(d>a){this._+="A"+o+","+o+",0,"+ +(d>=t)+","+v+","+(this._x1=e+o*Math.cos(l))+","+(this._y1=i+o*Math.sin(l))}},rect:function(e,t,r,a){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)+"h"+ +r+"v"+ +a+"h"+-r+"Z"},toString:function(){return this._}};e.path=o;Object.defineProperty(e,"__esModule",{value:true})}))},{}],170:[function(t,r,a){(function(t,n){typeof a==="object"&&typeof r!=="undefined"?n(a):typeof e==="function"&&e.amd?e(["exports"],n):(t=t||self,n(t.d3=t.d3||{}))})(this,(function(e){"use strict";function t(e){var t=+this._x.call(null,e),a=+this._y.call(null,e);return r(this.cover(t,a),t,a,e)}function r(e,t,r,a){if(isNaN(t)||isNaN(r))return e;var n,i=e._root,o={data:a},s=e._x0,l=e._y0,u=e._x1,c=e._y1,f,h,p,v,d,m,g,y;if(!i)return e._root=o,e;while(i.length){if(d=t>=(f=(s+u)/2))s=f;else u=f;if(m=r>=(h=(l+c)/2))l=h;else c=h;if(n=i,!(i=i[g=m<<1|d]))return n[g]=o,e}p=+e._x.call(null,i.data);v=+e._y.call(null,i.data);if(t===p&&r===v)return o.next=i,n?n[g]=o:e._root=o,e;do{n=n?n[g]=new Array(4):e._root=new Array(4);if(d=t>=(f=(s+u)/2))s=f;else u=f;if(m=r>=(h=(l+c)/2))l=h;else c=h}while((g=m<<1|d)===(y=(v>=h)<<1|p>=f));return n[y]=i,n[g]=o,e}function a(e){var t,a,n=e.length,i,o,s=new Array(n),l=new Array(n),u=Infinity,c=Infinity,f=-Infinity,h=-Infinity;for(a=0;a<n;++a){if(isNaN(i=+this._x.call(null,t=e[a]))||isNaN(o=+this._y.call(null,t)))continue;s[a]=i;l[a]=o;if(i<u)u=i;if(i>f)f=i;if(o<c)c=o;if(o>h)h=o}if(u>f||c>h)return this;this.cover(u,c).cover(f,h);for(a=0;a<n;++a){r(this,s[a],l[a],e[a])}return this}function n(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var r=this._x0,a=this._y0,n=this._x1,i=this._y1;if(isNaN(r)){n=(r=Math.floor(e))+1;i=(a=Math.floor(t))+1}else{var o=n-r,s=this._root,l,u;while(r>e||e>=n||a>t||t>=i){u=(t<a)<<1|e<r;l=new Array(4),l[u]=s,s=l,o*=2;switch(u){case 0:n=r+o,i=a+o;break;case 1:r=n-o,i=a+o;break;case 2:n=r+o,a=i-o;break;case 3:r=n-o,a=i-o;break}}if(this._root&&this._root.length)this._root=s}this._x0=r;this._y0=a;this._x1=n;this._y1=i;return this}function i(){var e=[];this.visit((function(t){if(!t.length)do{e.push(t.data)}while(t=t.next)}));return e}function o(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?undefined:[[this._x0,this._y0],[this._x1,this._y1]]}function s(e,t,r,a,n){this.node=e;this.x0=t;this.y0=r;this.x1=a;this.y1=n}function l(e,t,r){var a,n=this._x0,i=this._y0,o,l,u,c,f=this._x1,h=this._y1,p=[],v=this._root,d,m;if(v)p.push(new s(v,n,i,f,h));if(r==null)r=Infinity;else{n=e-r,i=t-r;f=e+r,h=t+r;r*=r}while(d=p.pop()){if(!(v=d.node)||(o=d.x0)>f||(l=d.y0)>h||(u=d.x1)<n||(c=d.y1)<i)continue;if(v.length){var g=(o+u)/2,y=(l+c)/2;p.push(new s(v[3],g,y,u,c),new s(v[2],o,y,g,c),new s(v[1],g,l,u,y),new s(v[0],o,l,g,y));if(m=(t>=y)<<1|e>=g){d=p[p.length-1];p[p.length-1]=p[p.length-1-m];p[p.length-1-m]=d}}else{var x=e-+this._x.call(null,v.data),b=t-+this._y.call(null,v.data),_=x*x+b*b;if(_<r){var w=Math.sqrt(r=_);n=e-w,i=t-w;f=e+w,h=t+w;a=v.data}}}return a}function u(e){if(isNaN(c=+this._x.call(null,e))||isNaN(f=+this._y.call(null,e)))return this;var t,r=this._root,a,n,i,o=this._x0,s=this._y0,l=this._x1,u=this._y1,c,f,h,p,v,d,m,g;if(!r)return this;if(r.length)while(true){if(v=c>=(h=(o+l)/2))o=h;else l=h;if(d=f>=(p=(s+u)/2))s=p;else u=p;if(!(t=r,r=r[m=d<<1|v]))return this;if(!r.length)break;if(t[m+1&3]||t[m+2&3]||t[m+3&3])a=t,g=m}while(r.data!==e)if(!(n=r,r=r.next))return this;if(i=r.next)delete r.next;if(n)return i?n.next=i:delete n.next,this;if(!t)return this._root=i,this;i?t[m]=i:delete t[m];if((r=t[0]||t[1]||t[2]||t[3])&&r===(t[3]||t[2]||t[1]||t[0])&&!r.length){if(a)a[g]=r;else this._root=r}return this}function c(e){for(var t=0,r=e.length;t<r;++t)this.remove(e[t]);return this}function f(){return this._root}function h(){var e=0;this.visit((function(t){if(!t.length)do{++e}while(t=t.next)}));return e}function p(e){var t=[],r,a=this._root,n,i,o,l,u;if(a)t.push(new s(a,this._x0,this._y0,this._x1,this._y1));while(r=t.pop()){if(!e(a=r.node,i=r.x0,o=r.y0,l=r.x1,u=r.y1)&&a.length){var c=(i+l)/2,f=(o+u)/2;if(n=a[3])t.push(new s(n,c,f,l,u));if(n=a[2])t.push(new s(n,i,f,c,u));if(n=a[1])t.push(new s(n,c,o,l,f));if(n=a[0])t.push(new s(n,i,o,c,f))}}return this}function v(e){var t=[],r=[],a;if(this._root)t.push(new s(this._root,this._x0,this._y0,this._x1,this._y1));while(a=t.pop()){var n=a.node;if(n.length){var i,o=a.x0,l=a.y0,u=a.x1,c=a.y1,f=(o+u)/2,h=(l+c)/2;if(i=n[0])t.push(new s(i,o,l,f,h));if(i=n[1])t.push(new s(i,f,l,u,h));if(i=n[2])t.push(new s(i,o,h,f,c));if(i=n[3])t.push(new s(i,f,h,u,c))}r.push(a)}while(a=r.pop()){e(a.node,a.x0,a.y0,a.x1,a.y1)}return this}function d(e){return e[0]}function m(e){return arguments.length?(this._x=e,this):this._x}function g(e){return e[1]}function y(e){return arguments.length?(this._y=e,this):this._y}function x(e,t,r){var a=new b(t==null?d:t,r==null?g:r,NaN,NaN,NaN,NaN);return e==null?a:a.addAll(e)}function b(e,t,r,a,n,i){this._x=e;this._y=t;this._x0=r;this._y0=a;this._x1=n;this._y1=i;this._root=undefined}function _(e){var t={data:e.data},r=t;while(e=e.next)r=r.next={data:e.data};return t}var w=x.prototype=b.prototype;w.copy=function(){var e=new b(this._x,this._y,this._x0,this._y0,this._x1,this._y1),t=this._root,r,a;if(!t)return e;if(!t.length)return e._root=_(t),e;r=[{source:t,target:e._root=new Array(4)}];while(t=r.pop()){for(var n=0;n<4;++n){if(a=t.source[n]){if(a.length)r.push({source:a,target:t.target[n]=new Array(4)});else t.target[n]=_(a)}}}return e};w.add=t;w.addAll=a;w.cover=n;w.data=i;w.extent=o;w.find=l;w.remove=u;w.removeAll=c;w.root=f;w.size=h;w.visit=p;w.visitAfter=v;w.x=m;w.y=y;e.quadtree=x;Object.defineProperty(e,"__esModule",{value:true})}))},{}],171:[function(t,r,a){(function(n,i){typeof a==="object"&&typeof r!=="undefined"?i(a,t("d3-path")):typeof e==="function"&&e.amd?e(["exports","d3-path"],i):(n=n||self,i(n.d3=n.d3||{},n.d3))})(this,(function(e,t){"use strict";function r(e){return function t(){return e}}var a=Math.abs;var n=Math.atan2;var i=Math.cos;var o=Math.max;var s=Math.min;var l=Math.sin;var u=Math.sqrt;var c=1e-12;var f=Math.PI;var h=f/2;var p=2*f;function v(e){return e>1?0:e<-1?f:Math.acos(e)}function d(e){return e>=1?h:e<=-1?-h:Math.asin(e)}function m(e){return e.innerRadius}function g(e){return e.outerRadius}function y(e){return e.startAngle}function x(e){return e.endAngle}function b(e){return e&&e.padAngle}function _(e,t,r,a,n,i,o,s){var l=r-e,u=a-t,f=o-n,h=s-i,p=h*l-f*u;if(p*p<c)return;p=(f*(t-i)-h*(e-n))/p;return[e+p*l,t+p*u]}function w(e,t,r,a,n,i,s){var l=e-r,c=t-a,f=(s?i:-i)/u(l*l+c*c),h=f*c,p=-f*l,v=e+h,d=t+p,m=r+h,g=a+p,y=(v+m)/2,x=(d+g)/2,b=m-v,_=g-d,w=b*b+_*_,T=n-i,k=v*g-m*d,M=(_<0?-1:1)*u(o(0,T*T*w-k*k)),A=(k*_-b*M)/w,S=(-k*b-_*M)/w,E=(k*_+b*M)/w,L=(-k*b+_*M)/w,C=A-y,I=S-x,P=E-y,O=L-x;if(C*C+I*I>P*P+O*O)A=E,S=L;return{cx:A,cy:S,x01:-h,y01:-p,x11:A*(n/T-1),y11:S*(n/T-1)}}function T(){var e=m,o=g,T=r(0),k=null,M=y,A=x,S=b,E=null;function L(){var r,m,g=+e.apply(this,arguments),y=+o.apply(this,arguments),x=M.apply(this,arguments)-h,b=A.apply(this,arguments)-h,L=a(b-x),C=b>x;if(!E)E=r=t.path();if(y<g)m=y,y=g,g=m;if(!(y>c))E.moveTo(0,0);else if(L>p-c){E.moveTo(y*i(x),y*l(x));E.arc(0,0,y,x,b,!C);if(g>c){E.moveTo(g*i(b),g*l(b));E.arc(0,0,g,b,x,C)}}else{var I=x,P=b,O=x,z=b,D=L,R=L,F=S.apply(this,arguments)/2,B=F>c&&(k?+k.apply(this,arguments):u(g*g+y*y)),N=s(a(y-g)/2,+T.apply(this,arguments)),j=N,U=N,V,H;if(B>c){var q=d(B/g*l(F)),G=d(B/y*l(F));if((D-=q*2)>c)q*=C?1:-1,O+=q,z-=q;else D=0,O=z=(x+b)/2;if((R-=G*2)>c)G*=C?1:-1,I+=G,P-=G;else R=0,I=P=(x+b)/2}var Y=y*i(I),W=y*l(I),X=g*i(z),Z=g*l(z);if(N>c){var J=y*i(P),K=y*l(P),Q=g*i(O),$=g*l(O),ee;if(L<f&&(ee=_(Y,W,Q,$,J,K,X,Z))){var te=Y-ee[0],re=W-ee[1],ae=J-ee[0],ne=K-ee[1],ie=1/l(v((te*ae+re*ne)/(u(te*te+re*re)*u(ae*ae+ne*ne)))/2),oe=u(ee[0]*ee[0]+ee[1]*ee[1]);j=s(N,(g-oe)/(ie-1));U=s(N,(y-oe)/(ie+1))}}if(!(R>c))E.moveTo(Y,W);else if(U>c){V=w(Q,$,Y,W,y,U,C);H=w(J,K,X,Z,y,U,C);E.moveTo(V.cx+V.x01,V.cy+V.y01);if(U<N)E.arc(V.cx,V.cy,U,n(V.y01,V.x01),n(H.y01,H.x01),!C);else{E.arc(V.cx,V.cy,U,n(V.y01,V.x01),n(V.y11,V.x11),!C);E.arc(0,0,y,n(V.cy+V.y11,V.cx+V.x11),n(H.cy+H.y11,H.cx+H.x11),!C);E.arc(H.cx,H.cy,U,n(H.y11,H.x11),n(H.y01,H.x01),!C)}}else E.moveTo(Y,W),E.arc(0,0,y,I,P,!C);if(!(g>c)||!(D>c))E.lineTo(X,Z);else if(j>c){V=w(X,Z,J,K,g,-j,C);H=w(Y,W,Q,$,g,-j,C);E.lineTo(V.cx+V.x01,V.cy+V.y01);if(j<N)E.arc(V.cx,V.cy,j,n(V.y01,V.x01),n(H.y01,H.x01),!C);else{E.arc(V.cx,V.cy,j,n(V.y01,V.x01),n(V.y11,V.x11),!C);E.arc(0,0,g,n(V.cy+V.y11,V.cx+V.x11),n(H.cy+H.y11,H.cx+H.x11),C);E.arc(H.cx,H.cy,j,n(H.y11,H.x11),n(H.y01,H.x01),!C)}}else E.arc(0,0,g,z,O,C)}E.closePath();if(r)return E=null,r+""||null}L.centroid=function(){var t=(+e.apply(this,arguments)+ +o.apply(this,arguments))/2,r=(+M.apply(this,arguments)+ +A.apply(this,arguments))/2-f/2;return[i(r)*t,l(r)*t]};L.innerRadius=function(t){return arguments.length?(e=typeof t==="function"?t:r(+t),L):e};L.outerRadius=function(e){return arguments.length?(o=typeof e==="function"?e:r(+e),L):o};L.cornerRadius=function(e){return arguments.length?(T=typeof e==="function"?e:r(+e),L):T};L.padRadius=function(e){return arguments.length?(k=e==null?null:typeof e==="function"?e:r(+e),L):k};L.startAngle=function(e){return arguments.length?(M=typeof e==="function"?e:r(+e),L):M};L.endAngle=function(e){return arguments.length?(A=typeof e==="function"?e:r(+e),L):A};L.padAngle=function(e){return arguments.length?(S=typeof e==="function"?e:r(+e),L):S};L.context=function(e){return arguments.length?(E=e==null?null:e,L):E};return L}function k(e){this._context=e}k.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){if(this._line||this._line!==0&&this._point===1)this._context.closePath();this._line=1-this._line},point:function(e,t){e=+e,t=+t;switch(this._point){case 0:this._point=1;this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function M(e){return new k(e)}function A(e){return e[0]}function S(e){return e[1]}function E(){var e=A,a=S,n=r(true),i=null,o=M,s=null;function l(r){var l,u=r.length,c,f=false,h;if(i==null)s=o(h=t.path());for(l=0;l<=u;++l){if(!(l<u&&n(c=r[l],l,r))===f){if(f=!f)s.lineStart();else s.lineEnd()}if(f)s.point(+e(c,l,r),+a(c,l,r))}if(h)return s=null,h+""||null}l.x=function(t){return arguments.length?(e=typeof t==="function"?t:r(+t),l):e};l.y=function(e){return arguments.length?(a=typeof e==="function"?e:r(+e),l):a};l.defined=function(e){return arguments.length?(n=typeof e==="function"?e:r(!!e),l):n};l.curve=function(e){return arguments.length?(o=e,i!=null&&(s=o(i)),l):o};l.context=function(e){return arguments.length?(e==null?i=s=null:s=o(i=e),l):i};return l}function L(){var e=A,a=null,n=r(0),i=S,o=r(true),s=null,l=M,u=null;function c(r){var c,f,h,p=r.length,v,d=false,m,g=new Array(p),y=new Array(p);if(s==null)u=l(m=t.path());for(c=0;c<=p;++c){if(!(c<p&&o(v=r[c],c,r))===d){if(d=!d){f=c;u.areaStart();u.lineStart()}else{u.lineEnd();u.lineStart();for(h=c-1;h>=f;--h){u.point(g[h],y[h])}u.lineEnd();u.areaEnd()}}if(d){g[c]=+e(v,c,r),y[c]=+n(v,c,r);u.point(a?+a(v,c,r):g[c],i?+i(v,c,r):y[c])}}if(m)return u=null,m+""||null}function f(){return E().defined(o).curve(l).context(s)}c.x=function(t){return arguments.length?(e=typeof t==="function"?t:r(+t),a=null,c):e};c.x0=function(t){return arguments.length?(e=typeof t==="function"?t:r(+t),c):e};c.x1=function(e){return arguments.length?(a=e==null?null:typeof e==="function"?e:r(+e),c):a};c.y=function(e){return arguments.length?(n=typeof e==="function"?e:r(+e),i=null,c):n};c.y0=function(e){return arguments.length?(n=typeof e==="function"?e:r(+e),c):n};c.y1=function(e){return arguments.length?(i=e==null?null:typeof e==="function"?e:r(+e),c):i};c.lineX0=c.lineY0=function(){return f().x(e).y(n)};c.lineY1=function(){return f().x(e).y(i)};c.lineX1=function(){return f().x(a).y(n)};c.defined=function(e){return arguments.length?(o=typeof e==="function"?e:r(!!e),c):o};c.curve=function(e){return arguments.length?(l=e,s!=null&&(u=l(s)),c):l};c.context=function(e){return arguments.length?(e==null?s=u=null:u=l(s=e),c):s};return c}function C(e,t){return t<e?-1:t>e?1:t>=e?0:NaN}function I(e){return e}function P(){var e=I,t=C,a=null,n=r(0),i=r(p),o=r(0);function s(r){var s,l=r.length,u,c,f=0,h=new Array(l),v=new Array(l),d=+n.apply(this,arguments),m=Math.min(p,Math.max(-p,i.apply(this,arguments)-d)),g,y=Math.min(Math.abs(m)/l,o.apply(this,arguments)),x=y*(m<0?-1:1),b;for(s=0;s<l;++s){if((b=v[h[s]=s]=+e(r[s],s,r))>0){f+=b}}if(t!=null)h.sort((function(e,r){return t(v[e],v[r])}));else if(a!=null)h.sort((function(e,t){return a(r[e],r[t])}));for(s=0,c=f?(m-l*x)/f:0;s<l;++s,d=g){u=h[s],b=v[u],g=d+(b>0?b*c:0)+x,v[u]={data:r[u],index:s,value:b,startAngle:d,endAngle:g,padAngle:y}}return v}s.value=function(t){return arguments.length?(e=typeof t==="function"?t:r(+t),s):e};s.sortValues=function(e){return arguments.length?(t=e,a=null,s):t};s.sort=function(e){return arguments.length?(a=e,t=null,s):a};s.startAngle=function(e){return arguments.length?(n=typeof e==="function"?e:r(+e),s):n};s.endAngle=function(e){return arguments.length?(i=typeof e==="function"?e:r(+e),s):i};s.padAngle=function(e){return arguments.length?(o=typeof e==="function"?e:r(+e),s):o};return s}var O=D(M);function z(e){this._curve=e}z.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(e,t){this._curve.point(t*Math.sin(e),t*-Math.cos(e))}};function D(e){function t(t){return new z(e(t))}t._curve=e;return t}function R(e){var t=e.curve;e.angle=e.x,delete e.x;e.radius=e.y,delete e.y;e.curve=function(e){return arguments.length?t(D(e)):t()._curve};return e}function F(){return R(E().curve(O))}function B(){var e=L().curve(O),t=e.curve,r=e.lineX0,a=e.lineX1,n=e.lineY0,i=e.lineY1;e.angle=e.x,delete e.x;e.startAngle=e.x0,delete e.x0;e.endAngle=e.x1,delete e.x1;e.radius=e.y,delete e.y;e.innerRadius=e.y0,delete e.y0;e.outerRadius=e.y1,delete e.y1;e.lineStartAngle=function(){return R(r())},delete e.lineX0;e.lineEndAngle=function(){return R(a())},delete e.lineX1;e.lineInnerRadius=function(){return R(n())},delete e.lineY0;e.lineOuterRadius=function(){return R(i())},delete e.lineY1;e.curve=function(e){return arguments.length?t(D(e)):t()._curve};return e}function N(e,t){return[(t=+t)*Math.cos(e-=Math.PI/2),t*Math.sin(e)]}var j=Array.prototype.slice;function U(e){return e.source}function V(e){return e.target}function H(e){var a=U,n=V,i=A,o=S,s=null;function l(){var r,l=j.call(arguments),u=a.apply(this,l),c=n.apply(this,l);if(!s)s=r=t.path();e(s,+i.apply(this,(l[0]=u,l)),+o.apply(this,l),+i.apply(this,(l[0]=c,l)),+o.apply(this,l));if(r)return s=null,r+""||null}l.source=function(e){return arguments.length?(a=e,l):a};l.target=function(e){return arguments.length?(n=e,l):n};l.x=function(e){return arguments.length?(i=typeof e==="function"?e:r(+e),l):i};l.y=function(e){return arguments.length?(o=typeof e==="function"?e:r(+e),l):o};l.context=function(e){return arguments.length?(s=e==null?null:e,l):s};return l}function q(e,t,r,a,n){e.moveTo(t,r);e.bezierCurveTo(t=(t+a)/2,r,t,n,a,n)}function G(e,t,r,a,n){e.moveTo(t,r);e.bezierCurveTo(t,r=(r+n)/2,a,r,a,n)}function Y(e,t,r,a,n){var i=N(t,r),o=N(t,r=(r+n)/2),s=N(a,r),l=N(a,n);e.moveTo(i[0],i[1]);e.bezierCurveTo(o[0],o[1],s[0],s[1],l[0],l[1])}function W(){return H(q)}function X(){return H(G)}function Z(){var e=H(Y);e.angle=e.x,delete e.x;e.radius=e.y,delete e.y;return e}var J={draw:function(e,t){var r=Math.sqrt(t/f);e.moveTo(r,0);e.arc(0,0,r,0,p)}};var K={draw:function(e,t){var r=Math.sqrt(t/5)/2;e.moveTo(-3*r,-r);e.lineTo(-r,-r);e.lineTo(-r,-3*r);e.lineTo(r,-3*r);e.lineTo(r,-r);e.lineTo(3*r,-r);e.lineTo(3*r,r);e.lineTo(r,r);e.lineTo(r,3*r);e.lineTo(-r,3*r);e.lineTo(-r,r);e.lineTo(-3*r,r);e.closePath()}};var Q=Math.sqrt(1/3),$=Q*2;var ee={draw:function(e,t){var r=Math.sqrt(t/$),a=r*Q;e.moveTo(0,-r);e.lineTo(a,0);e.lineTo(0,r);e.lineTo(-a,0);e.closePath()}};var te=.8908130915292852,re=Math.sin(f/10)/Math.sin(7*f/10),ae=Math.sin(p/10)*re,ne=-Math.cos(p/10)*re;var ie={draw:function(e,t){var r=Math.sqrt(t*te),a=ae*r,n=ne*r;e.moveTo(0,-r);e.lineTo(a,n);for(var i=1;i<5;++i){var o=p*i/5,s=Math.cos(o),l=Math.sin(o);e.lineTo(l*r,-s*r);e.lineTo(s*a-l*n,l*a+s*n)}e.closePath()}};var oe={draw:function(e,t){var r=Math.sqrt(t),a=-r/2;e.rect(a,a,r,r)}};var se=Math.sqrt(3);var le={draw:function(e,t){var r=-Math.sqrt(t/(se*3));e.moveTo(0,r*2);e.lineTo(-se*r,-r);e.lineTo(se*r,-r);e.closePath()}};var ue=-.5,ce=Math.sqrt(3)/2,fe=1/Math.sqrt(12),he=(fe/2+1)*3;var pe={draw:function(e,t){var r=Math.sqrt(t/he),a=r/2,n=r*fe,i=a,o=r*fe+r,s=-i,l=o;e.moveTo(a,n);e.lineTo(i,o);e.lineTo(s,l);e.lineTo(ue*a-ce*n,ce*a+ue*n);e.lineTo(ue*i-ce*o,ce*i+ue*o);e.lineTo(ue*s-ce*l,ce*s+ue*l);e.lineTo(ue*a+ce*n,ue*n-ce*a);e.lineTo(ue*i+ce*o,ue*o-ce*i);e.lineTo(ue*s+ce*l,ue*l-ce*s);e.closePath()}};var ve=[J,K,ee,oe,ie,le,pe];function de(){var e=r(J),a=r(64),n=null;function i(){var r;if(!n)n=r=t.path();e.apply(this,arguments).draw(n,+a.apply(this,arguments));if(r)return n=null,r+""||null}i.type=function(t){return arguments.length?(e=typeof t==="function"?t:r(t),i):e};i.size=function(e){return arguments.length?(a=typeof e==="function"?e:r(+e),i):a};i.context=function(e){return arguments.length?(n=e==null?null:e,i):n};return i}function me(){}function ge(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function ye(e){this._context=e}ye.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN;this._point=0},lineEnd:function(){switch(this._point){case 3:ge(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}if(this._line||this._line!==0&&this._point===1)this._context.closePath();this._line=1-this._line},point:function(e,t){e=+e,t=+t;switch(this._point){case 0:this._point=1;this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:ge(this,e,t);break}this._x0=this._x1,this._x1=e;this._y0=this._y1,this._y1=t}};function xe(e){return new ye(e)}function be(e){this._context=e}be.prototype={areaStart:me,areaEnd:me,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN;this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2);this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3);this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3);this._context.closePath();break}case 3:{this.point(this._x2,this._y2);this.point(this._x3,this._y3);this.point(this._x4,this._y4);break}}},point:function(e,t){e=+e,t=+t;switch(this._point){case 0:this._point=1;this._x2=e,this._y2=t;break;case 1:this._point=2;this._x3=e,this._y3=t;break;case 2:this._point=3;this._x4=e,this._y4=t;this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:ge(this,e,t);break}this._x0=this._x1,this._x1=e;this._y0=this._y1,this._y1=t}};function _e(e){return new be(e)}function we(e){this._context=e}we.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN;this._point=0},lineEnd:function(){if(this._line||this._line!==0&&this._point===3)this._context.closePath();this._line=1-this._line},point:function(e,t){e=+e,t=+t;switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,a=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,a):this._context.moveTo(r,a);break;case 3:this._point=4;default:ge(this,e,t);break}this._x0=this._x1,this._x1=e;this._y0=this._y1,this._y1=t}};function Te(e){return new we(e)}function ke(e,t){this._basis=new ye(e);this._beta=t}ke.prototype={lineStart:function(){this._x=[];this._y=[];this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,r=e.length-1;if(r>0){var a=e[0],n=t[0],i=e[r]-a,o=t[r]-n,s=-1,l;while(++s<=r){l=s/r;this._basis.point(this._beta*e[s]+(1-this._beta)*(a+l*i),this._beta*t[s]+(1-this._beta)*(n+l*o))}}this._x=this._y=null;this._basis.lineEnd()},point:function(e,t){this._x.push(+e);this._y.push(+t)}};var Me=function e(t){function r(e){return t===1?new ye(e):new ke(e,t)}r.beta=function(t){return e(+t)};return r}(.85);function Ae(e,t,r){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-r),e._x2,e._y2)}function Se(e,t){this._context=e;this._k=(1-t)/6}Se.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN;this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:Ae(this,this._x1,this._y1);break}if(this._line||this._line!==0&&this._point===1)this._context.closePath();this._line=1-this._line},point:function(e,t){e=+e,t=+t;switch(this._point){case 0:this._point=1;this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;this._x1=e,this._y1=t;break;case 2:this._point=3;default:Ae(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e;this._y0=this._y1,this._y1=this._y2,this._y2=t}};var Ee=function e(t){function r(e){return new Se(e,t)}r.tension=function(t){return e(+t)};return r}(0);function Le(e,t){this._context=e;this._k=(1-t)/6}Le.prototype={areaStart:me,areaEnd:me,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN;this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3);this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3);this._context.closePath();break}case 3:{this.point(this._x3,this._y3);this.point(this._x4,this._y4);this.point(this._x5,this._y5);break}}},point:function(e,t){e=+e,t=+t;switch(this._point){case 0:this._point=1;this._x3=e,this._y3=t;break;case 1:this._point=2;this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3;this._x5=e,this._y5=t;break;default:Ae(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e;this._y0=this._y1,this._y1=this._y2,this._y2=t}};var Ce=function e(t){function r(e){return new Le(e,t)}r.tension=function(t){return e(+t)};return r}(0);function Ie(e,t){this._context=e;this._k=(1-t)/6}Ie.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN;this._point=0},lineEnd:function(){if(this._line||this._line!==0&&this._point===3)this._context.closePath();this._line=1-this._line},point:function(e,t){e=+e,t=+t;switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Ae(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e;this._y0=this._y1,this._y1=this._y2,this._y2=t}};var Pe=function e(t){function r(e){return new Ie(e,t)}r.tension=function(t){return e(+t)};return r}(0);function Oe(e,t,r){var a=e._x1,n=e._y1,i=e._x2,o=e._y2;if(e._l01_a>c){var s=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,l=3*e._l01_a*(e._l01_a+e._l12_a);a=(a*s-e._x0*e._l12_2a+e._x2*e._l01_2a)/l;n=(n*s-e._y0*e._l12_2a+e._y2*e._l01_2a)/l}if(e._l23_a>c){var u=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,f=3*e._l23_a*(e._l23_a+e._l12_a);i=(i*u+e._x1*e._l23_2a-t*e._l12_2a)/f;o=(o*u+e._y1*e._l23_2a-r*e._l12_2a)/f}e._context.bezierCurveTo(a,n,i,o,e._x2,e._y2)}function ze(e,t){this._context=e;this._alpha=t}ze.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN;this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}if(this._line||this._line!==0&&this._point===1)this._context.closePath();this._line=1-this._line},point:function(e,t){e=+e,t=+t;if(this._point){var r=this._x2-e,a=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(r*r+a*a,this._alpha))}switch(this._point){case 0:this._point=1;this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:Oe(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a;this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a;this._x0=this._x1,this._x1=this._x2,this._x2=e;this._y0=this._y1,this._y1=this._y2,this._y2=t}};var De=function e(t){function r(e){return t?new ze(e,t):new Se(e,0)}r.alpha=function(t){return e(+t)};return r}(.5);function Re(e,t){this._context=e;this._alpha=t}Re.prototype={areaStart:me,areaEnd:me,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN;this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3);this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3);this._context.closePath();break}case 3:{this.point(this._x3,this._y3);this.point(this._x4,this._y4);this.point(this._x5,this._y5);break}}},point:function(e,t){e=+e,t=+t;if(this._point){var r=this._x2-e,a=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(r*r+a*a,this._alpha))}switch(this._point){case 0:this._point=1;this._x3=e,this._y3=t;break;case 1:this._point=2;this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3;this._x5=e,this._y5=t;break;default:Oe(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a;this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a;this._x0=this._x1,this._x1=this._x2,this._x2=e;this._y0=this._y1,this._y1=this._y2,this._y2=t}};var Fe=function e(t){function r(e){return t?new Re(e,t):new Le(e,0)}r.alpha=function(t){return e(+t)};return r}(.5);function Be(e,t){this._context=e;this._alpha=t}Be.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN;this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){if(this._line||this._line!==0&&this._point===3)this._context.closePath();this._line=1-this._line},point:function(e,t){e=+e,t=+t;if(this._point){var r=this._x2-e,a=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(r*r+a*a,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Oe(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a;this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a;this._x0=this._x1,this._x1=this._x2,this._x2=e;this._y0=this._y1,this._y1=this._y2,this._y2=t}};var Ne=function e(t){function r(e){return t?new Be(e,t):new Ie(e,0)}r.alpha=function(t){return e(+t)};return r}(.5);function je(e){this._context=e}je.prototype={areaStart:me,areaEnd:me,lineStart:function(){this._point=0},lineEnd:function(){if(this._point)this._context.closePath()},point:function(e,t){e=+e,t=+t;if(this._point)this._context.lineTo(e,t);else this._point=1,this._context.moveTo(e,t)}};function Ue(e){return new je(e)}function Ve(e){return e<0?-1:1}function He(e,t,r){var a=e._x1-e._x0,n=t-e._x1,i=(e._y1-e._y0)/(a||n<0&&-0),o=(r-e._y1)/(n||a<0&&-0),s=(i*n+o*a)/(a+n);return(Ve(i)+Ve(o))*Math.min(Math.abs(i),Math.abs(o),.5*Math.abs(s))||0}function qe(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function Ge(e,t,r){var a=e._x0,n=e._y0,i=e._x1,o=e._y1,s=(i-a)/3;e._context.bezierCurveTo(a+s,n+s*t,i-s,o-s*r,i,o)}function Ye(e){this._context=e}Ye.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN;this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Ge(this,this._t0,qe(this,this._t0));break}if(this._line||this._line!==0&&this._point===1)this._context.closePath();this._line=1-this._line},point:function(e,t){var r=NaN;e=+e,t=+t;if(e===this._x1&&t===this._y1)return;switch(this._point){case 0:this._point=1;this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;Ge(this,qe(this,r=He(this,e,t)),r);break;default:Ge(this,this._t0,r=He(this,e,t));break}this._x0=this._x1,this._x1=e;this._y0=this._y1,this._y1=t;this._t0=r}};function We(e){this._context=new Xe(e)}(We.prototype=Object.create(Ye.prototype)).point=function(e,t){Ye.prototype.point.call(this,t,e)};function Xe(e){this._context=e}Xe.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,a,n,i){this._context.bezierCurveTo(t,e,a,r,i,n)}};function Ze(e){return new Ye(e)}function Je(e){return new We(e)}function Ke(e){this._context=e}Ke.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[];this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r){this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]);if(r===2){this._context.lineTo(e[1],t[1])}else{var a=Qe(e),n=Qe(t);for(var i=0,o=1;o<r;++i,++o){this._context.bezierCurveTo(a[0][i],n[0][i],a[1][i],n[1][i],e[o],t[o])}}}if(this._line||this._line!==0&&r===1)this._context.closePath();this._line=1-this._line;this._x=this._y=null},point:function(e,t){this._x.push(+e);this._y.push(+t)}};function Qe(e){var t,r=e.length-1,a,n=new Array(r),i=new Array(r),o=new Array(r);n[0]=0,i[0]=2,o[0]=e[0]+2*e[1];for(t=1;t<r-1;++t)n[t]=1,i[t]=4,o[t]=4*e[t]+2*e[t+1];n[r-1]=2,i[r-1]=7,o[r-1]=8*e[r-1]+e[r];for(t=1;t<r;++t)a=n[t]/i[t-1],i[t]-=a,o[t]-=a*o[t-1];n[r-1]=o[r-1]/i[r-1];for(t=r-2;t>=0;--t)n[t]=(o[t]-n[t+1])/i[t];i[r-1]=(e[r]+n[r-1])/2;for(t=0;t<r-1;++t)i[t]=2*e[t+1]-n[t+1];return[n,i]}function $e(e){return new Ke(e)}function et(e,t){this._context=e;this._t=t}et.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN;this._point=0},lineEnd:function(){if(0<this._t&&this._t<1&&this._point===2)this._context.lineTo(this._x,this._y);if(this._line||this._line!==0&&this._point===1)this._context.closePath();if(this._line>=0)this._t=1-this._t,this._line=1-this._line},point:function(e,t){e=+e,t=+t;switch(this._point){case 0:this._point=1;this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0){this._context.lineTo(this._x,t);this._context.lineTo(e,t)}else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y);this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function tt(e){return new et(e,.5)}function rt(e){return new et(e,0)}function at(e){return new et(e,1)}function nt(e,t){if(!((o=e.length)>1))return;for(var r=1,a,n,i=e[t[0]],o,s=i.length;r<o;++r){n=i,i=e[t[r]];for(a=0;a<s;++a){i[a][1]+=i[a][0]=isNaN(n[a][1])?n[a][0]:n[a][1]}}}function it(e){var t=e.length,r=new Array(t);while(--t>=0)r[t]=t;return r}function ot(e,t){return e[t]}function st(){var e=r([]),t=it,a=nt,n=ot;function i(r){var i=e.apply(this,arguments),o,s=r.length,l=i.length,u=new Array(l),c;for(o=0;o<l;++o){for(var f=i[o],h=u[o]=new Array(s),p=0,v;p<s;++p){h[p]=v=[0,+n(r[p],f,p,r)];v.data=r[p]}h.key=f}for(o=0,c=t(u);o<l;++o){u[c[o]].index=o}a(u,c);return u}i.keys=function(t){return arguments.length?(e=typeof t==="function"?t:r(j.call(t)),i):e};i.value=function(e){return arguments.length?(n=typeof e==="function"?e:r(+e),i):n};i.order=function(e){return arguments.length?(t=e==null?it:typeof e==="function"?e:r(j.call(e)),i):t};i.offset=function(e){return arguments.length?(a=e==null?nt:e,i):a};return i}function lt(e,t){if(!((a=e.length)>0))return;for(var r,a,n=0,i=e[0].length,o;n<i;++n){for(o=r=0;r<a;++r)o+=e[r][n][1]||0;if(o)for(r=0;r<a;++r)e[r][n][1]/=o}nt(e,t)}function ut(e,t){if(!((l=e.length)>0))return;for(var r,a=0,n,i,o,s,l,u=e[t[0]].length;a<u;++a){for(o=s=0,r=0;r<l;++r){if((i=(n=e[t[r]][a])[1]-n[0])>0){n[0]=o,n[1]=o+=i}else if(i<0){n[1]=s,n[0]=s+=i}else{n[0]=0,n[1]=i}}}}function ct(e,t){if(!((n=e.length)>0))return;for(var r=0,a=e[t[0]],n,i=a.length;r<i;++r){for(var o=0,s=0;o<n;++o)s+=e[o][r][1]||0;a[r][1]+=a[r][0]=-s/2}nt(e,t)}function ft(e,t){if(!((o=e.length)>0)||!((i=(n=e[t[0]]).length)>0))return;for(var r=0,a=1,n,i,o;a<i;++a){for(var s=0,l=0,u=0;s<o;++s){var c=e[t[s]],f=c[a][1]||0,h=c[a-1][1]||0,p=(f-h)/2;for(var v=0;v<s;++v){var d=e[t[v]],m=d[a][1]||0,g=d[a-1][1]||0;p+=m-g}l+=f,u+=p*f}n[a-1][1]+=n[a-1][0]=r;if(l)r-=u/l}n[a-1][1]+=n[a-1][0]=r;nt(e,t)}function ht(e){var t=e.map(pt);return it(e).sort((function(e,r){return t[e]-t[r]}))}function pt(e){var t=-1,r=0,a=e.length,n,i=-Infinity;while(++t<a)if((n=+e[t][1])>i)i=n,r=t;return r}function vt(e){var t=e.map(dt);return it(e).sort((function(e,r){return t[e]-t[r]}))}function dt(e){var t=0,r=-1,a=e.length,n;while(++r<a)if(n=+e[r][1])t+=n;return t}function mt(e){return vt(e).reverse()}function gt(e){var t=e.length,r,a,n=e.map(dt),i=ht(e),o=0,s=0,l=[],u=[];for(r=0;r<t;++r){a=i[r];if(o<s){o+=n[a];l.push(a)}else{s+=n[a];u.push(a)}}return u.reverse().concat(l)}function yt(e){return it(e).reverse()}e.arc=T;e.area=L;e.areaRadial=B;e.curveBasis=xe;e.curveBasisClosed=_e;e.curveBasisOpen=Te;e.curveBundle=Me;e.curveCardinal=Ee;e.curveCardinalClosed=Ce;e.curveCardinalOpen=Pe;e.curveCatmullRom=De;e.curveCatmullRomClosed=Fe;e.curveCatmullRomOpen=Ne;e.curveLinear=M;e.curveLinearClosed=Ue;e.curveMonotoneX=Ze;e.curveMonotoneY=Je;e.curveNatural=$e;e.curveStep=tt;e.curveStepAfter=at;e.curveStepBefore=rt;e.line=E;e.lineRadial=F;e.linkHorizontal=W;e.linkRadial=Z;e.linkVertical=X;e.pie=P;e.pointRadial=N;e.radialArea=B;e.radialLine=F;e.stack=st;e.stackOffsetDiverging=ut;e.stackOffsetExpand=lt;e.stackOffsetNone=nt;e.stackOffsetSilhouette=ct;e.stackOffsetWiggle=ft;e.stackOrderAppearance=ht;e.stackOrderAscending=vt;e.stackOrderDescending=mt;e.stackOrderInsideOut=gt;e.stackOrderNone=it;e.stackOrderReverse=yt;e.symbol=de;e.symbolCircle=J;e.symbolCross=K;e.symbolDiamond=ee;e.symbolSquare=oe;e.symbolStar=ie;e.symbolTriangle=le;e.symbolWye=pe;e.symbols=ve;Object.defineProperty(e,"__esModule",{value:true})}))},{"d3-path":169}],172:[function(t,r,a){(function(n,i){typeof a==="object"&&typeof r!=="undefined"?i(a,t("d3-time")):typeof e==="function"&&e.amd?e(["exports","d3-time"],i):(n=n||self,i(n.d3=n.d3||{},n.d3))})(this,(function(e,t){"use strict";function r(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);t.setFullYear(e.y);return t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function a(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));t.setUTCFullYear(e.y);return t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function n(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function i(e){var i=e.dateTime,s=e.date,l=e.time,u=e.periods,c=e.days,f=e.shortDays,ge=e.months,ye=e.shortMonths;var xe=h(u),be=p(u),_e=h(c),we=p(c),Te=h(f),ke=p(f),Me=h(ge),Ae=p(ge),Se=h(ye),Ee=p(ye);var Le={a:He,A:qe,b:Ge,B:Ye,c:null,d:z,e:z,f:N,H:D,I:R,j:F,L:B,m:j,M:U,p:We,q:Xe,Q:de,s:me,S:V,u:H,U:q,V:G,w:Y,W,x:null,X:null,y:X,Y:Z,Z:J,"%":ve};var Ce={a:Ze,A:Je,b:Ke,B:Qe,c:null,d:K,e:K,f:re,H:Q,I:$,j:ee,L:te,m:ae,M:ne,p:$e,q:et,Q:de,s:me,S:ie,u:oe,U:se,V:le,w:ue,W:ce,x:null,X:null,y:fe,Y:he,Z:pe,"%":ve};var Ie={a:Re,A:Fe,b:Be,B:Ne,c:je,d:k,e:k,f:C,H:A,I:A,j:M,L,m:T,M:S,p:De,q:w,Q:P,s:O,S:E,u:d,U:m,V:g,w:v,W:y,x:Ue,X:Ve,y:b,Y:x,Z:_,"%":I};Le.x=Pe(s,Le);Le.X=Pe(l,Le);Le.c=Pe(i,Le);Ce.x=Pe(s,Ce);Ce.X=Pe(l,Ce);Ce.c=Pe(i,Ce);function Pe(e,t){return function(r){var a=[],n=-1,i=0,s=e.length,l,u,c;if(!(r instanceof Date))r=new Date(+r);while(++n<s){if(e.charCodeAt(n)===37){a.push(e.slice(i,n));if((u=o[l=e.charAt(++n)])!=null)l=e.charAt(++n);else u=l==="e"?" ":"0";if(c=t[l])l=c(r,u);a.push(l);i=n+1}}a.push(e.slice(i,n));return a.join("")}}function Oe(e,i){return function(o){var s=n(1900,undefined,1),l=ze(s,e,o+="",0),u,c;if(l!=o.length)return null;if("Q"in s)return new Date(s.Q);if("s"in s)return new Date(s.s*1e3+("L"in s?s.L:0));if(i&&!("Z"in s))s.Z=0;if("p"in s)s.H=s.H%12+s.p*12;if(s.m===undefined)s.m="q"in s?s.q:0;if("V"in s){if(s.V<1||s.V>53)return null;if(!("w"in s))s.w=1;if("Z"in s){u=a(n(s.y,0,1)),c=u.getUTCDay();u=c>4||c===0?t.utcMonday.ceil(u):t.utcMonday(u);u=t.utcDay.offset(u,(s.V-1)*7);s.y=u.getUTCFullYear();s.m=u.getUTCMonth();s.d=u.getUTCDate()+(s.w+6)%7}else{u=r(n(s.y,0,1)),c=u.getDay();u=c>4||c===0?t.timeMonday.ceil(u):t.timeMonday(u);u=t.timeDay.offset(u,(s.V-1)*7);s.y=u.getFullYear();s.m=u.getMonth();s.d=u.getDate()+(s.w+6)%7}}else if("W"in s||"U"in s){if(!("w"in s))s.w="u"in s?s.u%7:"W"in s?1:0;c="Z"in s?a(n(s.y,0,1)).getUTCDay():r(n(s.y,0,1)).getDay();s.m=0;s.d="W"in s?(s.w+6)%7+s.W*7-(c+5)%7:s.w+s.U*7-(c+6)%7}if("Z"in s){s.H+=s.Z/100|0;s.M+=s.Z%100;return a(s)}return r(s)}}function ze(e,t,r,a){var n=0,i=t.length,s=r.length,l,u;while(n<i){if(a>=s)return-1;l=t.charCodeAt(n++);if(l===37){l=t.charAt(n++);u=Ie[l in o?t.charAt(n++):l];if(!u||(a=u(e,r,a))<0)return-1}else if(l!=r.charCodeAt(a++)){return-1}}return a}function De(e,t,r){var a=xe.exec(t.slice(r));return a?(e.p=be[a[0].toLowerCase()],r+a[0].length):-1}function Re(e,t,r){var a=Te.exec(t.slice(r));return a?(e.w=ke[a[0].toLowerCase()],r+a[0].length):-1}function Fe(e,t,r){var a=_e.exec(t.slice(r));return a?(e.w=we[a[0].toLowerCase()],r+a[0].length):-1}function Be(e,t,r){var a=Se.exec(t.slice(r));return a?(e.m=Ee[a[0].toLowerCase()],r+a[0].length):-1}function Ne(e,t,r){var a=Me.exec(t.slice(r));return a?(e.m=Ae[a[0].toLowerCase()],r+a[0].length):-1}function je(e,t,r){return ze(e,i,t,r)}function Ue(e,t,r){return ze(e,s,t,r)}function Ve(e,t,r){return ze(e,l,t,r)}function He(e){return f[e.getDay()]}function qe(e){return c[e.getDay()]}function Ge(e){return ye[e.getMonth()]}function Ye(e){return ge[e.getMonth()]}function We(e){return u[+(e.getHours()>=12)]}function Xe(e){return 1+~~(e.getMonth()/3)}function Ze(e){return f[e.getUTCDay()]}function Je(e){return c[e.getUTCDay()]}function Ke(e){return ye[e.getUTCMonth()]}function Qe(e){return ge[e.getUTCMonth()]}function $e(e){return u[+(e.getUTCHours()>=12)]}function et(e){return 1+~~(e.getUTCMonth()/3)}return{format:function(e){var t=Pe(e+="",Le);t.toString=function(){return e};return t},parse:function(e){var t=Oe(e+="",false);t.toString=function(){return e};return t},utcFormat:function(e){var t=Pe(e+="",Ce);t.toString=function(){return e};return t},utcParse:function(e){var t=Oe(e+="",true);t.toString=function(){return e};return t}}}var o={"-":"",_:" ",0:"0"},s=/^\s*\d+/,l=/^%/,u=/[\\^$*+?|[\]().{}]/g;function c(e,t,r){var a=e<0?"-":"",n=(a?-e:e)+"",i=n.length;return a+(i<r?new Array(r-i+1).join(t)+n:n)}function f(e){return e.replace(u,"\\$&")}function h(e){return new RegExp("^(?:"+e.map(f).join("|")+")","i")}function p(e){var t={},r=-1,a=e.length;while(++r<a)t[e[r].toLowerCase()]=r;return t}function v(e,t,r){var a=s.exec(t.slice(r,r+1));return a?(e.w=+a[0],r+a[0].length):-1}function d(e,t,r){var a=s.exec(t.slice(r,r+1));return a?(e.u=+a[0],r+a[0].length):-1}function m(e,t,r){var a=s.exec(t.slice(r,r+2));return a?(e.U=+a[0],r+a[0].length):-1}function g(e,t,r){var a=s.exec(t.slice(r,r+2));return a?(e.V=+a[0],r+a[0].length):-1}function y(e,t,r){var a=s.exec(t.slice(r,r+2));return a?(e.W=+a[0],r+a[0].length):-1}function x(e,t,r){var a=s.exec(t.slice(r,r+4));return a?(e.y=+a[0],r+a[0].length):-1}function b(e,t,r){var a=s.exec(t.slice(r,r+2));return a?(e.y=+a[0]+(+a[0]>68?1900:2e3),r+a[0].length):-1}function _(e,t,r){var a=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return a?(e.Z=a[1]?0:-(a[2]+(a[3]||"00")),r+a[0].length):-1}function w(e,t,r){var a=s.exec(t.slice(r,r+1));return a?(e.q=a[0]*3-3,r+a[0].length):-1}function T(e,t,r){var a=s.exec(t.slice(r,r+2));return a?(e.m=a[0]-1,r+a[0].length):-1}function k(e,t,r){var a=s.exec(t.slice(r,r+2));return a?(e.d=+a[0],r+a[0].length):-1}function M(e,t,r){var a=s.exec(t.slice(r,r+3));return a?(e.m=0,e.d=+a[0],r+a[0].length):-1}function A(e,t,r){var a=s.exec(t.slice(r,r+2));return a?(e.H=+a[0],r+a[0].length):-1}function S(e,t,r){var a=s.exec(t.slice(r,r+2));return a?(e.M=+a[0],r+a[0].length):-1}function E(e,t,r){var a=s.exec(t.slice(r,r+2));return a?(e.S=+a[0],r+a[0].length):-1}function L(e,t,r){var a=s.exec(t.slice(r,r+3));return a?(e.L=+a[0],r+a[0].length):-1}function C(e,t,r){var a=s.exec(t.slice(r,r+6));return a?(e.L=Math.floor(a[0]/1e3),r+a[0].length):-1}function I(e,t,r){var a=l.exec(t.slice(r,r+1));return a?r+a[0].length:-1}function P(e,t,r){var a=s.exec(t.slice(r));return a?(e.Q=+a[0],r+a[0].length):-1}function O(e,t,r){var a=s.exec(t.slice(r));return a?(e.s=+a[0],r+a[0].length):-1}function z(e,t){return c(e.getDate(),t,2)}function D(e,t){return c(e.getHours(),t,2)}function R(e,t){return c(e.getHours()%12||12,t,2)}function F(e,r){return c(1+t.timeDay.count(t.timeYear(e),e),r,3)}function B(e,t){return c(e.getMilliseconds(),t,3)}function N(e,t){return B(e,t)+"000"}function j(e,t){return c(e.getMonth()+1,t,2)}function U(e,t){return c(e.getMinutes(),t,2)}function V(e,t){return c(e.getSeconds(),t,2)}function H(e){var t=e.getDay();return t===0?7:t}function q(e,r){return c(t.timeSunday.count(t.timeYear(e)-1,e),r,2)}function G(e,r){var a=e.getDay();e=a>=4||a===0?t.timeThursday(e):t.timeThursday.ceil(e);return c(t.timeThursday.count(t.timeYear(e),e)+(t.timeYear(e).getDay()===4),r,2)}function Y(e){return e.getDay()}function W(e,r){return c(t.timeMonday.count(t.timeYear(e)-1,e),r,2)}function X(e,t){return c(e.getFullYear()%100,t,2)}function Z(e,t){return c(e.getFullYear()%1e4,t,4)}function J(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+c(t/60|0,"0",2)+c(t%60,"0",2)}function K(e,t){return c(e.getUTCDate(),t,2)}function Q(e,t){return c(e.getUTCHours(),t,2)}function $(e,t){return c(e.getUTCHours()%12||12,t,2)}function ee(e,r){return c(1+t.utcDay.count(t.utcYear(e),e),r,3)}function te(e,t){return c(e.getUTCMilliseconds(),t,3)}function re(e,t){return te(e,t)+"000"}function ae(e,t){return c(e.getUTCMonth()+1,t,2)}function ne(e,t){return c(e.getUTCMinutes(),t,2)}function ie(e,t){return c(e.getUTCSeconds(),t,2)}function oe(e){var t=e.getUTCDay();return t===0?7:t}function se(e,r){return c(t.utcSunday.count(t.utcYear(e)-1,e),r,2)}function le(e,r){var a=e.getUTCDay();e=a>=4||a===0?t.utcThursday(e):t.utcThursday.ceil(e);return c(t.utcThursday.count(t.utcYear(e),e)+(t.utcYear(e).getUTCDay()===4),r,2)}function ue(e){return e.getUTCDay()}function ce(e,r){return c(t.utcMonday.count(t.utcYear(e)-1,e),r,2)}function fe(e,t){return c(e.getUTCFullYear()%100,t,2)}function he(e,t){return c(e.getUTCFullYear()%1e4,t,4)}function pe(){return"+0000"}function ve(){return"%"}function de(e){return+e}function me(e){return Math.floor(+e/1e3)}var ge;ye({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function ye(t){ge=i(t);e.timeFormat=ge.format;e.timeParse=ge.parse;e.utcFormat=ge.utcFormat;e.utcParse=ge.utcParse;return ge}var xe="%Y-%m-%dT%H:%M:%S.%LZ";function be(e){return e.toISOString()}var _e=Date.prototype.toISOString?be:e.utcFormat(xe);function we(e){var t=new Date(e);return isNaN(t)?null:t}var Te=+new Date("2000-01-01T00:00:00.000Z")?we:e.utcParse(xe);e.isoFormat=_e;e.isoParse=Te;e.timeFormatDefaultLocale=ye;e.timeFormatLocale=i;Object.defineProperty(e,"__esModule",{value:true})}))},{"d3-time":173}],173:[function(t,r,a){(function(t,n){typeof a==="object"&&typeof r!=="undefined"?n(a):typeof e==="function"&&e.amd?e(["exports"],n):(t=t||self,n(t.d3=t.d3||{}))})(this,(function(e){"use strict";var t=new Date,r=new Date;function a(e,n,i,o){function s(t){return e(t=arguments.length===0?new Date:new Date(+t)),t}s.floor=function(t){return e(t=new Date(+t)),t};s.ceil=function(t){return e(t=new Date(t-1)),n(t,1),e(t),t};s.round=function(e){var t=s(e),r=s.ceil(e);return e-t<r-e?t:r};s.offset=function(e,t){return n(e=new Date(+e),t==null?1:Math.floor(t)),e};s.range=function(t,r,a){var i=[],o;t=s.ceil(t);a=a==null?1:Math.floor(a);if(!(t<r)||!(a>0))return i;do{i.push(o=new Date(+t)),n(t,a),e(t)}while(o<t&&t<r);return i};s.filter=function(t){return a((function(r){if(r>=r)while(e(r),!t(r))r.setTime(r-1)}),(function(e,r){if(e>=e){if(r<0)while(++r<=0){while(n(e,-1),!t(e)){}}else while(--r>=0){while(n(e,+1),!t(e)){}}}}))};if(i){s.count=function(a,n){t.setTime(+a),r.setTime(+n);e(t),e(r);return Math.floor(i(t,r))};s.every=function(e){e=Math.floor(e);return!isFinite(e)||!(e>0)?null:!(e>1)?s:s.filter(o?function(t){return o(t)%e===0}:function(t){return s.count(0,t)%e===0})}}return s}var n=a((function(){}),(function(e,t){e.setTime(+e+t)}),(function(e,t){return t-e}));n.every=function(e){e=Math.floor(e);if(!isFinite(e)||!(e>0))return null;if(!(e>1))return n;return a((function(t){t.setTime(Math.floor(t/e)*e)}),(function(t,r){t.setTime(+t+r*e)}),(function(t,r){return(r-t)/e}))};var i=n.range;var o=1e3;var s=6e4;var l=36e5;var u=864e5;var c=6048e5;var f=a((function(e){e.setTime(e-e.getMilliseconds())}),(function(e,t){e.setTime(+e+t*o)}),(function(e,t){return(t-e)/o}),(function(e){return e.getUTCSeconds()}));var h=f.range;var p=a((function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*o)}),(function(e,t){e.setTime(+e+t*s)}),(function(e,t){return(t-e)/s}),(function(e){return e.getMinutes()}));var v=p.range;var d=a((function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*o-e.getMinutes()*s)}),(function(e,t){e.setTime(+e+t*l)}),(function(e,t){return(t-e)/l}),(function(e){return e.getHours()}));var m=d.range;var g=a((function(e){e.setHours(0,0,0,0)}),(function(e,t){e.setDate(e.getDate()+t)}),(function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*s)/u}),(function(e){return e.getDate()-1}));var y=g.range;function x(e){return a((function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7);t.setHours(0,0,0,0)}),(function(e,t){e.setDate(e.getDate()+t*7)}),(function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*s)/c}))}var b=x(0);var _=x(1);var w=x(2);var T=x(3);var k=x(4);var M=x(5);var A=x(6);var S=b.range;var E=_.range;var L=w.range;var C=T.range;var I=k.range;var P=M.range;var O=A.range;var z=a((function(e){e.setDate(1);e.setHours(0,0,0,0)}),(function(e,t){e.setMonth(e.getMonth()+t)}),(function(e,t){return t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12}),(function(e){return e.getMonth()}));var D=z.range;var R=a((function(e){e.setMonth(0,1);e.setHours(0,0,0,0)}),(function(e,t){e.setFullYear(e.getFullYear()+t)}),(function(e,t){return t.getFullYear()-e.getFullYear()}),(function(e){return e.getFullYear()}));R.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:a((function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e);t.setMonth(0,1);t.setHours(0,0,0,0)}),(function(t,r){t.setFullYear(t.getFullYear()+r*e)}))};var F=R.range;var B=a((function(e){e.setUTCSeconds(0,0)}),(function(e,t){e.setTime(+e+t*s)}),(function(e,t){return(t-e)/s}),(function(e){return e.getUTCMinutes()}));var N=B.range;var j=a((function(e){e.setUTCMinutes(0,0,0)}),(function(e,t){e.setTime(+e+t*l)}),(function(e,t){return(t-e)/l}),(function(e){return e.getUTCHours()}));var U=j.range;var V=a((function(e){e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCDate(e.getUTCDate()+t)}),(function(e,t){return(t-e)/u}),(function(e){return e.getUTCDate()-1}));var H=V.range;function q(e){return a((function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7);t.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCDate(e.getUTCDate()+t*7)}),(function(e,t){return(t-e)/c}))}var G=q(0);var Y=q(1);var W=q(2);var X=q(3);var Z=q(4);var J=q(5);var K=q(6);var Q=G.range;var $=Y.range;var ee=W.range;var te=X.range;var re=Z.range;var ae=J.range;var ne=K.range;var ie=a((function(e){e.setUTCDate(1);e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCMonth(e.getUTCMonth()+t)}),(function(e,t){return t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12}),(function(e){return e.getUTCMonth()}));var oe=ie.range;var se=a((function(e){e.setUTCMonth(0,1);e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)}),(function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()}),(function(e){return e.getUTCFullYear()}));se.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:a((function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e);t.setUTCMonth(0,1);t.setUTCHours(0,0,0,0)}),(function(t,r){t.setUTCFullYear(t.getUTCFullYear()+r*e)}))};var le=se.range;e.timeDay=g;e.timeDays=y;e.timeFriday=M;e.timeFridays=P;e.timeHour=d;e.timeHours=m;e.timeInterval=a;e.timeMillisecond=n;e.timeMilliseconds=i;e.timeMinute=p;e.timeMinutes=v;e.timeMonday=_;e.timeMondays=E;e.timeMonth=z;e.timeMonths=D;e.timeSaturday=A;e.timeSaturdays=O;e.timeSecond=f;e.timeSeconds=h;e.timeSunday=b;e.timeSundays=S;e.timeThursday=k;e.timeThursdays=I;e.timeTuesday=w;e.timeTuesdays=L;e.timeWednesday=T;e.timeWednesdays=C;e.timeWeek=b;e.timeWeeks=S;e.timeYear=R;e.timeYears=F;e.utcDay=V;e.utcDays=H;e.utcFriday=J;e.utcFridays=ae;e.utcHour=j;e.utcHours=U;e.utcMillisecond=n;e.utcMilliseconds=i;e.utcMinute=B;e.utcMinutes=N;e.utcMonday=Y;e.utcMondays=$;e.utcMonth=ie;e.utcMonths=oe;e.utcSaturday=K;e.utcSaturdays=ne;e.utcSecond=f;e.utcSeconds=h;e.utcSunday=G;e.utcSundays=Q;e.utcThursday=Z;e.utcThursdays=re;e.utcTuesday=W;e.utcTuesdays=ee;e.utcWednesday=X;e.utcWednesdays=te;e.utcWeek=G;e.utcWeeks=Q;e.utcYear=se;e.utcYears=le;Object.defineProperty(e,"__esModule",{value:true})}))},{}],174:[function(e,t,r){arguments[4][173][0].apply(r,arguments)},{dup:173}],175:[function(t,r,a){(function(t,n){typeof a==="object"&&typeof r!=="undefined"?n(a):typeof e==="function"&&e.amd?e(["exports"],n):(t=t||self,n(t.d3=t.d3||{}))})(this,(function(e){"use strict";var t=0,r=0,a=0,n=1e3,i,o,s=0,l=0,u=0,c=typeof performance==="object"&&performance.now?performance:Date,f=typeof window==="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function h(){return l||(f(p),l=c.now()+u)}function p(){l=0}function v(){this._call=this._time=this._next=null}v.prototype=d.prototype={constructor:v,restart:function(e,t,r){if(typeof e!=="function")throw new TypeError("callback is not a function");r=(r==null?h():+r)+(t==null?0:+t);if(!this._next&&o!==this){if(o)o._next=this;else i=this;o=this}this._call=e;this._time=r;b()},stop:function(){if(this._call){this._call=null;this._time=Infinity;b()}}};function d(e,t,r){var a=new v;a.restart(e,t,r);return a}function m(){h();++t;var e=i,r;while(e){if((r=l-e._time)>=0)e._call.call(null,r);e=e._next}--t}function g(){l=(s=c.now())+u;t=r=0;try{m()}finally{t=0;x();l=0}}function y(){var e=c.now(),t=e-s;if(t>n)u-=t,s=e}function x(){var e,t=i,r,a=Infinity;while(t){if(t._call){if(a>t._time)a=t._time;e=t,t=t._next}else{r=t._next,t._next=null;t=e?e._next=r:i=r}}o=e;b(a)}function b(e){if(t)return;if(r)r=clearTimeout(r);var i=e-l;if(i>24){if(e<Infinity)r=setTimeout(g,e-c.now()-u);if(a)a=clearInterval(a)}else{if(!a)s=c.now(),a=setInterval(y,n);t=1,f(g)}}function _(e,t,r){var a=new v;t=t==null?0:+t;a.restart((function(r){a.stop();e(r+t)}),t,r);return a}function w(e,t,r){var a=new v,n=t;if(t==null)return a.restart(e,t,r),a;t=+t,r=r==null?h():+r;a.restart((function i(o){o+=n;a.restart(i,n+=t,r);e(o)}),t,r);return a}e.interval=w;e.now=h;e.timeout=_;e.timer=d;e.timerFlush=m;Object.defineProperty(e,"__esModule",{value:true})}))},{}],176:[function(e,t,r){t.exports=function(){for(var e=0;e<arguments.length;e++){if(arguments[e]!==undefined)return arguments[e]}}},{}],177:[function(e,t,r){"use strict";var a=e("incremental-convex-hull");var n=e("uniq");t.exports=l;function i(e,t){this.point=e;this.index=t}function o(e,t){var r=e.point;var a=t.point;var n=r.length;for(var i=0;i<n;++i){var o=a[i]-r[i];if(o){return o}}return 0}function s(e,t,r){if(e===1){if(r){return[[-1,0]]}else{return[]}}var a=t.map((function(e,t){return[e[0],t]}));a.sort((function(e,t){return e[0]-t[0]}));var n=new Array(e-1);for(var i=1;i<e;++i){var o=a[i-1];var s=a[i];n[i-1]=[o[1],s[1]]}if(r){n.push([-1,n[0][1]],[n[e-1][1],-1])}return n}function l(e,t){var r=e.length;if(r===0){return[]}var l=e[0].length;if(l<1){return[]}if(l===1){return s(r,e,t)}var u=new Array(r);var c=1;for(var f=0;f<r;++f){var h=e[f];var p=new Array(l+1);var v=0;for(var d=0;d<l;++d){var m=h[d];p[d]=m;v+=m*m}p[l]=v;u[f]=new i(p,f);c=Math.max(v,c)}n(u,o);r=u.length;var g=new Array(r+l+1);var y=new Array(r+l+1);var x=(l+1)*(l+1)*c;var b=new Array(l+1);for(var f=0;f<=l;++f){b[f]=0}b[l]=x;g[0]=b.slice();y[0]=-1;for(var f=0;f<=l;++f){var p=b.slice();p[f]=1;g[f+1]=p;y[f+1]=-1}for(var f=0;f<r;++f){var _=u[f];g[f+l+1]=_.point;y[f+l+1]=_.index}var w=a(g,false);if(t){w=w.filter((function(e){var t=0;for(var r=0;r<=l;++r){var a=y[e[r]];if(a<0){if(++t>=2){return false}}e[r]=a}return true}))}else{w=w.filter((function(e){for(var t=0;t<=l;++t){var r=y[e[t]];if(r<0){return false}e[t]=r}return true}))}if(l&1){for(var f=0;f<w.length;++f){var _=w[f];var p=_[0];_[0]=_[1];_[1]=p}}return w}},{"incremental-convex-hull":438,uniq:603}],178:[function(e,t,r){"use strict";t.exports=o;var a=o.canvas=document.createElement("canvas");var n=a.getContext("2d");var i=s([32,126]);o.createPairs=s;o.ascii=i;function o(e,t){if(Array.isArray(e))e=e.join(", ");var r={},a,o=16,l=.05;if(t){if(t.length===2&&typeof t[0]==="number"){a=s(t)}else if(Array.isArray(t)){a=t}else{if(t.o)a=s(t.o);else if(t.pairs)a=t.pairs;if(t.fontSize)o=t.fontSize;if(t.threshold!=null)l=t.threshold}}if(!a)a=i;n.font=o+"px "+e;for(var u=0;u<a.length;u++){var c=a[u];var f=n.measureText(c[0]).width+n.measureText(c[1]).width;var h=n.measureText(c).width;if(Math.abs(f-h)>o*l){var p=(h-f)/o;r[c]=p*1e3}}return r}function s(e){var t=[];for(var r=e[0];r<=e[1];r++){var a=String.fromCharCode(r);for(var n=e[0];n<e[1];n++){var i=String.fromCharCode(n);var o=a+i;t.push(o)}}return t}},{}],179:[function(e,t,r){(function(e){(function(){var r=false;if(typeof Float64Array!=="undefined"){var a=new Float64Array(1),n=new Uint32Array(a.buffer);a[0]=1;r=true;if(n[1]===1072693248){t.exports=function e(t){a[0]=t;return[n[0],n[1]]};function i(e,t){n[0]=e;n[1]=t;return a[0]}t.exports.pack=i;function o(e){a[0]=e;return n[0]}t.exports.lo=o;function s(e){a[0]=e;return n[1]}t.exports.hi=s}else if(n[0]===1072693248){t.exports=function e(t){a[0]=t;return[n[1],n[0]]};function l(e,t){n[1]=e;n[0]=t;return a[0]}t.exports.pack=l;function u(e){a[0]=e;return n[1]}t.exports.lo=u;function c(e){a[0]=e;return n[0]}t.exports.hi=c}else{r=false}}if(!r){var f=new e(8);t.exports=function e(t){f.writeDoubleLE(t,0,true);return[f.readUInt32LE(0,true),f.readUInt32LE(4,true)]};function h(e,t){f.writeUInt32LE(e,0,true);f.writeUInt32LE(t,4,true);return f.readDoubleLE(0,true)}t.exports.pack=h;function p(e){f.writeDoubleLE(e,0,true);return f.readUInt32LE(0,true)}t.exports.lo=p;function v(e){f.writeDoubleLE(e,0,true);return f.readUInt32LE(4,true)}t.exports.hi=v}t.exports.sign=function(e){return t.exports.hi(e)>>>31};t.exports.exponent=function(e){var r=t.exports.hi(e);return(r<<1>>>21)-1023};t.exports.fraction=function(e){var r=t.exports.lo(e);var a=t.exports.hi(e);var n=a&(1<<20)-1;if(a&2146435072){n+=1<<20}return[r,n]};t.exports.denormalized=function(e){var r=t.exports.hi(e);return!(r&2146435072)}}).call(this)}).call(this,e("buffer").Buffer)},{buffer:117}],180:[function(e,t,r){var a=e("abs-svg-path");var n=e("normalize-svg-path");var i={M:"moveTo",C:"bezierCurveTo"};t.exports=function(e,t){e.beginPath();n(a(t)).forEach((function(t){var r=t[0];var a=t.slice(1);e[i[r]].apply(e,a)}));e.closePath()}},{"abs-svg-path":71,"normalize-svg-path":474}],181:[function(e,t,r){t.exports=function(e){switch(e){case"int8":return Int8Array;case"int16":return Int16Array;case"int32":return Int32Array;case"uint8":return Uint8Array;case"uint16":return Uint16Array;case"uint32":return Uint32Array;case"float32":return Float32Array;case"float64":return Float64Array;case"array":return Array;case"uint8_clamped":return Uint8ClampedArray}}},{}],182:[function(e,t,r){"use strict";function a(e,t,r){var n=e[r]|0;if(n<=0){return[]}var i=new Array(n),o;if(r===e.length-1){for(o=0;o<n;++o){i[o]=t}}else{for(o=0;o<n;++o){i[o]=a(e,t,r+1)}}return i}function n(e,t){var r,a;r=new Array(e);for(a=0;a<e;++a){r[a]=t}return r}function i(e,t){if(typeof t==="undefined"){t=0}switch(typeof e){case"number":if(e>0){return n(e|0,t)}break;case"object":if(typeof e.length==="number"){return a(e,t,0)}break}return[]}t.exports=i},{}],183:[function(e,t,r){"use strict";t.exports=a;t.exports.default=a;function a(e,t,r){r=r||2;var a=t&&t.length,i=a?t[0]*r:e.length,s=n(e,0,i,r,true),l=[];if(!s||s.next===s.prev)return l;var u,c,h,p,v,d,m;if(a)s=f(e,t,s,r);if(e.length>80*r){u=h=e[0];c=p=e[1];for(var g=r;g<i;g+=r){v=e[g];d=e[g+1];if(v<u)u=v;if(d<c)c=d;if(v>h)h=v;if(d>p)p=d}m=Math.max(h-u,p-c);m=m!==0?1/m:0}o(s,l,r,u,c,m);return l}function n(e,t,r,a,n){var i,o;if(n===z(e,t,r,a)>0){for(i=t;i<r;i+=a)o=I(i,e[i],e[i+1],o)}else{for(i=r-a;i>=t;i-=a)o=I(i,e[i],e[i+1],o)}if(o&&T(o,o.next)){P(o);o=o.next}return o}function i(e,t){if(!e)return e;if(!t)t=e;var r=e,a;do{a=false;if(!r.steiner&&(T(r,r.next)||w(r.prev,r,r.next)===0)){P(r);r=t=r.prev;if(r===r.next)break;a=true}else{r=r.next}}while(a||r!==t);return t}function o(e,t,r,a,n,f,h){if(!e)return;if(!h&&f)m(e,a,n,f);var p=e,v,d;while(e.prev!==e.next){v=e.prev;d=e.next;if(f?l(e,a,n,f):s(e)){t.push(v.i/r);t.push(e.i/r);t.push(d.i/r);P(e);e=d.next;p=d.next;continue}e=d;if(e===p){if(!h){o(i(e),t,r,a,n,f,1)}else if(h===1){e=u(i(e),t,r);o(e,t,r,a,n,f,2)}else if(h===2){c(e,t,r,a,n,f)}break}}}function s(e){var t=e.prev,r=e,a=e.next;if(w(t,r,a)>=0)return false;var n=e.next.next;while(n!==e.prev){if(b(t.x,t.y,r.x,r.y,a.x,a.y,n.x,n.y)&&w(n.prev,n,n.next)>=0)return false;n=n.next}return true}function l(e,t,r,a){var n=e.prev,i=e,o=e.next;if(w(n,i,o)>=0)return false;var s=n.x<i.x?n.x<o.x?n.x:o.x:i.x<o.x?i.x:o.x,l=n.y<i.y?n.y<o.y?n.y:o.y:i.y<o.y?i.y:o.y,u=n.x>i.x?n.x>o.x?n.x:o.x:i.x>o.x?i.x:o.x,c=n.y>i.y?n.y>o.y?n.y:o.y:i.y>o.y?i.y:o.y;var f=y(s,l,t,r,a),h=y(u,c,t,r,a);var p=e.prevZ,v=e.nextZ;while(p&&p.z>=f&&v&&v.z<=h){if(p!==e.prev&&p!==e.next&&b(n.x,n.y,i.x,i.y,o.x,o.y,p.x,p.y)&&w(p.prev,p,p.next)>=0)return false;p=p.prevZ;if(v!==e.prev&&v!==e.next&&b(n.x,n.y,i.x,i.y,o.x,o.y,v.x,v.y)&&w(v.prev,v,v.next)>=0)return false;v=v.nextZ}while(p&&p.z>=f){if(p!==e.prev&&p!==e.next&&b(n.x,n.y,i.x,i.y,o.x,o.y,p.x,p.y)&&w(p.prev,p,p.next)>=0)return false;p=p.prevZ}while(v&&v.z<=h){if(v!==e.prev&&v!==e.next&&b(n.x,n.y,i.x,i.y,o.x,o.y,v.x,v.y)&&w(v.prev,v,v.next)>=0)return false;v=v.nextZ}return true}function u(e,t,r){var a=e;do{var n=a.prev,o=a.next.next;if(!T(n,o)&&k(n,a,a.next,o)&&E(n,o)&&E(o,n)){t.push(n.i/r);t.push(a.i/r);t.push(o.i/r);P(a);P(a.next);a=e=o}a=a.next}while(a!==e);return i(a)}function c(e,t,r,a,n,s){var l=e;do{var u=l.next.next;while(u!==l.prev){if(l.i!==u.i&&_(l,u)){var c=C(l,u);l=i(l,l.next);c=i(c,c.next);o(l,t,r,a,n,s);o(c,t,r,a,n,s);return}u=u.next}l=l.next}while(l!==e)}function f(e,t,r,a){var o=[],s,l,u,c,f;for(s=0,l=t.length;s<l;s++){u=t[s]*a;c=s<l-1?t[s+1]*a:e.length;f=n(e,u,c,a,false);if(f===f.next)f.steiner=true;o.push(x(f))}o.sort(h);for(s=0;s<o.length;s++){p(o[s],r);r=i(r,r.next)}return r}function h(e,t){return e.x-t.x}function p(e,t){t=v(e,t);if(t){var r=C(t,e);i(t,t.next);i(r,r.next)}}function v(e,t){var r=t,a=e.x,n=e.y,i=-Infinity,o;do{if(n<=r.y&&n>=r.next.y&&r.next.y!==r.y){var s=r.x+(n-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=a&&s>i){i=s;if(s===a){if(n===r.y)return r;if(n===r.next.y)return r.next}o=r.x<r.next.x?r:r.next}}r=r.next}while(r!==t);if(!o)return null;if(a===i)return o;var l=o,u=o.x,c=o.y,f=Infinity,h;r=o;do{if(a>=r.x&&r.x>=u&&a!==r.x&&b(n<c?a:i,n,u,c,n<c?i:a,n,r.x,r.y)){h=Math.abs(n-r.y)/(a-r.x);if(E(r,e)&&(h<f||h===f&&(r.x>o.x||r.x===o.x&&d(o,r)))){o=r;f=h}}r=r.next}while(r!==l);return o}function d(e,t){return w(e.prev,e,t.prev)<0&&w(t.next,e,e.next)<0}function m(e,t,r,a){var n=e;do{if(n.z===null)n.z=y(n.x,n.y,t,r,a);n.prevZ=n.prev;n.nextZ=n.next;n=n.next}while(n!==e);n.prevZ.nextZ=null;n.prevZ=null;g(n)}function g(e){var t,r,a,n,i,o,s,l,u=1;do{r=e;e=null;i=null;o=0;while(r){o++;a=r;s=0;for(t=0;t<u;t++){s++;a=a.nextZ;if(!a)break}l=u;while(s>0||l>0&&a){if(s!==0&&(l===0||!a||r.z<=a.z)){n=r;r=r.nextZ;s--}else{n=a;a=a.nextZ;l--}if(i)i.nextZ=n;else e=n;n.prevZ=i;i=n}r=a}i.nextZ=null;u*=2}while(o>1);return e}function y(e,t,r,a,n){e=32767*(e-r)*n;t=32767*(t-a)*n;e=(e|e<<8)&16711935;e=(e|e<<4)&252645135;e=(e|e<<2)&858993459;e=(e|e<<1)&1431655765;t=(t|t<<8)&16711935;t=(t|t<<4)&252645135;t=(t|t<<2)&858993459;t=(t|t<<1)&1431655765;return e|t<<1}function x(e){var t=e,r=e;do{if(t.x<r.x||t.x===r.x&&t.y<r.y)r=t;t=t.next}while(t!==e);return r}function b(e,t,r,a,n,i,o,s){return(n-o)*(t-s)-(e-o)*(i-s)>=0&&(e-o)*(a-s)-(r-o)*(t-s)>=0&&(r-o)*(i-s)-(n-o)*(a-s)>=0}function _(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!S(e,t)&&(E(e,t)&&E(t,e)&&L(e,t)&&(w(e.prev,e,t.prev)||w(e,t.prev,t))||T(e,t)&&w(e.prev,e,e.next)>0&&w(t.prev,t,t.next)>0)}function w(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function T(e,t){return e.x===t.x&&e.y===t.y}function k(e,t,r,a){var n=A(w(e,t,r));var i=A(w(e,t,a));var o=A(w(r,a,e));var s=A(w(r,a,t));if(n!==i&&o!==s)return true;if(n===0&&M(e,r,t))return true;if(i===0&&M(e,a,t))return true;if(o===0&&M(r,e,a))return true;if(s===0&&M(r,t,a))return true;return false}function M(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function A(e){return e>0?1:e<0?-1:0}function S(e,t){var r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&k(r,r.next,e,t))return true;r=r.next}while(r!==e);return false}function E(e,t){return w(e.prev,e,e.next)<0?w(e,t,e.next)>=0&&w(e,e.prev,t)>=0:w(e,t,e.prev)<0||w(e,e.next,t)<0}function L(e,t){var r=e,a=false,n=(e.x+t.x)/2,i=(e.y+t.y)/2;do{if(r.y>i!==r.next.y>i&&r.next.y!==r.y&&n<(r.next.x-r.x)*(i-r.y)/(r.next.y-r.y)+r.x)a=!a;r=r.next}while(r!==e);return a}function C(e,t){var r=new O(e.i,e.x,e.y),a=new O(t.i,t.x,t.y),n=e.next,i=t.prev;e.next=t;t.prev=e;r.next=n;n.prev=r;a.next=r;r.prev=a;i.next=a;a.prev=i;return a}function I(e,t,r,a){var n=new O(e,t,r);if(!a){n.prev=n;n.next=n}else{n.next=a.next;n.prev=a;a.next.prev=n;a.next=n}return n}function P(e){e.next.prev=e.prev;e.prev.next=e.next;if(e.prevZ)e.prevZ.nextZ=e.nextZ;if(e.nextZ)e.nextZ.prevZ=e.prevZ}function O(e,t,r){this.i=e;this.x=t;this.y=r;this.prev=null;this.next=null;this.z=null;this.prevZ=null;this.nextZ=null;this.steiner=false}a.deviation=function(e,t,r,a){var n=t&&t.length;var i=n?t[0]*r:e.length;var o=Math.abs(z(e,0,i,r));if(n){for(var s=0,l=t.length;s<l;s++){var u=t[s]*r;var c=s<l-1?t[s+1]*r:e.length;o-=Math.abs(z(e,u,c,r))}}var f=0;for(s=0;s<a.length;s+=3){var h=a[s]*r;var p=a[s+1]*r;var v=a[s+2]*r;f+=Math.abs((e[h]-e[v])*(e[p+1]-e[h+1])-(e[h]-e[p])*(e[v+1]-e[h+1]))}return o===0&&f===0?0:Math.abs((f-o)/o)};function z(e,t,r,a){var n=0;for(var i=t,o=r-a;i<r;i+=a){n+=(e[o]-e[i])*(e[i+1]+e[o+1]);o=i}return n}a.flatten=function(e){var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},a=0;for(var n=0;n<e.length;n++){for(var i=0;i<e[n].length;i++){for(var o=0;o<t;o++)r.vertices.push(e[n][i][o])}if(n>0){a+=e[n-1].length;r.holes.push(a)}}return r}},{}],184:[function(e,t,r){"use strict";t.exports=n;var a=e("uniq");function n(e,t){var r=e.length;if(typeof t!=="number"){t=0;for(var n=0;n<r;++n){var i=e[n];t=Math.max(t,i[0],i[1])}t=(t|0)+1}t=t|0;var o=new Array(t);for(var n=0;n<t;++n){o[n]=[]}for(var n=0;n<r;++n){var i=e[n];o[i[0]].push(i[1]);o[i[1]].push(i[0])}for(var s=0;s<t;++s){a(o[s],(function(e,t){return e-t}))}return o}},{uniq:603}],185:[function(e,t,r){var a=e("strongly-connected-components");t.exports=function e(t,r){var n=[];var i=[];var o=[];var s={};var l=[];var u;function c(e){o[e]=false;if(s.hasOwnProperty(e)){Object.keys(s[e]).forEach((function(t){delete s[e][t];if(o[t]){c(t)}}))}}function f(e){var t=false;i.push(e);o[e]=true;var r;var a;for(r=0;r<l[e].length;r++){a=l[e][r];if(a===u){h(u,i);t=true}else if(!o[a]){t=f(a)}}if(t){c(e)}else{for(r=0;r<l[e].length;r++){a=l[e][r];var n=s[a];if(!n){n={};s[a]=n}n[a]=true}}i.pop();return t}function h(e,t){var a=[].concat(t).concat(e);if(r){r(f)}else{n.push(a)}}function p(e){for(var r=0;r<t.length;r++){if(r<e)t[r]=[];t[r]=t[r].filter((function(t){return t>=e}))}}function v(e){p(e);var r=t;var n=a(r);var i=n.components.filter((function(e){return e.length>1}));var o=Infinity;var s;for(var l=0;l<i.length;l++){for(var u=0;u<i[l].length;u++){if(i[l][u]<o){o=i[l][u];s=l}}}var c=i[s];if(!c)return false;var f=t.map((function(e,t){if(c.indexOf(t)===-1)return[];return e.filter((function(e){return c.indexOf(e)!==-1}))}));return{leastVertex:o,adjList:f}}u=0;var d=t.length;while(u<d){var m=v(u);u=m.leastVertex;l=m.adjList;if(l){for(var g=0;g<l.length;g++){for(var y=0;y<l[g].length;y++){var x=l[g][y];o[+x]=false;s[x]={}}}f(u);u=u+1}else{u=d}}if(r){return}else{return n}}},{"strongly-connected-components":575}],186:[function(e,t,r){"use strict";var a=e("../../object/valid-value");t.exports=function(){a(this).length=0;return this}},{"../../object/valid-value":217}],187:[function(e,t,r){"use strict";t.exports=e("./is-implemented")()?Array.from:e("./shim")},{"./is-implemented":188,"./shim":189}],188:[function(e,t,r){"use strict";t.exports=function(){var e=Array.from,t,r;if(typeof e!=="function")return false;t=["raz","dwa"];r=e(t);return Boolean(r&&r!==t&&r[1]==="dwa")}},{}],189:[function(e,t,r){"use strict";var a=e("es6-symbol").iterator,n=e("../../function/is-arguments"),i=e("../../function/is-function"),o=e("../../number/to-pos-integer"),s=e("../../object/valid-callable"),l=e("../../object/valid-value"),u=e("../../object/is-value"),c=e("../../string/is-string"),f=Array.isArray,h=Function.prototype.call,p={configurable:true,enumerable:true,writable:true,value:null},v=Object.defineProperty;t.exports=function(e){var t=arguments[1],r=arguments[2],d,m,g,y,x,b,_,w,T,k;e=Object(l(e));if(u(t))s(t);if(!this||this===Array||!i(this)){if(!t){if(n(e)){x=e.length;if(x!==1)return Array.apply(null,e);y=new Array(1);y[0]=e[0];return y}if(f(e)){y=new Array(x=e.length);for(m=0;m<x;++m)y[m]=e[m];return y}}y=[]}else{d=this}if(!f(e)){if((T=e[a])!==undefined){_=s(T).call(e);if(d)y=new d;w=_.next();m=0;while(!w.done){k=t?h.call(t,r,w.value,m):w.value;if(d){p.value=k;v(y,m,p)}else{y[m]=k}w=_.next();++m}x=m}else if(c(e)){x=e.length;if(d)y=new d;for(m=0,g=0;m<x;++m){k=e[m];if(m+1<x){b=k.charCodeAt(0);if(b>=55296&&b<=56319)k+=e[++m]}k=t?h.call(t,r,k,g):k;if(d){p.value=k;v(y,g,p)}else{y[g]=k}++g}x=g}}if(x===undefined){x=o(e.length);if(d)y=new d(x);for(m=0;m<x;++m){k=t?h.call(t,r,e[m],m):e[m];if(d){p.value=k;v(y,m,p)}else{y[m]=k}}}if(d){p.value=null;y.length=x}return y}},{"../../function/is-arguments":190,"../../function/is-function":191,"../../number/to-pos-integer":197,"../../object/is-value":206,"../../object/valid-callable":215,"../../object/valid-value":217,"../../string/is-string":221,"es6-symbol":230}],190:[function(e,t,r){"use strict";var a=Object.prototype.toString,n=a.call(function(){return arguments}());t.exports=function(e){return a.call(e)===n}},{}],191:[function(e,t,r){"use strict";var a=Object.prototype.toString,n=RegExp.prototype.test.bind(/^[object [A-Za-z0-9]*Function]$/);t.exports=function(e){return typeof e==="function"&&n(a.call(e))}},{}],192:[function(e,t,r){"use strict";t.exports=function(){}},{}],193:[function(e,t,r){"use strict";t.exports=e("./is-implemented")()?Math.sign:e("./shim")},{"./is-implemented":194,"./shim":195}],194:[function(e,t,r){"use strict";t.exports=function(){var e=Math.sign;if(typeof e!=="function")return false;return e(10)===1&&e(-20)===-1}},{}],195:[function(e,t,r){"use strict";t.exports=function(e){e=Number(e);if(isNaN(e)||e===0)return e;return e>0?1:-1}},{}],196:[function(e,t,r){"use strict";var a=e("../math/sign"),n=Math.abs,i=Math.floor;t.exports=function(e){if(isNaN(e))return 0;e=Number(e);if(e===0||!isFinite(e))return e;return a(e)*i(n(e))}},{"../math/sign":193}],197:[function(e,t,r){"use strict";var a=e("./to-integer"),n=Math.max;t.exports=function(e){return n(0,a(e))}},{"./to-integer":196}],198:[function(e,t,r){"use strict";var a=e("./valid-callable"),n=e("./valid-value"),i=Function.prototype.bind,o=Function.prototype.call,s=Object.keys,l=Object.prototype.propertyIsEnumerable;t.exports=function(e,t){return function(r,u){var c,f=arguments[2],h=arguments[3];r=Object(n(r));a(u);c=s(r);if(h){c.sort(typeof h==="function"?i.call(h,r):undefined)}if(typeof e!=="function")e=c[e];return o.call(e,c,(function(e,a){if(!l.call(r,e))return t;return o.call(u,f,r[e],e,r,a)}))}}},{"./valid-callable":215,"./valid-value":217}],199:[function(e,t,r){"use strict";t.exports=e("./is-implemented")()?Object.assign:e("./shim")},{"./is-implemented":200,"./shim":201}],200:[function(e,t,r){"use strict";t.exports=function(){var e=Object.assign,t;if(typeof e!=="function")return false;t={foo:"raz"};e(t,{bar:"dwa"},{trzy:"trzy"});return t.foo+t.bar+t.trzy==="razdwatrzy"}},{}],201:[function(e,t,r){"use strict";var a=e("../keys"),n=e("../valid-value"),i=Math.max;t.exports=function(e,t){var r,o,s=i(arguments.length,2),l;e=Object(n(e));l=function(a){try{e[a]=t[a]}catch(n){if(!r)r=n}};for(o=1;o<s;++o){t=arguments[o];a(t).forEach(l)}if(r!==undefined)throw r;return e}},{"../keys":207,"../valid-value":217}],202:[function(e,t,r){"use strict";var a=e("../array/from"),n=e("./assign"),i=e("./valid-value");t.exports=function(e){var t=Object(i(e)),r=arguments[1],o=Object(arguments[2]);if(t!==e&&!r)return t;var s={};if(r){a(r,(function(t){if(o.ensure||t in e)s[t]=e[t]}))}else{n(s,e)}return s}},{"../array/from":187,"./assign":199,"./valid-value":217}],203:[function(e,t,r){"use strict";var a=Object.create,n;if(!e("./set-prototype-of/is-implemented")()){n=e("./set-prototype-of/shim")}t.exports=function(){var e,t,r;if(!n)return a;if(n.level!==1)return a;e={};t={};r={configurable:false,enumerable:false,writable:true,value:undefined};Object.getOwnPropertyNames(Object.prototype).forEach((function(e){if(e==="__proto__"){t[e]={configurable:true,enumerable:false,writable:true,value:undefined};return}t[e]=r}));Object.defineProperties(e,t);Object.defineProperty(n,"nullPolyfill",{configurable:false,enumerable:false,writable:false,value:e});return function(t,r){return a(t===null?e:t,r)}}()},{"./set-prototype-of/is-implemented":213,"./set-prototype-of/shim":214}],204:[function(e,t,r){"use strict";t.exports=e("./_iterate")("forEach")},{"./_iterate":198}],205:[function(e,t,r){"use strict";var a=e("./is-value");var n={function:true,object:true};t.exports=function(e){return a(e)&&n[typeof e]||false}},{"./is-value":206}],206:[function(e,t,r){"use strict";var a=e("../function/noop")();t.exports=function(e){return e!==a&&e!==null}},{"../function/noop":192}],207:[function(e,t,r){"use strict";t.exports=e("./is-implemented")()?Object.keys:e("./shim")},{"./is-implemented":208,"./shim":209}],208:[function(e,t,r){"use strict";t.exports=function(){try{Object.keys("primitive");return true}catch(e){return false}}},{}],209:[function(e,t,r){"use strict";var a=e("../is-value");var n=Object.keys;t.exports=function(e){return n(a(e)?Object(e):e)}},{"../is-value":206}],210:[function(e,t,r){"use strict";var a=e("./valid-callable"),n=e("./for-each"),i=Function.prototype.call;t.exports=function(e,t){var r={},o=arguments[2];a(t);n(e,(function(e,a,n,s){r[a]=i.call(t,o,e,a,n,s)}));return r}},{"./for-each":204,"./valid-callable":215}],211:[function(e,t,r){"use strict";var a=e("./is-value");var n=Array.prototype.forEach,i=Object.create;var o=function(e,t){var r;for(r in e)t[r]=e[r]};t.exports=function(e){var t=i(null);n.call(arguments,(function(e){if(!a(e))return;o(Object(e),t)}));return t}},{"./is-value":206}],212:[function(e,t,r){"use strict";t.exports=e("./is-implemented")()?Object.setPrototypeOf:e("./shim")},{"./is-implemented":213,"./shim":214}],213:[function(e,t,r){"use strict";var a=Object.create,n=Object.getPrototypeOf,i={};t.exports=function(){var e=Object.setPrototypeOf,t=arguments[0]||a;if(typeof e!=="function")return false;return n(e(t(null),i))===i}},{}],214:[function(e,t,r){"use strict";var a=e("../is-object"),n=e("../valid-value"),i=Object.prototype.isPrototypeOf,o=Object.defineProperty,s={configurable:true,enumerable:false,writable:true,value:undefined},l;l=function(e,t){n(e);if(t===null||a(t))return e;throw new TypeError("Prototype must be null or an object")};t.exports=function(e){var t,r;if(!e)return null;if(e.level===2){if(e.set){r=e.set;t=function(e,t){r.call(l(e,t),t);return e}}else{t=function(e,t){l(e,t).__proto__=t;return e}}}else{t=function e(t,r){var a;l(t,r);a=i.call(e.nullPolyfill,t);if(a)delete e.nullPolyfill.__proto__;if(r===null)r=e.nullPolyfill;t.__proto__=r;if(a)o(e.nullPolyfill,"__proto__",s);return t}}return Object.defineProperty(t,"level",{configurable:false,enumerable:false,writable:false,value:e.level})}(function(){var e=Object.create(null),t={},r,a=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__");if(a){try{r=a.set;r.call(e,t)}catch(n){}if(Object.getPrototypeOf(e)===t)return{set:r,level:2}}e.__proto__=t;if(Object.getPrototypeOf(e)===t)return{level:2};e={};e.__proto__=t;if(Object.getPrototypeOf(e)===t)return{level:1};return false}());e("../create")},{"../create":203,"../is-object":205,"../valid-value":217}],215:[function(e,t,r){"use strict";t.exports=function(e){if(typeof e!=="function")throw new TypeError(e+" is not a function");return e}},{}],216:[function(e,t,r){"use strict";var a=e("./is-object");t.exports=function(e){if(!a(e))throw new TypeError(e+" is not an Object");return e}},{"./is-object":205}],217:[function(e,t,r){"use strict";var a=e("./is-value");t.exports=function(e){if(!a(e))throw new TypeError("Cannot use null or undefined");return e}},{"./is-value":206}],218:[function(e,t,r){"use strict";t.exports=e("./is-implemented")()?String.prototype.contains:e("./shim")},{"./is-implemented":219,"./shim":220}],219:[function(e,t,r){"use strict";var a="razdwatrzy";t.exports=function(){if(typeof a.contains!=="function")return false;return a.contains("dwa")===true&&a.contains("foo")===false}},{}],220:[function(e,t,r){"use strict";var a=String.prototype.indexOf;t.exports=function(e){return a.call(this,e,arguments[1])>-1}},{}],221:[function(e,t,r){"use strict";var a=Object.prototype.toString,n=a.call("");t.exports=function(e){return typeof e==="string"||e&&typeof e==="object"&&(e instanceof String||a.call(e)===n)||false}},{}],222:[function(e,t,r){"use strict";var a=Object.create(null),n=Math.random;t.exports=function(){var e;do{e=n().toString(36).slice(2)}while(a[e]);return e}},{}],223:[function(e,t,r){"use strict";var a=e("es5-ext/object/set-prototype-of"),n=e("es5-ext/string/#/contains"),i=e("d"),o=e("es6-symbol"),s=e("./");var l=Object.defineProperty,u;u=t.exports=function(e,t){if(!(this instanceof u))throw new TypeError("Constructor requires 'new'");s.call(this,e);if(!t)t="value";else if(n.call(t,"key+value"))t="key+value";else if(n.call(t,"key"))t="key";else t="value";l(this,"__kind__",i("",t))};if(a)a(u,s);delete u.prototype.constructor;u.prototype=Object.create(s.prototype,{_resolve:i((function(e){if(this.__kind__==="value")return this.__list__[e];if(this.__kind__==="key+value")return[e,this.__list__[e]];return e}))});l(u.prototype,o.toStringTag,i("c","Array Iterator"))},{"./":226,d:158,"es5-ext/object/set-prototype-of":212,"es5-ext/string/#/contains":218,"es6-symbol":230}],224:[function(e,t,r){"use strict";var a=e("es5-ext/function/is-arguments"),n=e("es5-ext/object/valid-callable"),i=e("es5-ext/string/is-string"),o=e("./get");var s=Array.isArray,l=Function.prototype.call,u=Array.prototype.some;t.exports=function(e,t){var r,c=arguments[2],f,h,p,v,d,m,g;if(s(e)||a(e))r="array";else if(i(e))r="string";else e=o(e);n(t);h=function(){p=true};if(r==="array"){u.call(e,(function(e){l.call(t,c,e,h);return p}));return}if(r==="string"){d=e.length;for(v=0;v<d;++v){m=e[v];if(v+1<d){g=m.charCodeAt(0);if(g>=55296&&g<=56319)m+=e[++v]}l.call(t,c,m,h);if(p)break}return}f=e.next();while(!f.done){l.call(t,c,f.value,h);if(p)return;f=e.next()}}},{"./get":225,"es5-ext/function/is-arguments":190,"es5-ext/object/valid-callable":215,"es5-ext/string/is-string":221}],225:[function(e,t,r){"use strict";var a=e("es5-ext/function/is-arguments"),n=e("es5-ext/string/is-string"),i=e("./array"),o=e("./string"),s=e("./valid-iterable"),l=e("es6-symbol").iterator;t.exports=function(e){if(typeof s(e)[l]==="function")return e[l]();if(a(e))return new i(e);if(n(e))return new o(e);return new i(e)}},{"./array":223,"./string":228,"./valid-iterable":229,"es5-ext/function/is-arguments":190,"es5-ext/string/is-string":221,"es6-symbol":230}],226:[function(e,t,r){"use strict";var a=e("es5-ext/array/#/clear"),n=e("es5-ext/object/assign"),i=e("es5-ext/object/valid-callable"),o=e("es5-ext/object/valid-value"),s=e("d"),l=e("d/auto-bind"),u=e("es6-symbol");var c=Object.defineProperty,f=Object.defineProperties,h;t.exports=h=function(e,t){if(!(this instanceof h))throw new TypeError("Constructor requires 'new'");f(this,{__list__:s("w",o(e)),__context__:s("w",t),__nextIndex__:s("w",0)});if(!t)return;i(t.on);t.on("_add",this._onAdd);t.on("_delete",this._onDelete);t.on("_clear",this._onClear)};delete h.prototype.constructor;f(h.prototype,n({_next:s((function(){var e;if(!this.__list__)return undefined;if(this.__redo__){e=this.__redo__.shift();if(e!==undefined)return e}if(this.__nextIndex__<this.__list__.length)return this.__nextIndex__++;this._unBind();return undefined})),next:s((function(){return this._createResult(this._next())})),_createResult:s((function(e){if(e===undefined)return{done:true,value:undefined};return{done:false,value:this._resolve(e)}})),_resolve:s((function(e){return this.__list__[e]})),_unBind:s((function(){this.__list__=null;delete this.__redo__;if(!this.__context__)return;this.__context__.off("_add",this._onAdd);this.__context__.off("_delete",this._onDelete);this.__context__.off("_clear",this._onClear);this.__context__=null})),toString:s((function(){return"[object "+(this[u.toStringTag]||"Object")+"]"}))},l({_onAdd:s((function(e){if(e>=this.__nextIndex__)return;++this.__nextIndex__;if(!this.__redo__){c(this,"__redo__",s("c",[e]));return}this.__redo__.forEach((function(t,r){if(t>=e)this.__redo__[r]=++t}),this);this.__redo__.push(e)})),_onDelete:s((function(e){var t;if(e>=this.__nextIndex__)return;--this.__nextIndex__;if(!this.__redo__)return;t=this.__redo__.indexOf(e);if(t!==-1)this.__redo__.splice(t,1);this.__redo__.forEach((function(t,r){if(t>e)this.__redo__[r]=--t}),this)})),_onClear:s((function(){if(this.__redo__)a.call(this.__redo__);this.__nextIndex__=0}))})));c(h.prototype,u.iterator,s((function(){return this})))},{d:158,"d/auto-bind":157,"es5-ext/array/#/clear":186,"es5-ext/object/assign":199,"es5-ext/object/valid-callable":215,"es5-ext/object/valid-value":217,"es6-symbol":230}],227:[function(e,t,r){"use strict";var a=e("es5-ext/function/is-arguments"),n=e("es5-ext/object/is-value"),i=e("es5-ext/string/is-string");var o=e("es6-symbol").iterator,s=Array.isArray;t.exports=function(e){if(!n(e))return false;if(s(e))return true;if(i(e))return true;if(a(e))return true;return typeof e[o]==="function"}},{"es5-ext/function/is-arguments":190,"es5-ext/object/is-value":206,"es5-ext/string/is-string":221,"es6-symbol":230}],228:[function(e,t,r){"use strict";var a=e("es5-ext/object/set-prototype-of"),n=e("d"),i=e("es6-symbol"),o=e("./");var s=Object.defineProperty,l;l=t.exports=function(e){if(!(this instanceof l))throw new TypeError("Constructor requires 'new'");e=String(e);o.call(this,e);s(this,"__length__",n("",e.length))};if(a)a(l,o);delete l.prototype.constructor;l.prototype=Object.create(o.prototype,{_next:n((function(){if(!this.__list__)return undefined;if(this.__nextIndex__<this.__length__)return this.__nextIndex__++;this._unBind();return undefined})),_resolve:n((function(e){var t=this.__list__[e],r;if(this.__nextIndex__===this.__length__)return t;r=t.charCodeAt(0);if(r>=55296&&r<=56319)return t+this.__list__[this.__nextIndex__++];return t}))});s(l.prototype,i.toStringTag,n("c","String Iterator"))},{"./":226,d:158,"es5-ext/object/set-prototype-of":212,"es6-symbol":230}],229:[function(e,t,r){"use strict";var a=e("./is-iterable");t.exports=function(e){if(!a(e))throw new TypeError(e+" is not iterable");return e}},{"./is-iterable":227}],230:[function(e,t,r){"use strict";t.exports=e("./is-implemented")()?e("ext/global-this").Symbol:e("./polyfill")},{"./is-implemented":231,"./polyfill":236,"ext/global-this":243}],231:[function(e,t,r){"use strict";var a=e("ext/global-this"),n={object:true,symbol:true};t.exports=function(){var e=a.Symbol;var t;if(typeof e!=="function")return false;t=e("test symbol");try{String(t)}catch(r){return false}if(!n[typeof e.iterator])return false;if(!n[typeof e.toPrimitive])return false;if(!n[typeof e.toStringTag])return false;return true}},{"ext/global-this":243}],232:[function(e,t,r){"use strict";t.exports=function(e){if(!e)return false;if(typeof e==="symbol")return true;if(!e.constructor)return false;if(e.constructor.name!=="Symbol")return false;return e[e.constructor.toStringTag]==="Symbol"}},{}],233:[function(e,t,r){"use strict";var a=e("d");var n=Object.create,i=Object.defineProperty,o=Object.prototype;var s=n(null);t.exports=function(e){var t=0,r,n;while(s[e+(t||"")])++t;e+=t||"";s[e]=true;r="@@"+e;i(o,r,a.gs(null,(function(e){if(n)return;n=true;i(this,r,a(e));n=false})));return r}},{d:158}],234:[function(e,t,r){"use strict";var a=e("d"),n=e("ext/global-this").Symbol;t.exports=function(e){return Object.defineProperties(e,{hasInstance:a("",n&&n.hasInstance||e("hasInstance")),isConcatSpreadable:a("",n&&n.isConcatSpreadable||e("isConcatSpreadable")),iterator:a("",n&&n.iterator||e("iterator")),match:a("",n&&n.match||e("match")),replace:a("",n&&n.replace||e("replace")),search:a("",n&&n.search||e("search")),species:a("",n&&n.species||e("species")),split:a("",n&&n.split||e("split")),toPrimitive:a("",n&&n.toPrimitive||e("toPrimitive")),toStringTag:a("",n&&n.toStringTag||e("toStringTag")),unscopables:a("",n&&n.unscopables||e("unscopables"))})}},{d:158,"ext/global-this":243}],235:[function(e,t,r){"use strict";var a=e("d"),n=e("../../../validate-symbol");var i=Object.create(null);t.exports=function(e){return Object.defineProperties(e,{for:a((function(t){if(i[t])return i[t];return i[t]=e(String(t))})),keyFor:a((function(e){var t;n(e);for(t in i){if(i[t]===e)return t}return undefined}))})}},{"../../../validate-symbol":237,d:158}],236:[function(e,t,r){"use strict";var a=e("d"),n=e("./validate-symbol"),i=e("ext/global-this").Symbol,o=e("./lib/private/generate-name"),s=e("./lib/private/setup/standard-symbols"),l=e("./lib/private/setup/symbol-registry");var u=Object.create,c=Object.defineProperties,f=Object.defineProperty;var h,p,v;if(typeof i==="function"){try{String(i());v=true}catch(d){}}else{i=null}p=function e(t){if(this instanceof p)throw new TypeError("Symbol is not a constructor");return h(t)};t.exports=h=function e(t){var r;if(this instanceof e)throw new TypeError("Symbol is not a constructor");if(v)return i(t);r=u(p.prototype);t=t===undefined?"":String(t);return c(r,{__description__:a("",t),__name__:a("",o(t))})};s(h);l(h);c(p.prototype,{constructor:a(h),toString:a("",(function(){return this.__name__}))});c(h.prototype,{toString:a((function(){return"Symbol ("+n(this).__description__+")"})),valueOf:a((function(){return n(this)}))});f(h.prototype,h.toPrimitive,a("",(function(){var e=n(this);if(typeof e==="symbol")return e;return e.toString()})));f(h.prototype,h.toStringTag,a("c","Symbol"));f(p.prototype,h.toStringTag,a("c",h.prototype[h.toStringTag]));f(p.prototype,h.toPrimitive,a("c",h.prototype[h.toPrimitive]))},{"./lib/private/generate-name":233,"./lib/private/setup/standard-symbols":234,"./lib/private/setup/symbol-registry":235,"./validate-symbol":237,d:158,"ext/global-this":243}],237:[function(e,t,r){"use strict";var a=e("./is-symbol");t.exports=function(e){if(!a(e))throw new TypeError(e+" is not a symbol");return e}},{"./is-symbol":232}],238:[function(e,t,r){"use strict";t.exports=e("./is-implemented")()?WeakMap:e("./polyfill")},{"./is-implemented":239,"./polyfill":241}],239:[function(e,t,r){"use strict";t.exports=function(){var e,t;if(typeof WeakMap!=="function")return false;try{e=new WeakMap([[t={},"one"],[{},"two"],[{},"three"]])}catch(r){return false}if(String(e)!=="[object WeakMap]")return false;if(typeof e.set!=="function")return false;if(e.set({},1)!==e)return false;if(typeof e.delete!=="function")return false;if(typeof e.has!=="function")return false;if(e.get(t)!=="one")return false;return true}},{}],240:[function(e,t,r){"use strict";t.exports=function(){if(typeof WeakMap!=="function")return false;return Object.prototype.toString.call(new WeakMap)==="[object WeakMap]"}()},{}],241:[function(e,t,r){"use strict";var a=e("es5-ext/object/is-value"),n=e("es5-ext/object/set-prototype-of"),i=e("es5-ext/object/valid-object"),o=e("es5-ext/object/valid-value"),s=e("es5-ext/string/random-uniq"),l=e("d"),u=e("es6-iterator/get"),c=e("es6-iterator/for-of"),f=e("es6-symbol").toStringTag,h=e("./is-native-implemented"),p=Array.isArray,v=Object.defineProperty,d=Object.prototype.hasOwnProperty,m=Object.getPrototypeOf,g;t.exports=g=function(){var e=arguments[0],t;if(!(this instanceof g))throw new TypeError("Constructor requires 'new'");t=h&&n&&WeakMap!==g?n(new WeakMap,m(this)):this;if(a(e)){if(!p(e))e=u(e)}v(t,"__weakMapData__",l("c","$weakMap$"+s()));if(!e)return t;c(e,(function(e){o(e);t.set(e[0],e[1])}));return t};if(h){if(n)n(g,WeakMap);g.prototype=Object.create(WeakMap.prototype,{constructor:l(g)})}Object.defineProperties(g.prototype,{delete:l((function(e){if(d.call(i(e),this.__weakMapData__)){delete e[this.__weakMapData__];return true}return false})),get:l((function(e){if(!d.call(i(e),this.__weakMapData__))return undefined;return e[this.__weakMapData__]})),has:l((function(e){return d.call(i(e),this.__weakMapData__)})),set:l((function(e,t){v(i(e),this.__weakMapData__,l("c",t));return this})),toString:l((function(){return"[object WeakMap]"}))});v(g.prototype,f,l("c","WeakMap"))},{"./is-native-implemented":240,d:158,"es5-ext/object/is-value":206,"es5-ext/object/set-prototype-of":212,"es5-ext/object/valid-object":216,"es5-ext/object/valid-value":217,"es5-ext/string/random-uniq":222,"es6-iterator/for-of":224,"es6-iterator/get":225,"es6-symbol":230}],242:[function(e,t,r){var a=function(){if(typeof self==="object"&&self)return self;if(typeof window==="object"&&window)return window;throw new Error("Unable to resolve global `this`")};t.exports=function(){if(this)return this;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:true})}catch(e){return a()}try{if(!__global__)return a();return __global__}finally{delete Object.prototype.__global__}}()},{}],243:[function(e,t,r){"use strict";t.exports=e("./is-implemented")()?globalThis:e("./implementation")},{"./implementation":242,"./is-implemented":244}],244:[function(e,t,r){"use strict";t.exports=function(){if(typeof globalThis!=="object")return false;if(!globalThis)return false;return globalThis.Array===Array}},{}],245:[function(e,t,r){"use strict";t.exports=a;function a(e,t,r){var a=t||0;var n=r||1;return[[e[12]+e[0],e[13]+e[1],e[14]+e[2],e[15]+e[3]],[e[12]-e[0],e[13]-e[1],e[14]-e[2],e[15]-e[3]],[e[12]+e[4],e[13]+e[5],e[14]+e[6],e[15]+e[7]],[e[12]-e[4],e[13]-e[5],e[14]-e[6],e[15]-e[7]],[a*e[12]+e[8],a*e[13]+e[9],a*e[14]+e[10],a*e[15]+e[11]],[n*e[12]-e[8],n*e[13]-e[9],n*e[14]-e[10],n*e[15]-e[11]]]}},{}],246:[function(e,t,r){"use strict";var a=e("is-string-blank");t.exports=function(e){var t=typeof e;if(t==="string"){var r=e;e=+e;if(e===0&&a(r))return false}else if(t!=="number")return false;return e-e<1}},{"is-string-blank":448}],247:[function(e,t,r){"use strict";t.exports=u;var a=e("cubic-hermite");var n=e("binary-search-bounds");function i(e,t,r){return Math.min(t,Math.max(e,r))}function o(e,t,r){this.dimension=e.length;this.bounds=[new Array(this.dimension),new Array(this.dimension)];for(var a=0;a<this.dimension;++a){this.bounds[0][a]=-Infinity;this.bounds[1][a]=Infinity}this._state=e.slice().reverse();this._velocity=t.slice().reverse();this._time=[r];this._scratch=[e.slice(),e.slice(),e.slice(),e.slice(),e.slice()]}var s=o.prototype;s.flush=function(e){var t=n.gt(this._time,e)-1;if(t<=0){return}this._time.splice(0,t);this._state.splice(0,t*this.dimension);this._velocity.splice(0,t*this.dimension)};s.curve=function(e){var t=this._time;var r=t.length;var o=n.le(t,e);var s=this._scratch[0];var l=this._state;var u=this._velocity;var c=this.dimension;var f=this.bounds;if(o<0){var h=c-1;for(var p=0;p<c;++p,--h){s[p]=l[h]}}else if(o>=r-1){var h=l.length-1;var v=e-t[r-1];for(var p=0;p<c;++p,--h){s[p]=l[h]+v*u[h]}}else{var h=c*(o+1)-1;var d=t[o];var m=t[o+1];var g=m-d||1;var y=this._scratch[1];var x=this._scratch[2];var b=this._scratch[3];var _=this._scratch[4];var w=true;for(var p=0;p<c;++p,--h){y[p]=l[h];b[p]=u[h]*g;x[p]=l[h+c];_[p]=u[h+c]*g;w=w&&(y[p]===x[p]&&b[p]===_[p]&&b[p]===0)}if(w){for(var p=0;p<c;++p){s[p]=y[p]}}else{a(y,b,x,_,(e-d)/g,s)}}var T=f[0];var k=f[1];for(var p=0;p<c;++p){s[p]=i(T[p],k[p],s[p])}return s};s.dcurve=function(e){var t=this._time;var r=t.length;var i=n.le(t,e);var o=this._scratch[0];var s=this._state;var l=this._velocity;var u=this.dimension;if(i>=r-1){var c=s.length-1;var f=e-t[r-1];for(var h=0;h<u;++h,--c){o[h]=l[c]}}else{var c=u*(i+1)-1;var p=t[i];var v=t[i+1];var d=v-p||1;var m=this._scratch[1];var g=this._scratch[2];var y=this._scratch[3];var x=this._scratch[4];var b=true;for(var h=0;h<u;++h,--c){m[h]=s[c];y[h]=l[c]*d;g[h]=s[c+u];x[h]=l[c+u]*d;b=b&&(m[h]===g[h]&&y[h]===x[h]&&y[h]===0)}if(b){for(var h=0;h<u;++h){o[h]=0}}else{a.derivative(m,y,g,x,(e-p)/d,o);for(var h=0;h<u;++h){o[h]/=d}}}return o};s.lastT=function(){var e=this._time;return e[e.length-1]};s.stable=function(){var e=this._velocity;var t=e.length;for(var r=this.dimension-1;r>=0;--r){if(e[--t]){return false}}return true};s.jump=function(e){var t=this.lastT();var r=this.dimension;if(e<t||arguments.length!==r+1){return}var a=this._state;var n=this._velocity;var o=a.length-this.dimension;var s=this.bounds;var l=s[0];var u=s[1];this._time.push(t,e);for(var c=0;c<2;++c){for(var f=0;f<r;++f){a.push(a[o++]);n.push(0)}}this._time.push(e);for(var f=r;f>0;--f){a.push(i(l[f-1],u[f-1],arguments[f]));n.push(0)}};s.push=function(e){var t=this.lastT();var r=this.dimension;if(e<t||arguments.length!==r+1){return}var a=this._state;var n=this._velocity;var o=a.length-this.dimension;var s=e-t;var l=this.bounds;var u=l[0];var c=l[1];var f=s>1e-6?1/s:0;this._time.push(e);for(var h=r;h>0;--h){var p=i(u[h-1],c[h-1],arguments[h]);a.push(p);n.push((p-a[o++])*f)}};s.set=function(e){var t=this.dimension;if(e<this.lastT()||arguments.length!==t+1){return}var r=this._state;var a=this._velocity;var n=this.bounds;var o=n[0];var s=n[1];this._time.push(e);for(var l=t;l>0;--l){r.push(i(o[l-1],s[l-1],arguments[l]));a.push(0)}};s.move=function(e){var t=this.lastT();var r=this.dimension;if(e<=t||arguments.length!==r+1){return}var a=this._state;var n=this._velocity;var o=a.length-this.dimension;var s=this.bounds;var l=s[0];var u=s[1];var c=e-t;var f=c>1e-6?1/c:0;this._time.push(e);for(var h=r;h>0;--h){var p=arguments[h];a.push(i(l[h-1],u[h-1],a[o++]+p));n.push(p*f)}};s.idle=function(e){var t=this.lastT();if(e<t){return}var r=this.dimension;var a=this._state;var n=this._velocity;var o=a.length-r;var s=this.bounds;var l=s[0];var u=s[1];var c=e-t;this._time.push(e);for(var f=r-1;f>=0;--f){a.push(i(l[f],u[f],a[o]+c*n[o]));n.push(0);o+=1}};function l(e){var t=new Array(e);for(var r=0;r<e;++r){t[r]=0}return t}function u(e,t,r){switch(arguments.length){case 0:return new o([0],[0],0);case 1:if(typeof e==="number"){var a=l(e);return new o(a,a,0)}else{return new o(e,l(e.length),0)}case 2:if(typeof t==="number"){var a=l(e.length);return new o(e,a,+t)}else{r=0}case 3:if(e.length!==t.length){throw new Error("state and velocity lengths must match")}return new o(e,t,r)}}},{"binary-search-bounds":103,"cubic-hermite":156}],248:[function(e,t,r){var a=e("dtype");t.exports=n;function n(e,t,r){if(!e)throw new TypeError("must specify data as first parameter");r=+(r||0)|0;if(Array.isArray(e)&&(e[0]&&typeof e[0][0]==="number")){var n=e[0].length;var i=e.length*n;var o,s,l,u;if(!t||typeof t==="string"){t=new(a(t||"float32"))(i+r)}var c=t.length-r;if(i!==c){throw new Error("source length "+i+" ("+n+"x"+e.length+")"+" does not match destination length "+c)}for(o=0,l=r;o<e.length;o++){for(s=0;s<n;s++){t[l++]=e[o][s]===null?NaN:e[o][s]}}}else{if(!t||typeof t==="string"){var f=a(t||"float32");if(Array.isArray(e)||t==="array"){t=new f(e.length+r);for(o=0,l=r,u=t.length;l<u;l++,o++){t[l]=e[o]===null?NaN:e[o]}}else{if(r===0){t=new f(e)}else{t=new f(e.length+r);t.set(e,r)}}}else{t.set(e,r)}}return t}},{dtype:181}],249:[function(e,t,r){"use strict";var a=e("css-font/stringify");var n=[32,126];t.exports=i;function i(e){e=e||{};var t=e.shape?e.shape:e.canvas?[e.canvas.width,e.canvas.height]:[512,512];var r=e.canvas||document.createElement("canvas");var i=e.font;var o=typeof e.step==="number"?[e.step,e.step]:e.step||[32,32];var s=e.chars||n;if(i&&typeof i!=="string")i=a(i);if(!Array.isArray(s)){s=String(s).split("")}else if(s.length===2&&typeof s[0]==="number"&&typeof s[1]==="number"){var l=[];for(var u=s[0],c=0;u<=s[1];u++){l[c++]=String.fromCharCode(u)}s=l}t=t.slice();r.width=t[0];r.height=t[1];var f=r.getContext("2d");f.fillStyle="#000";f.fillRect(0,0,r.width,r.height);f.font=i;f.textAlign="center";f.textBaseline="middle";f.fillStyle="#fff";var h=o[0]/2;var p=o[1]/2;for(var u=0;u<s.length;u++){f.fillText(s[u],h,p);if((h+=o[0])>t[0]-o[0]/2)h=o[0]/2,p+=o[1]}return r}},{"css-font/stringify":153}],250:[function(e,t,r){"use strict";t.exports=a;a.canvas=document.createElement("canvas");a.cache={};function a(e,t){if(!t)t={};if(typeof e==="string"||Array.isArray(e)){t.family=e}var r=Array.isArray(t.family)?t.family.join(", "):t.family;if(!r)throw Error("`family` must be defined");var s=t.size||t.fontSize||t.em||48;var l=t.weight||t.fontWeight||"";var u=t.style||t.fontStyle||"";var e=[u,l,s].join(" ")+"px "+r;var c=t.origin||"top";if(a.cache[r]){if(s<=a.cache[r].em){return n(a.cache[r],c)}}var f=t.canvas||a.canvas;var h=f.getContext("2d");var p={upper:t.upper!==undefined?t.upper:"H",lower:t.lower!==undefined?t.lower:"x",descent:t.descent!==undefined?t.descent:"p",ascent:t.ascent!==undefined?t.ascent:"h",tittle:t.tittle!==undefined?t.tittle:"i",overshoot:t.overshoot!==undefined?t.overshoot:"O"};var v=Math.ceil(s*1.5);f.height=v;f.width=v*.5;h.font=e;var d="H";var m={top:0};h.clearRect(0,0,v,v);h.textBaseline="top";h.fillStyle="black";h.fillText(d,0,0);var g=i(h.getImageData(0,0,v,v));h.clearRect(0,0,v,v);h.textBaseline="bottom";h.fillText(d,0,v);var y=i(h.getImageData(0,0,v,v));m.lineHeight=m.bottom=v-y+g;h.clearRect(0,0,v,v);h.textBaseline="alphabetic";h.fillText(d,0,v);var x=i(h.getImageData(0,0,v,v));var b=v-x-1+g;m.baseline=m.alphabetic=b;h.clearRect(0,0,v,v);h.textBaseline="middle";h.fillText(d,0,v*.5);var _=i(h.getImageData(0,0,v,v));m.median=m.middle=v-_-1+g-v*.5;h.clearRect(0,0,v,v);h.textBaseline="hanging";h.fillText(d,0,v*.5);var w=i(h.getImageData(0,0,v,v));m.hanging=v-w-1+g-v*.5;h.clearRect(0,0,v,v);h.textBaseline="ideographic";h.fillText(d,0,v);var T=i(h.getImageData(0,0,v,v));m.ideographic=v-T-1+g;if(p.upper){h.clearRect(0,0,v,v);h.textBaseline="top";h.fillText(p.upper,0,0);m.upper=i(h.getImageData(0,0,v,v));m.capHeight=m.baseline-m.upper}if(p.lower){h.clearRect(0,0,v,v);h.textBaseline="top";h.fillText(p.lower,0,0);m.lower=i(h.getImageData(0,0,v,v));m.xHeight=m.baseline-m.lower}if(p.tittle){h.clearRect(0,0,v,v);h.textBaseline="top";h.fillText(p.tittle,0,0);m.tittle=i(h.getImageData(0,0,v,v))}if(p.ascent){h.clearRect(0,0,v,v);h.textBaseline="top";h.fillText(p.ascent,0,0);m.ascent=i(h.getImageData(0,0,v,v))}if(p.descent){h.clearRect(0,0,v,v);h.textBaseline="top";h.fillText(p.descent,0,0);m.descent=o(h.getImageData(0,0,v,v))}if(p.overshoot){h.clearRect(0,0,v,v);h.textBaseline="top";h.fillText(p.overshoot,0,0);var k=o(h.getImageData(0,0,v,v));m.overshoot=k-b}for(var M in m){m[M]/=s}m.em=s;a.cache[r]=m;return n(m,c)}function n(e,t){var r={};if(typeof t==="string")t=e[t];for(var a in e){if(a==="em")continue;r[a]=e[a]-t}return r}function i(e){var t=e.height;var r=e.data;for(var a=3;a<r.length;a+=4){if(r[a]!==0){return Math.floor((a-3)*.25/t)}}}function o(e){var t=e.height;var r=e.data;for(var a=r.length-1;a>0;a-=4){if(r[a]!==0){return Math.floor((a-3)*.25/t)}}}},{}],251:[function(e,t,r){"use strict";t.exports=x;var a=0;var n=1;function i(e,t,r,a,n,i){this._color=e;this.key=t;this.value=r;this.left=a;this.right=n;this._count=i}function o(e){return new i(e._color,e.key,e.value,e.left,e.right,e._count)}function s(e,t){return new i(e,t.key,t.value,t.left,t.right,t._count)}function l(e){e._count=1+(e.left?e.left._count:0)+(e.right?e.right._count:0)}function u(e,t){this._compare=e;this.root=t}var c=u.prototype;Object.defineProperty(c,"keys",{get:function(){var e=[];this.forEach((function(t,r){e.push(t)}));return e}});Object.defineProperty(c,"values",{get:function(){var e=[];this.forEach((function(t,r){e.push(r)}));return e}});Object.defineProperty(c,"length",{get:function(){if(this.root){return this.root._count}return 0}});c.insert=function(e,t){var r=this._compare;var o=this.root;var c=[];var f=[];while(o){var h=r(e,o.key);c.push(o);f.push(h);if(h<=0){o=o.left}else{o=o.right}}c.push(new i(a,e,t,null,null,1));for(var p=c.length-2;p>=0;--p){var o=c[p];if(f[p]<=0){c[p]=new i(o._color,o.key,o.value,c[p+1],o.right,o._count+1)}else{c[p]=new i(o._color,o.key,o.value,o.left,c[p+1],o._count+1)}}for(var p=c.length-1;p>1;--p){var v=c[p-1];var o=c[p];if(v._color===n||o._color===n){break}var d=c[p-2];if(d.left===v){if(v.left===o){var m=d.right;if(m&&m._color===a){v._color=n;d.right=s(n,m);d._color=a;p-=1}else{d._color=a;d.left=v.right;v._color=n;v.right=d;c[p-2]=v;c[p-1]=o;l(d);l(v);if(p>=3){var g=c[p-3];if(g.left===d){g.left=v}else{g.right=v}}break}}else{var m=d.right;if(m&&m._color===a){v._color=n;d.right=s(n,m);d._color=a;p-=1}else{v.right=o.left;d._color=a;d.left=o.right;o._color=n;o.left=v;o.right=d;c[p-2]=o;c[p-1]=v;l(d);l(v);l(o);if(p>=3){var g=c[p-3];if(g.left===d){g.left=o}else{g.right=o}}break}}}else{if(v.right===o){var m=d.left;if(m&&m._color===a){v._color=n;d.left=s(n,m);d._color=a;p-=1}else{d._color=a;d.right=v.left;v._color=n;v.left=d;c[p-2]=v;c[p-1]=o;l(d);l(v);if(p>=3){var g=c[p-3];if(g.right===d){g.right=v}else{g.left=v}}break}}else{var m=d.left;if(m&&m._color===a){v._color=n;d.left=s(n,m);d._color=a;p-=1}else{v.left=o.right;d._color=a;d.right=o.left;o._color=n;o.right=v;o.left=d;c[p-2]=o;c[p-1]=v;l(d);l(v);l(o);if(p>=3){var g=c[p-3];if(g.right===d){g.right=o}else{g.left=o}}break}}}}c[0]._color=n;return new u(r,c[0])};function f(e,t){if(t.left){var r=f(e,t.left);if(r){return r}}var r=e(t.key,t.value);if(r){return r}if(t.right){return f(e,t.right)}}function h(e,t,r,a){var n=t(e,a.key);if(n<=0){if(a.left){var i=h(e,t,r,a.left);if(i){return i}}var i=r(a.key,a.value);if(i){return i}}if(a.right){return h(e,t,r,a.right)}}function p(e,t,r,a,n){var i=r(e,n.key);var o=r(t,n.key);var s;if(i<=0){if(n.left){s=p(e,t,r,a,n.left);if(s){return s}}if(o>0){s=a(n.key,n.value);if(s){return s}}}if(o>0&&n.right){return p(e,t,r,a,n.right)}}c.forEach=function e(t,r,a){if(!this.root){return}switch(arguments.length){case 1:return f(t,this.root);break;case 2:return h(r,this._compare,t,this.root);break;case 3:if(this._compare(r,a)>=0){return}return p(r,a,this._compare,t,this.root);break}};Object.defineProperty(c,"begin",{get:function(){var e=[];var t=this.root;while(t){e.push(t);t=t.left}return new v(this,e)}});Object.defineProperty(c,"end",{get:function(){var e=[];var t=this.root;while(t){e.push(t);t=t.right}return new v(this,e)}});c.at=function(e){if(e<0){return new v(this,[])}var t=this.root;var r=[];while(true){r.push(t);if(t.left){if(e<t.left._count){t=t.left;continue}e-=t.left._count}if(!e){return new v(this,r)}e-=1;if(t.right){if(e>=t.right._count){break}t=t.right}else{break}}return new v(this,[])};c.ge=function(e){var t=this._compare;var r=this.root;var a=[];var n=0;while(r){var i=t(e,r.key);a.push(r);if(i<=0){n=a.length}if(i<=0){r=r.left}else{r=r.right}}a.length=n;return new v(this,a)};c.gt=function(e){var t=this._compare;var r=this.root;var a=[];var n=0;while(r){var i=t(e,r.key);a.push(r);if(i<0){n=a.length}if(i<0){r=r.left}else{r=r.right}}a.length=n;return new v(this,a)};c.lt=function(e){var t=this._compare;var r=this.root;var a=[];var n=0;while(r){var i=t(e,r.key);a.push(r);if(i>0){n=a.length}if(i<=0){r=r.left}else{r=r.right}}a.length=n;return new v(this,a)};c.le=function(e){var t=this._compare;var r=this.root;var a=[];var n=0;while(r){var i=t(e,r.key);a.push(r);if(i>=0){n=a.length}if(i<0){r=r.left}else{r=r.right}}a.length=n;return new v(this,a)};c.find=function(e){var t=this._compare;var r=this.root;var a=[];while(r){var n=t(e,r.key);a.push(r);if(n===0){return new v(this,a)}if(n<=0){r=r.left}else{r=r.right}}return new v(this,[])};c.remove=function(e){var t=this.find(e);if(t){return t.remove()}return this};c.get=function(e){var t=this._compare;var r=this.root;while(r){var a=t(e,r.key);if(a===0){return r.value}if(a<=0){r=r.left}else{r=r.right}}return};function v(e,t){this.tree=e;this._stack=t}var d=v.prototype;Object.defineProperty(d,"valid",{get:function(){return this._stack.length>0}});Object.defineProperty(d,"node",{get:function(){if(this._stack.length>0){return this._stack[this._stack.length-1]}return null},enumerable:true});d.clone=function(){return new v(this.tree,this._stack.slice())};function m(e,t){e.key=t.key;e.value=t.value;e.left=t.left;e.right=t.right;e._color=t._color;e._count=t._count}function g(e){var t,r,i,u;for(var c=e.length-1;c>=0;--c){t=e[c];if(c===0){t._color=n;return}r=e[c-1];if(r.left===t){i=r.right;if(i.right&&i.right._color===a){i=r.right=o(i);u=i.right=o(i.right);r.right=i.left;i.left=r;i.right=u;i._color=r._color;t._color=n;r._color=n;u._color=n;l(r);l(i);if(c>1){var f=e[c-2];if(f.left===r){f.left=i}else{f.right=i}}e[c-1]=i;return}else if(i.left&&i.left._color===a){i=r.right=o(i);u=i.left=o(i.left);r.right=u.left;i.left=u.right;u.left=r;u.right=i;u._color=r._color;r._color=n;i._color=n;t._color=n;l(r);l(i);l(u);if(c>1){var f=e[c-2];if(f.left===r){f.left=u}else{f.right=u}}e[c-1]=u;return}if(i._color===n){if(r._color===a){r._color=n;r.right=s(a,i);return}else{r.right=s(a,i);continue}}else{i=o(i);r.right=i.left;i.left=r;i._color=r._color;r._color=a;l(r);l(i);if(c>1){var f=e[c-2];if(f.left===r){f.left=i}else{f.right=i}}e[c-1]=i;e[c]=r;if(c+1<e.length){e[c+1]=t}else{e.push(t)}c=c+2}}else{i=r.left;if(i.left&&i.left._color===a){i=r.left=o(i);u=i.left=o(i.left);r.left=i.right;i.right=r;i.left=u;i._color=r._color;t._color=n;r._color=n;u._color=n;l(r);l(i);if(c>1){var f=e[c-2];if(f.right===r){f.right=i}else{f.left=i}}e[c-1]=i;return}else if(i.right&&i.right._color===a){i=r.left=o(i);u=i.right=o(i.right);r.left=u.right;i.right=u.left;u.right=r;u.left=i;u._color=r._color;r._color=n;i._color=n;t._color=n;l(r);l(i);l(u);if(c>1){var f=e[c-2];if(f.right===r){f.right=u}else{f.left=u}}e[c-1]=u;return}if(i._color===n){if(r._color===a){r._color=n;r.left=s(a,i);return}else{r.left=s(a,i);continue}}else{i=o(i);r.left=i.right;i.right=r;i._color=r._color;r._color=a;l(r);l(i);if(c>1){var f=e[c-2];if(f.right===r){f.right=i}else{f.left=i}}e[c-1]=i;e[c]=r;if(c+1<e.length){e[c+1]=t}else{e.push(t)}c=c+2}}}}d.remove=function(){var e=this._stack;if(e.length===0){return this.tree}var t=new Array(e.length);var r=e[e.length-1];t[t.length-1]=new i(r._color,r.key,r.value,r.left,r.right,r._count);for(var o=e.length-2;o>=0;--o){var r=e[o];if(r.left===e[o+1]){t[o]=new i(r._color,r.key,r.value,t[o+1],r.right,r._count)}else{t[o]=new i(r._color,r.key,r.value,r.left,t[o+1],r._count)}}r=t[t.length-1];if(r.left&&r.right){var s=t.length;r=r.left;while(r.right){t.push(r);r=r.right}var l=t[s-1];t.push(new i(r._color,l.key,l.value,r.left,r.right,r._count));t[s-1].key=r.key;t[s-1].value=r.value;for(var o=t.length-2;o>=s;--o){r=t[o];t[o]=new i(r._color,r.key,r.value,r.left,t[o+1],r._count)}t[s-1].left=t[s]}r=t[t.length-1];if(r._color===a){var c=t[t.length-2];if(c.left===r){c.left=null}else if(c.right===r){c.right=null}t.pop();for(var o=0;o<t.length;++o){t[o]._count--}return new u(this.tree._compare,t[0])}else{if(r.left||r.right){if(r.left){m(r,r.left)}else if(r.right){m(r,r.right)}r._color=n;for(var o=0;o<t.length-1;++o){t[o]._count--}return new u(this.tree._compare,t[0])}else if(t.length===1){return new u(this.tree._compare,null)}else{for(var o=0;o<t.length;++o){t[o]._count--}var f=t[t.length-2];g(t);if(f.left===r){f.left=null}else{f.right=null}}}return new u(this.tree._compare,t[0])};Object.defineProperty(d,"key",{get:function(){if(this._stack.length>0){return this._stack[this._stack.length-1].key}return},enumerable:true});Object.defineProperty(d,"value",{get:function(){if(this._stack.length>0){return this._stack[this._stack.length-1].value}return},enumerable:true});Object.defineProperty(d,"index",{get:function(){var e=0;var t=this._stack;if(t.length===0){var r=this.tree.root;if(r){return r._count}return 0}else if(t[t.length-1].left){e=t[t.length-1].left._count}for(var a=t.length-2;a>=0;--a){if(t[a+1]===t[a].right){++e;if(t[a].left){e+=t[a].left._count}}}return e},enumerable:true});d.next=function(){var e=this._stack;if(e.length===0){return}var t=e[e.length-1];if(t.right){t=t.right;while(t){e.push(t);t=t.left}}else{e.pop();while(e.length>0&&e[e.length-1].right===t){t=e[e.length-1];e.pop()}}};Object.defineProperty(d,"hasNext",{get:function(){var e=this._stack;if(e.length===0){return false}if(e[e.length-1].right){return true}for(var t=e.length-1;t>0;--t){if(e[t-1].left===e[t]){return true}}return false}});d.update=function(e){var t=this._stack;if(t.length===0){throw new Error("Can't update empty node!")}var r=new Array(t.length);var a=t[t.length-1];r[r.length-1]=new i(a._color,a.key,e,a.left,a.right,a._count);for(var n=t.length-2;n>=0;--n){a=t[n];if(a.left===t[n+1]){r[n]=new i(a._color,a.key,a.value,r[n+1],a.right,a._count)}else{r[n]=new i(a._color,a.key,a.value,a.left,r[n+1],a._count)}}return new u(this.tree._compare,r[0])};d.prev=function(){var e=this._stack;if(e.length===0){return}var t=e[e.length-1];if(t.left){t=t.left;while(t){e.push(t);t=t.right}}else{e.pop();while(e.length>0&&e[e.length-1].left===t){t=e[e.length-1];e.pop()}}};Object.defineProperty(d,"hasPrev",{get:function(){var e=this._stack;if(e.length===0){return false}if(e[e.length-1].left){return true}for(var t=e.length-1;t>0;--t){if(e[t-1].right===e[t]){return true}}return false}});function y(e,t){if(e<t){return-1}if(e>t){return 1}return 0}function x(e){return new u(e||y,null)}},{}],252:[function(e,t,r){t.exports=a;function a(e,t){if(typeof e!=="string"){throw new TypeError("must specify type string")}t=t||{};if(typeof document==="undefined"&&!t.canvas){return null}var r=t.canvas||document.createElement("canvas");if(typeof t.width==="number"){r.width=t.width}if(typeof t.height==="number"){r.height=t.height}var a=t;var n;try{var i=[e];if(e.indexOf("webgl")===0){i.push("experimental-"+e)}for(var o=0;o<i.length;o++){n=r.getContext(i[o],a);if(n)return n}}catch(s){n=null}return n||null}},{}],253:[function(e,t,r){"use strict";t.exports=_;var a=e("./lib/text.js");var n=e("./lib/lines.js");var i=e("./lib/background.js");var o=e("./lib/cube.js");var s=e("./lib/ticks.js");var l=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);function u(e,t){e[0]=t[0];e[1]=t[1];e[2]=t[2];return e}function c(e){this.gl=e;this.pixelRatio=1;this.bounds=[[-10,-10,-10],[10,10,10]];this.ticks=[[],[],[]];this.autoTicks=true;this.tickSpacing=[1,1,1];this.tickEnable=[true,true,true];this.tickFont=["sans-serif","sans-serif","sans-serif"];this.tickSize=[12,12,12];this.tickAngle=[0,0,0];this.tickAlign=["auto","auto","auto"];this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.tickPad=[10,10,10];this.lastCubeProps={cubeEdges:[0,0,0],axis:[0,0,0]};this.labels=["x","y","z"];this.labelEnable=[true,true,true];this.labelFont="sans-serif";this.labelSize=[20,20,20];this.labelAngle=[0,0,0];this.labelAlign=["auto","auto","auto"];this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.labelPad=[10,10,10];this.lineEnable=[true,true,true];this.lineMirror=[false,false,false];this.lineWidth=[1,1,1];this.lineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.lineTickEnable=[true,true,true];this.lineTickMirror=[false,false,false];this.lineTickLength=[0,0,0];this.lineTickWidth=[1,1,1];this.lineTickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.gridEnable=[true,true,true];this.gridWidth=[1,1,1];this.gridColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.zeroEnable=[true,true,true];this.zeroLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.zeroLineWidth=[2,2,2];this.backgroundEnable=[false,false,false];this.backgroundColor=[[.8,.8,.8,.5],[.8,.8,.8,.5],[.8,.8,.8,.5]];this._firstInit=true;this._text=null;this._lines=null;this._background=i(e)}var f=c.prototype;f.update=function(e){e=e||{};function t(t,r,a){if(a in e){var n=e[a];var i=this[a];var o;if(t?Array.isArray(n)&&Array.isArray(n[0]):Array.isArray(n)){this[a]=o=[r(n[0]),r(n[1]),r(n[2])]}else{this[a]=o=[r(n),r(n),r(n)]}for(var s=0;s<3;++s){if(o[s]!==i[s]){return true}}}return false}var r=t.bind(this,false,Number);var i=t.bind(this,false,Boolean);var o=t.bind(this,false,String);var l=t.bind(this,true,(function(e){if(Array.isArray(e)){if(e.length===3){return[+e[0],+e[1],+e[2],1]}else if(e.length===4){return[+e[0],+e[1],+e[2],+e[3]]}}return[0,0,0,1]}));var u;var c=false;var f=false;if("bounds"in e){var h=e.bounds;e:for(var p=0;p<2;++p){for(var v=0;v<3;++v){if(h[p][v]!==this.bounds[p][v]){f=true}this.bounds[p][v]=h[p][v]}}}if("ticks"in e){u=e.ticks;c=true;this.autoTicks=false;for(var p=0;p<3;++p){this.tickSpacing[p]=0}}else if(r("tickSpacing")){this.autoTicks=true;f=true}if(this._firstInit){if(!("ticks"in e||"tickSpacing"in e)){this.autoTicks=true}f=true;c=true;this._firstInit=false}if(f&&this.autoTicks){u=s.create(this.bounds,this.tickSpacing);c=true}if(c){for(var p=0;p<3;++p){u[p].sort((function(e,t){return e.x-t.x}))}if(s.equal(u,this.ticks)){c=false}else{this.ticks=u}}i("tickEnable");if(o("tickFont")){c=true}r("tickSize");r("tickAngle");r("tickPad");l("tickColor");var d=o("labels");if(o("labelFont")){d=true}i("labelEnable");r("labelSize");r("labelPad");l("labelColor");i("lineEnable");i("lineMirror");r("lineWidth");l("lineColor");i("lineTickEnable");i("lineTickMirror");r("lineTickLength");r("lineTickWidth");l("lineTickColor");i("gridEnable");r("gridWidth");l("gridColor");i("zeroEnable");l("zeroLineColor");r("zeroLineWidth");i("backgroundEnable");l("backgroundColor");if(!this._text){this._text=a(this.gl,this.bounds,this.labels,this.labelFont,this.ticks,this.tickFont)}else if(this._text&&(d||c)){this._text.update(this.bounds,this.labels,this.labelFont,this.ticks,this.tickFont)}if(this._lines&&c){this._lines.dispose();this._lines=null}if(!this._lines){this._lines=n(this.gl,this.bounds,this.ticks)}};function h(){this.primalOffset=[0,0,0];this.primalMinor=[0,0,0];this.mirrorOffset=[0,0,0];this.mirrorMinor=[0,0,0]}var p=[new h,new h,new h];function v(e,t,r,a,n){var i=e.primalOffset;var o=e.primalMinor;var s=e.mirrorOffset;var l=e.mirrorMinor;var u=a[t];for(var c=0;c<3;++c){if(t===c){continue}var f=i,h=s,p=o,v=l;if(u&1<<c){f=s;h=i;p=l;v=o}f[c]=r[0][c];h[c]=r[1][c];if(n[c]>0){p[c]=-1;v[c]=0}else{p[c]=0;v[c]=+1}}}var d=[0,0,0];var m={model:l,view:l,projection:l,_ortho:false};f.isOpaque=function(){return true};f.isTransparent=function(){return false};f.drawTransparent=function(e){};var g=0;var y=[0,0,0];var x=[0,0,0];var b=[0,0,0];f.draw=function(e){e=e||m;var t=this.gl;var r=e.model||l;var a=e.view||l;var n=e.projection||l;var i=this.bounds;var s=e._ortho||false;var c=o(r,a,n,i,s);var f=c.cubeEdges;var h=c.axis;var _=a[12];var w=a[13];var T=a[14];var k=a[15];var M=s?2:1;var A=M*this.pixelRatio*(n[3]*_+n[7]*w+n[11]*T+n[15]*k)/t.drawingBufferHeight;for(var S=0;S<3;++S){this.lastCubeProps.cubeEdges[S]=f[S];this.lastCubeProps.axis[S]=h[S]}var E=p;for(var S=0;S<3;++S){v(p[S],S,this.bounds,f,h)}var t=this.gl;var L=d;for(var S=0;S<3;++S){if(this.backgroundEnable[S]){L[S]=h[S]}else{L[S]=0}}this._background.draw(r,a,n,i,L,this.backgroundColor);this._lines.bind(r,a,n,this);for(var S=0;S<3;++S){var C=[0,0,0];if(h[S]>0){C[S]=i[1][S]}else{C[S]=i[0][S]}for(var I=0;I<2;++I){var P=(S+1+I)%3;var O=(S+1+(I^1))%3;if(this.gridEnable[P]){this._lines.drawGrid(P,O,this.bounds,C,this.gridColor[P],this.gridWidth[P]*this.pixelRatio)}}for(var I=0;I<2;++I){var P=(S+1+I)%3;var O=(S+1+(I^1))%3;if(this.zeroEnable[O]){if(Math.min(i[0][O],i[1][O])<=0&&Math.max(i[0][O],i[1][O])>=0){this._lines.drawZero(P,O,this.bounds,C,this.zeroLineColor[O],this.zeroLineWidth[O]*this.pixelRatio)}}}}for(var S=0;S<3;++S){if(this.lineEnable[S]){this._lines.drawAxisLine(S,this.bounds,E[S].primalOffset,this.lineColor[S],this.lineWidth[S]*this.pixelRatio)}if(this.lineMirror[S]){this._lines.drawAxisLine(S,this.bounds,E[S].mirrorOffset,this.lineColor[S],this.lineWidth[S]*this.pixelRatio)}var z=u(y,E[S].primalMinor);var D=u(x,E[S].mirrorMinor);var R=this.lineTickLength;for(var I=0;I<3;++I){var F=A/r[5*I];z[I]*=R[I]*F;D[I]*=R[I]*F}if(this.lineTickEnable[S]){this._lines.drawAxisTicks(S,E[S].primalOffset,z,this.lineTickColor[S],this.lineTickWidth[S]*this.pixelRatio)}if(this.lineTickMirror[S]){this._lines.drawAxisTicks(S,E[S].mirrorOffset,D,this.lineTickColor[S],this.lineTickWidth[S]*this.pixelRatio)}}this._lines.unbind();this._text.bind(r,a,n,this.pixelRatio);var B;var N=.5;var j;var U;function V(e){U=[0,0,0];U[e]=1}function H(e,t,r){var a=(e+1)%3;var n=(e+2)%3;var i=t[a];var o=t[n];var s=r[a];var l=r[n];if(i>0&&l>0){V(a);return}else if(i>0&&l<0){V(a);return}else if(i<0&&l>0){V(a);return}else if(i<0&&l<0){V(a);return}else if(o>0&&s>0){V(n);return}else if(o>0&&s<0){V(n);return}else if(o<0&&s>0){V(n);return}else if(o<0&&s<0){V(n);return}}for(var S=0;S<3;++S){var q=E[S].primalMinor;var G=E[S].mirrorMinor;var Y=u(b,E[S].primalOffset);for(var I=0;I<3;++I){if(this.lineTickEnable[S]){Y[I]+=A*q[I]*Math.max(this.lineTickLength[I],0)/r[5*I]}}var W=[0,0,0];W[S]=1;if(this.tickEnable[S]){if(this.tickAngle[S]===-3600){this.tickAngle[S]=0;this.tickAlign[S]="auto"}else{this.tickAlign[S]=-1}j=1;B=[this.tickAlign[S],N,j];if(B[0]==="auto")B[0]=g;else B[0]=parseInt(""+B[0]);U=[0,0,0];H(S,q,G);for(var I=0;I<3;++I){Y[I]+=A*q[I]*this.tickPad[I]/r[5*I]}this._text.drawTicks(S,this.tickSize[S],this.tickAngle[S],Y,this.tickColor[S],W,U,B)}if(this.labelEnable[S]){j=0;U=[0,0,0];if(this.labels[S].length>4){V(S);j=1}B=[this.labelAlign[S],N,j];if(B[0]==="auto")B[0]=g;else B[0]=parseInt(""+B[0]);for(var I=0;I<3;++I){Y[I]+=A*q[I]*this.labelPad[I]/r[5*I]}Y[S]+=.5*(i[0][S]+i[1][S]);this._text.drawLabel(S,this.labelSize[S],this.labelAngle[S],Y,this.labelColor[S],[0,0,0],U,B)}}this._text.unbind()};f.dispose=function(){this._text.dispose();this._lines.dispose();this._background.dispose();this._lines=null;this._text=null;this._background=null;this.gl=null};function _(e,t){var r=new c(e);r.update(t);return r}},{"./lib/background.js":254,"./lib/cube.js":255,"./lib/lines.js":256,"./lib/text.js":258,"./lib/ticks.js":259}],254:[function(e,t,r){"use strict";t.exports=l;var a=e("gl-buffer");var n=e("gl-vao");var i=e("./shaders").bg;function o(e,t,r,a){this.gl=e;this.buffer=t;this.vao=r;this.shader=a}var s=o.prototype;s.draw=function(e,t,r,a,n,i){var o=false;for(var s=0;s<3;++s){o=o||n[s]}if(!o){return}var l=this.gl;l.enable(l.POLYGON_OFFSET_FILL);l.polygonOffset(1,2);this.shader.bind();this.shader.uniforms={model:e,view:t,projection:r,bounds:a,enable:n,colors:i};this.vao.bind();this.vao.draw(this.gl.TRIANGLES,36);this.vao.unbind();l.disable(l.POLYGON_OFFSET_FILL)};s.dispose=function(){this.vao.dispose();this.buffer.dispose();this.shader.dispose()};function l(e){var t=[];var r=[];var s=0;for(var l=0;l<3;++l){var u=(l+1)%3;var c=(l+2)%3;var f=[0,0,0];var h=[0,0,0];for(var p=-1;p<=1;p+=2){r.push(s,s+2,s+1,s+1,s+2,s+3);f[l]=p;h[l]=p;for(var v=-1;v<=1;v+=2){f[u]=v;for(var d=-1;d<=1;d+=2){f[c]=d;t.push(f[0],f[1],f[2],h[0],h[1],h[2]);s+=1}}var m=u;u=c;c=m}}var g=a(e,new Float32Array(t));var y=a(e,new Uint16Array(r),e.ELEMENT_ARRAY_BUFFER);var x=n(e,[{buffer:g,type:e.FLOAT,size:3,offset:0,stride:24},{buffer:g,type:e.FLOAT,size:3,offset:12,stride:24}],y);var b=i(e);b.attributes.position.location=0;b.attributes.normal.location=1;return new o(e,g,x,b)}},{"./shaders":257,"gl-buffer":261,"gl-vao":353}],255:[function(e,t,r){"use strict";t.exports=y;var a=e("bit-twiddle");var n=e("gl-mat4/multiply");var i=e("split-polygon");var o=e("robust-orientation");var s=new Array(16);var l=new Array(8);var u=new Array(8);var c=new Array(3);var f=[0,0,0];(function(){for(var e=0;e<8;++e){l[e]=[1,1,1,1];u[e]=[1,1,1]}})();function h(e,t,r){for(var a=0;a<4;++a){e[a]=r[12+a];for(var n=0;n<3;++n){e[a]+=t[n]*r[4*n+a]}}}var p=[[0,0,1,0,0],[0,0,-1,1,0],[0,-1,0,1,0],[0,1,0,1,0],[-1,0,0,1,0],[1,0,0,1,0]];function v(e){for(var t=0;t<p.length;++t){e=i.positive(e,p[t]);if(e.length<3){return 0}}var r=e[0];var a=r[0]/r[3];var n=r[1]/r[3];var o=0;for(var t=1;t+1<e.length;++t){var s=e[t];var l=e[t+1];var u=s[0]/s[3];var c=s[1]/s[3];var f=l[0]/l[3];var h=l[1]/l[3];var v=u-a;var d=c-n;var m=f-a;var g=h-n;o+=Math.abs(v*g-d*m)}return o}var d=[1,1,1];var m=[0,0,0];var g={cubeEdges:d,axis:m};function y(e,t,r,i,p){n(s,t,e);n(s,r,s);var y=0;for(var x=0;x<2;++x){c[2]=i[x][2];for(var b=0;b<2;++b){c[1]=i[b][1];for(var _=0;_<2;++_){c[0]=i[_][0];h(l[y],c,s);y+=1}}}var w=-1;for(var x=0;x<8;++x){var T=l[x][3];for(var k=0;k<3;++k){u[x][k]=l[x][k]/T}if(p)u[x][2]*=-1;if(T<0){if(w<0){w=x}else if(u[x][2]<u[w][2]){w=x}}}if(w<0){w=0;for(var M=0;M<3;++M){var A=(M+2)%3;var S=(M+1)%3;var E=-1;var L=-1;for(var C=0;C<2;++C){var I=C<<M;var P=I+(C<<A)+(1-C<<S);var O=I+(1-C<<A)+(C<<S);if(o(u[I],u[P],u[O],f)<0){continue}if(C){E=1}else{L=1}}if(E<0||L<0){if(L>E){w|=1<<M}continue}for(var C=0;C<2;++C){var I=C<<M;var P=I+(C<<A)+(1-C<<S);var O=I+(1-C<<A)+(C<<S);var z=v([l[I],l[P],l[O],l[I+(1<<A)+(1<<S)]]);if(C){E=z}else{L=z}}if(L>E){w|=1<<M;continue}}}var D=7^w;var R=-1;for(var x=0;x<8;++x){if(x===w||x===D){continue}if(R<0){R=x}else if(u[R][1]>u[x][1]){R=x}}var F=-1;for(var x=0;x<3;++x){var B=R^1<<x;if(B===w||B===D){continue}if(F<0){F=B}var S=u[B];if(S[0]<u[F][0]){F=B}}var N=-1;for(var x=0;x<3;++x){var B=R^1<<x;if(B===w||B===D||B===F){continue}if(N<0){N=B}var S=u[B];if(S[0]>u[N][0]){N=B}}var j=d;j[0]=j[1]=j[2]=0;j[a.log2(F^R)]=R&F;j[a.log2(R^N)]=R&N;var U=N^7;if(U===w||U===D){U=F^7;j[a.log2(N^U)]=U&N}else{j[a.log2(F^U)]=U&F}var V=m;var H=w;for(var M=0;M<3;++M){if(H&1<<M){V[M]=-1}else{V[M]=1}}return g}},{"bit-twiddle":104,"gl-mat4/multiply":295,"robust-orientation":534,"split-polygon":552}],256:[function(e,t,r){"use strict";t.exports=d;var a=e("gl-buffer");var n=e("gl-vao");var i=e("./shaders").line;var o=[0,0,0];var s=[0,0,0];var l=[0,0,0];var u=[0,0,0];var c=[1,1];function f(e){e[0]=e[1]=e[2]=0;return e}function h(e,t){e[0]=t[0];e[1]=t[1];e[2]=t[2];return e}function p(e,t,r,a,n,i,o,s){this.gl=e;this.vertBuffer=t;this.vao=r;this.shader=a;this.tickCount=n;this.tickOffset=i;this.gridCount=o;this.gridOffset=s}var v=p.prototype;v.bind=function(e,t,r){this.shader.bind();this.shader.uniforms.model=e;this.shader.uniforms.view=t;this.shader.uniforms.projection=r;c[0]=this.gl.drawingBufferWidth;c[1]=this.gl.drawingBufferHeight;this.shader.uniforms.screenShape=c;this.vao.bind()};v.unbind=function(){this.vao.unbind()};v.drawAxisLine=function(e,t,r,a,n){var i=f(s);this.shader.uniforms.majorAxis=s;i[e]=t[1][e]-t[0][e];this.shader.uniforms.minorAxis=i;var o=h(u,r);o[e]+=t[0][e];this.shader.uniforms.offset=o;this.shader.uniforms.lineWidth=n;this.shader.uniforms.color=a;var c=f(l);c[(e+2)%3]=1;this.shader.uniforms.screenAxis=c;this.vao.draw(this.gl.TRIANGLES,6);var c=f(l);c[(e+1)%3]=1;this.shader.uniforms.screenAxis=c;this.vao.draw(this.gl.TRIANGLES,6)};v.drawAxisTicks=function(e,t,r,a,n){if(!this.tickCount[e]){return}var i=f(o);i[e]=1;this.shader.uniforms.majorAxis=i;this.shader.uniforms.offset=t;this.shader.uniforms.minorAxis=r;this.shader.uniforms.color=a;this.shader.uniforms.lineWidth=n;var s=f(l);s[e]=1;this.shader.uniforms.screenAxis=s;this.vao.draw(this.gl.TRIANGLES,this.tickCount[e],this.tickOffset[e])};v.drawGrid=function(e,t,r,a,n,i){if(!this.gridCount[e]){return}var c=f(s);c[t]=r[1][t]-r[0][t];this.shader.uniforms.minorAxis=c;var p=h(u,a);p[t]+=r[0][t];this.shader.uniforms.offset=p;var v=f(o);v[e]=1;this.shader.uniforms.majorAxis=v;var d=f(l);d[e]=1;this.shader.uniforms.screenAxis=d;this.shader.uniforms.lineWidth=i;this.shader.uniforms.color=n;this.vao.draw(this.gl.TRIANGLES,this.gridCount[e],this.gridOffset[e])};v.drawZero=function(e,t,r,a,n,i){var o=f(s);this.shader.uniforms.majorAxis=o;o[e]=r[1][e]-r[0][e];this.shader.uniforms.minorAxis=o;var c=h(u,a);c[e]+=r[0][e];this.shader.uniforms.offset=c;var p=f(l);p[t]=1;this.shader.uniforms.screenAxis=p;this.shader.uniforms.lineWidth=i;this.shader.uniforms.color=n;this.vao.draw(this.gl.TRIANGLES,6)};v.dispose=function(){this.vao.dispose();this.vertBuffer.dispose();this.shader.dispose()};function d(e,t,r){var o=[];var s=[0,0,0];var l=[0,0,0];var u=[0,0,0];var c=[0,0,0];o.push(0,0,1,0,1,1,0,0,-1,0,0,-1,0,1,1,0,1,-1);for(var f=0;f<3;++f){var h=o.length/3|0;for(var v=0;v<r[f].length;++v){var d=+r[f][v].x;o.push(d,0,1,d,1,1,d,0,-1,d,0,-1,d,1,1,d,1,-1)}var m=o.length/3|0;s[f]=h;l[f]=m-h;var h=o.length/3|0;for(var g=0;g<r[f].length;++g){var d=+r[f][g].x;o.push(d,0,1,d,1,1,d,0,-1,d,0,-1,d,1,1,d,1,-1)}var m=o.length/3|0;u[f]=h;c[f]=m-h}var y=a(e,new Float32Array(o));var x=n(e,[{buffer:y,type:e.FLOAT,size:3,stride:0,offset:0}]);var b=i(e);b.attributes.position.location=0;return new p(e,y,x,b,l,s,c,u)}},{"./shaders":257,"gl-buffer":261,"gl-vao":353}],257:[function(e,t,r){"use strict";var a=e("glslify");var n=e("gl-shader");var i=a(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position;\n\nuniform mat4 model, view, projection;\nuniform vec3 offset, majorAxis, minorAxis, screenAxis;\nuniform float lineWidth;\nuniform vec2 screenShape;\n\nvec3 project(vec3 p) {\n  vec4 pp = projection * view * model * vec4(p, 1.0);\n  return pp.xyz / max(pp.w, 0.0001);\n}\n\nvoid main() {\n  vec3 major = position.x * majorAxis;\n  vec3 minor = position.y * minorAxis;\n\n  vec3 vPosition = major + minor + offset;\n  vec3 pPosition = project(vPosition);\n  vec3 offset = project(vPosition + screenAxis * position.z);\n\n  vec2 screen = normalize((offset - pPosition).xy * screenShape) / screenShape;\n\n  gl_Position = vec4(pPosition + vec3(0.5 * screen * lineWidth, 0), 1.0);\n}\n"]);var o=a(["precision highp float;\n#define GLSLIFY 1\n\nuniform vec4 color;\nvoid main() {\n  gl_FragColor = color;\n}"]);r.line=function(e){return n(e,i,o,null,[{name:"position",type:"vec3"}])};var s=a(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position;\n\nuniform mat4 model, view, projection;\nuniform vec3 offset, axis, alignDir, alignOpt;\nuniform float scale, angle, pixelScale;\nuniform vec2 resolution;\n\nvec3 project(vec3 p) {\n  vec4 pp = projection * view * model * vec4(p, 1.0);\n  return pp.xyz / max(pp.w, 0.0001);\n}\n\nfloat computeViewAngle(vec3 a, vec3 b) {\n  vec3 A = project(a);\n  vec3 B = project(b);\n\n  return atan(\n    (B.y - A.y) * resolution.y,\n    (B.x - A.x) * resolution.x\n  );\n}\n\nconst float PI = 3.141592;\nconst float TWO_PI = 2.0 * PI;\nconst float HALF_PI = 0.5 * PI;\nconst float ONE_AND_HALF_PI = 1.5 * PI;\n\nint option = int(floor(alignOpt.x + 0.001));\nfloat hv_ratio =       alignOpt.y;\nbool enableAlign =    (alignOpt.z != 0.0);\n\nfloat mod_angle(float a) {\n  return mod(a, PI);\n}\n\nfloat positive_angle(float a) {\n  return mod_angle((a < 0.0) ?\n    a + TWO_PI :\n    a\n  );\n}\n\nfloat look_upwards(float a) {\n  float b = positive_angle(a);\n  return ((b > HALF_PI) && (b <= ONE_AND_HALF_PI)) ?\n    b - PI :\n    b;\n}\n\nfloat look_horizontal_or_vertical(float a, float ratio) {\n  // ratio controls the ratio between being horizontal to (vertical + horizontal)\n  // if ratio is set to 0.5 then it is 50%, 50%.\n  // when using a higher ratio e.g. 0.75 the result would\n  // likely be more horizontal than vertical.\n\n  float b = positive_angle(a);\n\n  return\n    (b < (      ratio) * HALF_PI) ? 0.0 :\n    (b < (2.0 - ratio) * HALF_PI) ? -HALF_PI :\n    (b < (2.0 + ratio) * HALF_PI) ? 0.0 :\n    (b < (4.0 - ratio) * HALF_PI) ? HALF_PI :\n                                    0.0;\n}\n\nfloat roundTo(float a, float b) {\n  return float(b * floor((a + 0.5 * b) / b));\n}\n\nfloat look_round_n_directions(float a, int n) {\n  float b = positive_angle(a);\n  float div = TWO_PI / float(n);\n  float c = roundTo(b, div);\n  return look_upwards(c);\n}\n\nfloat applyAlignOption(float rawAngle, float delta) {\n  return\n    (option >  2) ? look_round_n_directions(rawAngle + delta, option) :       // option 3-n: round to n directions\n    (option == 2) ? look_horizontal_or_vertical(rawAngle + delta, hv_ratio) : // horizontal or vertical\n    (option == 1) ? rawAngle + delta :       // use free angle, and flip to align with one direction of the axis\n    (option == 0) ? look_upwards(rawAngle) : // use free angle, and stay upwards\n    (option ==-1) ? 0.0 :                    // useful for backward compatibility, all texts remains horizontal\n                    rawAngle;                // otherwise return back raw input angle\n}\n\nbool isAxisTitle = (axis.x == 0.0) &&\n                   (axis.y == 0.0) &&\n                   (axis.z == 0.0);\n\nvoid main() {\n  //Compute world offset\n  float axisDistance = position.z;\n  vec3 dataPosition = axisDistance * axis + offset;\n\n  float beta = angle; // i.e. user defined attributes for each tick\n\n  float axisAngle;\n  float clipAngle;\n  float flip;\n\n  if (enableAlign) {\n    axisAngle = (isAxisTitle) ? HALF_PI :\n                      computeViewAngle(dataPosition, dataPosition + axis);\n    clipAngle = computeViewAngle(dataPosition, dataPosition + alignDir);\n\n    axisAngle += (sin(axisAngle) < 0.0) ? PI : 0.0;\n    clipAngle += (sin(clipAngle) < 0.0) ? PI : 0.0;\n\n    flip = (dot(vec2(cos(axisAngle), sin(axisAngle)),\n                vec2(sin(clipAngle),-cos(clipAngle))) > 0.0) ? 1.0 : 0.0;\n\n    beta += applyAlignOption(clipAngle, flip * PI);\n  }\n\n  //Compute plane offset\n  vec2 planeCoord = position.xy * pixelScale;\n\n  mat2 planeXform = scale * mat2(\n     cos(beta), sin(beta),\n    -sin(beta), cos(beta)\n  );\n\n  vec2 viewOffset = 2.0 * planeXform * planeCoord / resolution;\n\n  //Compute clip position\n  vec3 clipPosition = project(dataPosition);\n\n  //Apply text offset in clip coordinates\n  clipPosition += vec3(viewOffset, 0.0);\n\n  //Done\n  gl_Position = vec4(clipPosition, 1.0);\n}"]);var l=a(["precision highp float;\n#define GLSLIFY 1\n\nuniform vec4 color;\nvoid main() {\n  gl_FragColor = color;\n}"]);r.text=function(e){return n(e,s,l,null,[{name:"position",type:"vec3"}])};var u=a(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position;\nattribute vec3 normal;\n\nuniform mat4 model, view, projection;\nuniform vec3 enable;\nuniform vec3 bounds[2];\n\nvarying vec3 colorChannel;\n\nvoid main() {\n\n  vec3 signAxis = sign(bounds[1] - bounds[0]);\n\n  vec3 realNormal = signAxis * normal;\n\n  if(dot(realNormal, enable) > 0.0) {\n    vec3 minRange = min(bounds[0], bounds[1]);\n    vec3 maxRange = max(bounds[0], bounds[1]);\n    vec3 nPosition = mix(minRange, maxRange, 0.5 * (position + 1.0));\n    gl_Position = projection * view * model * vec4(nPosition, 1.0);\n  } else {\n    gl_Position = vec4(0,0,0,0);\n  }\n\n  colorChannel = abs(realNormal);\n}"]);var c=a(["precision highp float;\n#define GLSLIFY 1\n\nuniform vec4 colors[3];\n\nvarying vec3 colorChannel;\n\nvoid main() {\n  gl_FragColor = colorChannel.x * colors[0] +\n                 colorChannel.y * colors[1] +\n                 colorChannel.z * colors[2];\n}"]);r.bg=function(e){return n(e,u,c,null,[{name:"position",type:"vec3"},{name:"normal",type:"vec3"}])}},{"gl-shader":332,glslify:434}],258:[function(e,t,r){(function(r){(function(){"use strict";t.exports=v;var a=e("gl-buffer");var n=e("gl-vao");var i=e("vectorize-text");var o=e("./shaders").text;var s=window||r.global||{};var l=s.__TEXT_CACHE||{};s.__TEXT_CACHE={};var u=3;function c(e,t,r,a){this.gl=e;this.shader=t;this.buffer=r;this.vao=a;this.tickOffset=this.tickCount=this.labelOffset=this.labelCount=null}var f=c.prototype;var h=[0,0];f.bind=function(e,t,r,a){this.vao.bind();this.shader.bind();var n=this.shader.uniforms;n.model=e;n.view=t;n.projection=r;n.pixelScale=a;h[0]=this.gl.drawingBufferWidth;h[1]=this.gl.drawingBufferHeight;this.shader.uniforms.resolution=h};f.unbind=function(){this.vao.unbind()};f.update=function(e,t,r,a,n){var i=[];function o(e,t,r,a,n,o){var s=l[r];if(!s){s=l[r]={}}var u=s[t];if(!u){u=s[t]=p(t,{triangles:true,font:r,textAlign:"center",textBaseline:"middle",lineSpacing:n,styletags:o})}var c=(a||12)/12;var f=u.positions;var h=u.cells;for(var v=0,d=h.length;v<d;++v){var m=h[v];for(var g=2;g>=0;--g){var y=f[m[g]];i.push(c*y[0],-c*y[1],e)}}}var s=[0,0,0];var c=[0,0,0];var f=[0,0,0];var h=[0,0,0];var v=1.25;var d={breaklines:true,bolds:true,italics:true,subscripts:true,superscripts:true};for(var m=0;m<3;++m){f[m]=i.length/u|0;o(.5*(e[0][m]+e[1][m]),t[m],r[m],12,v,d);h[m]=(i.length/u|0)-f[m];s[m]=i.length/u|0;for(var g=0;g<a[m].length;++g){if(!a[m][g].text){continue}o(a[m][g].x,a[m][g].text,a[m][g].font||n,a[m][g].fontSize||12,v,d)}c[m]=(i.length/u|0)-s[m]}this.buffer.update(i);this.tickOffset=s;this.tickCount=c;this.labelOffset=f;this.labelCount=h};f.drawTicks=function(e,t,r,a,n,i,o,s){if(!this.tickCount[e]){return}this.shader.uniforms.axis=i;this.shader.uniforms.color=n;this.shader.uniforms.angle=r;this.shader.uniforms.scale=t;this.shader.uniforms.offset=a;this.shader.uniforms.alignDir=o;this.shader.uniforms.alignOpt=s;this.vao.draw(this.gl.TRIANGLES,this.tickCount[e],this.tickOffset[e])};f.drawLabel=function(e,t,r,a,n,i,o,s){if(!this.labelCount[e]){return}this.shader.uniforms.axis=i;this.shader.uniforms.color=n;this.shader.uniforms.angle=r;this.shader.uniforms.scale=t;this.shader.uniforms.offset=a;this.shader.uniforms.alignDir=o;this.shader.uniforms.alignOpt=s;this.vao.draw(this.gl.TRIANGLES,this.labelCount[e],this.labelOffset[e])};f.dispose=function(){this.shader.dispose();this.vao.dispose();this.buffer.dispose()};function p(e,t){try{return i(e,t)}catch(r){console.warn('error vectorizing text:"'+e+'" error:',r);return{cells:[],positions:[]}}}function v(e,t,r,i,s,l){var u=a(e);var f=n(e,[{buffer:u,size:3}]);var h=o(e);h.attributes.position.location=0;var p=new c(e,h,u,f);p.update(t,r,i,s,l);return p}}).call(this)}).call(this,e("_process"))},{"./shaders":257,_process:514,"gl-buffer":261,"gl-vao":353,"vectorize-text":607}],259:[function(e,t,r){"use strict";r.create=n;r.equal=i;function a(e,t){var r=e+"";var a=r.indexOf(".");var n=0;if(a>=0){n=r.length-a-1}var i=Math.pow(10,n);var o=Math.round(e*t*i);var s=o+"";if(s.indexOf("e")>=0){return s}var l=o/i,u=o%i;if(o<0){l=-Math.ceil(l)|0;u=-u|0}else{l=Math.floor(l)|0;u=u|0}var c=""+l;if(o<0){c="-"+c}if(n){var f=""+u;while(f.length<n){f="0"+f}return c+"."+f}else{return c}}function n(e,t){var r=[];for(var n=0;n<3;++n){var i=[];var o=.5*(e[0][n]+e[1][n]);for(var s=0;s*t[n]<=e[1][n];++s){i.push({x:s*t[n],text:a(t[n],s)})}for(var s=-1;s*t[n]>=e[0][n];--s){i.push({x:s*t[n],text:a(t[n],s)})}r.push(i)}return r}function i(e,t){for(var r=0;r<3;++r){if(e[r].length!==t[r].length){return false}for(var a=0;a<e[r].length;++a){var n=e[r][a];var i=t[r][a];if(n.x!==i.x||n.text!==i.text||n.font!==i.font||n.fontColor!==i.fontColor||n.fontSize!==i.fontSize||n.dx!==i.dx||n.dy!==i.dy){return false}}}return true}},{}],260:[function(e,t,r){"use strict";t.exports=g;var a=e("extract-frustum-planes");var n=e("split-polygon");var i=e("./lib/cube.js");var o=e("gl-mat4/multiply");var s=e("gl-mat4/transpose");var l=e("gl-vec4/transformMat4");var u=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);var c=new Float32Array(16);function f(e,t,r){this.lo=e;this.hi=t;this.pixelsPerDataUnit=r}var h=[0,0,0,1];var p=[0,0,0,1];function v(e,t,r,a,n){for(var i=0;i<3;++i){var o=h;var s=p;for(var u=0;u<3;++u){s[u]=o[u]=r[u]}s[3]=o[3]=1;s[i]+=1;l(s,s,t);if(s[3]<0){e[i]=Infinity}o[i]-=1;l(o,o,t);if(o[3]<0){e[i]=Infinity}var c=(o[0]/o[3]-s[0]/s[3])*a;var f=(o[1]/o[3]-s[1]/s[3])*n;e[i]=.25*Math.sqrt(c*c+f*f)}return e}var d=[new f(Infinity,-Infinity,Infinity),new f(Infinity,-Infinity,Infinity),new f(Infinity,-Infinity,Infinity)];var m=[0,0,0];function g(e,t,r,l,f){var h=t.model||u;var p=t.view||u;var g=t.projection||u;var y=t._ortho||false;var x=e.bounds;var f=f||i(h,p,g,x,y);var b=f.axis;o(c,p,h);o(c,g,c);var _=d;for(var w=0;w<3;++w){_[w].lo=Infinity;_[w].hi=-Infinity;_[w].pixelsPerDataUnit=Infinity}var T=a(s(c,c));s(c,c);for(var k=0;k<3;++k){var M=(k+1)%3;var A=(k+2)%3;var S=m;e:for(var w=0;w<2;++w){var E=[];if(b[k]<0===!!w){continue}S[k]=x[w][k];for(var L=0;L<2;++L){S[M]=x[L^w][M];for(var C=0;C<2;++C){S[A]=x[C^L^w][A];E.push(S.slice())}}var I=y?5:4;for(var L=I;L===I;++L){if(E.length===0){continue e}E=n.positive(E,T[L])}for(var L=0;L<E.length;++L){var A=E[L];var P=v(m,c,A,r,l);for(var C=0;C<3;++C){_[C].lo=Math.min(_[C].lo,A[C]);_[C].hi=Math.max(_[C].hi,A[C]);if(C!==k){_[C].pixelsPerDataUnit=Math.min(_[C].pixelsPerDataUnit,Math.abs(P[C]))}}}}}return _}},{"./lib/cube.js":255,"extract-frustum-planes":245,"gl-mat4/multiply":295,"gl-mat4/transpose":306,"gl-vec4/transformMat4":424,"split-polygon":552}],261:[function(e,t,r){"use strict";var a=e("typedarray-pool");var n=e("ndarray-ops");var i=e("ndarray");var o=["uint8","uint8_clamped","uint16","uint32","int8","int16","int32","float32"];function s(e,t,r,a,n){this.gl=e;this.type=t;this.handle=r;this.length=a;this.usage=n}var l=s.prototype;l.bind=function(){this.gl.bindBuffer(this.type,this.handle)};l.unbind=function(){this.gl.bindBuffer(this.type,null)};l.dispose=function(){this.gl.deleteBuffer(this.handle)};function u(e,t,r,a,n,i){var o=n.length*n.BYTES_PER_ELEMENT;if(i<0){e.bufferData(t,n,a);return o}if(o+i>r){throw new Error("gl-buffer: If resizing buffer, must not specify offset")}e.bufferSubData(t,i,n);return r}function c(e,t){var r=a.malloc(e.length,t);var n=e.length;for(var i=0;i<n;++i){r[i]=e[i]}return r}function f(e,t){var r=1;for(var a=t.length-1;a>=0;--a){if(t[a]!==r){return false}r*=e[a]}return true}l.update=function(e,t){if(typeof t!=="number"){t=-1}this.bind();if(typeof e==="object"&&typeof e.shape!=="undefined"){var r=e.dtype;if(o.indexOf(r)<0){r="float32"}if(this.type===this.gl.ELEMENT_ARRAY_BUFFER){var s=gl.getExtension("OES_element_index_uint");if(s&&r!=="uint16"){r="uint32"}else{r="uint16"}}if(r===e.dtype&&f(e.shape,e.stride)){if(e.offset===0&&e.data.length===e.shape[0]){this.length=u(this.gl,this.type,this.length,this.usage,e.data,t)}else{this.length=u(this.gl,this.type,this.length,this.usage,e.data.subarray(e.offset,e.shape[0]),t)}}else{var l=a.malloc(e.size,r);var h=i(l,e.shape);n.assign(h,e);if(t<0){this.length=u(this.gl,this.type,this.length,this.usage,l,t)}else{this.length=u(this.gl,this.type,this.length,this.usage,l.subarray(0,e.size),t)}a.free(l)}}else if(Array.isArray(e)){var p;if(this.type===this.gl.ELEMENT_ARRAY_BUFFER){p=c(e,"uint16")}else{p=c(e,"float32")}if(t<0){this.length=u(this.gl,this.type,this.length,this.usage,p,t)}else{this.length=u(this.gl,this.type,this.length,this.usage,p.subarray(0,e.length),t)}a.free(p)}else if(typeof e==="object"&&typeof e.length==="number"){this.length=u(this.gl,this.type,this.length,this.usage,e,t)}else if(typeof e==="number"||e===undefined){if(t>=0){throw new Error("gl-buffer: Cannot specify offset when resizing buffer")}e=e|0;if(e<=0){e=1}this.gl.bufferData(this.type,e|0,this.usage);this.length=e}else{throw new Error("gl-buffer: Invalid data type")}};function h(e,t,r,a){r=r||e.ARRAY_BUFFER;a=a||e.DYNAMIC_DRAW;if(r!==e.ARRAY_BUFFER&&r!==e.ELEMENT_ARRAY_BUFFER){throw new Error("gl-buffer: Invalid type for webgl buffer, must be either gl.ARRAY_BUFFER or gl.ELEMENT_ARRAY_BUFFER")}if(a!==e.DYNAMIC_DRAW&&a!==e.STATIC_DRAW&&a!==e.STREAM_DRAW){throw new Error("gl-buffer: Invalid usage for buffer, must be either gl.DYNAMIC_DRAW, gl.STATIC_DRAW or gl.STREAM_DRAW")}var n=e.createBuffer();var i=new s(e,r,n,0,a);i.update(t);return i}t.exports=h},{ndarray:472,"ndarray-ops":467,"typedarray-pool":601}],262:[function(e,t,r){"use strict";var a=e("gl-vec3");t.exports=function(e,t){var r=e.positions;var n=e.vectors;var i={positions:[],vertexIntensity:[],vertexIntensityBounds:e.vertexIntensityBounds,vectors:[],cells:[],coneOffset:e.coneOffset,colormap:e.colormap};if(e.positions.length===0){if(t){t[0]=[0,0,0];t[1]=[0,0,0]}return i}var o=0;var s=Infinity,l=-Infinity;var u=Infinity,c=-Infinity;var f=Infinity,h=-Infinity;var p=null;var v=null;var d=[];var m=Infinity;var g=false;for(var y=0;y<r.length;y++){var x=r[y];s=Math.min(x[0],s);l=Math.max(x[0],l);u=Math.min(x[1],u);c=Math.max(x[1],c);f=Math.min(x[2],f);h=Math.max(x[2],h);var b=n[y];if(a.length(b)>o){o=a.length(b)}if(y){var _=2*a.distance(p,x)/(a.length(v)+a.length(b));if(_){m=Math.min(m,_);g=false}else{g=true}}if(!g){p=x;v=b}d.push(b)}var w=[s,u,f];var T=[l,c,h];if(t){t[0]=w;t[1]=T}if(o===0){o=1}var k=1/o;if(!isFinite(m)){m=1}i.vectorScale=m;var M=e.coneSize||.5;if(e.absoluteConeSize){M=e.absoluteConeSize*k}i.coneScale=M;for(var y=0,A=0;y<r.length;y++){var x=r[y];var S=x[0],E=x[1],L=x[2];var C=d[y];var I=a.length(C)*k;for(var P=0,O=8;P<O;P++){i.positions.push([S,E,L,A++]);i.positions.push([S,E,L,A++]);i.positions.push([S,E,L,A++]);i.positions.push([S,E,L,A++]);i.positions.push([S,E,L,A++]);i.positions.push([S,E,L,A++]);i.vectors.push(C);i.vectors.push(C);i.vectors.push(C);i.vectors.push(C);i.vectors.push(C);i.vectors.push(C);i.vertexIntensity.push(I,I,I);i.vertexIntensity.push(I,I,I);var z=i.positions.length;i.cells.push([z-6,z-5,z-4],[z-3,z-2,z-1])}}return i};var n=e("./lib/shaders");t.exports.createMesh=e("./create_mesh");t.exports.createConeMesh=function(e,r){return t.exports.createMesh(e,r,{shaders:n,traceType:"cone"})}},{"./create_mesh":263,"./lib/shaders":264,"gl-vec3":372}],263:[function(e,t,r){"use strict";var a=e("gl-shader");var n=e("gl-buffer");var i=e("gl-vao");var o=e("gl-texture2d");var s=e("gl-mat4/multiply");var l=e("gl-mat4/invert");var u=e("ndarray");var c=e("colormap");var f=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function h(e,t,r,a,n,i,o,s,l,u,c){this.gl=e;this.pixelRatio=1;this.cells=[];this.positions=[];this.intensity=[];this.texture=t;this.dirty=true;this.triShader=r;this.pickShader=a;this.trianglePositions=n;this.triangleVectors=i;this.triangleColors=s;this.triangleUVs=l;this.triangleIds=o;this.triangleVAO=u;this.triangleCount=0;this.pickId=1;this.bounds=[[Infinity,Infinity,Infinity],[-Infinity,-Infinity,-Infinity]];this.clipBounds=[[-Infinity,-Infinity,-Infinity],[Infinity,Infinity,Infinity]];this.lightPosition=[1e5,1e5,0];this.ambientLight=.8;this.diffuseLight=.8;this.specularLight=2;this.roughness=.5;this.fresnel=1.5;this.opacity=1;this.traceType=c;this.tubeScale=1;this.coneScale=2;this.vectorScale=1;this.coneOffset=.25;this._model=f;this._view=f;this._projection=f;this._resolution=[1,1]}var p=h.prototype;p.isOpaque=function(){return this.opacity>=1};p.isTransparent=function(){return this.opacity<1};p.pickSlots=1;p.setPickBase=function(e){this.pickId=e};function v(e){var t=c({colormap:e,nshades:256,format:"rgba"});var r=new Uint8Array(256*4);for(var a=0;a<256;++a){var n=t[a];for(var i=0;i<3;++i){r[4*a+i]=n[i]}r[4*a+3]=n[3]*255}return u(r,[256,256,4],[4,0,1])}function d(e){var t=e.length;var r=new Array(t);for(var a=0;a<t;++a){r[a]=e[a][2]}return r}p.update=function(e){e=e||{};var t=this.gl;this.dirty=true;if("lightPosition"in e){this.lightPosition=e.lightPosition}if("opacity"in e){this.opacity=e.opacity}if("ambient"in e){this.ambientLight=e.ambient}if("diffuse"in e){this.diffuseLight=e.diffuse}if("specular"in e){this.specularLight=e.specular}if("roughness"in e){this.roughness=e.roughness}if("fresnel"in e){this.fresnel=e.fresnel}if(e.tubeScale!==undefined){this.tubeScale=e.tubeScale}if(e.vectorScale!==undefined){this.vectorScale=e.vectorScale}if(e.coneScale!==undefined){this.coneScale=e.coneScale}if(e.coneOffset!==undefined){this.coneOffset=e.coneOffset}if(e.colormap){this.texture.shape=[256,256];this.texture.minFilter=t.LINEAR_MIPMAP_LINEAR;this.texture.magFilter=t.LINEAR;this.texture.setPixels(v(e.colormap));this.texture.generateMipmap()}var r=e.cells;var a=e.positions;var n=e.vectors;if(!a||!r||!n){return}var i=[];var o=[];var s=[];var l=[];var u=[];this.cells=r;this.positions=a;this.vectors=n;var c=e.meshColor||[1,1,1,1];var f=e.vertexIntensity;var h=Infinity;var p=-Infinity;if(f){if(e.vertexIntensityBounds){h=+e.vertexIntensityBounds[0];p=+e.vertexIntensityBounds[1]}else{for(var m=0;m<f.length;++m){var g=f[m];h=Math.min(h,g);p=Math.max(p,g)}}}else{for(var m=0;m<a.length;++m){var g=a[m][2];h=Math.min(h,g);p=Math.max(p,g)}}if(f){this.intensity=f}else{this.intensity=d(a)}this.bounds=[[Infinity,Infinity,Infinity],[-Infinity,-Infinity,-Infinity]];for(var m=0;m<a.length;++m){var y=a[m];for(var x=0;x<3;++x){if(isNaN(y[x])||!isFinite(y[x])){continue}this.bounds[0][x]=Math.min(this.bounds[0][x],y[x]);this.bounds[1][x]=Math.max(this.bounds[1][x],y[x])}}var b=0;e:for(var m=0;m<r.length;++m){var _=r[m];switch(_.length){case 3:for(var x=0;x<3;++x){var w=_[x];var y=a[w];for(var T=0;T<3;++T){if(isNaN(y[T])||!isFinite(y[T])){continue e}}}for(var x=0;x<3;++x){var w=_[2-x];var y=a[w];i.push(y[0],y[1],y[2],y[3]);var k=n[w];o.push(k[0],k[1],k[2],k[3]||0);var M=c;if(M.length===3){s.push(M[0],M[1],M[2],1)}else{s.push(M[0],M[1],M[2],M[3])}var A;if(f){A=[(f[w]-h)/(p-h),0]}else{A=[(y[2]-h)/(p-h),0]}l.push(A[0],A[1]);u.push(m)}b+=1;break;default:break}}this.triangleCount=b;this.trianglePositions.update(i);this.triangleVectors.update(o);this.triangleColors.update(s);this.triangleUVs.update(l);this.triangleIds.update(new Uint32Array(u))};p.drawTransparent=p.draw=function(e){e=e||{};var t=this.gl;var r=e.model||f;var a=e.view||f;var n=e.projection||f;var i=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]];for(var o=0;o<3;++o){i[0][o]=Math.max(i[0][o],this.clipBounds[0][o]);i[1][o]=Math.min(i[1][o],this.clipBounds[1][o])}var u={model:r,view:a,projection:n,inverseModel:f.slice(),clipBounds:i,kambient:this.ambientLight,kdiffuse:this.diffuseLight,kspecular:this.specularLight,roughness:this.roughness,fresnel:this.fresnel,eyePosition:[0,0,0],lightPosition:[0,0,0],opacity:this.opacity,tubeScale:this.tubeScale,vectorScale:this.vectorScale,coneScale:this.coneScale,coneOffset:this.coneOffset,texture:0};u.inverseModel=l(u.inverseModel,u.model);t.disable(t.CULL_FACE);this.texture.bind(0);var c=new Array(16);s(c,u.view,u.model);s(c,u.projection,c);l(c,c);for(var o=0;o<3;++o){u.eyePosition[o]=c[12+o]/c[15]}var h=c[15];for(var o=0;o<3;++o){h+=this.lightPosition[o]*c[4*o+3]}for(var o=0;o<3;++o){var p=c[12+o];for(var v=0;v<3;++v){p+=c[4*v+o]*this.lightPosition[v]}u.lightPosition[o]=p/h}if(this.triangleCount>0){var d=this.triShader;d.bind();d.uniforms=u;this.triangleVAO.bind();t.drawArrays(t.TRIANGLES,0,this.triangleCount*3);this.triangleVAO.unbind()}};p.drawPick=function(e){e=e||{};var t=this.gl;var r=e.model||f;var a=e.view||f;var n=e.projection||f;var i=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]];for(var o=0;o<3;++o){i[0][o]=Math.max(i[0][o],this.clipBounds[0][o]);i[1][o]=Math.min(i[1][o],this.clipBounds[1][o])}this._model=[].slice.call(r);this._view=[].slice.call(a);this._projection=[].slice.call(n);this._resolution=[t.drawingBufferWidth,t.drawingBufferHeight];var s={model:r,view:a,projection:n,clipBounds:i,tubeScale:this.tubeScale,vectorScale:this.vectorScale,coneScale:this.coneScale,coneOffset:this.coneOffset,pickId:this.pickId/255};var l=this.pickShader;l.bind();l.uniforms=s;if(this.triangleCount>0){this.triangleVAO.bind();t.drawArrays(t.TRIANGLES,0,this.triangleCount*3);this.triangleVAO.unbind()}};p.pick=function(e){if(!e){return null}if(e.id!==this.pickId){return null}var t=e.value[0]+256*e.value[1]+65536*e.value[2];var r=this.cells[t];var a=this.positions[r[1]].slice(0,3);var n={position:a,dataCoordinate:a,index:Math.floor(r[1]/48)};if(this.traceType==="cone"){n.index=Math.floor(r[1]/48)}else if(this.traceType==="streamtube"){n.intensity=this.intensity[r[1]];n.velocity=this.vectors[r[1]].slice(0,3);n.divergence=this.vectors[r[1]][3];n.index=t}return n};p.dispose=function(){this.texture.dispose();this.triShader.dispose();this.pickShader.dispose();this.triangleVAO.dispose();this.trianglePositions.dispose();this.triangleVectors.dispose();this.triangleColors.dispose();this.triangleUVs.dispose();this.triangleIds.dispose()};function m(e,t){var r=a(e,t.meshShader.vertex,t.meshShader.fragment,null,t.meshShader.attributes);r.attributes.position.location=0;r.attributes.color.location=2;r.attributes.uv.location=3;r.attributes.vector.location=4;return r}function g(e,t){var r=a(e,t.pickShader.vertex,t.pickShader.fragment,null,t.pickShader.attributes);r.attributes.position.location=0;r.attributes.id.location=1;r.attributes.vector.location=4;return r}function y(e,t,r){var a=r.shaders;if(arguments.length===1){t=e;e=t.gl}var s=m(e,a);var l=g(e,a);var c=o(e,u(new Uint8Array([255,255,255,255]),[1,1,4]));c.generateMipmap();c.minFilter=e.LINEAR_MIPMAP_LINEAR;c.magFilter=e.LINEAR;var f=n(e);var p=n(e);var v=n(e);var d=n(e);var y=n(e);var x=i(e,[{buffer:f,type:e.FLOAT,size:4},{buffer:y,type:e.UNSIGNED_BYTE,size:4,normalized:true},{buffer:v,type:e.FLOAT,size:4},{buffer:d,type:e.FLOAT,size:2},{buffer:p,type:e.FLOAT,size:4}]);var b=new h(e,c,s,l,f,p,y,v,d,x,r.traceType||"cone");b.update(t);return b}t.exports=y},{colormap:137,"gl-buffer":261,"gl-mat4/invert":293,"gl-mat4/multiply":295,"gl-shader":332,"gl-texture2d":348,"gl-vao":353,ndarray:472}],264:[function(e,t,r){var a=e("glslify");var n=a(["precision highp float;\n\nprecision highp float;\n#define GLSLIFY 1\n\nvec3 getOrthogonalVector(vec3 v) {\n  // Return up-vector for only-z vector.\n  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).\n  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.\n  // Assign z = 0, x = -b, y = a:\n  // a*-b + b*a + c*0 = -ba + ba + 0 = 0\n  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {\n    return normalize(vec3(-v.y, v.x, 0.0));\n  } else {\n    return normalize(vec3(0.0, v.z, -v.y));\n  }\n}\n\n// Calculate the cone vertex and normal at the given index.\n//\n// The returned vertex is for a cone with its top at origin and height of 1.0,\n// pointing in the direction of the vector attribute.\n//\n// Each cone is made up of a top vertex, a center base vertex and base perimeter vertices.\n// These vertices are used to make up the triangles of the cone by the following:\n//   segment + 0 top vertex\n//   segment + 1 perimeter vertex a+1\n//   segment + 2 perimeter vertex a\n//   segment + 3 center base vertex\n//   segment + 4 perimeter vertex a\n//   segment + 5 perimeter vertex a+1\n// Where segment is the number of the radial segment * 6 and a is the angle at that radial segment.\n// To go from index to segment, floor(index / 6)\n// To go from segment to angle, 2*pi * (segment/segmentCount)\n// To go from index to segment index, index - (segment*6)\n//\nvec3 getConePosition(vec3 d, float rawIndex, float coneOffset, out vec3 normal) {\n\n  const float segmentCount = 8.0;\n\n  float index = rawIndex - floor(rawIndex /\n    (segmentCount * 6.0)) *\n    (segmentCount * 6.0);\n\n  float segment = floor(0.001 + index/6.0);\n  float segmentIndex = index - (segment*6.0);\n\n  normal = -normalize(d);\n\n  if (segmentIndex > 2.99 && segmentIndex < 3.01) {\n    return mix(vec3(0.0), -d, coneOffset);\n  }\n\n  float nextAngle = (\n    (segmentIndex > 0.99 &&  segmentIndex < 1.01) ||\n    (segmentIndex > 4.99 &&  segmentIndex < 5.01)\n  ) ? 1.0 : 0.0;\n  float angle = 2.0 * 3.14159 * ((segment + nextAngle) / segmentCount);\n\n  vec3 v1 = mix(d, vec3(0.0), coneOffset);\n  vec3 v2 = v1 - d;\n\n  vec3 u = getOrthogonalVector(d);\n  vec3 v = normalize(cross(u, d));\n\n  vec3 x = u * cos(angle) * length(d)*0.25;\n  vec3 y = v * sin(angle) * length(d)*0.25;\n  vec3 v3 = v2 + x + y;\n  if (segmentIndex < 3.0) {\n    vec3 tx = u * sin(angle);\n    vec3 ty = v * -cos(angle);\n    vec3 tangent = tx + ty;\n    normal = normalize(cross(v3 - v1, tangent));\n  }\n\n  if (segmentIndex == 0.0) {\n    return mix(d, vec3(0.0), coneOffset);\n  }\n  return v3;\n}\n\nattribute vec3 vector;\nattribute vec4 color, position;\nattribute vec2 uv;\n\nuniform float vectorScale, coneScale, coneOffset;\nuniform mat4 model, view, projection, inverseModel;\nuniform vec3 eyePosition, lightPosition;\n\nvarying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  // Scale the vector magnitude to stay constant with\n  // model & view changes.\n  vec3 normal;\n  vec3 XYZ = getConePosition(mat3(model) * ((vectorScale * coneScale) * vector), position.w, coneOffset, normal);\n  vec4 conePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);\n\n  //Lighting geometry parameters\n  vec4 cameraCoordinate = view * conePosition;\n  cameraCoordinate.xyz /= cameraCoordinate.w;\n  f_lightDirection = lightPosition - cameraCoordinate.xyz;\n  f_eyeDirection   = eyePosition - cameraCoordinate.xyz;\n  f_normal = normalize((vec4(normal, 0.0) * inverseModel).xyz);\n\n  // vec4 m_position  = model * vec4(conePosition, 1.0);\n  vec4 t_position  = view * conePosition;\n  gl_Position      = projection * t_position;\n\n  f_color          = color;\n  f_data           = conePosition.xyz;\n  f_position       = position.xyz;\n  f_uv             = uv;\n}\n"]);var i=a(["#extension GL_OES_standard_derivatives : enable\n\nprecision highp float;\n#define GLSLIFY 1\n\nfloat beckmannDistribution(float x, float roughness) {\n  float NdotH = max(x, 0.0001);\n  float cos2Alpha = NdotH * NdotH;\n  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;\n  float roughness2 = roughness * roughness;\n  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;\n  return exp(tan2Alpha / roughness2) / denom;\n}\n\nfloat cookTorranceSpecular(\n  vec3 lightDirection,\n  vec3 viewDirection,\n  vec3 surfaceNormal,\n  float roughness,\n  float fresnel) {\n\n  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);\n  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);\n\n  //Half angle vector\n  vec3 H = normalize(lightDirection + viewDirection);\n\n  //Geometric term\n  float NdotH = max(dot(surfaceNormal, H), 0.0);\n  float VdotH = max(dot(viewDirection, H), 0.000001);\n  float LdotH = max(dot(lightDirection, H), 0.000001);\n  float G1 = (2.0 * NdotH * VdotN) / VdotH;\n  float G2 = (2.0 * NdotH * LdotN) / LdotH;\n  float G = min(1.0, min(G1, G2));\n  \n  //Distribution term\n  float D = beckmannDistribution(NdotH, roughness);\n\n  //Fresnel term\n  float F = pow(1.0 - VdotN, fresnel);\n\n  //Multiply terms and done\n  return  G * F * D / max(3.14159265 * VdotN, 0.000001);\n}\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 clipBounds[2];\nuniform float roughness, fresnel, kambient, kdiffuse, kspecular, opacity;\nuniform sampler2D texture;\n\nvarying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;\n  vec3 N = normalize(f_normal);\n  vec3 L = normalize(f_lightDirection);\n  vec3 V = normalize(f_eyeDirection);\n\n  if(gl_FrontFacing) {\n    N = -N;\n  }\n\n  float specular = min(1.0, max(0.0, cookTorranceSpecular(L, V, N, roughness, fresnel)));\n  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);\n\n  vec4 surfaceColor = f_color * texture2D(texture, f_uv);\n  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);\n\n  gl_FragColor = litColor * opacity;\n}\n"]);var o=a(["precision highp float;\n\nprecision highp float;\n#define GLSLIFY 1\n\nvec3 getOrthogonalVector(vec3 v) {\n  // Return up-vector for only-z vector.\n  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).\n  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.\n  // Assign z = 0, x = -b, y = a:\n  // a*-b + b*a + c*0 = -ba + ba + 0 = 0\n  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {\n    return normalize(vec3(-v.y, v.x, 0.0));\n  } else {\n    return normalize(vec3(0.0, v.z, -v.y));\n  }\n}\n\n// Calculate the cone vertex and normal at the given index.\n//\n// The returned vertex is for a cone with its top at origin and height of 1.0,\n// pointing in the direction of the vector attribute.\n//\n// Each cone is made up of a top vertex, a center base vertex and base perimeter vertices.\n// These vertices are used to make up the triangles of the cone by the following:\n//   segment + 0 top vertex\n//   segment + 1 perimeter vertex a+1\n//   segment + 2 perimeter vertex a\n//   segment + 3 center base vertex\n//   segment + 4 perimeter vertex a\n//   segment + 5 perimeter vertex a+1\n// Where segment is the number of the radial segment * 6 and a is the angle at that radial segment.\n// To go from index to segment, floor(index / 6)\n// To go from segment to angle, 2*pi * (segment/segmentCount)\n// To go from index to segment index, index - (segment*6)\n//\nvec3 getConePosition(vec3 d, float rawIndex, float coneOffset, out vec3 normal) {\n\n  const float segmentCount = 8.0;\n\n  float index = rawIndex - floor(rawIndex /\n    (segmentCount * 6.0)) *\n    (segmentCount * 6.0);\n\n  float segment = floor(0.001 + index/6.0);\n  float segmentIndex = index - (segment*6.0);\n\n  normal = -normalize(d);\n\n  if (segmentIndex > 2.99 && segmentIndex < 3.01) {\n    return mix(vec3(0.0), -d, coneOffset);\n  }\n\n  float nextAngle = (\n    (segmentIndex > 0.99 &&  segmentIndex < 1.01) ||\n    (segmentIndex > 4.99 &&  segmentIndex < 5.01)\n  ) ? 1.0 : 0.0;\n  float angle = 2.0 * 3.14159 * ((segment + nextAngle) / segmentCount);\n\n  vec3 v1 = mix(d, vec3(0.0), coneOffset);\n  vec3 v2 = v1 - d;\n\n  vec3 u = getOrthogonalVector(d);\n  vec3 v = normalize(cross(u, d));\n\n  vec3 x = u * cos(angle) * length(d)*0.25;\n  vec3 y = v * sin(angle) * length(d)*0.25;\n  vec3 v3 = v2 + x + y;\n  if (segmentIndex < 3.0) {\n    vec3 tx = u * sin(angle);\n    vec3 ty = v * -cos(angle);\n    vec3 tangent = tx + ty;\n    normal = normalize(cross(v3 - v1, tangent));\n  }\n\n  if (segmentIndex == 0.0) {\n    return mix(d, vec3(0.0), coneOffset);\n  }\n  return v3;\n}\n\nattribute vec4 vector;\nattribute vec4 position;\nattribute vec4 id;\n\nuniform mat4 model, view, projection;\nuniform float vectorScale, coneScale, coneOffset;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  vec3 normal;\n  vec3 XYZ = getConePosition(mat3(model) * ((vectorScale * coneScale) * vector.xyz), position.w, coneOffset, normal);\n  vec4 conePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);\n  gl_Position = projection * view * conePosition;\n  f_id        = id;\n  f_position  = position.xyz;\n}\n"]);var s=a(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3  clipBounds[2];\nuniform float pickId;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;\n\n  gl_FragColor = vec4(pickId, f_id.xyz);\n}"]);r.meshShader={vertex:n,fragment:i,attributes:[{name:"position",type:"vec4"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"vector",type:"vec3"}]};r.pickShader={vertex:o,fragment:s,attributes:[{name:"position",type:"vec4"},{name:"id",type:"vec4"},{name:"vector",type:"vec3"}]}},{glslify:434}],265:[function(e,t,r){t.exports={0:"NONE",1:"ONE",2:"LINE_LOOP",3:"LINE_STRIP",4:"TRIANGLES",5:"TRIANGLE_STRIP",6:"TRIANGLE_FAN",256:"DEPTH_BUFFER_BIT",512:"NEVER",513:"LESS",514:"EQUAL",515:"LEQUAL",516:"GREATER",517:"NOTEQUAL",518:"GEQUAL",519:"ALWAYS",768:"SRC_COLOR",769:"ONE_MINUS_SRC_COLOR",770:"SRC_ALPHA",771:"ONE_MINUS_SRC_ALPHA",772:"DST_ALPHA",773:"ONE_MINUS_DST_ALPHA",774:"DST_COLOR",775:"ONE_MINUS_DST_COLOR",776:"SRC_ALPHA_SATURATE",1024:"STENCIL_BUFFER_BIT",1028:"FRONT",1029:"BACK",1032:"FRONT_AND_BACK",1280:"INVALID_ENUM",1281:"INVALID_VALUE",1282:"INVALID_OPERATION",1285:"OUT_OF_MEMORY",1286:"INVALID_FRAMEBUFFER_OPERATION",2304:"CW",2305:"CCW",2849:"LINE_WIDTH",2884:"CULL_FACE",2885:"CULL_FACE_MODE",2886:"FRONT_FACE",2928:"DEPTH_RANGE",2929:"DEPTH_TEST",2930:"DEPTH_WRITEMASK",2931:"DEPTH_CLEAR_VALUE",2932:"DEPTH_FUNC",2960:"STENCIL_TEST",2961:"STENCIL_CLEAR_VALUE",2962:"STENCIL_FUNC",2963:"STENCIL_VALUE_MASK",2964:"STENCIL_FAIL",2965:"STENCIL_PASS_DEPTH_FAIL",2966:"STENCIL_PASS_DEPTH_PASS",2967:"STENCIL_REF",2968:"STENCIL_WRITEMASK",2978:"VIEWPORT",3024:"DITHER",3042:"BLEND",3088:"SCISSOR_BOX",3089:"SCISSOR_TEST",3106:"COLOR_CLEAR_VALUE",3107:"COLOR_WRITEMASK",3317:"UNPACK_ALIGNMENT",3333:"PACK_ALIGNMENT",3379:"MAX_TEXTURE_SIZE",3386:"MAX_VIEWPORT_DIMS",3408:"SUBPIXEL_BITS",3410:"RED_BITS",3411:"GREEN_BITS",3412:"BLUE_BITS",3413:"ALPHA_BITS",3414:"DEPTH_BITS",3415:"STENCIL_BITS",3553:"TEXTURE_2D",4352:"DONT_CARE",4353:"FASTEST",4354:"NICEST",5120:"BYTE",5121:"UNSIGNED_BYTE",5122:"SHORT",5123:"UNSIGNED_SHORT",5124:"INT",5125:"UNSIGNED_INT",5126:"FLOAT",5386:"INVERT",5890:"TEXTURE",6401:"STENCIL_INDEX",6402:"DEPTH_COMPONENT",6406:"ALPHA",6407:"RGB",6408:"RGBA",6409:"LUMINANCE",6410:"LUMINANCE_ALPHA",7680:"KEEP",7681:"REPLACE",7682:"INCR",7683:"DECR",7936:"VENDOR",7937:"RENDERER",7938:"VERSION",9728:"NEAREST",9729:"LINEAR",9984:"NEAREST_MIPMAP_NEAREST",9985:"LINEAR_MIPMAP_NEAREST",9986:"NEAREST_MIPMAP_LINEAR",9987:"LINEAR_MIPMAP_LINEAR",10240:"TEXTURE_MAG_FILTER",10241:"TEXTURE_MIN_FILTER",10242:"TEXTURE_WRAP_S",10243:"TEXTURE_WRAP_T",10497:"REPEAT",10752:"POLYGON_OFFSET_UNITS",16384:"COLOR_BUFFER_BIT",32769:"CONSTANT_COLOR",32770:"ONE_MINUS_CONSTANT_COLOR",32771:"CONSTANT_ALPHA",32772:"ONE_MINUS_CONSTANT_ALPHA",32773:"BLEND_COLOR",32774:"FUNC_ADD",32777:"BLEND_EQUATION_RGB",32778:"FUNC_SUBTRACT",32779:"FUNC_REVERSE_SUBTRACT",32819:"UNSIGNED_SHORT_4_4_4_4",32820:"UNSIGNED_SHORT_5_5_5_1",32823:"POLYGON_OFFSET_FILL",32824:"POLYGON_OFFSET_FACTOR",32854:"RGBA4",32855:"RGB5_A1",32873:"TEXTURE_BINDING_2D",32926:"SAMPLE_ALPHA_TO_COVERAGE",32928:"SAMPLE_COVERAGE",32936:"SAMPLE_BUFFERS",32937:"SAMPLES",32938:"SAMPLE_COVERAGE_VALUE",32939:"SAMPLE_COVERAGE_INVERT",32968:"BLEND_DST_RGB",32969:"BLEND_SRC_RGB",32970:"BLEND_DST_ALPHA",32971:"BLEND_SRC_ALPHA",33071:"CLAMP_TO_EDGE",33170:"GENERATE_MIPMAP_HINT",33189:"DEPTH_COMPONENT16",33306:"DEPTH_STENCIL_ATTACHMENT",33635:"UNSIGNED_SHORT_5_6_5",33648:"MIRRORED_REPEAT",33901:"ALIASED_POINT_SIZE_RANGE",33902:"ALIASED_LINE_WIDTH_RANGE",33984:"TEXTURE0",33985:"TEXTURE1",33986:"TEXTURE2",33987:"TEXTURE3",33988:"TEXTURE4",33989:"TEXTURE5",33990:"TEXTURE6",33991:"TEXTURE7",33992:"TEXTURE8",33993:"TEXTURE9",33994:"TEXTURE10",33995:"TEXTURE11",33996:"TEXTURE12",33997:"TEXTURE13",33998:"TEXTURE14",33999:"TEXTURE15",34e3:"TEXTURE16",34001:"TEXTURE17",34002:"TEXTURE18",34003:"TEXTURE19",34004:"TEXTURE20",34005:"TEXTURE21",34006:"TEXTURE22",34007:"TEXTURE23",34008:"TEXTURE24",34009:"TEXTURE25",34010:"TEXTURE26",34011:"TEXTURE27",34012:"TEXTURE28",34013:"TEXTURE29",34014:"TEXTURE30",34015:"TEXTURE31",34016:"ACTIVE_TEXTURE",34024:"MAX_RENDERBUFFER_SIZE",34041:"DEPTH_STENCIL",34055:"INCR_WRAP",34056:"DECR_WRAP",34067:"TEXTURE_CUBE_MAP",34068:"TEXTURE_BINDING_CUBE_MAP",34069:"TEXTURE_CUBE_MAP_POSITIVE_X",34070:"TEXTURE_CUBE_MAP_NEGATIVE_X",34071:"TEXTURE_CUBE_MAP_POSITIVE_Y",34072:"TEXTURE_CUBE_MAP_NEGATIVE_Y",34073:"TEXTURE_CUBE_MAP_POSITIVE_Z",34074:"TEXTURE_CUBE_MAP_NEGATIVE_Z",34076:"MAX_CUBE_MAP_TEXTURE_SIZE",34338:"VERTEX_ATTRIB_ARRAY_ENABLED",34339:"VERTEX_ATTRIB_ARRAY_SIZE",34340:"VERTEX_ATTRIB_ARRAY_STRIDE",34341:"VERTEX_ATTRIB_ARRAY_TYPE",34342:"CURRENT_VERTEX_ATTRIB",34373:"VERTEX_ATTRIB_ARRAY_POINTER",34466:"NUM_COMPRESSED_TEXTURE_FORMATS",34467:"COMPRESSED_TEXTURE_FORMATS",34660:"BUFFER_SIZE",34661:"BUFFER_USAGE",34816:"STENCIL_BACK_FUNC",34817:"STENCIL_BACK_FAIL",34818:"STENCIL_BACK_PASS_DEPTH_FAIL",34819:"STENCIL_BACK_PASS_DEPTH_PASS",34877:"BLEND_EQUATION_ALPHA",34921:"MAX_VERTEX_ATTRIBS",34922:"VERTEX_ATTRIB_ARRAY_NORMALIZED",34930:"MAX_TEXTURE_IMAGE_UNITS",34962:"ARRAY_BUFFER",34963:"ELEMENT_ARRAY_BUFFER",34964:"ARRAY_BUFFER_BINDING",34965:"ELEMENT_ARRAY_BUFFER_BINDING",34975:"VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",35040:"STREAM_DRAW",35044:"STATIC_DRAW",35048:"DYNAMIC_DRAW",35632:"FRAGMENT_SHADER",35633:"VERTEX_SHADER",35660:"MAX_VERTEX_TEXTURE_IMAGE_UNITS",35661:"MAX_COMBINED_TEXTURE_IMAGE_UNITS",35663:"SHADER_TYPE",35664:"FLOAT_VEC2",35665:"FLOAT_VEC3",35666:"FLOAT_VEC4",35667:"INT_VEC2",35668:"INT_VEC3",35669:"INT_VEC4",35670:"BOOL",35671:"BOOL_VEC2",35672:"BOOL_VEC3",35673:"BOOL_VEC4",35674:"FLOAT_MAT2",35675:"FLOAT_MAT3",35676:"FLOAT_MAT4",35678:"SAMPLER_2D",35680:"SAMPLER_CUBE",35712:"DELETE_STATUS",35713:"COMPILE_STATUS",35714:"LINK_STATUS",35715:"VALIDATE_STATUS",35716:"INFO_LOG_LENGTH",35717:"ATTACHED_SHADERS",35718:"ACTIVE_UNIFORMS",35719:"ACTIVE_UNIFORM_MAX_LENGTH",35720:"SHADER_SOURCE_LENGTH",35721:"ACTIVE_ATTRIBUTES",35722:"ACTIVE_ATTRIBUTE_MAX_LENGTH",35724:"SHADING_LANGUAGE_VERSION",35725:"CURRENT_PROGRAM",36003:"STENCIL_BACK_REF",36004:"STENCIL_BACK_VALUE_MASK",36005:"STENCIL_BACK_WRITEMASK",36006:"FRAMEBUFFER_BINDING",36007:"RENDERBUFFER_BINDING",36048:"FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",36049:"FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",36050:"FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",36051:"FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",36053:"FRAMEBUFFER_COMPLETE",36054:"FRAMEBUFFER_INCOMPLETE_ATTACHMENT",36055:"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",36057:"FRAMEBUFFER_INCOMPLETE_DIMENSIONS",36061:"FRAMEBUFFER_UNSUPPORTED",36064:"COLOR_ATTACHMENT0",36096:"DEPTH_ATTACHMENT",36128:"STENCIL_ATTACHMENT",36160:"FRAMEBUFFER",36161:"RENDERBUFFER",36162:"RENDERBUFFER_WIDTH",36163:"RENDERBUFFER_HEIGHT",36164:"RENDERBUFFER_INTERNAL_FORMAT",36168:"STENCIL_INDEX8",36176:"RENDERBUFFER_RED_SIZE",36177:"RENDERBUFFER_GREEN_SIZE",36178:"RENDERBUFFER_BLUE_SIZE",36179:"RENDERBUFFER_ALPHA_SIZE",36180:"RENDERBUFFER_DEPTH_SIZE",36181:"RENDERBUFFER_STENCIL_SIZE",36194:"RGB565",36336:"LOW_FLOAT",36337:"MEDIUM_FLOAT",36338:"HIGH_FLOAT",36339:"LOW_INT",36340:"MEDIUM_INT",36341:"HIGH_INT",36346:"SHADER_COMPILER",36347:"MAX_VERTEX_UNIFORM_VECTORS",36348:"MAX_VARYING_VECTORS",36349:"MAX_FRAGMENT_UNIFORM_VECTORS",37440:"UNPACK_FLIP_Y_WEBGL",37441:"UNPACK_PREMULTIPLY_ALPHA_WEBGL",37442:"CONTEXT_LOST_WEBGL",37443:"UNPACK_COLORSPACE_CONVERSION_WEBGL",37444:"BROWSER_DEFAULT_WEBGL"}},{}],266:[function(e,t,r){var a=e("./1.0/numbers");t.exports=function e(t){return a[t]}},{"./1.0/numbers":265}],267:[function(e,t,r){"use strict";t.exports=h;var a=e("gl-buffer");var n=e("gl-vao");var i=e("./shaders/index");var o=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function s(e,t,r,a){this.gl=e;this.shader=a;this.buffer=t;this.vao=r;this.pixelRatio=1;this.bounds=[[Infinity,Infinity,Infinity],[-Infinity,-Infinity,-Infinity]];this.clipBounds=[[-Infinity,-Infinity,-Infinity],[Infinity,Infinity,Infinity]];this.lineWidth=[1,1,1];this.capSize=[10,10,10];this.lineCount=[0,0,0];this.lineOffset=[0,0,0];this.opacity=1;this.hasAlpha=false}var l=s.prototype;l.isOpaque=function(){return!this.hasAlpha};l.isTransparent=function(){return this.hasAlpha};l.drawTransparent=l.draw=function(e){var t=this.gl;var r=this.shader.uniforms;this.shader.bind();var a=r.view=e.view||o;var n=r.projection=e.projection||o;r.model=e.model||o;r.clipBounds=this.clipBounds;r.opacity=this.opacity;var i=a[12];var s=a[13];var l=a[14];var u=a[15];var c=e._ortho||false;var f=c?2:1;var h=f*this.pixelRatio*(n[3]*i+n[7]*s+n[11]*l+n[15]*u)/t.drawingBufferHeight;this.vao.bind();for(var p=0;p<3;++p){t.lineWidth(this.lineWidth[p]*this.pixelRatio);r.capSize=this.capSize[p]*h;if(this.lineCount[p]){t.drawArrays(t.LINES,this.lineOffset[p],this.lineCount[p])}}this.vao.unbind()};function u(e,t){for(var r=0;r<3;++r){e[0][r]=Math.min(e[0][r],t[r]);e[1][r]=Math.max(e[1][r],t[r])}}var c=function(){var e=new Array(3);for(var t=0;t<3;++t){var r=[];for(var a=1;a<=2;++a){for(var n=-1;n<=1;n+=2){var i=(a+t)%3;var o=[0,0,0];o[i]=n;r.push(o)}}e[t]=r}return e}();function f(e,t,r,a){var n=c[a];for(var i=0;i<n.length;++i){var o=n[i];e.push(t[0],t[1],t[2],r[0],r[1],r[2],r[3],o[0],o[1],o[2])}return n.length}l.update=function(e){e=e||{};if("lineWidth"in e){this.lineWidth=e.lineWidth;if(!Array.isArray(this.lineWidth)){this.lineWidth=[this.lineWidth,this.lineWidth,this.lineWidth]}}if("capSize"in e){this.capSize=e.capSize;if(!Array.isArray(this.capSize)){this.capSize=[this.capSize,this.capSize,this.capSize]}}this.hasAlpha=false;if("opacity"in e){this.opacity=+e.opacity;if(this.opacity<1){this.hasAlpha=true}}var t=e.color||[[0,0,0],[0,0,0],[0,0,0]];var r=e.position;var a=e.error;if(!Array.isArray(t[0])){t=[t,t,t]}if(r&&a){var n=[];var i=r.length;var o=0;this.bounds=[[Infinity,Infinity,Infinity],[-Infinity,-Infinity,-Infinity]];this.lineCount=[0,0,0];for(var s=0;s<3;++s){this.lineOffset[s]=o;e:for(var l=0;l<i;++l){var c=r[l];for(var h=0;h<3;++h){if(isNaN(c[h])||!isFinite(c[h])){continue e}}var p=a[l];var v=t[s];if(Array.isArray(v[0])){v=t[l]}if(v.length===3){v=[v[0],v[1],v[2],1]}else if(v.length===4){v=[v[0],v[1],v[2],v[3]];if(!this.hasAlpha&&v[3]<1)this.hasAlpha=true}if(isNaN(p[0][s])||isNaN(p[1][s])){continue}if(p[0][s]<0){var d=c.slice();d[s]+=p[0][s];n.push(c[0],c[1],c[2],v[0],v[1],v[2],v[3],0,0,0,d[0],d[1],d[2],v[0],v[1],v[2],v[3],0,0,0);u(this.bounds,d);o+=2+f(n,d,v,s)}if(p[1][s]>0){var d=c.slice();d[s]+=p[1][s];n.push(c[0],c[1],c[2],v[0],v[1],v[2],v[3],0,0,0,d[0],d[1],d[2],v[0],v[1],v[2],v[3],0,0,0);u(this.bounds,d);o+=2+f(n,d,v,s)}}this.lineCount[s]=o-this.lineOffset[s]}this.buffer.update(n)}};l.dispose=function(){this.shader.dispose();this.buffer.dispose();this.vao.dispose()};function h(e){var t=e.gl;var r=a(t);var o=n(t,[{buffer:r,type:t.FLOAT,size:3,offset:0,stride:40},{buffer:r,type:t.FLOAT,size:4,offset:12,stride:40},{buffer:r,type:t.FLOAT,size:3,offset:28,stride:40}]);var l=i(t);l.attributes.position.location=0;l.attributes.color.location=1;l.attributes.offset.location=2;var u=new s(t,r,o,l);u.update(e);return u}},{"./shaders/index":269,"gl-buffer":261,"gl-vao":353}],268:[function(e,t,r){t.exports=function(e){if(typeof e==="string")e=[e];var t=[].slice.call(arguments,1);var r=[];for(var a=0;a<e.length-1;a++){r.push(e[a],t[a]||"")}r.push(e[a]);return r.join("")}},{}],269:[function(e,t,r){"use strict";var a=e("glslify");var n=e("gl-shader");var i=a(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position, offset;\nattribute vec4 color;\nuniform mat4 model, view, projection;\nuniform float capSize;\nvarying vec4 fragColor;\nvarying vec3 fragPosition;\n\nvoid main() {\n  vec4 worldPosition  = model * vec4(position, 1.0);\n  worldPosition       = (worldPosition / worldPosition.w) + vec4(capSize * offset, 0.0);\n  gl_Position         = projection * view * worldPosition;\n  fragColor           = color;\n  fragPosition        = position;\n}"]);var o=a(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 clipBounds[2];\nuniform float opacity;\nvarying vec3 fragPosition;\nvarying vec4 fragColor;\n\nvoid main() {\n  if (\n    outOfRange(clipBounds[0], clipBounds[1], fragPosition) ||\n    fragColor.a * opacity == 0.\n  ) discard;\n\n  gl_FragColor = opacity * fragColor;\n}"]);t.exports=function(e){return n(e,i,o,null,[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"offset",type:"vec3"}])}},{"gl-shader":332,glslify:268}],270:[function(e,t,r){"use strict";var a=e("gl-texture2d");t.exports=x;var n=null;var i;var o;var s;var l;function u(e){var t=e.getParameter(e.FRAMEBUFFER_BINDING);var r=e.getParameter(e.RENDERBUFFER_BINDING);var a=e.getParameter(e.TEXTURE_BINDING_2D);return[t,r,a]}function c(e,t){e.bindFramebuffer(e.FRAMEBUFFER,t[0]);e.bindRenderbuffer(e.RENDERBUFFER,t[1]);e.bindTexture(e.TEXTURE_2D,t[2])}function f(e,t){var r=e.getParameter(t.MAX_COLOR_ATTACHMENTS_WEBGL);n=new Array(r+1);for(var a=0;a<=r;++a){var i=new Array(r);for(var o=0;o<a;++o){i[o]=e.COLOR_ATTACHMENT0+o}for(var o=a;o<r;++o){i[o]=e.NONE}n[a]=i}}function h(e){switch(e){case i:throw new Error("gl-fbo: Framebuffer unsupported");case o:throw new Error("gl-fbo: Framebuffer incomplete attachment");case s:throw new Error("gl-fbo: Framebuffer incomplete dimensions");case l:throw new Error("gl-fbo: Framebuffer incomplete missing attachment");default:throw new Error("gl-fbo: Framebuffer failed for unspecified reason")}}function p(e,t,r,n,i,o){if(!n){return null}var s=a(e,t,r,i,n);s.magFilter=e.NEAREST;s.minFilter=e.NEAREST;s.mipSamples=1;s.bind();e.framebufferTexture2D(e.FRAMEBUFFER,o,e.TEXTURE_2D,s.handle,0);return s}function v(e,t,r,a,n){var i=e.createRenderbuffer();e.bindRenderbuffer(e.RENDERBUFFER,i);e.renderbufferStorage(e.RENDERBUFFER,a,t,r);e.framebufferRenderbuffer(e.FRAMEBUFFER,n,e.RENDERBUFFER,i);return i}function d(e){var t=u(e.gl);var r=e.gl;var a=e.handle=r.createFramebuffer();var i=e._shape[0];var o=e._shape[1];var s=e.color.length;var l=e._ext;var f=e._useStencil;var d=e._useDepth;var m=e._colorType;r.bindFramebuffer(r.FRAMEBUFFER,a);for(var g=0;g<s;++g){e.color[g]=p(r,i,o,m,r.RGBA,r.COLOR_ATTACHMENT0+g)}if(s===0){e._color_rb=v(r,i,o,r.RGBA4,r.COLOR_ATTACHMENT0);if(l){l.drawBuffersWEBGL(n[0])}}else if(s>1){l.drawBuffersWEBGL(n[s])}var y=r.getExtension("WEBGL_depth_texture");if(y){if(f){e.depth=p(r,i,o,y.UNSIGNED_INT_24_8_WEBGL,r.DEPTH_STENCIL,r.DEPTH_STENCIL_ATTACHMENT)}else if(d){e.depth=p(r,i,o,r.UNSIGNED_SHORT,r.DEPTH_COMPONENT,r.DEPTH_ATTACHMENT)}}else{if(d&&f){e._depth_rb=v(r,i,o,r.DEPTH_STENCIL,r.DEPTH_STENCIL_ATTACHMENT)}else if(d){e._depth_rb=v(r,i,o,r.DEPTH_COMPONENT16,r.DEPTH_ATTACHMENT)}else if(f){e._depth_rb=v(r,i,o,r.STENCIL_INDEX,r.STENCIL_ATTACHMENT)}}var x=r.checkFramebufferStatus(r.FRAMEBUFFER);if(x!==r.FRAMEBUFFER_COMPLETE){e._destroyed=true;r.bindFramebuffer(r.FRAMEBUFFER,null);r.deleteFramebuffer(e.handle);e.handle=null;if(e.depth){e.depth.dispose();e.depth=null}if(e._depth_rb){r.deleteRenderbuffer(e._depth_rb);e._depth_rb=null}for(var g=0;g<e.color.length;++g){e.color[g].dispose();e.color[g]=null}if(e._color_rb){r.deleteRenderbuffer(e._color_rb);e._color_rb=null}c(r,t);h(x)}c(r,t)}function m(e,t,r,a,n,i,o,s){this.gl=e;this._shape=[t|0,r|0];this._destroyed=false;this._ext=s;this.color=new Array(n);for(var l=0;l<n;++l){this.color[l]=null}this._color_rb=null;this.depth=null;this._depth_rb=null;this._colorType=a;this._useDepth=i;this._useStencil=o;var u=this;var c=[t|0,r|0];Object.defineProperties(c,{0:{get:function(){return u._shape[0]},set:function(e){return u.width=e}},1:{get:function(){return u._shape[1]},set:function(e){return u.height=e}}});this._shapeVector=c;d(this)}var g=m.prototype;function y(e,t,r){if(e._destroyed){throw new Error("gl-fbo: Can't resize destroyed FBO")}if(e._shape[0]===t&&e._shape[1]===r){return}var a=e.gl;var n=a.getParameter(a.MAX_RENDERBUFFER_SIZE);if(t<0||t>n||r<0||r>n){throw new Error("gl-fbo: Can't resize FBO, invalid dimensions")}e._shape[0]=t;e._shape[1]=r;var i=u(a);for(var o=0;o<e.color.length;++o){e.color[o].shape=e._shape}if(e._color_rb){a.bindRenderbuffer(a.RENDERBUFFER,e._color_rb);a.renderbufferStorage(a.RENDERBUFFER,a.RGBA4,e._shape[0],e._shape[1])}if(e.depth){e.depth.shape=e._shape}if(e._depth_rb){a.bindRenderbuffer(a.RENDERBUFFER,e._depth_rb);if(e._useDepth&&e._useStencil){a.renderbufferStorage(a.RENDERBUFFER,a.DEPTH_STENCIL,e._shape[0],e._shape[1])}else if(e._useDepth){a.renderbufferStorage(a.RENDERBUFFER,a.DEPTH_COMPONENT16,e._shape[0],e._shape[1])}else if(e._useStencil){a.renderbufferStorage(a.RENDERBUFFER,a.STENCIL_INDEX,e._shape[0],e._shape[1])}}a.bindFramebuffer(a.FRAMEBUFFER,e.handle);var s=a.checkFramebufferStatus(a.FRAMEBUFFER);if(s!==a.FRAMEBUFFER_COMPLETE){e.dispose();c(a,i);h(s)}c(a,i)}Object.defineProperties(g,{shape:{get:function(){if(this._destroyed){return[0,0]}return this._shapeVector},set:function(e){if(!Array.isArray(e)){e=[e|0,e|0]}if(e.length!==2){throw new Error("gl-fbo: Shape vector must be length 2")}var t=e[0]|0;var r=e[1]|0;y(this,t,r);return[t,r]},enumerable:false},width:{get:function(){if(this._destroyed){return 0}return this._shape[0]},set:function(e){e=e|0;y(this,e,this._shape[1]);return e},enumerable:false},height:{get:function(){if(this._destroyed){return 0}return this._shape[1]},set:function(e){e=e|0;y(this,this._shape[0],e);return e},enumerable:false}});g.bind=function(){if(this._destroyed){return}var e=this.gl;e.bindFramebuffer(e.FRAMEBUFFER,this.handle);e.viewport(0,0,this._shape[0],this._shape[1])};g.dispose=function(){if(this._destroyed){return}this._destroyed=true;var e=this.gl;e.deleteFramebuffer(this.handle);this.handle=null;if(this.depth){this.depth.dispose();this.depth=null}if(this._depth_rb){e.deleteRenderbuffer(this._depth_rb);this._depth_rb=null}for(var t=0;t<this.color.length;++t){this.color[t].dispose();this.color[t]=null}if(this._color_rb){e.deleteRenderbuffer(this._color_rb);this._color_rb=null}};function x(e,t,r,a){if(!i){i=e.FRAMEBUFFER_UNSUPPORTED;o=e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT;s=e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS;l=e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT}var u=e.getExtension("WEBGL_draw_buffers");if(!n&&u){f(e,u)}if(Array.isArray(t)){a=r;r=t[1]|0;t=t[0]|0}if(typeof t!=="number"){throw new Error("gl-fbo: Missing shape parameter")}var c=e.getParameter(e.MAX_RENDERBUFFER_SIZE);if(t<0||t>c||r<0||r>c){throw new Error("gl-fbo: Parameters are too large for FBO")}a=a||{};var h=1;if("color"in a){h=Math.max(a.color|0,0);if(h<0){throw new Error("gl-fbo: Must specify a nonnegative number of colors")}if(h>1){if(!u){throw new Error("gl-fbo: Multiple draw buffer extension not supported")}else if(h>e.getParameter(u.MAX_COLOR_ATTACHMENTS_WEBGL)){throw new Error("gl-fbo: Context does not support "+h+" draw buffers")}}}var p=e.UNSIGNED_BYTE;var v=e.getExtension("OES_texture_float");if(a.float&&h>0){if(!v){throw new Error("gl-fbo: Context does not support floating point textures")}p=e.FLOAT}else if(a.preferFloat&&h>0){if(v){p=e.FLOAT}}var d=true;if("depth"in a){d=!!a.depth}var g=false;if("stencil"in a){g=!!a.stencil}return new m(e,t,r,p,h,d,g,u)}},{"gl-texture2d":348}],271:[function(e,t,r){var a=e("sprintf-js").sprintf;var n=e("gl-constants/lookup");var i=e("glsl-shader-name");var o=e("add-line-numbers");t.exports=s;function s(e,t,r){"use strict";var s=i(t)||"of unknown name (see npm glsl-shader-name)";var l="unknown type";if(r!==undefined){l=r===n.FRAGMENT_SHADER?"fragment":"vertex"}var u=a("Error compiling %s shader %s:\n",l,s);var c=a("%s%s",u,e);var f=e.split("\n");var h={};for(var p=0;p<f.length;p++){var v=f[p];if(v===""||v==="\0")continue;var d=parseInt(v.split(":")[2]);if(isNaN(d)){throw new Error(a("Could not parse error: %s",v))}h[d]=v}var m=o(t).split("\n");for(var p=0;p<m.length;p++){if(!h[p+3]&&!h[p+2]&&!h[p+1])continue;var g=m[p];u+=g+"\n";if(h[p+1]){var y=h[p+1];y=y.substr(y.split(":",3).join(":").length+1).trim();u+=a("^^^ %s\n\n",y)}}return{long:u.trim(),short:c.trim()}}},{"add-line-numbers":72,"gl-constants/lookup":266,"glsl-shader-name":426,"sprintf-js":553}],272:[function(e,t,r){"use strict";t.exports=h;var a=e("binary-search-bounds");var n=e("iota-array");var i=e("typedarray-pool");var o=e("gl-shader");var s=e("gl-buffer");var l=e("./lib/shaders");function u(e,t,r,a,n,i,o){this.plot=e;this.shader=t;this.pickShader=r;this.positionBuffer=a;this.weightBuffer=n;this.colorBuffer=i;this.idBuffer=o;this.xData=[];this.yData=[];this.shape=[0,0];this.bounds=[Infinity,Infinity,-Infinity,-Infinity];this.pickOffset=0}var c=u.prototype;var f=[0,0,1,0,0,1,1,0,1,1,0,1];c.draw=function(){var e=[1,0,0,0,1,0,0,0,1];return function(){var t=this.plot;var r=this.shader;var a=this.bounds;var n=this.numVertices;if(n<=0){return}var i=t.gl;var o=t.dataBox;var s=a[2]-a[0];var l=a[3]-a[1];var u=o[2]-o[0];var c=o[3]-o[1];e[0]=2*s/u;e[4]=2*l/c;e[6]=2*(a[0]-o[0])/u-1;e[7]=2*(a[1]-o[1])/c-1;r.bind();var f=r.uniforms;f.viewTransform=e;f.shape=this.shape;var h=r.attributes;this.positionBuffer.bind();h.position.pointer();this.weightBuffer.bind();h.weight.pointer(i.UNSIGNED_BYTE,false);this.colorBuffer.bind();h.color.pointer(i.UNSIGNED_BYTE,true);i.drawArrays(i.TRIANGLES,0,n)}}();c.drawPick=function(){var e=[1,0,0,0,1,0,0,0,1];var t=[0,0,0,0];return function(r){var a=this.plot;var n=this.pickShader;var i=this.bounds;var o=this.numVertices;if(o<=0){return}var s=a.gl;var l=a.dataBox;var u=i[2]-i[0];var c=i[3]-i[1];var f=l[2]-l[0];var h=l[3]-l[1];e[0]=2*u/f;e[4]=2*c/h;e[6]=2*(i[0]-l[0])/f-1;e[7]=2*(i[1]-l[1])/h-1;for(var p=0;p<4;++p){t[p]=r>>p*8&255}this.pickOffset=r;n.bind();var v=n.uniforms;v.viewTransform=e;v.pickOffset=t;v.shape=this.shape;var d=n.attributes;this.positionBuffer.bind();d.position.pointer();this.weightBuffer.bind();d.weight.pointer(s.UNSIGNED_BYTE,false);this.idBuffer.bind();d.pickId.pointer(s.UNSIGNED_BYTE,false);s.drawArrays(s.TRIANGLES,0,o);return r+this.shape[0]*this.shape[1]}}();c.pick=function(e,t,r){var a=this.pickOffset;var n=this.shape[0]*this.shape[1];if(r<a||r>=a+n){return null}var i=r-a;var o=this.xData;var s=this.yData;return{object:this,pointId:i,dataCoord:[o[i%this.shape[0]],s[i/this.shape[0]|0]]}};c.update=function(e){e=e||{};var t=e.shape||[0,0];var r=e.x||n(t[0]);var o=e.y||n(t[1]);var s=e.z||new Float32Array(t[0]*t[1]);var l=e.zsmooth!==false;this.xData=r;this.yData=o;var u=e.colorLevels||[0];var c=e.colorValues||[0,0,0,1];var h=u.length;var p=this.bounds;var v,d,m,g;if(l){v=p[0]=r[0];d=p[1]=o[0];m=p[2]=r[r.length-1];g=p[3]=o[o.length-1]}else{v=p[0]=r[0]+(r[1]-r[0])/2;d=p[1]=o[0]+(o[1]-o[0])/2;m=p[2]=r[r.length-1]+(r[r.length-1]-r[r.length-2])/2;g=p[3]=o[o.length-1]+(o[o.length-1]-o[o.length-2])/2}var y=1/(m-v);var x=1/(g-d);var b=t[0];var _=t[1];this.shape=[b,_];var w=(l?(b-1)*(_-1):b*_)*(f.length>>>1);this.numVertices=w;var T=i.mallocUint8(w*4);var k=i.mallocFloat32(w*2);var M=i.mallocUint8(w*2);var A=i.mallocUint32(w);var S=0;var E=l?b-1:b;var L=l?_-1:_;for(var C=0;C<L;++C){var I,P;if(l){I=x*(o[C]-d);P=x*(o[C+1]-d)}else{I=C<_-1?x*(o[C]-(o[C+1]-o[C])/2-d):x*(o[C]-(o[C]-o[C-1])/2-d);P=C<_-1?x*(o[C]+(o[C+1]-o[C])/2-d):x*(o[C]+(o[C]-o[C-1])/2-d)}for(var O=0;O<E;++O){var z,D;if(l){z=y*(r[O]-v);D=y*(r[O+1]-v)}else{z=O<b-1?y*(r[O]-(r[O+1]-r[O])/2-v):y*(r[O]-(r[O]-r[O-1])/2-v);D=O<b-1?y*(r[O]+(r[O+1]-r[O])/2-v):y*(r[O]+(r[O]-r[O-1])/2-v)}for(var R=0;R<f.length;R+=2){var F=f[R];var B=f[R+1];var N=l?(C+B)*b+(O+F):C*b+O;var j=s[N];var U=a.le(u,j);var V,H,q,G;if(U<0){V=c[0];H=c[1];q=c[2];G=c[3]}else if(U===h-1){V=c[4*h-4];H=c[4*h-3];q=c[4*h-2];G=c[4*h-1]}else{var Y=(j-u[U])/(u[U+1]-u[U]);var W=1-Y;var X=4*U;var Z=4*(U+1);V=W*c[X]+Y*c[Z];H=W*c[X+1]+Y*c[Z+1];q=W*c[X+2]+Y*c[Z+2];G=W*c[X+3]+Y*c[Z+3]}T[4*S]=255*V;T[4*S+1]=255*H;T[4*S+2]=255*q;T[4*S+3]=255*G;k[2*S]=z*.5+D*.5;k[2*S+1]=I*.5+P*.5;M[2*S]=F;M[2*S+1]=B;A[S]=C*b+O;S+=1}}}this.positionBuffer.update(k);this.weightBuffer.update(M);this.colorBuffer.update(T);this.idBuffer.update(A);i.free(k);i.free(T);i.free(M);i.free(A)};c.dispose=function(){this.shader.dispose();this.pickShader.dispose();this.positionBuffer.dispose();this.weightBuffer.dispose();this.colorBuffer.dispose();this.idBuffer.dispose();this.plot.removeObject(this)};function h(e,t){var r=e.gl;var a=o(r,l.vertex,l.fragment);var n=o(r,l.pickVertex,l.pickFragment);var i=s(r);var c=s(r);var f=s(r);var h=s(r);var p=new u(e,a,n,i,c,f,h);p.update(t);e.addObject(p);return p}},{"./lib/shaders":273,"binary-search-bounds":103,"gl-buffer":261,"gl-shader":332,"iota-array":441,"typedarray-pool":601}],273:[function(e,t,r){"use strict";var a=e("glslify");t.exports={fragment:a(["precision lowp float;\n#define GLSLIFY 1\nvarying vec4 fragColor;\nvoid main() {\n  gl_FragColor = vec4(fragColor.rgb * fragColor.a, fragColor.a);\n}\n"]),vertex:a(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 position;\nattribute vec4 color;\nattribute vec2 weight;\n\nuniform vec2 shape;\nuniform mat3 viewTransform;\n\nvarying vec4 fragColor;\n\nvoid main() {\n  vec3 vPosition = viewTransform * vec3( position + (weight-.5)/(shape-1.) , 1.0);\n  fragColor = color;\n  gl_Position = vec4(vPosition.xy, 0, vPosition.z);\n}\n"]),pickFragment:a(["precision mediump float;\n#define GLSLIFY 1\n\nvarying vec4 fragId;\nvarying vec2 vWeight;\n\nuniform vec2 shape;\nuniform vec4 pickOffset;\n\nvoid main() {\n  vec2 d = step(.5, vWeight);\n  vec4 id = fragId + pickOffset;\n  id.x += d.x + d.y*shape.x;\n\n  id.y += floor(id.x / 256.0);\n  id.x -= floor(id.x / 256.0) * 256.0;\n\n  id.z += floor(id.y / 256.0);\n  id.y -= floor(id.y / 256.0) * 256.0;\n\n  id.w += floor(id.z / 256.0);\n  id.z -= floor(id.z / 256.0) * 256.0;\n\n  gl_FragColor = id/255.;\n}\n"]),pickVertex:a(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 position;\nattribute vec4 pickId;\nattribute vec2 weight;\n\nuniform vec2 shape;\nuniform mat3 viewTransform;\n\nvarying vec4 fragId;\nvarying vec2 vWeight;\n\nvoid main() {\n  vWeight = weight;\n\n  fragId = pickId;\n\n  vec3 vPosition = viewTransform * vec3( position + (weight-.5)/(shape-1.) , 1.0);\n  gl_Position = vec4(vPosition.xy, 0, vPosition.z);\n}\n"])}},{glslify:434}],274:[function(e,t,r){var a=e("glslify");var n=e("gl-shader");var i=a(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position, nextPosition;\nattribute float arcLength, lineWidth;\nattribute vec4 color;\n\nuniform vec2 screenShape;\nuniform float pixelRatio;\nuniform mat4 model, view, projection;\n\nvarying vec4 fragColor;\nvarying vec3 worldPosition;\nvarying float pixelArcLength;\n\nvec4 project(vec3 p) {\n  return projection * view * model * vec4(p, 1.0);\n}\n\nvoid main() {\n  vec4 startPoint = project(position);\n  vec4 endPoint   = project(nextPosition);\n\n  vec2 A = startPoint.xy / startPoint.w;\n  vec2 B =   endPoint.xy /   endPoint.w;\n\n  float clipAngle = atan(\n    (B.y - A.y) * screenShape.y,\n    (B.x - A.x) * screenShape.x\n  );\n\n  vec2 offset = 0.5 * pixelRatio * lineWidth * vec2(\n    sin(clipAngle),\n    -cos(clipAngle)\n  ) / screenShape;\n\n  gl_Position = vec4(startPoint.xy + startPoint.w * offset, startPoint.zw);\n\n  worldPosition = position;\n  pixelArcLength = arcLength;\n  fragColor = color;\n}\n"]);var o=a(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3      clipBounds[2];\nuniform sampler2D dashTexture;\nuniform float     dashScale;\nuniform float     opacity;\n\nvarying vec3    worldPosition;\nvarying float   pixelArcLength;\nvarying vec4    fragColor;\n\nvoid main() {\n  if (\n    outOfRange(clipBounds[0], clipBounds[1], worldPosition) ||\n    fragColor.a * opacity == 0.\n  ) discard;\n\n  float dashWeight = texture2D(dashTexture, vec2(dashScale * pixelArcLength, 0)).r;\n  if(dashWeight < 0.5) {\n    discard;\n  }\n  gl_FragColor = fragColor * opacity;\n}\n"]);var s=a(["precision highp float;\n#define GLSLIFY 1\n\n#define FLOAT_MAX  1.70141184e38\n#define FLOAT_MIN  1.17549435e-38\n\n// https://github.com/mikolalysenko/glsl-read-float/blob/master/index.glsl\nvec4 packFloat(float v) {\n  float av = abs(v);\n\n  //Handle special cases\n  if(av < FLOAT_MIN) {\n    return vec4(0.0, 0.0, 0.0, 0.0);\n  } else if(v > FLOAT_MAX) {\n    return vec4(127.0, 128.0, 0.0, 0.0) / 255.0;\n  } else if(v < -FLOAT_MAX) {\n    return vec4(255.0, 128.0, 0.0, 0.0) / 255.0;\n  }\n\n  vec4 c = vec4(0,0,0,0);\n\n  //Compute exponent and mantissa\n  float e = floor(log2(av));\n  float m = av * pow(2.0, -e) - 1.0;\n\n  //Unpack mantissa\n  c[1] = floor(128.0 * m);\n  m -= c[1] / 128.0;\n  c[2] = floor(32768.0 * m);\n  m -= c[2] / 32768.0;\n  c[3] = floor(8388608.0 * m);\n\n  //Unpack exponent\n  float ebias = e + 127.0;\n  c[0] = floor(ebias / 2.0);\n  ebias -= c[0] * 2.0;\n  c[1] += floor(ebias) * 128.0;\n\n  //Unpack sign bit\n  c[0] += 128.0 * step(0.0, -v);\n\n  //Scale back to range\n  return c / 255.0;\n}\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform float pickId;\nuniform vec3 clipBounds[2];\n\nvarying vec3 worldPosition;\nvarying float pixelArcLength;\nvarying vec4 fragColor;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], worldPosition)) discard;\n\n  gl_FragColor = vec4(pickId/255.0, packFloat(pixelArcLength).xyz);\n}"]);var l=[{name:"position",type:"vec3"},{name:"nextPosition",type:"vec3"},{name:"arcLength",type:"float"},{name:"lineWidth",type:"float"},{name:"color",type:"vec4"}];r.createShader=function(e){return n(e,i,o,null,l)};r.createPickShader=function(e){return n(e,i,s,null,l)}},{"gl-shader":332,glslify:276}],275:[function(e,t,r){"use strict";t.exports=b;var a=e("gl-buffer");var n=e("gl-vao");var i=e("gl-texture2d");var o=new Uint8Array(4);var s=new Float32Array(o.buffer);function l(e,t,r,a){o[0]=a;o[1]=r;o[2]=t;o[3]=e;return s[0]}var u=e("binary-search-bounds");var c=e("ndarray");var f=e("./lib/shaders");var h=f.createShader;var p=f.createPickShader;var v=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function d(e,t){var r=0;for(var a=0;a<3;++a){var n=e[a]-t[a];r+=n*n}return Math.sqrt(r)}function m(e){var t=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]];for(var r=0;r<3;++r){t[0][r]=Math.max(e[0][r],t[0][r]);t[1][r]=Math.min(e[1][r],t[1][r])}return t}function g(e,t,r,a){this.arcLength=e;this.position=t;this.index=r;this.dataCoordinate=a}function y(e,t,r,a,n,i){this.gl=e;this.shader=t;this.pickShader=r;this.buffer=a;this.vao=n;this.clipBounds=[[-Infinity,-Infinity,-Infinity],[Infinity,Infinity,Infinity]];this.points=[];this.arcLength=[];this.vertexCount=0;this.bounds=[[0,0,0],[0,0,0]];this.pickId=0;this.lineWidth=1;this.texture=i;this.dashScale=1;this.opacity=1;this.hasAlpha=false;this.dirty=true;this.pixelRatio=1}var x=y.prototype;x.isTransparent=function(){return this.hasAlpha};x.isOpaque=function(){return!this.hasAlpha};x.pickSlots=1;x.setPickBase=function(e){this.pickId=e};x.drawTransparent=x.draw=function(e){if(!this.vertexCount)return;var t=this.gl;var r=this.shader;var a=this.vao;r.bind();r.uniforms={model:e.model||v,view:e.view||v,projection:e.projection||v,clipBounds:m(this.clipBounds),dashTexture:this.texture.bind(),dashScale:this.dashScale/this.arcLength[this.arcLength.length-1],opacity:this.opacity,screenShape:[t.drawingBufferWidth,t.drawingBufferHeight],pixelRatio:this.pixelRatio};a.bind();a.draw(t.TRIANGLE_STRIP,this.vertexCount);a.unbind()};x.drawPick=function(e){if(!this.vertexCount)return;var t=this.gl;var r=this.pickShader;var a=this.vao;r.bind();r.uniforms={model:e.model||v,view:e.view||v,projection:e.projection||v,pickId:this.pickId,clipBounds:m(this.clipBounds),screenShape:[t.drawingBufferWidth,t.drawingBufferHeight],pixelRatio:this.pixelRatio};a.bind();a.draw(t.TRIANGLE_STRIP,this.vertexCount);a.unbind()};x.update=function(e){var t,r;this.dirty=true;var a=!!e.connectGaps;if("dashScale"in e){this.dashScale=e.dashScale}this.hasAlpha=false;if("opacity"in e){this.opacity=+e.opacity;if(this.opacity<1){this.hasAlpha=true}}var n=[];var i=[];var o=[];var s=0;var l=0;var f=[[Infinity,Infinity,Infinity],[-Infinity,-Infinity,-Infinity]];var h=e.position||e.positions;if(h){var p=e.color||e.colors||[0,0,0,1];var v=e.lineWidth||1;var m=false;e:for(t=1;t<h.length;++t){var g=h[t-1];var y=h[t];i.push(s);o.push(g.slice());for(r=0;r<3;++r){if(isNaN(g[r])||isNaN(y[r])||!isFinite(g[r])||!isFinite(y[r])){if(!a&&n.length>0){for(var x=0;x<24;++x){n.push(n[n.length-12])}l+=2;m=true}continue e}f[0][r]=Math.min(f[0][r],g[r],y[r]);f[1][r]=Math.max(f[1][r],g[r],y[r])}var b,_;if(Array.isArray(p[0])){b=p.length>t-1?p[t-1]:p.length>0?p[p.length-1]:[0,0,0,1];_=p.length>t?p[t]:p.length>0?p[p.length-1]:[0,0,0,1]}else{b=_=p}if(b.length===3){b=[b[0],b[1],b[2],1]}if(_.length===3){_=[_[0],_[1],_[2],1]}if(!this.hasAlpha&&b[3]<1)this.hasAlpha=true;var w;if(Array.isArray(v)){w=v.length>t-1?v[t-1]:v.length>0?v[v.length-1]:[0,0,0,1]}else{w=v}var T=s;s+=d(g,y);if(m){for(r=0;r<2;++r){n.push(g[0],g[1],g[2],y[0],y[1],y[2],T,w,b[0],b[1],b[2],b[3])}l+=2;m=false}n.push(g[0],g[1],g[2],y[0],y[1],y[2],T,w,b[0],b[1],b[2],b[3],g[0],g[1],g[2],y[0],y[1],y[2],T,-w,b[0],b[1],b[2],b[3],y[0],y[1],y[2],g[0],g[1],g[2],s,-w,_[0],_[1],_[2],_[3],y[0],y[1],y[2],g[0],g[1],g[2],s,w,_[0],_[1],_[2],_[3]);l+=4}}this.buffer.update(n);i.push(s);o.push(h[h.length-1].slice());this.bounds=f;this.vertexCount=l;this.points=o;this.arcLength=i;if("dashes"in e){var k=e.dashes;var M=k.slice();M.unshift(0);for(t=1;t<M.length;++t){M[t]=M[t-1]+M[t]}var A=c(new Array(256*4),[256,1,4]);for(t=0;t<256;++t){for(r=0;r<4;++r){A.set(t,0,r,0)}if(u.le(M,M[M.length-1]*t/255)&1){A.set(t,0,0,0)}else{A.set(t,0,0,255)}}this.texture.setPixels(A)}};x.dispose=function(){this.shader.dispose();this.vao.dispose();this.buffer.dispose()};x.pick=function(e){if(!e){return null}if(e.id!==this.pickId){return null}var t=l(e.value[0],e.value[1],e.value[2],0);var r=u.le(this.arcLength,t);if(r<0){return null}if(r===this.arcLength.length-1){return new g(this.arcLength[this.arcLength.length-1],this.points[this.points.length-1].slice(),r)}var a=this.points[r];var n=this.points[Math.min(r+1,this.points.length-1)];var i=(t-this.arcLength[r])/(this.arcLength[r+1]-this.arcLength[r]);var o=1-i;var s=[0,0,0];for(var c=0;c<3;++c){s[c]=o*a[c]+i*n[c]}var f=Math.min(i<.5?r:r+1,this.points.length-1);return new g(t,s,f,this.points[f])};function b(e){var t=e.gl||e.scene&&e.scene.gl;var r=h(t);r.attributes.position.location=0;r.attributes.nextPosition.location=1;r.attributes.arcLength.location=2;r.attributes.lineWidth.location=3;r.attributes.color.location=4;var o=p(t);o.attributes.position.location=0;o.attributes.nextPosition.location=1;o.attributes.arcLength.location=2;o.attributes.lineWidth.location=3;o.attributes.color.location=4;var s=a(t);var l=n(t,[{buffer:s,size:3,offset:0,stride:48},{buffer:s,size:3,offset:12,stride:48},{buffer:s,size:1,offset:24,stride:48},{buffer:s,size:1,offset:28,stride:48},{buffer:s,size:4,offset:32,stride:48}]);var u=c(new Array(256*4),[256,1,4]);for(var f=0;f<256*4;++f){u.data[f]=255}var v=i(t,u);v.wrap=t.REPEAT;var d=new y(t,r,o,s,l,v);d.update(e);return d}},{"./lib/shaders":274,"binary-search-bounds":103,"gl-buffer":261,"gl-texture2d":348,"gl-vao":353,ndarray:472}],276:[function(e,t,r){arguments[4][268][0].apply(r,arguments)},{dup:268}],277:[function(e,t,r){t.exports=a;function a(e,t){var r=t[0],a=t[1],n=t[2],i=t[3],o=t[4],s=t[5],l=t[6],u=t[7],c=t[8],f=t[9],h=t[10],p=t[11],v=t[12],d=t[13],m=t[14],g=t[15];e[0]=s*(h*g-p*m)-f*(l*g-u*m)+d*(l*p-u*h);e[1]=-(a*(h*g-p*m)-f*(n*g-i*m)+d*(n*p-i*h));e[2]=a*(l*g-u*m)-s*(n*g-i*m)+d*(n*u-i*l);e[3]=-(a*(l*p-u*h)-s*(n*p-i*h)+f*(n*u-i*l));e[4]=-(o*(h*g-p*m)-c*(l*g-u*m)+v*(l*p-u*h));e[5]=r*(h*g-p*m)-c*(n*g-i*m)+v*(n*p-i*h);e[6]=-(r*(l*g-u*m)-o*(n*g-i*m)+v*(n*u-i*l));e[7]=r*(l*p-u*h)-o*(n*p-i*h)+c*(n*u-i*l);e[8]=o*(f*g-p*d)-c*(s*g-u*d)+v*(s*p-u*f);e[9]=-(r*(f*g-p*d)-c*(a*g-i*d)+v*(a*p-i*f));e[10]=r*(s*g-u*d)-o*(a*g-i*d)+v*(a*u-i*s);e[11]=-(r*(s*p-u*f)-o*(a*p-i*f)+c*(a*u-i*s));e[12]=-(o*(f*m-h*d)-c*(s*m-l*d)+v*(s*h-l*f));e[13]=r*(f*m-h*d)-c*(a*m-n*d)+v*(a*h-n*f);e[14]=-(r*(s*m-l*d)-o*(a*m-n*d)+v*(a*l-n*s));e[15]=r*(s*h-l*f)-o*(a*h-n*f)+c*(a*l-n*s);return e}},{}],278:[function(e,t,r){t.exports=a;function a(e){var t=new Float32Array(16);t[0]=e[0];t[1]=e[1];t[2]=e[2];t[3]=e[3];t[4]=e[4];t[5]=e[5];t[6]=e[6];t[7]=e[7];t[8]=e[8];t[9]=e[9];t[10]=e[10];t[11]=e[11];t[12]=e[12];t[13]=e[13];t[14]=e[14];t[15]=e[15];return t}},{}],279:[function(e,t,r){t.exports=a;function a(e,t){e[0]=t[0];e[1]=t[1];e[2]=t[2];e[3]=t[3];e[4]=t[4];e[5]=t[5];e[6]=t[6];e[7]=t[7];e[8]=t[8];e[9]=t[9];e[10]=t[10];e[11]=t[11];e[12]=t[12];e[13]=t[13];e[14]=t[14];e[15]=t[15];return e}},{}],280:[function(e,t,r){t.exports=a;function a(){var e=new Float32Array(16);e[0]=1;e[1]=0;e[2]=0;e[3]=0;e[4]=0;e[5]=1;e[6]=0;e[7]=0;e[8]=0;e[9]=0;e[10]=1;e[11]=0;e[12]=0;e[13]=0;e[14]=0;e[15]=1;return e}},{}],281:[function(e,t,r){t.exports=a;function a(e){var t=e[0],r=e[1],a=e[2],n=e[3],i=e[4],o=e[5],s=e[6],l=e[7],u=e[8],c=e[9],f=e[10],h=e[11],p=e[12],v=e[13],d=e[14],m=e[15],g=t*o-r*i,y=t*s-a*i,x=t*l-n*i,b=r*s-a*o,_=r*l-n*o,w=a*l-n*s,T=u*v-c*p,k=u*d-f*p,M=u*m-h*p,A=c*d-f*v,S=c*m-h*v,E=f*m-h*d;return g*E-y*S+x*A+b*M-_*k+w*T}},{}],282:[function(e,t,r){t.exports=a;function a(e,t){var r=t[0],a=t[1],n=t[2],i=t[3],o=r+r,s=a+a,l=n+n,u=r*o,c=a*o,f=a*s,h=n*o,p=n*s,v=n*l,d=i*o,m=i*s,g=i*l;e[0]=1-f-v;e[1]=c+g;e[2]=h-m;e[3]=0;e[4]=c-g;e[5]=1-u-v;e[6]=p+d;e[7]=0;e[8]=h+m;e[9]=p-d;e[10]=1-u-f;e[11]=0;e[12]=0;e[13]=0;e[14]=0;e[15]=1;return e}},{}],283:[function(e,t,r){t.exports=a;function a(e,t,r){var a,n,i;var o=r[0];var s=r[1];var l=r[2];var u=Math.sqrt(o*o+s*s+l*l);if(Math.abs(u)<1e-6){return null}u=1/u;o*=u;s*=u;l*=u;a=Math.sin(t);n=Math.cos(t);i=1-n;e[0]=o*o*i+n;e[1]=s*o*i+l*a;e[2]=l*o*i-s*a;e[3]=0;e[4]=o*s*i-l*a;e[5]=s*s*i+n;e[6]=l*s*i+o*a;e[7]=0;e[8]=o*l*i+s*a;e[9]=s*l*i-o*a;e[10]=l*l*i+n;e[11]=0;e[12]=0;e[13]=0;e[14]=0;e[15]=1;return e}},{}],284:[function(e,t,r){t.exports=a;function a(e,t,r){var a=t[0],n=t[1],i=t[2],o=t[3],s=a+a,l=n+n,u=i+i,c=a*s,f=a*l,h=a*u,p=n*l,v=n*u,d=i*u,m=o*s,g=o*l,y=o*u;e[0]=1-(p+d);e[1]=f+y;e[2]=h-g;e[3]=0;e[4]=f-y;e[5]=1-(c+d);e[6]=v+m;e[7]=0;e[8]=h+g;e[9]=v-m;e[10]=1-(c+p);e[11]=0;e[12]=r[0];e[13]=r[1];e[14]=r[2];e[15]=1;return e}},{}],285:[function(e,t,r){t.exports=a;function a(e,t){e[0]=t[0];e[1]=0;e[2]=0;e[3]=0;e[4]=0;e[5]=t[1];e[6]=0;e[7]=0;e[8]=0;e[9]=0;e[10]=t[2];e[11]=0;e[12]=0;e[13]=0;e[14]=0;e[15]=1;return e}},{}],286:[function(e,t,r){t.exports=a;function a(e,t){e[0]=1;e[1]=0;e[2]=0;e[3]=0;e[4]=0;e[5]=1;e[6]=0;e[7]=0;e[8]=0;e[9]=0;e[10]=1;e[11]=0;e[12]=t[0];e[13]=t[1];e[14]=t[2];e[15]=1;return e}},{}],287:[function(e,t,r){t.exports=a;function a(e,t){var r=Math.sin(t),a=Math.cos(t);e[0]=1;e[1]=0;e[2]=0;e[3]=0;e[4]=0;e[5]=a;e[6]=r;e[7]=0;e[8]=0;e[9]=-r;e[10]=a;e[11]=0;e[12]=0;e[13]=0;e[14]=0;e[15]=1;return e}},{}],288:[function(e,t,r){t.exports=a;function a(e,t){var r=Math.sin(t),a=Math.cos(t);e[0]=a;e[1]=0;e[2]=-r;e[3]=0;e[4]=0;e[5]=1;e[6]=0;e[7]=0;e[8]=r;e[9]=0;e[10]=a;e[11]=0;e[12]=0;e[13]=0;e[14]=0;e[15]=1;return e}},{}],289:[function(e,t,r){t.exports=a;function a(e,t){var r=Math.sin(t),a=Math.cos(t);e[0]=a;e[1]=r;e[2]=0;e[3]=0;e[4]=-r;e[5]=a;e[6]=0;e[7]=0;e[8]=0;e[9]=0;e[10]=1;e[11]=0;e[12]=0;e[13]=0;e[14]=0;e[15]=1;return e}},{}],290:[function(e,t,r){t.exports=a;function a(e,t,r,a,n,i,o){var s=1/(r-t),l=1/(n-a),u=1/(i-o);e[0]=i*2*s;e[1]=0;e[2]=0;e[3]=0;e[4]=0;e[5]=i*2*l;e[6]=0;e[7]=0;e[8]=(r+t)*s;e[9]=(n+a)*l;e[10]=(o+i)*u;e[11]=-1;e[12]=0;e[13]=0;e[14]=o*i*2*u;e[15]=0;return e}},{}],291:[function(e,t,r){t.exports=a;function a(e){e[0]=1;e[1]=0;e[2]=0;e[3]=0;e[4]=0;e[5]=1;e[6]=0;e[7]=0;e[8]=0;e[9]=0;e[10]=1;e[11]=0;e[12]=0;e[13]=0;e[14]=0;e[15]=1;return e}},{}],292:[function(e,t,r){t.exports={create:e("./create"),clone:e("./clone"),copy:e("./copy"),identity:e("./identity"),transpose:e("./transpose"),invert:e("./invert"),adjoint:e("./adjoint"),determinant:e("./determinant"),multiply:e("./multiply"),translate:e("./translate"),scale:e("./scale"),rotate:e("./rotate"),rotateX:e("./rotateX"),rotateY:e("./rotateY"),rotateZ:e("./rotateZ"),fromRotation:e("./fromRotation"),fromRotationTranslation:e("./fromRotationTranslation"),fromScaling:e("./fromScaling"),fromTranslation:e("./fromTranslation"),fromXRotation:e("./fromXRotation"),fromYRotation:e("./fromYRotation"),fromZRotation:e("./fromZRotation"),fromQuat:e("./fromQuat"),frustum:e("./frustum"),perspective:e("./perspective"),perspectiveFromFieldOfView:e("./perspectiveFromFieldOfView"),ortho:e("./ortho"),lookAt:e("./lookAt"),str:e("./str")}},{"./adjoint":277,"./clone":278,"./copy":279,"./create":280,"./determinant":281,"./fromQuat":282,"./fromRotation":283,"./fromRotationTranslation":284,"./fromScaling":285,"./fromTranslation":286,"./fromXRotation":287,"./fromYRotation":288,"./fromZRotation":289,"./frustum":290,"./identity":291,"./invert":293,"./lookAt":294,"./multiply":295,"./ortho":296,"./perspective":297,"./perspectiveFromFieldOfView":298,"./rotate":299,"./rotateX":300,"./rotateY":301,"./rotateZ":302,"./scale":303,"./str":304,"./translate":305,"./transpose":306}],293:[function(e,t,r){t.exports=a;function a(e,t){var r=t[0],a=t[1],n=t[2],i=t[3],o=t[4],s=t[5],l=t[6],u=t[7],c=t[8],f=t[9],h=t[10],p=t[11],v=t[12],d=t[13],m=t[14],g=t[15],y=r*s-a*o,x=r*l-n*o,b=r*u-i*o,_=a*l-n*s,w=a*u-i*s,T=n*u-i*l,k=c*d-f*v,M=c*m-h*v,A=c*g-p*v,S=f*m-h*d,E=f*g-p*d,L=h*g-p*m,C=y*L-x*E+b*S+_*A-w*M+T*k;if(!C){return null}C=1/C;e[0]=(s*L-l*E+u*S)*C;e[1]=(n*E-a*L-i*S)*C;e[2]=(d*T-m*w+g*_)*C;e[3]=(h*w-f*T-p*_)*C;e[4]=(l*A-o*L-u*M)*C;e[5]=(r*L-n*A+i*M)*C;e[6]=(m*b-v*T-g*x)*C;e[7]=(c*T-h*b+p*x)*C;e[8]=(o*E-s*A+u*k)*C;e[9]=(a*A-r*E-i*k)*C;e[10]=(v*w-d*b+g*y)*C;e[11]=(f*b-c*w-p*y)*C;e[12]=(s*M-o*S-l*k)*C;e[13]=(r*S-a*M+n*k)*C;e[14]=(d*x-v*_-m*y)*C;e[15]=(c*_-f*x+h*y)*C;return e}},{}],294:[function(e,t,r){var a=e("./identity");t.exports=n;function n(e,t,r,n){var i,o,s,l,u,c,f,h,p,v,d=t[0],m=t[1],g=t[2],y=n[0],x=n[1],b=n[2],_=r[0],w=r[1],T=r[2];if(Math.abs(d-_)<1e-6&&Math.abs(m-w)<1e-6&&Math.abs(g-T)<1e-6){return a(e)}f=d-_;h=m-w;p=g-T;v=1/Math.sqrt(f*f+h*h+p*p);f*=v;h*=v;p*=v;i=x*p-b*h;o=b*f-y*p;s=y*h-x*f;v=Math.sqrt(i*i+o*o+s*s);if(!v){i=0;o=0;s=0}else{v=1/v;i*=v;o*=v;s*=v}l=h*s-p*o;u=p*i-f*s;c=f*o-h*i;v=Math.sqrt(l*l+u*u+c*c);if(!v){l=0;u=0;c=0}else{v=1/v;l*=v;u*=v;c*=v}e[0]=i;e[1]=l;e[2]=f;e[3]=0;e[4]=o;e[5]=u;e[6]=h;e[7]=0;e[8]=s;e[9]=c;e[10]=p;e[11]=0;e[12]=-(i*d+o*m+s*g);e[13]=-(l*d+u*m+c*g);e[14]=-(f*d+h*m+p*g);e[15]=1;return e}},{"./identity":291}],295:[function(e,t,r){t.exports=a;function a(e,t,r){var a=t[0],n=t[1],i=t[2],o=t[3],s=t[4],l=t[5],u=t[6],c=t[7],f=t[8],h=t[9],p=t[10],v=t[11],d=t[12],m=t[13],g=t[14],y=t[15];var x=r[0],b=r[1],_=r[2],w=r[3];e[0]=x*a+b*s+_*f+w*d;e[1]=x*n+b*l+_*h+w*m;e[2]=x*i+b*u+_*p+w*g;e[3]=x*o+b*c+_*v+w*y;x=r[4];b=r[5];_=r[6];w=r[7];e[4]=x*a+b*s+_*f+w*d;e[5]=x*n+b*l+_*h+w*m;e[6]=x*i+b*u+_*p+w*g;e[7]=x*o+b*c+_*v+w*y;x=r[8];b=r[9];_=r[10];w=r[11];e[8]=x*a+b*s+_*f+w*d;e[9]=x*n+b*l+_*h+w*m;e[10]=x*i+b*u+_*p+w*g;e[11]=x*o+b*c+_*v+w*y;x=r[12];b=r[13];_=r[14];w=r[15];e[12]=x*a+b*s+_*f+w*d;e[13]=x*n+b*l+_*h+w*m;e[14]=x*i+b*u+_*p+w*g;e[15]=x*o+b*c+_*v+w*y;return e}},{}],296:[function(e,t,r){t.exports=a;function a(e,t,r,a,n,i,o){var s=1/(t-r),l=1/(a-n),u=1/(i-o);e[0]=-2*s;e[1]=0;e[2]=0;e[3]=0;e[4]=0;e[5]=-2*l;e[6]=0;e[7]=0;e[8]=0;e[9]=0;e[10]=2*u;e[11]=0;e[12]=(t+r)*s;e[13]=(n+a)*l;e[14]=(o+i)*u;e[15]=1;return e}},{}],297:[function(e,t,r){t.exports=a;function a(e,t,r,a,n){var i=1/Math.tan(t/2),o=1/(a-n);e[0]=i/r;e[1]=0;e[2]=0;e[3]=0;e[4]=0;e[5]=i;e[6]=0;e[7]=0;e[8]=0;e[9]=0;e[10]=(n+a)*o;e[11]=-1;e[12]=0;e[13]=0;e[14]=2*n*a*o;e[15]=0;return e}},{}],298:[function(e,t,r){t.exports=a;function a(e,t,r,a){var n=Math.tan(t.upDegrees*Math.PI/180),i=Math.tan(t.downDegrees*Math.PI/180),o=Math.tan(t.leftDegrees*Math.PI/180),s=Math.tan(t.rightDegrees*Math.PI/180),l=2/(o+s),u=2/(n+i);e[0]=l;e[1]=0;e[2]=0;e[3]=0;e[4]=0;e[5]=u;e[6]=0;e[7]=0;e[8]=-((o-s)*l*.5);e[9]=(n-i)*u*.5;e[10]=a/(r-a);e[11]=-1;e[12]=0;e[13]=0;e[14]=a*r/(r-a);e[15]=0;return e}},{}],299:[function(e,t,r){t.exports=a;function a(e,t,r,a){var n=a[0],i=a[1],o=a[2],s=Math.sqrt(n*n+i*i+o*o),l,u,c,f,h,p,v,d,m,g,y,x,b,_,w,T,k,M,A,S,E,L,C,I;if(Math.abs(s)<1e-6){return null}s=1/s;n*=s;i*=s;o*=s;l=Math.sin(r);u=Math.cos(r);c=1-u;f=t[0];h=t[1];p=t[2];v=t[3];d=t[4];m=t[5];g=t[6];y=t[7];x=t[8];b=t[9];_=t[10];w=t[11];T=n*n*c+u;k=i*n*c+o*l;M=o*n*c-i*l;A=n*i*c-o*l;S=i*i*c+u;E=o*i*c+n*l;L=n*o*c+i*l;C=i*o*c-n*l;I=o*o*c+u;e[0]=f*T+d*k+x*M;e[1]=h*T+m*k+b*M;e[2]=p*T+g*k+_*M;e[3]=v*T+y*k+w*M;e[4]=f*A+d*S+x*E;e[5]=h*A+m*S+b*E;e[6]=p*A+g*S+_*E;e[7]=v*A+y*S+w*E;e[8]=f*L+d*C+x*I;e[9]=h*L+m*C+b*I;e[10]=p*L+g*C+_*I;e[11]=v*L+y*C+w*I;if(t!==e){e[12]=t[12];e[13]=t[13];e[14]=t[14];e[15]=t[15]}return e}},{}],300:[function(e,t,r){t.exports=a;function a(e,t,r){var a=Math.sin(r),n=Math.cos(r),i=t[4],o=t[5],s=t[6],l=t[7],u=t[8],c=t[9],f=t[10],h=t[11];if(t!==e){e[0]=t[0];e[1]=t[1];e[2]=t[2];e[3]=t[3];e[12]=t[12];e[13]=t[13];e[14]=t[14];e[15]=t[15]}e[4]=i*n+u*a;e[5]=o*n+c*a;e[6]=s*n+f*a;e[7]=l*n+h*a;e[8]=u*n-i*a;e[9]=c*n-o*a;e[10]=f*n-s*a;e[11]=h*n-l*a;return e}},{}],301:[function(e,t,r){t.exports=a;function a(e,t,r){var a=Math.sin(r),n=Math.cos(r),i=t[0],o=t[1],s=t[2],l=t[3],u=t[8],c=t[9],f=t[10],h=t[11];if(t!==e){e[4]=t[4];e[5]=t[5];e[6]=t[6];e[7]=t[7];e[12]=t[12];e[13]=t[13];e[14]=t[14];e[15]=t[15]}e[0]=i*n-u*a;e[1]=o*n-c*a;e[2]=s*n-f*a;e[3]=l*n-h*a;e[8]=i*a+u*n;e[9]=o*a+c*n;e[10]=s*a+f*n;e[11]=l*a+h*n;return e}},{}],302:[function(e,t,r){t.exports=a;function a(e,t,r){var a=Math.sin(r),n=Math.cos(r),i=t[0],o=t[1],s=t[2],l=t[3],u=t[4],c=t[5],f=t[6],h=t[7];if(t!==e){e[8]=t[8];e[9]=t[9];e[10]=t[10];e[11]=t[11];e[12]=t[12];e[13]=t[13];e[14]=t[14];e[15]=t[15]}e[0]=i*n+u*a;e[1]=o*n+c*a;e[2]=s*n+f*a;e[3]=l*n+h*a;e[4]=u*n-i*a;e[5]=c*n-o*a;e[6]=f*n-s*a;e[7]=h*n-l*a;return e}},{}],303:[function(e,t,r){t.exports=a;function a(e,t,r){var a=r[0],n=r[1],i=r[2];e[0]=t[0]*a;e[1]=t[1]*a;e[2]=t[2]*a;e[3]=t[3]*a;e[4]=t[4]*n;e[5]=t[5]*n;e[6]=t[6]*n;e[7]=t[7]*n;e[8]=t[8]*i;e[9]=t[9]*i;e[10]=t[10]*i;e[11]=t[11]*i;e[12]=t[12];e[13]=t[13];e[14]=t[14];e[15]=t[15];return e}},{}],304:[function(e,t,r){t.exports=a;function a(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"}},{}],305:[function(e,t,r){t.exports=a;function a(e,t,r){var a=r[0],n=r[1],i=r[2],o,s,l,u,c,f,h,p,v,d,m,g;if(t===e){e[12]=t[0]*a+t[4]*n+t[8]*i+t[12];e[13]=t[1]*a+t[5]*n+t[9]*i+t[13];e[14]=t[2]*a+t[6]*n+t[10]*i+t[14];e[15]=t[3]*a+t[7]*n+t[11]*i+t[15]}else{o=t[0];s=t[1];l=t[2];u=t[3];c=t[4];f=t[5];h=t[6];p=t[7];v=t[8];d=t[9];m=t[10];g=t[11];e[0]=o;e[1]=s;e[2]=l;e[3]=u;e[4]=c;e[5]=f;e[6]=h;e[7]=p;e[8]=v;e[9]=d;e[10]=m;e[11]=g;e[12]=o*a+c*n+v*i+t[12];e[13]=s*a+f*n+d*i+t[13];e[14]=l*a+h*n+m*i+t[14];e[15]=u*a+p*n+g*i+t[15]}return e}},{}],306:[function(e,t,r){t.exports=a;function a(e,t){if(e===t){var r=t[1],a=t[2],n=t[3],i=t[6],o=t[7],s=t[11];e[1]=t[4];e[2]=t[8];e[3]=t[12];e[4]=r;e[6]=t[9];e[7]=t[13];e[8]=a;e[9]=i;e[11]=t[14];e[12]=n;e[13]=o;e[14]=s}else{e[0]=t[0];e[1]=t[4];e[2]=t[8];e[3]=t[12];e[4]=t[1];e[5]=t[5];e[6]=t[9];e[7]=t[13];e[8]=t[2];e[9]=t[6];e[10]=t[10];e[11]=t[14];e[12]=t[3];e[13]=t[7];e[14]=t[11];e[15]=t[15]}return e}},{}],307:[function(e,t,r){"use strict";var a=e("barycentric");var n=e("polytope-closest-point/lib/closest_point_2d.js");t.exports=u;function i(e,t){var r=[0,0,0,0];for(var a=0;a<4;++a){for(var n=0;n<4;++n){r[n]+=e[4*a+n]*t[a]}}return r}function o(e,t,r,a,n){var o=i(a,i(r,i(t,[e[0],e[1],e[2],1])));for(var s=0;s<3;++s){o[s]/=o[3]}return[.5*n[0]*(1+o[0]),.5*n[1]*(1-o[1])]}function s(e,t){if(e.length===2){var r=0;var i=0;for(var o=0;o<2;++o){r+=Math.pow(t[o]-e[0][o],2);i+=Math.pow(t[o]-e[1][o],2)}r=Math.sqrt(r);i=Math.sqrt(i);if(r+i<1e-6){return[1,0]}return[i/(r+i),r/(i+r)]}else if(e.length===3){var s=[0,0];n(e[0],e[1],e[2],t,s);return a(e,s)}return[]}function l(e,t){var r=[0,0,0];for(var a=0;a<e.length;++a){var n=e[a];var i=t[a];for(var o=0;o<3;++o){r[o]+=i*n[o]}}return r}function u(e,t,r,a,n,i){if(e.length===1){return[0,e[0].slice()]}var u=new Array(e.length);for(var c=0;c<e.length;++c){u[c]=o(e[c],r,a,n,i)}var f=0;var h=Infinity;for(var c=0;c<u.length;++c){var p=0;for(var v=0;v<2;++v){p+=Math.pow(u[c][v]-t[v],2)}if(p<h){h=p;f=c}}var d=s(u,t);var m=0;for(var c=0;c<3;++c){if(d[c]<-.001||d[c]>1.0001){return null}m+=d[c]}if(Math.abs(m-1)>.001){return null}return[f,l(e,d),d]}},{barycentric:85,"polytope-closest-point/lib/closest_point_2d.js":498}],308:[function(e,t,r){var a=e("glslify");var n=a(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position, normal;\nattribute vec4 color;\nattribute vec2 uv;\n\nuniform mat4 model\n           , view\n           , projection\n           , inverseModel;\nuniform vec3 eyePosition\n           , lightPosition;\n\nvarying vec3 f_normal\n           , f_lightDirection\n           , f_eyeDirection\n           , f_data;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvec4 project(vec3 p) {\n  return projection * view * model * vec4(p, 1.0);\n}\n\nvoid main() {\n  gl_Position      = project(position);\n\n  //Lighting geometry parameters\n  vec4 cameraCoordinate = view * vec4(position , 1.0);\n  cameraCoordinate.xyz /= cameraCoordinate.w;\n  f_lightDirection = lightPosition - cameraCoordinate.xyz;\n  f_eyeDirection   = eyePosition - cameraCoordinate.xyz;\n  f_normal  = normalize((vec4(normal, 0.0) * inverseModel).xyz);\n\n  f_color          = color;\n  f_data           = position;\n  f_uv             = uv;\n}\n"]);var i=a(["#extension GL_OES_standard_derivatives : enable\n\nprecision highp float;\n#define GLSLIFY 1\n\nfloat beckmannDistribution(float x, float roughness) {\n  float NdotH = max(x, 0.0001);\n  float cos2Alpha = NdotH * NdotH;\n  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;\n  float roughness2 = roughness * roughness;\n  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;\n  return exp(tan2Alpha / roughness2) / denom;\n}\n\nfloat cookTorranceSpecular(\n  vec3 lightDirection,\n  vec3 viewDirection,\n  vec3 surfaceNormal,\n  float roughness,\n  float fresnel) {\n\n  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);\n  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);\n\n  //Half angle vector\n  vec3 H = normalize(lightDirection + viewDirection);\n\n  //Geometric term\n  float NdotH = max(dot(surfaceNormal, H), 0.0);\n  float VdotH = max(dot(viewDirection, H), 0.000001);\n  float LdotH = max(dot(lightDirection, H), 0.000001);\n  float G1 = (2.0 * NdotH * VdotN) / VdotH;\n  float G2 = (2.0 * NdotH * LdotN) / LdotH;\n  float G = min(1.0, min(G1, G2));\n  \n  //Distribution term\n  float D = beckmannDistribution(NdotH, roughness);\n\n  //Fresnel term\n  float F = pow(1.0 - VdotN, fresnel);\n\n  //Multiply terms and done\n  return  G * F * D / max(3.14159265 * VdotN, 0.000001);\n}\n\n//#pragma glslify: beckmann = require(glsl-specular-beckmann) // used in gl-surface3d\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 clipBounds[2];\nuniform float roughness\n            , fresnel\n            , kambient\n            , kdiffuse\n            , kspecular;\nuniform sampler2D texture;\n\nvarying vec3 f_normal\n           , f_lightDirection\n           , f_eyeDirection\n           , f_data;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  if (f_color.a == 0.0 ||\n    outOfRange(clipBounds[0], clipBounds[1], f_data)\n  ) discard;\n\n  vec3 N = normalize(f_normal);\n  vec3 L = normalize(f_lightDirection);\n  vec3 V = normalize(f_eyeDirection);\n\n  if(gl_FrontFacing) {\n    N = -N;\n  }\n\n  float specular = min(1.0, max(0.0, cookTorranceSpecular(L, V, N, roughness, fresnel)));\n  //float specular = max(0.0, beckmann(L, V, N, roughness)); // used in gl-surface3d\n\n  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);\n\n  vec4 surfaceColor = vec4(f_color.rgb, 1.0) * texture2D(texture, f_uv);\n  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);\n\n  gl_FragColor = litColor * f_color.a;\n}\n"]);var o=a(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 uv;\n\nuniform mat4 model, view, projection;\n\nvarying vec4 f_color;\nvarying vec3 f_data;\nvarying vec2 f_uv;\n\nvoid main() {\n  gl_Position = projection * view * model * vec4(position, 1.0);\n  f_color = color;\n  f_data  = position;\n  f_uv    = uv;\n}"]);var s=a(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 clipBounds[2];\nuniform sampler2D texture;\nuniform float opacity;\n\nvarying vec4 f_color;\nvarying vec3 f_data;\nvarying vec2 f_uv;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], f_data)) discard;\n\n  gl_FragColor = f_color * texture2D(texture, f_uv) * opacity;\n}"]);var l=a(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 uv;\nattribute float pointSize;\n\nuniform mat4 model, view, projection;\nuniform vec3 clipBounds[2];\n\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], position)) {\n\n    gl_Position = vec4(0.0, 0.0 ,0.0 ,0.0);\n  } else {\n    gl_Position = projection * view * model * vec4(position, 1.0);\n  }\n  gl_PointSize = pointSize;\n  f_color = color;\n  f_uv = uv;\n}"]);var u=a(["precision highp float;\n#define GLSLIFY 1\n\nuniform sampler2D texture;\nuniform float opacity;\n\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  vec2 pointR = gl_PointCoord.xy - vec2(0.5, 0.5);\n  if(dot(pointR, pointR) > 0.25) {\n    discard;\n  }\n  gl_FragColor = f_color * texture2D(texture, f_uv) * opacity;\n}"]);var c=a(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position;\nattribute vec4 id;\n\nuniform mat4 model, view, projection;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  gl_Position = projection * view * model * vec4(position, 1.0);\n  f_id        = id;\n  f_position  = position;\n}"]);var f=a(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3  clipBounds[2];\nuniform float pickId;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;\n\n  gl_FragColor = vec4(pickId, f_id.xyz);\n}"]);var h=a(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nattribute vec3  position;\nattribute float pointSize;\nattribute vec4  id;\n\nuniform mat4 model, view, projection;\nuniform vec3 clipBounds[2];\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], position)) {\n\n    gl_Position = vec4(0.0, 0.0, 0.0, 0.0);\n  } else {\n    gl_Position  = projection * view * model * vec4(position, 1.0);\n    gl_PointSize = pointSize;\n  }\n  f_id         = id;\n  f_position   = position;\n}"]);var p=a(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position;\n\nuniform mat4 model, view, projection;\n\nvoid main() {\n  gl_Position = projection * view * model * vec4(position, 1.0);\n}"]);var v=a(["precision highp float;\n#define GLSLIFY 1\n\nuniform vec3 contourColor;\n\nvoid main() {\n  gl_FragColor = vec4(contourColor, 1.0);\n}\n"]);r.meshShader={vertex:n,fragment:i,attributes:[{name:"position",type:"vec3"},{name:"normal",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"}]};r.wireShader={vertex:o,fragment:s,attributes:[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"}]};r.pointShader={vertex:l,fragment:u,attributes:[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"pointSize",type:"float"}]};r.pickShader={vertex:c,fragment:f,attributes:[{name:"position",type:"vec3"},{name:"id",type:"vec4"}]};r.pointPickShader={vertex:h,fragment:f,attributes:[{name:"position",type:"vec3"},{name:"pointSize",type:"float"},{name:"id",type:"vec4"}]};r.contourShader={vertex:p,fragment:v,attributes:[{name:"position",type:"vec3"}]}},{glslify:434}],309:[function(e,t,r){"use strict";var a=1e-6;var n=1e-6;var i=e("gl-shader");var o=e("gl-buffer");var s=e("gl-vao");var l=e("gl-texture2d");var u=e("normals");var c=e("gl-mat4/multiply");var f=e("gl-mat4/invert");var h=e("ndarray");var p=e("colormap");var v=e("simplicial-complex-contour");var d=e("typedarray-pool");var m=e("./lib/shaders");var g=e("./lib/closest-point");var y=m.meshShader;var x=m.wireShader;var b=m.pointShader;var _=m.pickShader;var w=m.pointPickShader;var T=m.contourShader;var k=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function M(e,t,r,a,n,i,o,s,l,u,c,f,h,p,v,d,m,g,y,x,b,_,w,T,M,A,S){this.gl=e;this.pixelRatio=1;this.cells=[];this.positions=[];this.intensity=[];this.texture=t;this.dirty=true;this.triShader=r;this.lineShader=a;this.pointShader=n;this.pickShader=i;this.pointPickShader=o;this.contourShader=s;this.trianglePositions=l;this.triangleColors=c;this.triangleNormals=h;this.triangleUVs=f;this.triangleIds=u;this.triangleVAO=p;this.triangleCount=0;this.lineWidth=1;this.edgePositions=v;this.edgeColors=m;this.edgeUVs=g;this.edgeIds=d;this.edgeVAO=y;this.edgeCount=0;this.pointPositions=x;this.pointColors=_;this.pointUVs=w;this.pointSizes=T;this.pointIds=b;this.pointVAO=M;this.pointCount=0;this.contourLineWidth=1;this.contourPositions=A;this.contourVAO=S;this.contourCount=0;this.contourColor=[0,0,0];this.contourEnable=true;this.pickVertex=true;this.pickId=1;this.bounds=[[Infinity,Infinity,Infinity],[-Infinity,-Infinity,-Infinity]];this.clipBounds=[[-Infinity,-Infinity,-Infinity],[Infinity,Infinity,Infinity]];this.lightPosition=[1e5,1e5,0];this.ambientLight=.8;this.diffuseLight=.8;this.specularLight=2;this.roughness=.5;this.fresnel=1.5;this.opacity=1;this.hasAlpha=false;this.opacityscale=false;this._model=k;this._view=k;this._projection=k;this._resolution=[1,1]}var A=M.prototype;A.isOpaque=function(){return!this.hasAlpha};A.isTransparent=function(){return this.hasAlpha};A.pickSlots=1;A.setPickBase=function(e){this.pickId=e};function S(e,t){if(!t)return 1;if(!t.length)return 1;for(var r=0;r<t.length;++r){if(t.length<2)return 1;if(t[r][0]===e)return t[r][1];if(t[r][0]>e&&r>0){var a=(t[r][0]-e)/(t[r][0]-t[r-1][0]);return t[r][1]*(1-a)+a*t[r-1][1]}}return 1}function E(e,t){var r=p({colormap:e,nshades:256,format:"rgba"});var a=new Uint8Array(256*4);for(var n=0;n<256;++n){var i=r[n];for(var o=0;o<3;++o){a[4*n+o]=i[o]}if(!t){a[4*n+3]=255*i[3]}else{a[4*n+3]=255*S(n/255,t)}}return h(a,[256,256,4],[4,0,1])}function L(e){var t=e.length;var r=new Array(t);for(var a=0;a<t;++a){r[a]=e[a][2]}return r}A.highlight=function(e){if(!e||!this.contourEnable){this.contourCount=0;return}var t=v(this.cells,this.intensity,e.intensity);var r=t.cells;var a=t.vertexIds;var n=t.vertexWeights;var i=r.length;var o=d.mallocFloat32(2*3*i);var s=0;for(var l=0;l<i;++l){var u=r[l];for(var c=0;c<2;++c){var f=u[0];if(u.length===2){f=u[c]}var h=a[f][0];var p=a[f][1];var m=n[f];var g=1-m;var y=this.positions[h];var x=this.positions[p];for(var b=0;b<3;++b){o[s++]=m*y[b]+g*x[b]}}}this.contourCount=s/3|0;this.contourPositions.update(o.subarray(0,s));d.free(o)};A.update=function(e){e=e||{};var t=this.gl;this.dirty=true;if("contourEnable"in e){this.contourEnable=e.contourEnable}if("contourColor"in e){this.contourColor=e.contourColor}if("lineWidth"in e){this.lineWidth=e.lineWidth}if("lightPosition"in e){this.lightPosition=e.lightPosition}this.hasAlpha=false;if("opacity"in e){this.opacity=e.opacity;if(this.opacity<1){this.hasAlpha=true}}if("opacityscale"in e){this.opacityscale=e.opacityscale;this.hasAlpha=true}if("ambient"in e){this.ambientLight=e.ambient}if("diffuse"in e){this.diffuseLight=e.diffuse}if("specular"in e){this.specularLight=e.specular}if("roughness"in e){this.roughness=e.roughness}if("fresnel"in e){this.fresnel=e.fresnel}if(e.texture){this.texture.dispose();this.texture=l(t,e.texture)}else if(e.colormap){this.texture.shape=[256,256];this.texture.minFilter=t.LINEAR_MIPMAP_LINEAR;this.texture.magFilter=t.LINEAR;this.texture.setPixels(E(e.colormap,this.opacityscale));this.texture.generateMipmap()}var r=e.cells;var i=e.positions;if(!i||!r){return}var o=[];var s=[];var c=[];var f=[];var h=[];var p=[];var v=[];var d=[];var m=[];var g=[];var y=[];var x=[];var b=[];var _=[];this.cells=r;this.positions=i;var w=e.vertexNormals;var T=e.cellNormals;var k=e.vertexNormalsEpsilon===void 0?a:e.vertexNormalsEpsilon;var M=e.faceNormalsEpsilon===void 0?n:e.faceNormalsEpsilon;if(e.useFacetNormals&&!T){T=u.faceNormals(r,i,M)}if(!T&&!w){w=u.vertexNormals(r,i,k)}var A=e.vertexColors;var C=e.cellColors;var I=e.meshColor||[1,1,1,1];var P=e.vertexUVs;var O=e.vertexIntensity;var z=e.cellUVs;var D=e.cellIntensity;var R=Infinity;var F=-Infinity;if(!P&&!z){if(O){if(e.vertexIntensityBounds){R=+e.vertexIntensityBounds[0];F=+e.vertexIntensityBounds[1]}else{for(var B=0;B<O.length;++B){var N=O[B];R=Math.min(R,N);F=Math.max(F,N)}}}else if(D){if(e.cellIntensityBounds){R=+e.cellIntensityBounds[0];F=+e.cellIntensityBounds[1]}else{for(var B=0;B<D.length;++B){var N=D[B];R=Math.min(R,N);F=Math.max(F,N)}}}else{for(var B=0;B<i.length;++B){var N=i[B][2];R=Math.min(R,N);F=Math.max(F,N)}}}if(O){this.intensity=O}else if(D){this.intensity=D}else{this.intensity=L(i)}this.pickVertex=!(D||C);var j=e.pointSizes;var U=e.pointSize||1;this.bounds=[[Infinity,Infinity,Infinity],[-Infinity,-Infinity,-Infinity]];for(var B=0;B<i.length;++B){var V=i[B];for(var H=0;H<3;++H){if(isNaN(V[H])||!isFinite(V[H])){continue}this.bounds[0][H]=Math.min(this.bounds[0][H],V[H]);this.bounds[1][H]=Math.max(this.bounds[1][H],V[H])}}var q=0;var G=0;var Y=0;e:for(var B=0;B<r.length;++B){var W=r[B];switch(W.length){case 1:var X=W[0];var V=i[X];for(var H=0;H<3;++H){if(isNaN(V[H])||!isFinite(V[H])){continue e}}g.push(V[0],V[1],V[2]);var Z;if(A){Z=A[X]}else if(C){Z=C[B]}else{Z=I}if(this.opacityscale&&O){s.push(Z[0],Z[1],Z[2],this.opacity*S((O[X]-R)/(F-R),this.opacityscale))}else if(Z.length===3){y.push(Z[0],Z[1],Z[2],this.opacity)}else{y.push(Z[0],Z[1],Z[2],Z[3]*this.opacity);if(Z[3]<1)this.hasAlpha=true}var J;if(P){J=P[X]}else if(O){J=[(O[X]-R)/(F-R),0]}else if(z){J=z[B]}else if(D){J=[(D[B]-R)/(F-R),0]}else{J=[(V[2]-R)/(F-R),0]}x.push(J[0],J[1]);if(j){b.push(j[X])}else{b.push(U)}_.push(B);Y+=1;break;case 2:for(var H=0;H<2;++H){var X=W[H];var V=i[X];for(var K=0;K<3;++K){if(isNaN(V[K])||!isFinite(V[K])){continue e}}}for(var H=0;H<2;++H){var X=W[H];var V=i[X];p.push(V[0],V[1],V[2]);var Z;if(A){Z=A[X]}else if(C){Z=C[B]}else{Z=I}if(this.opacityscale&&O){s.push(Z[0],Z[1],Z[2],this.opacity*S((O[X]-R)/(F-R),this.opacityscale))}else if(Z.length===3){v.push(Z[0],Z[1],Z[2],this.opacity)}else{v.push(Z[0],Z[1],Z[2],Z[3]*this.opacity);if(Z[3]<1)this.hasAlpha=true}var J;if(P){J=P[X]}else if(O){J=[(O[X]-R)/(F-R),0]}else if(z){J=z[B]}else if(D){J=[(D[B]-R)/(F-R),0]}else{J=[(V[2]-R)/(F-R),0]}d.push(J[0],J[1]);m.push(B)}G+=1;break;case 3:for(var H=0;H<3;++H){var X=W[H];var V=i[X];for(var K=0;K<3;++K){if(isNaN(V[K])||!isFinite(V[K])){continue e}}}for(var H=0;H<3;++H){var X=W[2-H];var V=i[X];o.push(V[0],V[1],V[2]);var Z;if(A){Z=A[X]}else if(C){Z=C[B]}else{Z=I}if(!Z){s.push(.5,.5,.5,1)}else if(this.opacityscale&&O){s.push(Z[0],Z[1],Z[2],this.opacity*S((O[X]-R)/(F-R),this.opacityscale))}else if(Z.length===3){s.push(Z[0],Z[1],Z[2],this.opacity)}else{s.push(Z[0],Z[1],Z[2],Z[3]*this.opacity);if(Z[3]<1)this.hasAlpha=true}var J;if(P){J=P[X]}else if(O){J=[(O[X]-R)/(F-R),0]}else if(z){J=z[B]}else if(D){J=[(D[B]-R)/(F-R),0]}else{J=[(V[2]-R)/(F-R),0]}f.push(J[0],J[1]);var Q;if(w){Q=w[X]}else{Q=T[B]}c.push(Q[0],Q[1],Q[2]);h.push(B)}q+=1;break;default:break}}this.pointCount=Y;this.edgeCount=G;this.triangleCount=q;this.pointPositions.update(g);this.pointColors.update(y);this.pointUVs.update(x);this.pointSizes.update(b);this.pointIds.update(new Uint32Array(_));this.edgePositions.update(p);this.edgeColors.update(v);this.edgeUVs.update(d);this.edgeIds.update(new Uint32Array(m));this.trianglePositions.update(o);this.triangleColors.update(s);this.triangleUVs.update(f);this.triangleNormals.update(c);this.triangleIds.update(new Uint32Array(h))};A.drawTransparent=A.draw=function(e){e=e||{};var t=this.gl;var r=e.model||k;var a=e.view||k;var n=e.projection||k;var i=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]];for(var o=0;o<3;++o){i[0][o]=Math.max(i[0][o],this.clipBounds[0][o]);i[1][o]=Math.min(i[1][o],this.clipBounds[1][o])}var s={model:r,view:a,projection:n,inverseModel:k.slice(),clipBounds:i,kambient:this.ambientLight,kdiffuse:this.diffuseLight,kspecular:this.specularLight,roughness:this.roughness,fresnel:this.fresnel,eyePosition:[0,0,0],lightPosition:[0,0,0],contourColor:this.contourColor,texture:0};s.inverseModel=f(s.inverseModel,s.model);t.disable(t.CULL_FACE);this.texture.bind(0);var l=new Array(16);c(l,s.view,s.model);c(l,s.projection,l);f(l,l);for(var o=0;o<3;++o){s.eyePosition[o]=l[12+o]/l[15]}var u=l[15];for(var o=0;o<3;++o){u+=this.lightPosition[o]*l[4*o+3]}for(var o=0;o<3;++o){var h=l[12+o];for(var p=0;p<3;++p){h+=l[4*p+o]*this.lightPosition[p]}s.lightPosition[o]=h/u}if(this.triangleCount>0){var v=this.triShader;v.bind();v.uniforms=s;this.triangleVAO.bind();t.drawArrays(t.TRIANGLES,0,this.triangleCount*3);this.triangleVAO.unbind()}if(this.edgeCount>0&&this.lineWidth>0){var v=this.lineShader;v.bind();v.uniforms=s;this.edgeVAO.bind();t.lineWidth(this.lineWidth*this.pixelRatio);t.drawArrays(t.LINES,0,this.edgeCount*2);this.edgeVAO.unbind()}if(this.pointCount>0){var v=this.pointShader;v.bind();v.uniforms=s;this.pointVAO.bind();t.drawArrays(t.POINTS,0,this.pointCount);this.pointVAO.unbind()}if(this.contourEnable&&this.contourCount>0&&this.contourLineWidth>0){var v=this.contourShader;v.bind();v.uniforms=s;this.contourVAO.bind();t.drawArrays(t.LINES,0,this.contourCount);this.contourVAO.unbind()}};A.drawPick=function(e){e=e||{};var t=this.gl;var r=e.model||k;var a=e.view||k;var n=e.projection||k;var i=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]];for(var o=0;o<3;++o){i[0][o]=Math.max(i[0][o],this.clipBounds[0][o]);i[1][o]=Math.min(i[1][o],this.clipBounds[1][o])}this._model=[].slice.call(r);this._view=[].slice.call(a);this._projection=[].slice.call(n);this._resolution=[t.drawingBufferWidth,t.drawingBufferHeight];var s={model:r,view:a,projection:n,clipBounds:i,pickId:this.pickId/255};var l=this.pickShader;l.bind();l.uniforms=s;if(this.triangleCount>0){this.triangleVAO.bind();t.drawArrays(t.TRIANGLES,0,this.triangleCount*3);this.triangleVAO.unbind()}if(this.edgeCount>0){this.edgeVAO.bind();t.lineWidth(this.lineWidth*this.pixelRatio);t.drawArrays(t.LINES,0,this.edgeCount*2);this.edgeVAO.unbind()}if(this.pointCount>0){var l=this.pointPickShader;l.bind();l.uniforms=s;this.pointVAO.bind();t.drawArrays(t.POINTS,0,this.pointCount);this.pointVAO.unbind()}};A.pick=function(e){if(!e){return null}if(e.id!==this.pickId){return null}var t=e.value[0]+256*e.value[1]+65536*e.value[2];var r=this.cells[t];var a=this.positions;var n=new Array(r.length);for(var i=0;i<r.length;++i){n[i]=a[r[i]]}var o=e.coord[0];var s=e.coord[1];if(!this.pickVertex){var l=this.positions[r[0]];var u=this.positions[r[1]];var c=this.positions[r[2]];var f=[(l[0]+u[0]+c[0])/3,(l[1]+u[1]+c[1])/3,(l[2]+u[2]+c[2])/3];return{_cellCenter:true,position:[o,s],index:t,cell:r,cellId:t,intensity:this.intensity[t],dataCoordinate:f}}var h=g(n,[o*this.pixelRatio,this._resolution[1]-s*this.pixelRatio],this._model,this._view,this._projection,this._resolution);if(!h){return null}var p=h[2];var v=0;for(var i=0;i<r.length;++i){v+=p[i]*this.intensity[r[i]]}return{position:h[1],index:r[h[0]],cell:r,cellId:t,intensity:v,dataCoordinate:this.positions[r[h[0]]]}};A.dispose=function(){this.texture.dispose();this.triShader.dispose();this.lineShader.dispose();this.pointShader.dispose();this.pickShader.dispose();this.pointPickShader.dispose();this.triangleVAO.dispose();this.trianglePositions.dispose();this.triangleColors.dispose();this.triangleUVs.dispose();this.triangleNormals.dispose();this.triangleIds.dispose();this.edgeVAO.dispose();this.edgePositions.dispose();this.edgeColors.dispose();this.edgeUVs.dispose();this.edgeIds.dispose();this.pointVAO.dispose();this.pointPositions.dispose();this.pointColors.dispose();this.pointUVs.dispose();this.pointSizes.dispose();this.pointIds.dispose();this.contourVAO.dispose();this.contourPositions.dispose();this.contourShader.dispose()};function C(e){var t=i(e,y.vertex,y.fragment);t.attributes.position.location=0;t.attributes.color.location=2;t.attributes.uv.location=3;t.attributes.normal.location=4;return t}function I(e){var t=i(e,x.vertex,x.fragment);t.attributes.position.location=0;t.attributes.color.location=2;t.attributes.uv.location=3;return t}function P(e){var t=i(e,b.vertex,b.fragment);t.attributes.position.location=0;t.attributes.color.location=2;t.attributes.uv.location=3;t.attributes.pointSize.location=4;return t}function O(e){var t=i(e,_.vertex,_.fragment);t.attributes.position.location=0;t.attributes.id.location=1;return t}function z(e){var t=i(e,w.vertex,w.fragment);t.attributes.position.location=0;t.attributes.id.location=1;t.attributes.pointSize.location=4;return t}function D(e){var t=i(e,T.vertex,T.fragment);t.attributes.position.location=0;return t}function R(e,t){if(arguments.length===1){t=e;e=t.gl}var r=e.getExtension("OES_standard_derivatives")||e.getExtension("MOZ_OES_standard_derivatives")||e.getExtension("WEBKIT_OES_standard_derivatives");if(!r)throw new Error("derivatives not supported");var a=C(e);var n=I(e);var i=P(e);var u=O(e);var c=z(e);var f=D(e);var p=l(e,h(new Uint8Array([255,255,255,255]),[1,1,4]));p.generateMipmap();p.minFilter=e.LINEAR_MIPMAP_LINEAR;p.magFilter=e.LINEAR;var v=o(e);var d=o(e);var m=o(e);var g=o(e);var y=o(e);var x=s(e,[{buffer:v,type:e.FLOAT,size:3},{buffer:y,type:e.UNSIGNED_BYTE,size:4,normalized:true},{buffer:d,type:e.FLOAT,size:4},{buffer:m,type:e.FLOAT,size:2},{buffer:g,type:e.FLOAT,size:3}]);var b=o(e);var _=o(e);var w=o(e);var T=o(e);var k=s(e,[{buffer:b,type:e.FLOAT,size:3},{buffer:T,type:e.UNSIGNED_BYTE,size:4,normalized:true},{buffer:_,type:e.FLOAT,size:4},{buffer:w,type:e.FLOAT,size:2}]);var A=o(e);var S=o(e);var E=o(e);var L=o(e);var R=o(e);var F=s(e,[{buffer:A,type:e.FLOAT,size:3},{buffer:R,type:e.UNSIGNED_BYTE,size:4,normalized:true},{buffer:S,type:e.FLOAT,size:4},{buffer:E,type:e.FLOAT,size:2},{buffer:L,type:e.FLOAT,size:1}]);var B=o(e);var N=s(e,[{buffer:B,type:e.FLOAT,size:3}]);var j=new M(e,p,a,n,i,u,c,f,v,y,d,m,g,x,b,T,_,w,k,A,R,S,E,L,F,B,N);j.update(t);return j}t.exports=R},{"./lib/closest-point":307,"./lib/shaders":308,colormap:137,"gl-buffer":261,"gl-mat4/invert":293,"gl-mat4/multiply":295,"gl-shader":332,"gl-texture2d":348,"gl-vao":353,ndarray:472,normals:475,"simplicial-complex-contour":543,"typedarray-pool":601}],310:[function(e,t,r){"use strict";t.exports=l;var a=e("gl-buffer");var n=e("gl-shader");var i=e("./shaders");function o(e,t,r){this.plot=e;this.vbo=t;this.shader=r}var s=o.prototype;s.bind=function(){var e=this.shader;this.vbo.bind();this.shader.bind();e.attributes.coord.pointer();e.uniforms.screenBox=this.plot.screenBox};s.drawBox=function(){var e=[0,0];var t=[0,0];return function(r,a,n,i,o){var s=this.plot;var l=this.shader;var u=s.gl;e[0]=r;e[1]=a;t[0]=n;t[1]=i;l.uniforms.lo=e;l.uniforms.hi=t;l.uniforms.color=o;u.drawArrays(u.TRIANGLE_STRIP,0,4)}}();s.dispose=function(){this.vbo.dispose();this.shader.dispose()};function l(e){var t=e.gl;var r=a(t,[0,0,0,1,1,0,1,1]);var s=n(t,i.boxVert,i.lineFrag);return new o(e,r,s)}},{"./shaders":313,"gl-buffer":261,"gl-shader":332}],311:[function(e,t,r){"use strict";t.exports=c;var a=e("gl-buffer");var n=e("gl-shader");var i=e("binary-search-bounds");var o=e("./shaders");function s(e,t,r,a){this.plot=e;this.vbo=t;this.shader=r;this.tickShader=a;this.ticks=[[],[]]}function l(e,t){return e-t}var u=s.prototype;u.draw=function(){var e=[0,0];var t=[0,0];var r=[0,0];return function(){var a=this.plot;var n=this.vbo;var i=this.shader;var o=this.ticks;var s=a.gl;var l=a._tickBounds;var u=a.dataBox;var c=a.viewBox;var f=a.gridLineWidth;var h=a.gridLineColor;var p=a.gridLineEnable;var v=a.pixelRatio;for(var d=0;d<2;++d){var m=l[d];var g=l[d+2];var y=g-m;var x=.5*(u[d+2]+u[d]);var b=u[d+2]-u[d];t[d]=2*y/b;e[d]=2*(m-x)/b}i.bind();n.bind();i.attributes.dataCoord.pointer();i.uniforms.dataShift=e;i.uniforms.dataScale=t;var _=0;for(var d=0;d<2;++d){r[0]=r[1]=0;r[d]=1;i.uniforms.dataAxis=r;i.uniforms.lineWidth=f[d]/(c[d+2]-c[d])*v;i.uniforms.color=h[d];var w=o[d].length*6;if(p[d]&&w){s.drawArrays(s.TRIANGLES,_,w)}_+=w}}}();u.drawTickMarks=function(){var e=[0,0];var t=[0,0];var r=[1,0];var a=[0,1];var n=[0,0];var o=[0,0];return function(){var s=this.plot;var u=this.vbo;var c=this.tickShader;var f=this.ticks;var h=s.gl;var p=s._tickBounds;var v=s.dataBox;var d=s.viewBox;var m=s.pixelRatio;var g=s.screenBox;var y=g[2]-g[0];var x=g[3]-g[1];var b=d[2]-d[0];var _=d[3]-d[1];for(var w=0;w<2;++w){var T=p[w];var k=p[w+2];var M=k-T;var A=.5*(v[w+2]+v[w]);var S=v[w+2]-v[w];t[w]=2*M/S;e[w]=2*(T-A)/S}t[0]*=b/y;e[0]*=b/y;t[1]*=_/x;e[1]*=_/x;c.bind();u.bind();c.attributes.dataCoord.pointer();var E=c.uniforms;E.dataShift=e;E.dataScale=t;var L=s.tickMarkLength;var C=s.tickMarkWidth;var I=s.tickMarkColor;var P=0;var O=f[0].length*6;var z=Math.min(i.ge(f[0],(v[0]-p[0])/(p[2]-p[0]),l),f[0].length);var D=Math.min(i.gt(f[0],(v[2]-p[0])/(p[2]-p[0]),l),f[0].length);var R=P+6*z;var F=6*Math.max(0,D-z);var B=Math.min(i.ge(f[1],(v[1]-p[1])/(p[3]-p[1]),l),f[1].length);var N=Math.min(i.gt(f[1],(v[3]-p[1])/(p[3]-p[1]),l),f[1].length);var j=O+6*B;var U=6*Math.max(0,N-B);n[0]=2*(d[0]-L[1])/y-1;n[1]=(d[3]+d[1])/x-1;o[0]=L[1]*m/y;o[1]=C[1]*m/x;if(U){E.color=I[1];E.tickScale=o;E.dataAxis=a;E.screenOffset=n;h.drawArrays(h.TRIANGLES,j,U)}n[0]=(d[2]+d[0])/y-1;n[1]=2*(d[1]-L[0])/x-1;o[0]=C[0]*m/y;o[1]=L[0]*m/x;if(F){E.color=I[0];E.tickScale=o;E.dataAxis=r;E.screenOffset=n;h.drawArrays(h.TRIANGLES,R,F)}n[0]=2*(d[2]+L[3])/y-1;n[1]=(d[3]+d[1])/x-1;o[0]=L[3]*m/y;o[1]=C[3]*m/x;if(U){E.color=I[3];E.tickScale=o;E.dataAxis=a;E.screenOffset=n;h.drawArrays(h.TRIANGLES,j,U)}n[0]=(d[2]+d[0])/y-1;n[1]=2*(d[3]+L[2])/x-1;o[0]=C[2]*m/y;o[1]=L[2]*m/x;if(F){E.color=I[2];E.tickScale=o;E.dataAxis=r;E.screenOffset=n;h.drawArrays(h.TRIANGLES,R,F)}}}();u.update=function(){var e=[1,1,-1,-1,1,-1];var t=[1,-1,1,1,-1,-1];return function(r){var a=r.ticks;var n=r.bounds;var i=new Float32Array(6*3*(a[0].length+a[1].length));var o=this.plot.zeroLineEnable;var s=0;var l=[[],[]];for(var u=0;u<2;++u){var c=l[u];var f=a[u];var h=n[u];var p=n[u+2];for(var v=0;v<f.length;++v){var d=(f[v].x-h)/(p-h);c.push(d);for(var m=0;m<6;++m){i[s++]=d;i[s++]=e[m];i[s++]=t[m]}}}this.ticks=l;this.vbo.update(i)}}();u.dispose=function(){this.vbo.dispose();this.shader.dispose();this.tickShader.dispose()};function c(e){var t=e.gl;var r=a(t);var i=n(t,o.gridVert,o.gridFrag);var l=n(t,o.tickVert,o.gridFrag);var u=new s(e,r,i,l);return u}},{"./shaders":313,"binary-search-bounds":103,"gl-buffer":261,"gl-shader":332}],312:[function(e,t,r){"use strict";t.exports=l;var a=e("gl-buffer");var n=e("gl-shader");var i=e("./shaders");function o(e,t,r){this.plot=e;this.vbo=t;this.shader=r}var s=o.prototype;s.bind=function(){var e=this.shader;this.vbo.bind();this.shader.bind();e.attributes.coord.pointer();e.uniforms.screenBox=this.plot.screenBox};s.drawLine=function(){var e=[0,0];var t=[0,0];return function(r,a,n,i,o,s){var l=this.plot;var u=this.shader;var c=l.gl;e[0]=r;e[1]=a;t[0]=n;t[1]=i;u.uniforms.start=e;u.uniforms.end=t;u.uniforms.width=o*l.pixelRatio;u.uniforms.color=s;c.drawArrays(c.TRIANGLE_STRIP,0,4)}}();s.dispose=function(){this.vbo.dispose();this.shader.dispose()};function l(e){var t=e.gl;var r=a(t,[-1,-1,-1,1,1,-1,1,1]);var s=n(t,i.lineVert,i.lineFrag);var l=new o(e,r,s);return l}},{"./shaders":313,"gl-buffer":261,"gl-shader":332}],313:[function(e,t,r){"use strict";var a=e("glslify");var n=a(["precision lowp float;\n#define GLSLIFY 1\nuniform vec4 color;\nvoid main() {\n  gl_FragColor = vec4(color.xyz * color.w, color.w);\n}\n"]);t.exports={lineVert:a(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 coord;\n\nuniform vec4 screenBox;\nuniform vec2 start, end;\nuniform float width;\n\nvec2 perp(vec2 v) {\n  return vec2(v.y, -v.x);\n}\n\nvec2 screen(vec2 v) {\n  return 2.0 * (v - screenBox.xy) / (screenBox.zw - screenBox.xy) - 1.0;\n}\n\nvoid main() {\n  vec2 delta = normalize(perp(start - end));\n  vec2 offset = mix(start, end, 0.5 * (coord.y+1.0));\n  gl_Position = vec4(screen(offset + 0.5 * width * delta * coord.x), 0, 1);\n}\n"]),lineFrag:n,textVert:a(["#define GLSLIFY 1\nattribute vec3 textCoordinate;\n\nuniform vec2 dataScale, dataShift, dataAxis, screenOffset, textScale;\nuniform float angle;\n\nvoid main() {\n  float dataOffset  = textCoordinate.z;\n  vec2 glyphOffset  = textCoordinate.xy;\n  mat2 glyphMatrix = mat2(cos(angle), sin(angle), -sin(angle), cos(angle));\n  vec2 screenCoordinate = dataAxis * (dataScale * dataOffset + dataShift) +\n    glyphMatrix * glyphOffset * textScale + screenOffset;\n  gl_Position = vec4(screenCoordinate, 0, 1);\n}\n"]),textFrag:n,gridVert:a(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 dataCoord;\n\nuniform vec2 dataAxis, dataShift, dataScale;\nuniform float lineWidth;\n\nvoid main() {\n  vec2 pos = dataAxis * (dataScale * dataCoord.x + dataShift);\n  pos += 10.0 * dataCoord.y * vec2(dataAxis.y, -dataAxis.x) + dataCoord.z * lineWidth;\n  gl_Position = vec4(pos, 0, 1);\n}\n"]),gridFrag:n,boxVert:a(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 coord;\n\nuniform vec4 screenBox;\nuniform vec2 lo, hi;\n\nvec2 screen(vec2 v) {\n  return 2.0 * (v - screenBox.xy) / (screenBox.zw - screenBox.xy) - 1.0;\n}\n\nvoid main() {\n  gl_Position = vec4(screen(mix(lo, hi, coord)), 0, 1);\n}\n"]),tickVert:a(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 dataCoord;\n\nuniform vec2 dataAxis, dataShift, dataScale, screenOffset, tickScale;\n\nvoid main() {\n  vec2 pos = dataAxis * (dataScale * dataCoord.x + dataShift);\n  gl_Position = vec4(pos + tickScale*dataCoord.yz + screenOffset, 0, 1);\n}\n"])}},{glslify:315}],314:[function(e,t,r){"use strict";t.exports=c;var a=e("gl-buffer");var n=e("gl-shader");var i=e("text-cache");var o=e("binary-search-bounds");var s=e("./shaders");function l(e,t,r){this.plot=e;this.vbo=t;this.shader=r;this.tickOffset=[[],[]];this.tickX=[[],[]];this.labelOffset=[0,0];this.labelCount=[0,0]}var u=l.prototype;u.drawTicks=function(){var e=[0,0];var t=[0,0];var r=[0,0];return function(a){var n=this.plot;var i=this.shader;var s=this.tickX[a];var l=this.tickOffset[a];var u=n.gl;var c=n.viewBox;var f=n.dataBox;var h=n.screenBox;var p=n.pixelRatio;var v=n.tickEnable;var d=n.tickPad;var m=n.tickColor;var g=n.tickAngle;var y=n.labelEnable;var x=n.labelPad;var b=n.labelColor;var _=n.labelAngle;var w=this.labelOffset[a];var T=this.labelCount[a];var k=o.lt(s,f[a]);var M=o.le(s,f[a+2]);e[0]=e[1]=0;e[a]=1;t[a]=(c[2+a]+c[a])/(h[2+a]-h[a])-1;var A=2/h[2+(a^1)]-h[a^1];t[a^1]=A*c[a^1]-1;if(v[a]){t[a^1]-=A*p*d[a];if(k<M&&l[M]>l[k]){i.uniforms.dataAxis=e;i.uniforms.screenOffset=t;i.uniforms.color=m[a];i.uniforms.angle=g[a];u.drawArrays(u.TRIANGLES,l[k],l[M]-l[k])}}if(y[a]&&T){t[a^1]-=A*p*x[a];i.uniforms.dataAxis=r;i.uniforms.screenOffset=t;i.uniforms.color=b[a];i.uniforms.angle=_[a];u.drawArrays(u.TRIANGLES,w,T)}t[a^1]=A*c[2+(a^1)]-1;if(v[a+2]){t[a^1]+=A*p*d[a+2];if(k<M&&l[M]>l[k]){i.uniforms.dataAxis=e;i.uniforms.screenOffset=t;i.uniforms.color=m[a+2];i.uniforms.angle=g[a+2];u.drawArrays(u.TRIANGLES,l[k],l[M]-l[k])}}if(y[a+2]&&T){t[a^1]+=A*p*x[a+2];i.uniforms.dataAxis=r;i.uniforms.screenOffset=t;i.uniforms.color=b[a+2];i.uniforms.angle=_[a+2];u.drawArrays(u.TRIANGLES,w,T)}}}();u.drawTitle=function(){var e=[0,0];var t=[0,0];return function(){var r=this.plot;var a=this.shader;var n=r.gl;var i=r.screenBox;var o=r.titleCenter;var s=r.titleAngle;var l=r.titleColor;var u=r.pixelRatio;if(!this.titleCount){return}for(var c=0;c<2;++c){t[c]=2*(o[c]*u-i[c])/(i[2+c]-i[c])-1}a.bind();a.uniforms.dataAxis=e;a.uniforms.screenOffset=t;a.uniforms.angle=s;a.uniforms.color=l;n.drawArrays(n.TRIANGLES,this.titleOffset,this.titleCount)}}();u.bind=function(){var e=[0,0];var t=[0,0];var r=[0,0];return function(){var a=this.plot;var n=this.shader;var i=a._tickBounds;var o=a.dataBox;var s=a.screenBox;var l=a.viewBox;n.bind();for(var u=0;u<2;++u){var c=i[u];var f=i[u+2];var h=f-c;var p=.5*(o[u+2]+o[u]);var v=o[u+2]-o[u];var d=l[u];var m=l[u+2];var g=m-d;var y=s[u];var x=s[u+2];var b=x-y;t[u]=2*h/v*g/b;e[u]=2*(c-p)/v*g/b}r[1]=2*a.pixelRatio/(s[3]-s[1]);r[0]=r[1]*(s[3]-s[1])/(s[2]-s[0]);n.uniforms.dataScale=t;n.uniforms.dataShift=e;n.uniforms.textScale=r;this.vbo.bind();n.attributes.textCoordinate.pointer()}}();u.update=function(e){var t=[];var r=e.ticks;var a=e.bounds;var n,o,s,l,u,c;for(c=0;c<2;++c){var f=[Math.floor(t.length/3)],h=[-Infinity];var p=r[c];for(n=0;n<p.length;++n){var v=p[n];var d=v.x;var m=v.text;var g=v.font||"sans-serif";u=v.fontSize||12;var y=1/(a[c+2]-a[c]);var x=a[c];var b=m.split("\n");for(var _=0;_<b.length;_++){l=i(g,b[_]).data;for(o=0;o<l.length;o+=2){t.push(l[o]*u,-l[o+1]*u-_*u*1.2,(d-x)*y)}}f.push(Math.floor(t.length/3));h.push(d)}this.tickOffset[c]=f;this.tickX[c]=h}for(c=0;c<2;++c){this.labelOffset[c]=Math.floor(t.length/3);l=i(e.labelFont[c],e.labels[c],{textAlign:"center"}).data;u=e.labelSize[c];for(n=0;n<l.length;n+=2){t.push(l[n]*u,-l[n+1]*u,0)}this.labelCount[c]=Math.floor(t.length/3)-this.labelOffset[c]}this.titleOffset=Math.floor(t.length/3);l=i(e.titleFont,e.title).data;u=e.titleSize;for(n=0;n<l.length;n+=2){t.push(l[n]*u,-l[n+1]*u,0)}this.titleCount=Math.floor(t.length/3)-this.titleOffset;this.vbo.update(t)};u.dispose=function(){this.vbo.dispose();this.shader.dispose()};function c(e){var t=e.gl;var r=a(t);var i=n(t,s.textVert,s.textFrag);var o=new l(e,r,i);return o}},{"./shaders":313,"binary-search-bounds":103,"gl-buffer":261,"gl-shader":332,"text-cache":581}],315:[function(e,t,r){arguments[4][268][0].apply(r,arguments)},{dup:268}],316:[function(e,t,r){"use strict";t.exports=p;var a=e("gl-select-static");var n=e("./lib/grid");var i=e("./lib/text");var o=e("./lib/line");var s=e("./lib/box");function l(e,t){this.gl=e;this.pickBuffer=t;this.screenBox=[0,0,e.drawingBufferWidth,e.drawingBufferHeight];this.viewBox=[0,0,0,0];this.dataBox=[-10,-10,10,10];this.gridLineEnable=[true,true];this.gridLineWidth=[1,1];this.gridLineColor=[[0,0,0,1],[0,0,0,1]];this.pixelRatio=1;this.tickMarkLength=[0,0,0,0];this.tickMarkWidth=[0,0,0,0];this.tickMarkColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.tickPad=[15,15,15,15];this.tickAngle=[0,0,0,0];this.tickEnable=[true,true,true,true];this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.labelPad=[15,15,15,15];this.labelAngle=[0,Math.PI/2,0,3*Math.PI/2];this.labelEnable=[true,true,true,true];this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.titleCenter=[0,0];this.titleEnable=true;this.titleAngle=0;this.titleColor=[0,0,0,1];this.borderColor=[0,0,0,0];this.backgroundColor=[0,0,0,0];this.zeroLineEnable=[true,true];this.zeroLineWidth=[4,4];this.zeroLineColor=[[0,0,0,1],[0,0,0,1]];this.borderLineEnable=[true,true,true,true];this.borderLineWidth=[2,2,2,2];this.borderLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.grid=null;this.text=null;this.line=null;this.box=null;this.objects=[];this.overlays=[];this._tickBounds=[Infinity,Infinity,-Infinity,-Infinity];this.static=false;this.dirty=false;this.pickDirty=false;this.pickDelay=120;this.pickRadius=10;this._pickTimeout=null;this._drawPick=this.drawPick.bind(this);this._depthCounter=0}var u=l.prototype;u.setDirty=function(){this.dirty=this.pickDirty=true};u.setOverlayDirty=function(){this.dirty=true};u.nextDepthValue=function(){return this._depthCounter++/65536};function c(e,t,r){var a=.5*(r+1);return Math.floor((1-a)*e+a*t)|0}u.draw=function(){var e=[0,0,0,0];return function(){var e=this.gl;var t=this.screenBox;var r=this.viewBox;var a=this.dataBox;var n=this.pixelRatio;var i=this.grid;var o=this.line;var s=this.text;var l=this.objects;this._depthCounter=0;if(this.pickDirty){if(this._pickTimeout){clearTimeout(this._pickTimeout)}this.pickDirty=false;this._pickTimeout=setTimeout(this._drawPick,this.pickDelay)}if(!this.dirty){return}this.dirty=false;e.bindFramebuffer(e.FRAMEBUFFER,null);e.enable(e.SCISSOR_TEST);e.disable(e.DEPTH_TEST);e.depthFunc(e.LESS);e.depthMask(false);e.enable(e.BLEND);e.blendEquation(e.FUNC_ADD,e.FUNC_ADD);e.blendFunc(e.ONE,e.ONE_MINUS_SRC_ALPHA);if(this.borderColor){e.scissor(t[0],t[1],t[2]-t[0],t[3]-t[1]);var u=this.borderColor;e.clearColor(u[0]*u[3],u[1]*u[3],u[2]*u[3],u[3]);e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT)}e.scissor(r[0],r[1],r[2]-r[0],r[3]-r[1]);e.viewport(r[0],r[1],r[2]-r[0],r[3]-r[1]);var c=this.backgroundColor;e.clearColor(c[0]*c[3],c[1]*c[3],c[2]*c[3],c[3]);e.clear(e.COLOR_BUFFER_BIT);i.draw();var f=this.zeroLineEnable;var h=this.zeroLineColor;var p=this.zeroLineWidth;if(f[0]||f[1]){o.bind();for(var v=0;v<2;++v){if(!f[v]||!(a[v]<=0&&a[v+2]>=0)){continue}var d=t[v]-a[v]*(t[v+2]-t[v])/(a[v+2]-a[v]);if(v===0){o.drawLine(d,t[1],d,t[3],p[v],h[v])}else{o.drawLine(t[0],d,t[2],d,p[v],h[v])}}}for(var v=0;v<l.length;++v){l[v].draw()}e.viewport(t[0],t[1],t[2]-t[0],t[3]-t[1]);e.scissor(t[0],t[1],t[2]-t[0],t[3]-t[1]);this.grid.drawTickMarks();o.bind();var m=this.borderLineEnable;var g=this.borderLineWidth;var y=this.borderLineColor;if(m[1]){o.drawLine(r[0],r[1]-.5*g[1]*n,r[0],r[3]+.5*g[3]*n,g[1],y[1])}if(m[0]){o.drawLine(r[0]-.5*g[0]*n,r[1],r[2]+.5*g[2]*n,r[1],g[0],y[0])}if(m[3]){o.drawLine(r[2],r[1]-.5*g[1]*n,r[2],r[3]+.5*g[3]*n,g[3],y[3])}if(m[2]){o.drawLine(r[0]-.5*g[0]*n,r[3],r[2]+.5*g[2]*n,r[3],g[2],y[2])}s.bind();for(var v=0;v<2;++v){s.drawTicks(v)}if(this.titleEnable){s.drawTitle()}var x=this.overlays;for(var v=0;v<x.length;++v){x[v].draw()}e.disable(e.SCISSOR_TEST);e.disable(e.BLEND);e.depthMask(true)}}();u.drawPick=function(){return function(){if(this.static)return;var e=this.pickBuffer;var t=this.gl;this._pickTimeout=null;e.begin();var r=1;var a=this.objects;for(var n=0;n<a.length;++n){r=a[n].drawPick(r)}e.end()}}();u.pick=function(){return function(e,t){if(this.static)return;var r=this.pixelRatio;var a=this.pickPixelRatio;var n=this.viewBox;var i=Math.round((e-n[0]/r)*a)|0;var o=Math.round((t-n[1]/r)*a)|0;var s=this.pickBuffer.query(i,o,this.pickRadius);if(!s){return null}var l=s.id+(s.value[0]<<8)+(s.value[1]<<16)+(s.value[2]<<24);var u=this.objects;for(var c=0;c<u.length;++c){var f=u[c].pick(i,o,l);if(f){return f}}return null}}();function f(e){var t=e.slice();for(var r=0;r<t.length;++r){t[r]=t[r].slice()}return t}function h(e,t){return e.x-t.x}u.setScreenBox=function(e){var t=this.screenBox;var r=this.pixelRatio;t[0]=Math.round(e[0]*r)|0;t[1]=Math.round(e[1]*r)|0;t[2]=Math.round(e[2]*r)|0;t[3]=Math.round(e[3]*r)|0;this.setDirty()};u.setDataBox=function(e){var t=this.dataBox;var r=t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||t[3]!==e[3];if(r){t[0]=e[0];t[1]=e[1];t[2]=e[2];t[3]=e[3];this.setDirty()}};u.setViewBox=function(e){var t=this.pixelRatio;var r=this.viewBox;r[0]=Math.round(e[0]*t)|0;r[1]=Math.round(e[1]*t)|0;r[2]=Math.round(e[2]*t)|0;r[3]=Math.round(e[3]*t)|0;var a=this.pickPixelRatio;this.pickBuffer.shape=[Math.round((e[2]-e[0])*a)|0,Math.round((e[3]-e[1])*a)|0];this.setDirty()};u.update=function(e){e=e||{};var t=this.gl;this.pixelRatio=e.pixelRatio||1;var r=this.pixelRatio;this.pickPixelRatio=Math.max(r,1);this.setScreenBox(e.screenBox||[0,0,t.drawingBufferWidth/r,t.drawingBufferHeight/r]);var a=this.screenBox;this.setViewBox(e.viewBox||[.125*(this.screenBox[2]-this.screenBox[0])/r,.125*(this.screenBox[3]-this.screenBox[1])/r,.875*(this.screenBox[2]-this.screenBox[0])/r,.875*(this.screenBox[3]-this.screenBox[1])/r]);var n=this.viewBox;var i=(n[2]-n[0])/(n[3]-n[1]);this.setDataBox(e.dataBox||[-10,-10/i,10,10/i]);this.borderColor=e.borderColor!==false?(e.borderColor||[0,0,0,0]).slice():false;this.backgroundColor=(e.backgroundColor||[0,0,0,0]).slice();this.gridLineEnable=(e.gridLineEnable||[true,true]).slice();this.gridLineWidth=(e.gridLineWidth||[1,1]).slice();this.gridLineColor=f(e.gridLineColor||[[.5,.5,.5,1],[.5,.5,.5,1]]);this.zeroLineEnable=(e.zeroLineEnable||[true,true]).slice();this.zeroLineWidth=(e.zeroLineWidth||[4,4]).slice();this.zeroLineColor=f(e.zeroLineColor||[[0,0,0,1],[0,0,0,1]]);this.tickMarkLength=(e.tickMarkLength||[0,0,0,0]).slice();this.tickMarkWidth=(e.tickMarkWidth||[0,0,0,0]).slice();this.tickMarkColor=f(e.tickMarkColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]);this.titleCenter=(e.titleCenter||[.5*(n[0]+n[2])/r,(n[3]+120)/r]).slice();this.titleEnable=!("titleEnable"in e)||!!e.titleEnable;this.titleAngle=e.titleAngle||0;this.titleColor=(e.titleColor||[0,0,0,1]).slice();this.labelPad=(e.labelPad||[15,15,15,15]).slice();this.labelAngle=(e.labelAngle||[0,Math.PI/2,0,3*Math.PI/2]).slice();this.labelEnable=(e.labelEnable||[true,true,true,true]).slice();this.labelColor=f(e.labelColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]);this.tickPad=(e.tickPad||[15,15,15,15]).slice();this.tickAngle=(e.tickAngle||[0,0,0,0]).slice();this.tickEnable=(e.tickEnable||[true,true,true,true]).slice();this.tickColor=f(e.tickColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]);this.borderLineEnable=(e.borderLineEnable||[true,true,true,true]).slice();this.borderLineWidth=(e.borderLineWidth||[2,2,2,2]).slice();this.borderLineColor=f(e.borderLineColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]);var o=e.ticks||[[],[]];var s=this._tickBounds;s[0]=s[1]=Infinity;s[2]=s[3]=-Infinity;for(var l=0;l<2;++l){var u=o[l].slice(0);if(u.length===0){continue}u.sort(h);s[l]=Math.min(s[l],u[0].x);s[l+2]=Math.max(s[l+2],u[u.length-1].x)}this.grid.update({bounds:s,ticks:o});this.text.update({bounds:s,ticks:o,labels:e.labels||["x","y"],labelSize:e.labelSize||[12,12],labelFont:e.labelFont||["sans-serif","sans-serif"],title:e.title||"",titleSize:e.titleSize||18,titleFont:e.titleFont||"sans-serif"});this.static=!!e.static;this.setDirty()};u.dispose=function(){this.box.dispose();this.grid.dispose();this.text.dispose();this.line.dispose();for(var e=this.objects.length-1;e>=0;--e){this.objects[e].dispose()}this.objects.length=0;for(var e=this.overlays.length-1;e>=0;--e){this.overlays[e].dispose()}this.overlays.length=0;this.gl=null};u.addObject=function(e){if(this.objects.indexOf(e)<0){this.objects.push(e);this.setDirty()}};u.removeObject=function(e){var t=this.objects;for(var r=0;r<t.length;++r){if(t[r]===e){t.splice(r,1);this.setDirty();break}}};u.addOverlay=function(e){if(this.overlays.indexOf(e)<0){this.overlays.push(e);this.setOverlayDirty()}};u.removeOverlay=function(e){var t=this.overlays;for(var r=0;r<t.length;++r){if(t[r]===e){t.splice(r,1);this.setOverlayDirty();break}}};function p(e){var t=e.gl;var r=a(t,[t.drawingBufferWidth,t.drawingBufferHeight]);var u=new l(t,r);u.grid=n(u);u.text=i(u);u.line=o(u);u.box=s(u);u.update(e);return u}},{"./lib/box":310,"./lib/grid":311,"./lib/line":312,"./lib/text":314,"gl-select-static":331}],317:[function(e,t,r){"use strict";t.exports=u;var a=e("right-now");var n=e("3d-view");var i=e("mouse-change");var o=e("mouse-wheel");var s=e("mouse-event-offset");var l=e("has-passive-events");function u(e,t){e=e||document.body;t=t||{};var r=[.01,Infinity];if("distanceLimits"in t){r[0]=t.distanceLimits[0];r[1]=t.distanceLimits[1]}if("zoomMin"in t){r[0]=t.zoomMin}if("zoomMax"in t){r[1]=t.zoomMax}var u=n({center:t.center||[0,0,0],up:t.up||[0,1,0],eye:t.eye||[0,0,10],mode:t.mode||"orbit",distanceLimits:r});var c=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];var f=0;var h=e.clientWidth;var p=e.clientHeight;var v={keyBindingMode:"rotate",enableWheel:true,view:u,element:e,delay:t.delay||16,rotateSpeed:t.rotateSpeed||1,zoomSpeed:t.zoomSpeed||1,translateSpeed:t.translateSpeed||1,flipX:!!t.flipX,flipY:!!t.flipY,modes:u.modes,_ortho:t._ortho||t.projection&&t.projection.type==="orthographic"||false,tick:function(){var t=a();var r=this.delay;var n=t-2*r;u.idle(t-r);u.recalcMatrix(n);u.flush(t-(100+r*2));var i=true;var o=u.computedMatrix;for(var s=0;s<16;++s){i=i&&c[s]===o[s];c[s]=o[s]}var l=e.clientWidth===h&&e.clientHeight===p;h=e.clientWidth;p=e.clientHeight;if(i){return!l}f=Math.exp(u.computedRadius[0]);return true},lookAt:function(e,t,r){u.lookAt(u.lastT(),e,t,r)},rotate:function(e,t,r){u.rotate(u.lastT(),e,t,r)},pan:function(e,t,r){u.pan(u.lastT(),e,t,r)},translate:function(e,t,r){u.translate(u.lastT(),e,t,r)}};Object.defineProperties(v,{matrix:{get:function(){return u.computedMatrix},set:function(e){u.setMatrix(u.lastT(),e);return u.computedMatrix},enumerable:true},mode:{get:function(){return u.getMode()},set:function(e){var t=u.computedUp.slice();var r=u.computedEye.slice();var n=u.computedCenter.slice();u.setMode(e);if(e==="turntable"){var i=a();u._active.lookAt(i,r,n,t);u._active.lookAt(i+500,r,n,[0,0,1]);u._active.flush(i)}return u.getMode()},enumerable:true},center:{get:function(){return u.computedCenter},set:function(e){u.lookAt(u.lastT(),null,e);return u.computedCenter},enumerable:true},eye:{get:function(){return u.computedEye},set:function(e){u.lookAt(u.lastT(),e);return u.computedEye},enumerable:true},up:{get:function(){return u.computedUp},set:function(e){u.lookAt(u.lastT(),null,null,e);return u.computedUp},enumerable:true},distance:{get:function(){return f},set:function(e){u.setDistance(u.lastT(),e);return e},enumerable:true},distanceLimits:{get:function(){return u.getDistanceLimits(r)},set:function(e){u.setDistanceLimits(e);return e},enumerable:true}});e.addEventListener("contextmenu",(function(e){e.preventDefault();return false}));v._lastX=-1;v._lastY=-1;v._lastMods={shift:false,control:false,alt:false,meta:false};v.enableMouseListeners=function(){v.mouseListener=i(e,t);e.addEventListener("touchstart",(function(r){var a=s(r.changedTouches[0],e);t(0,a[0],a[1],v._lastMods);t(1,a[0],a[1],v._lastMods)}),l?{passive:true}:false);e.addEventListener("touchmove",(function(r){var a=s(r.changedTouches[0],e);t(1,a[0],a[1],v._lastMods);r.preventDefault()}),l?{passive:false}:false);e.addEventListener("touchend",(function(e){t(0,v._lastX,v._lastY,v._lastMods)}),l?{passive:true}:false);function t(t,r,n,i){var o=v.keyBindingMode;if(o===false)return;var s=o==="rotate";var l=o==="pan";var c=o==="zoom";var h=!!i.control;var p=!!i.alt;var d=!!i.shift;var m=!!(t&1);var g=!!(t&2);var y=!!(t&4);var x=1/e.clientHeight;var b=x*(r-v._lastX);var _=x*(n-v._lastY);var w=v.flipX?1:-1;var T=v.flipY?1:-1;var k=Math.PI*v.rotateSpeed;var M=a();if(v._lastX!==-1&&v._lastY!==-1){if(s&&m&&!h&&!p&&!d||m&&!h&&!p&&d){u.rotate(M,w*k*b,-T*k*_,0)}if(l&&m&&!h&&!p&&!d||g||m&&h&&!p&&!d){u.pan(M,-v.translateSpeed*b*f,v.translateSpeed*_*f,0)}if(c&&m&&!h&&!p&&!d||y||m&&!h&&p&&!d){var A=-v.zoomSpeed*_/window.innerHeight*(M-u.lastT())*100;u.pan(M,0,0,f*(Math.exp(A)-1))}}v._lastX=r;v._lastY=n;v._lastMods=i;return true}v.wheelListener=o(e,(function(e,t){if(v.keyBindingMode===false)return;if(!v.enableWheel)return;var r=v.flipX?1:-1;var n=v.flipY?1:-1;var i=a();if(Math.abs(e)>Math.abs(t)){u.rotate(i,0,0,-e*r*Math.PI*v.rotateSpeed/window.innerWidth)}else{if(!v._ortho){var o=-v.zoomSpeed*n*t/window.innerHeight*(i-u.lastT())/20;u.pan(i,0,0,f*(Math.exp(o)-1))}}}),true)};v.enableMouseListeners();return v}},{"3d-view":55,"has-passive-events":436,"mouse-change":459,"mouse-event-offset":460,"mouse-wheel":462,"right-now":528}],318:[function(e,t,r){var a=e("glslify");var n=e("gl-shader");var i=a(["precision mediump float;\n#define GLSLIFY 1\nattribute vec2 position;\nvarying vec2 uv;\nvoid main() {\n  uv = position;\n  gl_Position = vec4(position, 0, 1);\n}"]);var o=a(["precision mediump float;\n#define GLSLIFY 1\n\nuniform sampler2D accumBuffer;\nvarying vec2 uv;\n\nvoid main() {\n  vec4 accum = texture2D(accumBuffer, 0.5 * (uv + 1.0));\n  gl_FragColor = min(vec4(1,1,1,1), accum);\n}"]);t.exports=function(e){return n(e,i,o,null,[{name:"position",type:"vec2"}])}},{"gl-shader":332,glslify:434}],319:[function(e,t,r){"use strict";var a=e("./camera.js");var n=e("gl-axes3d");var i=e("gl-axes3d/properties");var o=e("gl-spikes3d");var s=e("gl-select-static");var l=e("gl-fbo");var u=e("a-big-triangle");var c=e("mouse-change");var f=e("gl-mat4/perspective");var h=e("gl-mat4/ortho");var p=e("./lib/shader");var v=e("is-mobile")({tablet:true,featureDetect:true});t.exports={createScene:x,createCamera:a};function d(){this.mouse=[-1,-1];this.screen=null;this.distance=Infinity;this.index=null;this.dataCoordinate=null;this.dataPosition=null;this.object=null;this.data=null}function m(e,t){var r=null;try{r=e.getContext("webgl",t);if(!r){r=e.getContext("experimental-webgl",t)}}catch(a){return null}return r}function g(e){var t=Math.round(Math.log(Math.abs(e))/Math.log(10));if(t<0){var r=Math.round(Math.pow(10,-t));return Math.ceil(e*r)/r}else if(t>0){var r=Math.round(Math.pow(10,t));return Math.ceil(e/r)*r}return Math.ceil(e)}function y(e){if(typeof e==="boolean"){return e}return true}function x(e){e=e||{};e.camera=e.camera||{};var t=e.canvas;if(!t){t=document.createElement("canvas");if(e.container){var r=e.container;r.appendChild(t)}else{document.body.appendChild(t)}}var f=e.gl;if(!f){if(e.glOptions){v=!!e.glOptions.preserveDrawingBuffer}f=m(t,e.glOptions||{premultipliedAlpha:true,antialias:true,preserveDrawingBuffer:v})}if(!f){throw new Error("webgl not supported")}var h=e.bounds||[[-10,-10,-10],[10,10,10]];var x=new d;var _=l(f,f.drawingBufferWidth,f.drawingBufferHeight,{preferFloat:!v});var w=p(f);var T=e.cameraObject&&e.cameraObject._ortho===true||e.camera.projection&&e.camera.projection.type==="orthographic"||false;var k={eye:e.camera.eye||[2,0,0],center:e.camera.center||[0,0,0],up:e.camera.up||[0,1,0],zoomMin:e.camera.zoomMax||.1,zoomMax:e.camera.zoomMin||100,mode:e.camera.mode||"turntable",_ortho:T};var M=e.axes||{};var A=n(f,M);A.enable=!M.disable;var S=e.spikes||{};var E=o(f,S);var L=[];var C=[];var I=[];var P=[];var O=true;var z=true;var D=new Array(16);var R=new Array(16);var F={view:null,projection:D,model:R,_ortho:false};var z=true;var B=[f.drawingBufferWidth,f.drawingBufferHeight];var N=e.cameraObject||a(t,k);var j={gl:f,contextLost:false,pixelRatio:e.pixelRatio||1,canvas:t,selection:x,camera:N,axes:A,axesPixels:null,spikes:E,bounds:h,objects:L,shape:B,aspect:e.aspectRatio||[1,1,1],pickRadius:e.pickRadius||10,zNear:e.zNear||.01,zFar:e.zFar||1e3,fovy:e.fovy||Math.PI/4,clearColor:e.clearColor||[0,0,0,0],autoResize:y(e.autoResize),autoBounds:y(e.autoBounds),autoScale:!!e.autoScale,autoCenter:y(e.autoCenter),clipToBounds:y(e.clipToBounds),snapToData:!!e.snapToData,onselect:e.onselect||null,onrender:e.onrender||null,onclick:e.onclick||null,cameraParams:F,oncontextloss:null,mouseListener:null,_stopped:false,getAspectratio:function(){return{x:this.aspect[0],y:this.aspect[1],z:this.aspect[2]}},setAspectratio:function(e){this.aspect[0]=e.x;this.aspect[1]=e.y;this.aspect[2]=e.z;z=true},setBounds:function(e,t){this.bounds[0][e]=t.min;this.bounds[1][e]=t.max},setClearColor:function(e){this.clearColor=e},clearRGBA:function(){this.gl.clearColor(this.clearColor[0],this.clearColor[1],this.clearColor[2],this.clearColor[3]);this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT)}};var U=[f.drawingBufferWidth/j.pixelRatio|0,f.drawingBufferHeight/j.pixelRatio|0];function V(){if(j._stopped){return}if(!j.autoResize){return}var e=t.parentNode;var r=1;var a=1;if(e&&e!==document.body){r=e.clientWidth;a=e.clientHeight}else{r=window.innerWidth;a=window.innerHeight}var n=Math.ceil(r*j.pixelRatio)|0;var i=Math.ceil(a*j.pixelRatio)|0;if(n!==t.width||i!==t.height){t.width=n;t.height=i;var o=t.style;o.position=o.position||"absolute";o.left="0px";o.top="0px";o.width=r+"px";o.height=a+"px";O=true}}if(j.autoResize){V()}window.addEventListener("resize",V);function H(){var e=L.length;var t=P.length;for(var r=0;r<t;++r){I[r]=0}e:for(var r=0;r<e;++r){var a=L[r];var n=a.pickSlots;if(!n){C[r]=-1;continue}for(var i=0;i<t;++i){if(I[i]+n<255){C[r]=i;a.setPickBase(I[i]+1);I[i]+=n;continue e}}var o=s(f,B);C[r]=t;P.push(o);I.push(n);a.setPickBase(1);t+=1}while(t>0&&I[t-1]===0){I.pop();P.pop().dispose()}}j.update=function(e){if(j._stopped){return}e=e||{};O=true;z=true};j.add=function(e){if(j._stopped){return}e.axes=A;L.push(e);C.push(-1);O=true;z=true;H()};j.remove=function(e){if(j._stopped){return}var t=L.indexOf(e);if(t<0){return}L.splice(t,1);C.pop();O=true;z=true;H()};j.dispose=function(){if(j._stopped){return}j._stopped=true;window.removeEventListener("resize",V);t.removeEventListener("webglcontextlost",q);j.mouseListener.enabled=false;if(j.contextLost){return}A.dispose();E.dispose();for(var e=0;e<L.length;++e){L[e].dispose()}_.dispose();for(var e=0;e<P.length;++e){P[e].dispose()}w.dispose();f=null;A=null;E=null;L=[]};j._mouseRotating=false;j._prevButtons=0;j.enableMouseListeners=function(){j.mouseListener=c(t,(function(e,t,r){if(j._stopped){return}var a=P.length;var n=L.length;var i=x.object;x.distance=Infinity;x.mouse[0]=t;x.mouse[1]=r;x.object=null;x.screen=null;x.dataCoordinate=x.dataPosition=null;var o=false;if(e&&j._prevButtons){j._mouseRotating=true}else{if(j._mouseRotating){z=true}j._mouseRotating=false;for(var s=0;s<a;++s){var l=P[s].query(t,U[1]-r-1,j.pickRadius);if(l){if(l.distance>x.distance){continue}for(var u=0;u<n;++u){var c=L[u];if(C[u]!==s){continue}var f=c.pick(l);if(f){x.buttons=e;x.screen=l.coord;x.distance=l.distance;x.object=c;x.index=f.distance;x.dataPosition=f.position;x.dataCoordinate=f.dataCoordinate;x.data=f;o=true}}}}}if(i&&i!==x.object){if(i.highlight){i.highlight(null)}O=true}if(x.object){if(x.object.highlight){x.object.highlight(x.data)}O=true}o=o||x.object!==i;if(o&&j.onselect){j.onselect(x)}if(e&1&&!(j._prevButtons&1)&&j.onclick){j.onclick(x)}j._prevButtons=e}))};function q(){if(j.contextLost){return true}if(f.isContextLost()){j.contextLost=true;j.mouseListener.enabled=false;j.selection.object=null;if(j.oncontextloss){j.oncontextloss()}}}t.addEventListener("webglcontextlost",q);function G(){if(q()){return}f.colorMask(true,true,true,true);f.depthMask(true);f.disable(f.BLEND);f.enable(f.DEPTH_TEST);f.depthFunc(f.LEQUAL);var e=L.length;var t=P.length;for(var r=0;r<t;++r){var a=P[r];a.shape=U;a.begin();for(var n=0;n<e;++n){if(C[n]!==r){continue}var i=L[n];if(i.drawPick){i.pixelRatio=1;i.drawPick(F)}}a.end()}}var Y=[[Infinity,Infinity,Infinity],[-Infinity,-Infinity,-Infinity]];var W=[Y[0].slice(),Y[1].slice()];function X(){if(q()){return}V();var e=j.camera.tick();F.view=j.camera.matrix;O=O||e;z=z||e;A.pixelRatio=j.pixelRatio;E.pixelRatio=j.pixelRatio;var t=L.length;var r=Y[0];var a=Y[1];r[0]=r[1]=r[2]=Infinity;a[0]=a[1]=a[2]=-Infinity;for(var n=0;n<t;++n){var o=L[n];o.pixelRatio=j.pixelRatio;o.axes=j.axes;O=O||!!o.dirty;z=z||!!o.dirty;var s=o.bounds;if(s){var l=s[0];var c=s[1];for(var h=0;h<3;++h){r[h]=Math.min(r[h],l[h]);a[h]=Math.max(a[h],c[h])}}}var p=j.bounds;if(j.autoBounds){for(var h=0;h<3;++h){if(a[h]<r[h]){r[h]=-1;a[h]=1}else{if(r[h]===a[h]){r[h]-=1;a[h]+=1}var v=.05*(a[h]-r[h]);r[h]=r[h]-v;a[h]=a[h]+v}p[0][h]=r[h];p[1][h]=a[h]}}var d=false;for(var h=0;h<3;++h){d=d||W[0][h]!==p[0][h]||W[1][h]!==p[1][h];W[0][h]=p[0][h];W[1][h]=p[1][h]}z=z||d;O=O||d;if(!O){return}if(d){var m=[0,0,0];for(var n=0;n<3;++n){m[n]=g((p[1][n]-p[0][n])/10)}if(A.autoTicks){A.update({bounds:p,tickSpacing:m})}else{A.update({bounds:p})}}var y=f.drawingBufferWidth;var k=f.drawingBufferHeight;B[0]=y;B[1]=k;U[0]=Math.max(y/j.pixelRatio,1)|0;U[1]=Math.max(k/j.pixelRatio,1)|0;b(j,T);for(var n=0;n<t;++n){var o=L[n];o.axesBounds=p;if(j.clipToBounds){o.clipBounds=p}}if(x.object){if(j.snapToData){E.position=x.dataCoordinate}else{E.position=x.dataPosition}E.bounds=p}if(z){z=false;G()}j.axesPixels=i(j.axes,F,y,k);if(j.onrender){j.onrender()}f.bindFramebuffer(f.FRAMEBUFFER,null);f.viewport(0,0,y,k);j.clearRGBA();f.depthMask(true);f.colorMask(true,true,true,true);f.enable(f.DEPTH_TEST);f.depthFunc(f.LEQUAL);f.disable(f.BLEND);f.disable(f.CULL_FACE);var M=false;if(A.enable){M=M||A.isTransparent();A.draw(F)}E.axes=A;if(x.object){E.draw(F)}f.disable(f.CULL_FACE);for(var n=0;n<t;++n){var o=L[n];o.axes=A;o.pixelRatio=j.pixelRatio;if(o.isOpaque&&o.isOpaque()){o.draw(F)}if(o.isTransparent&&o.isTransparent()){M=true}}if(M){_.shape=B;_.bind();f.clear(f.DEPTH_BUFFER_BIT);f.colorMask(false,false,false,false);f.depthMask(true);f.depthFunc(f.LESS);if(A.enable&&A.isTransparent()){A.drawTransparent(F)}for(var n=0;n<t;++n){var o=L[n];if(o.isOpaque&&o.isOpaque()){o.draw(F)}}f.enable(f.BLEND);f.blendEquation(f.FUNC_ADD);f.blendFunc(f.ONE,f.ONE_MINUS_SRC_ALPHA);f.colorMask(true,true,true,true);f.depthMask(false);f.clearColor(0,0,0,0);f.clear(f.COLOR_BUFFER_BIT);if(A.isTransparent()){A.drawTransparent(F)}for(var n=0;n<t;++n){var o=L[n];if(o.isTransparent&&o.isTransparent()){o.drawTransparent(F)}}f.bindFramebuffer(f.FRAMEBUFFER,null);f.blendFunc(f.ONE,f.ONE_MINUS_SRC_ALPHA);f.disable(f.DEPTH_TEST);w.bind();_.color[0].bind(0);w.uniforms.accumBuffer=0;u(f);f.disable(f.BLEND)}O=false;for(var n=0;n<t;++n){L[n].dirty=false}}function Z(){if(j._stopped||j.contextLost){return}X();requestAnimationFrame(Z)}j.enableMouseListeners();Z();j.redraw=function(){if(j._stopped){return}O=true;X()};return j}function b(e,t){var r=e.bounds;var a=e.cameraParams;var n=a.projection;var i=a.model;var o=e.gl.drawingBufferWidth;var s=e.gl.drawingBufferHeight;var l=e.zNear;var u=e.zFar;var c=e.fovy;var p=o/s;if(t){h(n,-p,p,-1,1,l,u);a._ortho=true}else{f(n,c,p,l,u);a._ortho=false}for(var v=0;v<16;++v){i[v]=0}i[15]=1;var d=0;for(var v=0;v<3;++v){d=Math.max(d,r[1][v]-r[0][v])}for(var v=0;v<3;++v){if(e.autoScale){i[5*v]=e.aspect[v]/(r[1][v]-r[0][v])}else{i[5*v]=1/d}if(e.autoCenter){i[12+v]=-i[5*v]*.5*(r[0][v]+r[1][v])}}}},{"./camera.js":317,"./lib/shader":318,"a-big-triangle":70,"gl-axes3d":253,"gl-axes3d/properties":260,"gl-fbo":270,"gl-mat4/ortho":296,"gl-mat4/perspective":297,"gl-select-static":331,"gl-spikes3d":341,"is-mobile":445,"mouse-change":459}],320:[function(e,t,r){var a=e("glslify");r.pointVertex=a(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 position;\n\nuniform mat3 matrix;\nuniform float pointSize;\nuniform float pointCloud;\n\nhighp float rand(vec2 co) {\n  highp float a = 12.9898;\n  highp float b = 78.233;\n  highp float c = 43758.5453;\n  highp float d = dot(co.xy, vec2(a, b));\n  highp float e = mod(d, 3.14);\n  return fract(sin(e) * c);\n}\n\nvoid main() {\n  vec3 hgPosition = matrix * vec3(position, 1);\n  gl_Position  = vec4(hgPosition.xy, 0, hgPosition.z);\n    // if we don't jitter the point size a bit, overall point cloud\n    // saturation 'jumps' on zooming, which is disturbing and confusing\n  gl_PointSize = pointSize * ((19.5 + rand(position)) / 20.0);\n  if(pointCloud != 0.0) { // pointCloud is truthy\n    // get the same square surface as circle would be\n    gl_PointSize *= 0.886;\n  }\n}"]);r.pointFragment=a(["precision mediump float;\n#define GLSLIFY 1\n\nuniform vec4 color, borderColor;\nuniform float centerFraction;\nuniform float pointCloud;\n\nvoid main() {\n  float radius;\n  vec4 baseColor;\n  if(pointCloud != 0.0) { // pointCloud is truthy\n    if(centerFraction == 1.0) {\n      gl_FragColor = color;\n    } else {\n      gl_FragColor = mix(borderColor, color, centerFraction);\n    }\n  } else {\n    radius = length(2.0 * gl_PointCoord.xy - 1.0);\n    if(radius > 1.0) {\n      discard;\n    }\n    baseColor = mix(borderColor, color, step(radius, centerFraction));\n    gl_FragColor = vec4(baseColor.rgb * baseColor.a, baseColor.a);\n  }\n}\n"]);r.pickVertex=a(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 position;\nattribute vec4 pickId;\n\nuniform mat3 matrix;\nuniform float pointSize;\nuniform vec4 pickOffset;\n\nvarying vec4 fragId;\n\nvoid main() {\n  vec3 hgPosition = matrix * vec3(position, 1);\n  gl_Position  = vec4(hgPosition.xy, 0, hgPosition.z);\n  gl_PointSize = pointSize;\n\n  vec4 id = pickId + pickOffset;\n  id.y += floor(id.x / 256.0);\n  id.x -= floor(id.x / 256.0) * 256.0;\n\n  id.z += floor(id.y / 256.0);\n  id.y -= floor(id.y / 256.0) * 256.0;\n\n  id.w += floor(id.z / 256.0);\n  id.z -= floor(id.z / 256.0) * 256.0;\n\n  fragId = id;\n}\n"]);r.pickFragment=a(["precision mediump float;\n#define GLSLIFY 1\n\nvarying vec4 fragId;\n\nvoid main() {\n  float radius = length(2.0 * gl_PointCoord.xy - 1.0);\n  if(radius > 1.0) {\n    discard;\n  }\n  gl_FragColor = fragId / 255.0;\n}\n"])},{glslify:434}],321:[function(e,t,r){"use strict";var a=e("gl-shader");var n=e("gl-buffer");var i=e("typedarray-pool");var o=e("./lib/shader");t.exports=c;function s(e,t,r,a,n){this.plot=e;this.offsetBuffer=t;this.pickBuffer=r;this.shader=a;this.pickShader=n;this.sizeMin=.5;this.sizeMinCap=2;this.sizeMax=20;this.areaRatio=1;this.pointCount=0;this.color=[1,0,0,1];this.borderColor=[0,0,0,1];this.blend=false;this.pickOffset=0;this.points=null}var l=s.prototype;l.dispose=function(){this.shader.dispose();this.pickShader.dispose();this.offsetBuffer.dispose();this.pickBuffer.dispose();this.plot.removeObject(this)};l.update=function(e){var t;e=e||{};function r(t,r){if(t in e){return e[t]}return r}this.sizeMin=r("sizeMin",.5);this.sizeMax=r("sizeMax",20);this.color=r("color",[1,0,0,1]).slice();this.areaRatio=r("areaRatio",1);this.borderColor=r("borderColor",[0,0,0,1]).slice();this.blend=r("blend",false);var a=e.positions.length>>>1;var n=e.positions instanceof Float32Array;var o=e.idToIndex instanceof Int32Array&&e.idToIndex.length>=a;var s=e.positions;var l=n?s:i.mallocFloat32(s.length);var u=o?e.idToIndex:i.mallocInt32(a);if(!n){l.set(s)}if(!o){l.set(s);for(t=0;t<a;t++){u[t]=t}}this.points=s;this.offsetBuffer.update(l);this.pickBuffer.update(u);if(!n){i.free(l)}if(!o){i.free(u)}this.pointCount=a;this.pickOffset=0};function u(e,t){var r=0;var a=e.length>>>1;var n;for(n=0;n<a;n++){var i=e[n*2];var o=e[n*2+1];if(i>=t[0]&&i<=t[2]&&o>=t[1]&&o<=t[3])r++}return r}l.unifiedDraw=function(){var e=[1,0,0,0,1,0,0,0,1];var t=[0,0,0,0];return function(r){var a=r!==void 0;var n=a?this.pickShader:this.shader;var i=this.plot.gl;var o=this.plot.dataBox;if(this.pointCount===0){return r}var s=o[2]-o[0];var l=o[3]-o[1];var c=u(this.points,o);var f=this.plot.pickPixelRatio*Math.max(Math.min(this.sizeMinCap,this.sizeMin),Math.min(this.sizeMax,this.sizeMax/Math.pow(c,.33333)));e[0]=2/s;e[4]=2/l;e[6]=-2*o[0]/s-1;e[7]=-2*o[1]/l-1;this.offsetBuffer.bind();n.bind();n.attributes.position.pointer();n.uniforms.matrix=e;n.uniforms.color=this.color;n.uniforms.borderColor=this.borderColor;n.uniforms.pointCloud=f<5;n.uniforms.pointSize=f;n.uniforms.centerFraction=Math.min(1,Math.max(0,Math.sqrt(1-this.areaRatio)));if(a){t[0]=r&255;t[1]=r>>8&255;t[2]=r>>16&255;t[3]=r>>24&255;this.pickBuffer.bind();n.attributes.pickId.pointer(i.UNSIGNED_BYTE);n.uniforms.pickOffset=t;this.pickOffset=r}var h=i.getParameter(i.BLEND);var p=i.getParameter(i.DITHER);if(h&&!this.blend)i.disable(i.BLEND);if(p)i.disable(i.DITHER);i.drawArrays(i.POINTS,0,this.pointCount);if(h&&!this.blend)i.enable(i.BLEND);if(p)i.enable(i.DITHER);return r+this.pointCount}}();l.draw=l.unifiedDraw;l.drawPick=l.unifiedDraw;l.pick=function(e,t,r){var a=this.pickOffset;var n=this.pointCount;if(r<a||r>=a+n){return null}var i=r-a;var o=this.points;return{object:this,pointId:i,dataCoord:[o[2*i],o[2*i+1]]}};function c(e,t){var r=e.gl;var i=n(r);var l=n(r);var u=a(r,o.pointVertex,o.pointFragment);var c=a(r,o.pickVertex,o.pickFragment);var f=new s(e,i,l,u,c);f.update(t);e.addObject(f);return f}},{"./lib/shader":320,"gl-buffer":261,"gl-shader":332,"typedarray-pool":601}],322:[function(e,t,r){t.exports=a;function a(e,t,r,a){var n=t[0],i=t[1],o=t[2],s=t[3],l=r[0],u=r[1],c=r[2],f=r[3];var h,p,v,d,m;p=n*l+i*u+o*c+s*f;if(p<0){p=-p;l=-l;u=-u;c=-c;f=-f}if(1-p>1e-6){h=Math.acos(p);v=Math.sin(h);d=Math.sin((1-a)*h)/v;m=Math.sin(a*h)/v}else{d=1-a;m=a}e[0]=d*n+m*l;e[1]=d*i+m*u;e[2]=d*o+m*c;e[3]=d*s+m*f;return e}},{}],323:[function(e,t,r){"use strict";t.exports=function(e){return!e&&e!==0?"":e.toString()}},{}],324:[function(e,t,r){"use strict";var a=e("vectorize-text");t.exports=i;var n={};function i(e,t,r){var i=n[t];if(!i){i=n[t]={}}if(e in i){return i[e]}var o={textAlign:"center",textBaseline:"middle",lineHeight:1,font:t,lineSpacing:1.25,styletags:{breaklines:true,bolds:true,italics:true,subscripts:true,superscripts:true}};o.triangles=true;var s=a(e,o);o.triangles=false;var l=a(e,o);var u,c;if(r&&r!==1){for(u=0;u<s.positions.length;++u){for(c=0;c<s.positions[u].length;++c){s.positions[u][c]/=r}}for(u=0;u<l.positions.length;++u){for(c=0;c<l.positions[u].length;++c){l.positions[u][c]/=r}}}var f=[[Infinity,Infinity],[-Infinity,-Infinity]];var h=l.positions.length;for(u=0;u<h;++u){var p=l.positions[u];for(c=0;c<2;++c){f[0][c]=Math.min(f[0][c],p[c]);f[1][c]=Math.max(f[1][c],p[c])}}return i[e]=[s,l,f]}},{"vectorize-text":607}],325:[function(e,t,r){var a=e("gl-shader");var n=e("glslify");var i=n(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 glyph;\nattribute vec4 id;\n\nuniform vec4 highlightId;\nuniform float highlightScale;\nuniform mat4 model, view, projection;\nuniform vec3 clipBounds[2];\n\nvarying vec4 interpColor;\nvarying vec4 pickId;\nvarying vec3 dataCoordinate;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], position)) {\n\n    gl_Position = vec4(0,0,0,0);\n  } else {\n    float scale = 1.0;\n    if(distance(highlightId, id) < 0.0001) {\n      scale = highlightScale;\n    }\n\n    vec4 worldPosition = model * vec4(position, 1);\n    vec4 viewPosition = view * worldPosition;\n    viewPosition = viewPosition / viewPosition.w;\n    vec4 clipPosition = projection * (viewPosition + scale * vec4(glyph.x, -glyph.y, 0, 0));\n\n    gl_Position = clipPosition;\n    interpColor = color;\n    pickId = id;\n    dataCoordinate = position;\n  }\n}"]);var o=n(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 glyph;\nattribute vec4 id;\n\nuniform mat4 model, view, projection;\nuniform vec2 screenSize;\nuniform vec3 clipBounds[2];\nuniform float highlightScale, pixelRatio;\nuniform vec4 highlightId;\n\nvarying vec4 interpColor;\nvarying vec4 pickId;\nvarying vec3 dataCoordinate;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], position)) {\n\n    gl_Position = vec4(0,0,0,0);\n  } else {\n    float scale = pixelRatio;\n    if(distance(highlightId.bgr, id.bgr) < 0.001) {\n      scale *= highlightScale;\n    }\n\n    vec4 worldPosition = model * vec4(position, 1.0);\n    vec4 viewPosition = view * worldPosition;\n    vec4 clipPosition = projection * viewPosition;\n    clipPosition /= clipPosition.w;\n\n    gl_Position = clipPosition + vec4(screenSize * scale * vec2(glyph.x, -glyph.y), 0.0, 0.0);\n    interpColor = color;\n    pickId = id;\n    dataCoordinate = position;\n  }\n}"]);var s=n(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 glyph;\nattribute vec4 id;\n\nuniform float highlightScale;\nuniform vec4 highlightId;\nuniform vec3 axes[2];\nuniform mat4 model, view, projection;\nuniform vec2 screenSize;\nuniform vec3 clipBounds[2];\nuniform float scale, pixelRatio;\n\nvarying vec4 interpColor;\nvarying vec4 pickId;\nvarying vec3 dataCoordinate;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], position)) {\n\n    gl_Position = vec4(0,0,0,0);\n  } else {\n    float lscale = pixelRatio * scale;\n    if(distance(highlightId, id) < 0.0001) {\n      lscale *= highlightScale;\n    }\n\n    vec4 clipCenter   = projection * view * model * vec4(position, 1);\n    vec3 dataPosition = position + 0.5*lscale*(axes[0] * glyph.x + axes[1] * glyph.y) * clipCenter.w * screenSize.y;\n    vec4 clipPosition = projection * view * model * vec4(dataPosition, 1);\n\n    gl_Position = clipPosition;\n    interpColor = color;\n    pickId = id;\n    dataCoordinate = dataPosition;\n  }\n}\n"]);var l=n(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 fragClipBounds[2];\nuniform float opacity;\n\nvarying vec4 interpColor;\nvarying vec3 dataCoordinate;\n\nvoid main() {\n  if (\n    outOfRange(fragClipBounds[0], fragClipBounds[1], dataCoordinate) ||\n    interpColor.a * opacity == 0.\n  ) discard;\n  gl_FragColor = interpColor * opacity;\n}\n"]);var u=n(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 fragClipBounds[2];\nuniform float pickGroup;\n\nvarying vec4 pickId;\nvarying vec3 dataCoordinate;\n\nvoid main() {\n  if (outOfRange(fragClipBounds[0], fragClipBounds[1], dataCoordinate)) discard;\n\n  gl_FragColor = vec4(pickGroup, pickId.bgr);\n}"]);var c=[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"glyph",type:"vec2"},{name:"id",type:"vec4"}];var f={vertex:i,fragment:l,attributes:c},h={vertex:o,fragment:l,attributes:c},p={vertex:s,fragment:l,attributes:c},v={vertex:i,fragment:u,attributes:c},d={vertex:o,fragment:u,attributes:c},m={vertex:s,fragment:u,attributes:c};function g(e,t){var r=a(e,t);var n=r.attributes;n.position.location=0;n.color.location=1;n.glyph.location=2;n.id.location=3;return r}r.createPerspective=function(e){return g(e,f)};r.createOrtho=function(e){return g(e,h)};r.createProject=function(e){return g(e,p)};r.createPickPerspective=function(e){return g(e,v)};r.createPickOrtho=function(e){return g(e,d)};r.createPickProject=function(e){return g(e,m)}},{"gl-shader":332,glslify:326}],326:[function(e,t,r){arguments[4][268][0].apply(r,arguments)},{dup:268}],327:[function(e,t,r){"use strict";var a=e("is-string-blank");var n=e("gl-buffer");var i=e("gl-vao");var o=e("typedarray-pool");var s=e("gl-mat4/multiply");var l=e("./lib/shaders");var u=e("./lib/glyphs");var c=e("./lib/get-simple-string");var f=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];t.exports=R;function h(e,t){var r=e[0];var a=e[1];var n=e[2];var i=e[3];e[0]=t[0]*r+t[4]*a+t[8]*n+t[12]*i;e[1]=t[1]*r+t[5]*a+t[9]*n+t[13]*i;e[2]=t[2]*r+t[6]*a+t[10]*n+t[14]*i;e[3]=t[3]*r+t[7]*a+t[11]*n+t[15]*i;return e}function p(e,t,r,a){h(a,a,r);h(a,a,t);return h(a,a,e)}function v(e,t){this.index=e;this.dataCoordinate=this.position=t}function d(e){if(e===true)return 1;if(e>1)return 1;return e}function m(e,t,r,a,n,i,o,s,l,u,c,f){this.gl=e;this.pixelRatio=1;this.shader=t;this.orthoShader=r;this.projectShader=a;this.pointBuffer=n;this.colorBuffer=i;this.glyphBuffer=o;this.idBuffer=s;this.vao=l;this.vertexCount=0;this.lineVertexCount=0;this.opacity=1;this.hasAlpha=false;this.lineWidth=0;this.projectScale=[2/3,2/3,2/3];this.projectOpacity=[1,1,1];this.projectHasAlpha=false;this.pickId=0;this.pickPerspectiveShader=u;this.pickOrthoShader=c;this.pickProjectShader=f;this.points=[];this._selectResult=new v(0,[0,0,0]);this.useOrtho=true;this.bounds=[[Infinity,Infinity,Infinity],[-Infinity,-Infinity,-Infinity]];this.axesProject=[true,true,true];this.axesBounds=[[-Infinity,-Infinity,-Infinity],[Infinity,Infinity,Infinity]];this.highlightId=[1,1,1,1];this.highlightScale=2;this.clipBounds=[[-Infinity,-Infinity,-Infinity],[Infinity,Infinity,Infinity]];this.dirty=true}var g=m.prototype;g.pickSlots=1;g.setPickBase=function(e){this.pickId=e};g.isTransparent=function(){if(this.hasAlpha){return true}for(var e=0;e<3;++e){if(this.axesProject[e]&&this.projectHasAlpha){return true}}return false};g.isOpaque=function(){if(!this.hasAlpha){return true}for(var e=0;e<3;++e){if(this.axesProject[e]&&!this.projectHasAlpha){return true}}return false};var y=[0,0];var x=[0,0,0];var b=[0,0,0];var _=[0,0,0,1];var w=[0,0,0,1];var T=f.slice();var k=[0,0,0];var M=[[0,0,0],[0,0,0]];function A(e){e[0]=e[1]=e[2]=0;return e}function S(e,t){e[0]=t[0];e[1]=t[1];e[2]=t[2];e[3]=1;return e}function E(e,t,r,a){e[0]=t[0];e[1]=t[1];e[2]=t[2];e[r]=a;return e}function L(e){var t=M;for(var r=0;r<2;++r){for(var a=0;a<3;++a){t[r][a]=Math.max(Math.min(e[r][a],1e8),-1e8)}}return t}function C(e,t,r,a){var n=t.axesProject;var i=t.gl;var o=e.uniforms;var l=r.model||f;var u=r.view||f;var c=r.projection||f;var h=t.axesBounds;var v=L(t.clipBounds);var d;if(t.axes&&t.axes.lastCubeProps){d=t.axes.lastCubeProps.axis}else{d=[1,1,1]}y[0]=2/i.drawingBufferWidth;y[1]=2/i.drawingBufferHeight;e.bind();o.view=u;o.projection=c;o.screenSize=y;o.highlightId=t.highlightId;o.highlightScale=t.highlightScale;o.clipBounds=v;o.pickGroup=t.pickId/255;o.pixelRatio=a;for(var m=0;m<3;++m){if(!n[m]){continue}o.scale=t.projectScale[m];o.opacity=t.projectOpacity[m];var g=T;for(var M=0;M<16;++M){g[M]=0}for(var M=0;M<4;++M){g[5*M]=1}g[5*m]=0;if(d[m]<0){g[12+m]=h[0][m]}else{g[12+m]=h[1][m]}s(g,l,g);o.model=g;var C=(m+1)%3;var I=(m+2)%3;var P=A(x);var O=A(b);P[C]=1;O[I]=1;var z=p(c,u,l,S(_,P));var D=p(c,u,l,S(w,O));if(Math.abs(z[1])>Math.abs(D[1])){var R=z;z=D;D=R;R=P;P=O;O=R;var F=C;C=I;I=F}if(z[0]<0){P[C]=-1}if(D[1]>0){O[I]=-1}var B=0;var N=0;for(var M=0;M<4;++M){B+=Math.pow(l[4*C+M],2);N+=Math.pow(l[4*I+M],2)}P[C]/=Math.sqrt(B);O[I]/=Math.sqrt(N);o.axes[0]=P;o.axes[1]=O;o.fragClipBounds[0]=E(k,v[0],m,-1e8);o.fragClipBounds[1]=E(k,v[1],m,1e8);t.vao.bind();t.vao.draw(i.TRIANGLES,t.vertexCount);if(t.lineWidth>0){i.lineWidth(t.lineWidth*a);t.vao.draw(i.LINES,t.lineVertexCount,t.vertexCount)}t.vao.unbind()}}var I=[-1e8,-1e8,-1e8];var P=[1e8,1e8,1e8];var O=[I,P];function z(e,t,r,a,n,i,o){var s=r.gl;if(i===r.projectHasAlpha||o){C(t,r,a,n)}if(i===r.hasAlpha||o){e.bind();var l=e.uniforms;l.model=a.model||f;l.view=a.view||f;l.projection=a.projection||f;y[0]=2/s.drawingBufferWidth;y[1]=2/s.drawingBufferHeight;l.screenSize=y;l.highlightId=r.highlightId;l.highlightScale=r.highlightScale;l.fragClipBounds=O;l.clipBounds=r.axes.bounds;l.opacity=r.opacity;l.pickGroup=r.pickId/255;l.pixelRatio=n;r.vao.bind();r.vao.draw(s.TRIANGLES,r.vertexCount);if(r.lineWidth>0){s.lineWidth(r.lineWidth*n);r.vao.draw(s.LINES,r.lineVertexCount,r.vertexCount)}r.vao.unbind()}}g.draw=function(e){var t=this.useOrtho?this.orthoShader:this.shader;z(t,this.projectShader,this,e,this.pixelRatio,false,false)};g.drawTransparent=function(e){var t=this.useOrtho?this.orthoShader:this.shader;z(t,this.projectShader,this,e,this.pixelRatio,true,false)};g.drawPick=function(e){var t=this.useOrtho?this.pickOrthoShader:this.pickPerspectiveShader;z(t,this.pickProjectShader,this,e,1,true,true)};g.pick=function(e){if(!e){return null}if(e.id!==this.pickId){return null}var t=e.value[2]+(e.value[1]<<8)+(e.value[0]<<16);if(t>=this.pointCount||t<0){return null}var r=this.points[t];var a=this._selectResult;a.index=t;for(var n=0;n<3;++n){a.position[n]=a.dataCoordinate[n]=r[n]}return a};g.highlight=function(e){if(!e){this.highlightId=[1,1,1,1]}else{var t=e.index;var r=t&255;var a=t>>8&255;var n=t>>16&255;this.highlightId=[r/255,a/255,n/255,0]}};function D(e,t,r,n){var i;if(Array.isArray(e)){if(t<e.length){i=e[t]}else{i=undefined}}else{i=e}i=c(i);var o=true;if(a(i)){i="▼";o=false}var s=u(i,r,n);return{mesh:s[0],lines:s[1],bounds:s[2],visible:o}}g.update=function(e){e=e||{};if("perspective"in e){this.useOrtho=!e.perspective}if("orthographic"in e){this.useOrtho=!!e.orthographic}if("lineWidth"in e){this.lineWidth=e.lineWidth}if("project"in e){if(Array.isArray(e.project)){this.axesProject=e.project}else{var t=!!e.project;this.axesProject=[t,t,t]}}if("projectScale"in e){if(Array.isArray(e.projectScale)){this.projectScale=e.projectScale.slice()}else{var r=+e.projectScale;this.projectScale=[r,r,r]}}this.projectHasAlpha=false;if("projectOpacity"in e){if(Array.isArray(e.projectOpacity)){this.projectOpacity=e.projectOpacity.slice()}else{var r=+e.projectOpacity;this.projectOpacity=[r,r,r]}for(var a=0;a<3;++a){this.projectOpacity[a]=d(this.projectOpacity[a]);if(this.projectOpacity[a]<1){this.projectHasAlpha=true}}}this.hasAlpha=false;if("opacity"in e){this.opacity=d(e.opacity);if(this.opacity<1){this.hasAlpha=true}}this.dirty=true;var n=e.position;var i=e.font||"normal";var s=e.alignment||[0,0];var l;var u;if(s.length===2){l=s[0];u=s[1]}else{l=[];u=[];for(var a=0;a<s.length;++a){l[a]=s[a][0];u[a]=s[a][1]}}var c=[Infinity,Infinity,Infinity];var f=[-Infinity,-Infinity,-Infinity];var h=e.glyph;var p=e.color;var v=e.size;var m=e.angle;var g=e.lineColor;var y=-1;var x=0;var b=0;var _=0;if(n.length){_=n.length;e:for(var a=0;a<_;++a){var w=n[a];for(var T=0;T<3;++T){if(isNaN(w[T])||!isFinite(w[T])){continue e}}var k=D(h,a,i,this.pixelRatio);var M=k.mesh;var A=k.lines;var S=k.bounds;x+=M.cells.length*3;b+=A.edges.length*2}}var E=x+b;var L=o.mallocFloat(3*E);var C=o.mallocFloat(4*E);var I=o.mallocFloat(2*E);var P=o.mallocUint32(E);if(E>0){var O=0;var z=x;var R=[0,0,0,1];var F=[0,0,0,1];var B=Array.isArray(p)&&Array.isArray(p[0]);var N=Array.isArray(g)&&Array.isArray(g[0]);e:for(var a=0;a<_;++a){y+=1;var w=n[a];for(var T=0;T<3;++T){if(isNaN(w[T])||!isFinite(w[T])){continue e}f[T]=Math.max(f[T],w[T]);c[T]=Math.min(c[T],w[T])}var k=D(h,a,i,this.pixelRatio);var M=k.mesh;var A=k.lines;var S=k.bounds;var j=k.visible;if(!j)R=[1,1,1,0];else if(Array.isArray(p)){var U;if(B){if(a<p.length){U=p[a]}else{U=[0,0,0,0]}}else{U=p}if(U.length===3){for(var T=0;T<3;++T){R[T]=U[T]}R[3]=1}else if(U.length===4){for(var T=0;T<4;++T){R[T]=U[T]}if(!this.hasAlpha&&U[3]<1)this.hasAlpha=true}}else{R[0]=R[1]=R[2]=0;R[3]=1}if(!j)F=[1,1,1,0];else if(Array.isArray(g)){var U;if(N){if(a<g.length){U=g[a]}else{U=[0,0,0,0]}}else{U=g}if(U.length===3){for(var T=0;T<3;++T){F[T]=U[T]}F[T]=1}else if(U.length===4){for(var T=0;T<4;++T){F[T]=U[T]}if(!this.hasAlpha&&U[3]<1)this.hasAlpha=true}}else{F[0]=F[1]=F[2]=0;F[3]=1}var V=.5;if(!j)V=0;else if(Array.isArray(v)){if(a<v.length){V=+v[a]}else{V=12}}else if(v){V=+v}else if(this.useOrtho){V=12}var H=0;if(Array.isArray(m)){if(a<m.length){H=+m[a]}else{H=0}}else if(m){H=+m}var q=Math.cos(H);var G=Math.sin(H);var w=n[a];for(var T=0;T<3;++T){f[T]=Math.max(f[T],w[T]);c[T]=Math.min(c[T],w[T])}var Y=l;var W=u;var Y=0;if(Array.isArray(l)){if(a<l.length){Y=l[a]}else{Y=0}}else if(l){Y=l}var W=0;if(Array.isArray(u)){if(a<u.length){W=u[a]}else{W=0}}else if(u){W=u}Y*=Y>0?1-S[0][0]:Y<0?1+S[1][0]:1;W*=W>0?1-S[0][1]:W<0?1+S[1][1]:1;var X=[Y,W];var Z=M.cells||[];var J=M.positions||[];for(var T=0;T<Z.length;++T){var K=Z[T];for(var Q=0;Q<3;++Q){for(var $=0;$<3;++$){L[3*O+$]=w[$]}for(var $=0;$<4;++$){C[4*O+$]=R[$]}P[O]=y;var ee=J[K[Q]];I[2*O]=V*(q*ee[0]-G*ee[1]+X[0]);I[2*O+1]=V*(G*ee[0]+q*ee[1]+X[1]);O+=1}}var Z=A.edges;var J=A.positions;for(var T=0;T<Z.length;++T){var K=Z[T];for(var Q=0;Q<2;++Q){for(var $=0;$<3;++$){L[3*z+$]=w[$]}for(var $=0;$<4;++$){C[4*z+$]=F[$]}P[z]=y;var ee=J[K[Q]];I[2*z]=V*(q*ee[0]-G*ee[1]+X[0]);I[2*z+1]=V*(G*ee[0]+q*ee[1]+X[1]);z+=1}}}}this.bounds=[c,f];this.points=n;this.pointCount=n.length;this.vertexCount=x;this.lineVertexCount=b;this.pointBuffer.update(L);this.colorBuffer.update(C);this.glyphBuffer.update(I);this.idBuffer.update(P);o.free(L);o.free(C);o.free(I);o.free(P)};g.dispose=function(){this.shader.dispose();this.orthoShader.dispose();this.pickPerspectiveShader.dispose();this.pickOrthoShader.dispose();this.vao.dispose();this.pointBuffer.dispose();this.colorBuffer.dispose();this.glyphBuffer.dispose();this.idBuffer.dispose()};function R(e){var t=e.gl;var r=l.createPerspective(t);var a=l.createOrtho(t);var o=l.createProject(t);var s=l.createPickPerspective(t);var u=l.createPickOrtho(t);var c=l.createPickProject(t);var f=n(t);var h=n(t);var p=n(t);var v=n(t);var d=i(t,[{buffer:f,size:3,type:t.FLOAT},{buffer:h,size:4,type:t.FLOAT},{buffer:p,size:2,type:t.FLOAT},{buffer:v,size:4,type:t.UNSIGNED_BYTE,normalized:true}]);var g=new m(t,r,a,o,f,h,p,v,d,s,u,c);g.update(e);return g}},{"./lib/get-simple-string":323,"./lib/glyphs":324,"./lib/shaders":325,"gl-buffer":261,"gl-mat4/multiply":295,"gl-vao":353,"is-string-blank":448,"typedarray-pool":601}],328:[function(e,t,r){"use strict";var a=e("glslify");r.boxVertex=a(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 vertex;\n\nuniform vec2 cornerA, cornerB;\n\nvoid main() {\n  gl_Position = vec4(mix(cornerA, cornerB, vertex), 0, 1);\n}\n"]);r.boxFragment=a(["precision mediump float;\n#define GLSLIFY 1\n\nuniform vec4 color;\n\nvoid main() {\n  gl_FragColor = color;\n}\n"])},{glslify:329}],329:[function(e,t,r){arguments[4][268][0].apply(r,arguments)},{dup:268}],330:[function(e,t,r){"use strict";var a=e("gl-shader");var n=e("gl-buffer");var i=e("./lib/shaders");t.exports=l;function o(e,t,r){this.plot=e;this.boxBuffer=t;this.boxShader=r;this.enabled=true;this.selectBox=[Infinity,Infinity,-Infinity,-Infinity];this.borderColor=[0,0,0,1];this.innerFill=false;this.innerColor=[0,0,0,.25];this.outerFill=true;this.outerColor=[0,0,0,.5];this.borderWidth=10}var s=o.prototype;s.draw=function(){if(!this.enabled){return}var e=this.plot;var t=this.selectBox;var r=this.borderWidth;var a=this.innerFill;var n=this.innerColor;var i=this.outerFill;var o=this.outerColor;var s=this.borderColor;var l=e.box;var u=e.screenBox;var c=e.dataBox;var f=e.viewBox;var h=e.pixelRatio;var p=(t[0]-c[0])*(f[2]-f[0])/(c[2]-c[0])+f[0];var v=(t[1]-c[1])*(f[3]-f[1])/(c[3]-c[1])+f[1];var d=(t[2]-c[0])*(f[2]-f[0])/(c[2]-c[0])+f[0];var m=(t[3]-c[1])*(f[3]-f[1])/(c[3]-c[1])+f[1];p=Math.max(p,f[0]);v=Math.max(v,f[1]);d=Math.min(d,f[2]);m=Math.min(m,f[3]);if(d<p||m<v){return}l.bind();var g=u[2]-u[0];var y=u[3]-u[1];if(this.outerFill){l.drawBox(0,0,g,v,o);l.drawBox(0,v,p,m,o);l.drawBox(0,m,g,y,o);l.drawBox(d,v,g,m,o)}if(this.innerFill){l.drawBox(p,v,d,m,n)}if(r>0){var x=r*h;l.drawBox(p-x,v-x,d+x,v+x,s);l.drawBox(p-x,m-x,d+x,m+x,s);l.drawBox(p-x,v-x,p+x,m+x,s);l.drawBox(d-x,v-x,d+x,m+x,s)}};s.update=function(e){e=e||{};this.innerFill=!!e.innerFill;this.outerFill=!!e.outerFill;this.innerColor=(e.innerColor||[0,0,0,.5]).slice();this.outerColor=(e.outerColor||[0,0,0,.5]).slice();this.borderColor=(e.borderColor||[0,0,0,1]).slice();this.borderWidth=e.borderWidth||0;this.selectBox=(e.selectBox||this.selectBox).slice()};s.dispose=function(){this.boxBuffer.dispose();this.boxShader.dispose();this.plot.removeOverlay(this)};function l(e,t){var r=e.gl;var s=n(r,[0,0,0,1,1,0,1,1]);var l=a(r,i.boxVertex,i.boxFragment);var u=new o(e,s,l);u.update(t);e.addOverlay(u);return u}},{"./lib/shaders":328,"gl-buffer":261,"gl-shader":332}],331:[function(e,t,r){"use strict";t.exports=f;var a=e("gl-fbo");var n=e("typedarray-pool");var i=e("ndarray");var o=e("bit-twiddle").nextPow2;var s=function(e,t,r){var a=1e8;var n=-1;var i=-1;var o=e.shape[0];var s=e.shape[1];for(var l=0;l<o;l++){for(var u=0;u<s;u++){var c=e.get(l,u,0);var f=e.get(l,u,1);var h=e.get(l,u,2);var p=e.get(l,u,3);if(c<255||f<255||h<255||p<255){var v=t-l;var d=r-u;var m=v*v+d*d;if(m<a){a=m;n=l;i=u}}}}return[n,i,a]};function l(e,t,r,a,n){this.coord=[e,t];this.id=r;this.value=a;this.distance=n}function u(e,t,r){this.gl=e;this.fbo=t;this.buffer=r;this._readTimeout=null;var a=this;this._readCallback=function(){if(!a.gl){return}t.bind();e.readPixels(0,0,t.shape[0],t.shape[1],e.RGBA,e.UNSIGNED_BYTE,a.buffer);a._readTimeout=null}}var c=u.prototype;Object.defineProperty(c,"shape",{get:function(){if(!this.gl){return[0,0]}return this.fbo.shape.slice()},set:function(e){if(!this.gl){return}this.fbo.shape=e;var t=this.fbo.shape[0];var r=this.fbo.shape[1];if(r*t*4>this.buffer.length){n.free(this.buffer);var a=this.buffer=n.mallocUint8(o(r*t*4));for(var i=0;i<r*t*4;++i){a[i]=255}}return e}});c.begin=function(){var e=this.gl;var t=this.shape;if(!e){return}this.fbo.bind();e.clearColor(1,1,1,1);e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT)};c.end=function(){var e=this.gl;if(!e){return}e.bindFramebuffer(e.FRAMEBUFFER,null);if(!this._readTimeout){clearTimeout(this._readTimeout)}this._readTimeout=setTimeout(this._readCallback,1)};c.query=function(e,t,r){if(!this.gl){return null}var a=this.fbo.shape.slice();e=e|0;t=t|0;if(typeof r!=="number"){r=1}var n=Math.min(Math.max(e-r,0),a[0])|0;var o=Math.min(Math.max(e+r,0),a[0])|0;var u=Math.min(Math.max(t-r,0),a[1])|0;var c=Math.min(Math.max(t+r,0),a[1])|0;if(o<=n||c<=u){return null}var f=[o-n,c-u];var h=i(this.buffer,[f[0],f[1],4],[4,a[0]*4,1],4*(n+a[0]*u));var p=s(h.hi(f[0],f[1],1),r,r);var v=p[0];var d=p[1];if(v<0||Math.pow(this.radius,2)<p[2]){return null}var m=h.get(v,d,0);var g=h.get(v,d,1);var y=h.get(v,d,2);var x=h.get(v,d,3);return new l(v+n|0,d+u|0,m,[g,y,x],Math.sqrt(p[2]))};c.dispose=function(){if(!this.gl){return}this.fbo.dispose();n.free(this.buffer);this.gl=null;if(this._readTimeout){clearTimeout(this._readTimeout)}};function f(e,t){var r=t[0];var i=t[1];var o={};var s=a(e,r,i,o);var l=n.mallocUint8(r*i*4);return new u(e,s,l)}},{"bit-twiddle":104,"gl-fbo":270,ndarray:472,"typedarray-pool":601}],332:[function(e,t,r){"use strict";var a=e("./lib/create-uniforms");var n=e("./lib/create-attributes");var i=e("./lib/reflect");var o=e("./lib/shader-cache");var s=e("./lib/runtime-reflect");var l=e("./lib/GLError");function u(e){this.gl=e;this.gl.lastAttribCount=0;this._vref=this._fref=this._relink=this.vertShader=this.fragShader=this.program=this.attributes=this.uniforms=this.types=null}var c=u.prototype;c.bind=function(){if(!this.program){this._relink()}var e;var t=this.gl.getProgramParameter(this.program,this.gl.ACTIVE_ATTRIBUTES);var r=this.gl.lastAttribCount;if(t>r){for(e=r;e<t;e++){this.gl.enableVertexAttribArray(e)}}else if(r>t){for(e=t;e<r;e++){this.gl.disableVertexAttribArray(e)}}this.gl.lastAttribCount=t;this.gl.useProgram(this.program)};c.dispose=function(){var e=this.gl.lastAttribCount;for(var t=0;t<e;t++){this.gl.disableVertexAttribArray(t)}this.gl.lastAttribCount=0;if(this._fref){this._fref.dispose()}if(this._vref){this._vref.dispose()}this.attributes=this.types=this.vertShader=this.fragShader=this.program=this._relink=this._fref=this._vref=null};function f(e,t){if(e.name<t.name){return-1}return 1}c.update=function(e,t,r,u){if(!t||arguments.length===1){var c=e;e=c.vertex;t=c.fragment;r=c.uniforms;u=c.attributes}var h=this;var p=h.gl;var v=h._vref;h._vref=o.shader(p,p.VERTEX_SHADER,e);if(v){v.dispose()}h.vertShader=h._vref.shader;var d=this._fref;h._fref=o.shader(p,p.FRAGMENT_SHADER,t);if(d){d.dispose()}h.fragShader=h._fref.shader;if(!r||!u){var m=p.createProgram();p.attachShader(m,h.fragShader);p.attachShader(m,h.vertShader);p.linkProgram(m);if(!p.getProgramParameter(m,p.LINK_STATUS)){var g=p.getProgramInfoLog(m);throw new l(g,"Error linking program:"+g)}r=r||s.uniforms(p,m);u=u||s.attributes(p,m);p.deleteProgram(m)}u=u.slice();u.sort(f);var y=[];var x=[];var b=[];var _;for(_=0;_<u.length;++_){var w=u[_];if(w.type.indexOf("mat")>=0){var T=w.type.charAt(w.type.length-1)|0;var k=new Array(T);for(var M=0;M<T;++M){k[M]=b.length;x.push(w.name+"["+M+"]");if(typeof w.location==="number"){b.push(w.location+M)}else if(Array.isArray(w.location)&&w.location.length===T&&typeof w.location[M]==="number"){b.push(w.location[M]|0)}else{b.push(-1)}}y.push({name:w.name,type:w.type,locations:k})}else{y.push({name:w.name,type:w.type,locations:[b.length]});x.push(w.name);if(typeof w.location==="number"){b.push(w.location|0)}else{b.push(-1)}}}var A=0;for(_=0;_<b.length;++_){if(b[_]<0){while(b.indexOf(A)>=0){A+=1}b[_]=A}}var S=new Array(r.length);function E(){h.program=o.program(p,h._vref,h._fref,x,b);for(var e=0;e<r.length;++e){S[e]=p.getUniformLocation(h.program,r[e].name)}}E();h._relink=E;h.types={uniforms:i(r),attributes:i(u)};h.attributes=n(p,h,y,b);Object.defineProperty(h,"uniforms",a(p,h,r,S))};function h(e,t,r,a,n){var i=new u(e);i.update(t,r,a,n);return i}t.exports=h},{"./lib/GLError":333,"./lib/create-attributes":334,"./lib/create-uniforms":335,"./lib/reflect":336,"./lib/runtime-reflect":337,"./lib/shader-cache":338}],333:[function(e,t,r){function a(e,t,r){this.shortMessage=t||"";this.longMessage=r||"";this.rawError=e||"";this.message="gl-shader: "+(t||e||"")+(r?"\n"+r:"");this.stack=(new Error).stack}a.prototype=new Error;a.prototype.name="GLError";a.prototype.constructor=a;t.exports=a},{}],334:[function(e,t,r){"use strict";t.exports=u;var a=e("./GLError");function n(e,t,r,a,n,i){this._gl=e;this._wrapper=t;this._index=r;this._locations=a;this._dimension=n;this._constFunc=i}var i=n.prototype;i.pointer=function e(t,r,a,n){var i=this;var o=i._gl;var s=i._locations[i._index];o.vertexAttribPointer(s,i._dimension,t||o.FLOAT,!!r,a||0,n||0);o.enableVertexAttribArray(s)};i.set=function(e,t,r,a){return this._constFunc(this._locations[this._index],e,t,r,a)};Object.defineProperty(i,"location",{get:function(){return this._locations[this._index]},set:function(e){if(e!==this._locations[this._index]){this._locations[this._index]=e|0;this._wrapper.program=null}return e|0}});var o=[function(e,t,r){if(r.length===undefined){return e.vertexAttrib1f(t,r)}else{return e.vertexAttrib1fv(t,r)}},function(e,t,r,a){if(r.length===undefined){return e.vertexAttrib2f(t,r,a)}else{return e.vertexAttrib2fv(t,r)}},function(e,t,r,a,n){if(r.length===undefined){return e.vertexAttrib3f(t,r,a,n)}else{return e.vertexAttrib3fv(t,r)}},function(e,t,r,a,n,i){if(r.length===undefined){return e.vertexAttrib4f(t,r,a,n,i)}else{return e.vertexAttrib4fv(t,r)}}];function s(e,t,r,a,i,s,l){var u=o[i];var c=new n(e,t,r,a,i,u);Object.defineProperty(s,l,{set:function(t){e.disableVertexAttribArray(a[r]);u(e,a[r],t);return t},get:function(){return c},enumerable:true})}function l(e,t,r,a,n,i,o){var l=new Array(n);var u=new Array(n);for(var c=0;c<n;++c){s(e,t,r[c],a,n,l,c);u[c]=l[c]}Object.defineProperty(l,"location",{set:function(e){if(Array.isArray(e)){for(var t=0;t<n;++t){u[t].location=e[t]}}else{for(var t=0;t<n;++t){u[t].location=e+t}}return e},get:function(){var e=new Array(n);for(var t=0;t<n;++t){e[t]=a[r[t]]}return e},enumerable:true});l.pointer=function(t,i,o,s){t=t||e.FLOAT;i=!!i;o=o||n*n;s=s||0;for(var l=0;l<n;++l){var u=a[r[l]];e.vertexAttribPointer(u,n,t,i,o,s+l*n);e.enableVertexAttribArray(u)}};var f=new Array(n);var h=e["vertexAttrib"+n+"fv"];Object.defineProperty(i,o,{set:function(t){for(var i=0;i<n;++i){var o=a[r[i]];e.disableVertexAttribArray(o);if(Array.isArray(t[0])){h.call(e,o,t[i])}else{for(var s=0;s<n;++s){f[s]=t[n*i+s]}h.call(e,o,f)}}return t},get:function(){return l},enumerable:true})}function u(e,t,r,n){var i={};for(var o=0,u=r.length;o<u;++o){var c=r[o];var f=c.name;var h=c.type;var p=c.locations;switch(h){case"bool":case"int":case"float":s(e,t,p[0],n,1,i,f);break;default:if(h.indexOf("vec")>=0){var v=h.charCodeAt(h.length-1)-48;if(v<2||v>4){throw new a("","Invalid data type for attribute "+f+": "+h)}s(e,t,p[0],n,v,i,f)}else if(h.indexOf("mat")>=0){var v=h.charCodeAt(h.length-1)-48;if(v<2||v>4){throw new a("","Invalid data type for attribute "+f+": "+h)}l(e,t,p,n,v,i,f)}else{throw new a("","Unknown data type for attribute "+f+": "+h)}break}}return i}},{"./GLError":333}],335:[function(e,t,r){"use strict";var a=e("./reflect");var n=e("./GLError");t.exports=s;function i(e){return function(){return e}}function o(e,t){var r=new Array(e);for(var a=0;a<e;++a){r[a]=t}return r}function s(e,t,r,s){function l(e){return function(t,r,a){return t.getUniform(r.program,a[e])}}function u(t){return function a(i){var o=c("",t);for(var l=0;l<o.length;++l){var u=o[l];var f=u[0];var h=u[1];if(s[h]){var p=i;if(typeof f==="string"&&(f.indexOf(".")===0||f.indexOf("[")===0)){var v=f;if(f.indexOf(".")===0){v=f.slice(1)}if(v.indexOf("]")===v.length-1){var d=v.indexOf("[");var m=v.slice(0,d);var g=v.slice(d+1,v.length-1);p=m?i[m][g]:i[g]}else{p=i[v]}}var y=r[h].type;var x;switch(y){case"bool":case"int":case"sampler2D":case"samplerCube":e.uniform1i(s[h],p);break;case"float":e.uniform1f(s[h],p);break;default:var b=y.indexOf("vec");if(0<=b&&b<=1&&y.length===4+b){x=y.charCodeAt(y.length-1)-48;if(x<2||x>4){throw new n("","Invalid data type")}switch(y.charAt(0)){case"b":case"i":e["uniform"+x+"iv"](s[h],p);break;case"v":e["uniform"+x+"fv"](s[h],p);break;default:throw new n("","Unrecognized data type for vector "+name+": "+y)}}else if(y.indexOf("mat")===0&&y.length===4){x=y.charCodeAt(y.length-1)-48;if(x<2||x>4){throw new n("","Invalid uniform dimension type for matrix "+name+": "+y)}e["uniformMatrix"+x+"fv"](s[h],false,p);break}else{throw new n("","Unknown uniform data type for "+name+": "+y)}}}}}}function c(e,t){if(typeof t!=="object"){return[[e,t]]}var r=[];for(var a in t){var n=t[a];var i=e;if(parseInt(a)+""===a){i+="["+a+"]"}else{i+="."+a}if(typeof n==="object"){r.push.apply(r,c(i,n))}else{r.push([i,n])}}return r}function f(e){switch(e){case"bool":return false;case"int":case"sampler2D":case"samplerCube":return 0;case"float":return 0;default:var t=e.indexOf("vec");if(0<=t&&t<=1&&e.length===4+t){var r=e.charCodeAt(e.length-1)-48;if(r<2||r>4){throw new n("","Invalid data type")}if(e.charAt(0)==="b"){return o(r,false)}return o(r,0)}else if(e.indexOf("mat")===0&&e.length===4){var r=e.charCodeAt(e.length-1)-48;if(r<2||r>4){throw new n("","Invalid uniform dimension type for matrix "+name+": "+e)}return o(r*r,0)}else{throw new n("","Unknown uniform data type for "+name+": "+e)}}}function h(e,t,a){if(typeof a==="object"){var n=p(a);Object.defineProperty(e,t,{get:i(n),set:u(a),enumerable:true,configurable:false})}else{if(s[a]){Object.defineProperty(e,t,{get:l(a),set:u(a),enumerable:true,configurable:false})}else{e[t]=f(r[a].type)}}}function p(e){var t;if(Array.isArray(e)){t=new Array(e.length);for(var r=0;r<e.length;++r){h(t,r,e[r])}}else{t={};for(var a in e){h(t,a,e[a])}}return t}var v=a(r,true);return{get:i(p(v)),set:u(v),enumerable:true,configurable:true}}},{"./GLError":333,"./reflect":336}],336:[function(e,t,r){"use strict";t.exports=a;function a(e,t){var r={};for(var a=0;a<e.length;++a){var n=e[a].name;var i=n.split(".");var o=r;for(var s=0;s<i.length;++s){var l=i[s].split("[");if(l.length>1){if(!(l[0]in o)){o[l[0]]=[]}o=o[l[0]];for(var u=1;u<l.length;++u){var c=parseInt(l[u]);if(u<l.length-1||s<i.length-1){if(!(c in o)){if(u<l.length-1){o[c]=[]}else{o[c]={}}}o=o[c]}else{if(t){o[c]=a}else{o[c]=e[a].type}}}}else if(s<i.length-1){if(!(l[0]in o)){o[l[0]]={}}o=o[l[0]]}else{if(t){o[l[0]]=a}else{o[l[0]]=e[a].type}}}}return r}},{}],337:[function(e,t,r){"use strict";r.uniforms=o;r.attributes=s;var a={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube"};var n=null;function i(e,t){if(!n){var r=Object.keys(a);n={};for(var i=0;i<r.length;++i){var o=r[i];n[e[o]]=a[o]}}return n[t]}function o(e,t){var r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);var a=[];for(var n=0;n<r;++n){var o=e.getActiveUniform(t,n);if(o){var s=i(e,o.type);if(o.size>1){for(var l=0;l<o.size;++l){a.push({name:o.name.replace("[0]","["+l+"]"),type:s})}}else{a.push({name:o.name,type:s})}}}return a}function s(e,t){var r=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES);var a=[];for(var n=0;n<r;++n){var o=e.getActiveAttrib(t,n);if(o){a.push({name:o.name,type:i(e,o.type)})}}return a}},{}],338:[function(e,t,r){"use strict";r.shader=v;r.program=d;var a=e("./GLError");var n=e("gl-format-compiler-error");var i=typeof WeakMap==="undefined"?e("weakmap-shim"):WeakMap;var o=new i;var s=0;function l(e,t,r,a,n,i,o){this.id=e;this.src=t;this.type=r;this.shader=a;this.count=i;this.programs=[];this.cache=o}l.prototype.dispose=function(){if(--this.count===0){var e=this.cache;var t=e.gl;var r=this.programs;for(var a=0,n=r.length;a<n;++a){var i=e.programs[r[a]];if(i){delete e.programs[a];t.deleteProgram(i)}}t.deleteShader(this.shader);delete e.shaders[this.type===t.FRAGMENT_SHADER|0][this.src]}};function u(e){this.gl=e;this.shaders=[{},{}];this.programs={}}var c=u.prototype;function f(e,t,r){var i=e.createShader(t);e.shaderSource(i,r);e.compileShader(i);if(!e.getShaderParameter(i,e.COMPILE_STATUS)){var o=e.getShaderInfoLog(i);try{var s=n(o,r,t)}catch(l){console.warn("Failed to format compiler error: "+l);throw new a(o,"Error compiling shader:\n"+o)}throw new a(o,s.short,s.long)}return i}c.getShaderReference=function(e,t){var r=this.gl;var a=this.shaders[e===r.FRAGMENT_SHADER|0];var n=a[t];if(!n||!r.isShader(n.shader)){var i=f(r,e,t);n=a[t]=new l(s++,t,e,i,[],1,this)}else{n.count+=1}return n};function h(e,t,r,n,i){var o=e.createProgram();e.attachShader(o,t);e.attachShader(o,r);for(var s=0;s<n.length;++s){e.bindAttribLocation(o,i[s],n[s])}e.linkProgram(o);if(!e.getProgramParameter(o,e.LINK_STATUS)){var l=e.getProgramInfoLog(o);throw new a(l,"Error linking program: "+l)}return o}c.getProgram=function(e,t,r,a){var n=[e.id,t.id,r.join(":"),a.join(":")].join("@");var i=this.programs[n];if(!i||!this.gl.isProgram(i)){this.programs[n]=i=h(this.gl,e.shader,t.shader,r,a);e.programs.push(n);t.programs.push(n)}return i};function p(e){var t=o.get(e);if(!t){t=new u(e);o.set(e,t)}return t}function v(e,t,r){return p(e).getShaderReference(t,r)}function d(e,t,r,a,n){return p(e).getProgram(t,r,a,n)}},{"./GLError":333,"gl-format-compiler-error":271,"weakmap-shim":612}],339:[function(e,t,r){"use strict";t.exports=i;function a(e){this.plot=e;this.enable=[true,true,false,false];this.width=[1,1,1,1];this.color=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.center=[Infinity,Infinity]}var n=a.prototype;n.update=function(e){e=e||{};this.enable=(e.enable||[true,true,false,false]).slice();this.width=(e.width||[1,1,1,1]).slice();this.color=(e.color||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]).map((function(e){return e.slice()}));this.center=(e.center||[Infinity,Infinity]).slice();this.plot.setOverlayDirty()};n.draw=function(){var e=this.enable;var t=this.width;var r=this.color;var a=this.center;var n=this.plot;var i=n.line;var o=n.dataBox;var s=n.viewBox;i.bind();if(o[0]<=a[0]&&a[0]<=o[2]&&o[1]<=a[1]&&a[1]<=o[3]){var l=s[0]+(a[0]-o[0])/(o[2]-o[0])*(s[2]-s[0]);var u=s[1]+(a[1]-o[1])/(o[3]-o[1])*(s[3]-s[1]);if(e[0]){i.drawLine(l,u,s[0],u,t[0],r[0])}if(e[1]){i.drawLine(l,u,l,s[1],t[1],r[1])}if(e[2]){i.drawLine(l,u,s[2],u,t[2],r[2])}if(e[3]){i.drawLine(l,u,l,s[3],t[3],r[3])}}};n.dispose=function(){this.plot.removeOverlay(this)};function i(e,t){var r=new a(e);r.update(t);e.addOverlay(r);return r}},{}],340:[function(e,t,r){"use strict";var a=e("glslify");var n=e("gl-shader");var i=a(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 position, color;\nattribute float weight;\n\nuniform mat4 model, view, projection;\nuniform vec3 coordinates[3];\nuniform vec4 colors[3];\nuniform vec2 screenShape;\nuniform float lineWidth;\n\nvarying vec4 fragColor;\n\nvoid main() {\n  vec3 vertexPosition = mix(coordinates[0],\n    mix(coordinates[2], coordinates[1], 0.5 * (position + 1.0)), abs(position));\n\n  vec4 clipPos = projection * view * model * vec4(vertexPosition, 1.0);\n  vec2 clipOffset = (projection * view * model * vec4(color, 0.0)).xy;\n  vec2 delta = weight * clipOffset * screenShape;\n  vec2 lineOffset = normalize(vec2(delta.y, -delta.x)) / screenShape;\n\n  gl_Position   = vec4(clipPos.xy + clipPos.w * 0.5 * lineWidth * lineOffset, clipPos.z, clipPos.w);\n  fragColor     = color.x * colors[0] + color.y * colors[1] + color.z * colors[2];\n}\n"]);var o=a(["precision mediump float;\n#define GLSLIFY 1\n\nvarying vec4 fragColor;\n\nvoid main() {\n  gl_FragColor = fragColor;\n}"]);t.exports=function(e){return n(e,i,o,null,[{name:"position",type:"vec3"},{name:"color",type:"vec3"},{name:"weight",type:"float"}])}},{"gl-shader":332,glslify:434}],341:[function(e,t,r){"use strict";var a=e("gl-buffer");var n=e("gl-vao");var i=e("./shaders/index");t.exports=h;var o=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function s(e,t,r,a){this.gl=e;this.buffer=t;this.vao=r;this.shader=a;this.pixelRatio=1;this.bounds=[[-1e3,-1e3,-1e3],[1e3,1e3,1e3]];this.position=[0,0,0];this.lineWidth=[2,2,2];this.colors=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.enabled=[true,true,true];this.drawSides=[true,true,true];this.axes=null}var l=s.prototype;var u=[0,0,0];var c=[0,0,0];var f=[0,0];l.isTransparent=function(){return false};l.drawTransparent=function(e){};l.draw=function(e){var t=this.gl;var r=this.vao;var a=this.shader;r.bind();a.bind();var n=e.model||o;var i=e.view||o;var s=e.projection||o;var l;if(this.axes){l=this.axes.lastCubeProps.axis}var h=u;var p=c;for(var v=0;v<3;++v){if(l&&l[v]<0){h[v]=this.bounds[0][v];p[v]=this.bounds[1][v]}else{h[v]=this.bounds[1][v];p[v]=this.bounds[0][v]}}f[0]=t.drawingBufferWidth;f[1]=t.drawingBufferHeight;a.uniforms.model=n;a.uniforms.view=i;a.uniforms.projection=s;a.uniforms.coordinates=[this.position,h,p];a.uniforms.colors=this.colors;a.uniforms.screenShape=f;for(var v=0;v<3;++v){a.uniforms.lineWidth=this.lineWidth[v]*this.pixelRatio;if(this.enabled[v]){r.draw(t.TRIANGLES,6,6*v);if(this.drawSides[v]){r.draw(t.TRIANGLES,12,18+12*v)}}}r.unbind()};l.update=function(e){if(!e){return}if("bounds"in e){this.bounds=e.bounds}if("position"in e){this.position=e.position}if("lineWidth"in e){this.lineWidth=e.lineWidth}if("colors"in e){this.colors=e.colors}if("enabled"in e){this.enabled=e.enabled}if("drawSides"in e){this.drawSides=e.drawSides}};l.dispose=function(){this.vao.dispose();this.buffer.dispose();this.shader.dispose()};function h(e,t){var r=[];function o(e,t,a,n,i,o){var s=[e,t,a,0,0,0,1];s[n+3]=1;s[n]=i;r.push.apply(r,s);s[6]=-1;r.push.apply(r,s);s[n]=o;r.push.apply(r,s);r.push.apply(r,s);s[6]=1;r.push.apply(r,s);s[n]=i;r.push.apply(r,s)}o(0,0,0,0,0,1);o(0,0,0,1,0,1);o(0,0,0,2,0,1);o(1,0,0,1,-1,1);o(1,0,0,2,-1,1);o(0,1,0,0,-1,1);o(0,1,0,2,-1,1);o(0,0,1,0,-1,1);o(0,0,1,1,-1,1);var l=a(e,r);var u=n(e,[{type:e.FLOAT,buffer:l,size:3,offset:0,stride:28},{type:e.FLOAT,buffer:l,size:3,offset:12,stride:28},{type:e.FLOAT,buffer:l,size:1,offset:24,stride:28}]);var c=i(e);c.attributes.position.location=0;c.attributes.color.location=1;c.attributes.weight.location=2;var f=new s(e,l,u,c);f.update(t);return f}},{"./shaders/index":340,"gl-buffer":261,"gl-vao":353}],342:[function(e,t,r){var a=e("glslify");var n=a(["precision highp float;\n\nprecision highp float;\n#define GLSLIFY 1\n\nvec3 getOrthogonalVector(vec3 v) {\n  // Return up-vector for only-z vector.\n  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).\n  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.\n  // Assign z = 0, x = -b, y = a:\n  // a*-b + b*a + c*0 = -ba + ba + 0 = 0\n  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {\n    return normalize(vec3(-v.y, v.x, 0.0));\n  } else {\n    return normalize(vec3(0.0, v.z, -v.y));\n  }\n}\n\n// Calculate the tube vertex and normal at the given index.\n//\n// The returned vertex is for a tube ring with its center at origin, radius of length(d), pointing in the direction of d.\n//\n// Each tube segment is made up of a ring of vertices.\n// These vertices are used to make up the triangles of the tube by connecting them together in the vertex array.\n// The indexes of tube segments run from 0 to 8.\n//\nvec3 getTubePosition(vec3 d, float index, out vec3 normal) {\n  float segmentCount = 8.0;\n\n  float angle = 2.0 * 3.14159 * (index / segmentCount);\n\n  vec3 u = getOrthogonalVector(d);\n  vec3 v = normalize(cross(u, d));\n\n  vec3 x = u * cos(angle) * length(d);\n  vec3 y = v * sin(angle) * length(d);\n  vec3 v3 = x + y;\n\n  normal = normalize(v3);\n\n  return v3;\n}\n\nattribute vec4 vector;\nattribute vec4 color, position;\nattribute vec2 uv;\n\nuniform float vectorScale, tubeScale;\nuniform mat4 model, view, projection, inverseModel;\nuniform vec3 eyePosition, lightPosition;\n\nvarying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  // Scale the vector magnitude to stay constant with\n  // model & view changes.\n  vec3 normal;\n  vec3 XYZ = getTubePosition(mat3(model) * (tubeScale * vector.w * normalize(vector.xyz)), position.w, normal);\n  vec4 tubePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);\n\n  //Lighting geometry parameters\n  vec4 cameraCoordinate = view * tubePosition;\n  cameraCoordinate.xyz /= cameraCoordinate.w;\n  f_lightDirection = lightPosition - cameraCoordinate.xyz;\n  f_eyeDirection   = eyePosition - cameraCoordinate.xyz;\n  f_normal = normalize((vec4(normal, 0.0) * inverseModel).xyz);\n\n  // vec4 m_position  = model * vec4(tubePosition, 1.0);\n  vec4 t_position  = view * tubePosition;\n  gl_Position      = projection * t_position;\n\n  f_color          = color;\n  f_data           = tubePosition.xyz;\n  f_position       = position.xyz;\n  f_uv             = uv;\n}\n"]);var i=a(["#extension GL_OES_standard_derivatives : enable\n\nprecision highp float;\n#define GLSLIFY 1\n\nfloat beckmannDistribution(float x, float roughness) {\n  float NdotH = max(x, 0.0001);\n  float cos2Alpha = NdotH * NdotH;\n  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;\n  float roughness2 = roughness * roughness;\n  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;\n  return exp(tan2Alpha / roughness2) / denom;\n}\n\nfloat cookTorranceSpecular(\n  vec3 lightDirection,\n  vec3 viewDirection,\n  vec3 surfaceNormal,\n  float roughness,\n  float fresnel) {\n\n  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);\n  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);\n\n  //Half angle vector\n  vec3 H = normalize(lightDirection + viewDirection);\n\n  //Geometric term\n  float NdotH = max(dot(surfaceNormal, H), 0.0);\n  float VdotH = max(dot(viewDirection, H), 0.000001);\n  float LdotH = max(dot(lightDirection, H), 0.000001);\n  float G1 = (2.0 * NdotH * VdotN) / VdotH;\n  float G2 = (2.0 * NdotH * LdotN) / LdotH;\n  float G = min(1.0, min(G1, G2));\n  \n  //Distribution term\n  float D = beckmannDistribution(NdotH, roughness);\n\n  //Fresnel term\n  float F = pow(1.0 - VdotN, fresnel);\n\n  //Multiply terms and done\n  return  G * F * D / max(3.14159265 * VdotN, 0.000001);\n}\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 clipBounds[2];\nuniform float roughness, fresnel, kambient, kdiffuse, kspecular, opacity;\nuniform sampler2D texture;\n\nvarying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;\n  vec3 N = normalize(f_normal);\n  vec3 L = normalize(f_lightDirection);\n  vec3 V = normalize(f_eyeDirection);\n\n  if(gl_FrontFacing) {\n    N = -N;\n  }\n\n  float specular = min(1.0, max(0.0, cookTorranceSpecular(L, V, N, roughness, fresnel)));\n  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);\n\n  vec4 surfaceColor = f_color * texture2D(texture, f_uv);\n  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);\n\n  gl_FragColor = litColor * opacity;\n}\n"]);var o=a(["precision highp float;\n\nprecision highp float;\n#define GLSLIFY 1\n\nvec3 getOrthogonalVector(vec3 v) {\n  // Return up-vector for only-z vector.\n  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).\n  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.\n  // Assign z = 0, x = -b, y = a:\n  // a*-b + b*a + c*0 = -ba + ba + 0 = 0\n  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {\n    return normalize(vec3(-v.y, v.x, 0.0));\n  } else {\n    return normalize(vec3(0.0, v.z, -v.y));\n  }\n}\n\n// Calculate the tube vertex and normal at the given index.\n//\n// The returned vertex is for a tube ring with its center at origin, radius of length(d), pointing in the direction of d.\n//\n// Each tube segment is made up of a ring of vertices.\n// These vertices are used to make up the triangles of the tube by connecting them together in the vertex array.\n// The indexes of tube segments run from 0 to 8.\n//\nvec3 getTubePosition(vec3 d, float index, out vec3 normal) {\n  float segmentCount = 8.0;\n\n  float angle = 2.0 * 3.14159 * (index / segmentCount);\n\n  vec3 u = getOrthogonalVector(d);\n  vec3 v = normalize(cross(u, d));\n\n  vec3 x = u * cos(angle) * length(d);\n  vec3 y = v * sin(angle) * length(d);\n  vec3 v3 = x + y;\n\n  normal = normalize(v3);\n\n  return v3;\n}\n\nattribute vec4 vector;\nattribute vec4 position;\nattribute vec4 id;\n\nuniform mat4 model, view, projection;\nuniform float tubeScale;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  vec3 normal;\n  vec3 XYZ = getTubePosition(mat3(model) * (tubeScale * vector.w * normalize(vector.xyz)), position.w, normal);\n  vec4 tubePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);\n\n  gl_Position = projection * view * tubePosition;\n  f_id        = id;\n  f_position  = position.xyz;\n}\n"]);var s=a(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3  clipBounds[2];\nuniform float pickId;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;\n\n  gl_FragColor = vec4(pickId, f_id.xyz);\n}"]);r.meshShader={vertex:n,fragment:i,attributes:[{name:"position",type:"vec4"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"vector",type:"vec4"}]};r.pickShader={vertex:o,fragment:s,attributes:[{name:"position",type:"vec4"},{name:"id",type:"vec4"},{name:"vector",type:"vec4"}]}},{glslify:343}],343:[function(e,t,r){arguments[4][268][0].apply(r,arguments)},{dup:268}],344:[function(e,t,r){"use strict";var a=e("gl-vec3");var n=e("gl-vec4");var i=["xyz","xzy","yxz","yzx","zxy","zyx"];var o=function(e,t,r,i){var o=e.points;var s=e.velocities;var l=e.divergences;var u=[];var c=[];var f=[];var h=[];var p=[];var v=[];var d=0;var m=0;var g=n.create();var y=n.create();var x=8;for(var b=0;b<o.length;b++){var _=o[b];var w=s[b];var T=l[b];if(t===0){T=r*.05}m=a.length(w)/i;g=n.create();a.copy(g,w);g[3]=T;for(var k=0;k<x;k++){p[k]=[_[0],_[1],_[2],k]}if(h.length>0){for(var k=0;k<x;k++){var M=(k+1)%x;u.push(h[k],p[k],p[M],p[M],h[M],h[k]);f.push(y,g,g,g,y,y);v.push(d,m,m,m,d,d);var A=u.length;c.push([A-6,A-5,A-4],[A-3,A-2,A-1])}}var S=h;h=p;p=S;var E=y;y=g;g=E;var L=d;d=m;m=L}return{positions:u,cells:c,vectors:f,vertexIntensity:v}};var s=function(e,t,r,n){var i=0;for(var s=0;s<e.length;s++){var l=e[s].velocities;for(var u=0;u<l.length;u++){i=Math.max(i,a.length(l[u]))}}var c=e.map((function(e){return o(e,r,n,i)}));var f=[];var h=[];var p=[];var v=[];for(var s=0;s<c.length;s++){var d=c[s];var m=f.length;f=f.concat(d.positions);p=p.concat(d.vectors);v=v.concat(d.vertexIntensity);for(var u=0;u<d.cells.length;u++){var g=d.cells[u];var y=[];h.push(y);for(var x=0;x<g.length;x++){y.push(g[x]+m)}}}return{positions:f,cells:h,vectors:p,vertexIntensity:v,colormap:t}};var l=function(e,t){var r=e.length;var a;for(a=0;a<r;a++){var n=e[a];if(n===t)return a;else if(n>t)return a-1}return a};var u=function(e,t,r){return e<t?t:e>r?r:e};var c=function(e,t,r){var n=t.vectors;var i=t.meshgrid;var o=e[0];var s=e[1];var c=e[2];var f=i[0].length;var h=i[1].length;var p=i[2].length;var v=l(i[0],o);var d=l(i[1],s);var m=l(i[2],c);var g=v+1;var y=d+1;var x=m+1;v=u(v,0,f-1);g=u(g,0,f-1);d=u(d,0,h-1);y=u(y,0,h-1);m=u(m,0,p-1);x=u(x,0,p-1);if(v<0||d<0||m<0||g>f-1||y>h-1||x>p-1){return a.create()}var b=i[0][v];var _=i[0][g];var w=i[1][d];var T=i[1][y];var k=i[2][m];var M=i[2][x];var A=(o-b)/(_-b);var S=(s-w)/(T-w);var E=(c-k)/(M-k);if(!isFinite(A))A=.5;if(!isFinite(S))S=.5;if(!isFinite(E))E=.5;var L;var C;var I;var P;var O;var z;if(r.reversedX){v=f-1-v;g=f-1-g}if(r.reversedY){d=h-1-d;y=h-1-y}if(r.reversedZ){m=p-1-m;x=p-1-x}switch(r.filled){case 5:O=m;z=x;I=d*p;P=y*p;L=v*p*h;C=g*p*h;break;case 4:O=m;z=x;L=v*p;C=g*p;I=d*p*f;P=y*p*f;break;case 3:I=d;P=y;O=m*h;z=x*h;L=v*h*p;C=g*h*p;break;case 2:I=d;P=y;L=v*h;C=g*h;O=m*h*f;z=x*h*f;break;case 1:L=v;C=g;O=m*f;z=x*f;I=d*f*p;P=y*f*p;break;default:L=v;C=g;I=d*f;P=y*f;O=m*f*h;z=x*f*h;break}var D=n[L+I+O];var R=n[L+I+z];var F=n[L+P+O];var B=n[L+P+z];var N=n[C+I+O];var j=n[C+I+z];var U=n[C+P+O];var V=n[C+P+z];var H=a.create();var q=a.create();var G=a.create();var Y=a.create();a.lerp(H,D,N,A);a.lerp(q,R,j,A);a.lerp(G,F,U,A);a.lerp(Y,B,V,A);var W=a.create();var X=a.create();a.lerp(W,H,G,S);a.lerp(X,q,Y,S);var Z=a.create();a.lerp(Z,W,X,E);return Z};var f=function(e,t){var r=t[0];var a=t[1];var n=t[2];e[0]=r<0?-r:r;e[1]=a<0?-a:a;e[2]=n<0?-n:n;return e};var h=function(e){var t=Infinity;e.sort((function(e,t){return e-t}));var r=e.length;for(var a=1;a<r;a++){var n=Math.abs(e[a]-e[a-1]);if(n<t){t=n}}return t};var p=function(e){var t=[],r=[],a=[];var n={},i={},o={};var s=e.length;for(var l=0;l<s;l++){var u=e[l];var c=u[0],f=u[1],p=u[2];if(!n[c]){t.push(c);n[c]=true}if(!i[f]){r.push(f);i[f]=true}if(!o[p]){a.push(p);o[p]=true}}var v=h(t);var d=h(r);var m=h(a);var g=Math.min(v,d,m);return isFinite(g)?g:1};t.exports=function(e,t){var r=e.startingPositions;var n=e.maxLength||1e3;var o=e.tubeSize||1;var l=e.absoluteTubeSize;var u=e.gridFill||"+x+y+z";var f={};if(u.indexOf("-x")!==-1){f.reversedX=true}if(u.indexOf("-y")!==-1){f.reversedY=true}if(u.indexOf("-z")!==-1){f.reversedZ=true}f.filled=i.indexOf(u.replace(/-/g,"").replace(/\+/g,""));var h=e.getVelocity||function(t){return c(t,e,f)};var v=e.getDivergence||function(e,t){var r=a.create();var n=1e-4;a.add(r,e,[n,0,0]);var i=h(r);a.subtract(i,i,t);a.scale(i,i,1/n);a.add(r,e,[0,n,0]);var o=h(r);a.subtract(o,o,t);a.scale(o,o,1/n);a.add(r,e,[0,0,n]);var s=h(r);a.subtract(s,s,t);a.scale(s,s,1/n);a.add(r,i,o);a.add(r,r,s);return r};var d=[];var m=t[0][0],g=t[0][1],y=t[0][2];var x=t[1][0],b=t[1][1],_=t[1][2];var w=function(e){var t=e[0];var r=e[1];var a=e[2];return!(t<m||t>x||r<g||r>b||a<y||a>_)};var T=a.distance(t[0],t[1]);var k=10*T/n;var M=k*k;var A=1;var S=0;var E=r.length;if(E>1){A=p(r)}for(var L=0;L<E;L++){var C=a.create();a.copy(C,r[L]);var I=[C];var P=[];var O=h(C);var z=C;P.push(O);var D=[];var R=v(C,O);var F=a.length(R);if(isFinite(F)&&F>S){S=F}D.push(F);d.push({points:I,velocities:P,divergences:D});var B=0;while(B<n*100&&I.length<n&&w(C)){B++;var N=a.clone(O);var j=a.squaredLength(N);if(j===0){break}else if(j>M){a.scale(N,N,k/Math.sqrt(j))}a.add(N,N,C);O=h(N);if(a.squaredDistance(z,N)-M>-1e-4*M){I.push(N);z=N;P.push(O);var R=v(N,O);var F=a.length(R);if(isFinite(F)&&F>S){S=F}D.push(F)}C=N}}var U=s(d,e.colormap,S,A);if(l){U.tubeScale=l}else{if(S===0){S=1}U.tubeScale=o*.5*A/S}return U};var v=e("./lib/shaders");var d=e("gl-cone3d").createMesh;t.exports.createTubeMesh=function(e,t){return d(e,t,{shaders:v,traceType:"streamtube"})}},{"./lib/shaders":342,"gl-cone3d":262,"gl-vec3":372,"gl-vec4":408}],345:[function(e,t,r){var a=e("gl-shader");var n=e("glslify");var i=n(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec4 uv;\nattribute vec3 f;\nattribute vec3 normal;\n\nuniform vec3 objectOffset;\nuniform mat4 model, view, projection, inverseModel;\nuniform vec3 lightPosition, eyePosition;\nuniform sampler2D colormap;\n\nvarying float value, kill;\nvarying vec3 worldCoordinate;\nvarying vec2 planeCoordinate;\nvarying vec3 lightDirection, eyeDirection, surfaceNormal;\nvarying vec4 vColor;\n\nvoid main() {\n  vec3 localCoordinate = vec3(uv.zw, f.x);\n  worldCoordinate = objectOffset + localCoordinate;\n  vec4 worldPosition = model * vec4(worldCoordinate, 1.0);\n  vec4 clipPosition = projection * view * worldPosition;\n  gl_Position = clipPosition;\n  kill = f.y;\n  value = f.z;\n  planeCoordinate = uv.xy;\n\n  vColor = texture2D(colormap, vec2(value, value));\n\n  //Lighting geometry parameters\n  vec4 cameraCoordinate = view * worldPosition;\n  cameraCoordinate.xyz /= cameraCoordinate.w;\n  lightDirection = lightPosition - cameraCoordinate.xyz;\n  eyeDirection   = eyePosition - cameraCoordinate.xyz;\n  surfaceNormal  = normalize((vec4(normal,0) * inverseModel).xyz);\n}\n"]);var o=n(["precision highp float;\n#define GLSLIFY 1\n\nfloat beckmannDistribution(float x, float roughness) {\n  float NdotH = max(x, 0.0001);\n  float cos2Alpha = NdotH * NdotH;\n  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;\n  float roughness2 = roughness * roughness;\n  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;\n  return exp(tan2Alpha / roughness2) / denom;\n}\n\nfloat beckmannSpecular(\n  vec3 lightDirection,\n  vec3 viewDirection,\n  vec3 surfaceNormal,\n  float roughness) {\n  return beckmannDistribution(dot(surfaceNormal, normalize(lightDirection + viewDirection)), roughness);\n}\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 lowerBound, upperBound;\nuniform float contourTint;\nuniform vec4 contourColor;\nuniform sampler2D colormap;\nuniform vec3 clipBounds[2];\nuniform float roughness, fresnel, kambient, kdiffuse, kspecular, opacity;\nuniform float vertexColor;\n\nvarying float value, kill;\nvarying vec3 worldCoordinate;\nvarying vec3 lightDirection, eyeDirection, surfaceNormal;\nvarying vec4 vColor;\n\nvoid main() {\n  if (\n    kill > 0.0 ||\n    vColor.a == 0.0 ||\n    outOfRange(clipBounds[0], clipBounds[1], worldCoordinate)\n  ) discard;\n\n  vec3 N = normalize(surfaceNormal);\n  vec3 V = normalize(eyeDirection);\n  vec3 L = normalize(lightDirection);\n\n  if(gl_FrontFacing) {\n    N = -N;\n  }\n\n  float specular = max(beckmannSpecular(L, V, N, roughness), 0.);\n  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);\n\n  //decide how to interpolate color — in vertex or in fragment\n  vec4 surfaceColor =\n    step(vertexColor, .5) * texture2D(colormap, vec2(value, value)) +\n    step(.5, vertexColor) * vColor;\n\n  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);\n\n  gl_FragColor = mix(litColor, contourColor, contourTint) * opacity;\n}\n"]);var s=n(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec4 uv;\nattribute float f;\n\nuniform vec3 objectOffset;\nuniform mat3 permutation;\nuniform mat4 model, view, projection;\nuniform float height, zOffset;\nuniform sampler2D colormap;\n\nvarying float value, kill;\nvarying vec3 worldCoordinate;\nvarying vec2 planeCoordinate;\nvarying vec3 lightDirection, eyeDirection, surfaceNormal;\nvarying vec4 vColor;\n\nvoid main() {\n  vec3 dataCoordinate = permutation * vec3(uv.xy, height);\n  worldCoordinate = objectOffset + dataCoordinate;\n  vec4 worldPosition = model * vec4(worldCoordinate, 1.0);\n\n  vec4 clipPosition = projection * view * worldPosition;\n  clipPosition.z += zOffset;\n\n  gl_Position = clipPosition;\n  value = f + objectOffset.z;\n  kill = -1.0;\n  planeCoordinate = uv.zw;\n\n  vColor = texture2D(colormap, vec2(value, value));\n\n  //Don't do lighting for contours\n  surfaceNormal   = vec3(1,0,0);\n  eyeDirection    = vec3(0,1,0);\n  lightDirection  = vec3(0,0,1);\n}\n"]);var l=n(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec2 shape;\nuniform vec3 clipBounds[2];\nuniform float pickId;\n\nvarying float value, kill;\nvarying vec3 worldCoordinate;\nvarying vec2 planeCoordinate;\nvarying vec3 surfaceNormal;\n\nvec2 splitFloat(float v) {\n  float vh = 255.0 * v;\n  float upper = floor(vh);\n  float lower = fract(vh);\n  return vec2(upper / 255.0, floor(lower * 16.0) / 16.0);\n}\n\nvoid main() {\n  if ((kill > 0.0) ||\n      (outOfRange(clipBounds[0], clipBounds[1], worldCoordinate))) discard;\n\n  vec2 ux = splitFloat(planeCoordinate.x / shape.x);\n  vec2 uy = splitFloat(planeCoordinate.y / shape.y);\n  gl_FragColor = vec4(pickId, ux.x, uy.x, ux.y + (uy.y/16.0));\n}\n"]);r.createShader=function(e){var t=a(e,i,o,null,[{name:"uv",type:"vec4"},{name:"f",type:"vec3"},{name:"normal",type:"vec3"}]);t.attributes.uv.location=0;t.attributes.f.location=1;t.attributes.normal.location=2;return t};r.createPickShader=function(e){var t=a(e,i,l,null,[{name:"uv",type:"vec4"},{name:"f",type:"vec3"},{name:"normal",type:"vec3"}]);t.attributes.uv.location=0;t.attributes.f.location=1;t.attributes.normal.location=2;return t};r.createContourShader=function(e){var t=a(e,s,o,null,[{name:"uv",type:"vec4"},{name:"f",type:"float"}]);t.attributes.uv.location=0;t.attributes.f.location=1;return t};r.createPickContourShader=function(e){var t=a(e,s,l,null,[{name:"uv",type:"vec4"},{name:"f",type:"float"}]);t.attributes.uv.location=0;t.attributes.f.location=1;return t}},{"gl-shader":332,glslify:434}],346:[function(e,t,r){"use strict";t.exports=V;var a=e("bit-twiddle");var n=e("gl-buffer");var i=e("gl-vao");var o=e("gl-texture2d");var s=e("typedarray-pool");var l=e("colormap");var u=e("ndarray-ops");var c=e("ndarray-pack");var f=e("ndarray");var h=e("surface-nets");var p=e("gl-mat4/multiply");var v=e("gl-mat4/invert");var d=e("binary-search-bounds");var m=e("ndarray-gradient");var g=e("./lib/shaders");var y=g.createShader;var x=g.createContourShader;var b=g.createPickShader;var _=g.createPickContourShader;var w=4*(4+3+3);var T=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];var k=[[0,0],[0,1],[1,0],[1,1],[1,0],[0,1]];var M=[[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0]];(function(){for(var e=0;e<3;++e){var t=M[e];var r=(e+1)%3;var a=(e+2)%3;t[r+0]=1;t[a+3]=1;t[e+6]=1}})();function A(e,t,r,a,n){this.position=e;this.index=t;this.uv=r;this.level=a;this.dataCoordinate=n}var S=256;function E(e,t,r,a,n,i,o,l,u,c,h,p,v,d,m){this.gl=e;this.shape=t;this.bounds=r;this.objectOffset=m;this.intensityBounds=[];this._shader=a;this._pickShader=n;this._coordinateBuffer=i;this._vao=o;this._colorMap=l;this._contourShader=u;this._contourPickShader=c;this._contourBuffer=h;this._contourVAO=p;this._contourOffsets=[[],[],[]];this._contourCounts=[[],[],[]];this._vertexCount=0;this._pickResult=new A([0,0,0],[0,0],[0,0],[0,0,0],[0,0,0]);this._dynamicBuffer=v;this._dynamicVAO=d;this._dynamicOffsets=[0,0,0];this._dynamicCounts=[0,0,0];this.contourWidth=[1,1,1];this.contourLevels=[[1],[1],[1]];this.contourTint=[0,0,0];this.contourColor=[[.5,.5,.5,1],[.5,.5,.5,1],[.5,.5,.5,1]];this.showContour=true;this.showSurface=true;this.enableHighlight=[true,true,true];this.highlightColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.highlightTint=[1,1,1];this.highlightLevel=[-1,-1,-1];this.enableDynamic=[true,true,true];this.dynamicLevel=[NaN,NaN,NaN];this.dynamicColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.dynamicTint=[1,1,1];this.dynamicWidth=[1,1,1];this.axesBounds=[[Infinity,Infinity,Infinity],[-Infinity,-Infinity,-Infinity]];this.surfaceProject=[false,false,false];this.contourProject=[[false,false,false],[false,false,false],[false,false,false]];this.colorBounds=[false,false];this._field=[f(s.mallocFloat(1024),[0,0]),f(s.mallocFloat(1024),[0,0]),f(s.mallocFloat(1024),[0,0])];this.pickId=1;this.clipBounds=[[-Infinity,-Infinity,-Infinity],[Infinity,Infinity,Infinity]];this.snapToData=false;this.pixelRatio=1;this.opacity=1;this.lightPosition=[10,1e4,0];this.ambientLight=.8;this.diffuseLight=.8;this.specularLight=2;this.roughness=.5;this.fresnel=1.5;this.vertexColor=0;this.dirty=true}var L=E.prototype;L.genColormap=function(e,t){var r=false;var a=c([l({colormap:e,nshades:S,format:"rgba"}).map((function(e,a){var n=t?C(a/255,t):e[3];if(n<1)r=true;return[e[0],e[1],e[2],255*n]}))]);u.divseq(a,255);this.hasAlphaScale=r;return a};L.isTransparent=function(){return this.opacity<1||this.hasAlphaScale};L.isOpaque=function(){return!this.isTransparent()};L.pickSlots=1;L.setPickBase=function(e){this.pickId=e};function C(e,t){if(!t)return 1;if(!t.length)return 1;for(var r=0;r<t.length;++r){if(t.length<2)return 1;if(t[r][0]===e)return t[r][1];if(t[r][0]>e&&r>0){var a=(t[r][0]-e)/(t[r][0]-t[r-1][0]);return t[r][1]*(1-a)+a*t[r-1][1]}}return 1}var I=[0,0,0];var P={showSurface:false,showContour:false,projections:[T.slice(),T.slice(),T.slice()],clipBounds:[[[0,0,0],[0,0,0]],[[0,0,0],[0,0,0]],[[0,0,0],[0,0,0]]]};function O(e,t){var r,a,n;var i=t.axes&&t.axes.lastCubeProps.axis||I;var o=t.showSurface;var s=t.showContour;for(r=0;r<3;++r){o=o||t.surfaceProject[r];for(a=0;a<3;++a){s=s||t.contourProject[r][a]}}for(r=0;r<3;++r){var l=P.projections[r];for(a=0;a<16;++a){l[a]=0}for(a=0;a<4;++a){l[5*a]=1}l[5*r]=0;l[12+r]=t.axesBounds[+(i[r]>0)][r];p(l,e.model,l);var u=P.clipBounds[r];for(n=0;n<2;++n){for(a=0;a<3;++a){u[n][a]=e.clipBounds[n][a]}}u[0][r]=-1e8;u[1][r]=1e8}P.showSurface=o;P.showContour=s;return P}var z={model:T,view:T,projection:T,inverseModel:T.slice(),lowerBound:[0,0,0],upperBound:[0,0,0],colorMap:0,clipBounds:[[0,0,0],[0,0,0]],height:0,contourTint:0,contourColor:[0,0,0,1],permutation:[1,0,0,0,1,0,0,0,1],zOffset:-1e-4,objectOffset:[0,0,0],kambient:1,kdiffuse:1,kspecular:1,lightPosition:[1e3,1e3,1e3],eyePosition:[0,0,0],roughness:1,fresnel:1,opacity:1,vertexColor:0};var D=T.slice();var R=[1,0,0,0,1,0,0,0,1];function F(e,t){e=e||{};var r=this.gl;r.disable(r.CULL_FACE);this._colorMap.bind(0);var a=z;a.model=e.model||T;a.view=e.view||T;a.projection=e.projection||T;a.lowerBound=[this.bounds[0][0],this.bounds[0][1],this.colorBounds[0]||this.bounds[0][2]];a.upperBound=[this.bounds[1][0],this.bounds[1][1],this.colorBounds[1]||this.bounds[1][2]];a.objectOffset=this.objectOffset;a.contourColor=this.contourColor[0];a.inverseModel=v(a.inverseModel,a.model);for(var n=0;n<2;++n){var i=a.clipBounds[n];for(var o=0;o<3;++o){i[o]=Math.min(Math.max(this.clipBounds[n][o],-1e8),1e8)}}a.kambient=this.ambientLight;a.kdiffuse=this.diffuseLight;a.kspecular=this.specularLight;a.roughness=this.roughness;a.fresnel=this.fresnel;a.opacity=this.opacity;a.height=0;a.permutation=R;a.vertexColor=this.vertexColor;var s=D;p(s,a.view,a.model);p(s,a.projection,s);v(s,s);for(n=0;n<3;++n){a.eyePosition[n]=s[12+n]/s[15]}var l=s[15];for(n=0;n<3;++n){l+=this.lightPosition[n]*s[4*n+3]}for(n=0;n<3;++n){var u=s[12+n];for(o=0;o<3;++o){u+=s[4*o+n]*this.lightPosition[o]}a.lightPosition[n]=u/l}var c=O(a,this);if(c.showSurface){this._shader.bind();this._shader.uniforms=a;this._vao.bind();if(this.showSurface&&this._vertexCount){this._vao.draw(r.TRIANGLES,this._vertexCount)}for(n=0;n<3;++n){if(!this.surfaceProject[n]||!this.vertexCount){continue}this._shader.uniforms.model=c.projections[n];this._shader.uniforms.clipBounds=c.clipBounds[n];this._vao.draw(r.TRIANGLES,this._vertexCount)}this._vao.unbind()}if(c.showContour){var f=this._contourShader;a.kambient=1;a.kdiffuse=0;a.kspecular=0;a.opacity=1;f.bind();f.uniforms=a;var h=this._contourVAO;h.bind();for(n=0;n<3;++n){f.uniforms.permutation=M[n];r.lineWidth(this.contourWidth[n]*this.pixelRatio);for(o=0;o<this.contourLevels[n].length;++o){if(o===this.highlightLevel[n]){f.uniforms.contourColor=this.highlightColor[n];f.uniforms.contourTint=this.highlightTint[n]}else if(o===0||o-1===this.highlightLevel[n]){f.uniforms.contourColor=this.contourColor[n];f.uniforms.contourTint=this.contourTint[n]}if(!this._contourCounts[n][o]){continue}f.uniforms.height=this.contourLevels[n][o];h.draw(r.LINES,this._contourCounts[n][o],this._contourOffsets[n][o])}}for(n=0;n<3;++n){f.uniforms.model=c.projections[n];f.uniforms.clipBounds=c.clipBounds[n];for(o=0;o<3;++o){if(!this.contourProject[n][o]){continue}f.uniforms.permutation=M[o];r.lineWidth(this.contourWidth[o]*this.pixelRatio);for(var d=0;d<this.contourLevels[o].length;++d){if(d===this.highlightLevel[o]){f.uniforms.contourColor=this.highlightColor[o];f.uniforms.contourTint=this.highlightTint[o]}else if(d===0||d-1===this.highlightLevel[o]){f.uniforms.contourColor=this.contourColor[o];f.uniforms.contourTint=this.contourTint[o]}if(!this._contourCounts[o][d]){continue}f.uniforms.height=this.contourLevels[o][d];h.draw(r.LINES,this._contourCounts[o][d],this._contourOffsets[o][d])}}}h.unbind();h=this._dynamicVAO;h.bind();for(n=0;n<3;++n){if(this._dynamicCounts[n]===0){continue}f.uniforms.model=a.model;f.uniforms.clipBounds=a.clipBounds;f.uniforms.permutation=M[n];r.lineWidth(this.dynamicWidth[n]*this.pixelRatio);f.uniforms.contourColor=this.dynamicColor[n];f.uniforms.contourTint=this.dynamicTint[n];f.uniforms.height=this.dynamicLevel[n];h.draw(r.LINES,this._dynamicCounts[n],this._dynamicOffsets[n]);for(o=0;o<3;++o){if(!this.contourProject[o][n]){continue}f.uniforms.model=c.projections[o];f.uniforms.clipBounds=c.clipBounds[o];h.draw(r.LINES,this._dynamicCounts[n],this._dynamicOffsets[n])}}h.unbind()}}L.draw=function(e){return F.call(this,e,false)};L.drawTransparent=function(e){return F.call(this,e,true)};var B={model:T,view:T,projection:T,inverseModel:T,clipBounds:[[0,0,0],[0,0,0]],height:0,shape:[0,0],pickId:0,lowerBound:[0,0,0],upperBound:[0,0,0],zOffset:0,objectOffset:[0,0,0],permutation:[1,0,0,0,1,0,0,0,1],lightPosition:[0,0,0],eyePosition:[0,0,0]};L.drawPick=function(e){e=e||{};var t=this.gl;t.disable(t.CULL_FACE);var r=B;r.model=e.model||T;r.view=e.view||T;r.projection=e.projection||T;r.shape=this._field[2].shape;r.pickId=this.pickId/255;r.lowerBound=this.bounds[0];r.upperBound=this.bounds[1];r.objectOffset=this.objectOffset;r.permutation=R;for(var a=0;a<2;++a){var n=r.clipBounds[a];for(var i=0;i<3;++i){n[i]=Math.min(Math.max(this.clipBounds[a][i],-1e8),1e8)}}var o=O(r,this);if(o.showSurface){this._pickShader.bind();this._pickShader.uniforms=r;this._vao.bind();this._vao.draw(t.TRIANGLES,this._vertexCount);for(a=0;a<3;++a){if(!this.surfaceProject[a]){continue}this._pickShader.uniforms.model=o.projections[a];this._pickShader.uniforms.clipBounds=o.clipBounds[a];this._vao.draw(t.TRIANGLES,this._vertexCount)}this._vao.unbind()}if(o.showContour){var s=this._contourPickShader;s.bind();s.uniforms=r;var l=this._contourVAO;l.bind();for(i=0;i<3;++i){t.lineWidth(this.contourWidth[i]*this.pixelRatio);s.uniforms.permutation=M[i];for(a=0;a<this.contourLevels[i].length;++a){if(this._contourCounts[i][a]){s.uniforms.height=this.contourLevels[i][a];l.draw(t.LINES,this._contourCounts[i][a],this._contourOffsets[i][a])}}}for(a=0;a<3;++a){s.uniforms.model=o.projections[a];s.uniforms.clipBounds=o.clipBounds[a];for(i=0;i<3;++i){if(!this.contourProject[a][i]){continue}s.uniforms.permutation=M[i];t.lineWidth(this.contourWidth[i]*this.pixelRatio);for(var u=0;u<this.contourLevels[i].length;++u){if(this._contourCounts[i][u]){s.uniforms.height=this.contourLevels[i][u];l.draw(t.LINES,this._contourCounts[i][u],this._contourOffsets[i][u])}}}}l.unbind()}};L.pick=function(e){if(!e){return null}if(e.id!==this.pickId){return null}var t=this._field[2].shape;var r=this._pickResult;var a=t[0]*(e.value[0]+(e.value[2]>>4)/16)/255;var n=Math.floor(a);var i=a-n;var o=t[1]*(e.value[1]+(e.value[2]&15)/16)/255;var s=Math.floor(o);var l=o-s;n+=1;s+=1;var u=r.position;u[0]=u[1]=u[2]=0;for(var c=0;c<2;++c){var f=c?i:1-i;for(var h=0;h<2;++h){var p=h?l:1-l;var v=n+c;var m=s+h;var g=f*p;for(var y=0;y<3;++y){u[y]+=this._field[y].get(v,m)*g}}}var x=this._pickResult.level;for(var b=0;b<3;++b){x[b]=d.le(this.contourLevels[b],u[b]);if(x[b]<0){if(this.contourLevels[b].length>0){x[b]=0}}else if(x[b]<this.contourLevels[b].length-1){var _=this.contourLevels[b][x[b]];var w=this.contourLevels[b][x[b]+1];if(Math.abs(_-u[b])>Math.abs(w-u[b])){x[b]+=1}}}r.index[0]=i<.5?n:n+1;r.index[1]=l<.5?s:s+1;r.uv[0]=a/t[0];r.uv[1]=o/t[1];for(y=0;y<3;++y){r.dataCoordinate[y]=this._field[y].get(r.index[0],r.index[1])}return r};L.padField=function(e,t){var r=t.shape.slice();var a=e.shape.slice();u.assign(e.lo(1,1).hi(r[0],r[1]),t);u.assign(e.lo(1).hi(r[0],1),t.hi(r[0],1));u.assign(e.lo(1,a[1]-1).hi(r[0],1),t.lo(0,r[1]-1).hi(r[0],1));u.assign(e.lo(0,1).hi(1,r[1]),t.hi(1));u.assign(e.lo(a[0]-1,1).hi(1,r[1]),t.lo(r[0]-1));e.set(0,0,t.get(0,0));e.set(0,a[1]-1,t.get(0,r[1]-1));e.set(a[0]-1,0,t.get(r[0]-1,0));e.set(a[0]-1,a[1]-1,t.get(r[0]-1,r[1]-1))};function N(e,t){if(Array.isArray(e)){return[t(e[0]),t(e[1]),t(e[2])]}return[t(e),t(e),t(e)]}function j(e){if(Array.isArray(e)){if(e.length===3){return[e[0],e[1],e[2],1]}return[e[0],e[1],e[2],e[3]]}return[0,0,0,1]}function U(e){if(Array.isArray(e)){if(Array.isArray(e)){return[j(e[0]),j(e[1]),j(e[2])]}else{var t=j(e);return[t.slice(),t.slice(),t.slice()]}}}L.update=function(e){e=e||{};this.objectOffset=e.objectOffset||this.objectOffset;this.dirty=true;if("contourWidth"in e){this.contourWidth=N(e.contourWidth,Number)}if("showContour"in e){this.showContour=N(e.showContour,Boolean)}if("showSurface"in e){this.showSurface=!!e.showSurface}if("contourTint"in e){this.contourTint=N(e.contourTint,Boolean)}if("contourColor"in e){this.contourColor=U(e.contourColor)}if("contourProject"in e){this.contourProject=N(e.contourProject,(function(e){return N(e,Boolean)}))}if("surfaceProject"in e){this.surfaceProject=e.surfaceProject}if("dynamicColor"in e){this.dynamicColor=U(e.dynamicColor)}if("dynamicTint"in e){this.dynamicTint=N(e.dynamicTint,Number)}if("dynamicWidth"in e){this.dynamicWidth=N(e.dynamicWidth,Number)}if("opacity"in e){this.opacity=e.opacity}if("opacityscale"in e){this.opacityscale=e.opacityscale}if("colorBounds"in e){this.colorBounds=e.colorBounds}if("vertexColor"in e){this.vertexColor=e.vertexColor?1:0}if("colormap"in e){this._colorMap.setPixels(this.genColormap(e.colormap,this.opacityscale))}var t=e.field||e.coords&&e.coords[2]||null;var r=false;if(!t){if(this._field[2].shape[0]||this._field[2].shape[2]){t=this._field[2].lo(1,1).hi(this._field[2].shape[0]-2,this._field[2].shape[1]-2)}else{t=this._field[2].hi(0,0)}}if("field"in e||"coords"in e){var n=(t.shape[0]+2)*(t.shape[1]+2);if(n>this._field[2].data.length){s.freeFloat(this._field[2].data);this._field[2].data=s.mallocFloat(a.nextPow2(n))}this._field[2]=f(this._field[2].data,[t.shape[0]+2,t.shape[1]+2]);this.padField(this._field[2],t);this.shape=t.shape.slice();var i=this.shape;for(var o=0;o<2;++o){if(this._field[2].size>this._field[o].data.length){s.freeFloat(this._field[o].data);this._field[o].data=s.mallocFloat(this._field[2].size)}this._field[o]=f(this._field[o].data,[i[0]+2,i[1]+2])}if(e.coords){var l=e.coords;if(!Array.isArray(l)||l.length!==3){throw new Error("gl-surface: invalid coordinates for x/y")}for(o=0;o<2;++o){var u=l[o];for(g=0;g<2;++g){if(u.shape[g]!==i[g]){throw new Error("gl-surface: coords have incorrect shape")}}this.padField(this._field[o],u)}}else if(e.ticks){var c=e.ticks;if(!Array.isArray(c)||c.length!==2){throw new Error("gl-surface: invalid ticks")}for(o=0;o<2;++o){var p=c[o];if(Array.isArray(p)||p.length){p=f(p)}if(p.shape[0]!==i[o]){throw new Error("gl-surface: invalid tick length")}var v=f(p.data,i);v.stride[o]=p.stride[0];v.stride[o^1]=0;this.padField(this._field[o],v)}}else{for(o=0;o<2;++o){var d=[0,0];d[o]=1;this._field[o]=f(this._field[o].data,[i[0]+2,i[1]+2],d,0)}this._field[0].set(0,0,0);for(var g=0;g<i[0];++g){this._field[0].set(g+1,0,g)}this._field[0].set(i[0]+1,0,i[0]-1);this._field[1].set(0,0,0);for(g=0;g<i[1];++g){this._field[1].set(0,g+1,g)}this._field[1].set(0,i[1]+1,i[1]-1)}var y=this._field;var x=f(s.mallocFloat(y[2].size*3*2),[3,i[0]+2,i[1]+2,2]);for(o=0;o<3;++o){m(x.pick(o),y[o],"mirror")}var b=f(s.mallocFloat(y[2].size*3),[i[0]+2,i[1]+2,3]);for(o=0;o<i[0]+2;++o){for(g=0;g<i[1]+2;++g){var _=x.get(0,o,g,0);var w=x.get(0,o,g,1);var T=x.get(1,o,g,0);var M=x.get(1,o,g,1);var A=x.get(2,o,g,0);var S=x.get(2,o,g,1);var E=T*S-M*A;var L=A*w-S*_;var C=_*M-w*T;var I=Math.sqrt(E*E+L*L+C*C);if(I<1e-8){I=Math.max(Math.abs(E),Math.abs(L),Math.abs(C));if(I<1e-8){C=1;L=E=0;I=1}else{I=1/I}}else{I=1/Math.sqrt(I)}b.set(o,g,0,E*I);b.set(o,g,1,L*I);b.set(o,g,2,C*I)}}s.free(x.data);var P=[Infinity,Infinity,Infinity];var O=[-Infinity,-Infinity,-Infinity];var z=Infinity;var D=-Infinity;var R=(i[0]-1)*(i[1]-1)*6;var F=s.mallocFloat(a.nextPow2(10*R));var B=0;var j=0;for(o=0;o<i[0]-1;++o){e:for(g=0;g<i[1]-1;++g){for(var V=0;V<2;++V){for(var H=0;H<2;++H){for(var q=0;q<3;++q){var G=this._field[q].get(1+o+V,1+g+H);if(isNaN(G)||!isFinite(G)){continue e}}}}for(q=0;q<6;++q){var Y=o+k[q][0];var W=g+k[q][1];var X=this._field[0].get(Y+1,W+1);var Z=this._field[1].get(Y+1,W+1);G=this._field[2].get(Y+1,W+1);E=b.get(Y+1,W+1,0);L=b.get(Y+1,W+1,1);C=b.get(Y+1,W+1,2);if(e.intensity){J=e.intensity.get(Y,W)}var J=e.intensity?e.intensity.get(Y,W):G+this.objectOffset[2];F[B++]=Y;F[B++]=W;F[B++]=X;F[B++]=Z;F[B++]=G;F[B++]=0;F[B++]=J;F[B++]=E;F[B++]=L;F[B++]=C;P[0]=Math.min(P[0],X+this.objectOffset[0]);P[1]=Math.min(P[1],Z+this.objectOffset[1]);P[2]=Math.min(P[2],G+this.objectOffset[2]);z=Math.min(z,J);O[0]=Math.max(O[0],X+this.objectOffset[0]);O[1]=Math.max(O[1],Z+this.objectOffset[1]);O[2]=Math.max(O[2],G+this.objectOffset[2]);D=Math.max(D,J);j+=1}}}if(e.intensityBounds){z=+e.intensityBounds[0];D=+e.intensityBounds[1]}for(o=6;o<B;o+=10){F[o]=(F[o]-z)/(D-z)}this._vertexCount=j;this._coordinateBuffer.update(F.subarray(0,B));s.freeFloat(F);s.free(b.data);this.bounds=[P,O];this.intensity=e.intensity||this._field[2];if(this.intensityBounds[0]!==z||this.intensityBounds[1]!==D){r=true}this.intensityBounds=[z,D]}if("levels"in e){var K=e.levels;if(!Array.isArray(K[0])){K=[[],[],K]}else{K=K.slice()}for(o=0;o<3;++o){K[o]=K[o].slice();K[o].sort((function(e,t){return e-t}))}for(o=0;o<3;++o){for(g=0;g<K[o].length;++g){K[o][g]-=this.objectOffset[o]}}e:for(o=0;o<3;++o){if(K[o].length!==this.contourLevels[o].length){r=true;break}for(g=0;g<K[o].length;++g){if(K[o][g]!==this.contourLevels[o][g]){r=true;break e}}}this.contourLevels=K}if(r){y=this._field;i=this.shape;var Q=[];for(var $=0;$<3;++$){var ee=this.contourLevels[$];var te=[];var re=[];var ae=[0,0,0];for(o=0;o<ee.length;++o){var ne=h(this._field[$],ee[o]);te.push(Q.length/5|0);j=0;e:for(g=0;g<ne.cells.length;++g){var ie=ne.cells[g];for(q=0;q<2;++q){var oe=ne.positions[ie[q]];var se=oe[0];var le=Math.floor(se)|0;var ue=se-le;var ce=oe[1];var fe=Math.floor(ce)|0;var he=ce-fe;var pe=false;t:for(var ve=0;ve<3;++ve){ae[ve]=0;var de=($+ve+1)%3;for(V=0;V<2;++V){var me=V?ue:1-ue;Y=Math.min(Math.max(le+V,0),i[0])|0;for(H=0;H<2;++H){var ge=H?he:1-he;W=Math.min(Math.max(fe+H,0),i[1])|0;if(ve<2){G=this._field[de].get(Y,W)}else{G=(this.intensity.get(Y,W)-this.intensityBounds[0])/(this.intensityBounds[1]-this.intensityBounds[0])}if(!isFinite(G)||isNaN(G)){pe=true;break t}var ye=me*ge;ae[ve]+=ye*G}}}if(!pe){Q.push(ae[0],ae[1],oe[0],oe[1],ae[2]);j+=1}else{if(q>0){for(var xe=0;xe<5;++xe){Q.pop()}j-=1}continue e}}}re.push(j)}this._contourOffsets[$]=te;this._contourCounts[$]=re}var be=s.mallocFloat(Q.length);for(o=0;o<Q.length;++o){be[o]=Q[o]}this._contourBuffer.update(be);s.freeFloat(be)}};L.dispose=function(){this._shader.dispose();this._vao.dispose();this._coordinateBuffer.dispose();this._colorMap.dispose();this._contourBuffer.dispose();this._contourVAO.dispose();this._contourShader.dispose();this._contourPickShader.dispose();this._dynamicBuffer.dispose();this._dynamicVAO.dispose();for(var e=0;e<3;++e){s.freeFloat(this._field[e].data)}};L.highlight=function(e){var t;if(!e){this._dynamicCounts=[0,0,0];this.dyanamicLevel=[NaN,NaN,NaN];this.highlightLevel=[-1,-1,-1];return}for(t=0;t<3;++t){if(this.enableHighlight[t]){this.highlightLevel[t]=e.level[t]}else{this.highlightLevel[t]=-1}}var r;if(this.snapToData){r=e.dataCoordinate}else{r=e.position}for(t=0;t<3;++t){r[t]-=this.objectOffset[t]}if((!this.enableDynamic[0]||r[0]===this.dynamicLevel[0])&&(!this.enableDynamic[1]||r[1]===this.dynamicLevel[1])&&(!this.enableDynamic[2]||r[2]===this.dynamicLevel[2])){return}var a=0;var n=this.shape;var i=s.mallocFloat(12*n[0]*n[1]);for(var o=0;o<3;++o){if(!this.enableDynamic[o]){this.dynamicLevel[o]=NaN;this._dynamicCounts[o]=0;continue}this.dynamicLevel[o]=r[o];var l=(o+1)%3;var u=(o+2)%3;var c=this._field[o];var f=this._field[l];var p=this._field[u];var v=h(c,r[o]);var d=v.cells;var m=v.positions;this._dynamicOffsets[o]=a;for(t=0;t<d.length;++t){var g=d[t];for(var y=0;y<2;++y){var x=m[g[y]];var b=+x[0];var _=b|0;var w=Math.min(_+1,n[0])|0;var T=b-_;var k=1-T;var M=+x[1];var A=M|0;var S=Math.min(A+1,n[1])|0;var E=M-A;var L=1-E;var C=k*L;var I=k*E;var P=T*L;var O=T*E;var z=C*f.get(_,A)+I*f.get(_,S)+P*f.get(w,A)+O*f.get(w,S);var D=C*p.get(_,A)+I*p.get(_,S)+P*p.get(w,A)+O*p.get(w,S);if(isNaN(z)||isNaN(D)){if(y){a-=1}break}i[2*a+0]=z;i[2*a+1]=D;a+=1}}this._dynamicCounts[o]=a-this._dynamicOffsets[o]}this._dynamicBuffer.update(i.subarray(0,2*a));s.freeFloat(i)};function V(e){var t=e.gl;var r=y(t);var a=b(t);var s=x(t);var l=_(t);var u=n(t);var c=i(t,[{buffer:u,size:4,stride:w,offset:0},{buffer:u,size:3,stride:w,offset:16},{buffer:u,size:3,stride:w,offset:28}]);var f=n(t);var h=i(t,[{buffer:f,size:4,stride:20,offset:0},{buffer:f,size:1,stride:20,offset:16}]);var p=n(t);var v=i(t,[{buffer:p,size:2,type:t.FLOAT}]);var d=o(t,1,S,t.RGBA,t.UNSIGNED_BYTE);d.minFilter=t.LINEAR;d.magFilter=t.LINEAR;var m=new E(t,[0,0],[[0,0,0],[0,0,0]],r,a,u,c,d,s,l,f,h,p,v,[0,0,0]);var g={levels:[[],[],[]]};for(var T in e){g[T]=e[T]}g.colormap=g.colormap||"jet";m.update(g);return m}},{"./lib/shaders":345,"binary-search-bounds":103,"bit-twiddle":104,colormap:137,"gl-buffer":261,"gl-mat4/invert":293,"gl-mat4/multiply":295,"gl-texture2d":348,"gl-vao":353,ndarray:472,"ndarray-gradient":465,"ndarray-ops":467,"ndarray-pack":468,"surface-nets":576,"typedarray-pool":601}],347:[function(e,t,r){"use strict";var a=e("css-font");var n=e("pick-by-alias");var i=e("regl");var o=e("gl-util/context");var s=e("es6-weak-map");var l=e("color-normalize");var u=e("font-atlas");var c=e("typedarray-pool");var f=e("parse-rect");var h=e("is-plain-obj");var p=e("parse-unit");var v=e("to-px");var d=e("detect-kerning");var m=e("object-assign");var g=e("font-measure");var y=e("flatten-vertex-data");var x=e("bit-twiddle");var b=x.nextPow2;var _=new s;var w=false;if(document.body){var T=document.body.appendChild(document.createElement("div"));T.style.font="italic small-caps bold condensed 16px/2 cursive";if(getComputedStyle(T).fontStretch){w=true}document.body.removeChild(T)}var k=function e(t){if(M(t)){t={regl:t};this.gl=t.regl._gl}else{this.gl=o(t)}this.shader=_.get(this.gl);if(!this.shader){this.regl=t.regl||i({gl:this.gl})}else{this.regl=this.shader.regl}this.charBuffer=this.regl.buffer({type:"uint8",usage:"stream"});this.sizeBuffer=this.regl.buffer({type:"float",usage:"stream"});if(!this.shader){this.shader=this.createShader();_.set(this.gl,this.shader)}this.batch=[];this.fontSize=[];this.font=[];this.fontAtlas=[];this.draw=this.shader.draw.bind(this);this.render=function(){this.regl._refresh();this.draw(this.batch)};this.canvas=this.gl.canvas;this.update(h(t)?t:{})};k.prototype.createShader=function e(){var t=this.regl;var r=t({blend:{enable:true,color:[0,0,0,1],func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},stencil:{enable:false},depth:{enable:false},count:t.prop("count"),offset:t.prop("offset"),attributes:{charOffset:{offset:4,stride:8,buffer:t.this("sizeBuffer")},width:{offset:0,stride:8,buffer:t.this("sizeBuffer")},char:t.this("charBuffer"),position:t.this("position")},uniforms:{atlasSize:function(e,t){return[t.atlas.width,t.atlas.height]},atlasDim:function(e,t){return[t.atlas.cols,t.atlas.rows]},atlas:function(e,t){return t.atlas.texture},charStep:function(e,t){return t.atlas.step},em:function(e,t){return t.atlas.em},color:t.prop("color"),opacity:t.prop("opacity"),viewport:t.this("viewportArray"),scale:t.this("scale"),align:t.prop("align"),baseline:t.prop("baseline"),translate:t.this("translate"),positionOffset:t.prop("positionOffset")},primitive:"points",viewport:t.this("viewport"),vert:"\n\t\t\tprecision highp float;\n\t\t\tattribute float width, charOffset, char;\n\t\t\tattribute vec2 position;\n\t\t\tuniform float fontSize, charStep, em, align, baseline;\n\t\t\tuniform vec4 viewport;\n\t\t\tuniform vec4 color;\n\t\t\tuniform vec2 atlasSize, atlasDim, scale, translate, positionOffset;\n\t\t\tvarying vec2 charCoord, charId;\n\t\t\tvarying float charWidth;\n\t\t\tvarying vec4 fontColor;\n\t\t\tvoid main () {\n\t\t\t\tvec2 offset = floor(em * (vec2(align + charOffset, baseline)\n\t\t\t\t\t+ vec2(positionOffset.x, -positionOffset.y)))\n\t\t\t\t\t/ (viewport.zw * scale.xy);\n\n\t\t\t\tvec2 position = (position + translate) * scale;\n\t\t\t\tposition += offset * scale;\n\n\t\t\t\tcharCoord = position * viewport.zw + viewport.xy;\n\n\t\t\t\tgl_Position = vec4(position * 2. - 1., 0, 1);\n\n\t\t\t\tgl_PointSize = charStep;\n\n\t\t\t\tcharId.x = mod(char, atlasDim.x);\n\t\t\t\tcharId.y = floor(char / atlasDim.x);\n\n\t\t\t\tcharWidth = width * em;\n\n\t\t\t\tfontColor = color / 255.;\n\t\t\t}",frag:"\n\t\t\tprecision highp float;\n\t\t\tuniform float fontSize, charStep, opacity;\n\t\t\tuniform vec2 atlasSize;\n\t\t\tuniform vec4 viewport;\n\t\t\tuniform sampler2D atlas;\n\t\t\tvarying vec4 fontColor;\n\t\t\tvarying vec2 charCoord, charId;\n\t\t\tvarying float charWidth;\n\n\t\t\tfloat lightness(vec4 color) {\n\t\t\t\treturn color.r * 0.299 + color.g * 0.587 + color.b * 0.114;\n\t\t\t}\n\n\t\t\tvoid main () {\n\t\t\t\tvec2 uv = gl_FragCoord.xy - charCoord + charStep * .5;\n\t\t\t\tfloat halfCharStep = floor(charStep * .5 + .5);\n\n\t\t\t\t// invert y and shift by 1px (FF expecially needs that)\n\t\t\t\tuv.y = charStep - uv.y;\n\n\t\t\t\t// ignore points outside of character bounding box\n\t\t\t\tfloat halfCharWidth = ceil(charWidth * .5);\n\t\t\t\tif (floor(uv.x) > halfCharStep + halfCharWidth ||\n\t\t\t\t\tfloor(uv.x) < halfCharStep - halfCharWidth) return;\n\n\t\t\t\tuv += charId * charStep;\n\t\t\t\tuv = uv / atlasSize;\n\n\t\t\t\tvec4 color = fontColor;\n\t\t\t\tvec4 mask = texture2D(atlas, uv);\n\n\t\t\t\tfloat maskY = lightness(mask);\n\t\t\t\t// float colorY = lightness(color);\n\t\t\t\tcolor.a *= maskY;\n\t\t\t\tcolor.a *= opacity;\n\n\t\t\t\t// color.a += .1;\n\n\t\t\t\t// antialiasing, see yiq color space y-channel formula\n\t\t\t\t// color.rgb += (1. - color.rgb) * (1. - mask.rgb);\n\n\t\t\t\tgl_FragColor = color;\n\t\t\t}"});var a={};return{regl:t,draw:r,atlas:a}};k.prototype.update=function e(t){var r=this;if(typeof t==="string"){t={text:t}}else if(!t){return}t=n(t,{position:"position positions coord coords coordinates",font:"font fontFace fontface typeface cssFont css-font family fontFamily",fontSize:"fontSize fontsize size font-size",text:"text texts chars characters value values symbols",align:"align alignment textAlign textbaseline",baseline:"baseline textBaseline textbaseline",direction:"dir direction textDirection",color:"color colour fill fill-color fillColor textColor textcolor",kerning:"kerning kern",range:"range dataBox",viewport:"vp viewport viewBox viewbox viewPort",opacity:"opacity alpha transparency visible visibility opaque",offset:"offset positionOffset padding shift indent indentation"},true);if(t.opacity!=null){if(Array.isArray(t.opacity)){this.opacity=t.opacity.map((function(e){return parseFloat(e)}))}else{this.opacity=parseFloat(t.opacity)}}if(t.viewport!=null){this.viewport=f(t.viewport);this.viewportArray=[this.viewport.x,this.viewport.y,this.viewport.width,this.viewport.height]}if(this.viewport==null){this.viewport={x:0,y:0,width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight};this.viewportArray=[this.viewport.x,this.viewport.y,this.viewport.width,this.viewport.height]}if(t.kerning!=null){this.kerning=t.kerning}if(t.offset!=null){if(typeof t.offset==="number"){t.offset=[t.offset,0]}this.positionOffset=y(t.offset)}if(t.direction){this.direction=t.direction}if(t.range){this.range=t.range;this.scale=[1/(t.range[2]-t.range[0]),1/(t.range[3]-t.range[1])];this.translate=[-t.range[0],-t.range[1]]}if(t.scale){this.scale=t.scale}if(t.translate){this.translate=t.translate}if(!this.scale){this.scale=[1/this.viewport.width,1/this.viewport.height]}if(!this.translate){this.translate=[0,0]}if(!this.font.length&&!t.font){t.font=k.baseFontSize+"px sans-serif"}var i=false,o=false;if(t.font){(Array.isArray(t.font)?t.font:[t.font]).forEach((function(e,t){if(typeof e==="string"){try{e=a.parse(e)}catch(f){e=a.parse(k.baseFontSize+"px "+e)}}else{e=a.parse(a.stringify(e))}var n=a.stringify({size:k.baseFontSize,family:e.family,stretch:w?e.stretch:undefined,variant:e.variant,weight:e.weight,style:e.style});var s=p(e.size);var l=Math.round(s[0]*v(s[1]));if(l!==r.fontSize[t]){o=true;r.fontSize[t]=l}if(!r.font[t]||n!=r.font[t].baseString){i=true;r.font[t]=k.fonts[n];if(!r.font[t]){var u=e.family.join(", ");var c=[e.style];if(e.style!=e.variant){c.push(e.variant)}if(e.variant!=e.weight){c.push(e.weight)}if(w&&e.weight!=e.stretch){c.push(e.stretch)}r.font[t]={baseString:n,family:u,weight:e.weight,stretch:e.stretch,style:e.style,variant:e.variant,width:{},kerning:{},metrics:g(u,{origin:"top",fontSize:k.baseFontSize,fontStyle:c.join(" ")})};k.fonts[n]=r.font[t]}}}))}if(i||o){this.font.forEach((function(e,n){var i=a.stringify({size:r.fontSize[n],family:e.family,stretch:w?e.stretch:undefined,variant:e.variant,weight:e.weight,style:e.style});r.fontAtlas[n]=r.shader.atlas[i];if(!r.fontAtlas[n]){var o=e.metrics;r.shader.atlas[i]=r.fontAtlas[n]={fontString:i,step:Math.ceil(r.fontSize[n]*o.bottom*.5)*2,em:r.fontSize[n],cols:0,rows:0,height:0,width:0,chars:[],ids:{},texture:r.regl.texture()}}if(t.text==null){t.text=r.text}}))}if(typeof t.text==="string"&&t.position&&t.position.length>2){var s=Array(t.position.length*.5);for(var h=0;h<s.length;h++){s[h]=t.text}t.text=s}var x;if(t.text!=null||i){this.textOffsets=[0];if(Array.isArray(t.text)){this.count=t.text[0].length;this.counts=[this.count];for(var _=1;_<t.text.length;_++){this.textOffsets[_]=this.textOffsets[_-1]+t.text[_-1].length;this.count+=t.text[_].length;this.counts.push(t.text[_].length)}this.text=t.text.join("")}else{this.text=t.text;this.count=this.text.length;this.counts=[this.count]}x=[];this.font.forEach((function(e,t){k.atlasContext.font=e.baseString;var a=r.fontAtlas[t];for(var n=0;n<r.text.length;n++){var i=r.text.charAt(n);if(a.ids[i]==null){a.ids[i]=a.chars.length;a.chars.push(i);x.push(i)}if(e.width[i]==null){e.width[i]=k.atlasContext.measureText(i).width/k.baseFontSize;if(r.kerning){var o=[];for(var s in e.width){o.push(s+i,i+s)}m(e.kerning,d(e.family,{pairs:o}))}}}}))}if(t.position){if(t.position.length>2){var T=!t.position[0].length;var M=c.mallocFloat(this.count*2);for(var A=0,S=0;A<this.counts.length;A++){var E=this.counts[A];if(T){for(var L=0;L<E;L++){M[S++]=t.position[A*2];M[S++]=t.position[A*2+1]}}else{for(var C=0;C<E;C++){M[S++]=t.position[A][0];M[S++]=t.position[A][1]}}}if(this.position.call){this.position({type:"float",data:M})}else{this.position=this.regl.buffer({type:"float",data:M})}c.freeFloat(M)}else{if(this.position.destroy){this.position.destroy()}this.position={constant:t.position}}}if(t.text||i){var I=c.mallocUint8(this.count);var P=c.mallocFloat(this.count*2);this.textWidth=[];for(var O=0,z=0;O<this.counts.length;O++){var D=this.counts[O];var R=this.font[O]||this.font[0];var F=this.fontAtlas[O]||this.fontAtlas[0];for(var B=0;B<D;B++){var N=this.text.charAt(z);var j=this.text.charAt(z-1);I[z]=F.ids[N];P[z*2]=R.width[N];if(B){var U=P[z*2-2];var V=P[z*2];var H=P[z*2-1];var q=H+U*.5+V*.5;if(this.kerning){var G=R.kerning[j+N];if(G){q+=G*.001}}P[z*2+1]=q}else{P[z*2+1]=P[z*2]*.5}z++}this.textWidth.push(!P.length?0:P[z*2-2]*.5+P[z*2-1])}if(!t.align){t.align=this.align}this.charBuffer({data:I,type:"uint8",usage:"stream"});this.sizeBuffer({data:P,type:"float",usage:"stream"});c.freeUint8(I);c.freeFloat(P);if(x.length){this.font.forEach((function(e,t){var a=r.fontAtlas[t];var n=a.step;var i=Math.floor(k.maxAtlasSize/n);var o=Math.min(i,a.chars.length);var s=Math.ceil(a.chars.length/o);var l=b(o*n);var c=b(s*n);a.width=l;a.height=c;a.rows=s;a.cols=o;if(!a.em){return}a.texture({data:u({canvas:k.atlasCanvas,font:a.fontString,chars:a.chars,shape:[l,c],step:[n,n]})})}))}}if(t.align){this.align=t.align;this.alignOffset=this.textWidth.map((function(e,t){var a=!Array.isArray(r.align)?r.align:r.align.length>1?r.align[t]:r.align[0];if(typeof a==="number"){return a}switch(a){case"right":case"end":return-e;case"center":case"centre":case"middle":return-e*.5}return 0}))}if(this.baseline==null&&t.baseline==null){t.baseline=0}if(t.baseline!=null){this.baseline=t.baseline;if(!Array.isArray(this.baseline)){this.baseline=[this.baseline]}this.baselineOffset=this.baseline.map((function(e,t){var a=(r.font[t]||r.font[0]).metrics;var n=0;n+=a.bottom*.5;if(typeof e==="number"){n+=e-a.baseline}else{n+=-a[e]}n*=-1;return n}))}if(t.color!=null){if(!t.color){t.color="transparent"}if(typeof t.color==="string"||!isNaN(t.color)){this.color=l(t.color,"uint8")}else{var Y;if(typeof t.color[0]==="number"&&t.color.length>this.counts.length){var W=t.color.length;Y=c.mallocUint8(W);var X=(t.color.subarray||t.color.slice).bind(t.color);for(var Z=0;Z<W;Z+=4){Y.set(l(X(Z,Z+4),"uint8"),Z)}}else{var J=t.color.length;Y=c.mallocUint8(J*4);for(var K=0;K<J;K++){Y.set(l(t.color[K]||0,"uint8"),K*4)}}this.color=Y}}if(t.position||t.text||t.color||t.baseline||t.align||t.font||t.offset||t.opacity){var Q=this.color.length>4||this.baselineOffset.length>1||this.align&&this.align.length>1||this.fontAtlas.length>1||this.positionOffset.length>2;if(Q){var $=Math.max(this.position.length*.5||0,this.color.length*.25||0,this.baselineOffset.length||0,this.alignOffset.length||0,this.font.length||0,this.opacity.length||0,this.positionOffset.length*.5||0);this.batch=Array($);for(var ee=0;ee<this.batch.length;ee++){this.batch[ee]={count:this.counts.length>1?this.counts[ee]:this.counts[0],offset:this.textOffsets.length>1?this.textOffsets[ee]:this.textOffsets[0],color:!this.color?[0,0,0,255]:this.color.length<=4?this.color:this.color.subarray(ee*4,ee*4+4),opacity:Array.isArray(this.opacity)?this.opacity[ee]:this.opacity,baseline:this.baselineOffset[ee]!=null?this.baselineOffset[ee]:this.baselineOffset[0],align:!this.align?0:this.alignOffset[ee]!=null?this.alignOffset[ee]:this.alignOffset[0],atlas:this.fontAtlas[ee]||this.fontAtlas[0],positionOffset:this.positionOffset.length>2?this.positionOffset.subarray(ee*2,ee*2+2):this.positionOffset}}}else{if(this.count){this.batch=[{count:this.count,offset:0,color:this.color||[0,0,0,255],opacity:Array.isArray(this.opacity)?this.opacity[0]:this.opacity,baseline:this.baselineOffset[0],align:this.alignOffset?this.alignOffset[0]:0,atlas:this.fontAtlas[0],positionOffset:this.positionOffset}]}else{this.batch=[]}}}};k.prototype.destroy=function e(){};k.prototype.kerning=true;k.prototype.position={constant:new Float32Array(2)};k.prototype.translate=null;k.prototype.scale=null;k.prototype.font=null;k.prototype.text="";k.prototype.positionOffset=[0,0];k.prototype.opacity=1;k.prototype.color=new Uint8Array([0,0,0,255]);k.prototype.alignOffset=[0,0];k.maxAtlasSize=1024;k.atlasCanvas=document.createElement("canvas");k.atlasContext=k.atlasCanvas.getContext("2d",{alpha:false});k.baseFontSize=64;k.fonts={};function M(e){return typeof e==="function"&&e._gl&&e.prop&&e.texture&&e.buffer}t.exports=k},{"bit-twiddle":104,"color-normalize":131,"css-font":150,"detect-kerning":178,"es6-weak-map":238,"flatten-vertex-data":248,"font-atlas":249,"font-measure":250,"gl-util/context":349,"is-plain-obj":447,"object-assign":476,"parse-rect":481,"parse-unit":483,"pick-by-alias":485,regl:526,"to-px":585,"typedarray-pool":601}],348:[function(e,t,r){"use strict";var a=e("ndarray");var n=e("ndarray-ops");var i=e("typedarray-pool");t.exports=_;var o=null;var s=null;var l=null;function u(e){o=[e.LINEAR,e.NEAREST_MIPMAP_LINEAR,e.LINEAR_MIPMAP_NEAREST,e.LINEAR_MIPMAP_NEAREST];s=[e.NEAREST,e.LINEAR,e.NEAREST_MIPMAP_NEAREST,e.NEAREST_MIPMAP_LINEAR,e.LINEAR_MIPMAP_NEAREST,e.LINEAR_MIPMAP_LINEAR];l=[e.REPEAT,e.CLAMP_TO_EDGE,e.MIRRORED_REPEAT]}function c(e){return"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLVideoElement&&e instanceof HTMLVideoElement||"undefined"!=typeof ImageData&&e instanceof ImageData}var f=function(e,t){n.muls(e,t,255)};function h(e,t,r){var a=e.gl;var n=a.getParameter(a.MAX_TEXTURE_SIZE);if(t<0||t>n||r<0||r>n){throw new Error("gl-texture2d: Invalid texture size")}e._shape=[t,r];e.bind();a.texImage2D(a.TEXTURE_2D,0,e.format,t,r,0,e.format,e.type,null);e._mipLevels=[0];return e}function p(e,t,r,a,n,i){this.gl=e;this.handle=t;this.format=n;this.type=i;this._shape=[r,a];this._mipLevels=[0];this._magFilter=e.NEAREST;this._minFilter=e.NEAREST;this._wrapS=e.CLAMP_TO_EDGE;this._wrapT=e.CLAMP_TO_EDGE;this._anisoSamples=1;var o=this;var s=[this._wrapS,this._wrapT];Object.defineProperties(s,[{get:function(){return o._wrapS},set:function(e){return o.wrapS=e}},{get:function(){return o._wrapT},set:function(e){return o.wrapT=e}}]);this._wrapVector=s;var l=[this._shape[0],this._shape[1]];Object.defineProperties(l,[{get:function(){return o._shape[0]},set:function(e){return o.width=e}},{get:function(){return o._shape[1]},set:function(e){return o.height=e}}]);this._shapeVector=l}var v=p.prototype;Object.defineProperties(v,{minFilter:{get:function(){return this._minFilter},set:function(e){this.bind();var t=this.gl;if(this.type===t.FLOAT&&o.indexOf(e)>=0){if(!t.getExtension("OES_texture_float_linear")){e=t.NEAREST}}if(s.indexOf(e)<0){throw new Error("gl-texture2d: Unknown filter mode "+e)}t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,e);return this._minFilter=e}},magFilter:{get:function(){return this._magFilter},set:function(e){this.bind();var t=this.gl;if(this.type===t.FLOAT&&o.indexOf(e)>=0){if(!t.getExtension("OES_texture_float_linear")){e=t.NEAREST}}if(s.indexOf(e)<0){throw new Error("gl-texture2d: Unknown filter mode "+e)}t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,e);return this._magFilter=e}},mipSamples:{get:function(){return this._anisoSamples},set:function(e){var t=this._anisoSamples;this._anisoSamples=Math.max(e,1)|0;if(t!==this._anisoSamples){var r=this.gl.getExtension("EXT_texture_filter_anisotropic");if(r){this.gl.texParameterf(this.gl.TEXTURE_2D,r.TEXTURE_MAX_ANISOTROPY_EXT,this._anisoSamples)}}return this._anisoSamples}},wrapS:{get:function(){return this._wrapS},set:function(e){this.bind();if(l.indexOf(e)<0){throw new Error("gl-texture2d: Unknown wrap mode "+e)}this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,e);return this._wrapS=e}},wrapT:{get:function(){return this._wrapT},set:function(e){this.bind();if(l.indexOf(e)<0){throw new Error("gl-texture2d: Unknown wrap mode "+e)}this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,e);return this._wrapT=e}},wrap:{get:function(){return this._wrapVector},set:function(e){if(!Array.isArray(e)){e=[e,e]}if(e.length!==2){throw new Error("gl-texture2d: Must specify wrap mode for rows and columns")}for(var t=0;t<2;++t){if(l.indexOf(e[t])<0){throw new Error("gl-texture2d: Unknown wrap mode "+e)}}this._wrapS=e[0];this._wrapT=e[1];var r=this.gl;this.bind();r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,this._wrapS);r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,this._wrapT);return e}},shape:{get:function(){return this._shapeVector},set:function(e){if(!Array.isArray(e)){e=[e|0,e|0]}else{if(e.length!==2){throw new Error("gl-texture2d: Invalid texture shape")}}h(this,e[0]|0,e[1]|0);return[e[0]|0,e[1]|0]}},width:{get:function(){return this._shape[0]},set:function(e){e=e|0;h(this,e,this._shape[1]);return e}},height:{get:function(){return this._shape[1]},set:function(e){e=e|0;h(this,this._shape[0],e);return e}}});v.bind=function(e){var t=this.gl;if(e!==undefined){t.activeTexture(t.TEXTURE0+(e|0))}t.bindTexture(t.TEXTURE_2D,this.handle);if(e!==undefined){return e|0}return t.getParameter(t.ACTIVE_TEXTURE)-t.TEXTURE0};v.dispose=function(){this.gl.deleteTexture(this.handle)};v.generateMipmap=function(){this.bind();this.gl.generateMipmap(this.gl.TEXTURE_2D);var e=Math.min(this._shape[0],this._shape[1]);for(var t=0;e>0;++t,e>>>=1){if(this._mipLevels.indexOf(t)<0){this._mipLevels.push(t)}}};v.setPixels=function(e,t,r,a){var n=this.gl;this.bind();if(Array.isArray(t)){a=r;r=t[1]|0;t=t[0]|0}else{t=t||0;r=r||0}a=a||0;var i=c(e)?e:e.raw;if(i){var o=this._mipLevels.indexOf(a)<0;if(o){n.texImage2D(n.TEXTURE_2D,0,this.format,this.format,this.type,i);this._mipLevels.push(a)}else{n.texSubImage2D(n.TEXTURE_2D,a,t,r,this.format,this.type,i)}}else if(e.shape&&e.stride&&e.data){if(e.shape.length<2||t+e.shape[1]>this._shape[1]>>>a||r+e.shape[0]>this._shape[0]>>>a||t<0||r<0){throw new Error("gl-texture2d: Texture dimensions are out of bounds")}m(n,t,r,a,this.format,this.type,this._mipLevels,e)}else{throw new Error("gl-texture2d: Unsupported data type")}};function d(e,t){if(e.length===3){return t[2]===1&&t[1]===e[0]*e[2]&&t[0]===e[2]}return t[0]===1&&t[1]===e[0]}function m(e,t,r,o,s,l,u,c){var h=c.dtype;var p=c.shape.slice();if(p.length<2||p.length>3){throw new Error("gl-texture2d: Invalid ndarray, must be 2d or 3d")}var v=0,m=0;var g=d(p,c.stride.slice());if(h==="float32"){v=e.FLOAT}else if(h==="float64"){v=e.FLOAT;g=false;h="float32"}else if(h==="uint8"){v=e.UNSIGNED_BYTE}else{v=e.UNSIGNED_BYTE;g=false;h="uint8"}var y=1;if(p.length===2){m=e.LUMINANCE;p=[p[0],p[1],1];c=a(c.data,p,[c.stride[0],c.stride[1],1],c.offset)}else if(p.length===3){if(p[2]===1){m=e.ALPHA}else if(p[2]===2){m=e.LUMINANCE_ALPHA}else if(p[2]===3){m=e.RGB}else if(p[2]===4){m=e.RGBA}else{throw new Error("gl-texture2d: Invalid shape for pixel coords")}y=p[2]}else{throw new Error("gl-texture2d: Invalid shape for texture")}if((m===e.LUMINANCE||m===e.ALPHA)&&(s===e.LUMINANCE||s===e.ALPHA)){m=s}if(m!==s){throw new Error("gl-texture2d: Incompatible texture format for setPixels")}var x=c.size;var b=u.indexOf(o)<0;if(b){u.push(o)}if(v===l&&g){if(c.offset===0&&c.data.length===x){if(b){e.texImage2D(e.TEXTURE_2D,o,s,p[0],p[1],0,s,l,c.data)}else{e.texSubImage2D(e.TEXTURE_2D,o,t,r,p[0],p[1],s,l,c.data)}}else{if(b){e.texImage2D(e.TEXTURE_2D,o,s,p[0],p[1],0,s,l,c.data.subarray(c.offset,c.offset+x))}else{e.texSubImage2D(e.TEXTURE_2D,o,t,r,p[0],p[1],s,l,c.data.subarray(c.offset,c.offset+x))}}}else{var _;if(l===e.FLOAT){_=i.mallocFloat32(x)}else{_=i.mallocUint8(x)}var w=a(_,p,[p[2],p[2]*p[0],1]);if(v===e.FLOAT&&l===e.UNSIGNED_BYTE){f(w,c)}else{n.assign(w,c)}if(b){e.texImage2D(e.TEXTURE_2D,o,s,p[0],p[1],0,s,l,_.subarray(0,x))}else{e.texSubImage2D(e.TEXTURE_2D,o,t,r,p[0],p[1],s,l,_.subarray(0,x))}if(l===e.FLOAT){i.freeFloat32(_)}else{i.freeUint8(_)}}}function g(e){var t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE);return t}function y(e,t,r,a,n){var i=e.getParameter(e.MAX_TEXTURE_SIZE);if(t<0||t>i||r<0||r>i){throw new Error("gl-texture2d: Invalid texture shape")}if(n===e.FLOAT&&!e.getExtension("OES_texture_float")){throw new Error("gl-texture2d: Floating point textures not supported on this platform")}var o=g(e);e.texImage2D(e.TEXTURE_2D,0,a,t,r,0,a,n,null);return new p(e,o,t,r,a,n)}function x(e,t,r,a,n,i){var o=g(e);e.texImage2D(e.TEXTURE_2D,0,n,n,i,t);return new p(e,o,r,a,n,i)}function b(e,t){var r=t.dtype;var o=t.shape.slice();var s=e.getParameter(e.MAX_TEXTURE_SIZE);if(o[0]<0||o[0]>s||o[1]<0||o[1]>s){throw new Error("gl-texture2d: Invalid texture size")}var l=d(o,t.stride.slice());var u=0;if(r==="float32"){u=e.FLOAT}else if(r==="float64"){u=e.FLOAT;l=false;r="float32"}else if(r==="uint8"){u=e.UNSIGNED_BYTE}else{u=e.UNSIGNED_BYTE;l=false;r="uint8"}var c=0;if(o.length===2){c=e.LUMINANCE;o=[o[0],o[1],1];t=a(t.data,o,[t.stride[0],t.stride[1],1],t.offset)}else if(o.length===3){if(o[2]===1){c=e.ALPHA}else if(o[2]===2){c=e.LUMINANCE_ALPHA}else if(o[2]===3){c=e.RGB}else if(o[2]===4){c=e.RGBA}else{throw new Error("gl-texture2d: Invalid shape for pixel coords")}}else{throw new Error("gl-texture2d: Invalid shape for texture")}if(u===e.FLOAT&&!e.getExtension("OES_texture_float")){u=e.UNSIGNED_BYTE;l=false}var h,v;var m=t.size;if(!l){var y=[o[2],o[2]*o[0],1];v=i.malloc(m,r);var x=a(v,o,y,0);if((r==="float32"||r==="float64")&&u===e.UNSIGNED_BYTE){f(x,t)}else{n.assign(x,t)}h=v.subarray(0,m)}else if(t.offset===0&&t.data.length===m){h=t.data}else{h=t.data.subarray(t.offset,t.offset+m)}var b=g(e);e.texImage2D(e.TEXTURE_2D,0,c,o[0],o[1],0,c,u,h);if(!l){i.free(v)}return new p(e,b,o[0],o[1],c,u)}function _(e){if(arguments.length<=1){throw new Error("gl-texture2d: Missing arguments for texture2d constructor")}if(!o){u(e)}if(typeof arguments[1]==="number"){return y(e,arguments[1],arguments[2],arguments[3]||e.RGBA,arguments[4]||e.UNSIGNED_BYTE)}if(Array.isArray(arguments[1])){return y(e,arguments[1][0]|0,arguments[1][1]|0,arguments[2]||e.RGBA,arguments[3]||e.UNSIGNED_BYTE)}if(typeof arguments[1]==="object"){var t=arguments[1];var r=c(t)?t:t.raw;if(r){return x(e,r,t.width|0,t.height|0,arguments[2]||e.RGBA,arguments[3]||e.UNSIGNED_BYTE)}else if(t.shape&&t.data&&t.stride){return b(e,t)}}throw new Error("gl-texture2d: Invalid arguments for texture2d constructor")}},{ndarray:472,"ndarray-ops":467,"typedarray-pool":601}],349:[function(e,r,a){(function(t){(function(){"use strict";var a=e("pick-by-alias");r.exports=function e(r){if(!r)r={};else if(typeof r==="string")r={container:r};if(i(r)){r={container:r}}else if(o(r)){r={container:r}}else if(s(r)){r={gl:r}}else{r=a(r,{container:"container target element el canvas holder parent parentNode wrapper use ref root node",gl:"gl context webgl glContext",attrs:"attributes attrs contextAttributes",pixelRatio:"pixelRatio pxRatio px ratio pxratio pixelratio",width:"w width",height:"h height"},true)}if(!r.pixelRatio)r.pixelRatio=t.pixelRatio||1;if(r.gl){return r.gl}if(r.canvas){r.container=r.canvas.parentNode}if(r.container){if(typeof r.container==="string"){var u=document.querySelector(r.container);if(!u)throw Error("Element "+r.container+" is not found");r.container=u}if(i(r.container)){r.canvas=r.container;r.container=r.canvas.parentNode}else if(!r.canvas){r.canvas=l();r.container.appendChild(r.canvas);n(r)}}else if(!r.canvas){if(typeof document!=="undefined"){r.container=document.body||document.documentElement;r.canvas=l();r.container.appendChild(r.canvas);n(r)}else{throw Error("Not DOM environment. Use headless-gl.")}}if(!r.gl){["webgl","experimental-webgl","webgl-experimental"].some((function(e){try{r.gl=r.canvas.getContext(e,r.attrs)}catch(t){}return r.gl}))}return r.gl};function n(e){if(e.container){if(e.container==document.body){if(!document.body.style.width)e.canvas.width=e.width||e.pixelRatio*t.innerWidth;if(!document.body.style.height)e.canvas.height=e.height||e.pixelRatio*t.innerHeight}else{var r=e.container.getBoundingClientRect();e.canvas.width=e.width||r.right-r.left;e.canvas.height=e.height||r.bottom-r.top}}}function i(e){return typeof e.getContext==="function"&&"width"in e&&"height"in e}function o(e){return typeof e.nodeName==="string"&&typeof e.appendChild==="function"&&typeof e.getBoundingClientRect==="function"}function s(e){return typeof e.drawArrays==="function"||typeof e.drawElements==="function"}function l(){var e=document.createElement("canvas");e.style.position="absolute";e.style.top=0;e.style.left=0;return e}}).call(this)}).call(this,typeof t!=="undefined"?t:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"pick-by-alias":485}],350:[function(e,t,r){"use strict";function a(e,t,r){if(t){t.bind()}else{e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)}var a=e.getParameter(e.MAX_VERTEX_ATTRIBS)|0;if(r){if(r.length>a){throw new Error("gl-vao: Too many vertex attributes")}for(var n=0;n<r.length;++n){var i=r[n];if(i.buffer){var o=i.buffer;var s=i.size||4;var l=i.type||e.FLOAT;var u=!!i.normalized;var c=i.stride||0;var f=i.offset||0;o.bind();e.enableVertexAttribArray(n);e.vertexAttribPointer(n,s,l,u,c,f)}else{if(typeof i==="number"){e.vertexAttrib1f(n,i)}else if(i.length===1){e.vertexAttrib1f(n,i[0])}else if(i.length===2){e.vertexAttrib2f(n,i[0],i[1])}else if(i.length===3){e.vertexAttrib3f(n,i[0],i[1],i[2])}else if(i.length===4){e.vertexAttrib4f(n,i[0],i[1],i[2],i[3])}else{throw new Error("gl-vao: Invalid vertex attribute")}e.disableVertexAttribArray(n)}}for(;n<a;++n){e.disableVertexAttribArray(n)}}else{e.bindBuffer(e.ARRAY_BUFFER,null);for(var n=0;n<a;++n){e.disableVertexAttribArray(n)}}}t.exports=a},{}],351:[function(e,t,r){"use strict";var a=e("./do-bind.js");function n(e){this.gl=e;this._elements=null;this._attributes=null;this._elementsType=e.UNSIGNED_SHORT}n.prototype.bind=function(){a(this.gl,this._elements,this._attributes)};n.prototype.update=function(e,t,r){this._elements=t;this._attributes=e;this._elementsType=r||this.gl.UNSIGNED_SHORT};n.prototype.dispose=function(){};n.prototype.unbind=function(){};n.prototype.draw=function(e,t,r){r=r||0;var a=this.gl;if(this._elements){a.drawElements(e,t,this._elementsType,r)}else{a.drawArrays(e,r,t)}};function i(e){return new n(e)}t.exports=i},{"./do-bind.js":350}],352:[function(e,t,r){"use strict";var a=e("./do-bind.js");function n(e,t,r,a,n,i){this.location=e;this.dimension=t;this.a=r;this.b=a;this.c=n;this.d=i}n.prototype.bind=function(e){switch(this.dimension){case 1:e.vertexAttrib1f(this.location,this.a);break;case 2:e.vertexAttrib2f(this.location,this.a,this.b);break;case 3:e.vertexAttrib3f(this.location,this.a,this.b,this.c);break;case 4:e.vertexAttrib4f(this.location,this.a,this.b,this.c,this.d);break}};function i(e,t,r){this.gl=e;this._ext=t;this.handle=r;this._attribs=[];this._useElements=false;this._elementsType=e.UNSIGNED_SHORT}i.prototype.bind=function(){this._ext.bindVertexArrayOES(this.handle);for(var e=0;e<this._attribs.length;++e){this._attribs[e].bind(this.gl)}};i.prototype.unbind=function(){this._ext.bindVertexArrayOES(null)};i.prototype.dispose=function(){this._ext.deleteVertexArrayOES(this.handle)};i.prototype.update=function(e,t,r){this.bind();a(this.gl,t,e);this.unbind();this._attribs.length=0;if(e)for(var i=0;i<e.length;++i){var o=e[i];if(typeof o==="number"){this._attribs.push(new n(i,1,o))}else if(Array.isArray(o)){this._attribs.push(new n(i,o.length,o[0],o[1],o[2],o[3]))}}this._useElements=!!t;this._elementsType=r||this.gl.UNSIGNED_SHORT};i.prototype.draw=function(e,t,r){r=r||0;var a=this.gl;if(this._useElements){a.drawElements(e,t,this._elementsType,r)}else{a.drawArrays(e,r,t)}};function o(e,t){return new i(e,t,t.createVertexArrayOES())}t.exports=o},{"./do-bind.js":350}],353:[function(e,t,r){"use strict";var a=e("./lib/vao-native.js");var n=e("./lib/vao-emulated.js");function i(e){this.bindVertexArrayOES=e.bindVertexArray.bind(e);this.createVertexArrayOES=e.createVertexArray.bind(e);this.deleteVertexArrayOES=e.deleteVertexArray.bind(e)}function o(e,t,r,o){var s=e.createVertexArray?new i(e):e.getExtension("OES_vertex_array_object");var l;if(s){l=a(e,s)}else{l=n(e)}l.update(t,r,o);return l}t.exports=o},{"./lib/vao-emulated.js":351,"./lib/vao-native.js":352}],354:[function(e,t,r){t.exports=a;function a(e,t,r){e[0]=t[0]+r[0];e[1]=t[1]+r[1];e[2]=t[2]+r[2];return e}},{}],355:[function(e,t,r){t.exports=o;var a=e("./fromValues");var n=e("./normalize");var i=e("./dot");function o(e,t){var r=a(e[0],e[1],e[2]);var o=a(t[0],t[1],t[2]);n(r,r);n(o,o);var s=i(r,o);if(s>1){return 0}else{return Math.acos(s)}}},{"./dot":365,"./fromValues":371,"./normalize":382}],356:[function(e,t,r){t.exports=a;function a(e,t){e[0]=Math.ceil(t[0]);e[1]=Math.ceil(t[1]);e[2]=Math.ceil(t[2]);return e}},{}],357:[function(e,t,r){t.exports=a;function a(e){var t=new Float32Array(3);t[0]=e[0];t[1]=e[1];t[2]=e[2];return t}},{}],358:[function(e,t,r){t.exports=a;function a(e,t){e[0]=t[0];e[1]=t[1];e[2]=t[2];return e}},{}],359:[function(e,t,r){t.exports=a;function a(){var e=new Float32Array(3);e[0]=0;e[1]=0;e[2]=0;return e}},{}],360:[function(e,t,r){t.exports=a;function a(e,t,r){var a=t[0],n=t[1],i=t[2],o=r[0],s=r[1],l=r[2];e[0]=n*l-i*s;e[1]=i*o-a*l;e[2]=a*s-n*o;return e}},{}],361:[function(e,t,r){t.exports=e("./distance")},{"./distance":362}],362:[function(e,t,r){t.exports=a;function a(e,t){var r=t[0]-e[0],a=t[1]-e[1],n=t[2]-e[2];return Math.sqrt(r*r+a*a+n*n)}},{}],363:[function(e,t,r){t.exports=e("./divide")},{"./divide":364}],364:[function(e,t,r){t.exports=a;function a(e,t,r){e[0]=t[0]/r[0];e[1]=t[1]/r[1];e[2]=t[2]/r[2];return e}},{}],365:[function(e,t,r){t.exports=a;function a(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}},{}],366:[function(e,t,r){t.exports=1e-6},{}],367:[function(e,t,r){t.exports=n;var a=e("./epsilon");function n(e,t){var r=e[0];var n=e[1];var i=e[2];var o=t[0];var s=t[1];var l=t[2];return Math.abs(r-o)<=a*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(n-s)<=a*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(i-l)<=a*Math.max(1,Math.abs(i),Math.abs(l))}},{"./epsilon":366}],368:[function(e,t,r){t.exports=a;function a(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]}},{}],369:[function(e,t,r){t.exports=a;function a(e,t){e[0]=Math.floor(t[0]);e[1]=Math.floor(t[1]);e[2]=Math.floor(t[2]);return e}},{}],370:[function(e,t,r){t.exports=n;var a=e("./create")();function n(e,t,r,n,i,o){var s,l;if(!t){t=3}if(!r){r=0}if(n){l=Math.min(n*t+r,e.length)}else{l=e.length}for(s=r;s<l;s+=t){a[0]=e[s];a[1]=e[s+1];a[2]=e[s+2];i(a,a,o);e[s]=a[0];e[s+1]=a[1];e[s+2]=a[2]}return e}},{"./create":359}],371:[function(e,t,r){t.exports=a;function a(e,t,r){var a=new Float32Array(3);a[0]=e;a[1]=t;a[2]=r;return a}},{}],372:[function(e,t,r){t.exports={EPSILON:e("./epsilon"),create:e("./create"),clone:e("./clone"),angle:e("./angle"),fromValues:e("./fromValues"),copy:e("./copy"),set:e("./set"),equals:e("./equals"),exactEquals:e("./exactEquals"),add:e("./add"),subtract:e("./subtract"),sub:e("./sub"),multiply:e("./multiply"),mul:e("./mul"),divide:e("./divide"),div:e("./div"),min:e("./min"),max:e("./max"),floor:e("./floor"),ceil:e("./ceil"),round:e("./round"),scale:e("./scale"),scaleAndAdd:e("./scaleAndAdd"),distance:e("./distance"),dist:e("./dist"),squaredDistance:e("./squaredDistance"),sqrDist:e("./sqrDist"),length:e("./length"),len:e("./len"),squaredLength:e("./squaredLength"),sqrLen:e("./sqrLen"),negate:e("./negate"),inverse:e("./inverse"),normalize:e("./normalize"),dot:e("./dot"),cross:e("./cross"),lerp:e("./lerp"),random:e("./random"),transformMat4:e("./transformMat4"),transformMat3:e("./transformMat3"),transformQuat:e("./transformQuat"),rotateX:e("./rotateX"),rotateY:e("./rotateY"),rotateZ:e("./rotateZ"),forEach:e("./forEach")}},{"./add":354,"./angle":355,"./ceil":356,"./clone":357,"./copy":358,"./create":359,"./cross":360,"./dist":361,"./distance":362,"./div":363,"./divide":364,"./dot":365,"./epsilon":366,"./equals":367,"./exactEquals":368,"./floor":369,"./forEach":370,"./fromValues":371,"./inverse":373,"./len":374,"./length":375,"./lerp":376,"./max":377,"./min":378,"./mul":379,"./multiply":380,"./negate":381,"./normalize":382,"./random":383,"./rotateX":384,"./rotateY":385,"./rotateZ":386,"./round":387,"./scale":388,"./scaleAndAdd":389,"./set":390,"./sqrDist":391,"./sqrLen":392,"./squaredDistance":393,"./squaredLength":394,"./sub":395,"./subtract":396,"./transformMat3":397,"./transformMat4":398,"./transformQuat":399}],373:[function(e,t,r){t.exports=a;function a(e,t){e[0]=1/t[0];e[1]=1/t[1];e[2]=1/t[2];return e}},{}],374:[function(e,t,r){t.exports=e("./length")},{"./length":375}],375:[function(e,t,r){t.exports=a;function a(e){var t=e[0],r=e[1],a=e[2];return Math.sqrt(t*t+r*r+a*a)}},{}],376:[function(e,t,r){t.exports=a;function a(e,t,r,a){var n=t[0],i=t[1],o=t[2];e[0]=n+a*(r[0]-n);e[1]=i+a*(r[1]-i);e[2]=o+a*(r[2]-o);return e}},{}],377:[function(e,t,r){t.exports=a;function a(e,t,r){e[0]=Math.max(t[0],r[0]);e[1]=Math.max(t[1],r[1]);e[2]=Math.max(t[2],r[2]);return e}},{}],378:[function(e,t,r){t.exports=a;function a(e,t,r){e[0]=Math.min(t[0],r[0]);e[1]=Math.min(t[1],r[1]);e[2]=Math.min(t[2],r[2]);return e}},{}],379:[function(e,t,r){t.exports=e("./multiply")},{"./multiply":380}],380:[function(e,t,r){t.exports=a;function a(e,t,r){e[0]=t[0]*r[0];e[1]=t[1]*r[1];e[2]=t[2]*r[2];return e}},{}],381:[function(e,t,r){t.exports=a;function a(e,t){e[0]=-t[0];e[1]=-t[1];e[2]=-t[2];return e}},{}],382:[function(e,t,r){t.exports=a;function a(e,t){var r=t[0],a=t[1],n=t[2];var i=r*r+a*a+n*n;if(i>0){i=1/Math.sqrt(i);e[0]=t[0]*i;e[1]=t[1]*i;e[2]=t[2]*i}return e}},{}],383:[function(e,t,r){t.exports=a;function a(e,t){t=t||1;var r=Math.random()*2*Math.PI;var a=Math.random()*2-1;var n=Math.sqrt(1-a*a)*t;e[0]=Math.cos(r)*n;e[1]=Math.sin(r)*n;e[2]=a*t;return e}},{}],384:[function(e,t,r){t.exports=a;function a(e,t,r,a){var n=r[1];var i=r[2];var o=t[1]-n;var s=t[2]-i;var l=Math.sin(a);var u=Math.cos(a);e[0]=t[0];e[1]=n+o*u-s*l;e[2]=i+o*l+s*u;return e}},{}],385:[function(e,t,r){t.exports=a;function a(e,t,r,a){var n=r[0];var i=r[2];var o=t[0]-n;var s=t[2]-i;var l=Math.sin(a);var u=Math.cos(a);e[0]=n+s*l+o*u;e[1]=t[1];e[2]=i+s*u-o*l;return e}},{}],386:[function(e,t,r){t.exports=a;function a(e,t,r,a){var n=r[0];var i=r[1];var o=t[0]-n;var s=t[1]-i;var l=Math.sin(a);var u=Math.cos(a);e[0]=n+o*u-s*l;e[1]=i+o*l+s*u;e[2]=t[2];return e}},{}],387:[function(e,t,r){t.exports=a;function a(e,t){e[0]=Math.round(t[0]);e[1]=Math.round(t[1]);e[2]=Math.round(t[2]);return e}},{}],388:[function(e,t,r){t.exports=a;function a(e,t,r){e[0]=t[0]*r;e[1]=t[1]*r;e[2]=t[2]*r;return e}},{}],389:[function(e,t,r){t.exports=a;function a(e,t,r,a){e[0]=t[0]+r[0]*a;e[1]=t[1]+r[1]*a;e[2]=t[2]+r[2]*a;return e}},{}],390:[function(e,t,r){t.exports=a;function a(e,t,r,a){e[0]=t;e[1]=r;e[2]=a;return e}},{}],391:[function(e,t,r){t.exports=e("./squaredDistance")},{"./squaredDistance":393}],392:[function(e,t,r){t.exports=e("./squaredLength")},{"./squaredLength":394}],393:[function(e,t,r){t.exports=a;function a(e,t){var r=t[0]-e[0],a=t[1]-e[1],n=t[2]-e[2];return r*r+a*a+n*n}},{}],394:[function(e,t,r){t.exports=a;function a(e){var t=e[0],r=e[1],a=e[2];return t*t+r*r+a*a}},{}],395:[function(e,t,r){t.exports=e("./subtract")},{"./subtract":396}],396:[function(e,t,r){t.exports=a;function a(e,t,r){e[0]=t[0]-r[0];e[1]=t[1]-r[1];e[2]=t[2]-r[2];return e}},{}],397:[function(e,t,r){t.exports=a;function a(e,t,r){var a=t[0],n=t[1],i=t[2];e[0]=a*r[0]+n*r[3]+i*r[6];e[1]=a*r[1]+n*r[4]+i*r[7];e[2]=a*r[2]+n*r[5]+i*r[8];return e}},{}],398:[function(e,t,r){t.exports=a;function a(e,t,r){var a=t[0],n=t[1],i=t[2],o=r[3]*a+r[7]*n+r[11]*i+r[15];o=o||1;e[0]=(r[0]*a+r[4]*n+r[8]*i+r[12])/o;e[1]=(r[1]*a+r[5]*n+r[9]*i+r[13])/o;e[2]=(r[2]*a+r[6]*n+r[10]*i+r[14])/o;return e}},{}],399:[function(e,t,r){t.exports=a;function a(e,t,r){var a=t[0],n=t[1],i=t[2],o=r[0],s=r[1],l=r[2],u=r[3],c=u*a+s*i-l*n,f=u*n+l*a-o*i,h=u*i+o*n-s*a,p=-o*a-s*n-l*i;e[0]=c*u+p*-o+f*-l-h*-s;e[1]=f*u+p*-s+h*-o-c*-l;e[2]=h*u+p*-l+c*-s-f*-o;return e}},{}],400:[function(e,t,r){t.exports=a;function a(e,t,r){e[0]=t[0]+r[0];e[1]=t[1]+r[1];e[2]=t[2]+r[2];e[3]=t[3]+r[3];return e}},{}],401:[function(e,t,r){t.exports=a;function a(e){var t=new Float32Array(4);t[0]=e[0];t[1]=e[1];t[2]=e[2];t[3]=e[3];return t}},{}],402:[function(e,t,r){t.exports=a;function a(e,t){e[0]=t[0];e[1]=t[1];e[2]=t[2];e[3]=t[3];return e}},{}],403:[function(e,t,r){t.exports=a;function a(){var e=new Float32Array(4);e[0]=0;e[1]=0;e[2]=0;e[3]=0;return e}},{}],404:[function(e,t,r){t.exports=a;function a(e,t){var r=t[0]-e[0],a=t[1]-e[1],n=t[2]-e[2],i=t[3]-e[3];return Math.sqrt(r*r+a*a+n*n+i*i)}},{}],405:[function(e,t,r){t.exports=a;function a(e,t,r){e[0]=t[0]/r[0];e[1]=t[1]/r[1];e[2]=t[2]/r[2];e[3]=t[3]/r[3];return e}},{}],406:[function(e,t,r){t.exports=a;function a(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}},{}],407:[function(e,t,r){t.exports=a;function a(e,t,r,a){var n=new Float32Array(4);n[0]=e;n[1]=t;n[2]=r;n[3]=a;return n}},{}],408:[function(e,t,r){t.exports={create:e("./create"),clone:e("./clone"),fromValues:e("./fromValues"),copy:e("./copy"),set:e("./set"),add:e("./add"),subtract:e("./subtract"),multiply:e("./multiply"),divide:e("./divide"),min:e("./min"),max:e("./max"),scale:e("./scale"),scaleAndAdd:e("./scaleAndAdd"),distance:e("./distance"),squaredDistance:e("./squaredDistance"),length:e("./length"),squaredLength:e("./squaredLength"),negate:e("./negate"),inverse:e("./inverse"),normalize:e("./normalize"),dot:e("./dot"),lerp:e("./lerp"),random:e("./random"),transformMat4:e("./transformMat4"),transformQuat:e("./transformQuat")}},{"./add":400,"./clone":401,"./copy":402,"./create":403,"./distance":404,"./divide":405,"./dot":406,"./fromValues":407,"./inverse":409,"./length":410,"./lerp":411,"./max":412,"./min":413,"./multiply":414,"./negate":415,"./normalize":416,"./random":417,"./scale":418,"./scaleAndAdd":419,"./set":420,"./squaredDistance":421,"./squaredLength":422,"./subtract":423,"./transformMat4":424,"./transformQuat":425}],409:[function(e,t,r){t.exports=a;function a(e,t){e[0]=1/t[0];e[1]=1/t[1];e[2]=1/t[2];e[3]=1/t[3];return e}},{}],410:[function(e,t,r){t.exports=a;function a(e){var t=e[0],r=e[1],a=e[2],n=e[3];return Math.sqrt(t*t+r*r+a*a+n*n)}},{}],411:[function(e,t,r){t.exports=a;function a(e,t,r,a){var n=t[0],i=t[1],o=t[2],s=t[3];e[0]=n+a*(r[0]-n);e[1]=i+a*(r[1]-i);e[2]=o+a*(r[2]-o);e[3]=s+a*(r[3]-s);return e}},{}],412:[function(e,t,r){t.exports=a;function a(e,t,r){e[0]=Math.max(t[0],r[0]);e[1]=Math.max(t[1],r[1]);e[2]=Math.max(t[2],r[2]);e[3]=Math.max(t[3],r[3]);return e}},{}],413:[function(e,t,r){t.exports=a;function a(e,t,r){e[0]=Math.min(t[0],r[0]);e[1]=Math.min(t[1],r[1]);e[2]=Math.min(t[2],r[2]);e[3]=Math.min(t[3],r[3]);return e}},{}],414:[function(e,t,r){t.exports=a;function a(e,t,r){e[0]=t[0]*r[0];e[1]=t[1]*r[1];e[2]=t[2]*r[2];e[3]=t[3]*r[3];return e}},{}],415:[function(e,t,r){t.exports=a;function a(e,t){e[0]=-t[0];e[1]=-t[1];e[2]=-t[2];e[3]=-t[3];return e}},{}],416:[function(e,t,r){t.exports=a;function a(e,t){var r=t[0],a=t[1],n=t[2],i=t[3];var o=r*r+a*a+n*n+i*i;if(o>0){o=1/Math.sqrt(o);e[0]=r*o;e[1]=a*o;e[2]=n*o;e[3]=i*o}return e}},{}],417:[function(e,t,r){var a=e("./normalize");var n=e("./scale");t.exports=i;function i(e,t){t=t||1;e[0]=Math.random();e[1]=Math.random();e[2]=Math.random();e[3]=Math.random();a(e,e);n(e,e,t);return e}},{"./normalize":416,"./scale":418}],418:[function(e,t,r){t.exports=a;function a(e,t,r){e[0]=t[0]*r;e[1]=t[1]*r;e[2]=t[2]*r;e[3]=t[3]*r;return e}},{}],419:[function(e,t,r){t.exports=a;function a(e,t,r,a){e[0]=t[0]+r[0]*a;e[1]=t[1]+r[1]*a;e[2]=t[2]+r[2]*a;e[3]=t[3]+r[3]*a;return e}},{}],420:[function(e,t,r){t.exports=a;function a(e,t,r,a,n){e[0]=t;e[1]=r;e[2]=a;e[3]=n;return e}},{}],421:[function(e,t,r){t.exports=a;function a(e,t){var r=t[0]-e[0],a=t[1]-e[1],n=t[2]-e[2],i=t[3]-e[3];return r*r+a*a+n*n+i*i}},{}],422:[function(e,t,r){t.exports=a;function a(e){var t=e[0],r=e[1],a=e[2],n=e[3];return t*t+r*r+a*a+n*n}},{}],423:[function(e,t,r){t.exports=a;function a(e,t,r){e[0]=t[0]-r[0];e[1]=t[1]-r[1];e[2]=t[2]-r[2];e[3]=t[3]-r[3];return e}},{}],424:[function(e,t,r){t.exports=a;function a(e,t,r){var a=t[0],n=t[1],i=t[2],o=t[3];e[0]=r[0]*a+r[4]*n+r[8]*i+r[12]*o;e[1]=r[1]*a+r[5]*n+r[9]*i+r[13]*o;e[2]=r[2]*a+r[6]*n+r[10]*i+r[14]*o;e[3]=r[3]*a+r[7]*n+r[11]*i+r[15]*o;return e}},{}],425:[function(e,t,r){t.exports=a;function a(e,t,r){var a=t[0],n=t[1],i=t[2],o=r[0],s=r[1],l=r[2],u=r[3],c=u*a+s*i-l*n,f=u*n+l*a-o*i,h=u*i+o*n-s*a,p=-o*a-s*n-l*i;e[0]=c*u+p*-o+f*-l-h*-s;e[1]=f*u+p*-s+h*-o-c*-l;e[2]=h*u+p*-l+c*-s-f*-o;e[3]=t[3];return e}},{}],426:[function(e,t,r){var a=e("glsl-tokenizer");var n=e("atob-lite");t.exports=i;function i(e){var t=Array.isArray(e)?e:a(e);for(var r=0;r<t.length;r++){var i=t[r];if(i.type!=="preprocessor")continue;var o=i.data.match(/\#define\s+SHADER_NAME(_B64)?\s+(.+)$/);if(!o)continue;if(!o[2])continue;var s=o[1];var l=o[2];return(s?n(l):l).trim()}}},{"atob-lite":84,"glsl-tokenizer":433}],427:[function(e,t,r){t.exports=T;var a=e("./lib/literals"),n=e("./lib/operators"),i=e("./lib/builtins"),o=e("./lib/literals-300es"),s=e("./lib/builtins-300es");var l=999,u=9999,c=0,f=1,h=2,p=3,v=4,d=5,m=6,g=7,y=8,x=9,b=10,_=11;var w=["block-comment","line-comment","preprocessor","operator","integer","float","ident","builtin","keyword","whitespace","eof","integer"];function T(e){var t=0,r=0,T=l,k,M,A=[],S=[],E=0,L=0,C=1,I=0,P=0,O=false,z=false,D="",R;e=e||{};var F=i;var B=a;if(e.version==="300 es"){F=s;B=o}var N={},j={};for(var t=0;t<F.length;t++){N[F[t]]=true}for(var t=0;t<B.length;t++){j[B[t]]=true}return function(e){S=[];if(e!==null)return V(e);return H()};function U(e){if(e.length){S.push({type:w[T],data:e,position:P,line:C,column:I})}}function V(e){t=0;if(e.toString)e=e.toString();D+=e.replace(/\r\n/g,"\n");R=D.length;var a;while(k=D[t],t<R){a=t;switch(T){case c:t=X();break;case f:t=W();break;case h:t=Y();break;case p:t=Z();break;case v:t=Q();break;case _:t=K();break;case d:t=$();break;case u:t=ee();break;case x:t=G();break;case l:t=q();break}if(a!==t){switch(D[a]){case"\n":I=0;++C;break;default:++I;break}}}r+=t;D=D.slice(t);return S}function H(e){if(A.length){U(A.join(""))}T=b;U("(eof)");return S}function q(){A=A.length?[]:A;if(M==="/"&&k==="*"){P=r+t-1;T=c;M=k;return t+1}if(M==="/"&&k==="/"){P=r+t-1;T=f;M=k;return t+1}if(k==="#"){T=h;P=r+t;return t}if(/\s/.test(k)){T=x;P=r+t;return t}O=/\d/.test(k);z=/[^\w_]/.test(k);P=r+t;T=O?v:z?p:u;return t}function G(){if(/[^\s]/g.test(k)){U(A.join(""));T=l;return t}A.push(k);M=k;return t+1}function Y(){if((k==="\r"||k==="\n")&&M!=="\\"){U(A.join(""));T=l;return t}A.push(k);M=k;return t+1}function W(){return Y()}function X(){if(k==="/"&&M==="*"){A.push(k);U(A.join(""));T=l;return t+1}A.push(k);M=k;return t+1}function Z(){if(M==="."&&/\d/.test(k)){T=d;return t}if(M==="/"&&k==="*"){T=c;return t}if(M==="/"&&k==="/"){T=f;return t}if(k==="."&&A.length){while(J(A));T=d;return t}if(k===";"||k===")"||k==="("){if(A.length)while(J(A));U(k);T=l;return t+1}var e=A.length===2&&k!=="=";if(/[\w_\d\s]/.test(k)||e){while(J(A));T=l;return t}A.push(k);M=k;return t+1}function J(e){var t=0,r,a;do{r=n.indexOf(e.slice(0,e.length+t).join(""));a=n[r];if(r===-1){if(t--+e.length>0)continue;a=e.slice(0,1).join("")}U(a);P+=a.length;A=A.slice(a.length);return A.length}while(1)}function K(){if(/[^a-fA-F0-9]/.test(k)){U(A.join(""));T=l;return t}A.push(k);M=k;return t+1}function Q(){if(k==="."){A.push(k);T=d;M=k;return t+1}if(/[eE]/.test(k)){A.push(k);T=d;M=k;return t+1}if(k==="x"&&A.length===1&&A[0]==="0"){T=_;A.push(k);M=k;return t+1}if(/[^\d]/.test(k)){U(A.join(""));T=l;return t}A.push(k);M=k;return t+1}function $(){if(k==="f"){A.push(k);M=k;t+=1}if(/[eE]/.test(k)){A.push(k);M=k;return t+1}if((k==="-"||k==="+")&&/[eE]/.test(M)){A.push(k);M=k;return t+1}if(/[^\d]/.test(k)){U(A.join(""));T=l;return t}A.push(k);M=k;return t+1}function ee(){if(/[^\d\w_]/.test(k)){var e=A.join("");if(j[e]){T=y}else if(N[e]){T=g}else{T=m}U(A.join(""));T=l;return t}A.push(k);M=k;return t+1}}},{"./lib/builtins":429,"./lib/builtins-300es":428,"./lib/literals":431,"./lib/literals-300es":430,"./lib/operators":432}],428:[function(e,t,r){var a=e("./builtins");a=a.slice().filter((function(e){return!/^(gl\_|texture)/.test(e)}));t.exports=a.concat(["gl_VertexID","gl_InstanceID","gl_Position","gl_PointSize","gl_FragCoord","gl_FrontFacing","gl_FragDepth","gl_PointCoord","gl_MaxVertexAttribs","gl_MaxVertexUniformVectors","gl_MaxVertexOutputVectors","gl_MaxFragmentInputVectors","gl_MaxVertexTextureImageUnits","gl_MaxCombinedTextureImageUnits","gl_MaxTextureImageUnits","gl_MaxFragmentUniformVectors","gl_MaxDrawBuffers","gl_MinProgramTexelOffset","gl_MaxProgramTexelOffset","gl_DepthRangeParameters","gl_DepthRange","trunc","round","roundEven","isnan","isinf","floatBitsToInt","floatBitsToUint","intBitsToFloat","uintBitsToFloat","packSnorm2x16","unpackSnorm2x16","packUnorm2x16","unpackUnorm2x16","packHalf2x16","unpackHalf2x16","outerProduct","transpose","determinant","inverse","texture","textureSize","textureProj","textureLod","textureOffset","texelFetch","texelFetchOffset","textureProjOffset","textureLodOffset","textureProjLod","textureProjLodOffset","textureGrad","textureGradOffset","textureProjGrad","textureProjGradOffset"])},{"./builtins":429}],429:[function(e,t,r){t.exports=["abs","acos","all","any","asin","atan","ceil","clamp","cos","cross","dFdx","dFdy","degrees","distance","dot","equal","exp","exp2","faceforward","floor","fract","gl_BackColor","gl_BackLightModelProduct","gl_BackLightProduct","gl_BackMaterial","gl_BackSecondaryColor","gl_ClipPlane","gl_ClipVertex","gl_Color","gl_DepthRange","gl_DepthRangeParameters","gl_EyePlaneQ","gl_EyePlaneR","gl_EyePlaneS","gl_EyePlaneT","gl_Fog","gl_FogCoord","gl_FogFragCoord","gl_FogParameters","gl_FragColor","gl_FragCoord","gl_FragData","gl_FragDepth","gl_FragDepthEXT","gl_FrontColor","gl_FrontFacing","gl_FrontLightModelProduct","gl_FrontLightProduct","gl_FrontMaterial","gl_FrontSecondaryColor","gl_LightModel","gl_LightModelParameters","gl_LightModelProducts","gl_LightProducts","gl_LightSource","gl_LightSourceParameters","gl_MaterialParameters","gl_MaxClipPlanes","gl_MaxCombinedTextureImageUnits","gl_MaxDrawBuffers","gl_MaxFragmentUniformComponents","gl_MaxLights","gl_MaxTextureCoords","gl_MaxTextureImageUnits","gl_MaxTextureUnits","gl_MaxVaryingFloats","gl_MaxVertexAttribs","gl_MaxVertexTextureImageUnits","gl_MaxVertexUniformComponents","gl_ModelViewMatrix","gl_ModelViewMatrixInverse","gl_ModelViewMatrixInverseTranspose","gl_ModelViewMatrixTranspose","gl_ModelViewProjectionMatrix","gl_ModelViewProjectionMatrixInverse","gl_ModelViewProjectionMatrixInverseTranspose","gl_ModelViewProjectionMatrixTranspose","gl_MultiTexCoord0","gl_MultiTexCoord1","gl_MultiTexCoord2","gl_MultiTexCoord3","gl_MultiTexCoord4","gl_MultiTexCoord5","gl_MultiTexCoord6","gl_MultiTexCoord7","gl_Normal","gl_NormalMatrix","gl_NormalScale","gl_ObjectPlaneQ","gl_ObjectPlaneR","gl_ObjectPlaneS","gl_ObjectPlaneT","gl_Point","gl_PointCoord","gl_PointParameters","gl_PointSize","gl_Position","gl_ProjectionMatrix","gl_ProjectionMatrixInverse","gl_ProjectionMatrixInverseTranspose","gl_ProjectionMatrixTranspose","gl_SecondaryColor","gl_TexCoord","gl_TextureEnvColor","gl_TextureMatrix","gl_TextureMatrixInverse","gl_TextureMatrixInverseTranspose","gl_TextureMatrixTranspose","gl_Vertex","greaterThan","greaterThanEqual","inversesqrt","length","lessThan","lessThanEqual","log","log2","matrixCompMult","max","min","mix","mod","normalize","not","notEqual","pow","radians","reflect","refract","sign","sin","smoothstep","sqrt","step","tan","texture2D","texture2DLod","texture2DProj","texture2DProjLod","textureCube","textureCubeLod","texture2DLodEXT","texture2DProjLodEXT","textureCubeLodEXT","texture2DGradEXT","texture2DProjGradEXT","textureCubeGradEXT"]},{}],430:[function(e,t,r){var a=e("./literals");t.exports=a.slice().concat(["layout","centroid","smooth","case","mat2x2","mat2x3","mat2x4","mat3x2","mat3x3","mat3x4","mat4x2","mat4x3","mat4x4","uvec2","uvec3","uvec4","samplerCubeShadow","sampler2DArray","sampler2DArrayShadow","isampler2D","isampler3D","isamplerCube","isampler2DArray","usampler2D","usampler3D","usamplerCube","usampler2DArray","coherent","restrict","readonly","writeonly","resource","atomic_uint","noperspective","patch","sample","subroutine","common","partition","active","filter","image1D","image2D","image3D","imageCube","iimage1D","iimage2D","iimage3D","iimageCube","uimage1D","uimage2D","uimage3D","uimageCube","image1DArray","image2DArray","iimage1DArray","iimage2DArray","uimage1DArray","uimage2DArray","image1DShadow","image2DShadow","image1DArrayShadow","image2DArrayShadow","imageBuffer","iimageBuffer","uimageBuffer","sampler1DArray","sampler1DArrayShadow","isampler1D","isampler1DArray","usampler1D","usampler1DArray","isampler2DRect","usampler2DRect","samplerBuffer","isamplerBuffer","usamplerBuffer","sampler2DMS","isampler2DMS","usampler2DMS","sampler2DMSArray","isampler2DMSArray","usampler2DMSArray"])},{"./literals":431}],431:[function(e,t,r){t.exports=["precision","highp","mediump","lowp","attribute","const","uniform","varying","break","continue","do","for","while","if","else","in","out","inout","float","int","uint","void","bool","true","false","discard","return","mat2","mat3","mat4","vec2","vec3","vec4","ivec2","ivec3","ivec4","bvec2","bvec3","bvec4","sampler1D","sampler2D","sampler3D","samplerCube","sampler1DShadow","sampler2DShadow","struct","asm","class","union","enum","typedef","template","this","packed","goto","switch","default","inline","noinline","volatile","public","static","extern","external","interface","long","short","double","half","fixed","unsigned","input","output","hvec2","hvec3","hvec4","dvec2","dvec3","dvec4","fvec2","fvec3","fvec4","sampler2DRect","sampler3DRect","sampler2DRectShadow","sizeof","cast","namespace","using"]},{}],432:[function(e,t,r){t.exports=["<<=",">>=","++","--","<<",">>","<=",">=","==","!=","&&","||","+=","-=","*=","/=","%=","&=","^^","^=","|=","(",")","[","]",".","!","~","*","/","%","+","-","<",">","&","^","|","?",":","=",",",";","{","}"]},{}],433:[function(e,t,r){var a=e("./index");t.exports=n;function n(e,t){var r=a(t);var n=[];n=n.concat(r(e));n=n.concat(r(null));return n}},{"./index":427}],434:[function(e,t,r){arguments[4][268][0].apply(r,arguments)},{dup:268}],435:[function(e,r,a){(function(t){(function(){"use strict";var a=e("is-browser");var n;if(typeof t.matchMedia==="function"){n=!t.matchMedia("(hover: none)").matches}else{n=a}r.exports=n}).call(this)}).call(this,typeof t!=="undefined"?t:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"is-browser":442}],436:[function(e,t,r){"use strict";var a=e("is-browser");function n(){var e=false;try{var t=Object.defineProperty({},"passive",{get:function(){e=true}});window.addEventListener("test",null,t);window.removeEventListener("test",null,t)}catch(r){e=false}return e}t.exports=a&&n()},{"is-browser":442}],437:[function(e,t,r){r.read=function(e,t,r,a,n){var i,o;var s=n*8-a-1;var l=(1<<s)-1;var u=l>>1;var c=-7;var f=r?n-1:0;var h=r?-1:1;var p=e[t+f];f+=h;i=p&(1<<-c)-1;p>>=-c;c+=s;for(;c>0;i=i*256+e[t+f],f+=h,c-=8){}o=i&(1<<-c)-1;i>>=-c;c+=a;for(;c>0;o=o*256+e[t+f],f+=h,c-=8){}if(i===0){i=1-u}else if(i===l){return o?NaN:(p?-1:1)*Infinity}else{o=o+Math.pow(2,a);i=i-u}return(p?-1:1)*o*Math.pow(2,i-a)};r.write=function(e,t,r,a,n,i){var o,s,l;var u=i*8-n-1;var c=(1<<u)-1;var f=c>>1;var h=n===23?Math.pow(2,-24)-Math.pow(2,-77):0;var p=a?0:i-1;var v=a?1:-1;var d=t<0||t===0&&1/t<0?1:0;t=Math.abs(t);if(isNaN(t)||t===Infinity){s=isNaN(t)?1:0;o=c}else{o=Math.floor(Math.log(t)/Math.LN2);if(t*(l=Math.pow(2,-o))<1){o--;l*=2}if(o+f>=1){t+=h/l}else{t+=h*Math.pow(2,1-f)}if(t*l>=2){o++;l/=2}if(o+f>=c){s=0;o=c}else if(o+f>=1){s=(t*l-1)*Math.pow(2,n);o=o+f}else{s=t*Math.pow(2,f-1)*Math.pow(2,n);o=0}}for(;n>=8;e[r+p]=s&255,p+=v,s/=256,n-=8){}o=o<<n|s;u+=n;for(;u>0;e[r+p]=o&255,p+=v,o/=256,u-=8){}e[r+p-v]|=d*128}},{}],438:[function(e,t,r){"use strict";t.exports=p;var a=e("robust-orientation");var n=e("simplicial-complex").compareCells;function i(e,t,r){this.vertices=e;this.adjacent=t;this.boundary=r;this.lastVisited=-1}i.prototype.flip=function(){var e=this.vertices[0];this.vertices[0]=this.vertices[1];this.vertices[1]=e;var t=this.adjacent[0];this.adjacent[0]=this.adjacent[1];this.adjacent[1]=t};function o(e,t,r){this.vertices=e;this.cell=t;this.index=r}function s(e,t){return n(e.vertices,t.vertices)}function l(e){return function(){var t=this.tuple;return e.apply(this,t)}}function u(e){var t=a[e+1];if(!t){t=a}return l(t)}var c=[];function f(e,t,r){this.dimension=e;this.vertices=t;this.simplices=r;this.interior=r.filter((function(e){return!e.boundary}));this.tuple=new Array(e+1);for(var a=0;a<=e;++a){this.tuple[a]=this.vertices[a]}var n=c[e];if(!n){n=c[e]=u(e)}this.orient=n}var h=f.prototype;h.handleBoundaryDegeneracy=function(e,t){var r=this.dimension;var a=this.vertices.length-1;var n=this.tuple;var i=this.vertices;var o=[e];e.lastVisited=-a;while(o.length>0){e=o.pop();var s=e.adjacent;for(var l=0;l<=r;++l){var u=s[l];if(!u.boundary||u.lastVisited<=-a){continue}var c=u.vertices;for(var f=0;f<=r;++f){var h=c[f];if(h<0){n[f]=t}else{n[f]=i[h]}}var p=this.orient();if(p>0){return u}u.lastVisited=-a;if(p===0){o.push(u)}}}return null};h.walk=function(e,t){var r=this.vertices.length-1;var a=this.dimension;var n=this.vertices;var i=this.tuple;var o=t?this.interior.length*Math.random()|0:this.interior.length-1;var s=this.interior[o];e:while(!s.boundary){var l=s.vertices;var u=s.adjacent;for(var c=0;c<=a;++c){i[c]=n[l[c]]}s.lastVisited=r;for(var c=0;c<=a;++c){var f=u[c];if(f.lastVisited>=r){continue}var h=i[c];i[c]=e;var p=this.orient();i[c]=h;if(p<0){s=f;continue e}else{if(!f.boundary){f.lastVisited=r}else{f.lastVisited=-r}}}return}return s};h.addPeaks=function(e,t){var r=this.vertices.length-1;var a=this.dimension;var n=this.vertices;var l=this.tuple;var u=this.interior;var c=this.simplices;var f=[t];t.lastVisited=r;t.vertices[t.vertices.indexOf(-1)]=r;t.boundary=false;u.push(t);var h=[];while(f.length>0){var t=f.pop();var p=t.vertices;var v=t.adjacent;var d=p.indexOf(r);if(d<0){continue}for(var m=0;m<=a;++m){if(m===d){continue}var g=v[m];if(!g.boundary||g.lastVisited>=r){continue}var y=g.vertices;if(g.lastVisited!==-r){var x=0;for(var b=0;b<=a;++b){if(y[b]<0){x=b;l[b]=e}else{l[b]=n[y[b]]}}var _=this.orient();if(_>0){y[x]=r;g.boundary=false;u.push(g);f.push(g);g.lastVisited=r;continue}else{g.lastVisited=-r}}var w=g.adjacent;var T=p.slice();var k=v.slice();var M=new i(T,k,true);c.push(M);var A=w.indexOf(t);if(A<0){continue}w[A]=M;k[d]=g;T[m]=-1;k[m]=t;v[m]=M;M.flip();for(var b=0;b<=a;++b){var S=T[b];if(S<0||S===r){continue}var E=new Array(a-1);var L=0;for(var C=0;C<=a;++C){var I=T[C];if(I<0||C===b){continue}E[L++]=I}h.push(new o(E,M,b))}}}h.sort(s);for(var m=0;m+1<h.length;m+=2){var P=h[m];var O=h[m+1];var z=P.index;var D=O.index;if(z<0||D<0){continue}P.cell.adjacent[P.index]=O.cell;O.cell.adjacent[O.index]=P.cell}};h.insert=function(e,t){var r=this.vertices;r.push(e);var a=this.walk(e,t);if(!a){return}var n=this.dimension;var i=this.tuple;for(var o=0;o<=n;++o){var s=a.vertices[o];if(s<0){i[o]=e}else{i[o]=r[s]}}var l=this.orient(i);if(l<0){return}else if(l===0){a=this.handleBoundaryDegeneracy(a,e);if(!a){return}}this.addPeaks(e,a)};h.boundary=function(){var e=this.dimension;var t=[];var r=this.simplices;var a=r.length;for(var n=0;n<a;++n){var i=r[n];if(i.boundary){var o=new Array(e);var s=i.vertices;var l=0;var u=0;for(var c=0;c<=e;++c){if(s[c]>=0){o[l++]=s[c]}else{u=c&1}}if(u===(e&1)){var f=o[0];o[0]=o[1];o[1]=f}t.push(o)}}return t};function p(e,t){var r=e.length;if(r===0){throw new Error("Must have at least d+1 points")}var n=e[0].length;if(r<=n){throw new Error("Must input at least d+1 points")}var o=e.slice(0,n+1);var s=a.apply(void 0,o);if(s===0){throw new Error("Input not in general position")}var l=new Array(n+1);for(var u=0;u<=n;++u){l[u]=u}if(s<0){l[0]=1;l[1]=0}var c=new i(l,new Array(n+1),false);var h=c.adjacent;var p=new Array(n+2);for(var u=0;u<=n;++u){var v=l.slice();for(var d=0;d<=n;++d){if(d===u){v[d]=-1}}var m=v[0];v[0]=v[1];v[1]=m;var g=new i(v,new Array(n+1),true);h[u]=g;p[u]=g}p[n+1]=c;for(var u=0;u<=n;++u){var v=h[u].vertices;var y=h[u].adjacent;for(var d=0;d<=n;++d){var x=v[d];if(x<0){y[d]=c;continue}for(var b=0;b<=n;++b){if(h[b].vertices.indexOf(x)<0){y[d]=h[b]}}}}var _=new f(n,o,p);var w=!!t;for(var u=n+1;u<r;++u){_.insert(e[u],w)}return _.boundary()}},{"robust-orientation":534,"simplicial-complex":545}],439:[function(e,t,r){if(typeof Object.create==="function"){t.exports=function e(t,r){if(r){t.super_=r;t.prototype=Object.create(r.prototype,{constructor:{value:t,enumerable:false,writable:true,configurable:true}})}}}else{t.exports=function e(t,r){if(r){t.super_=r;var a=function(){};a.prototype=r.prototype;t.prototype=new a;t.prototype.constructor=t}}}},{}],440:[function(e,t,r){"use strict";var a=e("binary-search-bounds");var n=0;var i=1;var o=2;t.exports=w;function s(e,t,r,a,n){this.mid=e;this.left=t;this.right=r;this.leftPoints=a;this.rightPoints=n;this.count=(t?t.count:0)+(r?r.count:0)+a.length}var l=s.prototype;function u(e,t){e.mid=t.mid;e.left=t.left;e.right=t.right;e.leftPoints=t.leftPoints;e.rightPoints=t.rightPoints;e.count=t.count}function c(e,t){var r=x(t);e.mid=r.mid;e.left=r.left;e.right=r.right;e.leftPoints=r.leftPoints;e.rightPoints=r.rightPoints;e.count=r.count}function f(e,t){var r=e.intervals([]);r.push(t);c(e,r)}function h(e,t){var r=e.intervals([]);var a=r.indexOf(t);if(a<0){return n}r.splice(a,1);c(e,r);return i}l.intervals=function(e){e.push.apply(e,this.leftPoints);if(this.left){this.left.intervals(e)}if(this.right){this.right.intervals(e)}return e};l.insert=function(e){var t=this.count-this.leftPoints.length;this.count+=1;if(e[1]<this.mid){if(this.left){if(4*(this.left.count+1)>3*(t+1)){f(this,e)}else{this.left.insert(e)}}else{this.left=x([e])}}else if(e[0]>this.mid){if(this.right){if(4*(this.right.count+1)>3*(t+1)){f(this,e)}else{this.right.insert(e)}}else{this.right=x([e])}}else{var r=a.ge(this.leftPoints,e,g);var n=a.ge(this.rightPoints,e,y);this.leftPoints.splice(r,0,e);this.rightPoints.splice(n,0,e)}};l.remove=function(e){var t=this.count-this.leftPoints;if(e[1]<this.mid){if(!this.left){return n}var r=this.right?this.right.count:0;if(4*r>3*(t-1)){return h(this,e)}var s=this.left.remove(e);if(s===o){this.left=null;this.count-=1;return i}else if(s===i){this.count-=1}return s}else if(e[0]>this.mid){if(!this.right){return n}var l=this.left?this.left.count:0;if(4*l>3*(t-1)){return h(this,e)}var s=this.right.remove(e);if(s===o){this.right=null;this.count-=1;return i}else if(s===i){this.count-=1}return s}else{if(this.count===1){if(this.leftPoints[0]===e){return o}else{return n}}if(this.leftPoints.length===1&&this.leftPoints[0]===e){if(this.left&&this.right){var c=this;var f=this.left;while(f.right){c=f;f=f.right}if(c===this){f.right=this.right}else{var p=this.left;var s=this.right;c.count-=f.count;c.right=f.left;f.left=p;f.right=s}u(this,f);this.count=(this.left?this.left.count:0)+(this.right?this.right.count:0)+this.leftPoints.length}else if(this.left){u(this,this.left)}else{u(this,this.right)}return i}for(var p=a.ge(this.leftPoints,e,g);p<this.leftPoints.length;++p){if(this.leftPoints[p][0]!==e[0]){break}if(this.leftPoints[p]===e){this.count-=1;this.leftPoints.splice(p,1);for(var s=a.ge(this.rightPoints,e,y);s<this.rightPoints.length;++s){if(this.rightPoints[s][1]!==e[1]){break}else if(this.rightPoints[s]===e){this.rightPoints.splice(s,1);return i}}}}return n}};function p(e,t,r){for(var a=0;a<e.length&&e[a][0]<=t;++a){var n=r(e[a]);if(n){return n}}}function v(e,t,r){for(var a=e.length-1;a>=0&&e[a][1]>=t;--a){var n=r(e[a]);if(n){return n}}}function d(e,t){for(var r=0;r<e.length;++r){var a=t(e[r]);if(a){return a}}}l.queryPoint=function(e,t){if(e<this.mid){if(this.left){var r=this.left.queryPoint(e,t);if(r){return r}}return p(this.leftPoints,e,t)}else if(e>this.mid){if(this.right){var r=this.right.queryPoint(e,t);if(r){return r}}return v(this.rightPoints,e,t)}else{return d(this.leftPoints,t)}};l.queryInterval=function(e,t,r){if(e<this.mid&&this.left){var a=this.left.queryInterval(e,t,r);if(a){return a}}if(t>this.mid&&this.right){var a=this.right.queryInterval(e,t,r);if(a){return a}}if(t<this.mid){return p(this.leftPoints,t,r)}else if(e>this.mid){return v(this.rightPoints,e,r)}else{return d(this.leftPoints,r)}};function m(e,t){return e-t}function g(e,t){var r=e[0]-t[0];if(r){return r}return e[1]-t[1]}function y(e,t){var r=e[1]-t[1];if(r){return r}return e[0]-t[0]}function x(e){if(e.length===0){return null}var t=[];for(var r=0;r<e.length;++r){t.push(e[r][0],e[r][1])}t.sort(m);var a=t[t.length>>1];var n=[];var i=[];var o=[];for(var r=0;r<e.length;++r){var l=e[r];if(l[1]<a){n.push(l)}else if(a<l[0]){i.push(l)}else{o.push(l)}}var u=o;var c=o.slice();u.sort(g);c.sort(y);return new s(a,x(n),x(i),u,c)}function b(e){this.root=e}var _=b.prototype;_.insert=function(e){if(this.root){this.root.insert(e)}else{this.root=new s(e[0],null,null,[e],[e])}};_.remove=function(e){if(this.root){var t=this.root.remove(e);if(t===o){this.root=null}return t!==n}return false};_.queryPoint=function(e,t){if(this.root){return this.root.queryPoint(e,t)}};_.queryInterval=function(e,t,r){if(e<=t&&this.root){return this.root.queryInterval(e,t,r)}};Object.defineProperty(_,"count",{get:function(){if(this.root){return this.root.count}return 0}});Object.defineProperty(_,"intervals",{get:function(){if(this.root){return this.root.intervals([])}return[]}});function w(e){if(!e||e.length===0){return new b(null)}return new b(x(e))}},{"binary-search-bounds":103}],441:[function(e,t,r){"use strict";function a(e){var t=new Array(e);for(var r=0;r<e;++r){t[r]=r}return t}t.exports=a},{}],442:[function(e,t,r){t.exports=true},{}],443:[function(e,t,r){t.exports=function(e){return e!=null&&(a(e)||n(e)||!!e._isBuffer)};function a(e){return!!e.constructor&&typeof e.constructor.isBuffer==="function"&&e.constructor.isBuffer(e)}function n(e){return typeof e.readFloatLE==="function"&&typeof e.slice==="function"&&a(e.slice(0,0))}},{}],444:[function(e,t,r){"use strict";t.exports=typeof navigator!=="undefined"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion))},{}],445:[function(e,t,r){"use strict";t.exports=i;t.exports.isMobile=i;t.exports.default=i;var a=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i;var n=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino|android|ipad|playbook|silk/i;function i(e){if(!e)e={};var t=e.ua;if(!t&&typeof navigator!=="undefined")t=navigator.userAgent;if(t&&t.headers&&typeof t.headers["user-agent"]==="string"){t=t.headers["user-agent"]}if(typeof t!=="string")return false;var r=e.tablet?n.test(t):a.test(t);if(!r&&e.tablet&&e.featureDetect&&navigator&&navigator.maxTouchPoints>1&&t.indexOf("Macintosh")!==-1&&t.indexOf("Safari")!==-1){r=true}return r}},{}],446:[function(e,t,r){"use strict";t.exports=function(e){var t=typeof e;return e!==null&&(t==="object"||t==="function")}},{}],447:[function(e,t,r){"use strict";var a=Object.prototype.toString;t.exports=function(e){var t;return a.call(e)==="[object Object]"&&(t=Object.getPrototypeOf(e),t===null||t===Object.getPrototypeOf({}))}},{}],448:[function(e,t,r){"use strict";t.exports=function(e){var t=e.length,r;for(var a=0;a<t;a++){r=e.charCodeAt(a);if((r<9||r>13)&&r!==32&&r!==133&&r!==160&&r!==5760&&r!==6158&&(r<8192||r>8205)&&r!==8232&&r!==8233&&r!==8239&&r!==8287&&r!==8288&&r!==12288&&r!==65279){return false}}return true}},{}],449:[function(e,t,r){"use strict";t.exports=function e(t){if(typeof t!=="string")return false;t=t.trim();if(/^[mzlhvcsqta]\s*[-+.0-9][^mlhvzcsqta]+/i.test(t)&&/[\dz]$/i.test(t)&&t.length>4)return true;return false}},{}],450:[function(e,t,r){function a(e,t,r){return e*(1-r)+t*r}t.exports=a},{}],451:[function(t,r,a){(function(t,n){typeof a==="object"&&typeof r!=="undefined"?r.exports=n():typeof e==="function"&&e.amd?e(n):(t=t||self,t.mapboxgl=n())})(this,(function(){"use strict";var e,t,r;function a(a,n){if(!e){e=n}else if(!t){t=n}else{var i="var sharedChunk = {}; ("+e+")(sharedChunk); ("+t+")(sharedChunk);";var o={};e(o);r=n(o);r.workerUrl=window.URL.createObjectURL(new Blob([i],{type:"text/javascript"}))}}a(["exports"],(function(e){"use strict";function t(e,t){return t={exports:{}},e(t,t.exports),t.exports}var r="1.10.1";var a=n;function n(e,t,r,a){this.cx=3*e;this.bx=3*(r-e)-this.cx;this.ax=1-this.cx-this.bx;this.cy=3*t;this.by=3*(a-t)-this.cy;this.ay=1-this.cy-this.by;this.p1x=e;this.p1y=a;this.p2x=r;this.p2y=a}n.prototype.sampleCurveX=function(e){return((this.ax*e+this.bx)*e+this.cx)*e};n.prototype.sampleCurveY=function(e){return((this.ay*e+this.by)*e+this.cy)*e};n.prototype.sampleCurveDerivativeX=function(e){return(3*this.ax*e+2*this.bx)*e+this.cx};n.prototype.solveCurveX=function(e,t){if(typeof t==="undefined"){t=1e-6}var r,a,n,i,o;for(n=e,o=0;o<8;o++){i=this.sampleCurveX(n)-e;if(Math.abs(i)<t){return n}var s=this.sampleCurveDerivativeX(n);if(Math.abs(s)<1e-6){break}n=n-i/s}r=0;a=1;n=e;if(n<r){return r}if(n>a){return a}while(r<a){i=this.sampleCurveX(n);if(Math.abs(i-e)<t){return n}if(e>i){r=n}else{a=n}n=(a-r)*.5+r}return n};n.prototype.solve=function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))};var i=o;function o(e,t){this.x=e;this.y=t}o.prototype={clone:function(){return new o(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(e,t){return this.clone()._rotateAround(e,t)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var t=e.x-this.x,r=e.y-this.y;return t*t+r*r},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult:function(e){var t=e[0]*this.x+e[1]*this.y,r=e[2]*this.x+e[3]*this.y;this.x=t;this.y=r;return this},_add:function(e){this.x+=e.x;this.y+=e.y;return this},_sub:function(e){this.x-=e.x;this.y-=e.y;return this},_mult:function(e){this.x*=e;this.y*=e;return this},_div:function(e){this.x/=e;this.y/=e;return this},_multByPoint:function(e){this.x*=e.x;this.y*=e.y;return this},_divByPoint:function(e){this.x/=e.x;this.y/=e.y;return this},_unit:function(){this._div(this.mag());return this},_perp:function(){var e=this.y;this.y=this.x;this.x=-e;return this},_rotate:function(e){var t=Math.cos(e),r=Math.sin(e),a=t*this.x-r*this.y,n=r*this.x+t*this.y;this.x=a;this.y=n;return this},_rotateAround:function(e,t){var r=Math.cos(e),a=Math.sin(e),n=t.x+r*(this.x-t.x)-a*(this.y-t.y),i=t.y+a*(this.x-t.x)+r*(this.y-t.y);this.x=n;this.y=i;return this},_round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);return this}};o.convert=function(e){if(e instanceof o){return e}if(Array.isArray(e)){return new o(e[0],e[1])}return e};function s(e,t){if(Array.isArray(e)){if(!Array.isArray(t)||e.length!==t.length){return false}for(var r=0;r<e.length;r++){if(!s(e[r],t[r])){return false}}return true}if(typeof e==="object"&&e!==null&&t!==null){if(!(typeof t==="object")){return false}var a=Object.keys(e);if(a.length!==Object.keys(t).length){return false}for(var n in e){if(!s(e[n],t[n])){return false}}return true}return e===t}function l(e){if(e<=0){return 0}if(e>=1){return 1}var t=e*e,r=t*e;return 4*(e<.5?r:3*(e-t)+r-.75)}function u(e,t,r,n){var i=new a(e,t,r,n);return function(e){return i.solve(e)}}var c=u(.25,.1,.25,1);function f(e,t,r){return Math.min(r,Math.max(t,e))}function h(e,t,r){var a=r-t;var n=((e-t)%a+a)%a+t;return n===t?r:n}function p(e,t,r){if(!e.length){return r(null,[])}var a=e.length;var n=new Array(e.length);var i=null;e.forEach((function(e,o){t(e,(function(e,t){if(e){i=e}n[o]=t;if(--a===0){r(i,n)}}))}))}function v(e){var t=[];for(var r in e){t.push(e[r])}return t}function d(e,t){var r=[];for(var a in e){if(!(a in t)){r.push(a)}}return r}function m(e){var t=[],r=arguments.length-1;while(r-- >0)t[r]=arguments[r+1];for(var a=0,n=t;a<n.length;a+=1){var i=n[a];for(var o in i){e[o]=i[o]}}return e}function g(e,t){var r={};for(var a=0;a<t.length;a++){var n=t[a];if(n in e){r[n]=e[n]}}return r}var y=1;function x(){return y++}function b(){function e(t){return t?(t^Math.random()*16>>t/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,e)}return e()}function _(e){return e?/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e):false}function w(e,t){e.forEach((function(e){if(!t[e]){return}t[e]=t[e].bind(t)}))}function T(e,t){return e.indexOf(t,e.length-t.length)!==-1}function k(e,t,r){var a={};for(var n in e){a[n]=t.call(r||this,e[n],n,e)}return a}function M(e,t,r){var a={};for(var n in e){if(t.call(r||this,e[n],n,e)){a[n]=e[n]}}return a}function A(e){if(Array.isArray(e)){return e.map(A)}else if(typeof e==="object"&&e){return k(e,A)}else{return e}}function S(e,t){for(var r=0;r<e.length;r++){if(t.indexOf(e[r])>=0){return true}}return false}var E={};function L(e){if(!E[e]){if(typeof console!=="undefined"){console.warn(e)}E[e]=true}}function C(e,t,r){return(r.y-e.y)*(t.x-e.x)>(t.y-e.y)*(r.x-e.x)}function I(e){var t=0;for(var r=0,a=e.length,n=a-1,i=void 0,o=void 0;r<a;n=r++){i=e[r];o=e[n];t+=(o.x-i.x)*(i.y+o.y)}return t}function P(e){var t=e[0];var r=e[1];var a=e[2];r+=90;r*=Math.PI/180;a*=Math.PI/180;return{x:t*Math.cos(r)*Math.sin(a),y:t*Math.sin(r)*Math.sin(a),z:t*Math.cos(a)}}function O(){return typeof WorkerGlobalScope!=="undefined"&&typeof self!=="undefined"&&self instanceof WorkerGlobalScope}function z(e){var t=/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g;var r={};e.replace(t,(function(e,t,a,n){var i=a||n;r[t]=i?i.toLowerCase():true;return""}));if(r["max-age"]){var a=parseInt(r["max-age"],10);if(isNaN(a)){delete r["max-age"]}else{r["max-age"]=a}}return r}var D=null;function R(e){if(D==null){var t=e.navigator?e.navigator.userAgent:null;D=!!e.safari||!!(t&&(/\b(iPad|iPhone|iPod)\b/.test(t)||!!t.match("Safari")&&!t.match("Chrome")))}return D}function F(e){try{var t=self[e];t.setItem("_mapbox_test_",1);t.removeItem("_mapbox_test_");return true}catch(r){return false}}function B(e){return self.btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,(function(e,t){return String.fromCharCode(Number("0x"+t))})))}function N(e){return decodeURIComponent(self.atob(e).split("").map((function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)})).join(""))}var j=self.performance&&self.performance.now?self.performance.now.bind(self.performance):Date.now.bind(Date);var U=self.requestAnimationFrame||self.mozRequestAnimationFrame||self.webkitRequestAnimationFrame||self.msRequestAnimationFrame;var V=self.cancelAnimationFrame||self.mozCancelAnimationFrame||self.webkitCancelAnimationFrame||self.msCancelAnimationFrame;var H;var q;var G={now:j,frame:function e(t){var e=U(t);return{cancel:function(){return V(e)}}},getImageData:function e(t,r){if(r===void 0)r=0;var a=self.document.createElement("canvas");var n=a.getContext("2d");if(!n){throw new Error("failed to create canvas 2d context")}a.width=t.width;a.height=t.height;n.drawImage(t,0,0,t.width,t.height);return n.getImageData(-r,-r,t.width+2*r,t.height+2*r)},resolveURL:function e(t){if(!H){H=self.document.createElement("a")}H.href=t;return H.href},hardwareConcurrency:self.navigator.hardwareConcurrency||4,get devicePixelRatio(){return self.devicePixelRatio},get prefersReducedMotion(){if(!self.matchMedia){return false}if(q==null){q=self.matchMedia("(prefers-reduced-motion: reduce)")}return q.matches}};var Y={API_URL:"https://api.mapbox.com",get EVENTS_URL(){if(!this.API_URL){return null}if(this.API_URL.indexOf("https://api.mapbox.cn")===0){return"https://events.mapbox.cn/events/v2"}else if(this.API_URL.indexOf("https://api.mapbox.com")===0){return"https://events.mapbox.com/events/v2"}else{return null}},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:true,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16};var W={supported:false,testSupport:Q};var X;var Z=false;var J;var K=false;if(self.document){J=self.document.createElement("img");J.onload=function(){if(X){$(X)}X=null;K=true};J.onerror=function(){Z=true;X=null};J.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="}function Q(e){if(Z||!J){return}if(K){$(e)}else{X=e}}function $(e){var t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t);try{e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,J);if(e.isContextLost()){return}W.supported=true}catch(r){}e.deleteTexture(t);Z=true}var ee="01";function te(){var e="1";var t="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";var r="";for(var a=0;a<10;a++){r+=t[Math.floor(Math.random()*62)]}var n=12*60*60*1e3;var i=[e,ee,r].join("");var o=Date.now()+n;return{token:i,tokenExpiresAt:o}}var re=function e(t,r){this._transformRequestFn=t;this._customAccessToken=r;this._createSkuToken()};re.prototype._createSkuToken=function e(){var t=te();this._skuToken=t.token;this._skuTokenExpiresAt=t.tokenExpiresAt};re.prototype._isSkuTokenExpired=function e(){return Date.now()>this._skuTokenExpiresAt};re.prototype.transformRequest=function e(t,r){if(this._transformRequestFn){return this._transformRequestFn(t,r)||{url:t}}return{url:t}};re.prototype.normalizeStyleURL=function e(t,r){if(!ae(t)){return t}var a=ue(t);a.path="/styles/v1"+a.path;return this._makeAPIURL(a,this._customAccessToken||r)};re.prototype.normalizeGlyphsURL=function e(t,r){if(!ae(t)){return t}var a=ue(t);a.path="/fonts/v1"+a.path;return this._makeAPIURL(a,this._customAccessToken||r)};re.prototype.normalizeSourceURL=function e(t,r){if(!ae(t)){return t}var a=ue(t);a.path="/v4/"+a.authority+".json";a.params.push("secure");return this._makeAPIURL(a,this._customAccessToken||r)};re.prototype.normalizeSpriteURL=function e(t,r,a,n){var i=ue(t);if(!ae(t)){i.path+=""+r+a;return ce(i)}i.path="/styles/v1"+i.path+"/sprite"+r+a;return this._makeAPIURL(i,this._customAccessToken||n)};re.prototype.normalizeTileURL=function e(t,r){if(this._isSkuTokenExpired()){this._createSkuToken()}if(t&&!ae(t)){return t}var a=ue(t);var n=/(\.(png|jpg)\d*)(?=$)/;var i=/^.+\/v4\//;var o=G.devicePixelRatio>=2||r===512?"@2x":"";var s=W.supported?".webp":"$1";a.path=a.path.replace(n,""+o+s);a.path=a.path.replace(i,"/");a.path="/v4"+a.path;var l=this._customAccessToken||se(a.params)||Y.ACCESS_TOKEN;if(Y.REQUIRE_ACCESS_TOKEN&&l&&this._skuToken){a.params.push("sku="+this._skuToken)}return this._makeAPIURL(a,l)};re.prototype.canonicalizeTileURL=function e(t,r){var a="/v4/";var n=/\.[\w]+$/;var i=ue(t);if(!i.path.match(/(^\/v4\/)/)||!i.path.match(n)){return t}var o="mapbox://tiles/";o+=i.path.replace(a,"");var s=i.params;if(r){s=s.filter((function(e){return!e.match(/^access_token=/)}))}if(s.length){o+="?"+s.join("&")}return o};re.prototype.canonicalizeTileset=function e(t,r){var a=r?ae(r):false;var n=[];for(var i=0,o=t.tiles||[];i<o.length;i+=1){var s=o[i];if(ie(s)){n.push(this.canonicalizeTileURL(s,a))}else{n.push(s)}}return n};re.prototype._makeAPIURL=function e(t,r){var a="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes";var n=ue(Y.API_URL);t.protocol=n.protocol;t.authority=n.authority;if(n.path!=="/"){t.path=""+n.path+t.path}if(!Y.REQUIRE_ACCESS_TOKEN){return ce(t)}r=r||Y.ACCESS_TOKEN;if(!r){throw new Error("An API access token is required to use Mapbox GL. "+a)}if(r[0]==="s"){throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+a)}t.params=t.params.filter((function(e){return e.indexOf("access_token")===-1}));t.params.push("access_token="+r);return ce(t)};function ae(e){return e.indexOf("mapbox:")===0}var ne=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function ie(e){return ne.test(e)}function oe(e){return e.indexOf("sku=")>0&&ie(e)}function se(e){for(var t=0,r=e;t<r.length;t+=1){var a=r[t];var n=a.match(/^access_token=(.*)$/);if(n){return n[1]}}return null}var le=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function ue(e){var t=e.match(le);if(!t){throw new Error("Unable to parse URL object")}return{protocol:t[1],authority:t[2],path:t[3]||"/",params:t[4]?t[4].split("&"):[]}}function ce(e){var t=e.params.length?"?"+e.params.join("&"):"";return e.protocol+"://"+e.authority+e.path+t}var fe="mapbox.eventData";function he(e){if(!e){return null}var t=e.split(".");if(!t||t.length!==3){return null}try{var r=JSON.parse(N(t[1]));return r}catch(a){return null}}var pe=function e(t){this.type=t;this.anonId=null;this.eventData={};this.queue=[];this.pendingRequest=null};pe.prototype.getStorageKey=function e(t){var r=he(Y.ACCESS_TOKEN);var a="";if(r&&r["u"]){a=B(r["u"])}else{a=Y.ACCESS_TOKEN||""}return t?fe+"."+t+":"+a:fe+":"+a};pe.prototype.fetchEventData=function e(){var t=F("localStorage");var r=this.getStorageKey();var a=this.getStorageKey("uuid");if(t){try{var n=self.localStorage.getItem(r);if(n){this.eventData=JSON.parse(n)}var i=self.localStorage.getItem(a);if(i){this.anonId=i}}catch(o){L("Unable to read from LocalStorage")}}};pe.prototype.saveEventData=function e(){var t=F("localStorage");var r=this.getStorageKey();var a=this.getStorageKey("uuid");if(t){try{self.localStorage.setItem(a,this.anonId);if(Object.keys(this.eventData).length>=1){self.localStorage.setItem(r,JSON.stringify(this.eventData))}}catch(n){L("Unable to write to LocalStorage")}}};pe.prototype.processRequests=function e(t){};pe.prototype.postEvent=function e(t,a,n,i){var o=this;if(!Y.EVENTS_URL){return}var s=ue(Y.EVENTS_URL);s.params.push("access_token="+(i||Y.ACCESS_TOKEN||""));var l={event:this.type,created:new Date(t).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:r,skuId:ee,userId:this.anonId};var u=a?m(l,a):l;var c={url:ce(s),headers:{"Content-Type":"text/plain"},body:JSON.stringify([u])};this.pendingRequest=Xe(c,(function(e){o.pendingRequest=null;n(e);o.saveEventData();o.processRequests(i)}))};pe.prototype.queueRequest=function e(t,r){this.queue.push(t);this.processRequests(r)};var ve=function(e){function t(){e.call(this,"map.load");this.success={};this.skuToken=""}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype.postMapLoadEvent=function e(t,r,a,n){this.skuToken=a;if(Y.EVENTS_URL&&n||Y.ACCESS_TOKEN&&Array.isArray(t)&&t.some((function(e){return ae(e)||ie(e)}))){this.queueRequest({id:r,timestamp:Date.now()},n)}};t.prototype.processRequests=function e(t){var r=this;if(this.pendingRequest||this.queue.length===0){return}var a=this.queue.shift();var n=a.id;var i=a.timestamp;if(n&&this.success[n]){return}if(!this.anonId){this.fetchEventData()}if(!_(this.anonId)){this.anonId=b()}this.postEvent(i,{skuToken:this.skuToken},(function(e){if(!e){if(n){r.success[n]=true}}}),t)};return t}(pe);var de=function(e){function t(t){e.call(this,"appUserTurnstile");this._customAccessToken=t}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype.postTurnstileEvent=function e(t,r){if(Y.EVENTS_URL&&Y.ACCESS_TOKEN&&Array.isArray(t)&&t.some((function(e){return ae(e)||ie(e)}))){this.queueRequest(Date.now(),r)}};t.prototype.processRequests=function e(t){var r=this;if(this.pendingRequest||this.queue.length===0){return}if(!this.anonId||!this.eventData.lastSuccess||!this.eventData.tokenU){this.fetchEventData()}var a=he(Y.ACCESS_TOKEN);var n=a?a["u"]:Y.ACCESS_TOKEN;var i=n!==this.eventData.tokenU;if(!_(this.anonId)){this.anonId=b();i=true}var o=this.queue.shift();if(this.eventData.lastSuccess){var s=new Date(this.eventData.lastSuccess);var l=new Date(o);var u=(o-this.eventData.lastSuccess)/(24*60*60*1e3);i=i||u>=1||u<-1||s.getDate()!==l.getDate()}else{i=true}if(!i){return this.processRequests()}this.postEvent(o,{"enabled.telemetry":false},(function(e){if(!e){r.eventData.lastSuccess=o;r.eventData.tokenU=n}}),t)};return t}(pe);var me=new de;var ge=me.postTurnstileEvent.bind(me);var ye=new ve;var xe=ye.postMapLoadEvent.bind(ye);var be="mapbox-tiles";var _e=500;var we=50;var Te=1e3*60*7;var ke;function Me(){if(self.caches&&!ke){ke=self.caches.open(be)}}var Ae;function Se(e,t){if(Ae===undefined){try{new Response(new ReadableStream);Ae=true}catch(r){Ae=false}}if(Ae){t(e.body)}else{e.blob().then(t)}}function Ee(e,t,r){Me();if(!ke){return}var a={status:t.status,statusText:t.statusText,headers:new self.Headers};t.headers.forEach((function(e,t){return a.headers.set(t,e)}));var n=z(t.headers.get("Cache-Control")||"");if(n["no-store"]){return}if(n["max-age"]){a.headers.set("Expires",new Date(r+n["max-age"]*1e3).toUTCString())}var i=new Date(a.headers.get("Expires")).getTime()-r;if(i<Te){return}Se(t,(function(t){var r=new self.Response(t,a);Me();if(!ke){return}ke.then((function(t){return t.put(Le(e.url),r)})).catch((function(e){return L(e.message)}))}))}function Le(e){var t=e.indexOf("?");return t<0?e:e.slice(0,t)}function Ce(e,t){Me();if(!ke){return t(null)}var r=Le(e.url);ke.then((function(e){e.match(r).then((function(a){var n=Ie(a);e.delete(r);if(n){e.put(r,a.clone())}t(null,a,n)})).catch(t)})).catch(t)}function Ie(e){if(!e){return false}var t=new Date(e.headers.get("Expires")||0);var r=z(e.headers.get("Cache-Control")||"");return t>Date.now()&&!r["no-cache"]}var Pe=Infinity;function Oe(e){Pe++;if(Pe>we){e.getActor().send("enforceCacheSizeLimit",_e);Pe=0}}function ze(e){Me();if(!ke){return}ke.then((function(t){t.keys().then((function(r){for(var a=0;a<r.length-e;a++){t.delete(r[a])}}))}))}function De(e){var t=self.caches.delete(be);if(e){t.catch(e).then((function(){return e()}))}}function Re(e,t){_e=e;we=t}var Fe;function Be(){if(Fe==null){Fe=self.OffscreenCanvas&&new self.OffscreenCanvas(1,1).getContext("2d")&&typeof self.createImageBitmap==="function"}return Fe}var Ne={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};if(typeof Object.freeze=="function"){Object.freeze(Ne)}var je=function(e){function t(t,r,a){if(r===401&&ie(a)){t+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"}e.call(this,t);this.status=r;this.url=a;this.name=this.constructor.name;this.message=t}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype.toString=function e(){return this.name+": "+this.message+" ("+this.status+"): "+this.url};return t}(Error);var Ue=O()?function(){return self.worker&&self.worker.referrer}:function(){return(self.location.protocol==="blob:"?self.parent:self).location.href};var Ve=function(e){return/^file:/.test(e)||/^file:/.test(Ue())&&!/^\w+:/.test(e)};function He(e,t){var r=new self.AbortController;var a=new self.Request(e.url,{method:e.method||"GET",body:e.body,credentials:e.credentials,headers:e.headers,referrer:Ue(),signal:r.signal});var n=false;var i=false;var o=oe(a.url);if(e.type==="json"){a.headers.set("Accept","application/json")}var s=function(r,n,s){if(i){return}if(r){if(r.message!=="SecurityError"){L(r)}}if(n&&s){return l(n)}var u=Date.now();self.fetch(a).then((function(r){if(r.ok){var a=o?r.clone():null;return l(r,a,u)}else{return t(new je(r.statusText,r.status,e.url))}})).catch((function(e){if(e.code===20){return}t(new Error(e.message))}))};var l=function(r,o,s){(e.type==="arrayBuffer"?r.arrayBuffer():e.type==="json"?r.json():r.text()).then((function(e){if(i){return}if(o&&s){Ee(a,o,s)}n=true;t(null,e,r.headers.get("Cache-Control"),r.headers.get("Expires"))})).catch((function(e){if(!i){t(new Error(e.message))}}))};if(o){Ce(a,s)}else{s(null,null)}return{cancel:function(){i=true;if(!n){r.abort()}}}}function qe(e,t){var r=new self.XMLHttpRequest;r.open(e.method||"GET",e.url,true);if(e.type==="arrayBuffer"){r.responseType="arraybuffer"}for(var a in e.headers){r.setRequestHeader(a,e.headers[a])}if(e.type==="json"){r.responseType="text";r.setRequestHeader("Accept","application/json")}r.withCredentials=e.credentials==="include";r.onerror=function(){t(new Error(r.statusText))};r.onload=function(){if((r.status>=200&&r.status<300||r.status===0)&&r.response!==null){var a=r.response;if(e.type==="json"){try{a=JSON.parse(r.response)}catch(n){return t(n)}}t(null,a,r.getResponseHeader("Cache-Control"),r.getResponseHeader("Expires"))}else{t(new je(r.statusText,r.status,e.url))}};r.send(e.body);return{cancel:function(){return r.abort()}}}var Ge=function(e,t){if(!Ve(e.url)){if(self.fetch&&self.Request&&self.AbortController&&self.Request.prototype.hasOwnProperty("signal")){return He(e,t)}if(O()&&self.worker&&self.worker.actor){var r=true;return self.worker.actor.send("getResource",e,t,undefined,r)}}return qe(e,t)};var Ye=function(e,t){return Ge(m(e,{type:"json"}),t)};var We=function(e,t){return Ge(m(e,{type:"arrayBuffer"}),t)};var Xe=function(e,t){return Ge(m(e,{method:"POST"}),t)};function Ze(e){var t=self.document.createElement("a");t.href=e;return t.protocol===self.document.location.protocol&&t.host===self.document.location.host}var Je="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function Ke(e,t,r,a){var n=new self.Image;var i=self.URL;n.onload=function(){t(null,n);i.revokeObjectURL(n.src)};n.onerror=function(){return t(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var o=new self.Blob([new Uint8Array(e)],{type:"image/png"});n.cacheControl=r;n.expires=a;n.src=e.byteLength?i.createObjectURL(o):Je}function Qe(e,t){var r=new self.Blob([new Uint8Array(e)],{type:"image/png"});self.createImageBitmap(r).then((function(e){t(null,e)})).catch((function(e){t(new Error("Could not load image because of "+e.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))}))}var $e,et;var tt=function(){$e=[];et=0};tt();var rt=function(e,t){if(W.supported){if(!e.headers){e.headers={}}e.headers.accept="image/webp,*/*"}if(et>=Y.MAX_PARALLEL_IMAGE_REQUESTS){var r={requestParameters:e,callback:t,cancelled:false,cancel:function e(){this.cancelled=true}};$e.push(r);return r}et++;var a=false;var n=function(){if(a){return}a=true;et--;while($e.length&&et<Y.MAX_PARALLEL_IMAGE_REQUESTS){var e=$e.shift();var t=e.requestParameters;var r=e.callback;var n=e.cancelled;if(!n){e.cancel=rt(t,r).cancel}}};var i=We(e,(function(e,r,a,i){n();if(e){t(e)}else if(r){if(Be()){Qe(r,t)}else{Ke(r,t,a,i)}}}));return{cancel:function(){i.cancel();n()}}};var at=function(e,t){var r=self.document.createElement("video");r.muted=true;r.onloadstart=function(){t(null,r)};for(var a=0;a<e.length;a++){var n=self.document.createElement("source");if(!Ze(e[a])){r.crossOrigin="Anonymous"}n.src=e[a];r.appendChild(n)}return{cancel:function(){}}};function nt(e,t,r){var a=r[e]&&r[e].indexOf(t)!==-1;if(!a){r[e]=r[e]||[];r[e].push(t)}}function it(e,t,r){if(r&&r[e]){var a=r[e].indexOf(t);if(a!==-1){r[e].splice(a,1)}}}var ot=function e(t,r){if(r===void 0)r={};m(this,r);this.type=t};var st=function(e){function t(t,r){if(r===void 0)r={};e.call(this,"error",m({error:t},r))}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;return t}(ot);var lt=function e(){};lt.prototype.on=function e(t,r){this._listeners=this._listeners||{};nt(t,r,this._listeners);return this};lt.prototype.off=function e(t,r){it(t,r,this._listeners);it(t,r,this._oneTimeListeners);return this};lt.prototype.once=function e(t,r){this._oneTimeListeners=this._oneTimeListeners||{};nt(t,r,this._oneTimeListeners);return this};lt.prototype.fire=function e(t,r){if(typeof t==="string"){t=new ot(t,r||{})}var a=t.type;if(this.listens(a)){t.target=this;var n=this._listeners&&this._listeners[a]?this._listeners[a].slice():[];for(var i=0,o=n;i<o.length;i+=1){var s=o[i];s.call(this,t)}var l=this._oneTimeListeners&&this._oneTimeListeners[a]?this._oneTimeListeners[a].slice():[];for(var u=0,c=l;u<c.length;u+=1){var f=c[u];it(a,f,this._oneTimeListeners);f.call(this,t)}var h=this._eventedParent;if(h){m(t,typeof this._eventedParentData==="function"?this._eventedParentData():this._eventedParentData);h.fire(t)}}else if(t instanceof st){console.error(t.error)}return this};lt.prototype.listens=function e(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)};lt.prototype.setEventedParent=function e(t,r){this._eventedParent=t;this._eventedParentData=r;return this};var ut=8;var ct={version:{required:true,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:true,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:true,type:"array",value:"layer"}};var ft={"*":{type:"source"}};var ht=["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"];var pt={type:{required:true,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},"*":{type:"*"}};var vt={type:{required:true,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},"*":{type:"*"}};var dt={type:{required:true,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},"*":{type:"*"}};var mt={type:{required:true,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:false},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:false},generateId:{type:"boolean",default:false},promoteId:{type:"promoteId"}};var gt={type:{required:true,type:"enum",values:{video:{}}},urls:{required:true,type:"array",value:"string"},coordinates:{required:true,type:"array",length:4,value:{type:"array",length:2,value:"number"}}};var yt={type:{required:true,type:"enum",values:{image:{}}},url:{required:true,type:"string"},coordinates:{required:true,type:"array",length:4,value:{type:"array",length:2,value:"number"}}};var xt={id:{type:"string",required:true},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:true},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}};var bt=["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"];var _t={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}};var wt={"fill-sort-key":{type:"number",expression:{interpolated:false,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}};var Tt={"circle-sort-key":{type:"number",expression:{interpolated:false,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}};var kt={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}};var Mt={"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:false,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:false,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:true,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:true,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:false,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}};var At={"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:false,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:true,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:false,expression:{interpolated:false,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:false,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:false,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:false,requires:["icon-image"],expression:{interpolated:false,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:false,requires:["icon-image"],expression:{interpolated:false,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:false,requires:["icon-image","text-field"],expression:{interpolated:false,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:false,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:true,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:false,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:true,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:true,expression:{interpolated:false,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:true,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:true,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:false,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:false,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:true,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:false,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:false,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:false,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:false,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:true,expression:{interpolated:false,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:false,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:true,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:true,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:true,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:true,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:false,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:true,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:false,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:false,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:true,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:false,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:true,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:true,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:true,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:false,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:false,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:true,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:false,requires:["text-field"],expression:{interpolated:false,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:false,requires:["text-field"],expression:{interpolated:false,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:false,requires:["text-field","icon-image"],expression:{interpolated:false,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}};var St={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}};var Et={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}};var Lt={type:"array",value:"*"};var Ct={type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}};var It={type:"enum",values:{Point:{},LineString:{},Polygon:{}}};var Pt={type:"array",minimum:0,maximum:24,value:["number","color"],length:2};var Ot={type:"array",value:"*",minimum:1};var zt={type:"enum",values:{let:{group:"Variable binding"},var:{group:"Variable binding"},literal:{group:"Types"},array:{group:"Types"},at:{group:"Lookup"},in:{group:"Lookup"},"index-of":{group:"Lookup"},slice:{group:"Lookup"},case:{group:"Decision"},match:{group:"Decision"},coalesce:{group:"Decision"},step:{group:"Ramps, scales, curves"},interpolate:{group:"Ramps, scales, curves"},"interpolate-hcl":{group:"Ramps, scales, curves"},"interpolate-lab":{group:"Ramps, scales, curves"},ln2:{group:"Math"},pi:{group:"Math"},e:{group:"Math"},typeof:{group:"Types"},string:{group:"Types"},number:{group:"Types"},boolean:{group:"Types"},object:{group:"Types"},collator:{group:"Types"},format:{group:"Types"},image:{group:"Types"},"number-format":{group:"Types"},"to-string":{group:"Types"},"to-number":{group:"Types"},"to-boolean":{group:"Types"},"to-rgba":{group:"Color"},"to-color":{group:"Types"},rgb:{group:"Color"},rgba:{group:"Color"},get:{group:"Lookup"},has:{group:"Lookup"},length:{group:"Lookup"},properties:{group:"Feature data"},"feature-state":{group:"Feature data"},"geometry-type":{group:"Feature data"},id:{group:"Feature data"},zoom:{group:"Zoom"},"heatmap-density":{group:"Heatmap"},"line-progress":{group:"Feature data"},accumulated:{group:"Feature data"},"+":{group:"Math"},"*":{group:"Math"},"-":{group:"Math"},"/":{group:"Math"},"%":{group:"Math"},"^":{group:"Math"},sqrt:{group:"Math"},log10:{group:"Math"},ln:{group:"Math"},log2:{group:"Math"},sin:{group:"Math"},cos:{group:"Math"},tan:{group:"Math"},asin:{group:"Math"},acos:{group:"Math"},atan:{group:"Math"},min:{group:"Math"},max:{group:"Math"},round:{group:"Math"},abs:{group:"Math"},ceil:{group:"Math"},floor:{group:"Math"},distance:{group:"Math"},"==":{group:"Decision"},"!=":{group:"Decision"},">":{group:"Decision"},"<":{group:"Decision"},">=":{group:"Decision"},"<=":{group:"Decision"},all:{group:"Decision"},any:{group:"Decision"},"!":{group:"Decision"},within:{group:"Decision"},"is-supported-script":{group:"String"},upcase:{group:"String"},downcase:{group:"String"},concat:{group:"String"},"resolved-locale":{group:"String"}}};var Dt={anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:false,expression:{interpolated:false,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:true,expression:{interpolated:true,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:true,parameters:["zoom"]},transition:true},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:true,parameters:["zoom"]},transition:true}};var Rt=["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"];var Ft={"fill-antialias":{type:"boolean",default:true,expression:{interpolated:false,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:true,expression:{interpolated:true,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:true,requires:[{"!":"fill-pattern"}],expression:{interpolated:true,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:true,requires:[{"!":"fill-pattern"},{"fill-antialias":true}],expression:{interpolated:true,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:true,units:"pixels",expression:{interpolated:true,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:false,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:true,expression:{interpolated:false,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}};var Bt={"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:true,expression:{interpolated:true,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:true,requires:[{"!":"line-pattern"}],expression:{interpolated:true,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:true,units:"pixels",expression:{interpolated:true,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:false,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:true,units:"pixels",expression:{interpolated:true,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:true,units:"pixels",expression:{interpolated:true,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:true,units:"pixels",expression:{interpolated:true,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:true,units:"pixels",expression:{interpolated:true,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:true,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:false,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:true,expression:{interpolated:false,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:false,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:true}}],expression:{interpolated:true,parameters:["line-progress"]},"property-type":"color-ramp"}};var Nt={"circle-radius":{type:"number",default:5,minimum:0,transition:true,units:"pixels",expression:{interpolated:true,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:true,expression:{interpolated:true,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:true,expression:{interpolated:true,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:true,expression:{interpolated:true,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:true,units:"pixels",expression:{interpolated:true,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:false,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:false,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:false,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:true,units:"pixels",expression:{interpolated:true,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:true,expression:{interpolated:true,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:true,expression:{interpolated:true,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}};var jt={"heatmap-radius":{type:"number",default:30,minimum:1,transition:true,units:"pixels",expression:{interpolated:true,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:false,expression:{interpolated:true,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:true,expression:{interpolated:true,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:false,expression:{interpolated:true,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:true,expression:{interpolated:true,parameters:["zoom"]},"property-type":"data-constant"}};var Ut={"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:true,requires:["icon-image"],expression:{interpolated:true,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:true,requires:["icon-image"],expression:{interpolated:true,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:true,requires:["icon-image"],expression:{interpolated:true,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:true,units:"pixels",requires:["icon-image"],expression:{interpolated:true,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:true,units:"pixels",requires:["icon-image"],expression:{interpolated:true,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:true,units:"pixels",requires:["icon-image"],expression:{interpolated:true,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:false,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:true,requires:["text-field"],expression:{interpolated:true,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:true,overridable:true,requires:["text-field"],expression:{interpolated:true,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:true,requires:["text-field"],expression:{interpolated:true,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:true,units:"pixels",requires:["text-field"],expression:{interpolated:true,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:true,units:"pixels",requires:["text-field"],expression:{interpolated:true,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:true,units:"pixels",requires:["text-field"],expression:{interpolated:true,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:false,parameters:["zoom"]},"property-type":"data-constant"}};var Vt={"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:true,expression:{interpolated:true,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:true,units:"degrees",expression:{interpolated:true,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:true,expression:{interpolated:true,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:true,expression:{interpolated:true,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:true,expression:{interpolated:true,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:true,expression:{interpolated:true,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:false,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:false,units:"milliseconds",expression:{interpolated:true,parameters:["zoom"]},"property-type":"data-constant"}};var Ht={"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:false,expression:{interpolated:true,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:false,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:true,expression:{interpolated:true,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:true,expression:{interpolated:true,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:true,expression:{interpolated:true,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:true,expression:{interpolated:true,parameters:["zoom"]},"property-type":"data-constant"}};var qt={"background-color":{type:"color",default:"#000000",transition:true,requires:[{"!":"background-pattern"}],expression:{interpolated:true,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:true,expression:{interpolated:false,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:true,expression:{interpolated:true,parameters:["zoom"]},"property-type":"data-constant"}};var Gt={duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}};var Yt={"*":{type:"string"}};var Wt={$version:ut,$root:ct,sources:ft,source:ht,source_vector:pt,source_raster:vt,source_raster_dem:dt,source_geojson:mt,source_video:gt,source_image:yt,layer:xt,layout:bt,layout_background:_t,layout_fill:wt,layout_circle:Tt,layout_heatmap:kt,"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:Mt,layout_symbol:At,layout_raster:St,layout_hillshade:Et,filter:Lt,filter_operator:Ct,geometry_type:It,function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:false}},function_stop:Pt,expression:Ot,expression_name:zt,light:Dt,paint:Rt,paint_fill:Ft,"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:true,expression:{interpolated:true,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:true,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:true,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:true,units:"pixels",expression:{interpolated:true,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:false,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:true,expression:{interpolated:false,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:true,expression:{interpolated:true,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:true,requires:["fill-extrusion-height"],expression:{interpolated:true,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:true,transition:false,expression:{interpolated:false,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:Bt,paint_circle:Nt,paint_heatmap:jt,paint_symbol:Ut,paint_raster:Vt,paint_hillshade:Ht,paint_background:qt,transition:Gt,"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:Yt};var Xt=function e(t,r,a,n){this.message=(t?t+": ":"")+a;if(n){this.identifier=n}if(r!==null&&r!==undefined&&r.__line__){this.line=r.__line__}};function Zt(e){var t=e.key;var r=e.value;if(r){return[new Xt(t,r,"constants have been deprecated as of v8")]}else{return[]}}function Jt(e){var t=[],r=arguments.length-1;while(r-- >0)t[r]=arguments[r+1];for(var a=0,n=t;a<n.length;a+=1){var i=n[a];for(var o in i){e[o]=i[o]}}return e}function Kt(e){if(e instanceof Number||e instanceof String||e instanceof Boolean){return e.valueOf()}else{return e}}function Qt(e){if(Array.isArray(e)){return e.map(Qt)}else if(e instanceof Object&&!(e instanceof Number||e instanceof String||e instanceof Boolean)){var t={};for(var r in e){t[r]=Qt(e[r])}return t}return Kt(e)}var $t=function(e){function t(t,r){e.call(this,r);this.message=r;this.key=t}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;return t}(Error);var er=function e(t,r){if(r===void 0)r=[];this.parent=t;this.bindings={};for(var a=0,n=r;a<n.length;a+=1){var i=n[a];var o=i[0];var s=i[1];this.bindings[o]=s}};er.prototype.concat=function e(t){return new er(this,t)};er.prototype.get=function e(t){if(this.bindings[t]){return this.bindings[t]}if(this.parent){return this.parent.get(t)}throw new Error(t+" not found in scope.")};er.prototype.has=function e(t){if(this.bindings[t]){return true}return this.parent?this.parent.has(t):false};var tr={kind:"null"};var rr={kind:"number"};var ar={kind:"string"};var nr={kind:"boolean"};var ir={kind:"color"};var or={kind:"object"};var sr={kind:"value"};var lr={kind:"error"};var ur={kind:"collator"};var cr={kind:"formatted"};var fr={kind:"resolvedImage"};function hr(e,t){return{kind:"array",itemType:e,N:t}}function pr(e){if(e.kind==="array"){var t=pr(e.itemType);return typeof e.N==="number"?"array<"+t+", "+e.N+">":e.itemType.kind==="value"?"array":"array<"+t+">"}else{return e.kind}}var vr=[tr,rr,ar,nr,ir,cr,or,hr(sr),fr];function dr(e,t){if(t.kind==="error"){return null}else if(e.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!dr(e.itemType,t.itemType))&&(typeof e.N!=="number"||e.N===t.N)){return null}}else if(e.kind===t.kind){return null}else if(e.kind==="value"){for(var r=0,a=vr;r<a.length;r+=1){var n=a[r];if(!dr(n,t)){return null}}}return"Expected "+pr(e)+" but found "+pr(t)+" instead."}function mr(e,t){return t.some((function(t){return t.kind===e.kind}))}function gr(e,t){return t.some((function(t){if(t==="null"){return e===null}else if(t==="array"){return Array.isArray(e)}else if(t==="object"){return e&&!Array.isArray(e)&&typeof e==="object"}else{return t===typeof e}}))}var yr=t((function(e,t){var r={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function a(e){e=Math.round(e);return e<0?0:e>255?255:e}function n(e){return e<0?0:e>1?1:e}function i(e){if(e[e.length-1]==="%"){return a(parseFloat(e)/100*255)}return a(parseInt(e))}function o(e){if(e[e.length-1]==="%"){return n(parseFloat(e)/100)}return n(parseFloat(e))}function s(e,t,r){if(r<0){r+=1}else if(r>1){r-=1}if(r*6<1){return e+(t-e)*r*6}if(r*2<1){return t}if(r*3<2){return e+(t-e)*(2/3-r)*6}return e}function l(e){var t=e.replace(/ /g,"").toLowerCase();if(t in r){return r[t].slice()}if(t[0]==="#"){if(t.length===4){var n=parseInt(t.substr(1),16);if(!(n>=0&&n<=4095)){return null}return[(n&3840)>>4|(n&3840)>>8,n&240|(n&240)>>4,n&15|(n&15)<<4,1]}else if(t.length===7){var n=parseInt(t.substr(1),16);if(!(n>=0&&n<=16777215)){return null}return[(n&16711680)>>16,(n&65280)>>8,n&255,1]}return null}var l=t.indexOf("("),u=t.indexOf(")");if(l!==-1&&u+1===t.length){var c=t.substr(0,l);var f=t.substr(l+1,u-(l+1)).split(",");var h=1;switch(c){case"rgba":if(f.length!==4){return null}h=o(f.pop());case"rgb":if(f.length!==3){return null}return[i(f[0]),i(f[1]),i(f[2]),h];case"hsla":if(f.length!==4){return null}h=o(f.pop());case"hsl":if(f.length!==3){return null}var p=(parseFloat(f[0])%360+360)%360/360;var v=o(f[1]);var d=o(f[2]);var m=d<=.5?d*(v+1):d+v-d*v;var g=d*2-m;return[a(s(g,m,p+1/3)*255),a(s(g,m,p)*255),a(s(g,m,p-1/3)*255),h];default:return null}}return null}try{t.parseCSSColor=l}catch(u){}}));var xr=yr.parseCSSColor;var br=function e(t,r,a,n){if(n===void 0)n=1;this.r=t;this.g=r;this.b=a;this.a=n};br.parse=function e(t){if(!t){return undefined}if(t instanceof br){return t}if(typeof t!=="string"){return undefined}var r=xr(t);if(!r){return undefined}return new br(r[0]/255*r[3],r[1]/255*r[3],r[2]/255*r[3],r[3])};br.prototype.toString=function e(){var t=this.toArray();var r=t[0];var a=t[1];var n=t[2];var i=t[3];return"rgba("+Math.round(r)+","+Math.round(a)+","+Math.round(n)+","+i+")"};br.prototype.toArray=function e(){var t=this;var r=t.r;var a=t.g;var n=t.b;var i=t.a;return i===0?[0,0,0,0]:[r*255/i,a*255/i,n*255/i,i]};br.black=new br(0,0,0,1);br.white=new br(1,1,1,1);br.transparent=new br(0,0,0,0);br.red=new br(1,0,0,1);var _r=function e(t,r,a){if(t){this.sensitivity=r?"variant":"case"}else{this.sensitivity=r?"accent":"base"}this.locale=a;this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};_r.prototype.compare=function e(t,r){return this.collator.compare(t,r)};_r.prototype.resolvedLocale=function e(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var wr=function e(t,r,a,n,i){this.text=t;this.image=r;this.scale=a;this.fontStack=n;this.textColor=i};var Tr=function e(t){this.sections=t};Tr.fromString=function e(t){return new Tr([new wr(t,null,null,null,null)])};Tr.prototype.isEmpty=function e(){if(this.sections.length===0){return true}return!this.sections.some((function(e){return e.text.length!==0||e.image&&e.image.name.length!==0}))};Tr.factory=function e(t){if(t instanceof Tr){return t}else{return Tr.fromString(t)}};Tr.prototype.toString=function e(){if(this.sections.length===0){return""}return this.sections.map((function(e){return e.text})).join("")};Tr.prototype.serialize=function e(){var t=["format"];for(var r=0,a=this.sections;r<a.length;r+=1){var n=a[r];if(n.image){t.push(["image",n.image.name]);continue}t.push(n.text);var i={};if(n.fontStack){i["text-font"]=["literal",n.fontStack.split(",")]}if(n.scale){i["font-scale"]=n.scale}if(n.textColor){i["text-color"]=["rgba"].concat(n.textColor.toArray())}t.push(i)}return t};var kr=function e(t){this.name=t.name;this.available=t.available};kr.prototype.toString=function e(){return this.name};kr.fromString=function e(t){if(!t){return null}return new kr({name:t,available:false})};kr.prototype.serialize=function e(){return["image",this.name]};function Mr(e,t,r,a){if(!(typeof e==="number"&&e>=0&&e<=255&&typeof t==="number"&&t>=0&&t<=255&&typeof r==="number"&&r>=0&&r<=255)){var n=typeof a==="number"?[e,t,r,a]:[e,t,r];return"Invalid rgba value ["+n.join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}if(!(typeof a==="undefined"||typeof a==="number"&&a>=0&&a<=1)){return"Invalid rgba value ["+[e,t,r,a].join(", ")+"]: 'a' must be between 0 and 1."}return null}function Ar(e){if(e===null){return true}else if(typeof e==="string"){return true}else if(typeof e==="boolean"){return true}else if(typeof e==="number"){return true}else if(e instanceof br){return true}else if(e instanceof _r){return true}else if(e instanceof Tr){return true}else if(e instanceof kr){return true}else if(Array.isArray(e)){for(var t=0,r=e;t<r.length;t+=1){var a=r[t];if(!Ar(a)){return false}}return true}else if(typeof e==="object"){for(var n in e){if(!Ar(e[n])){return false}}return true}else{return false}}function Sr(e){if(e===null){return tr}else if(typeof e==="string"){return ar}else if(typeof e==="boolean"){return nr}else if(typeof e==="number"){return rr}else if(e instanceof br){return ir}else if(e instanceof _r){return ur}else if(e instanceof Tr){return cr}else if(e instanceof kr){return fr}else if(Array.isArray(e)){var t=e.length;var r;for(var a=0,n=e;a<n.length;a+=1){var i=n[a];var o=Sr(i);if(!r){r=o}else if(r===o){continue}else{r=sr;break}}return hr(r||sr,t)}else{return or}}function Er(e){var t=typeof e;if(e===null){return""}else if(t==="string"||t==="number"||t==="boolean"){return String(e)}else if(e instanceof br||e instanceof Tr||e instanceof kr){return e.toString()}else{return JSON.stringify(e)}}var Lr=function e(t,r){this.type=t;this.value=r};Lr.parse=function e(t,r){if(t.length!==2){return r.error("'literal' expression requires exactly one argument, but found "+(t.length-1)+" instead.")}if(!Ar(t[1])){return r.error("invalid value")}var a=t[1];var n=Sr(a);var i=r.expectedType;if(n.kind==="array"&&n.N===0&&i&&i.kind==="array"&&(typeof i.N!=="number"||i.N===0)){n=i}return new Lr(n,a)};Lr.prototype.evaluate=function e(){return this.value};Lr.prototype.eachChild=function e(){};Lr.prototype.outputDefined=function e(){return true};Lr.prototype.serialize=function e(){if(this.type.kind==="array"||this.type.kind==="object"){return["literal",this.value]}else if(this.value instanceof br){return["rgba"].concat(this.value.toArray())}else if(this.value instanceof Tr){return this.value.serialize()}else{return this.value}};var Cr=function e(t){this.name="ExpressionEvaluationError";this.message=t};Cr.prototype.toJSON=function e(){return this.message};var Ir={string:ar,number:rr,boolean:nr,object:or};var Pr=function e(t,r){this.type=t;this.args=r};Pr.parse=function e(t,r){if(t.length<2){return r.error("Expected at least one argument.")}var a=1;var n;var i=t[0];if(i==="array"){var o;if(t.length>2){var s=t[1];if(typeof s!=="string"||!(s in Ir)||s==="object"){return r.error('The item type argument of "array" must be one of string, number, boolean',1)}o=Ir[s];a++}else{o=sr}var l;if(t.length>3){if(t[2]!==null&&(typeof t[2]!=="number"||t[2]<0||t[2]!==Math.floor(t[2]))){return r.error('The length argument to "array" must be a positive integer literal',2)}l=t[2];a++}n=hr(o,l)}else{n=Ir[i]}var u=[];for(;a<t.length;a++){var c=r.parse(t[a],a,sr);if(!c){return null}u.push(c)}return new Pr(n,u)};Pr.prototype.evaluate=function e(t){for(var r=0;r<this.args.length;r++){var a=this.args[r].evaluate(t);var n=dr(this.type,Sr(a));if(!n){return a}else if(r===this.args.length-1){throw new Cr("Expected value to be of type "+pr(this.type)+", but found "+pr(Sr(a))+" instead.")}}return null};Pr.prototype.eachChild=function e(t){this.args.forEach(t)};Pr.prototype.outputDefined=function e(){return this.args.every((function(e){return e.outputDefined()}))};Pr.prototype.serialize=function e(){var t=this.type;var r=[t.kind];if(t.kind==="array"){var a=t.itemType;if(a.kind==="string"||a.kind==="number"||a.kind==="boolean"){r.push(a.kind);var n=t.N;if(typeof n==="number"||this.args.length>1){r.push(n)}}}return r.concat(this.args.map((function(e){return e.serialize()})))};var Or=function e(t){this.type=cr;this.sections=t};Or.parse=function e(t,r){if(t.length<2){return r.error("Expected at least one argument.")}var a=t[1];if(!Array.isArray(a)&&typeof a==="object"){return r.error("First argument must be an image or text section.")}var n=[];var i=false;for(var o=1;o<=t.length-1;++o){var s=t[o];if(i&&typeof s==="object"&&!Array.isArray(s)){i=false;var l=null;if(s["font-scale"]){l=r.parse(s["font-scale"],1,rr);if(!l){return null}}var u=null;if(s["text-font"]){u=r.parse(s["text-font"],1,hr(ar));if(!u){return null}}var c=null;if(s["text-color"]){c=r.parse(s["text-color"],1,ir);if(!c){return null}}var f=n[n.length-1];f.scale=l;f.font=u;f.textColor=c}else{var h=r.parse(t[o],1,sr);if(!h){return null}var p=h.type.kind;if(p!=="string"&&p!=="value"&&p!=="null"&&p!=="resolvedImage"){return r.error("Formatted text type must be 'string', 'value', 'image' or 'null'.")}i=true;n.push({content:h,scale:null,font:null,textColor:null})}}return new Or(n)};Or.prototype.evaluate=function e(t){var r=function(e){var r=e.content.evaluate(t);if(Sr(r)===fr){return new wr("",r,null,null,null)}return new wr(Er(r),null,e.scale?e.scale.evaluate(t):null,e.font?e.font.evaluate(t).join(","):null,e.textColor?e.textColor.evaluate(t):null)};return new Tr(this.sections.map(r))};Or.prototype.eachChild=function e(t){for(var r=0,a=this.sections;r<a.length;r+=1){var n=a[r];t(n.content);if(n.scale){t(n.scale)}if(n.font){t(n.font)}if(n.textColor){t(n.textColor)}}};Or.prototype.outputDefined=function e(){return false};Or.prototype.serialize=function e(){var t=["format"];for(var r=0,a=this.sections;r<a.length;r+=1){var n=a[r];t.push(n.content.serialize());var i={};if(n.scale){i["font-scale"]=n.scale.serialize()}if(n.font){i["text-font"]=n.font.serialize()}if(n.textColor){i["text-color"]=n.textColor.serialize()}t.push(i)}return t};var zr=function e(t){this.type=fr;this.input=t};zr.parse=function e(t,r){if(t.length!==2){return r.error("Expected two arguments.")}var a=r.parse(t[1],1,ar);if(!a){return r.error("No image name provided.")}return new zr(a)};zr.prototype.evaluate=function e(t){var r=this.input.evaluate(t);var a=kr.fromString(r);if(a&&t.availableImages){a.available=t.availableImages.indexOf(r)>-1}return a};zr.prototype.eachChild=function e(t){t(this.input)};zr.prototype.outputDefined=function e(){return false};zr.prototype.serialize=function e(){return["image",this.input.serialize()]};var Dr={"to-boolean":nr,"to-color":ir,"to-number":rr,"to-string":ar};var Rr=function e(t,r){this.type=t;this.args=r};Rr.parse=function e(t,r){if(t.length<2){return r.error("Expected at least one argument.")}var a=t[0];if((a==="to-boolean"||a==="to-string")&&t.length!==2){return r.error("Expected one argument.")}var n=Dr[a];var i=[];for(var o=1;o<t.length;o++){var s=r.parse(t[o],o,sr);if(!s){return null}i.push(s)}return new Rr(n,i)};Rr.prototype.evaluate=function e(t){if(this.type.kind==="boolean"){return Boolean(this.args[0].evaluate(t))}else if(this.type.kind==="color"){var r;var a;for(var n=0,i=this.args;n<i.length;n+=1){var o=i[n];r=o.evaluate(t);a=null;if(r instanceof br){return r}else if(typeof r==="string"){var s=t.parseColor(r);if(s){return s}}else if(Array.isArray(r)){if(r.length<3||r.length>4){a="Invalid rbga value "+JSON.stringify(r)+": expected an array containing either three or four numeric values."}else{a=Mr(r[0],r[1],r[2],r[3])}if(!a){return new br(r[0]/255,r[1]/255,r[2]/255,r[3])}}}throw new Cr(a||"Could not parse color from value '"+(typeof r==="string"?r:String(JSON.stringify(r)))+"'")}else if(this.type.kind==="number"){var l=null;for(var u=0,c=this.args;u<c.length;u+=1){var f=c[u];l=f.evaluate(t);if(l===null){return 0}var h=Number(l);if(isNaN(h)){continue}return h}throw new Cr("Could not convert "+JSON.stringify(l)+" to number.")}else if(this.type.kind==="formatted"){return Tr.fromString(Er(this.args[0].evaluate(t)))}else if(this.type.kind==="resolvedImage"){return kr.fromString(Er(this.args[0].evaluate(t)))}else{return Er(this.args[0].evaluate(t))}};Rr.prototype.eachChild=function e(t){this.args.forEach(t)};Rr.prototype.outputDefined=function e(){return this.args.every((function(e){return e.outputDefined()}))};Rr.prototype.serialize=function e(){if(this.type.kind==="formatted"){return new Or([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize()}if(this.type.kind==="resolvedImage"){return new zr(this.args[0]).serialize()}var t=["to-"+this.type.kind];this.eachChild((function(e){t.push(e.serialize())}));return t};var Fr=["Unknown","Point","LineString","Polygon"];var Br=function e(){this.globals=null;this.feature=null;this.featureState=null;this.formattedSection=null;this._parseColorCache={};this.availableImages=null;this.canonical=null};Br.prototype.id=function e(){return this.feature&&"id"in this.feature?this.feature.id:null};Br.prototype.geometryType=function e(){return this.feature?typeof this.feature.type==="number"?Fr[this.feature.type]:this.feature.type:null};Br.prototype.geometry=function e(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null};Br.prototype.canonicalID=function e(){return this.canonical};Br.prototype.properties=function e(){return this.feature&&this.feature.properties||{}};Br.prototype.parseColor=function e(t){var r=this._parseColorCache[t];if(!r){r=this._parseColorCache[t]=br.parse(t)}return r};var Nr=function e(t,r,a,n){this.name=t;this.type=r;this._evaluate=a;this.args=n};Nr.prototype.evaluate=function e(t){return this._evaluate(t,this.args)};Nr.prototype.eachChild=function e(t){this.args.forEach(t)};Nr.prototype.outputDefined=function e(){return false};Nr.prototype.serialize=function e(){return[this.name].concat(this.args.map((function(e){return e.serialize()})))};Nr.parse=function e(t,r){var a;var n=t[0];var i=Nr.definitions[n];if(!i){return r.error('Unknown expression "'+n+'". If you wanted a literal array, use ["literal", [...]].',0)}var o=Array.isArray(i)?i[0]:i.type;var s=Array.isArray(i)?[[i[1],i[2]]]:i.overloads;var l=s.filter((function(e){var r=e[0];return!Array.isArray(r)||r.length===t.length-1}));var u=null;for(var c=0,f=l;c<f.length;c+=1){var h=f[c];var p=h[0];var v=h[1];u=new ga(r.registry,r.path,null,r.scope);var d=[];var m=false;for(var g=1;g<t.length;g++){var y=t[g];var x=Array.isArray(p)?p[g-1]:p.type;var b=u.parse(y,1+d.length,x);if(!b){m=true;break}d.push(b)}if(m){continue}if(Array.isArray(p)){if(p.length!==d.length){u.error("Expected "+p.length+" arguments, but found "+d.length+" instead.");continue}}for(var _=0;_<d.length;_++){var w=Array.isArray(p)?p[_]:p.type;var T=d[_];u.concat(_+1).checkSubtype(w,T.type)}if(u.errors.length===0){return new Nr(n,o,v,d)}}if(l.length===1){(a=r.errors).push.apply(a,u.errors)}else{var k=l.length?l:s;var M=k.map((function(e){var t=e[0];return jr(t)})).join(" | ");var A=[];for(var S=1;S<t.length;S++){var E=r.parse(t[S],1+A.length);if(!E){return null}A.push(pr(E.type))}r.error("Expected arguments of type "+M+", but found ("+A.join(", ")+") instead.")}return null};Nr.register=function e(t,r){Nr.definitions=r;for(var a in r){t[a]=Nr}};function jr(e){if(Array.isArray(e)){return"("+e.map(pr).join(", ")+")"}else{return"("+pr(e.type)+"...)"}}var Ur=function e(t,r,a){this.type=ur;this.locale=a;this.caseSensitive=t;this.diacriticSensitive=r};Ur.parse=function e(t,r){if(t.length!==2){return r.error("Expected one argument.")}var a=t[1];if(typeof a!=="object"||Array.isArray(a)){return r.error("Collator options argument must be an object.")}var n=r.parse(a["case-sensitive"]===undefined?false:a["case-sensitive"],1,nr);if(!n){return null}var i=r.parse(a["diacritic-sensitive"]===undefined?false:a["diacritic-sensitive"],1,nr);if(!i){return null}var o=null;if(a["locale"]){o=r.parse(a["locale"],1,ar);if(!o){return null}}return new Ur(n,i,o)};Ur.prototype.evaluate=function e(t){return new _r(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)};Ur.prototype.eachChild=function e(t){t(this.caseSensitive);t(this.diacriticSensitive);if(this.locale){t(this.locale)}};Ur.prototype.outputDefined=function e(){return false};Ur.prototype.serialize=function e(){var t={};t["case-sensitive"]=this.caseSensitive.serialize();t["diacritic-sensitive"]=this.diacriticSensitive.serialize();if(this.locale){t["locale"]=this.locale.serialize()}return["collator",t]};var Vr=8192;function Hr(e,t){e[0]=Math.min(e[0],t[0]);e[1]=Math.min(e[1],t[1]);e[2]=Math.max(e[2],t[0]);e[3]=Math.max(e[3],t[1])}function qr(e){return(180+e)/360}function Gr(e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360}function Yr(e,t){if(e[0]<=t[0]){return false}if(e[2]>=t[2]){return false}if(e[1]<=t[1]){return false}if(e[3]>=t[3]){return false}return true}function Wr(e,t){var r=qr(e[0]);var a=Gr(e[1]);var n=Math.pow(2,t.z);return[Math.round(r*n*Vr),Math.round(a*n*Vr)]}function Xr(e,t,r){var a=e[0]-t[0];var n=e[1]-t[1];var i=e[0]-r[0];var o=e[1]-r[1];return a*o-i*n===0&&a*i<=0&&n*o<=0}function Zr(e,t,r){return t[1]>e[1]!==r[1]>e[1]&&e[0]<(r[0]-t[0])*(e[1]-t[1])/(r[1]-t[1])+t[0]}function Jr(e,t){var r=false;for(var a=0,n=t.length;a<n;a++){var i=t[a];for(var o=0,s=i.length;o<s-1;o++){if(Xr(e,i[o],i[o+1])){return false}if(Zr(e,i[o],i[o+1])){r=!r}}}return r}function Kr(e,t){for(var r=0;r<t.length;r++){if(Jr(e,t[r])){return true}}return false}function Qr(e,t){return e[0]*t[1]-e[1]*t[0]}function $r(e,t,r,a){var n=e[0]-r[0];var i=e[1]-r[1];var o=t[0]-r[0];var s=t[1]-r[1];var l=a[0]-r[0];var u=a[1]-r[1];var c=n*u-l*i;var f=o*u-l*s;if(c>0&&f<0||c<0&&f>0){return true}return false}function ea(e,t,r,a){var n=[t[0]-e[0],t[1]-e[1]];var i=[a[0]-r[0],a[1]-r[1]];if(Qr(i,n)===0){return false}if($r(e,t,r,a)&&$r(r,a,e,t)){return true}return false}function ta(e,t,r){for(var a=0,n=r;a<n.length;a+=1){var i=n[a];for(var o=0;o<i.length-1;++o){if(ea(e,t,i[o],i[o+1])){return true}}}return false}function ra(e,t){for(var r=0;r<e.length;++r){if(!Jr(e[r],t)){return false}}for(var a=0;a<e.length-1;++a){if(ta(e[a],e[a+1],t)){return false}}return true}function aa(e,t){for(var r=0;r<t.length;r++){if(ra(e,t[r])){return true}}return false}function na(e,t,r){var a=[];for(var n=0;n<e.length;n++){var i=[];for(var o=0;o<e[n].length;o++){var s=Wr(e[n][o],r);Hr(t,s);i.push(s)}a.push(i)}return a}function ia(e,t,r){var a=[];for(var n=0;n<e.length;n++){var i=na(e[n],t,r);a.push(i)}return a}function oa(e,t,r,a){if(e[0]<r[0]||e[0]>r[2]){var n=a*.5;var i=e[0]-r[0]>n?-a:r[0]-e[0]>n?a:0;if(i===0){i=e[0]-r[2]>n?-a:r[2]-e[0]>n?a:0}e[0]+=i}Hr(t,e)}function sa(e){e[0]=e[1]=Infinity;e[2]=e[3]=-Infinity}function la(e,t,r,a){var n=Math.pow(2,a.z)*Vr;var i=[a.x*Vr,a.y*Vr];var o=[];for(var s=0,l=e;s<l.length;s+=1){var u=l[s];for(var c=0,f=u;c<f.length;c+=1){var h=f[c];var p=[h.x+i[0],h.y+i[1]];oa(p,t,r,n);o.push(p)}}return o}function ua(e,t,r,a){var n=Math.pow(2,a.z)*Vr;var i=[a.x*Vr,a.y*Vr];var o=[];for(var s=0,l=e;s<l.length;s+=1){var u=l[s];var c=[];for(var f=0,h=u;f<h.length;f+=1){var p=h[f];var v=[p.x+i[0],p.y+i[1]];Hr(t,v);c.push(v)}o.push(c)}if(t[2]-t[0]<=n/2){sa(t);for(var d=0,m=o;d<m.length;d+=1){var g=m[d];for(var y=0,x=g;y<x.length;y+=1){var b=x[y];oa(b,t,r,n)}}}return o}function ca(e,t){var r=[Infinity,Infinity,-Infinity,-Infinity];var a=[Infinity,Infinity,-Infinity,-Infinity];var n=e.canonicalID();if(t.type==="Polygon"){var i=na(t.coordinates,a,n);var o=la(e.geometry(),r,a,n);if(!Yr(r,a)){return false}for(var s=0,l=o;s<l.length;s+=1){var u=l[s];if(!Jr(u,i)){return false}}}if(t.type==="MultiPolygon"){var c=ia(t.coordinates,a,n);var f=la(e.geometry(),r,a,n);if(!Yr(r,a)){return false}for(var h=0,p=f;h<p.length;h+=1){var v=p[h];if(!Kr(v,c)){return false}}}return true}function fa(e,t){var r=[Infinity,Infinity,-Infinity,-Infinity];var a=[Infinity,Infinity,-Infinity,-Infinity];var n=e.canonicalID();if(t.type==="Polygon"){var i=na(t.coordinates,a,n);var o=ua(e.geometry(),r,a,n);if(!Yr(r,a)){return false}for(var s=0,l=o;s<l.length;s+=1){var u=l[s];if(!ra(u,i)){return false}}}if(t.type==="MultiPolygon"){var c=ia(t.coordinates,a,n);var f=ua(e.geometry(),r,a,n);if(!Yr(r,a)){return false}for(var h=0,p=f;h<p.length;h+=1){var v=p[h];if(!aa(v,c)){return false}}}return true}var ha=function e(t,r){this.type=nr;this.geojson=t;this.geometries=r};ha.parse=function e(t,r){if(t.length!==2){return r.error("'within' expression requires exactly one argument, but found "+(t.length-1)+" instead.")}if(Ar(t[1])){var a=t[1];if(a.type==="FeatureCollection"){for(var n=0;n<a.features.length;++n){var i=a.features[n].geometry.type;if(i==="Polygon"||i==="MultiPolygon"){return new ha(a,a.features[n].geometry)}}}else if(a.type==="Feature"){var o=a.geometry.type;if(o==="Polygon"||o==="MultiPolygon"){return new ha(a,a.geometry)}}else if(a.type==="Polygon"||a.type==="MultiPolygon"){return new ha(a,a)}}return r.error("'within' expression requires valid geojson object that contains polygon geometry type.")};ha.prototype.evaluate=function e(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point"){return ca(t,this.geometries)}else if(t.geometryType()==="LineString"){return fa(t,this.geometries)}}return false};ha.prototype.eachChild=function e(){};ha.prototype.outputDefined=function e(){return true};ha.prototype.serialize=function e(){return["within",this.geojson]};function pa(e){if(e instanceof Nr){if(e.name==="get"&&e.args.length===1){return false}else if(e.name==="feature-state"){return false}else if(e.name==="has"&&e.args.length===1){return false}else if(e.name==="properties"||e.name==="geometry-type"||e.name==="id"){return false}else if(/^filter-/.test(e.name)){return false}}if(e instanceof ha){return false}var t=true;e.eachChild((function(e){if(t&&!pa(e)){t=false}}));return t}function va(e){if(e instanceof Nr){if(e.name==="feature-state"){return false}}var t=true;e.eachChild((function(e){if(t&&!va(e)){t=false}}));return t}function da(e,t){if(e instanceof Nr&&t.indexOf(e.name)>=0){return false}var r=true;e.eachChild((function(e){if(r&&!da(e,t)){r=false}}));return r}var ma=function e(t,r){this.type=r.type;this.name=t;this.boundExpression=r};ma.parse=function e(t,r){if(t.length!==2||typeof t[1]!=="string"){return r.error("'var' expression requires exactly one string literal argument.")}var a=t[1];if(!r.scope.has(a)){return r.error('Unknown variable "'+a+'". Make sure "'+a+'" has been bound in an enclosing "let" expression before using it.',1)}return new ma(a,r.scope.get(a))};ma.prototype.evaluate=function e(t){return this.boundExpression.evaluate(t)};ma.prototype.eachChild=function e(){};ma.prototype.outputDefined=function e(){return false};ma.prototype.serialize=function e(){return["var",this.name]};var ga=function e(t,r,a,n,i){if(r===void 0)r=[];if(n===void 0)n=new er;if(i===void 0)i=[];this.registry=t;this.path=r;this.key=r.map((function(e){return"["+e+"]"})).join("");this.scope=n;this.errors=i;this.expectedType=a};ga.prototype.parse=function e(t,r,a,n,i){if(i===void 0)i={};if(r){return this.concat(r,a,n)._parse(t,i)}return this._parse(t,i)};ga.prototype._parse=function e(t,r){if(t===null||typeof t==="string"||typeof t==="boolean"||typeof t==="number"){t=["literal",t]}function a(e,t,r){if(r==="assert"){return new Pr(t,[e])}else if(r==="coerce"){return new Rr(t,[e])}else{return e}}if(Array.isArray(t)){if(t.length===0){return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].')}var n=t[0];if(typeof n!=="string"){this.error("Expression name must be a string, but found "+typeof n+' instead. If you wanted a literal array, use ["literal", [...]].',0);return null}var i=this.registry[n];if(i){var o=i.parse(t,this);if(!o){return null}if(this.expectedType){var s=this.expectedType;var l=o.type;if((s.kind==="string"||s.kind==="number"||s.kind==="boolean"||s.kind==="object"||s.kind==="array")&&l.kind==="value"){o=a(o,s,r.typeAnnotation||"assert")}else if((s.kind==="color"||s.kind==="formatted"||s.kind==="resolvedImage")&&(l.kind==="value"||l.kind==="string")){o=a(o,s,r.typeAnnotation||"coerce")}else if(this.checkSubtype(s,l)){return null}}if(!(o instanceof Lr)&&o.type.kind!=="resolvedImage"&&ya(o)){var u=new Br;try{o=new Lr(o.type,o.evaluate(u))}catch(c){this.error(c.message);return null}}return o}return this.error('Unknown expression "'+n+'". If you wanted a literal array, use ["literal", [...]].',0)}else if(typeof t==="undefined"){return this.error("'undefined' value invalid. Use null instead.")}else if(typeof t==="object"){return this.error('Bare objects invalid. Use ["literal", {...}] instead.')}else{return this.error("Expected an array, but found "+typeof t+" instead.")}};ga.prototype.concat=function e(t,r,a){var n=typeof t==="number"?this.path.concat(t):this.path;var i=a?this.scope.concat(a):this.scope;return new ga(this.registry,n,r||null,i,this.errors)};ga.prototype.error=function e(t){var r=[],a=arguments.length-1;while(a-- >0)r[a]=arguments[a+1];var n=""+this.key+r.map((function(e){return"["+e+"]"})).join("");this.errors.push(new $t(n,t))};ga.prototype.checkSubtype=function e(t,r){var a=dr(t,r);if(a){this.error(a)}return a};function ya(e){if(e instanceof ma){return ya(e.boundExpression)}else if(e instanceof Nr&&e.name==="error"){return false}else if(e instanceof Ur){return false}else if(e instanceof ha){return false}var t=e instanceof Rr||e instanceof Pr;var r=true;e.eachChild((function(e){if(t){r=r&&ya(e)}else{r=r&&e instanceof Lr}}));if(!r){return false}return pa(e)&&da(e,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function xa(e,t){var r=e.length-1;var a=0;var n=r;var i=0;var o,s;while(a<=n){i=Math.floor((a+n)/2);o=e[i];s=e[i+1];if(o<=t){if(i===r||t<s){return i}a=i+1}else if(o>t){n=i-1}else{throw new Cr("Input is not a number.")}}return 0}var ba=function e(t,r,a){this.type=t;this.input=r;this.labels=[];this.outputs=[];for(var n=0,i=a;n<i.length;n+=1){var o=i[n];var s=o[0];var l=o[1];this.labels.push(s);this.outputs.push(l)}};ba.parse=function e(t,r){if(t.length-1<4){return r.error("Expected at least 4 arguments, but found only "+(t.length-1)+".")}if((t.length-1)%2!==0){return r.error("Expected an even number of arguments.")}var a=r.parse(t[1],1,rr);if(!a){return null}var n=[];var i=null;if(r.expectedType&&r.expectedType.kind!=="value"){i=r.expectedType}for(var o=1;o<t.length;o+=2){var s=o===1?-Infinity:t[o];var l=t[o+1];var u=o;var c=o+1;if(typeof s!=="number"){return r.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',u)}if(n.length&&n[n.length-1][0]>=s){return r.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',u)}var f=r.parse(l,c,i);if(!f){return null}i=i||f.type;n.push([s,f])}return new ba(i,a,n)};ba.prototype.evaluate=function e(t){var r=this.labels;var a=this.outputs;if(r.length===1){return a[0].evaluate(t)}var n=this.input.evaluate(t);if(n<=r[0]){return a[0].evaluate(t)}var i=r.length;if(n>=r[i-1]){return a[i-1].evaluate(t)}var o=xa(r,n);return a[o].evaluate(t)};ba.prototype.eachChild=function e(t){t(this.input);for(var r=0,a=this.outputs;r<a.length;r+=1){var n=a[r];t(n)}};ba.prototype.outputDefined=function e(){return this.outputs.every((function(e){return e.outputDefined()}))};ba.prototype.serialize=function e(){var t=["step",this.input.serialize()];for(var r=0;r<this.labels.length;r++){if(r>0){t.push(this.labels[r])}t.push(this.outputs[r].serialize())}return t};function _a(e,t,r){return e*(1-r)+t*r}function wa(e,t,r){return new br(_a(e.r,t.r,r),_a(e.g,t.g,r),_a(e.b,t.b,r),_a(e.a,t.a,r))}function Ta(e,t,r){return e.map((function(e,a){return _a(e,t[a],r)}))}var ka=Object.freeze({__proto__:null,number:_a,color:wa,array:Ta});var Ma=.95047,Aa=1,Sa=1.08883,Ea=4/29,La=6/29,Ca=3*La*La,Ia=La*La*La,Pa=Math.PI/180,Oa=180/Math.PI;function za(e){return e>Ia?Math.pow(e,1/3):e/Ca+Ea}function Da(e){return e>La?e*e*e:Ca*(e-Ea)}function Ra(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function Fa(e){e/=255;return e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Ba(e){var t=Fa(e.r),r=Fa(e.g),a=Fa(e.b),n=za((.4124564*t+.3575761*r+.1804375*a)/Ma),i=za((.2126729*t+.7151522*r+.072175*a)/Aa),o=za((.0193339*t+.119192*r+.9503041*a)/Sa);return{l:116*i-16,a:500*(n-i),b:200*(i-o),alpha:e.a}}function Na(e){var t=(e.l+16)/116,r=isNaN(e.a)?t:t+e.a/500,a=isNaN(e.b)?t:t-e.b/200;t=Aa*Da(t);r=Ma*Da(r);a=Sa*Da(a);return new br(Ra(3.2404542*r-1.5371385*t-.4985314*a),Ra(-.969266*r+1.8760108*t+.041556*a),Ra(.0556434*r-.2040259*t+1.0572252*a),e.alpha)}function ja(e,t,r){return{l:_a(e.l,t.l,r),a:_a(e.a,t.a,r),b:_a(e.b,t.b,r),alpha:_a(e.alpha,t.alpha,r)}}function Ua(e){var t=Ba(e);var r=t.l;var a=t.a;var n=t.b;var i=Math.atan2(n,a)*Oa;return{h:i<0?i+360:i,c:Math.sqrt(a*a+n*n),l:r,alpha:e.a}}function Va(e){var t=e.h*Pa,r=e.c,a=e.l;return Na({l:a,a:Math.cos(t)*r,b:Math.sin(t)*r,alpha:e.alpha})}function Ha(e,t,r){var a=t-e;return e+r*(a>180||a<-180?a-360*Math.round(a/360):a)}function qa(e,t,r){return{h:Ha(e.h,t.h,r),c:_a(e.c,t.c,r),l:_a(e.l,t.l,r),alpha:_a(e.alpha,t.alpha,r)}}var Ga={forward:Ba,reverse:Na,interpolate:ja};var Ya={forward:Ua,reverse:Va,interpolate:qa};var Wa=Object.freeze({__proto__:null,lab:Ga,hcl:Ya});var Xa=function e(t,r,a,n,i){this.type=t;this.operator=r;this.interpolation=a;this.input=n;this.labels=[];this.outputs=[];for(var o=0,s=i;o<s.length;o+=1){var l=s[o];var u=l[0];var c=l[1];this.labels.push(u);this.outputs.push(c)}};Xa.interpolationFactor=function e(t,r,n,i){var o=0;if(t.name==="exponential"){o=Za(r,t.base,n,i)}else if(t.name==="linear"){o=Za(r,1,n,i)}else if(t.name==="cubic-bezier"){var s=t.controlPoints;var l=new a(s[0],s[1],s[2],s[3]);o=l.solve(Za(r,1,n,i))}return o};Xa.parse=function e(t,r){var a=t[0];var n=t[1];var i=t[2];var o=t.slice(3);if(!Array.isArray(n)||n.length===0){return r.error("Expected an interpolation type expression.",1)}if(n[0]==="linear"){n={name:"linear"}}else if(n[0]==="exponential"){var s=n[1];if(typeof s!=="number"){return r.error("Exponential interpolation requires a numeric base.",1,1)}n={name:"exponential",base:s}}else if(n[0]==="cubic-bezier"){var l=n.slice(1);if(l.length!==4||l.some((function(e){return typeof e!=="number"||e<0||e>1}))){return r.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1)}n={name:"cubic-bezier",controlPoints:l}}else{return r.error("Unknown interpolation type "+String(n[0]),1,0)}if(t.length-1<4){return r.error("Expected at least 4 arguments, but found only "+(t.length-1)+".")}if((t.length-1)%2!==0){return r.error("Expected an even number of arguments.")}i=r.parse(i,2,rr);if(!i){return null}var u=[];var c=null;if(a==="interpolate-hcl"||a==="interpolate-lab"){c=ir}else if(r.expectedType&&r.expectedType.kind!=="value"){c=r.expectedType}for(var f=0;f<o.length;f+=2){var h=o[f];var p=o[f+1];var v=f+3;var d=f+4;if(typeof h!=="number"){return r.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',v)}if(u.length&&u[u.length-1][0]>=h){return r.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',v)}var m=r.parse(p,d,c);if(!m){return null}c=c||m.type;u.push([h,m])}if(c.kind!=="number"&&c.kind!=="color"&&!(c.kind==="array"&&c.itemType.kind==="number"&&typeof c.N==="number")){return r.error("Type "+pr(c)+" is not interpolatable.")}return new Xa(c,a,n,i,u)};Xa.prototype.evaluate=function e(t){var r=this.labels;var a=this.outputs;if(r.length===1){return a[0].evaluate(t)}var n=this.input.evaluate(t);if(n<=r[0]){return a[0].evaluate(t)}var i=r.length;if(n>=r[i-1]){return a[i-1].evaluate(t)}var o=xa(r,n);var s=r[o];var l=r[o+1];var u=Xa.interpolationFactor(this.interpolation,n,s,l);var c=a[o].evaluate(t);var f=a[o+1].evaluate(t);if(this.operator==="interpolate"){return ka[this.type.kind.toLowerCase()](c,f,u)}else if(this.operator==="interpolate-hcl"){return Ya.reverse(Ya.interpolate(Ya.forward(c),Ya.forward(f),u))}else{return Ga.reverse(Ga.interpolate(Ga.forward(c),Ga.forward(f),u))}};Xa.prototype.eachChild=function e(t){t(this.input);for(var r=0,a=this.outputs;r<a.length;r+=1){var n=a[r];t(n)}};Xa.prototype.outputDefined=function e(){return this.outputs.every((function(e){return e.outputDefined()}))};Xa.prototype.serialize=function e(){var t;if(this.interpolation.name==="linear"){t=["linear"]}else if(this.interpolation.name==="exponential"){if(this.interpolation.base===1){t=["linear"]}else{t=["exponential",this.interpolation.base]}}else{t=["cubic-bezier"].concat(this.interpolation.controlPoints)}var r=[this.operator,t,this.input.serialize()];for(var a=0;a<this.labels.length;a++){r.push(this.labels[a],this.outputs[a].serialize())}return r};function Za(e,t,r,a){var n=a-r;var i=e-r;if(n===0){return 0}else if(t===1){return i/n}else{return(Math.pow(t,i)-1)/(Math.pow(t,n)-1)}}var Ja=function e(t,r){this.type=t;this.args=r};Ja.parse=function e(t,r){if(t.length<2){return r.error("Expectected at least one argument.")}var a=null;var n=r.expectedType;if(n&&n.kind!=="value"){a=n}var i=[];for(var o=0,s=t.slice(1);o<s.length;o+=1){var l=s[o];var u=r.parse(l,1+i.length,a,undefined,{typeAnnotation:"omit"});if(!u){return null}a=a||u.type;i.push(u)}var c=n&&i.some((function(e){return dr(n,e.type)}));return c?new Ja(sr,i):new Ja(a,i)};Ja.prototype.evaluate=function e(t){var r=null;var a=0;var n;for(var i=0,o=this.args;i<o.length;i+=1){var s=o[i];a++;r=s.evaluate(t);if(r&&r instanceof kr&&!r.available){if(!n){n=r.name}r=null;if(a===this.args.length){r=n}}if(r!==null){break}}return r};Ja.prototype.eachChild=function e(t){this.args.forEach(t)};Ja.prototype.outputDefined=function e(){return this.args.every((function(e){return e.outputDefined()}))};Ja.prototype.serialize=function e(){var t=["coalesce"];this.eachChild((function(e){t.push(e.serialize())}));return t};var Ka=function e(t,r){this.type=r.type;this.bindings=[].concat(t);this.result=r};Ka.prototype.evaluate=function e(t){return this.result.evaluate(t)};Ka.prototype.eachChild=function e(t){for(var r=0,a=this.bindings;r<a.length;r+=1){var n=a[r];t(n[1])}t(this.result)};Ka.parse=function e(t,r){if(t.length<4){return r.error("Expected at least 3 arguments, but found "+(t.length-1)+" instead.")}var a=[];for(var n=1;n<t.length-1;n+=2){var i=t[n];if(typeof i!=="string"){return r.error("Expected string, but found "+typeof i+" instead.",n)}if(/[^a-zA-Z0-9_]/.test(i)){return r.error("Variable names must contain only alphanumeric characters or '_'.",n)}var o=r.parse(t[n+1],n+1);if(!o){return null}a.push([i,o])}var s=r.parse(t[t.length-1],t.length-1,r.expectedType,a);if(!s){return null}return new Ka(a,s)};Ka.prototype.outputDefined=function e(){return this.result.outputDefined()};Ka.prototype.serialize=function e(){var t=["let"];for(var r=0,a=this.bindings;r<a.length;r+=1){var n=a[r];var i=n[0];var o=n[1];t.push(i,o.serialize())}t.push(this.result.serialize());return t};var Qa=function e(t,r,a){this.type=t;this.index=r;this.input=a};Qa.parse=function e(t,r){if(t.length!==3){return r.error("Expected 2 arguments, but found "+(t.length-1)+" instead.")}var a=r.parse(t[1],1,rr);var n=r.parse(t[2],2,hr(r.expectedType||sr));if(!a||!n){return null}var i=n.type;return new Qa(i.itemType,a,n)};Qa.prototype.evaluate=function e(t){var r=this.index.evaluate(t);var a=this.input.evaluate(t);if(r<0){throw new Cr("Array index out of bounds: "+r+" < 0.")}if(r>=a.length){throw new Cr("Array index out of bounds: "+r+" > "+(a.length-1)+".")}if(r!==Math.floor(r)){throw new Cr("Array index must be an integer, but found "+r+" instead.")}return a[r]};Qa.prototype.eachChild=function e(t){t(this.index);t(this.input)};Qa.prototype.outputDefined=function e(){return false};Qa.prototype.serialize=function e(){return["at",this.index.serialize(),this.input.serialize()]};var $a=function e(t,r){this.type=nr;this.needle=t;this.haystack=r};$a.parse=function e(t,r){if(t.length!==3){return r.error("Expected 2 arguments, but found "+(t.length-1)+" instead.")}var a=r.parse(t[1],1,sr);var n=r.parse(t[2],2,sr);if(!a||!n){return null}if(!mr(a.type,[nr,ar,rr,tr,sr])){return r.error("Expected first argument to be of type boolean, string, number or null, but found "+pr(a.type)+" instead")}return new $a(a,n)};$a.prototype.evaluate=function e(t){var r=this.needle.evaluate(t);var a=this.haystack.evaluate(t);if(!a){return false}if(!gr(r,["boolean","string","number","null"])){throw new Cr("Expected first argument to be of type boolean, string, number or null, but found "+pr(Sr(r))+" instead.")}if(!gr(a,["string","array"])){throw new Cr("Expected second argument to be of type array or string, but found "+pr(Sr(a))+" instead.")}return a.indexOf(r)>=0};$a.prototype.eachChild=function e(t){t(this.needle);t(this.haystack)};$a.prototype.outputDefined=function e(){return true};$a.prototype.serialize=function e(){return["in",this.needle.serialize(),this.haystack.serialize()]};var en=function e(t,r,a){this.type=rr;this.needle=t;this.haystack=r;this.fromIndex=a};en.parse=function e(t,r){if(t.length<=2||t.length>=5){return r.error("Expected 3 or 4 arguments, but found "+(t.length-1)+" instead.")}var a=r.parse(t[1],1,sr);var n=r.parse(t[2],2,sr);if(!a||!n){return null}if(!mr(a.type,[nr,ar,rr,tr,sr])){return r.error("Expected first argument to be of type boolean, string, number or null, but found "+pr(a.type)+" instead")}if(t.length===4){var i=r.parse(t[3],3,rr);if(!i){return null}return new en(a,n,i)}else{return new en(a,n)}};en.prototype.evaluate=function e(t){var r=this.needle.evaluate(t);var a=this.haystack.evaluate(t);if(!gr(r,["boolean","string","number","null"])){throw new Cr("Expected first argument to be of type boolean, string, number or null, but found "+pr(Sr(r))+" instead.")}if(!gr(a,["string","array"])){throw new Cr("Expected second argument to be of type array or string, but found "+pr(Sr(a))+" instead.")}if(this.fromIndex){var n=this.fromIndex.evaluate(t);return a.indexOf(r,n)}return a.indexOf(r)};en.prototype.eachChild=function e(t){t(this.needle);t(this.haystack);if(this.fromIndex){t(this.fromIndex)}};en.prototype.outputDefined=function e(){return false};en.prototype.serialize=function e(){if(this.fromIndex!=null&&this.fromIndex!==undefined){var t=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),t]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var tn=function e(t,r,a,n,i,o){this.inputType=t;this.type=r;this.input=a;this.cases=n;this.outputs=i;this.otherwise=o};tn.parse=function e(t,r){if(t.length<5){return r.error("Expected at least 4 arguments, but found only "+(t.length-1)+".")}if(t.length%2!==1){return r.error("Expected an even number of arguments.")}var a;var n;if(r.expectedType&&r.expectedType.kind!=="value"){n=r.expectedType}var i={};var o=[];for(var s=2;s<t.length-1;s+=2){var l=t[s];var u=t[s+1];if(!Array.isArray(l)){l=[l]}var c=r.concat(s);if(l.length===0){return c.error("Expected at least one branch label.")}for(var f=0,h=l;f<h.length;f+=1){var p=h[f];if(typeof p!=="number"&&typeof p!=="string"){return c.error("Branch labels must be numbers or strings.")}else if(typeof p==="number"&&Math.abs(p)>Number.MAX_SAFE_INTEGER){return c.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".")}else if(typeof p==="number"&&Math.floor(p)!==p){return c.error("Numeric branch labels must be integer values.")}else if(!a){a=Sr(p)}else if(c.checkSubtype(a,Sr(p))){return null}if(typeof i[String(p)]!=="undefined"){return c.error("Branch labels must be unique.")}i[String(p)]=o.length}var v=r.parse(u,s,n);if(!v){return null}n=n||v.type;o.push(v)}var d=r.parse(t[1],1,sr);if(!d){return null}var m=r.parse(t[t.length-1],t.length-1,n);if(!m){return null}if(d.type.kind!=="value"&&r.concat(1).checkSubtype(a,d.type)){return null}return new tn(a,n,d,i,o,m)};tn.prototype.evaluate=function e(t){var r=this.input.evaluate(t);var a=Sr(r)===this.inputType&&this.outputs[this.cases[r]]||this.otherwise;return a.evaluate(t)};tn.prototype.eachChild=function e(t){t(this.input);this.outputs.forEach(t);t(this.otherwise)};tn.prototype.outputDefined=function e(){return this.outputs.every((function(e){return e.outputDefined()}))&&this.otherwise.outputDefined()};tn.prototype.serialize=function e(){var t=this;var r=["match",this.input.serialize()];var a=Object.keys(this.cases).sort();var n=[];var i={};for(var o=0,s=a;o<s.length;o+=1){var l=s[o];var u=i[this.cases[l]];if(u===undefined){i[this.cases[l]]=n.length;n.push([this.cases[l],[l]])}else{n[u][1].push(l)}}var c=function(e){return t.inputType.kind==="number"?Number(e):e};for(var f=0,h=n;f<h.length;f+=1){var p=h[f];var u=p[0];var v=p[1];if(v.length===1){r.push(c(v[0]))}else{r.push(v.map(c))}r.push(this.outputs[outputIndex$1].serialize())}r.push(this.otherwise.serialize());return r};var rn=function e(t,r,a){this.type=t;this.branches=r;this.otherwise=a};rn.parse=function e(t,r){if(t.length<4){return r.error("Expected at least 3 arguments, but found only "+(t.length-1)+".")}if(t.length%2!==0){return r.error("Expected an odd number of arguments.")}var a;if(r.expectedType&&r.expectedType.kind!=="value"){a=r.expectedType}var n=[];for(var i=1;i<t.length-1;i+=2){var o=r.parse(t[i],i,nr);if(!o){return null}var s=r.parse(t[i+1],i+1,a);if(!s){return null}n.push([o,s]);a=a||s.type}var l=r.parse(t[t.length-1],t.length-1,a);if(!l){return null}return new rn(a,n,l)};rn.prototype.evaluate=function e(t){for(var r=0,a=this.branches;r<a.length;r+=1){var n=a[r];var i=n[0];var o=n[1];if(i.evaluate(t)){return o.evaluate(t)}}return this.otherwise.evaluate(t)};rn.prototype.eachChild=function e(t){for(var r=0,a=this.branches;r<a.length;r+=1){var n=a[r];var i=n[0];var o=n[1];t(i);t(o)}t(this.otherwise)};rn.prototype.outputDefined=function e(){return this.branches.every((function(e){var t=e[0];var r=e[1];return r.outputDefined()}))&&this.otherwise.outputDefined()};rn.prototype.serialize=function e(){var t=["case"];this.eachChild((function(e){t.push(e.serialize())}));return t};var an=function e(t,r,a,n){this.type=t;this.input=r;this.beginIndex=a;this.endIndex=n};an.parse=function e(t,r){if(t.length<=2||t.length>=5){return r.error("Expected 3 or 4 arguments, but found "+(t.length-1)+" instead.")}var a=r.parse(t[1],1,sr);var n=r.parse(t[2],2,rr);if(!a||!n){return null}if(!mr(a.type,[hr(sr),ar,sr])){return r.error("Expected first argument to be of type array or string, but found "+pr(a.type)+" instead")}if(t.length===4){var i=r.parse(t[3],3,rr);if(!i){return null}return new an(a.type,a,n,i)}else{return new an(a.type,a,n)}};an.prototype.evaluate=function e(t){var r=this.input.evaluate(t);var a=this.beginIndex.evaluate(t);if(!gr(r,["string","array"])){throw new Cr("Expected first argument to be of type array or string, but found "+pr(Sr(r))+" instead.")}if(this.endIndex){var n=this.endIndex.evaluate(t);return r.slice(a,n)}return r.slice(a)};an.prototype.eachChild=function e(t){t(this.input);t(this.beginIndex);if(this.endIndex){t(this.endIndex)}};an.prototype.outputDefined=function e(){return false};an.prototype.serialize=function e(){if(this.endIndex!=null&&this.endIndex!==undefined){var t=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),t]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};function nn(e,t){if(e==="=="||e==="!="){return t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value"}else{return t.kind==="string"||t.kind==="number"||t.kind==="value"}}function on(e,t,r){return t===r}function sn(e,t,r){return t!==r}function ln(e,t,r){return t<r}function un(e,t,r){return t>r}function cn(e,t,r){return t<=r}function fn(e,t,r){return t>=r}function hn(e,t,r,a){return a.compare(t,r)===0}function pn(e,t,r,a){return!hn(e,t,r,a)}function vn(e,t,r,a){return a.compare(t,r)<0}function dn(e,t,r,a){return a.compare(t,r)>0}function mn(e,t,r,a){return a.compare(t,r)<=0}function gn(e,t,r,a){return a.compare(t,r)>=0}function yn(e,t,r){var a=e!=="=="&&e!=="!=";return function(){function n(e,t,r){this.type=nr;this.lhs=e;this.rhs=t;this.collator=r;this.hasUntypedArgument=e.type.kind==="value"||t.type.kind==="value"}n.parse=function e(t,r){if(t.length!==3&&t.length!==4){return r.error("Expected two or three arguments.")}var i=t[0];var o=r.parse(t[1],1,sr);if(!o){return null}if(!nn(i,o.type)){return r.concat(1).error('"'+i+"\" comparisons are not supported for type '"+pr(o.type)+"'.")}var s=r.parse(t[2],2,sr);if(!s){return null}if(!nn(i,s.type)){return r.concat(2).error('"'+i+"\" comparisons are not supported for type '"+pr(s.type)+"'.")}if(o.type.kind!==s.type.kind&&o.type.kind!=="value"&&s.type.kind!=="value"){return r.error("Cannot compare types '"+pr(o.type)+"' and '"+pr(s.type)+"'.")}if(a){if(o.type.kind==="value"&&s.type.kind!=="value"){o=new Pr(s.type,[o])}else if(o.type.kind!=="value"&&s.type.kind==="value"){s=new Pr(o.type,[s])}}var l=null;if(t.length===4){if(o.type.kind!=="string"&&s.type.kind!=="string"&&o.type.kind!=="value"&&s.type.kind!=="value"){return r.error("Cannot use collator to compare non-string types.")}l=r.parse(t[3],3,ur);if(!l){return null}}return new n(o,s,l)};n.prototype.evaluate=function n(i){var o=this.lhs.evaluate(i);var s=this.rhs.evaluate(i);if(a&&this.hasUntypedArgument){var l=Sr(o);var u=Sr(s);if(l.kind!==u.kind||!(l.kind==="string"||l.kind==="number")){throw new Cr('Expected arguments for "'+e+'" to be (string, string) or (number, number), but found ('+l.kind+", "+u.kind+") instead.")}}if(this.collator&&!a&&this.hasUntypedArgument){var c=Sr(o);var f=Sr(s);if(c.kind!=="string"||f.kind!=="string"){return t(i,o,s)}}return this.collator?r(i,o,s,this.collator.evaluate(i)):t(i,o,s)};n.prototype.eachChild=function e(t){t(this.lhs);t(this.rhs);if(this.collator){t(this.collator)}};n.prototype.outputDefined=function e(){return true};n.prototype.serialize=function t(){var r=[e];this.eachChild((function(e){r.push(e.serialize())}));return r};return n}()}var xn=yn("==",on,hn);var bn=yn("!=",sn,pn);var _n=yn("<",ln,vn);var wn=yn(">",un,dn);var Tn=yn("<=",cn,mn);var kn=yn(">=",fn,gn);var Mn=function e(t,r,a,n,i){this.type=ar;this.number=t;this.locale=r;this.currency=a;this.minFractionDigits=n;this.maxFractionDigits=i};Mn.parse=function e(t,r){if(t.length!==3){return r.error("Expected two arguments.")}var a=r.parse(t[1],1,rr);if(!a){return null}var n=t[2];if(typeof n!=="object"||Array.isArray(n)){return r.error("NumberFormat options argument must be an object.")}var i=null;if(n["locale"]){i=r.parse(n["locale"],1,ar);if(!i){return null}}var o=null;if(n["currency"]){o=r.parse(n["currency"],1,ar);if(!o){return null}}var s=null;if(n["min-fraction-digits"]){s=r.parse(n["min-fraction-digits"],1,rr);if(!s){return null}}var l=null;if(n["max-fraction-digits"]){l=r.parse(n["max-fraction-digits"],1,rr);if(!l){return null}}return new Mn(a,i,o,s,l)};Mn.prototype.evaluate=function e(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):undefined,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):undefined,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):undefined}).format(this.number.evaluate(t))};Mn.prototype.eachChild=function e(t){t(this.number);if(this.locale){t(this.locale)}if(this.currency){t(this.currency)}if(this.minFractionDigits){t(this.minFractionDigits)}if(this.maxFractionDigits){t(this.maxFractionDigits)}};Mn.prototype.outputDefined=function e(){return false};Mn.prototype.serialize=function e(){var t={};if(this.locale){t["locale"]=this.locale.serialize()}if(this.currency){t["currency"]=this.currency.serialize()}if(this.minFractionDigits){t["min-fraction-digits"]=this.minFractionDigits.serialize()}if(this.maxFractionDigits){t["max-fraction-digits"]=this.maxFractionDigits.serialize()}return["number-format",this.number.serialize(),t]};var An=function e(t){this.type=rr;this.input=t};An.parse=function e(t,r){if(t.length!==2){return r.error("Expected 1 argument, but found "+(t.length-1)+" instead.")}var a=r.parse(t[1],1);if(!a){return null}if(a.type.kind!=="array"&&a.type.kind!=="string"&&a.type.kind!=="value"){return r.error("Expected argument of type string or array, but found "+pr(a.type)+" instead.")}return new An(a)};An.prototype.evaluate=function e(t){var r=this.input.evaluate(t);if(typeof r==="string"){return r.length}else if(Array.isArray(r)){return r.length}else{throw new Cr("Expected value to be of type string or array, but found "+pr(Sr(r))+" instead.")}};An.prototype.eachChild=function e(t){t(this.input)};An.prototype.outputDefined=function e(){return false};An.prototype.serialize=function e(){var t=["length"];this.eachChild((function(e){t.push(e.serialize())}));return t};var Sn={"==":xn,"!=":bn,">":wn,"<":_n,">=":kn,"<=":Tn,array:Pr,at:Qa,boolean:Pr,case:rn,coalesce:Ja,collator:Ur,format:Or,image:zr,in:$a,"index-of":en,interpolate:Xa,"interpolate-hcl":Xa,"interpolate-lab":Xa,length:An,let:Ka,literal:Lr,match:tn,number:Pr,"number-format":Mn,object:Pr,slice:an,step:ba,string:Pr,"to-boolean":Rr,"to-color":Rr,"to-number":Rr,"to-string":Rr,var:ma,within:ha};function En(e,t){var r=t[0];var a=t[1];var n=t[2];var i=t[3];r=r.evaluate(e);a=a.evaluate(e);n=n.evaluate(e);var o=i?i.evaluate(e):1;var s=Mr(r,a,n,o);if(s){throw new Cr(s)}return new br(r/255*o,a/255*o,n/255*o,o)}function Ln(e,t){return e in t}function Cn(e,t){var r=t[e];return typeof r==="undefined"?null:r}function In(e,t,r,a){while(r<=a){var n=r+a>>1;if(t[n]===e){return true}if(t[n]>e){a=n-1}else{r=n+1}}return false}function Pn(e){return{type:e}}Nr.register(Sn,{error:[lr,[ar],function(e,t){var r=t[0];throw new Cr(r.evaluate(e))}],typeof:[ar,[sr],function(e,t){var r=t[0];return pr(Sr(r.evaluate(e)))}],"to-rgba":[hr(rr,4),[ir],function(e,t){var r=t[0];return r.evaluate(e).toArray()}],rgb:[ir,[rr,rr,rr],En],rgba:[ir,[rr,rr,rr,rr],En],has:{type:nr,overloads:[[[ar],function(e,t){var r=t[0];return Ln(r.evaluate(e),e.properties())}],[[ar,or],function(e,t){var r=t[0];var a=t[1];return Ln(r.evaluate(e),a.evaluate(e))}]]},get:{type:sr,overloads:[[[ar],function(e,t){var r=t[0];return Cn(r.evaluate(e),e.properties())}],[[ar,or],function(e,t){var r=t[0];var a=t[1];return Cn(r.evaluate(e),a.evaluate(e))}]]},"feature-state":[sr,[ar],function(e,t){var r=t[0];return Cn(r.evaluate(e),e.featureState||{})}],properties:[or,[],function(e){return e.properties()}],"geometry-type":[ar,[],function(e){return e.geometryType()}],id:[sr,[],function(e){return e.id()}],zoom:[rr,[],function(e){return e.globals.zoom}],"heatmap-density":[rr,[],function(e){return e.globals.heatmapDensity||0}],"line-progress":[rr,[],function(e){return e.globals.lineProgress||0}],accumulated:[sr,[],function(e){return e.globals.accumulated===undefined?null:e.globals.accumulated}],"+":[rr,Pn(rr),function(e,t){var r=0;for(var a=0,n=t;a<n.length;a+=1){var i=n[a];r+=i.evaluate(e)}return r}],"*":[rr,Pn(rr),function(e,t){var r=1;for(var a=0,n=t;a<n.length;a+=1){var i=n[a];r*=i.evaluate(e)}return r}],"-":{type:rr,overloads:[[[rr,rr],function(e,t){var r=t[0];var a=t[1];return r.evaluate(e)-a.evaluate(e)}],[[rr],function(e,t){var r=t[0];return-r.evaluate(e)}]]},"/":[rr,[rr,rr],function(e,t){var r=t[0];var a=t[1];return r.evaluate(e)/a.evaluate(e)}],"%":[rr,[rr,rr],function(e,t){var r=t[0];var a=t[1];return r.evaluate(e)%a.evaluate(e)}],ln2:[rr,[],function(){return Math.LN2}],pi:[rr,[],function(){return Math.PI}],e:[rr,[],function(){return Math.E}],"^":[rr,[rr,rr],function(e,t){var r=t[0];var a=t[1];return Math.pow(r.evaluate(e),a.evaluate(e))}],sqrt:[rr,[rr],function(e,t){var r=t[0];return Math.sqrt(r.evaluate(e))}],log10:[rr,[rr],function(e,t){var r=t[0];return Math.log(r.evaluate(e))/Math.LN10}],ln:[rr,[rr],function(e,t){var r=t[0];return Math.log(r.evaluate(e))}],log2:[rr,[rr],function(e,t){var r=t[0];return Math.log(r.evaluate(e))/Math.LN2}],sin:[rr,[rr],function(e,t){var r=t[0];return Math.sin(r.evaluate(e))}],cos:[rr,[rr],function(e,t){var r=t[0];return Math.cos(r.evaluate(e))}],tan:[rr,[rr],function(e,t){var r=t[0];return Math.tan(r.evaluate(e))}],asin:[rr,[rr],function(e,t){var r=t[0];return Math.asin(r.evaluate(e))}],acos:[rr,[rr],function(e,t){var r=t[0];return Math.acos(r.evaluate(e))}],atan:[rr,[rr],function(e,t){var r=t[0];return Math.atan(r.evaluate(e))}],min:[rr,Pn(rr),function(e,t){return Math.min.apply(Math,t.map((function(t){return t.evaluate(e)})))}],max:[rr,Pn(rr),function(e,t){return Math.max.apply(Math,t.map((function(t){return t.evaluate(e)})))}],abs:[rr,[rr],function(e,t){var r=t[0];return Math.abs(r.evaluate(e))}],round:[rr,[rr],function(e,t){var r=t[0];var a=r.evaluate(e);return a<0?-Math.round(-a):Math.round(a)}],floor:[rr,[rr],function(e,t){var r=t[0];return Math.floor(r.evaluate(e))}],ceil:[rr,[rr],function(e,t){var r=t[0];return Math.ceil(r.evaluate(e))}],"filter-==":[nr,[ar,sr],function(e,t){var r=t[0];var a=t[1];return e.properties()[r.value]===a.value}],"filter-id-==":[nr,[sr],function(e,t){var r=t[0];return e.id()===r.value}],"filter-type-==":[nr,[ar],function(e,t){var r=t[0];return e.geometryType()===r.value}],"filter-<":[nr,[ar,sr],function(e,t){var r=t[0];var a=t[1];var n=e.properties()[r.value];var i=a.value;return typeof n===typeof i&&n<i}],"filter-id-<":[nr,[sr],function(e,t){var r=t[0];var a=e.id();var n=r.value;return typeof a===typeof n&&a<n}],"filter->":[nr,[ar,sr],function(e,t){var r=t[0];var a=t[1];var n=e.properties()[r.value];var i=a.value;return typeof n===typeof i&&n>i}],"filter-id->":[nr,[sr],function(e,t){var r=t[0];var a=e.id();var n=r.value;return typeof a===typeof n&&a>n}],"filter-<=":[nr,[ar,sr],function(e,t){var r=t[0];var a=t[1];var n=e.properties()[r.value];var i=a.value;return typeof n===typeof i&&n<=i}],"filter-id-<=":[nr,[sr],function(e,t){var r=t[0];var a=e.id();var n=r.value;return typeof a===typeof n&&a<=n}],"filter->=":[nr,[ar,sr],function(e,t){var r=t[0];var a=t[1];var n=e.properties()[r.value];var i=a.value;return typeof n===typeof i&&n>=i}],"filter-id->=":[nr,[sr],function(e,t){var r=t[0];var a=e.id();var n=r.value;return typeof a===typeof n&&a>=n}],"filter-has":[nr,[sr],function(e,t){var r=t[0];return r.value in e.properties()}],"filter-has-id":[nr,[],function(e){return e.id()!==null&&e.id()!==undefined}],"filter-type-in":[nr,[hr(ar)],function(e,t){var r=t[0];return r.value.indexOf(e.geometryType())>=0}],"filter-id-in":[nr,[hr(sr)],function(e,t){var r=t[0];return r.value.indexOf(e.id())>=0}],"filter-in-small":[nr,[ar,hr(sr)],function(e,t){var r=t[0];var a=t[1];return a.value.indexOf(e.properties()[r.value])>=0}],"filter-in-large":[nr,[ar,hr(sr)],function(e,t){var r=t[0];var a=t[1];return In(e.properties()[r.value],a.value,0,a.value.length-1)}],all:{type:nr,overloads:[[[nr,nr],function(e,t){var r=t[0];var a=t[1];return r.evaluate(e)&&a.evaluate(e)}],[Pn(nr),function(e,t){for(var r=0,a=t;r<a.length;r+=1){var n=a[r];if(!n.evaluate(e)){return false}}return true}]]},any:{type:nr,overloads:[[[nr,nr],function(e,t){var r=t[0];var a=t[1];return r.evaluate(e)||a.evaluate(e)}],[Pn(nr),function(e,t){for(var r=0,a=t;r<a.length;r+=1){var n=a[r];if(n.evaluate(e)){return true}}return false}]]},"!":[nr,[nr],function(e,t){var r=t[0];return!r.evaluate(e)}],"is-supported-script":[nr,[ar],function(e,t){var r=t[0];var a=e.globals&&e.globals.isSupportedScript;if(a){return a(r.evaluate(e))}return true}],upcase:[ar,[ar],function(e,t){var r=t[0];return r.evaluate(e).toUpperCase()}],downcase:[ar,[ar],function(e,t){var r=t[0];return r.evaluate(e).toLowerCase()}],concat:[ar,Pn(sr),function(e,t){return t.map((function(t){return Er(t.evaluate(e))})).join("")}],"resolved-locale":[ar,[ur],function(e,t){var r=t[0];return r.evaluate(e).resolvedLocale()}]});function On(e){return{result:"success",value:e}}function zn(e){return{result:"error",value:e}}function Dn(e){return e["property-type"]==="data-driven"||e["property-type"]==="cross-faded-data-driven"}function Rn(e){return!!e.expression&&e.expression.parameters.indexOf("zoom")>-1}function Fn(e){return!!e.expression&&e.expression.interpolated}function Bn(e){if(e instanceof Number){return"number"}else if(e instanceof String){return"string"}else if(e instanceof Boolean){return"boolean"}else if(Array.isArray(e)){return"array"}else if(e===null){return"null"}else{return typeof e}}function Nn(e){return typeof e==="object"&&e!==null&&!Array.isArray(e)}function jn(e){return e}function Un(e,t){var r=t.type==="color";var a=e.stops&&typeof e.stops[0][0]==="object";var n=a||e.property!==undefined;var i=a||!n;var o=e.type||(Fn(t)?"exponential":"interval");if(r){e=Jt({},e);if(e.stops){e.stops=e.stops.map((function(e){return[e[0],br.parse(e[1])]}))}if(e.default){e.default=br.parse(e.default)}else{e.default=br.parse(t.default)}}if(e.colorSpace&&e.colorSpace!=="rgb"&&!Wa[e.colorSpace]){throw new Error("Unknown color space: "+e.colorSpace)}var s;var l;var u;if(o==="exponential"){s=Gn}else if(o==="interval"){s=qn}else if(o==="categorical"){s=Hn;l=Object.create(null);for(var c=0,f=e.stops;c<f.length;c+=1){var h=f[c];l[h[0]]=h[1]}u=typeof e.stops[0][0]}else if(o==="identity"){s=Yn}else{throw new Error('Unknown function type "'+o+'"')}if(a){var p={};var v=[];for(var d=0;d<e.stops.length;d++){var m=e.stops[d];var g=m[0].zoom;if(p[g]===undefined){p[g]={zoom:g,type:e.type,property:e.property,default:e.default,stops:[]};v.push(g)}p[g].stops.push([m[0].value,m[1]])}var y=[];for(var x=0,b=v;x<b.length;x+=1){var _=b[x];y.push([p[_].zoom,Un(p[_],t)])}var w={name:"linear"};return{kind:"composite",interpolationType:w,interpolationFactor:Xa.interpolationFactor.bind(undefined,w),zoomStops:y.map((function(e){return e[0]})),evaluate:function r(a,n){var i=a.zoom;return Gn({stops:y,base:e.base},t,i).evaluate(i,n)}}}else if(i){var T=o==="exponential"?{name:"exponential",base:e.base!==undefined?e.base:1}:null;return{kind:"camera",interpolationType:T,interpolationFactor:Xa.interpolationFactor.bind(undefined,T),zoomStops:e.stops.map((function(e){return e[0]})),evaluate:function(r){var a=r.zoom;return s(e,t,a,l,u)}}}else{return{kind:"source",evaluate:function r(a,n){var i=n&&n.properties?n.properties[e.property]:undefined;if(i===undefined){return Vn(e.default,t.default)}return s(e,t,i,l,u)}}}}function Vn(e,t,r){if(e!==undefined){return e}if(t!==undefined){return t}if(r!==undefined){return r}}function Hn(e,t,r,a,n){var i=typeof r===n?a[r]:undefined;return Vn(i,e.default,t.default)}function qn(e,t,r){if(Bn(r)!=="number"){return Vn(e.default,t.default)}var a=e.stops.length;if(a===1){return e.stops[0][1]}if(r<=e.stops[0][0]){return e.stops[0][1]}if(r>=e.stops[a-1][0]){return e.stops[a-1][1]}var n=xa(e.stops.map((function(e){return e[0]})),r);return e.stops[n][1]}function Gn(e,t,r){var a=e.base!==undefined?e.base:1;if(Bn(r)!=="number"){return Vn(e.default,t.default)}var n=e.stops.length;if(n===1){return e.stops[0][1]}if(r<=e.stops[0][0]){return e.stops[0][1]}if(r>=e.stops[n-1][0]){return e.stops[n-1][1]}var i=xa(e.stops.map((function(e){return e[0]})),r);var o=Wn(r,a,e.stops[i][0],e.stops[i+1][0]);var s=e.stops[i][1];var l=e.stops[i+1][1];var u=ka[t.type]||jn;if(e.colorSpace&&e.colorSpace!=="rgb"){var c=Wa[e.colorSpace];u=function(e,t){return c.reverse(c.interpolate(c.forward(e),c.forward(t),o))}}if(typeof s.evaluate==="function"){return{evaluate:function e(){var t=[],r=arguments.length;while(r--)t[r]=arguments[r];var a=s.evaluate.apply(undefined,t);var n=l.evaluate.apply(undefined,t);if(a===undefined||n===undefined){return undefined}return u(a,n,o)}}}return u(s,l,o)}function Yn(e,t,r){if(t.type==="color"){r=br.parse(r)}else if(t.type==="formatted"){r=Tr.fromString(r.toString())}else if(t.type==="resolvedImage"){r=kr.fromString(r.toString())}else if(Bn(r)!==t.type&&(t.type!=="enum"||!t.values[r])){r=undefined}return Vn(r,e.default,t.default)}function Wn(e,t,r,a){var n=a-r;var i=e-r;if(n===0){return 0}else if(t===1){return i/n}else{return(Math.pow(t,i)-1)/(Math.pow(t,n)-1)}}var Xn=function e(t,r){this.expression=t;this._warningHistory={};this._evaluator=new Br;this._defaultValue=r?ni(r):null;this._enumValues=r&&r.type==="enum"?r.values:null};Xn.prototype.evaluateWithoutErrorHandling=function e(t,r,a,n,i,o){this._evaluator.globals=t;this._evaluator.feature=r;this._evaluator.featureState=a;this._evaluator.canonical=n;this._evaluator.availableImages=i||null;this._evaluator.formattedSection=o;return this.expression.evaluate(this._evaluator)};Xn.prototype.evaluate=function e(t,r,a,n,i,o){this._evaluator.globals=t;this._evaluator.feature=r||null;this._evaluator.featureState=a||null;this._evaluator.canonical=n;this._evaluator.availableImages=i||null;this._evaluator.formattedSection=o||null;try{var s=this.expression.evaluate(this._evaluator);if(s===null||s===undefined||typeof s==="number"&&s!==s){return this._defaultValue}if(this._enumValues&&!(s in this._enumValues)){throw new Cr("Expected value to be one of "+Object.keys(this._enumValues).map((function(e){return JSON.stringify(e)})).join(", ")+", but found "+JSON.stringify(s)+" instead.")}return s}catch(l){if(!this._warningHistory[l.message]){this._warningHistory[l.message]=true;if(typeof console!=="undefined"){console.warn(l.message)}}return this._defaultValue}};function Zn(e){return Array.isArray(e)&&e.length>0&&typeof e[0]==="string"&&e[0]in Sn}function Jn(e,t){var r=new ga(Sn,[],t?ai(t):undefined);var a=r.parse(e,undefined,undefined,undefined,t&&t.type==="string"?{typeAnnotation:"coerce"}:undefined);if(!a){return zn(r.errors)}return On(new Xn(a,t))}var Kn=function e(t,r){this.kind=t;this._styleExpression=r;this.isStateDependent=t!=="constant"&&!va(r.expression)};Kn.prototype.evaluateWithoutErrorHandling=function e(t,r,a,n,i,o){return this._styleExpression.evaluateWithoutErrorHandling(t,r,a,n,i,o)};Kn.prototype.evaluate=function e(t,r,a,n,i,o){return this._styleExpression.evaluate(t,r,a,n,i,o)};var Qn=function e(t,r,a,n){this.kind=t;this.zoomStops=a;this._styleExpression=r;this.isStateDependent=t!=="camera"&&!va(r.expression);this.interpolationType=n};Qn.prototype.evaluateWithoutErrorHandling=function e(t,r,a,n,i,o){return this._styleExpression.evaluateWithoutErrorHandling(t,r,a,n,i,o)};Qn.prototype.evaluate=function e(t,r,a,n,i,o){return this._styleExpression.evaluate(t,r,a,n,i,o)};Qn.prototype.interpolationFactor=function e(t,r,a){if(this.interpolationType){return Xa.interpolationFactor(this.interpolationType,t,r,a)}else{return 0}};function $n(e,t){e=Jn(e,t);if(e.result==="error"){return e}var r=e.value.expression;var a=pa(r);if(!a&&!Dn(t)){return zn([new $t("","data expressions not supported")])}var n=da(r,["zoom"]);if(!n&&!Rn(t)){return zn([new $t("","zoom expressions not supported")])}var i=ri(r);if(!i&&!n){return zn([new $t("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}else if(i instanceof $t){return zn([i])}else if(i instanceof Xa&&!Fn(t)){return zn([new $t("",'"interpolate" expressions cannot be used with this property')])}if(!i){return On(a?new Kn("constant",e.value):new Kn("source",e.value))}var o=i instanceof Xa?i.interpolation:undefined;return On(a?new Qn("camera",e.value,i.labels,o):new Qn("composite",e.value,i.labels,o))}var ei=function e(t,r){this._parameters=t;this._specification=r;Jt(this,Un(this._parameters,this._specification))};ei.deserialize=function e(t){return new ei(t._parameters,t._specification)};ei.serialize=function e(t){return{_parameters:t._parameters,_specification:t._specification}};function ti(e,t){if(Nn(e)){return new ei(e,t)}else if(Zn(e)){var r=$n(e,t);if(r.result==="error"){throw new Error(r.value.map((function(e){return e.key+": "+e.message})).join(", "))}return r.value}else{var a=e;if(typeof e==="string"&&t.type==="color"){a=br.parse(e)}return{kind:"constant",evaluate:function(){return a}}}}function ri(e){var t=null;if(e instanceof Ka){t=ri(e.result)}else if(e instanceof Ja){for(var r=0,a=e.args;r<a.length;r+=1){var n=a[r];t=ri(n);if(t){break}}}else if((e instanceof ba||e instanceof Xa)&&e.input instanceof Nr&&e.input.name==="zoom"){t=e}if(t instanceof $t){return t}e.eachChild((function(e){var r=ri(e);if(r instanceof $t){t=r}else if(!t&&r){t=new $t("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')}else if(t&&r&&t!==r){t=new $t("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.')}}));return t}function ai(e){var t={color:ir,string:ar,number:rr,enum:ar,boolean:nr,formatted:cr,resolvedImage:fr};if(e.type==="array"){return hr(t[e.value]||sr,e.length)}return t[e.type]}function ni(e){if(e.type==="color"&&Nn(e.default)){return new br(0,0,0,0)}else if(e.type==="color"){return br.parse(e.default)||null}else if(e.default===undefined){return null}else{return e.default}}function ii(e){var t=e.key;var r=e.value;var a=e.valueSpec||{};var n=e.objectElementValidators||{};var i=e.style;var o=e.styleSpec;var s=[];var l=Bn(r);if(l!=="object"){return[new Xt(t,r,"object expected, "+l+" found")]}for(var u in r){var c=u.split(".")[0];var f=a[c]||a["*"];var h=void 0;if(n[c]){h=n[c]}else if(a[c]){h=Bi}else if(n["*"]){h=n["*"]}else if(a["*"]){h=Bi}else{s.push(new Xt(t,r[u],'unknown property "'+u+'"'));continue}s=s.concat(h({key:(t?t+".":t)+u,value:r[u],valueSpec:f,style:i,styleSpec:o,object:r,objectKey:u},r))}for(var p in a){if(n[p]){continue}if(a[p].required&&a[p]["default"]===undefined&&r[p]===undefined){s.push(new Xt(t,r,'missing required property "'+p+'"'))}}return s}function oi(e){var t=e.value;var r=e.valueSpec;var a=e.style;var n=e.styleSpec;var i=e.key;var o=e.arrayElementValidator||Bi;if(Bn(t)!=="array"){return[new Xt(i,t,"array expected, "+Bn(t)+" found")]}if(r.length&&t.length!==r.length){return[new Xt(i,t,"array length "+r.length+" expected, length "+t.length+" found")]}if(r["min-length"]&&t.length<r["min-length"]){return[new Xt(i,t,"array length at least "+r["min-length"]+" expected, length "+t.length+" found")]}var s={type:r.value,values:r.values};if(n.$version<7){s.function=r.function}if(Bn(r.value)==="object"){s=r.value}var l=[];for(var u=0;u<t.length;u++){l=l.concat(o({array:t,arrayIndex:u,value:t[u],valueSpec:s,style:a,styleSpec:n,key:i+"["+u+"]"}))}return l}function si(e){var t=e.key;var r=e.value;var a=e.valueSpec;var n=Bn(r);if(n==="number"&&r!==r){n="NaN"}if(n!=="number"){return[new Xt(t,r,"number expected, "+n+" found")]}if("minimum"in a&&r<a.minimum){return[new Xt(t,r,r+" is less than the minimum value "+a.minimum)]}if("maximum"in a&&r>a.maximum){return[new Xt(t,r,r+" is greater than the maximum value "+a.maximum)]}return[]}function li(e){var t=e.valueSpec;var r=Kt(e.value.type);var a;var n={};var i;var o;var s=r!=="categorical"&&e.value.property===undefined;var l=!s;var u=Bn(e.value.stops)==="array"&&Bn(e.value.stops[0])==="array"&&Bn(e.value.stops[0][0])==="object";var c=ii({key:e.key,value:e.value,valueSpec:e.styleSpec.function,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{stops:f,default:v}});if(r==="identity"&&s){c.push(new Xt(e.key,e.value,'missing required property "property"'))}if(r!=="identity"&&!e.value.stops){c.push(new Xt(e.key,e.value,'missing required property "stops"'))}if(r==="exponential"&&e.valueSpec.expression&&!Fn(e.valueSpec)){c.push(new Xt(e.key,e.value,"exponential functions not supported"))}if(e.styleSpec.$version>=8){if(l&&!Dn(e.valueSpec)){c.push(new Xt(e.key,e.value,"property functions not supported"))}else if(s&&!Rn(e.valueSpec)){c.push(new Xt(e.key,e.value,"zoom functions not supported"))}}if((r==="categorical"||u)&&e.value.property===undefined){c.push(new Xt(e.key,e.value,'"property" property is required'))}return c;function f(e){if(r==="identity"){return[new Xt(e.key,e.value,'identity function may not have a "stops" property')]}var t=[];var a=e.value;t=t.concat(oi({key:e.key,value:a,valueSpec:e.valueSpec,style:e.style,styleSpec:e.styleSpec,arrayElementValidator:h}));if(Bn(a)==="array"&&a.length===0){t.push(new Xt(e.key,a,"array must have at least one stop"))}return t}function h(e){var r=[];var a=e.value;var s=e.key;if(Bn(a)!=="array"){return[new Xt(s,a,"array expected, "+Bn(a)+" found")]}if(a.length!==2){return[new Xt(s,a,"array length 2 expected, length "+a.length+" found")]}if(u){if(Bn(a[0])!=="object"){return[new Xt(s,a,"object expected, "+Bn(a[0])+" found")]}if(a[0].zoom===undefined){return[new Xt(s,a,"object stop key must have zoom")]}if(a[0].value===undefined){return[new Xt(s,a,"object stop key must have value")]}if(o&&o>Kt(a[0].zoom)){return[new Xt(s,a[0].zoom,"stop zoom values must appear in ascending order")]}if(Kt(a[0].zoom)!==o){o=Kt(a[0].zoom);i=undefined;n={}}r=r.concat(ii({key:s+"[0]",value:a[0],valueSpec:{zoom:{}},style:e.style,styleSpec:e.styleSpec,objectElementValidators:{zoom:si,value:p}}))}else{r=r.concat(p({key:s+"[0]",value:a[0],valueSpec:{},style:e.style,styleSpec:e.styleSpec},a))}if(Zn(Qt(a[1]))){return r.concat([new Xt(s+"[1]",a[1],"expressions are not allowed in function stops.")])}return r.concat(Bi({key:s+"[1]",value:a[1],valueSpec:t,style:e.style,styleSpec:e.styleSpec}))}function p(e,o){var s=Bn(e.value);var l=Kt(e.value);var u=e.value!==null?e.value:o;if(!a){a=s}else if(s!==a){return[new Xt(e.key,u,s+" stop domain type must match previous stop domain type "+a)]}if(s!=="number"&&s!=="string"&&s!=="boolean"){return[new Xt(e.key,u,"stop domain value must be a number, string, or boolean")]}if(s!=="number"&&r!=="categorical"){var c="number expected, "+s+" found";if(Dn(t)&&r===undefined){c+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'}return[new Xt(e.key,u,c)]}if(r==="categorical"&&s==="number"&&(!isFinite(l)||Math.floor(l)!==l)){return[new Xt(e.key,u,"integer expected, found "+l)]}if(r!=="categorical"&&s==="number"&&i!==undefined&&l<i){return[new Xt(e.key,u,"stop domain values must appear in ascending order")]}else{i=l}if(r==="categorical"&&l in n){return[new Xt(e.key,u,"stop domain values must be unique")]}else{n[l]=true}return[]}function v(e){return Bi({key:e.key,value:e.value,valueSpec:t,style:e.style,styleSpec:e.styleSpec})}}function ui(e){var t=(e.expressionContext==="property"?$n:Jn)(Qt(e.value),e.valueSpec);if(t.result==="error"){return t.value.map((function(t){return new Xt(""+e.key+t.key,e.value,t.message)}))}var r=t.value.expression||t.value._styleExpression.expression;if(e.expressionContext==="property"&&e.propertyKey==="text-font"&&!r.outputDefined()){return[new Xt(e.key,e.value,'Invalid data expression for "'+e.propertyKey+'". Output values must be contained as literals within the expression.')]}if(e.expressionContext==="property"&&e.propertyType==="layout"&&!va(r)){return[new Xt(e.key,e.value,'"feature-state" data expressions are not supported with layout properties.')]}if(e.expressionContext==="filter"&&!va(r)){return[new Xt(e.key,e.value,'"feature-state" data expressions are not supported with filters.')]}if(e.expressionContext&&e.expressionContext.indexOf("cluster")===0){if(!da(r,["zoom","feature-state"])){return[new Xt(e.key,e.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')]}if(e.expressionContext==="cluster-initial"&&!pa(r)){return[new Xt(e.key,e.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}}return[]}function ci(e){var t=e.value;var r=e.key;var a=Bn(t);if(a!=="boolean"){return[new Xt(r,t,"boolean expected, "+a+" found")]}return[]}function fi(e){var t=e.key;var r=e.value;var a=Bn(r);if(a!=="string"){return[new Xt(t,r,"color expected, "+a+" found")]}if(xr(r)===null){return[new Xt(t,r,'color expected, "'+r+'" found')]}return[]}function hi(e){var t=e.key;var r=e.value;var a=e.valueSpec;var n=[];if(Array.isArray(a.values)){if(a.values.indexOf(Kt(r))===-1){n.push(new Xt(t,r,"expected one of ["+a.values.join(", ")+"], "+JSON.stringify(r)+" found"))}}else{if(Object.keys(a.values).indexOf(Kt(r))===-1){n.push(new Xt(t,r,"expected one of ["+Object.keys(a.values).join(", ")+"], "+JSON.stringify(r)+" found"))}}return n}function pi(e){if(e===true||e===false){return true}if(!Array.isArray(e)||e.length===0){return false}switch(e[0]){case"has":return e.length>=2&&e[1]!=="$id"&&e[1]!=="$type";case"in":return e.length>=3&&(typeof e[1]!=="string"||Array.isArray(e[2]));case"!in":case"!has":case"none":return false;case"==":case"!=":case">":case">=":case"<":case"<=":return e.length!==3||(Array.isArray(e[1])||Array.isArray(e[2]));case"any":case"all":for(var t=0,r=e.slice(1);t<r.length;t+=1){var a=r[t];if(!pi(a)&&typeof a!=="boolean"){return false}}return true;default:return true}}var vi={type:"boolean",default:false,transition:false,"property-type":"data-driven",expression:{interpolated:false,parameters:["zoom","feature"]}};function di(e){if(e===null||e===undefined){return{filter:function(){return true},needGeometry:false}}if(!pi(e)){e=yi(e)}var t=Jn(e,vi);if(t.result==="error"){throw new Error(t.value.map((function(e){return e.key+": "+e.message})).join(", "))}else{var r=gi(e);return{filter:function(e,r,a){return t.value.evaluate(e,r,{},a)},needGeometry:r}}}function mi(e,t){return e<t?-1:e>t?1:0}function gi(e){if(!Array.isArray(e)){return false}if(e[0]==="within"){return true}for(var t=1;t<e.length;t++){if(gi(e[t])){return true}}return false}function yi(e){if(!e){return true}var t=e[0];if(e.length<=1){return t!=="any"}var r=t==="=="?xi(e[1],e[2],"=="):t==="!="?Ti(xi(e[1],e[2],"==")):t==="<"||t===">"||t==="<="||t===">="?xi(e[1],e[2],t):t==="any"?bi(e.slice(1)):t==="all"?["all"].concat(e.slice(1).map(yi)):t==="none"?["all"].concat(e.slice(1).map(yi).map(Ti)):t==="in"?_i(e[1],e.slice(2)):t==="!in"?Ti(_i(e[1],e.slice(2))):t==="has"?wi(e[1]):t==="!has"?Ti(wi(e[1])):t==="within"?e:true;return r}function xi(e,t,r){switch(e){case"$type":return["filter-type-"+r,t];case"$id":return["filter-id-"+r,t];default:return["filter-"+r,e,t]}}function bi(e){return["any"].concat(e.map(yi))}function _i(e,t){if(t.length===0){return false}switch(e){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:if(t.length>200&&!t.some((function(e){return typeof e!==typeof t[0]}))){return["filter-in-large",e,["literal",t.sort(mi)]]}else{return["filter-in-small",e,["literal",t]]}}}function wi(e){switch(e){case"$type":return true;case"$id":return["filter-has-id"];default:return["filter-has",e]}}function Ti(e){return["!",e]}function ki(e){if(pi(Qt(e.value))){return ui(Jt({},e,{expressionContext:"filter",valueSpec:{value:"boolean"}}))}else{return Mi(e)}}function Mi(e){var t=e.value;var r=e.key;if(Bn(t)!=="array"){return[new Xt(r,t,"array expected, "+Bn(t)+" found")]}var a=e.styleSpec;var n;var i=[];if(t.length<1){return[new Xt(r,t,"filter array must have at least 1 element")]}i=i.concat(hi({key:r+"[0]",value:t[0],valueSpec:a.filter_operator,style:e.style,styleSpec:e.styleSpec}));switch(Kt(t[0])){case"<":case"<=":case">":case">=":if(t.length>=2&&Kt(t[1])==="$type"){i.push(new Xt(r,t,'"$type" cannot be use with operator "'+t[0]+'"'))}case"==":case"!=":if(t.length!==3){i.push(new Xt(r,t,'filter array for operator "'+t[0]+'" must have 3 elements'))}case"in":case"!in":if(t.length>=2){n=Bn(t[1]);if(n!=="string"){i.push(new Xt(r+"[1]",t[1],"string expected, "+n+" found"))}}for(var o=2;o<t.length;o++){n=Bn(t[o]);if(Kt(t[1])==="$type"){i=i.concat(hi({key:r+"["+o+"]",value:t[o],valueSpec:a.geometry_type,style:e.style,styleSpec:e.styleSpec}))}else if(n!=="string"&&n!=="number"&&n!=="boolean"){i.push(new Xt(r+"["+o+"]",t[o],"string, number, or boolean expected, "+n+" found"))}}break;case"any":case"all":case"none":for(var s=1;s<t.length;s++){i=i.concat(Mi({key:r+"["+s+"]",value:t[s],style:e.style,styleSpec:e.styleSpec}))}break;case"has":case"!has":n=Bn(t[1]);if(t.length!==2){i.push(new Xt(r,t,'filter array for "'+t[0]+'" operator must have 2 elements'))}else if(n!=="string"){i.push(new Xt(r+"[1]",t[1],"string expected, "+n+" found"))}break;case"within":n=Bn(t[1]);if(t.length!==2){i.push(new Xt(r,t,'filter array for "'+t[0]+'" operator must have 2 elements'))}else if(n!=="object"){i.push(new Xt(r+"[1]",t[1],"object expected, "+n+" found"))}break}return i}function Ai(e,t){var r=e.key;var a=e.style;var n=e.styleSpec;var i=e.value;var o=e.objectKey;var s=n[t+"_"+e.layerType];if(!s){return[]}var l=o.match(/^(.*)-transition$/);if(t==="paint"&&l&&s[l[1]]&&s[l[1]].transition){return Bi({key:r,value:i,valueSpec:n.transition,style:a,styleSpec:n})}var u=e.valueSpec||s[o];if(!u){return[new Xt(r,i,'unknown property "'+o+'"')]}var c;if(Bn(i)==="string"&&Dn(u)&&!u.tokens&&(c=/^{([^}]+)}$/.exec(i))){return[new Xt(r,i,'"'+o+'" does not support interpolation syntax\n'+'Use an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(c[1])+" }`.")]}var f=[];if(e.layerType==="symbol"){if(o==="text-field"&&a&&!a.glyphs){f.push(new Xt(r,i,'use of "text-field" requires a style "glyphs" property'))}if(o==="text-font"&&Nn(Qt(i))&&Kt(i.type)==="identity"){f.push(new Xt(r,i,'"text-font" does not support identity functions'))}}return f.concat(Bi({key:e.key,value:i,valueSpec:u,style:a,styleSpec:n,expressionContext:"property",propertyType:t,propertyKey:o}))}function Si(e){return Ai(e,"paint")}function Ei(e){return Ai(e,"layout")}function Li(e){var t=[];var r=e.value;var a=e.key;var n=e.style;var i=e.styleSpec;if(!r.type&&!r.ref){t.push(new Xt(a,r,'either "type" or "ref" is required'))}var o=Kt(r.type);var s=Kt(r.ref);if(r.id){var l=Kt(r.id);for(var u=0;u<e.arrayIndex;u++){var c=n.layers[u];if(Kt(c.id)===l){t.push(new Xt(a,r.id,'duplicate layer id "'+r.id+'", previously used at line '+c.id.__line__))}}}if("ref"in r){["type","source","source-layer","filter","layout"].forEach((function(e){if(e in r){t.push(new Xt(a,r[e],'"'+e+'" is prohibited for ref layers'))}}));var f;n.layers.forEach((function(e){if(Kt(e.id)===s){f=e}}));if(!f){t.push(new Xt(a,r.ref,'ref layer "'+s+'" not found'))}else if(f.ref){t.push(new Xt(a,r.ref,"ref cannot reference another ref layer"))}else{o=Kt(f.type)}}else if(o!=="background"){if(!r.source){t.push(new Xt(a,r,'missing required property "source"'))}else{var h=n.sources&&n.sources[r.source];var p=h&&Kt(h.type);if(!h){t.push(new Xt(a,r.source,'source "'+r.source+'" not found'))}else if(p==="vector"&&o==="raster"){t.push(new Xt(a,r.source,'layer "'+r.id+'" requires a raster source'))}else if(p==="raster"&&o!=="raster"){t.push(new Xt(a,r.source,'layer "'+r.id+'" requires a vector source'))}else if(p==="vector"&&!r["source-layer"]){t.push(new Xt(a,r,'layer "'+r.id+'" must specify a "source-layer"'))}else if(p==="raster-dem"&&o!=="hillshade"){t.push(new Xt(a,r.source,"raster-dem source can only be used with layer type 'hillshade'."))}else if(o==="line"&&r.paint&&r.paint["line-gradient"]&&(p!=="geojson"||!h.lineMetrics)){t.push(new Xt(a,r,'layer "'+r.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.'))}}}t=t.concat(ii({key:a,value:r,valueSpec:i.layer,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":function e(){return[]},type:function t(){return Bi({key:a+".type",value:r.type,valueSpec:i.layer.type,style:e.style,styleSpec:e.styleSpec,object:r,objectKey:"type"})},filter:ki,layout:function e(t){return ii({layer:r,key:t.key,value:t.value,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":function e(t){return Ei(Jt({layerType:o},t))}}})},paint:function e(t){return ii({layer:r,key:t.key,value:t.value,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":function e(t){return Si(Jt({layerType:o},t))}}})}}}));return t}function Ci(e){var t=e.value;var r=e.key;var a=Bn(t);if(a!=="string"){return[new Xt(r,t,"string expected, "+a+" found")]}return[]}var Ii={promoteId:Oi};function Pi(e){var t=e.value;var r=e.key;var a=e.styleSpec;var n=e.style;if(!t.type){return[new Xt(r,t,'"type" is required')]}var i=Kt(t.type);var o;switch(i){case"vector":case"raster":case"raster-dem":o=ii({key:r,value:t,valueSpec:a["source_"+i.replace("-","_")],style:e.style,styleSpec:a,objectElementValidators:Ii});return o;case"geojson":o=ii({key:r,value:t,valueSpec:a.source_geojson,style:n,styleSpec:a,objectElementValidators:Ii});if(t.cluster){for(var s in t.clusterProperties){var l=t.clusterProperties[s];var u=l[0];var c=l[1];var f=typeof u==="string"?[u,["accumulated"],["get",s]]:u;o.push.apply(o,ui({key:r+"."+s+".map",value:c,expressionContext:"cluster-map"}));o.push.apply(o,ui({key:r+"."+s+".reduce",value:f,expressionContext:"cluster-reduce"}))}}return o;case"video":return ii({key:r,value:t,valueSpec:a.source_video,style:n,styleSpec:a});case"image":return ii({key:r,value:t,valueSpec:a.source_image,style:n,styleSpec:a});case"canvas":return[new Xt(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return hi({key:r+".type",value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:n,styleSpec:a})}}function Oi(e){var t=e.key;var r=e.value;if(Bn(r)==="string"){return Ci({key:t,value:r})}else{var a=[];for(var n in r){a.push.apply(a,Ci({key:t+"."+n,value:r[n]}))}return a}}function zi(e){var t=e.value;var r=e.styleSpec;var a=r.light;var n=e.style;var i=[];var o=Bn(t);if(t===undefined){return i}else if(o!=="object"){i=i.concat([new Xt("light",t,"object expected, "+o+" found")]);return i}for(var s in t){var l=s.match(/^(.*)-transition$/);if(l&&a[l[1]]&&a[l[1]].transition){i=i.concat(Bi({key:s,value:t[s],valueSpec:r.transition,style:n,styleSpec:r}))}else if(a[s]){i=i.concat(Bi({key:s,value:t[s],valueSpec:a[s],style:n,styleSpec:r}))}else{i=i.concat([new Xt(s,t[s],'unknown property "'+s+'"')])}}return i}function Di(e){if(Ci(e).length===0){return[]}return ui(e)}function Ri(e){if(Ci(e).length===0){return[]}return ui(e)}var Fi={"*":function e(){return[]},array:oi,boolean:ci,number:si,color:fi,constants:Zt,enum:hi,filter:ki,function:li,layer:Li,object:ii,source:Pi,light:zi,string:Ci,formatted:Di,resolvedImage:Ri};function Bi(e){var t=e.value;var r=e.valueSpec;var a=e.styleSpec;if(r.expression&&Nn(Kt(t))){return li(e)}else if(r.expression&&Zn(Qt(t))){return ui(e)}else if(r.type&&Fi[r.type]){return Fi[r.type](e)}else{var n=ii(Jt({},e,{valueSpec:r.type?a[r.type]:r}));return n}}function Ni(e){var t=e.value;var r=e.key;var a=Ci(e);if(a.length){return a}if(t.indexOf("{fontstack}")===-1){a.push(new Xt(r,t,'"glyphs" url must include a "{fontstack}" token'))}if(t.indexOf("{range}")===-1){a.push(new Xt(r,t,'"glyphs" url must include a "{range}" token'))}return a}function ji(e,t){if(t===void 0)t=Wt;var r=[];r=r.concat(Bi({key:"",value:e,valueSpec:t.$root,styleSpec:t,style:e,objectElementValidators:{glyphs:Ni,"*":function e(){return[]}}}));if(e.constants){r=r.concat(Zt({key:"constants",value:e.constants,style:e,styleSpec:t}))}return Ui(r)}ji.source=Vi(Pi);ji.light=Vi(zi);ji.layer=Vi(Li);ji.filter=Vi(ki);ji.paintProperty=Vi(Si);ji.layoutProperty=Vi(Ei);function Ui(e){return[].concat(e).sort((function(e,t){return e.line-t.line}))}function Vi(e){return function(){var t=[],r=arguments.length;while(r--)t[r]=arguments[r];return Ui(e.apply(this,t))}}var Hi=ji;var qi=Hi.light;var Gi=Hi.paintProperty;var Yi=Hi.layoutProperty;function Wi(e,t){var r=false;if(t&&t.length){for(var a=0,n=t;a<n.length;a+=1){var i=n[a];e.fire(new st(new Error(i.message)));r=true}}return r}var Xi=Ji;var Zi=3;function Ji(e,t,r){var a=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;var n=new Int32Array(this.arrayBuffer);e=n[0];t=n[1];r=n[2];this.d=t+2*r;for(var i=0;i<this.d*this.d;i++){var o=n[Zi+i];var s=n[Zi+i+1];a.push(o===s?null:n.subarray(o,s))}var l=n[Zi+a.length];var u=n[Zi+a.length+1];this.keys=n.subarray(l,u);this.bboxes=n.subarray(u);this.insert=this._insertReadonly}else{this.d=t+2*r;for(var c=0;c<this.d*this.d;c++){a.push([])}this.keys=[];this.bboxes=[]}this.n=t;this.extent=e;this.padding=r;this.scale=t/e;this.uid=0;var f=r/t*e;this.min=-f;this.max=e+f}Ji.prototype.insert=function(e,t,r,a,n){this._forEachCell(t,r,a,n,this._insertCell,this.uid++);this.keys.push(e);this.bboxes.push(t);this.bboxes.push(r);this.bboxes.push(a);this.bboxes.push(n)};Ji.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."};Ji.prototype._insertCell=function(e,t,r,a,n,i){this.cells[n].push(i)};Ji.prototype.query=function(e,t,r,a,n){var i=this.min;var o=this.max;if(e<=i&&t<=i&&o<=r&&o<=a&&!n){return Array.prototype.slice.call(this.keys)}else{var s=[];var l={};this._forEachCell(e,t,r,a,this._queryCell,s,l,n);return s}};Ji.prototype._queryCell=function(e,t,r,a,n,i,o,s){var l=this.cells[n];if(l!==null){var u=this.keys;var c=this.bboxes;for(var f=0;f<l.length;f++){var h=l[f];if(o[h]===undefined){var p=h*4;if(s?s(c[p+0],c[p+1],c[p+2],c[p+3]):e<=c[p+2]&&t<=c[p+3]&&r>=c[p+0]&&a>=c[p+1]){o[h]=true;i.push(u[h])}else{o[h]=false}}}}};Ji.prototype._forEachCell=function(e,t,r,a,n,i,o,s){var l=this._convertToCellCoord(e);var u=this._convertToCellCoord(t);var c=this._convertToCellCoord(r);var f=this._convertToCellCoord(a);for(var h=l;h<=c;h++){for(var p=u;p<=f;p++){var v=this.d*p+h;if(s&&!s(this._convertFromCellCoord(h),this._convertFromCellCoord(p),this._convertFromCellCoord(h+1),this._convertFromCellCoord(p+1))){continue}if(n.call(this,e,t,r,a,v,i,o,s)){return}}}};Ji.prototype._convertFromCellCoord=function(e){return(e-this.padding)/this.scale};Ji.prototype._convertToCellCoord=function(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))};Ji.prototype.toArrayBuffer=function(){if(this.arrayBuffer){return this.arrayBuffer}var e=this.cells;var t=Zi+this.cells.length+1+1;var r=0;for(var a=0;a<this.cells.length;a++){r+=this.cells[a].length}var n=new Int32Array(t+r+this.keys.length+this.bboxes.length);n[0]=this.extent;n[1]=this.n;n[2]=this.padding;var i=t;for(var o=0;o<e.length;o++){var s=e[o];n[Zi+o]=i;n.set(s,i);i+=s.length}n[Zi+e.length]=i;n.set(this.keys,i);i+=this.keys.length;n[Zi+e.length+1]=i;n.set(this.bboxes,i);i+=this.bboxes.length;return n.buffer};var Ki=self.ImageData;var Qi=self.ImageBitmap;var $i={};function eo(e,t,r){if(r===void 0)r={};Object.defineProperty(t,"_classRegistryKey",{value:e,writeable:false});$i[e]={klass:t,omit:r.omit||[],shallow:r.shallow||[]}}eo("Object",Object);Xi.serialize=function e(t,r){var a=t.toArrayBuffer();if(r){r.push(a)}return{buffer:a}};Xi.deserialize=function e(t){return new Xi(t.buffer)};eo("Grid",Xi);eo("Color",br);eo("Error",Error);eo("ResolvedImage",kr);eo("StylePropertyFunction",ei);eo("StyleExpression",Xn,{omit:["_evaluator"]});eo("ZoomDependentExpression",Qn);eo("ZoomConstantExpression",Kn);eo("CompoundExpression",Nr,{omit:["_evaluate"]});for(var to in Sn){if(Sn[to]._classRegistryKey){continue}eo("Expression_"+to,Sn[to])}function ro(e){return e&&typeof ArrayBuffer!=="undefined"&&(e instanceof ArrayBuffer||e.constructor&&e.constructor.name==="ArrayBuffer")}function ao(e){return Qi&&e instanceof Qi}function no(e,t){if(e===null||e===undefined||typeof e==="boolean"||typeof e==="number"||typeof e==="string"||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp){return e}if(ro(e)||ao(e)){if(t){t.push(e)}return e}if(ArrayBuffer.isView(e)){var r=e;if(t){t.push(r.buffer)}return r}if(e instanceof Ki){if(t){t.push(e.data.buffer)}return e}if(Array.isArray(e)){var a=[];for(var n=0,i=e;n<i.length;n+=1){var o=i[n];a.push(no(o,t))}return a}if(typeof e==="object"){var s=e.constructor;var l=s._classRegistryKey;if(!l){throw new Error("can't serialize object of unregistered class")}var u=s.serialize?s.serialize(e,t):{};if(!s.serialize){for(var c in e){if(!e.hasOwnProperty(c)){continue}if($i[l].omit.indexOf(c)>=0){continue}var f=e[c];u[c]=$i[l].shallow.indexOf(c)>=0?f:no(f,t)}if(e instanceof Error){u.message=e.message}}if(u.$name){throw new Error("$name property is reserved for worker serialization logic.")}if(l!=="Object"){u.$name=l}return u}throw new Error("can't serialize object of type "+typeof e)}function io(e){if(e===null||e===undefined||typeof e==="boolean"||typeof e==="number"||typeof e==="string"||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp||ro(e)||ao(e)||ArrayBuffer.isView(e)||e instanceof Ki){return e}if(Array.isArray(e)){return e.map(io)}if(typeof e==="object"){var t=e.$name||"Object";var r=$i[t];var a=r.klass;if(!a){throw new Error("can't deserialize unregistered class "+t)}if(a.deserialize){return a.deserialize(e)}var n=Object.create(a.prototype);for(var i=0,o=Object.keys(e);i<o.length;i+=1){var s=o[i];if(s==="$name"){continue}var l=e[s];n[s]=$i[t].shallow.indexOf(s)>=0?l:io(l)}return n}throw new Error("can't deserialize object of type "+typeof e)}var oo=function e(){this.first=true};oo.prototype.update=function e(t,r){var a=Math.floor(t);if(this.first){this.first=false;this.lastIntegerZoom=a;this.lastIntegerZoomTime=0;this.lastZoom=t;this.lastFloorZoom=a;return true}if(this.lastFloorZoom>a){this.lastIntegerZoom=a+1;this.lastIntegerZoomTime=r}else if(this.lastFloorZoom<a){this.lastIntegerZoom=a;this.lastIntegerZoomTime=r}if(t!==this.lastZoom){this.lastZoom=t;this.lastFloorZoom=a;return true}return false};var so={"Latin-1 Supplement":function(e){return e>=128&&e<=255},Arabic:function(e){return e>=1536&&e<=1791},"Arabic Supplement":function(e){return e>=1872&&e<=1919},"Arabic Extended-A":function(e){return e>=2208&&e<=2303},"Hangul Jamo":function(e){return e>=4352&&e<=4607},"Unified Canadian Aboriginal Syllabics":function(e){return e>=5120&&e<=5759},Khmer:function(e){return e>=6016&&e<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(e){return e>=6320&&e<=6399},"General Punctuation":function(e){return e>=8192&&e<=8303},"Letterlike Symbols":function(e){return e>=8448&&e<=8527},"Number Forms":function(e){return e>=8528&&e<=8591},"Miscellaneous Technical":function(e){return e>=8960&&e<=9215},"Control Pictures":function(e){return e>=9216&&e<=9279},"Optical Character Recognition":function(e){return e>=9280&&e<=9311},"Enclosed Alphanumerics":function(e){return e>=9312&&e<=9471},"Geometric Shapes":function(e){return e>=9632&&e<=9727},"Miscellaneous Symbols":function(e){return e>=9728&&e<=9983},"Miscellaneous Symbols and Arrows":function(e){return e>=11008&&e<=11263},"CJK Radicals Supplement":function(e){return e>=11904&&e<=12031},"Kangxi Radicals":function(e){return e>=12032&&e<=12255},"Ideographic Description Characters":function(e){return e>=12272&&e<=12287},"CJK Symbols and Punctuation":function(e){return e>=12288&&e<=12351},Hiragana:function(e){return e>=12352&&e<=12447},Katakana:function(e){return e>=12448&&e<=12543},Bopomofo:function(e){return e>=12544&&e<=12591},"Hangul Compatibility Jamo":function(e){return e>=12592&&e<=12687},Kanbun:function(e){return e>=12688&&e<=12703},"Bopomofo Extended":function(e){return e>=12704&&e<=12735},"CJK Strokes":function(e){return e>=12736&&e<=12783},"Katakana Phonetic Extensions":function(e){return e>=12784&&e<=12799},"Enclosed CJK Letters and Months":function(e){return e>=12800&&e<=13055},"CJK Compatibility":function(e){return e>=13056&&e<=13311},"CJK Unified Ideographs Extension A":function(e){return e>=13312&&e<=19903},"Yijing Hexagram Symbols":function(e){return e>=19904&&e<=19967},"CJK Unified Ideographs":function(e){return e>=19968&&e<=40959},"Yi Syllables":function(e){return e>=40960&&e<=42127},"Yi Radicals":function(e){return e>=42128&&e<=42191},"Hangul Jamo Extended-A":function(e){return e>=43360&&e<=43391},"Hangul Syllables":function(e){return e>=44032&&e<=55215},"Hangul Jamo Extended-B":function(e){return e>=55216&&e<=55295},"Private Use Area":function(e){return e>=57344&&e<=63743},"CJK Compatibility Ideographs":function(e){return e>=63744&&e<=64255},"Arabic Presentation Forms-A":function(e){return e>=64336&&e<=65023},"Vertical Forms":function(e){return e>=65040&&e<=65055},"CJK Compatibility Forms":function(e){return e>=65072&&e<=65103},"Small Form Variants":function(e){return e>=65104&&e<=65135},"Arabic Presentation Forms-B":function(e){return e>=65136&&e<=65279},"Halfwidth and Fullwidth Forms":function(e){return e>=65280&&e<=65519}};function lo(e){for(var t=0,r=e;t<r.length;t+=1){var a=r[t];if(ho(a.charCodeAt(0))){return true}}return false}function uo(e){for(var t=0,r=e;t<r.length;t+=1){var a=r[t];if(!co(a.charCodeAt(0))){return false}}return true}function co(e){if(so["Arabic"](e)){return false}if(so["Arabic Supplement"](e)){return false}if(so["Arabic Extended-A"](e)){return false}if(so["Arabic Presentation Forms-A"](e)){return false}if(so["Arabic Presentation Forms-B"](e)){return false}return true}function fo(e){if(e<11904){return false}if(so["Bopomofo Extended"](e)){return true}if(so["Bopomofo"](e)){return true}if(so["CJK Compatibility Forms"](e)){return true}if(so["CJK Compatibility Ideographs"](e)){return true}if(so["CJK Compatibility"](e)){return true}if(so["CJK Radicals Supplement"](e)){return true}if(so["CJK Strokes"](e)){return true}if(so["CJK Symbols and Punctuation"](e)){return true}if(so["CJK Unified Ideographs Extension A"](e)){return true}if(so["CJK Unified Ideographs"](e)){return true}if(so["Enclosed CJK Letters and Months"](e)){return true}if(so["Halfwidth and Fullwidth Forms"](e)){return true}if(so["Hiragana"](e)){return true}if(so["Ideographic Description Characters"](e)){return true}if(so["Kangxi Radicals"](e)){return true}if(so["Katakana Phonetic Extensions"](e)){return true}if(so["Katakana"](e)){return true}if(so["Vertical Forms"](e)){return true}if(so["Yi Radicals"](e)){return true}if(so["Yi Syllables"](e)){return true}return false}function ho(e){if(e===746||e===747){return true}if(e<4352){return false}if(so["Bopomofo Extended"](e)){return true}if(so["Bopomofo"](e)){return true}if(so["CJK Compatibility Forms"](e)){if(!(e>=65097&&e<=65103)){return true}}if(so["CJK Compatibility Ideographs"](e)){return true}if(so["CJK Compatibility"](e)){return true}if(so["CJK Radicals Supplement"](e)){return true}if(so["CJK Strokes"](e)){return true}if(so["CJK Symbols and Punctuation"](e)){if(!(e>=12296&&e<=12305)&&!(e>=12308&&e<=12319)&&e!==12336){return true}}if(so["CJK Unified Ideographs Extension A"](e)){return true}if(so["CJK Unified Ideographs"](e)){return true}if(so["Enclosed CJK Letters and Months"](e)){return true}if(so["Hangul Compatibility Jamo"](e)){return true}if(so["Hangul Jamo Extended-A"](e)){return true}if(so["Hangul Jamo Extended-B"](e)){return true}if(so["Hangul Jamo"](e)){return true}if(so["Hangul Syllables"](e)){return true}if(so["Hiragana"](e)){return true}if(so["Ideographic Description Characters"](e)){return true}if(so["Kanbun"](e)){return true}if(so["Kangxi Radicals"](e)){return true}if(so["Katakana Phonetic Extensions"](e)){return true}if(so["Katakana"](e)){if(e!==12540){return true}}if(so["Halfwidth and Fullwidth Forms"](e)){if(e!==65288&&e!==65289&&e!==65293&&!(e>=65306&&e<=65310)&&e!==65339&&e!==65341&&e!==65343&&!(e>=65371&&e<=65503)&&e!==65507&&!(e>=65512&&e<=65519)){return true}}if(so["Small Form Variants"](e)){if(!(e>=65112&&e<=65118)&&!(e>=65123&&e<=65126)){return true}}if(so["Unified Canadian Aboriginal Syllabics"](e)){return true}if(so["Unified Canadian Aboriginal Syllabics Extended"](e)){return true}if(so["Vertical Forms"](e)){return true}if(so["Yijing Hexagram Symbols"](e)){return true}if(so["Yi Syllables"](e)){return true}if(so["Yi Radicals"](e)){return true}return false}function po(e){if(so["Latin-1 Supplement"](e)){if(e===167||e===169||e===174||e===177||e===188||e===189||e===190||e===215||e===247){return true}}if(so["General Punctuation"](e)){if(e===8214||e===8224||e===8225||e===8240||e===8241||e===8251||e===8252||e===8258||e===8263||e===8264||e===8265||e===8273){return true}}if(so["Letterlike Symbols"](e)){return true}if(so["Number Forms"](e)){return true}if(so["Miscellaneous Technical"](e)){if(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||e===9003||e>=9085&&e<=9114||e>=9150&&e<=9165||e===9167||e>=9169&&e<=9179||e>=9186&&e<=9215){return true}}if(so["Control Pictures"](e)&&e!==9251){return true}if(so["Optical Character Recognition"](e)){return true}if(so["Enclosed Alphanumerics"](e)){return true}if(so["Geometric Shapes"](e)){return true}if(so["Miscellaneous Symbols"](e)){if(!(e>=9754&&e<=9759)){return true}}if(so["Miscellaneous Symbols and Arrows"](e)){if(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243){return true}}if(so["CJK Symbols and Punctuation"](e)){return true}if(so["Katakana"](e)){return true}if(so["Private Use Area"](e)){return true}if(so["CJK Compatibility Forms"](e)){return true}if(so["Small Form Variants"](e)){return true}if(so["Halfwidth and Fullwidth Forms"](e)){return true}if(e===8734||e===8756||e===8757||e>=9984&&e<=10087||e>=10102&&e<=10131||e===65532||e===65533){return true}return false}function vo(e){return!(ho(e)||po(e))}function mo(e){return so["Arabic"](e)||so["Arabic Supplement"](e)||so["Arabic Extended-A"](e)||so["Arabic Presentation Forms-A"](e)||so["Arabic Presentation Forms-B"](e)}function go(e){return e>=1424&&e<=2303||so["Arabic Presentation Forms-A"](e)||so["Arabic Presentation Forms-B"](e)}function yo(e,t){if(!t&&go(e)){return false}if(e>=2304&&e<=3583||e>=3840&&e<=4255||so["Khmer"](e)){return false}return true}function xo(e){for(var t=0,r=e;t<r.length;t+=1){var a=r[t];if(go(a.charCodeAt(0))){return true}}return false}function bo(e,t){for(var r=0,a=e;r<a.length;r+=1){var n=a[r];if(!yo(n.charCodeAt(0),t)){return false}}return true}var _o={unavailable:"unavailable",deferred:"deferred",loading:"loading",loaded:"loaded",error:"error"};var wo=null;var To=_o.unavailable;var ko=null;var Mo=function(e){if(e&&typeof e==="string"&&e.indexOf("NetworkError")>-1){To=_o.error}if(wo){wo(e)}};function Ao(){So.fire(new ot("pluginStateChange",{pluginStatus:To,pluginURL:ko}))}var So=new lt;var Eo=function(){return To};var Lo=function(e){e({pluginStatus:To,pluginURL:ko});So.on("pluginStateChange",e);return e};var Co=function(e,t,r){if(r===void 0)r=false;if(To===_o.deferred||To===_o.loading||To===_o.loaded){throw new Error("setRTLTextPlugin cannot be called multiple times.")}ko=G.resolveURL(e);To=_o.deferred;wo=t;Ao();if(!r){Io()}};var Io=function(){if(To!==_o.deferred||!ko){throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified")}To=_o.loading;Ao();if(ko){We({url:ko},(function(e){if(e){Mo(e)}else{To=_o.loaded;Ao()}}))}};var Po={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function e(){return To===_o.loaded||Po.applyArabicShaping!=null},isLoading:function e(){return To===_o.loading},setState:function e(t){To=t.pluginStatus;ko=t.pluginURL},isParsed:function e(){return Po.applyArabicShaping!=null&&Po.processBidirectionalText!=null&&Po.processStyledBidirectionalText!=null},getPluginURL:function e(){return ko}};var Oo=function(){if(!Po.isLoading()&&!Po.isLoaded()&&Eo()==="deferred"){Io()}};var zo=function e(t,r){this.zoom=t;if(r){this.now=r.now;this.fadeDuration=r.fadeDuration;this.zoomHistory=r.zoomHistory;this.transition=r.transition}else{this.now=0;this.fadeDuration=0;this.zoomHistory=new oo;this.transition={}}};zo.prototype.isSupportedScript=function e(t){return bo(t,Po.isLoaded())};zo.prototype.crossFadingFactor=function e(){if(this.fadeDuration===0){return 1}else{return Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}};zo.prototype.getCrossfadeParameters=function e(){var t=this.zoom;var r=t-Math.floor(t);var a=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:r+(1-r)*a}:{fromScale:.5,toScale:1,t:1-(1-a)*r}};var Do=function e(t,r){this.property=t;this.value=r;this.expression=ti(r===undefined?t.specification.default:r,t.specification)};Do.prototype.isDataDriven=function e(){return this.expression.kind==="source"||this.expression.kind==="composite"};Do.prototype.possiblyEvaluate=function e(t,r,a){return this.property.possiblyEvaluate(this,t,r,a)};var Ro=function e(t){this.property=t;this.value=new Do(t,undefined)};Ro.prototype.transitioned=function e(t,r){return new Bo(this.property,this.value,r,m({},t.transition,this.transition),t.now)};Ro.prototype.untransitioned=function e(){return new Bo(this.property,this.value,null,{},0)};var Fo=function e(t){this._properties=t;this._values=Object.create(t.defaultTransitionablePropertyValues)};Fo.prototype.getValue=function e(t){return A(this._values[t].value.value)};Fo.prototype.setValue=function e(t,r){if(!this._values.hasOwnProperty(t)){this._values[t]=new Ro(this._values[t].property)}this._values[t].value=new Do(this._values[t].property,r===null?undefined:A(r))};Fo.prototype.getTransition=function e(t){return A(this._values[t].transition)};Fo.prototype.setTransition=function e(t,r){if(!this._values.hasOwnProperty(t)){this._values[t]=new Ro(this._values[t].property)}this._values[t].transition=A(r)||undefined};Fo.prototype.serialize=function e(){var t={};for(var r=0,a=Object.keys(this._values);r<a.length;r+=1){var n=a[r];var i=this.getValue(n);if(i!==undefined){t[n]=i}var o=this.getTransition(n);if(o!==undefined){t[n+"-transition"]=o}}return t};Fo.prototype.transitioned=function e(t,r){var a=new No(this._properties);for(var n=0,i=Object.keys(this._values);n<i.length;n+=1){var o=i[n];a._values[o]=this._values[o].transitioned(t,r._values[o])}return a};Fo.prototype.untransitioned=function e(){var t=new No(this._properties);for(var r=0,a=Object.keys(this._values);r<a.length;r+=1){var n=a[r];t._values[n]=this._values[n].untransitioned()}return t};var Bo=function e(t,r,a,n,i){this.property=t;this.value=r;this.begin=i+n.delay||0;this.end=this.begin+n.duration||0;if(t.specification.transition&&(n.delay||n.duration)){this.prior=a}};Bo.prototype.possiblyEvaluate=function e(t,r,a){var n=t.now||0;var i=this.value.possiblyEvaluate(t,r,a);var o=this.prior;if(!o){return i}else if(n>this.end){this.prior=null;return i}else if(this.value.isDataDriven()){this.prior=null;return i}else if(n<this.begin){return o.possiblyEvaluate(t,r,a)}else{var s=(n-this.begin)/(this.end-this.begin);return this.property.interpolate(o.possiblyEvaluate(t,r,a),i,l(s))}};var No=function e(t){this._properties=t;this._values=Object.create(t.defaultTransitioningPropertyValues)};No.prototype.possiblyEvaluate=function e(t,r,a){var n=new Vo(this._properties);for(var i=0,o=Object.keys(this._values);i<o.length;i+=1){var s=o[i];n._values[s]=this._values[s].possiblyEvaluate(t,r,a)}return n};No.prototype.hasTransition=function e(){for(var t=0,r=Object.keys(this._values);t<r.length;t+=1){var a=r[t];if(this._values[a].prior){return true}}return false};var jo=function e(t){this._properties=t;this._values=Object.create(t.defaultPropertyValues)};jo.prototype.getValue=function e(t){return A(this._values[t].value)};jo.prototype.setValue=function e(t,r){this._values[t]=new Do(this._values[t].property,r===null?undefined:A(r))};jo.prototype.serialize=function e(){var t={};for(var r=0,a=Object.keys(this._values);r<a.length;r+=1){var n=a[r];var i=this.getValue(n);if(i!==undefined){t[n]=i}}return t};jo.prototype.possiblyEvaluate=function e(t,r,a){var n=new Vo(this._properties);for(var i=0,o=Object.keys(this._values);i<o.length;i+=1){var s=o[i];n._values[s]=this._values[s].possiblyEvaluate(t,r,a)}return n};var Uo=function e(t,r,a){this.property=t;this.value=r;this.parameters=a};Uo.prototype.isConstant=function e(){return this.value.kind==="constant"};Uo.prototype.constantOr=function e(t){if(this.value.kind==="constant"){return this.value.value}else{return t}};Uo.prototype.evaluate=function e(t,r,a,n){return this.property.evaluate(this.value,this.parameters,t,r,a,n)};var Vo=function e(t){this._properties=t;this._values=Object.create(t.defaultPossiblyEvaluatedValues)};Vo.prototype.get=function e(t){return this._values[t]};var Ho=function e(t){this.specification=t};Ho.prototype.possiblyEvaluate=function e(t,r){return t.expression.evaluate(r)};Ho.prototype.interpolate=function e(t,r,a){var n=ka[this.specification.type];if(n){return n(t,r,a)}else{return t}};var qo=function e(t,r){this.specification=t;this.overrides=r};qo.prototype.possiblyEvaluate=function e(t,r,a,n){if(t.expression.kind==="constant"||t.expression.kind==="camera"){return new Uo(this,{kind:"constant",value:t.expression.evaluate(r,null,{},a,n)},r)}else{return new Uo(this,t.expression,r)}};qo.prototype.interpolate=function e(t,r,a){if(t.value.kind!=="constant"||r.value.kind!=="constant"){return t}if(t.value.value===undefined||r.value.value===undefined){return new Uo(this,{kind:"constant",value:undefined},t.parameters)}var n=ka[this.specification.type];if(n){return new Uo(this,{kind:"constant",value:n(t.value.value,r.value.value,a)},t.parameters)}else{return t}};qo.prototype.evaluate=function e(t,r,a,n,i,o){if(t.kind==="constant"){return t.value}else{return t.evaluate(r,a,n,i,o)}};var Go=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype.possiblyEvaluate=function e(t,r,a,n){if(t.value===undefined){return new Uo(this,{kind:"constant",value:undefined},r)}else if(t.expression.kind==="constant"){var i=t.expression.evaluate(r,null,{},a,n);var o=t.property.specification.type==="resolvedImage";var s=o&&typeof i!=="string"?i.name:i;var l=this._calculate(s,s,s,r);return new Uo(this,{kind:"constant",value:l},r)}else if(t.expression.kind==="camera"){var u=this._calculate(t.expression.evaluate({zoom:r.zoom-1}),t.expression.evaluate({zoom:r.zoom}),t.expression.evaluate({zoom:r.zoom+1}),r);return new Uo(this,{kind:"constant",value:u},r)}else{return new Uo(this,t.expression,r)}};t.prototype.evaluate=function e(t,r,a,n,i,o){if(t.kind==="source"){var s=t.evaluate(r,a,n,i,o);return this._calculate(s,s,s,r)}else if(t.kind==="composite"){return this._calculate(t.evaluate({zoom:Math.floor(r.zoom)-1},a,n),t.evaluate({zoom:Math.floor(r.zoom)},a,n),t.evaluate({zoom:Math.floor(r.zoom)+1},a,n),r)}else{return t.value}};t.prototype._calculate=function e(t,r,a,n){var i=n.zoom;return i>n.zoomHistory.lastIntegerZoom?{from:t,to:r}:{from:a,to:r}};t.prototype.interpolate=function e(t){return t};return t}(qo);var Yo=function e(t){this.specification=t};Yo.prototype.possiblyEvaluate=function e(t,r,a,n){if(t.value===undefined){return undefined}else if(t.expression.kind==="constant"){var i=t.expression.evaluate(r,null,{},a,n);return this._calculate(i,i,i,r)}else{return this._calculate(t.expression.evaluate(new zo(Math.floor(r.zoom-1),r)),t.expression.evaluate(new zo(Math.floor(r.zoom),r)),t.expression.evaluate(new zo(Math.floor(r.zoom+1),r)),r)}};Yo.prototype._calculate=function e(t,r,a,n){var i=n.zoom;return i>n.zoomHistory.lastIntegerZoom?{from:t,to:r}:{from:a,to:r}};Yo.prototype.interpolate=function e(t){return t};var Wo=function e(t){this.specification=t};Wo.prototype.possiblyEvaluate=function e(t,r,a,n){return!!t.expression.evaluate(r,null,{},a,n)};Wo.prototype.interpolate=function e(){return false};var Xo=function e(t){this.properties=t;this.defaultPropertyValues={};this.defaultTransitionablePropertyValues={};this.defaultTransitioningPropertyValues={};this.defaultPossiblyEvaluatedValues={};this.overridableProperties=[];for(var r in t){var a=t[r];if(a.specification.overridable){this.overridableProperties.push(r)}var n=this.defaultPropertyValues[r]=new Do(a,undefined);var i=this.defaultTransitionablePropertyValues[r]=new Ro(a);this.defaultTransitioningPropertyValues[r]=i.untransitioned();this.defaultPossiblyEvaluatedValues[r]=n.possiblyEvaluate({})}};eo("DataDrivenProperty",qo);eo("DataConstantProperty",Ho);eo("CrossFadedDataDrivenProperty",Go);eo("CrossFadedProperty",Yo);eo("ColorRampProperty",Wo);var Zo="-transition";var Jo=function(e){function t(t,r){e.call(this);this.id=t.id;this.type=t.type;this._featureFilter={filter:function(){return true},needGeometry:false};if(t.type==="custom"){return}t=t;this.metadata=t.metadata;this.minzoom=t.minzoom;this.maxzoom=t.maxzoom;if(t.type!=="background"){this.source=t.source;this.sourceLayer=t["source-layer"];this.filter=t.filter}if(r.layout){this._unevaluatedLayout=new jo(r.layout)}if(r.paint){this._transitionablePaint=new Fo(r.paint);for(var a in t.paint){this.setPaintProperty(a,t.paint[a],{validate:false})}for(var n in t.layout){this.setLayoutProperty(n,t.layout[n],{validate:false})}this._transitioningPaint=this._transitionablePaint.untransitioned();this.paint=new Vo(r.paint)}}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype.getCrossfadeParameters=function e(){return this._crossfadeParameters};t.prototype.getLayoutProperty=function e(t){if(t==="visibility"){return this.visibility}return this._unevaluatedLayout.getValue(t)};t.prototype.setLayoutProperty=function e(t,r,a){if(a===void 0)a={};if(r!==null&&r!==undefined){var n="layers."+this.id+".layout."+t;if(this._validate(Yi,n,t,r,a)){return}}if(t==="visibility"){this.visibility=r;return}this._unevaluatedLayout.setValue(t,r)};t.prototype.getPaintProperty=function e(t){if(T(t,Zo)){return this._transitionablePaint.getTransition(t.slice(0,-Zo.length))}else{return this._transitionablePaint.getValue(t)}};t.prototype.setPaintProperty=function e(t,r,a){if(a===void 0)a={};if(r!==null&&r!==undefined){var n="layers."+this.id+".paint."+t;if(this._validate(Gi,n,t,r,a)){return false}}if(T(t,Zo)){this._transitionablePaint.setTransition(t.slice(0,-Zo.length),r||undefined);return false}else{var i=this._transitionablePaint._values[t];var o=i.property.specification["property-type"]==="cross-faded-data-driven";var s=i.value.isDataDriven();var l=i.value;this._transitionablePaint.setValue(t,r);this._handleSpecialPaintPropertyUpdate(t);var u=this._transitionablePaint._values[t].value;var c=u.isDataDriven();return c||s||o||this._handleOverridablePaintPropertyUpdate(t,l,u)}};t.prototype._handleSpecialPaintPropertyUpdate=function e(t){};t.prototype._handleOverridablePaintPropertyUpdate=function e(t,r,a){return false};t.prototype.isHidden=function e(t){if(this.minzoom&&t<this.minzoom){return true}if(this.maxzoom&&t>=this.maxzoom){return true}return this.visibility==="none"};t.prototype.updateTransitions=function e(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)};t.prototype.hasTransition=function e(){return this._transitioningPaint.hasTransition()};t.prototype.recalculate=function e(t,r){if(t.getCrossfadeParameters){this._crossfadeParameters=t.getCrossfadeParameters()}if(this._unevaluatedLayout){this.layout=this._unevaluatedLayout.possiblyEvaluate(t,undefined,r)}this.paint=this._transitioningPaint.possiblyEvaluate(t,undefined,r)};t.prototype.serialize=function e(){var t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};if(this.visibility){t.layout=t.layout||{};t.layout.visibility=this.visibility}return M(t,(function(e,t){return e!==undefined&&!(t==="layout"&&!Object.keys(e).length)&&!(t==="paint"&&!Object.keys(e).length)}))};t.prototype._validate=function e(t,r,a,n,i){if(i===void 0)i={};if(i&&i.validate===false){return false}return Wi(this,t.call(Hi,{key:r,layerType:this.type,objectKey:a,value:n,styleSpec:Wt,style:{glyphs:true,sprite:true}}))};t.prototype.is3D=function e(){return false};t.prototype.isTileClipped=function e(){return false};t.prototype.hasOffscreenPass=function e(){return false};t.prototype.resize=function e(){};t.prototype.isStateDependent=function e(){for(var t in this.paint._values){var r=this.paint.get(t);if(!(r instanceof Uo)||!Dn(r.property.specification)){continue}if((r.value.kind==="source"||r.value.kind==="composite")&&r.value.isStateDependent){return true}}return false};return t}(lt);var Ko={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};var Qo=function e(t,r){this._structArray=t;this._pos1=r*this.size;this._pos2=this._pos1/2;this._pos4=this._pos1/4;this._pos8=this._pos1/8};var $o=128;var es=5;var ts=function e(){this.isTransferred=false;this.capacity=-1;this.resize(0)};ts.serialize=function e(t,r){t._trim();if(r){t.isTransferred=true;r.push(t.arrayBuffer)}return{length:t.length,arrayBuffer:t.arrayBuffer}};ts.deserialize=function e(t){var r=Object.create(this.prototype);r.arrayBuffer=t.arrayBuffer;r.length=t.length;r.capacity=t.arrayBuffer.byteLength/r.bytesPerElement;r._refreshViews();return r};ts.prototype._trim=function e(){if(this.length!==this.capacity){this.capacity=this.length;this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement);this._refreshViews()}};ts.prototype.clear=function e(){this.length=0};ts.prototype.resize=function e(t){this.reserve(t);this.length=t};ts.prototype.reserve=function e(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(this.capacity*es),$o);this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var r=this.uint8;this._refreshViews();if(r){this.uint8.set(r)}}};ts.prototype._refreshViews=function e(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};function rs(e,t){if(t===void 0)t=1;var r=0;var a=0;var n=e.map((function(e){var n=as(e.type);var i=r=ns(r,Math.max(t,n));var o=e.components||1;a=Math.max(a,n);r+=n*o;return{name:e.name,type:e.type,components:o,offset:i}}));var i=ns(r,Math.max(a,t));return{members:n,size:i,alignment:t}}function as(e){return Ko[e].BYTES_PER_ELEMENT}function ns(e,t){return Math.ceil(e/t)*t}var is=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype._refreshViews=function e(){this.uint8=new Uint8Array(this.arrayBuffer);this.int16=new Int16Array(this.arrayBuffer)};t.prototype.emplaceBack=function e(t,r){var a=this.length;this.resize(a+1);return this.emplace(a,t,r)};t.prototype.emplace=function e(t,r,a){var n=t*2;this.int16[n+0]=r;this.int16[n+1]=a;return t};return t}(ts);is.prototype.bytesPerElement=4;eo("StructArrayLayout2i4",is);var os=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype._refreshViews=function e(){this.uint8=new Uint8Array(this.arrayBuffer);this.int16=new Int16Array(this.arrayBuffer)};t.prototype.emplaceBack=function e(t,r,a,n){var i=this.length;this.resize(i+1);return this.emplace(i,t,r,a,n)};t.prototype.emplace=function e(t,r,a,n,i){var o=t*4;this.int16[o+0]=r;this.int16[o+1]=a;this.int16[o+2]=n;this.int16[o+3]=i;return t};return t}(ts);os.prototype.bytesPerElement=8;eo("StructArrayLayout4i8",os);var ss=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype._refreshViews=function e(){this.uint8=new Uint8Array(this.arrayBuffer);this.int16=new Int16Array(this.arrayBuffer)};t.prototype.emplaceBack=function e(t,r,a,n,i,o){var s=this.length;this.resize(s+1);return this.emplace(s,t,r,a,n,i,o)};t.prototype.emplace=function e(t,r,a,n,i,o,s){var l=t*6;this.int16[l+0]=r;this.int16[l+1]=a;this.int16[l+2]=n;this.int16[l+3]=i;this.int16[l+4]=o;this.int16[l+5]=s;return t};return t}(ts);ss.prototype.bytesPerElement=12;eo("StructArrayLayout2i4i12",ss);var ls=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype._refreshViews=function e(){this.uint8=new Uint8Array(this.arrayBuffer);this.int16=new Int16Array(this.arrayBuffer)};t.prototype.emplaceBack=function e(t,r,a,n,i,o){var s=this.length;this.resize(s+1);return this.emplace(s,t,r,a,n,i,o)};t.prototype.emplace=function e(t,r,a,n,i,o,s){var l=t*4;var u=t*8;this.int16[l+0]=r;this.int16[l+1]=a;this.uint8[u+4]=n;this.uint8[u+5]=i;this.uint8[u+6]=o;this.uint8[u+7]=s;return t};return t}(ts);ls.prototype.bytesPerElement=8;eo("StructArrayLayout2i4ub8",ls);var us=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype._refreshViews=function e(){this.uint8=new Uint8Array(this.arrayBuffer);this.uint16=new Uint16Array(this.arrayBuffer)};t.prototype.emplaceBack=function e(t,r,a,n,i,o,s,l,u,c){var f=this.length;this.resize(f+1);return this.emplace(f,t,r,a,n,i,o,s,l,u,c)};t.prototype.emplace=function e(t,r,a,n,i,o,s,l,u,c,f){var h=t*9;var p=t*18;this.uint16[h+0]=r;this.uint16[h+1]=a;this.uint16[h+2]=n;this.uint16[h+3]=i;this.uint16[h+4]=o;this.uint16[h+5]=s;this.uint16[h+6]=l;this.uint16[h+7]=u;this.uint8[p+16]=c;this.uint8[p+17]=f;return t};return t}(ts);us.prototype.bytesPerElement=18;eo("StructArrayLayout8ui2ub18",us);var cs=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype._refreshViews=function e(){this.uint8=new Uint8Array(this.arrayBuffer);this.int16=new Int16Array(this.arrayBuffer);this.uint16=new Uint16Array(this.arrayBuffer)};t.prototype.emplaceBack=function e(t,r,a,n,i,o,s,l,u,c,f,h){var p=this.length;this.resize(p+1);return this.emplace(p,t,r,a,n,i,o,s,l,u,c,f,h)};t.prototype.emplace=function e(t,r,a,n,i,o,s,l,u,c,f,h,p){var v=t*12;this.int16[v+0]=r;this.int16[v+1]=a;this.int16[v+2]=n;this.int16[v+3]=i;this.uint16[v+4]=o;this.uint16[v+5]=s;this.uint16[v+6]=l;this.uint16[v+7]=u;this.int16[v+8]=c;this.int16[v+9]=f;this.int16[v+10]=h;this.int16[v+11]=p;return t};return t}(ts);cs.prototype.bytesPerElement=24;eo("StructArrayLayout4i4ui4i24",cs);var fs=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype._refreshViews=function e(){this.uint8=new Uint8Array(this.arrayBuffer);this.float32=new Float32Array(this.arrayBuffer)};t.prototype.emplaceBack=function e(t,r,a){var n=this.length;this.resize(n+1);return this.emplace(n,t,r,a)};t.prototype.emplace=function e(t,r,a,n){var i=t*3;this.float32[i+0]=r;this.float32[i+1]=a;this.float32[i+2]=n;return t};return t}(ts);fs.prototype.bytesPerElement=12;eo("StructArrayLayout3f12",fs);var hs=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype._refreshViews=function e(){this.uint8=new Uint8Array(this.arrayBuffer);this.uint32=new Uint32Array(this.arrayBuffer)};t.prototype.emplaceBack=function e(t){var r=this.length;this.resize(r+1);return this.emplace(r,t)};t.prototype.emplace=function e(t,r){var a=t*1;this.uint32[a+0]=r;return t};return t}(ts);hs.prototype.bytesPerElement=4;eo("StructArrayLayout1ul4",hs);var ps=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype._refreshViews=function e(){this.uint8=new Uint8Array(this.arrayBuffer);this.int16=new Int16Array(this.arrayBuffer);this.uint32=new Uint32Array(this.arrayBuffer);this.uint16=new Uint16Array(this.arrayBuffer)};t.prototype.emplaceBack=function e(t,r,a,n,i,o,s,l,u){var c=this.length;this.resize(c+1);return this.emplace(c,t,r,a,n,i,o,s,l,u)};t.prototype.emplace=function e(t,r,a,n,i,o,s,l,u,c){var f=t*10;var h=t*5;this.int16[f+0]=r;this.int16[f+1]=a;this.int16[f+2]=n;this.int16[f+3]=i;this.int16[f+4]=o;this.int16[f+5]=s;this.uint32[h+3]=l;this.uint16[f+8]=u;this.uint16[f+9]=c;return t};return t}(ts);ps.prototype.bytesPerElement=20;eo("StructArrayLayout6i1ul2ui20",ps);var vs=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype._refreshViews=function e(){this.uint8=new Uint8Array(this.arrayBuffer);this.int16=new Int16Array(this.arrayBuffer)};t.prototype.emplaceBack=function e(t,r,a,n,i,o){var s=this.length;this.resize(s+1);return this.emplace(s,t,r,a,n,i,o)};t.prototype.emplace=function e(t,r,a,n,i,o,s){var l=t*6;this.int16[l+0]=r;this.int16[l+1]=a;this.int16[l+2]=n;this.int16[l+3]=i;this.int16[l+4]=o;this.int16[l+5]=s;return t};return t}(ts);vs.prototype.bytesPerElement=12;eo("StructArrayLayout2i2i2i12",vs);var ds=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype._refreshViews=function e(){this.uint8=new Uint8Array(this.arrayBuffer);this.float32=new Float32Array(this.arrayBuffer);this.int16=new Int16Array(this.arrayBuffer)};t.prototype.emplaceBack=function e(t,r,a,n,i){var o=this.length;this.resize(o+1);return this.emplace(o,t,r,a,n,i)};t.prototype.emplace=function e(t,r,a,n,i,o){var s=t*4;var l=t*8;this.float32[s+0]=r;this.float32[s+1]=a;this.float32[s+2]=n;this.int16[l+6]=i;this.int16[l+7]=o;return t};return t}(ts);ds.prototype.bytesPerElement=16;eo("StructArrayLayout2f1f2i16",ds);var ms=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype._refreshViews=function e(){this.uint8=new Uint8Array(this.arrayBuffer);this.float32=new Float32Array(this.arrayBuffer)};t.prototype.emplaceBack=function e(t,r,a,n){var i=this.length;this.resize(i+1);return this.emplace(i,t,r,a,n)};t.prototype.emplace=function e(t,r,a,n,i){var o=t*12;var s=t*3;this.uint8[o+0]=r;this.uint8[o+1]=a;this.float32[s+1]=n;this.float32[s+2]=i;return t};return t}(ts);ms.prototype.bytesPerElement=12;eo("StructArrayLayout2ub2f12",ms);var gs=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype._refreshViews=function e(){this.uint8=new Uint8Array(this.arrayBuffer);this.uint16=new Uint16Array(this.arrayBuffer)};t.prototype.emplaceBack=function e(t,r,a){var n=this.length;this.resize(n+1);return this.emplace(n,t,r,a)};t.prototype.emplace=function e(t,r,a,n){var i=t*3;this.uint16[i+0]=r;this.uint16[i+1]=a;this.uint16[i+2]=n;return t};return t}(ts);gs.prototype.bytesPerElement=6;eo("StructArrayLayout3ui6",gs);var ys=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype._refreshViews=function e(){this.uint8=new Uint8Array(this.arrayBuffer);this.int16=new Int16Array(this.arrayBuffer);this.uint16=new Uint16Array(this.arrayBuffer);this.uint32=new Uint32Array(this.arrayBuffer);this.float32=new Float32Array(this.arrayBuffer)};t.prototype.emplaceBack=function e(t,r,a,n,i,o,s,l,u,c,f,h,p,v,d,m,g){var y=this.length;this.resize(y+1);return this.emplace(y,t,r,a,n,i,o,s,l,u,c,f,h,p,v,d,m,g)};t.prototype.emplace=function e(t,r,a,n,i,o,s,l,u,c,f,h,p,v,d,m,g,y){var x=t*24;var b=t*12;var _=t*48;this.int16[x+0]=r;this.int16[x+1]=a;this.uint16[x+2]=n;this.uint16[x+3]=i;this.uint32[b+2]=o;this.uint32[b+3]=s;this.uint32[b+4]=l;this.uint16[x+10]=u;this.uint16[x+11]=c;this.uint16[x+12]=f;this.float32[b+7]=h;this.float32[b+8]=p;this.uint8[_+36]=v;this.uint8[_+37]=d;this.uint8[_+38]=m;this.uint32[b+10]=g;this.int16[x+22]=y;return t};return t}(ts);ys.prototype.bytesPerElement=48;eo("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",ys);var xs=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype._refreshViews=function e(){this.uint8=new Uint8Array(this.arrayBuffer);this.int16=new Int16Array(this.arrayBuffer);this.uint16=new Uint16Array(this.arrayBuffer);this.uint32=new Uint32Array(this.arrayBuffer);this.float32=new Float32Array(this.arrayBuffer)};t.prototype.emplaceBack=function e(t,r,a,n,i,o,s,l,u,c,f,h,p,v,d,m,g,y,x,b,_,w,T,k,M,A,S,E){var L=this.length;this.resize(L+1);return this.emplace(L,t,r,a,n,i,o,s,l,u,c,f,h,p,v,d,m,g,y,x,b,_,w,T,k,M,A,S,E)};t.prototype.emplace=function e(t,r,a,n,i,o,s,l,u,c,f,h,p,v,d,m,g,y,x,b,_,w,T,k,M,A,S,E,L){var C=t*34;var I=t*17;this.int16[C+0]=r;this.int16[C+1]=a;this.int16[C+2]=n;this.int16[C+3]=i;this.int16[C+4]=o;this.int16[C+5]=s;this.int16[C+6]=l;this.int16[C+7]=u;this.uint16[C+8]=c;this.uint16[C+9]=f;this.uint16[C+10]=h;this.uint16[C+11]=p;this.uint16[C+12]=v;this.uint16[C+13]=d;this.uint16[C+14]=m;this.uint16[C+15]=g;this.uint16[C+16]=y;this.uint16[C+17]=x;this.uint16[C+18]=b;this.uint16[C+19]=_;this.uint16[C+20]=w;this.uint16[C+21]=T;this.uint16[C+22]=k;this.uint32[I+12]=M;this.float32[I+13]=A;this.float32[I+14]=S;this.float32[I+15]=E;this.float32[I+16]=L;return t};return t}(ts);xs.prototype.bytesPerElement=68;eo("StructArrayLayout8i15ui1ul4f68",xs);var bs=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype._refreshViews=function e(){this.uint8=new Uint8Array(this.arrayBuffer);this.float32=new Float32Array(this.arrayBuffer)};t.prototype.emplaceBack=function e(t){var r=this.length;this.resize(r+1);return this.emplace(r,t)};t.prototype.emplace=function e(t,r){var a=t*1;this.float32[a+0]=r;return t};return t}(ts);bs.prototype.bytesPerElement=4;eo("StructArrayLayout1f4",bs);var _s=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype._refreshViews=function e(){this.uint8=new Uint8Array(this.arrayBuffer);this.int16=new Int16Array(this.arrayBuffer)};t.prototype.emplaceBack=function e(t,r,a){var n=this.length;this.resize(n+1);return this.emplace(n,t,r,a)};t.prototype.emplace=function e(t,r,a,n){var i=t*3;this.int16[i+0]=r;this.int16[i+1]=a;this.int16[i+2]=n;return t};return t}(ts);_s.prototype.bytesPerElement=6;eo("StructArrayLayout3i6",_s);var ws=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype._refreshViews=function e(){this.uint8=new Uint8Array(this.arrayBuffer);this.uint32=new Uint32Array(this.arrayBuffer);this.uint16=new Uint16Array(this.arrayBuffer)};t.prototype.emplaceBack=function e(t,r,a){var n=this.length;this.resize(n+1);return this.emplace(n,t,r,a)};t.prototype.emplace=function e(t,r,a,n){var i=t*2;var o=t*4;this.uint32[i+0]=r;this.uint16[o+2]=a;this.uint16[o+3]=n;return t};return t}(ts);ws.prototype.bytesPerElement=8;eo("StructArrayLayout1ul2ui8",ws);var Ts=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype._refreshViews=function e(){this.uint8=new Uint8Array(this.arrayBuffer);this.uint16=new Uint16Array(this.arrayBuffer)};t.prototype.emplaceBack=function e(t,r){var a=this.length;this.resize(a+1);return this.emplace(a,t,r)};t.prototype.emplace=function e(t,r,a){var n=t*2;this.uint16[n+0]=r;this.uint16[n+1]=a;return t};return t}(ts);Ts.prototype.bytesPerElement=4;eo("StructArrayLayout2ui4",Ts);var ks=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype._refreshViews=function e(){this.uint8=new Uint8Array(this.arrayBuffer);this.uint16=new Uint16Array(this.arrayBuffer)};t.prototype.emplaceBack=function e(t){var r=this.length;this.resize(r+1);return this.emplace(r,t)};t.prototype.emplace=function e(t,r){var a=t*1;this.uint16[a+0]=r;return t};return t}(ts);ks.prototype.bytesPerElement=2;eo("StructArrayLayout1ui2",ks);var Ms=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype._refreshViews=function e(){this.uint8=new Uint8Array(this.arrayBuffer);this.float32=new Float32Array(this.arrayBuffer)};t.prototype.emplaceBack=function e(t,r){var a=this.length;this.resize(a+1);return this.emplace(a,t,r)};t.prototype.emplace=function e(t,r,a){var n=t*2;this.float32[n+0]=r;this.float32[n+1]=a;return t};return t}(ts);Ms.prototype.bytesPerElement=8;eo("StructArrayLayout2f8",Ms);var As=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype._refreshViews=function e(){this.uint8=new Uint8Array(this.arrayBuffer);this.float32=new Float32Array(this.arrayBuffer)};t.prototype.emplaceBack=function e(t,r,a,n){var i=this.length;this.resize(i+1);return this.emplace(i,t,r,a,n)};t.prototype.emplace=function e(t,r,a,n,i){var o=t*4;this.float32[o+0]=r;this.float32[o+1]=a;this.float32[o+2]=n;this.float32[o+3]=i;return t};return t}(ts);As.prototype.bytesPerElement=16;eo("StructArrayLayout4f16",As);var Ss=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;var r={anchorPointX:{configurable:true},anchorPointY:{configurable:true},x1:{configurable:true},y1:{configurable:true},x2:{configurable:true},y2:{configurable:true},featureIndex:{configurable:true},sourceLayerIndex:{configurable:true},bucketIndex:{configurable:true},anchorPoint:{configurable:true}};r.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]};r.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]};r.x1.get=function(){return this._structArray.int16[this._pos2+2]};r.y1.get=function(){return this._structArray.int16[this._pos2+3]};r.x2.get=function(){return this._structArray.int16[this._pos2+4]};r.y2.get=function(){return this._structArray.int16[this._pos2+5]};r.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]};r.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]};r.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]};r.anchorPoint.get=function(){return new i(this.anchorPointX,this.anchorPointY)};Object.defineProperties(t.prototype,r);return t}(Qo);Ss.prototype.size=20;var Es=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype.get=function e(t){return new Ss(this,t)};return t}(ps);eo("CollisionBoxArray",Es);var Ls=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;var r={anchorX:{configurable:true},anchorY:{configurable:true},glyphStartIndex:{configurable:true},numGlyphs:{configurable:true},vertexStartIndex:{configurable:true},lineStartIndex:{configurable:true},lineLength:{configurable:true},segment:{configurable:true},lowerSize:{configurable:true},upperSize:{configurable:true},lineOffsetX:{configurable:true},lineOffsetY:{configurable:true},writingMode:{configurable:true},placedOrientation:{configurable:true},hidden:{configurable:true},crossTileID:{configurable:true},associatedIconIndex:{configurable:true}};r.anchorX.get=function(){return this._structArray.int16[this._pos2+0]};r.anchorY.get=function(){return this._structArray.int16[this._pos2+1]};r.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]};r.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]};r.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]};r.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]};r.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]};r.segment.get=function(){return this._structArray.uint16[this._pos2+10]};r.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]};r.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]};r.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]};r.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]};r.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]};r.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]};r.placedOrientation.set=function(e){this._structArray.uint8[this._pos1+37]=e};r.hidden.get=function(){return this._structArray.uint8[this._pos1+38]};r.hidden.set=function(e){this._structArray.uint8[this._pos1+38]=e};r.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]};r.crossTileID.set=function(e){this._structArray.uint32[this._pos4+10]=e};r.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]};Object.defineProperties(t.prototype,r);return t}(Qo);Ls.prototype.size=48;var Cs=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype.get=function e(t){return new Ls(this,t)};return t}(ys);eo("PlacedSymbolArray",Cs);var Is=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;var r={anchorX:{configurable:true},anchorY:{configurable:true},rightJustifiedTextSymbolIndex:{configurable:true},centerJustifiedTextSymbolIndex:{configurable:true},leftJustifiedTextSymbolIndex:{configurable:true},verticalPlacedTextSymbolIndex:{configurable:true},placedIconSymbolIndex:{configurable:true},verticalPlacedIconSymbolIndex:{configurable:true},key:{configurable:true},textBoxStartIndex:{configurable:true},textBoxEndIndex:{configurable:true},verticalTextBoxStartIndex:{configurable:true},verticalTextBoxEndIndex:{configurable:true},iconBoxStartIndex:{configurable:true},iconBoxEndIndex:{configurable:true},verticalIconBoxStartIndex:{configurable:true},verticalIconBoxEndIndex:{configurable:true},featureIndex:{configurable:true},numHorizontalGlyphVertices:{configurable:true},numVerticalGlyphVertices:{configurable:true},numIconVertices:{configurable:true},numVerticalIconVertices:{configurable:true},useRuntimeCollisionCircles:{configurable:true},crossTileID:{configurable:true},textBoxScale:{configurable:true},textOffset0:{configurable:true},textOffset1:{configurable:true},collisionCircleDiameter:{configurable:true}};r.anchorX.get=function(){return this._structArray.int16[this._pos2+0]};r.anchorY.get=function(){return this._structArray.int16[this._pos2+1]};r.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]};r.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]};r.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]};r.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]};r.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]};r.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]};r.key.get=function(){return this._structArray.uint16[this._pos2+8]};r.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]};r.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]};r.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]};r.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]};r.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]};r.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]};r.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]};r.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]};r.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]};r.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]};r.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]};r.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]};r.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]};r.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]};r.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]};r.crossTileID.set=function(e){this._structArray.uint32[this._pos4+12]=e};r.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]};r.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]};r.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]};r.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]};Object.defineProperties(t.prototype,r);return t}(Qo);Is.prototype.size=68;var Ps=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype.get=function e(t){return new Is(this,t)};return t}(xs);eo("SymbolInstanceArray",Ps);var Os=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype.getoffsetX=function e(t){return this.float32[t*1+0]};return t}(bs);eo("GlyphOffsetArray",Os);var zs=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype.getx=function e(t){return this.int16[t*3+0]};t.prototype.gety=function e(t){return this.int16[t*3+1]};t.prototype.gettileUnitDistanceFromAnchor=function e(t){return this.int16[t*3+2]};return t}(_s);eo("SymbolLineVertexArray",zs);var Ds=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;var r={featureIndex:{configurable:true},sourceLayerIndex:{configurable:true},bucketIndex:{configurable:true}};r.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]};r.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]};r.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]};Object.defineProperties(t.prototype,r);return t}(Qo);Ds.prototype.size=8;var Rs=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype.get=function e(t){return new Ds(this,t)};return t}(ws);eo("FeatureIndexArray",Rs);var Fs=rs([{name:"a_pos",components:2,type:"Int16"}],4);var Bs=Fs.members;var Ns=function e(t){if(t===void 0)t=[];this.segments=t};Ns.prototype.prepareSegment=function e(t,r,a,n){var i=this.segments[this.segments.length-1];if(t>Ns.MAX_VERTEX_ARRAY_LENGTH){L("Max vertices per segment is "+Ns.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+t)}if(!i||i.vertexLength+t>Ns.MAX_VERTEX_ARRAY_LENGTH||i.sortKey!==n){i={vertexOffset:r.length,primitiveOffset:a.length,vertexLength:0,primitiveLength:0};if(n!==undefined){i.sortKey=n}this.segments.push(i)}return i};Ns.prototype.get=function e(){return this.segments};Ns.prototype.destroy=function e(){for(var t=0,r=this.segments;t<r.length;t+=1){var a=r[t];for(var n in a.vaos){a.vaos[n].destroy()}}};Ns.simpleSegment=function e(t,r,a,n){return new Ns([{vertexOffset:t,primitiveOffset:r,vertexLength:a,primitiveLength:n,vaos:{},sortKey:0}])};Ns.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1;eo("SegmentVector",Ns);function js(e,t){e=f(Math.floor(e),0,255);t=f(Math.floor(t),0,255);return 256*e+t}var Us=rs([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint8"},{name:"a_pixel_ratio_to",components:1,type:"Uint8"}]);var Vs=t((function(e){function t(e,t){var r,a,n,i,o,s,l,u;r=e.length&3;a=e.length-r;n=t;o=3432918353;s=461845907;u=0;while(u<a){l=e.charCodeAt(u)&255|(e.charCodeAt(++u)&255)<<8|(e.charCodeAt(++u)&255)<<16|(e.charCodeAt(++u)&255)<<24;++u;l=(l&65535)*o+(((l>>>16)*o&65535)<<16)&4294967295;l=l<<15|l>>>17;l=(l&65535)*s+(((l>>>16)*s&65535)<<16)&4294967295;n^=l;n=n<<13|n>>>19;i=(n&65535)*5+(((n>>>16)*5&65535)<<16)&4294967295;n=(i&65535)+27492+(((i>>>16)+58964&65535)<<16)}l=0;switch(r){case 3:l^=(e.charCodeAt(u+2)&255)<<16;case 2:l^=(e.charCodeAt(u+1)&255)<<8;case 1:l^=e.charCodeAt(u)&255;l=(l&65535)*o+(((l>>>16)*o&65535)<<16)&4294967295;l=l<<15|l>>>17;l=(l&65535)*s+(((l>>>16)*s&65535)<<16)&4294967295;n^=l}n^=e.length;n^=n>>>16;n=(n&65535)*2246822507+(((n>>>16)*2246822507&65535)<<16)&4294967295;n^=n>>>13;n=(n&65535)*3266489909+(((n>>>16)*3266489909&65535)<<16)&4294967295;n^=n>>>16;return n>>>0}{e.exports=t}}));var Hs=t((function(e){function t(e,t){var r=e.length,a=t^r,n=0,i;while(r>=4){i=e.charCodeAt(n)&255|(e.charCodeAt(++n)&255)<<8|(e.charCodeAt(++n)&255)<<16|(e.charCodeAt(++n)&255)<<24;i=(i&65535)*1540483477+(((i>>>16)*1540483477&65535)<<16);i^=i>>>24;i=(i&65535)*1540483477+(((i>>>16)*1540483477&65535)<<16);a=(a&65535)*1540483477+(((a>>>16)*1540483477&65535)<<16)^i;r-=4;++n}switch(r){case 3:a^=(e.charCodeAt(n+2)&255)<<16;case 2:a^=(e.charCodeAt(n+1)&255)<<8;case 1:a^=e.charCodeAt(n)&255;a=(a&65535)*1540483477+(((a>>>16)*1540483477&65535)<<16)}a^=a>>>13;a=(a&65535)*1540483477+(((a>>>16)*1540483477&65535)<<16);a^=a>>>15;return a>>>0}{e.exports=t}}));var qs=Vs;var Gs=Vs;var Ys=Hs;qs.murmur3=Gs;qs.murmur2=Ys;var Ws=function e(){this.ids=[];this.positions=[];this.indexed=false};Ws.prototype.add=function e(t,r,a,n){this.ids.push(Zs(t));this.positions.push(r,a,n)};Ws.prototype.getPositions=function e(t){var r=Zs(t);var a=0;var n=this.ids.length-1;while(a<n){var i=a+n>>1;if(this.ids[i]>=r){n=i}else{a=i+1}}var o=[];while(this.ids[a]===r){var s=this.positions[3*a];var l=this.positions[3*a+1];var u=this.positions[3*a+2];o.push({index:s,start:l,end:u});a++}return o};Ws.serialize=function e(t,r){var a=new Float64Array(t.ids);var n=new Uint32Array(t.positions);Js(a,n,0,a.length-1);if(r){r.push(a.buffer,n.buffer)}return{ids:a,positions:n}};Ws.deserialize=function e(t){var r=new Ws;r.ids=t.ids;r.positions=t.positions;r.indexed=true;return r};var Xs=Math.pow(2,53)-1;function Zs(e){var t=+e;if(!isNaN(t)&&t<=Xs){return t}return qs(String(e))}function Js(e,t,r,a){while(r<a){var n=e[r+a>>1];var i=r-1;var o=a+1;while(true){do{i++}while(e[i]<n);do{o--}while(e[o]>n);if(i>=o){break}Ks(e,i,o);Ks(t,3*i,3*o);Ks(t,3*i+1,3*o+1);Ks(t,3*i+2,3*o+2)}if(o-r<a-o){Js(e,t,r,o);r=o+1}else{Js(e,t,o+1,a);a=o}}}function Ks(e,t,r){var a=e[t];e[t]=e[r];e[r]=a}eo("FeaturePositionMap",Ws);var Qs=function e(t,r){this.gl=t.gl;this.location=r};var $s=function(e){function t(t,r){e.call(this,t,r);this.current=0}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype.set=function e(t){if(this.current!==t){this.current=t;this.gl.uniform1i(this.location,t)}};return t}(Qs);var el=function(e){function t(t,r){e.call(this,t,r);this.current=0}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype.set=function e(t){if(this.current!==t){this.current=t;this.gl.uniform1f(this.location,t)}};return t}(Qs);var tl=function(e){function t(t,r){e.call(this,t,r);this.current=[0,0]}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype.set=function e(t){if(t[0]!==this.current[0]||t[1]!==this.current[1]){this.current=t;this.gl.uniform2f(this.location,t[0],t[1])}};return t}(Qs);var rl=function(e){function t(t,r){e.call(this,t,r);this.current=[0,0,0]}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype.set=function e(t){if(t[0]!==this.current[0]||t[1]!==this.current[1]||t[2]!==this.current[2]){this.current=t;this.gl.uniform3f(this.location,t[0],t[1],t[2])}};return t}(Qs);var al=function(e){function t(t,r){e.call(this,t,r);this.current=[0,0,0,0]}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype.set=function e(t){if(t[0]!==this.current[0]||t[1]!==this.current[1]||t[2]!==this.current[2]||t[3]!==this.current[3]){this.current=t;this.gl.uniform4f(this.location,t[0],t[1],t[2],t[3])}};return t}(Qs);var nl=function(e){function t(t,r){e.call(this,t,r);this.current=br.transparent}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype.set=function e(t){if(t.r!==this.current.r||t.g!==this.current.g||t.b!==this.current.b||t.a!==this.current.a){this.current=t;this.gl.uniform4f(this.location,t.r,t.g,t.b,t.a)}};return t}(Qs);var il=new Float32Array(16);var ol=function(e){function t(t,r){e.call(this,t,r);this.current=il}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype.set=function e(t){if(t[12]!==this.current[12]||t[0]!==this.current[0]){this.current=t;this.gl.uniformMatrix4fv(this.location,false,t);return}for(var r=1;r<16;r++){if(t[r]!==this.current[r]){this.current=t;this.gl.uniformMatrix4fv(this.location,false,t);break}}};return t}(Qs);function sl(e){return[js(255*e.r,255*e.g),js(255*e.b,255*e.a)]}var ll=function e(t,r,a){this.value=t;this.uniformNames=r.map((function(e){return"u_"+e}));this.type=a};ll.prototype.setUniform=function e(t,r,a){t.set(a.constantOr(this.value))};ll.prototype.getBinding=function e(t,r,a){return this.type==="color"?new nl(t,r):new el(t,r)};var ul=function e(t,r){this.uniformNames=r.map((function(e){return"u_"+e}));this.patternFrom=null;this.patternTo=null;this.pixelRatioFrom=1;this.pixelRatioTo=1};ul.prototype.setConstantPatternPositions=function e(t,r){this.pixelRatioFrom=r.pixelRatio;this.pixelRatioTo=t.pixelRatio;this.patternFrom=r.tlbr;this.patternTo=t.tlbr};ul.prototype.setUniform=function e(t,r,a,n){var i=n==="u_pattern_to"?this.patternTo:n==="u_pattern_from"?this.patternFrom:n==="u_pixel_ratio_to"?this.pixelRatioTo:n==="u_pixel_ratio_from"?this.pixelRatioFrom:null;if(i){t.set(i)}};ul.prototype.getBinding=function e(t,r,a){return a.substr(0,9)==="u_pattern"?new al(t,r):new el(t,r)};var cl=function e(t,r,a,n){this.expression=t;this.type=a;this.maxValue=0;this.paintVertexAttributes=r.map((function(e){return{name:"a_"+e,type:"Float32",components:a==="color"?2:1,offset:0}}));this.paintVertexArray=new n};cl.prototype.populatePaintArray=function e(t,r,a,n,i){var o=this.paintVertexArray.length;var s=this.expression.evaluate(new zo(0),r,{},n,[],i);this.paintVertexArray.resize(t);this._setPaintValue(o,t,s)};cl.prototype.updatePaintArray=function e(t,r,a,n){var i=this.expression.evaluate({zoom:0},a,n);this._setPaintValue(t,r,i)};cl.prototype._setPaintValue=function e(t,r,a){if(this.type==="color"){var n=sl(a);for(var i=t;i<r;i++){this.paintVertexArray.emplace(i,n[0],n[1])}}else{for(var o=t;o<r;o++){this.paintVertexArray.emplace(o,a)}this.maxValue=Math.max(this.maxValue,Math.abs(a))}};cl.prototype.upload=function e(t){if(this.paintVertexArray&&this.paintVertexArray.arrayBuffer){if(this.paintVertexBuffer&&this.paintVertexBuffer.buffer){this.paintVertexBuffer.updateData(this.paintVertexArray)}else{this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent)}}};cl.prototype.destroy=function e(){if(this.paintVertexBuffer){this.paintVertexBuffer.destroy()}};var fl=function e(t,r,a,n,i,o){this.expression=t;this.uniformNames=r.map((function(e){return"u_"+e+"_t"}));this.type=a;this.useIntegerZoom=n;this.zoom=i;this.maxValue=0;this.paintVertexAttributes=r.map((function(e){return{name:"a_"+e,type:"Float32",components:a==="color"?4:2,offset:0}}));this.paintVertexArray=new o};fl.prototype.populatePaintArray=function e(t,r,a,n,i){var o=this.expression.evaluate(new zo(this.zoom),r,{},n,[],i);var s=this.expression.evaluate(new zo(this.zoom+1),r,{},n,[],i);var l=this.paintVertexArray.length;this.paintVertexArray.resize(t);this._setPaintValue(l,t,o,s)};fl.prototype.updatePaintArray=function e(t,r,a,n){var i=this.expression.evaluate({zoom:this.zoom},a,n);var o=this.expression.evaluate({zoom:this.zoom+1},a,n);this._setPaintValue(t,r,i,o)};fl.prototype._setPaintValue=function e(t,r,a,n){if(this.type==="color"){var i=sl(a);var o=sl(n);for(var s=t;s<r;s++){this.paintVertexArray.emplace(s,i[0],i[1],o[0],o[1])}}else{for(var l=t;l<r;l++){this.paintVertexArray.emplace(l,a,n)}this.maxValue=Math.max(this.maxValue,Math.abs(a),Math.abs(n))}};fl.prototype.upload=function e(t){if(this.paintVertexArray&&this.paintVertexArray.arrayBuffer){if(this.paintVertexBuffer&&this.paintVertexBuffer.buffer){this.paintVertexBuffer.updateData(this.paintVertexArray)}else{this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent)}}};fl.prototype.destroy=function e(){if(this.paintVertexBuffer){this.paintVertexBuffer.destroy()}};fl.prototype.setUniform=function e(t,r){var a=this.useIntegerZoom?Math.floor(r.zoom):r.zoom;var n=f(this.expression.interpolationFactor(a,this.zoom,this.zoom+1),0,1);t.set(n)};fl.prototype.getBinding=function e(t,r,a){return new el(t,r)};var hl=function e(t,r,a,n,i,o){this.expression=t;this.type=r;this.useIntegerZoom=a;this.zoom=n;this.layerId=o;this.zoomInPaintVertexArray=new i;this.zoomOutPaintVertexArray=new i};hl.prototype.populatePaintArray=function e(t,r,a){var n=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t);this.zoomOutPaintVertexArray.resize(t);this._setPaintValues(n,t,r.patterns&&r.patterns[this.layerId],a)};hl.prototype.updatePaintArray=function e(t,r,a,n,i){this._setPaintValues(t,r,a.patterns&&a.patterns[this.layerId],i)};hl.prototype._setPaintValues=function e(t,r,a,n){if(!n||!a){return}var i=a.min;var o=a.mid;var s=a.max;var l=n[i];var u=n[o];var c=n[s];if(!l||!u||!c){return}for(var f=t;f<r;f++){this.zoomInPaintVertexArray.emplace(f,u.tl[0],u.tl[1],u.br[0],u.br[1],l.tl[0],l.tl[1],l.br[0],l.br[1],u.pixelRatio,l.pixelRatio);this.zoomOutPaintVertexArray.emplace(f,u.tl[0],u.tl[1],u.br[0],u.br[1],c.tl[0],c.tl[1],c.br[0],c.br[1],u.pixelRatio,c.pixelRatio)}};hl.prototype.upload=function e(t){if(this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer){this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,Us.members,this.expression.isStateDependent);this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,Us.members,this.expression.isStateDependent)}};hl.prototype.destroy=function e(){if(this.zoomOutPaintVertexBuffer){this.zoomOutPaintVertexBuffer.destroy()}if(this.zoomInPaintVertexBuffer){this.zoomInPaintVertexBuffer.destroy()}};var pl=function e(t,r,a,n){this.binders={};this.layoutAttributes=n;this._buffers=[];var i=[];for(var o in t.paint._values){if(!a(o)){continue}var s=t.paint.get(o);if(!(s instanceof Uo)||!Dn(s.property.specification)){continue}var l=dl(o,t.type);var u=s.value;var c=s.property.specification.type;var f=s.property.useIntegerZoom;var h=s.property.specification["property-type"];var p=h==="cross-faded"||h==="cross-faded-data-driven";if(u.kind==="constant"){this.binders[o]=p?new ul(u.value,l):new ll(u.value,l,c);i.push("/u_"+o)}else if(u.kind==="source"||p){var v=gl(o,c,"source");this.binders[o]=p?new hl(u,c,f,r,v,t.id):new cl(u,l,c,v);i.push("/a_"+o)}else{var d=gl(o,c,"composite");this.binders[o]=new fl(u,l,c,f,r,d);i.push("/z_"+o)}}this.cacheKey=i.sort().join("")};pl.prototype.getMaxValue=function e(t){var r=this.binders[t];return r instanceof cl||r instanceof fl?r.maxValue:0};pl.prototype.populatePaintArrays=function e(t,r,a,n,i){for(var o in this.binders){var s=this.binders[o];if(s instanceof cl||s instanceof fl||s instanceof hl){s.populatePaintArray(t,r,a,n,i)}}};pl.prototype.setConstantPatternPositions=function e(t,r){for(var a in this.binders){var n=this.binders[a];if(n instanceof ul){n.setConstantPatternPositions(t,r)}}};pl.prototype.updatePaintArrays=function e(t,r,a,n,i){var o=false;for(var s in t){var l=r.getPositions(s);for(var u=0,c=l;u<c.length;u+=1){var f=c[u];var h=a.feature(f.index);for(var p in this.binders){var v=this.binders[p];if((v instanceof cl||v instanceof fl||v instanceof hl)&&v.expression.isStateDependent===true){var d=n.paint.get(p);v.expression=d.value;v.updatePaintArray(f.start,f.end,h,t[s],i);o=true}}}}return o};pl.prototype.defines=function e(){var t=[];for(var r in this.binders){var a=this.binders[r];if(a instanceof ll||a instanceof ul){t.push.apply(t,a.uniformNames.map((function(e){return"#define HAS_UNIFORM_"+e})))}}return t};pl.prototype.getPaintVertexBuffers=function e(){return this._buffers};pl.prototype.getUniforms=function e(t,r){var a=[];for(var n in this.binders){var i=this.binders[n];if(i instanceof ll||i instanceof ul||i instanceof fl){for(var o=0,s=i.uniformNames;o<s.length;o+=1){var l=s[o];if(r[l]){var u=i.getBinding(t,r[l],l);a.push({name:l,property:n,binding:u})}}}}return a};pl.prototype.setUniforms=function e(t,r,a,n){for(var i=0,o=r;i<o.length;i+=1){var s=o[i];var l=s.name;var u=s.property;var c=s.binding;this.binders[u].setUniform(c,n,a.get(u),l)}};pl.prototype.updatePaintBuffers=function e(t){this._buffers=[];for(var r in this.binders){var a=this.binders[r];if(t&&a instanceof hl){var n=t.fromScale===2?a.zoomInPaintVertexBuffer:a.zoomOutPaintVertexBuffer;if(n){this._buffers.push(n)}}else if((a instanceof cl||a instanceof fl)&&a.paintVertexBuffer){this._buffers.push(a.paintVertexBuffer)}}};pl.prototype.upload=function e(t){for(var r in this.binders){var a=this.binders[r];if(a instanceof cl||a instanceof fl||a instanceof hl){a.upload(t)}}this.updatePaintBuffers()};pl.prototype.destroy=function e(){for(var t in this.binders){var r=this.binders[t];if(r instanceof cl||r instanceof fl||r instanceof hl){r.destroy()}}};var vl=function e(t,r,a,n){if(n===void 0)n=function(){return true};this.programConfigurations={};for(var i=0,o=r;i<o.length;i+=1){var s=o[i];this.programConfigurations[s.id]=new pl(s,a,n,t)}this.needsUpload=false;this._featureMap=new Ws;this._bufferOffset=0};vl.prototype.populatePaintArrays=function e(t,r,a,n,i,o){for(var s in this.programConfigurations){this.programConfigurations[s].populatePaintArrays(t,r,n,i,o)}if(r.id!==undefined){this._featureMap.add(r.id,a,this._bufferOffset,t)}this._bufferOffset=t;this.needsUpload=true};vl.prototype.updatePaintArrays=function e(t,r,a,n){for(var i=0,o=a;i<o.length;i+=1){var s=o[i];this.needsUpload=this.programConfigurations[s.id].updatePaintArrays(t,this._featureMap,r,s,n)||this.needsUpload}};vl.prototype.get=function e(t){return this.programConfigurations[t]};vl.prototype.upload=function e(t){if(!this.needsUpload){return}for(var r in this.programConfigurations){this.programConfigurations[r].upload(t)}this.needsUpload=false};vl.prototype.destroy=function e(){for(var t in this.programConfigurations){this.programConfigurations[t].destroy()}};function dl(e,t){var r={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]};return r[e]||[e.replace(t+"-","").replace(/-/g,"_")]}function ml(e){var t={"line-pattern":{source:us,composite:us},"fill-pattern":{source:us,composite:us},"fill-extrusion-pattern":{source:us,composite:us}};return t[e]}function gl(e,t,r){var a={color:{source:Ms,composite:As},number:{source:bs,composite:Ms}};var n=ml(e);return n&&n[r]||a[t][r]}eo("ConstantBinder",ll);eo("CrossFadedConstantBinder",ul);eo("SourceExpressionBinder",cl);eo("CrossFadedCompositeBinder",hl);eo("CompositeExpressionBinder",fl);eo("ProgramConfiguration",pl,{omit:["_buffers"]});eo("ProgramConfigurationSet",vl);var yl=8192;function xl(e){return{min:-1*Math.pow(2,e-1),max:Math.pow(2,e-1)-1}}var bl=xl(15);function _l(e){var t=yl/e.extent;var r=e.loadGeometry();for(var a=0;a<r.length;a++){var n=r[a];for(var i=0;i<n.length;i++){var o=n[i];o.x=Math.round(o.x*t);o.y=Math.round(o.y*t);if(o.x<bl.min||o.x>bl.max||o.y<bl.min||o.y>bl.max){L("Geometry exceeds allowed extent, reduce your vector tile buffer size");o.x=f(o.x,bl.min,bl.max);o.y=f(o.y,bl.min,bl.max)}}}return r}function wl(e,t,r,a,n){e.emplaceBack(t*2+(a+1)/2,r*2+(n+1)/2)}var Tl=function e(t){this.zoom=t.zoom;this.overscaling=t.overscaling;this.layers=t.layers;this.layerIds=this.layers.map((function(e){return e.id}));this.index=t.index;this.hasPattern=false;this.layoutVertexArray=new is;this.indexArray=new gs;this.segments=new Ns;this.programConfigurations=new vl(Bs,t.layers,t.zoom);this.stateDependentLayerIds=this.layers.filter((function(e){return e.isStateDependent()})).map((function(e){return e.id}))};Tl.prototype.populate=function e(t,r,a){var n=this.layers[0];var i=[];var o=null;if(n.type==="circle"){o=n.layout.get("circle-sort-key")}for(var s=0,l=t;s<l.length;s+=1){var u=l[s];var c=u.feature;var f=u.id;var h=u.index;var p=u.sourceLayerIndex;var v=this.layers[0]._featureFilter.needGeometry;var d={type:c.type,id:f,properties:c.properties,geometry:v?_l(c):[]};if(!this.layers[0]._featureFilter.filter(new zo(this.zoom),d,a)){continue}if(!v){d.geometry=_l(c)}var m=o?o.evaluate(d,{},a):undefined;var g={id:f,properties:c.properties,type:c.type,sourceLayerIndex:p,index:h,geometry:d.geometry,patterns:{},sortKey:m};i.push(g)}if(o){i.sort((function(e,t){return e.sortKey-t.sortKey}))}for(var y=0,x=i;y<x.length;y+=1){var b=x[y];var _=b;var w=_.geometry;var T=_.index;var k=_.sourceLayerIndex;var M=t[T].feature;this.addFeature(b,w,T,a);r.featureIndex.insert(M,w,T,k,this.index)}};Tl.prototype.update=function e(t,r,a){if(!this.stateDependentLayers.length){return}this.programConfigurations.updatePaintArrays(t,r,this.stateDependentLayers,a)};Tl.prototype.isEmpty=function e(){return this.layoutVertexArray.length===0};Tl.prototype.uploadPending=function e(){return!this.uploaded||this.programConfigurations.needsUpload};Tl.prototype.upload=function e(t){if(!this.uploaded){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Bs);this.indexBuffer=t.createIndexBuffer(this.indexArray)}this.programConfigurations.upload(t);this.uploaded=true};Tl.prototype.destroy=function e(){if(!this.layoutVertexBuffer){return}this.layoutVertexBuffer.destroy();this.indexBuffer.destroy();this.programConfigurations.destroy();this.segments.destroy()};Tl.prototype.addFeature=function e(t,r,a,n){for(var i=0,o=r;i<o.length;i+=1){var s=o[i];for(var l=0,u=s;l<u.length;l+=1){var c=u[l];var f=c.x;var h=c.y;if(f<0||f>=yl||h<0||h>=yl){continue}var p=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,t.sortKey);var v=p.vertexLength;wl(this.layoutVertexArray,f,h,-1,-1);wl(this.layoutVertexArray,f,h,1,-1);wl(this.layoutVertexArray,f,h,1,1);wl(this.layoutVertexArray,f,h,-1,1);this.indexArray.emplaceBack(v,v+1,v+2);this.indexArray.emplaceBack(v,v+3,v+2);p.vertexLength+=4;p.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,a,{},n)};eo("CircleBucket",Tl,{omit:["layers"]});function kl(e,t){for(var r=0;r<e.length;r++){if(zl(t,e[r])){return true}}for(var a=0;a<t.length;a++){if(zl(e,t[a])){return true}}if(Ll(e,t)){return true}return false}function Ml(e,t,r){if(zl(e,t)){return true}if(Il(t,e,r)){return true}return false}function Al(e,t){if(e.length===1){return Ol(t,e[0])}for(var r=0;r<t.length;r++){var a=t[r];for(var n=0;n<a.length;n++){if(zl(e,a[n])){return true}}}for(var i=0;i<e.length;i++){if(Ol(t,e[i])){return true}}for(var o=0;o<t.length;o++){if(Ll(e,t[o])){return true}}return false}function Sl(e,t,r){for(var a=0;a<t.length;a++){var n=t[a];if(e.length>=3){for(var i=0;i<n.length;i++){if(zl(e,n[i])){return true}}}if(El(e,n,r)){return true}}return false}function El(e,t,r){if(e.length>1){if(Ll(e,t)){return true}for(var a=0;a<t.length;a++){if(Il(t[a],e,r)){return true}}}for(var n=0;n<e.length;n++){if(Il(e[n],t,r)){return true}}return false}function Ll(e,t){if(e.length===0||t.length===0){return false}for(var r=0;r<e.length-1;r++){var a=e[r];var n=e[r+1];for(var i=0;i<t.length-1;i++){var o=t[i];var s=t[i+1];if(Cl(a,n,o,s)){return true}}}return false}function Cl(e,t,r,a){return C(e,r,a)!==C(t,r,a)&&C(e,t,r)!==C(e,t,a)}function Il(e,t,r){var a=r*r;if(t.length===1){return e.distSqr(t[0])<a}for(var n=1;n<t.length;n++){var i=t[n-1],o=t[n];if(Pl(e,i,o)<a){return true}}return false}function Pl(e,t,r){var a=t.distSqr(r);if(a===0){return e.distSqr(t)}var n=((e.x-t.x)*(r.x-t.x)+(e.y-t.y)*(r.y-t.y))/a;if(n<0){return e.distSqr(t)}if(n>1){return e.distSqr(r)}return e.distSqr(r.sub(t)._mult(n)._add(t))}function Ol(e,t){var r=false,a,n,i;for(var o=0;o<e.length;o++){a=e[o];for(var s=0,l=a.length-1;s<a.length;l=s++){n=a[s];i=a[l];if(n.y>t.y!==i.y>t.y&&t.x<(i.x-n.x)*(t.y-n.y)/(i.y-n.y)+n.x){r=!r}}}return r}function zl(e,t){var r=false;for(var a=0,n=e.length-1;a<e.length;n=a++){var i=e[a];var o=e[n];if(i.y>t.y!==o.y>t.y&&t.x<(o.x-i.x)*(t.y-i.y)/(o.y-i.y)+i.x){r=!r}}return r}function Dl(e,t,r,a,n){for(var o=0,s=e;o<s.length;o+=1){var l=s[o];if(t<=l.x&&r<=l.y&&a>=l.x&&n>=l.y){return true}}var u=[new i(t,r),new i(t,n),new i(a,n),new i(a,r)];if(e.length>2){for(var c=0,f=u;c<f.length;c+=1){var h=f[c];if(zl(e,h)){return true}}}for(var p=0;p<e.length-1;p++){var v=e[p];var d=e[p+1];if(Rl(v,d,u)){return true}}return false}function Rl(e,t,r){var a=r[0];var n=r[2];if(e.x<a.x&&t.x<a.x||e.x>n.x&&t.x>n.x||e.y<a.y&&t.y<a.y||e.y>n.y&&t.y>n.y){return false}var i=C(e,t,r[0]);return i!==C(e,t,r[1])||i!==C(e,t,r[2])||i!==C(e,t,r[3])}function Fl(e,t,r){var a=t.paint.get(e).value;if(a.kind==="constant"){return a.value}else{return r.programConfigurations.get(t.id).getMaxValue(e)}}function Bl(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function Nl(e,t,r,a,n){if(!t[0]&&!t[1]){return e}var o=i.convert(t)._mult(n);if(r==="viewport"){o._rotate(-a)}var s=[];for(var l=0;l<e.length;l++){var u=e[l];s.push(u.sub(o))}return s}var jl=new Xo({"circle-sort-key":new qo(Wt["layout_circle"]["circle-sort-key"])});var Ul=new Xo({"circle-radius":new qo(Wt["paint_circle"]["circle-radius"]),"circle-color":new qo(Wt["paint_circle"]["circle-color"]),"circle-blur":new qo(Wt["paint_circle"]["circle-blur"]),"circle-opacity":new qo(Wt["paint_circle"]["circle-opacity"]),"circle-translate":new Ho(Wt["paint_circle"]["circle-translate"]),"circle-translate-anchor":new Ho(Wt["paint_circle"]["circle-translate-anchor"]),"circle-pitch-scale":new Ho(Wt["paint_circle"]["circle-pitch-scale"]),"circle-pitch-alignment":new Ho(Wt["paint_circle"]["circle-pitch-alignment"]),"circle-stroke-width":new qo(Wt["paint_circle"]["circle-stroke-width"]),"circle-stroke-color":new qo(Wt["paint_circle"]["circle-stroke-color"]),"circle-stroke-opacity":new qo(Wt["paint_circle"]["circle-stroke-opacity"])});var Vl={paint:Ul,layout:jl};var Hl=typeof Float32Array!=="undefined"?Float32Array:Array;if(!Math.hypot){Math.hypot=function(){var e=arguments;var t=0,r=arguments.length;while(r--){t+=e[r]*e[r]}return Math.sqrt(t)}}function ql(){var e=new Hl(4);if(Hl!=Float32Array){e[1]=0;e[2]=0}e[0]=1;e[3]=1;return e}function Gl(e,t,r){var a=t[0],n=t[1],i=t[2],o=t[3];var s=Math.sin(r);var l=Math.cos(r);e[0]=a*l+i*s;e[1]=n*l+o*s;e[2]=a*-s+i*l;e[3]=n*-s+o*l;return e}function Yl(){var e=new Hl(9);if(Hl!=Float32Array){e[1]=0;e[2]=0;e[3]=0;e[5]=0;e[6]=0;e[7]=0}e[0]=1;e[4]=1;e[8]=1;return e}function Wl(e,t){var r=Math.sin(t),a=Math.cos(t);e[0]=a;e[1]=r;e[2]=0;e[3]=-r;e[4]=a;e[5]=0;e[6]=0;e[7]=0;e[8]=1;return e}function Xl(){var e=new Hl(16);if(Hl!=Float32Array){e[1]=0;e[2]=0;e[3]=0;e[4]=0;e[6]=0;e[7]=0;e[8]=0;e[9]=0;e[11]=0;e[12]=0;e[13]=0;e[14]=0}e[0]=1;e[5]=1;e[10]=1;e[15]=1;return e}function Zl(e){var t=new Hl(16);t[0]=e[0];t[1]=e[1];t[2]=e[2];t[3]=e[3];t[4]=e[4];t[5]=e[5];t[6]=e[6];t[7]=e[7];t[8]=e[8];t[9]=e[9];t[10]=e[10];t[11]=e[11];t[12]=e[12];t[13]=e[13];t[14]=e[14];t[15]=e[15];return t}function Jl(e){e[0]=1;e[1]=0;e[2]=0;e[3]=0;e[4]=0;e[5]=1;e[6]=0;e[7]=0;e[8]=0;e[9]=0;e[10]=1;e[11]=0;e[12]=0;e[13]=0;e[14]=0;e[15]=1;return e}function Kl(e,t){var r=t[0],a=t[1],n=t[2],i=t[3];var o=t[4],s=t[5],l=t[6],u=t[7];var c=t[8],f=t[9],h=t[10],p=t[11];var v=t[12],d=t[13],m=t[14],g=t[15];var y=r*s-a*o;var x=r*l-n*o;var b=r*u-i*o;var _=a*l-n*s;var w=a*u-i*s;var T=n*u-i*l;var k=c*d-f*v;var M=c*m-h*v;var A=c*g-p*v;var S=f*m-h*d;var E=f*g-p*d;var L=h*g-p*m;var C=y*L-x*E+b*S+_*A-w*M+T*k;if(!C){return null}C=1/C;e[0]=(s*L-l*E+u*S)*C;e[1]=(n*E-a*L-i*S)*C;e[2]=(d*T-m*w+g*_)*C;e[3]=(h*w-f*T-p*_)*C;e[4]=(l*A-o*L-u*M)*C;e[5]=(r*L-n*A+i*M)*C;e[6]=(m*b-v*T-g*x)*C;e[7]=(c*T-h*b+p*x)*C;e[8]=(o*E-s*A+u*k)*C;e[9]=(a*A-r*E-i*k)*C;e[10]=(v*w-d*b+g*y)*C;e[11]=(f*b-c*w-p*y)*C;e[12]=(s*M-o*S-l*k)*C;e[13]=(r*S-a*M+n*k)*C;e[14]=(d*x-v*_-m*y)*C;e[15]=(c*_-f*x+h*y)*C;return e}function Ql(e,t,r){var a=t[0],n=t[1],i=t[2],o=t[3];var s=t[4],l=t[5],u=t[6],c=t[7];var f=t[8],h=t[9],p=t[10],v=t[11];var d=t[12],m=t[13],g=t[14],y=t[15];var x=r[0],b=r[1],_=r[2],w=r[3];e[0]=x*a+b*s+_*f+w*d;e[1]=x*n+b*l+_*h+w*m;e[2]=x*i+b*u+_*p+w*g;e[3]=x*o+b*c+_*v+w*y;x=r[4];b=r[5];_=r[6];w=r[7];e[4]=x*a+b*s+_*f+w*d;e[5]=x*n+b*l+_*h+w*m;e[6]=x*i+b*u+_*p+w*g;e[7]=x*o+b*c+_*v+w*y;x=r[8];b=r[9];_=r[10];w=r[11];e[8]=x*a+b*s+_*f+w*d;e[9]=x*n+b*l+_*h+w*m;e[10]=x*i+b*u+_*p+w*g;e[11]=x*o+b*c+_*v+w*y;x=r[12];b=r[13];_=r[14];w=r[15];e[12]=x*a+b*s+_*f+w*d;e[13]=x*n+b*l+_*h+w*m;e[14]=x*i+b*u+_*p+w*g;e[15]=x*o+b*c+_*v+w*y;return e}function $l(e,t,r){var a=r[0],n=r[1],i=r[2];var o,s,l,u;var c,f,h,p;var v,d,m,g;if(t===e){e[12]=t[0]*a+t[4]*n+t[8]*i+t[12];e[13]=t[1]*a+t[5]*n+t[9]*i+t[13];e[14]=t[2]*a+t[6]*n+t[10]*i+t[14];e[15]=t[3]*a+t[7]*n+t[11]*i+t[15]}else{o=t[0];s=t[1];l=t[2];u=t[3];c=t[4];f=t[5];h=t[6];p=t[7];v=t[8];d=t[9];m=t[10];g=t[11];e[0]=o;e[1]=s;e[2]=l;e[3]=u;e[4]=c;e[5]=f;e[6]=h;e[7]=p;e[8]=v;e[9]=d;e[10]=m;e[11]=g;e[12]=o*a+c*n+v*i+t[12];e[13]=s*a+f*n+d*i+t[13];e[14]=l*a+h*n+m*i+t[14];e[15]=u*a+p*n+g*i+t[15]}return e}function eu(e,t,r){var a=r[0],n=r[1],i=r[2];e[0]=t[0]*a;e[1]=t[1]*a;e[2]=t[2]*a;e[3]=t[3]*a;e[4]=t[4]*n;e[5]=t[5]*n;e[6]=t[6]*n;e[7]=t[7]*n;e[8]=t[8]*i;e[9]=t[9]*i;e[10]=t[10]*i;e[11]=t[11]*i;e[12]=t[12];e[13]=t[13];e[14]=t[14];e[15]=t[15];return e}function tu(e,t,r){var a=Math.sin(r);var n=Math.cos(r);var i=t[4];var o=t[5];var s=t[6];var l=t[7];var u=t[8];var c=t[9];var f=t[10];var h=t[11];if(t!==e){e[0]=t[0];e[1]=t[1];e[2]=t[2];e[3]=t[3];e[12]=t[12];e[13]=t[13];e[14]=t[14];e[15]=t[15]}e[4]=i*n+u*a;e[5]=o*n+c*a;e[6]=s*n+f*a;e[7]=l*n+h*a;e[8]=u*n-i*a;e[9]=c*n-o*a;e[10]=f*n-s*a;e[11]=h*n-l*a;return e}function ru(e,t,r){var a=Math.sin(r);var n=Math.cos(r);var i=t[0];var o=t[1];var s=t[2];var l=t[3];var u=t[4];var c=t[5];var f=t[6];var h=t[7];if(t!==e){e[8]=t[8];e[9]=t[9];e[10]=t[10];e[11]=t[11];e[12]=t[12];e[13]=t[13];e[14]=t[14];e[15]=t[15]}e[0]=i*n+u*a;e[1]=o*n+c*a;e[2]=s*n+f*a;e[3]=l*n+h*a;e[4]=u*n-i*a;e[5]=c*n-o*a;e[6]=f*n-s*a;e[7]=h*n-l*a;return e}function au(e,t,r,a,n){var i=1/Math.tan(t/2),o;e[0]=i/r;e[1]=0;e[2]=0;e[3]=0;e[4]=0;e[5]=i;e[6]=0;e[7]=0;e[8]=0;e[9]=0;e[11]=-1;e[12]=0;e[13]=0;e[15]=0;if(n!=null&&n!==Infinity){o=1/(a-n);e[10]=(n+a)*o;e[14]=2*n*a*o}else{e[10]=-1;e[14]=-2*a}return e}function nu(e,t,r,a,n,i,o){var s=1/(t-r);var l=1/(a-n);var u=1/(i-o);e[0]=-2*s;e[1]=0;e[2]=0;e[3]=0;e[4]=0;e[5]=-2*l;e[6]=0;e[7]=0;e[8]=0;e[9]=0;e[10]=2*u;e[11]=0;e[12]=(t+r)*s;e[13]=(n+a)*l;e[14]=(o+i)*u;e[15]=1;return e}var iu=Ql;function ou(){var e=new Hl(3);if(Hl!=Float32Array){e[0]=0;e[1]=0;e[2]=0}return e}function su(e){var t=new Hl(3);t[0]=e[0];t[1]=e[1];t[2]=e[2];return t}function lu(e,t,r){e[0]=t[0]+r[0];e[1]=t[1]+r[1];e[2]=t[2]+r[2];return e}function uu(e,t,r){e[0]=t[0]-r[0];e[1]=t[1]-r[1];e[2]=t[2]-r[2];return e}function cu(e,t,r){e[0]=t[0]*r;e[1]=t[1]*r;e[2]=t[2]*r;return e}function fu(e,t){var r=t[0];var a=t[1];var n=t[2];var i=r*r+a*a+n*n;if(i>0){i=1/Math.sqrt(i)}e[0]=t[0]*i;e[1]=t[1]*i;e[2]=t[2]*i;return e}function hu(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function pu(e,t,r){var a=t[0],n=t[1],i=t[2];var o=r[0],s=r[1],l=r[2];e[0]=n*l-i*s;e[1]=i*o-a*l;e[2]=a*s-n*o;return e}function vu(e,t,r){var a=t[0],n=t[1],i=t[2];e[0]=a*r[0]+n*r[3]+i*r[6];e[1]=a*r[1]+n*r[4]+i*r[7];e[2]=a*r[2]+n*r[5]+i*r[8];return e}var du=uu;var mu=function(){var e=ou();return function(t,r,a,n,i,o){var s,l;if(!r){r=3}if(!a){a=0}if(n){l=Math.min(n*r+a,t.length)}else{l=t.length}for(s=a;s<l;s+=r){e[0]=t[s];e[1]=t[s+1];e[2]=t[s+2];i(e,e,o);t[s]=e[0];t[s+1]=e[1];t[s+2]=e[2]}return t}}();function gu(){var e=new Hl(4);if(Hl!=Float32Array){e[0]=0;e[1]=0;e[2]=0;e[3]=0}return e}function yu(e,t,r){e[0]=t[0]*r;e[1]=t[1]*r;e[2]=t[2]*r;e[3]=t[3]*r;return e}function xu(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function bu(e,t,r){var a=t[0],n=t[1],i=t[2],o=t[3];e[0]=r[0]*a+r[4]*n+r[8]*i+r[12]*o;e[1]=r[1]*a+r[5]*n+r[9]*i+r[13]*o;e[2]=r[2]*a+r[6]*n+r[10]*i+r[14]*o;e[3]=r[3]*a+r[7]*n+r[11]*i+r[15]*o;return e}var _u=function(){var e=gu();return function(t,r,a,n,i,o){var s,l;if(!r){r=4}if(!a){a=0}if(n){l=Math.min(n*r+a,t.length)}else{l=t.length}for(s=a;s<l;s+=r){e[0]=t[s];e[1]=t[s+1];e[2]=t[s+2];e[3]=t[s+3];i(e,e,o);t[s]=e[0];t[s+1]=e[1];t[s+2]=e[2];t[s+3]=e[3]}return t}}();function wu(){var e=new Hl(2);if(Hl!=Float32Array){e[0]=0;e[1]=0}return e}function Tu(e){var t=e[0],r=e[1];return t*t+r*r}var ku=Tu;var Mu=function(){var e=wu();return function(t,r,a,n,i,o){var s,l;if(!r){r=2}if(!a){a=0}if(n){l=Math.min(n*r+a,t.length)}else{l=t.length}for(s=a;s<l;s+=r){e[0]=t[s];e[1]=t[s+1];i(e,e,o);t[s]=e[0];t[s+1]=e[1]}return t}}();var Au=function(e){function t(t){e.call(this,t,Vl)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype.createBucket=function e(t){return new Tl(t)};t.prototype.queryRadius=function e(t){var r=t;return Fl("circle-radius",this,r)+Fl("circle-stroke-width",this,r)+Bl(this.paint.get("circle-translate"))};t.prototype.queryIntersectsFeature=function e(t,r,a,n,i,o,s,l){var u=Nl(t,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),o.angle,s);var c=this.paint.get("circle-radius").evaluate(r,a);var f=this.paint.get("circle-stroke-width").evaluate(r,a);var h=c+f;var p=this.paint.get("circle-pitch-alignment")==="map";var v=p?u:Eu(u,l);var d=p?h*s:h;for(var m=0,g=n;m<g.length;m+=1){var y=g[m];for(var x=0,b=y;x<b.length;x+=1){var _=b[x];var w=p?_:Su(_,l);var T=d;var k=bu([],[_.x,_.y,0,1],l);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"){T*=k[3]/o.cameraToCenterDistance}else if(this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"){T*=o.cameraToCenterDistance/k[3]}if(Ml(v,w,T)){return true}}}return false};return t}(Jo);function Su(e,t){var r=bu([],[e.x,e.y,0,1],t);return new i(r[0]/r[3],r[1]/r[3])}function Eu(e,t){return e.map((function(e){return Su(e,t)}))}var Lu=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;return t}(Tl);eo("HeatmapBucket",Lu,{omit:["layers"]});function Cu(e,t,r,a){var n=t.width;var i=t.height;if(!a){a=new Uint8Array(n*i*r)}else if(a instanceof Uint8ClampedArray){a=new Uint8Array(a.buffer)}else if(a.length!==n*i*r){throw new RangeError("mismatched image size")}e.width=n;e.height=i;e.data=a;return e}function Iu(e,t,r){var a=t.width;var n=t.height;if(a===e.width&&n===e.height){return}var i=Cu({},{width:a,height:n},r);Pu(e,i,{x:0,y:0},{x:0,y:0},{width:Math.min(e.width,a),height:Math.min(e.height,n)},r);e.width=a;e.height=n;e.data=i.data}function Pu(e,t,r,a,n,i){if(n.width===0||n.height===0){return t}if(n.width>e.width||n.height>e.height||r.x>e.width-n.width||r.y>e.height-n.height){throw new RangeError("out of range source coordinates for image copy")}if(n.width>t.width||n.height>t.height||a.x>t.width-n.width||a.y>t.height-n.height){throw new RangeError("out of range destination coordinates for image copy")}var o=e.data;var s=t.data;for(var l=0;l<n.height;l++){var u=((r.y+l)*e.width+r.x)*i;var c=((a.y+l)*t.width+a.x)*i;for(var f=0;f<n.width*i;f++){s[c+f]=o[u+f]}}return t}var Ou=function e(t,r){Cu(this,t,1,r)};Ou.prototype.resize=function e(t){Iu(this,t,1)};Ou.prototype.clone=function e(){return new Ou({width:this.width,height:this.height},new Uint8Array(this.data))};Ou.copy=function e(t,r,a,n,i){Pu(t,r,a,n,i,1)};var zu=function e(t,r){Cu(this,t,4,r)};zu.prototype.resize=function e(t){Iu(this,t,4)};zu.prototype.replace=function e(t,r){if(r){this.data.set(t)}else if(t instanceof Uint8ClampedArray){this.data=new Uint8Array(t.buffer)}else{this.data=t}};zu.prototype.clone=function e(){return new zu({width:this.width,height:this.height},new Uint8Array(this.data))};zu.copy=function e(t,r,a,n,i){Pu(t,r,a,n,i,4)};eo("AlphaImage",Ou);eo("RGBAImage",zu);var Du=new Xo({"heatmap-radius":new qo(Wt["paint_heatmap"]["heatmap-radius"]),"heatmap-weight":new qo(Wt["paint_heatmap"]["heatmap-weight"]),"heatmap-intensity":new Ho(Wt["paint_heatmap"]["heatmap-intensity"]),"heatmap-color":new Wo(Wt["paint_heatmap"]["heatmap-color"]),"heatmap-opacity":new Ho(Wt["paint_heatmap"]["heatmap-opacity"])});var Ru={paint:Du};function Fu(e,t){var r=new Uint8Array(256*4);var a={};for(var n=0,i=0;n<256;n++,i+=4){a[t]=n/255;var o=e.evaluate(a);r[i+0]=Math.floor(o.r*255/o.a);r[i+1]=Math.floor(o.g*255/o.a);r[i+2]=Math.floor(o.b*255/o.a);r[i+3]=Math.floor(o.a*255)}return new zu({width:256,height:1},r)}var Bu=function(e){function t(t){e.call(this,t,Ru);this._updateColorRamp()}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype.createBucket=function e(t){return new Lu(t)};t.prototype._handleSpecialPaintPropertyUpdate=function e(t){if(t==="heatmap-color"){this._updateColorRamp()}};t.prototype._updateColorRamp=function e(){var t=this._transitionablePaint._values["heatmap-color"].value.expression;this.colorRamp=Fu(t,"heatmapDensity");this.colorRampTexture=null};t.prototype.resize=function e(){if(this.heatmapFbo){this.heatmapFbo.destroy();this.heatmapFbo=null}};t.prototype.queryRadius=function e(){return 0};t.prototype.queryIntersectsFeature=function e(){return false};t.prototype.hasOffscreenPass=function e(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"};return t}(Jo);var Nu=new Xo({"hillshade-illumination-direction":new Ho(Wt["paint_hillshade"]["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Ho(Wt["paint_hillshade"]["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Ho(Wt["paint_hillshade"]["hillshade-exaggeration"]),"hillshade-shadow-color":new Ho(Wt["paint_hillshade"]["hillshade-shadow-color"]),"hillshade-highlight-color":new Ho(Wt["paint_hillshade"]["hillshade-highlight-color"]),"hillshade-accent-color":new Ho(Wt["paint_hillshade"]["hillshade-accent-color"])});var ju={paint:Nu};var Uu=function(e){function t(t){e.call(this,t,ju)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype.hasOffscreenPass=function e(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"};return t}(Jo);var Vu=rs([{name:"a_pos",components:2,type:"Int16"}],4);var Hu=Vu.members;var qu=Yu;var Gu=Yu;function Yu(e,t,r){r=r||2;var a=t&&t.length,n=a?t[0]*r:e.length,i=Wu(e,0,n,r,true),o=[];if(!i||i.next===i.prev){return o}var s,l,u,c,f,h,p;if(a){i=ec(e,t,i,r)}if(e.length>80*r){s=u=e[0];l=c=e[1];for(var v=r;v<n;v+=r){f=e[v];h=e[v+1];if(f<s){s=f}if(h<l){l=h}if(f>u){u=f}if(h>c){c=h}}p=Math.max(u-s,c-l);p=p!==0?1/p:0}Zu(i,o,r,s,l,p);return o}function Wu(e,t,r,a,n){var i,o;if(n===Tc(e,t,r,a)>0){for(i=t;i<r;i+=a){o=bc(i,e[i],e[i+1],o)}}else{for(i=r-a;i>=t;i-=a){o=bc(i,e[i],e[i+1],o)}}if(o&&hc(o,o.next)){_c(o);o=o.next}return o}function Xu(e,t){if(!e){return e}if(!t){t=e}var r=e,a;do{a=false;if(!r.steiner&&(hc(r,r.next)||fc(r.prev,r,r.next)===0)){_c(r);r=t=r.prev;if(r===r.next){break}a=true}else{r=r.next}}while(a||r!==t);return t}function Zu(e,t,r,a,n,i,o){if(!e){return}if(!o&&i){ic(e,a,n,i)}var s=e,l,u;while(e.prev!==e.next){l=e.prev;u=e.next;if(i?Ku(e,a,n,i):Ju(e)){t.push(l.i/r);t.push(e.i/r);t.push(u.i/r);_c(e);e=u.next;s=u.next;continue}e=u;if(e===s){if(!o){Zu(Xu(e),t,r,a,n,i,1)}else if(o===1){e=Qu(Xu(e),t,r);Zu(e,t,r,a,n,i,2)}else if(o===2){$u(e,t,r,a,n,i)}break}}}function Ju(e){var t=e.prev,r=e,a=e.next;if(fc(t,r,a)>=0){return false}var n=e.next.next;while(n!==e.prev){if(uc(t.x,t.y,r.x,r.y,a.x,a.y,n.x,n.y)&&fc(n.prev,n,n.next)>=0){return false}n=n.next}return true}function Ku(e,t,r,a){var n=e.prev,i=e,o=e.next;if(fc(n,i,o)>=0){return false}var s=n.x<i.x?n.x<o.x?n.x:o.x:i.x<o.x?i.x:o.x,l=n.y<i.y?n.y<o.y?n.y:o.y:i.y<o.y?i.y:o.y,u=n.x>i.x?n.x>o.x?n.x:o.x:i.x>o.x?i.x:o.x,c=n.y>i.y?n.y>o.y?n.y:o.y:i.y>o.y?i.y:o.y;var f=sc(s,l,t,r,a),h=sc(u,c,t,r,a);var p=e.prevZ,v=e.nextZ;while(p&&p.z>=f&&v&&v.z<=h){if(p!==e.prev&&p!==e.next&&uc(n.x,n.y,i.x,i.y,o.x,o.y,p.x,p.y)&&fc(p.prev,p,p.next)>=0){return false}p=p.prevZ;if(v!==e.prev&&v!==e.next&&uc(n.x,n.y,i.x,i.y,o.x,o.y,v.x,v.y)&&fc(v.prev,v,v.next)>=0){return false}v=v.nextZ}while(p&&p.z>=f){if(p!==e.prev&&p!==e.next&&uc(n.x,n.y,i.x,i.y,o.x,o.y,p.x,p.y)&&fc(p.prev,p,p.next)>=0){return false}p=p.prevZ}while(v&&v.z<=h){if(v!==e.prev&&v!==e.next&&uc(n.x,n.y,i.x,i.y,o.x,o.y,v.x,v.y)&&fc(v.prev,v,v.next)>=0){return false}v=v.nextZ}return true}function Qu(e,t,r){var a=e;do{var n=a.prev,i=a.next.next;if(!hc(n,i)&&pc(n,a,a.next,i)&&gc(n,i)&&gc(i,n)){t.push(n.i/r);t.push(a.i/r);t.push(i.i/r);_c(a);_c(a.next);a=e=i}a=a.next}while(a!==e);return Xu(a)}function $u(e,t,r,a,n,i){var o=e;do{var s=o.next.next;while(s!==o.prev){if(o.i!==s.i&&cc(o,s)){var l=xc(o,s);o=Xu(o,o.next);l=Xu(l,l.next);Zu(o,t,r,a,n,i);Zu(l,t,r,a,n,i);return}s=s.next}o=o.next}while(o!==e)}function ec(e,t,r,a){var n=[],i,o,s,l,u;for(i=0,o=t.length;i<o;i++){s=t[i]*a;l=i<o-1?t[i+1]*a:e.length;u=Wu(e,s,l,a,false);if(u===u.next){u.steiner=true}n.push(lc(u))}n.sort(tc);for(i=0;i<n.length;i++){rc(n[i],r);r=Xu(r,r.next)}return r}function tc(e,t){return e.x-t.x}function rc(e,t){t=ac(e,t);if(t){var r=xc(t,e);Xu(t,t.next);Xu(r,r.next)}}function ac(e,t){var r=t,a=e.x,n=e.y,i=-Infinity,o;do{if(n<=r.y&&n>=r.next.y&&r.next.y!==r.y){var s=r.x+(n-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=a&&s>i){i=s;if(s===a){if(n===r.y){return r}if(n===r.next.y){return r.next}}o=r.x<r.next.x?r:r.next}}r=r.next}while(r!==t);if(!o){return null}if(a===i){return o}var l=o,u=o.x,c=o.y,f=Infinity,h;r=o;do{if(a>=r.x&&r.x>=u&&a!==r.x&&uc(n<c?a:i,n,u,c,n<c?i:a,n,r.x,r.y)){h=Math.abs(n-r.y)/(a-r.x);if(gc(r,e)&&(h<f||h===f&&(r.x>o.x||r.x===o.x&&nc(o,r)))){o=r;f=h}}r=r.next}while(r!==l);return o}function nc(e,t){return fc(e.prev,e,t.prev)<0&&fc(t.next,e,e.next)<0}function ic(e,t,r,a){var n=e;do{if(n.z===null){n.z=sc(n.x,n.y,t,r,a)}n.prevZ=n.prev;n.nextZ=n.next;n=n.next}while(n!==e);n.prevZ.nextZ=null;n.prevZ=null;oc(n)}function oc(e){var t,r,a,n,i,o,s,l,u=1;do{r=e;e=null;i=null;o=0;while(r){o++;a=r;s=0;for(t=0;t<u;t++){s++;a=a.nextZ;if(!a){break}}l=u;while(s>0||l>0&&a){if(s!==0&&(l===0||!a||r.z<=a.z)){n=r;r=r.nextZ;s--}else{n=a;a=a.nextZ;l--}if(i){i.nextZ=n}else{e=n}n.prevZ=i;i=n}r=a}i.nextZ=null;u*=2}while(o>1);return e}function sc(e,t,r,a,n){e=32767*(e-r)*n;t=32767*(t-a)*n;e=(e|e<<8)&16711935;e=(e|e<<4)&252645135;e=(e|e<<2)&858993459;e=(e|e<<1)&1431655765;t=(t|t<<8)&16711935;t=(t|t<<4)&252645135;t=(t|t<<2)&858993459;t=(t|t<<1)&1431655765;return e|t<<1}function lc(e){var t=e,r=e;do{if(t.x<r.x||t.x===r.x&&t.y<r.y){r=t}t=t.next}while(t!==e);return r}function uc(e,t,r,a,n,i,o,s){return(n-o)*(t-s)-(e-o)*(i-s)>=0&&(e-o)*(a-s)-(r-o)*(t-s)>=0&&(r-o)*(i-s)-(n-o)*(a-s)>=0}function cc(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!mc(e,t)&&(gc(e,t)&&gc(t,e)&&yc(e,t)&&(fc(e.prev,e,t.prev)||fc(e,t.prev,t))||hc(e,t)&&fc(e.prev,e,e.next)>0&&fc(t.prev,t,t.next)>0)}function fc(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function hc(e,t){return e.x===t.x&&e.y===t.y}function pc(e,t,r,a){var n=dc(fc(e,t,r));var i=dc(fc(e,t,a));var o=dc(fc(r,a,e));var s=dc(fc(r,a,t));if(n!==i&&o!==s){return true}if(n===0&&vc(e,r,t)){return true}if(i===0&&vc(e,a,t)){return true}if(o===0&&vc(r,e,a)){return true}if(s===0&&vc(r,t,a)){return true}return false}function vc(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function dc(e){return e>0?1:e<0?-1:0}function mc(e,t){var r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&pc(r,r.next,e,t)){return true}r=r.next}while(r!==e);return false}function gc(e,t){return fc(e.prev,e,e.next)<0?fc(e,t,e.next)>=0&&fc(e,e.prev,t)>=0:fc(e,t,e.prev)<0||fc(e,e.next,t)<0}function yc(e,t){var r=e,a=false,n=(e.x+t.x)/2,i=(e.y+t.y)/2;do{if(r.y>i!==r.next.y>i&&r.next.y!==r.y&&n<(r.next.x-r.x)*(i-r.y)/(r.next.y-r.y)+r.x){a=!a}r=r.next}while(r!==e);return a}function xc(e,t){var r=new wc(e.i,e.x,e.y),a=new wc(t.i,t.x,t.y),n=e.next,i=t.prev;e.next=t;t.prev=e;r.next=n;n.prev=r;a.next=r;r.prev=a;i.next=a;a.prev=i;return a}function bc(e,t,r,a){var n=new wc(e,t,r);if(!a){n.prev=n;n.next=n}else{n.next=a.next;n.prev=a;a.next.prev=n;a.next=n}return n}function _c(e){e.next.prev=e.prev;e.prev.next=e.next;if(e.prevZ){e.prevZ.nextZ=e.nextZ}if(e.nextZ){e.nextZ.prevZ=e.prevZ}}function wc(e,t,r){this.i=e;this.x=t;this.y=r;this.prev=null;this.next=null;this.z=null;this.prevZ=null;this.nextZ=null;this.steiner=false}Yu.deviation=function(e,t,r,a){var n=t&&t.length;var i=n?t[0]*r:e.length;var o=Math.abs(Tc(e,0,i,r));if(n){for(var s=0,l=t.length;s<l;s++){var u=t[s]*r;var c=s<l-1?t[s+1]*r:e.length;o-=Math.abs(Tc(e,u,c,r))}}var f=0;for(s=0;s<a.length;s+=3){var h=a[s]*r;var p=a[s+1]*r;var v=a[s+2]*r;f+=Math.abs((e[h]-e[v])*(e[p+1]-e[h+1])-(e[h]-e[p])*(e[v+1]-e[h+1]))}return o===0&&f===0?0:Math.abs((f-o)/o)};function Tc(e,t,r,a){var n=0;for(var i=t,o=r-a;i<r;i+=a){n+=(e[o]-e[i])*(e[i+1]+e[o+1]);o=i}return n}Yu.flatten=function(e){var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},a=0;for(var n=0;n<e.length;n++){for(var i=0;i<e[n].length;i++){for(var o=0;o<t;o++){r.vertices.push(e[n][i][o])}}if(n>0){a+=e[n-1].length;r.holes.push(a)}}return r};qu.default=Gu;function kc(e,t,r,a,n){Mc(e,t,r||0,a||e.length-1,n||Sc)}function Mc(e,t,r,a,n){while(a>r){if(a-r>600){var i=a-r+1;var o=t-r+1;var s=Math.log(i);var l=.5*Math.exp(2*s/3);var u=.5*Math.sqrt(s*l*(i-l)/i)*(o-i/2<0?-1:1);var c=Math.max(r,Math.floor(t-o*l/i+u));var f=Math.min(a,Math.floor(t+(i-o)*l/i+u));Mc(e,t,c,f,n)}var h=e[t];var p=r;var v=a;Ac(e,r,t);if(n(e[a],h)>0){Ac(e,r,a)}while(p<v){Ac(e,p,v);p++;v--;while(n(e[p],h)<0){p++}while(n(e[v],h)>0){v--}}if(n(e[r],h)===0){Ac(e,r,v)}else{v++;Ac(e,v,a)}if(v<=t){r=v+1}if(t<=v){a=v-1}}}function Ac(e,t,r){var a=e[t];e[t]=e[r];e[r]=a}function Sc(e,t){return e<t?-1:e>t?1:0}function Ec(e,t){var r=e.length;if(r<=1){return[e]}var a=[];var n,i;for(var o=0;o<r;o++){var s=I(e[o]);if(s===0){continue}e[o].area=Math.abs(s);if(i===undefined){i=s<0}if(i===s<0){if(n){a.push(n)}n=[e[o]]}else{n.push(e[o])}}if(n){a.push(n)}if(t>1){for(var l=0;l<a.length;l++){if(a[l].length<=t){continue}kc(a[l],t,1,a[l].length-1,Lc);a[l]=a[l].slice(0,t)}}return a}function Lc(e,t){return t.area-e.area}function Cc(e,t,r){var a=r.patternDependencies;var n=false;for(var i=0,o=t;i<o.length;i+=1){var s=o[i];var l=s.paint.get(e+"-pattern");if(!l.isConstant()){n=true}var u=l.constantOr(null);if(u){n=true;a[u.to]=true;a[u.from]=true}}return n}function Ic(e,t,r,a,n){var i=n.patternDependencies;for(var o=0,s=t;o<s.length;o+=1){var l=s[o];var u=l.paint.get(e+"-pattern");var c=u.value;if(c.kind!=="constant"){var f=c.evaluate({zoom:a-1},r,{},n.availableImages);var h=c.evaluate({zoom:a},r,{},n.availableImages);var p=c.evaluate({zoom:a+1},r,{},n.availableImages);f=f&&f.name?f.name:f;h=h&&h.name?h.name:h;p=p&&p.name?p.name:p;i[f]=true;i[h]=true;i[p]=true;r.patterns[l.id]={min:f,mid:h,max:p}}}return r}var Pc=500;var Oc=function e(t){this.zoom=t.zoom;this.overscaling=t.overscaling;this.layers=t.layers;this.layerIds=this.layers.map((function(e){return e.id}));this.index=t.index;this.hasPattern=false;this.patternFeatures=[];this.layoutVertexArray=new is;this.indexArray=new gs;this.indexArray2=new Ts;this.programConfigurations=new vl(Hu,t.layers,t.zoom);this.segments=new Ns;this.segments2=new Ns;this.stateDependentLayerIds=this.layers.filter((function(e){return e.isStateDependent()})).map((function(e){return e.id}))};Oc.prototype.populate=function e(t,r,a){this.hasPattern=Cc("fill",this.layers,r);var n=this.layers[0].layout.get("fill-sort-key");var i=[];for(var o=0,s=t;o<s.length;o+=1){var l=s[o];var u=l.feature;var c=l.id;var f=l.index;var h=l.sourceLayerIndex;var p=this.layers[0]._featureFilter.needGeometry;var v={type:u.type,id:c,properties:u.properties,geometry:p?_l(u):[]};if(!this.layers[0]._featureFilter.filter(new zo(this.zoom),v,a)){continue}if(!p){v.geometry=_l(u)}var d=n?n.evaluate(v,{},a,r.availableImages):undefined;var m={id:c,properties:u.properties,type:u.type,sourceLayerIndex:h,index:f,geometry:v.geometry,patterns:{},sortKey:d};i.push(m)}if(n){i.sort((function(e,t){return e.sortKey-t.sortKey}))}for(var g=0,y=i;g<y.length;g+=1){var x=y[g];var b=x;var _=b.geometry;var w=b.index;var T=b.sourceLayerIndex;if(this.hasPattern){var k=Ic("fill",this.layers,x,this.zoom,r);this.patternFeatures.push(k)}else{this.addFeature(x,_,w,a,{})}var M=t[w].feature;r.featureIndex.insert(M,_,w,T,this.index)}};Oc.prototype.update=function e(t,r,a){if(!this.stateDependentLayers.length){return}this.programConfigurations.updatePaintArrays(t,r,this.stateDependentLayers,a)};Oc.prototype.addFeatures=function e(t,r,a){for(var n=0,i=this.patternFeatures;n<i.length;n+=1){var o=i[n];this.addFeature(o,o.geometry,o.index,r,a)}};Oc.prototype.isEmpty=function e(){return this.layoutVertexArray.length===0};Oc.prototype.uploadPending=function e(){return!this.uploaded||this.programConfigurations.needsUpload};Oc.prototype.upload=function e(t){if(!this.uploaded){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Hu);this.indexBuffer=t.createIndexBuffer(this.indexArray);this.indexBuffer2=t.createIndexBuffer(this.indexArray2)}this.programConfigurations.upload(t);this.uploaded=true};Oc.prototype.destroy=function e(){if(!this.layoutVertexBuffer){return}this.layoutVertexBuffer.destroy();this.indexBuffer.destroy();this.indexBuffer2.destroy();this.programConfigurations.destroy();this.segments.destroy();this.segments2.destroy()};Oc.prototype.addFeature=function e(t,r,a,n,i){for(var o=0,s=Ec(r,Pc);o<s.length;o+=1){var l=s[o];var u=0;for(var c=0,f=l;c<f.length;c+=1){var h=f[c];u+=h.length}var p=this.segments.prepareSegment(u,this.layoutVertexArray,this.indexArray);var v=p.vertexLength;var d=[];var m=[];for(var g=0,y=l;g<y.length;g+=1){var x=y[g];if(x.length===0){continue}if(x!==l[0]){m.push(d.length/2)}var b=this.segments2.prepareSegment(x.length,this.layoutVertexArray,this.indexArray2);var _=b.vertexLength;this.layoutVertexArray.emplaceBack(x[0].x,x[0].y);this.indexArray2.emplaceBack(_+x.length-1,_);d.push(x[0].x);d.push(x[0].y);for(var w=1;w<x.length;w++){this.layoutVertexArray.emplaceBack(x[w].x,x[w].y);this.indexArray2.emplaceBack(_+w-1,_+w);d.push(x[w].x);d.push(x[w].y)}b.vertexLength+=x.length;b.primitiveLength+=x.length}var T=qu(d,m);for(var k=0;k<T.length;k+=3){this.indexArray.emplaceBack(v+T[k],v+T[k+1],v+T[k+2])}p.vertexLength+=u;p.primitiveLength+=T.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,a,i,n)};eo("FillBucket",Oc,{omit:["layers","patternFeatures"]});var zc=new Xo({"fill-sort-key":new qo(Wt["layout_fill"]["fill-sort-key"])});var Dc=new Xo({"fill-antialias":new Ho(Wt["paint_fill"]["fill-antialias"]),"fill-opacity":new qo(Wt["paint_fill"]["fill-opacity"]),"fill-color":new qo(Wt["paint_fill"]["fill-color"]),"fill-outline-color":new qo(Wt["paint_fill"]["fill-outline-color"]),"fill-translate":new Ho(Wt["paint_fill"]["fill-translate"]),"fill-translate-anchor":new Ho(Wt["paint_fill"]["fill-translate-anchor"]),"fill-pattern":new Go(Wt["paint_fill"]["fill-pattern"])});var Rc={paint:Dc,layout:zc};var Fc=function(e){function t(t){e.call(this,t,Rc)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype.recalculate=function t(r,a){e.prototype.recalculate.call(this,r,a);var n=this.paint._values["fill-outline-color"];if(n.value.kind==="constant"&&n.value.value===undefined){this.paint._values["fill-outline-color"]=this.paint._values["fill-color"]}};t.prototype.createBucket=function e(t){return new Oc(t)};t.prototype.queryRadius=function e(){return Bl(this.paint.get("fill-translate"))};t.prototype.queryIntersectsFeature=function e(t,r,a,n,i,o,s){var l=Nl(t,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),o.angle,s);return Al(l,n)};t.prototype.isTileClipped=function e(){return true};return t}(Jo);var Bc=rs([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4);var Nc=Bc.members;var jc=Uc;function Uc(e,t,r,a,n){this.properties={};this.extent=r;this.type=0;this._pbf=e;this._geometry=-1;this._keys=a;this._values=n;e.readFields(Vc,this,t)}function Vc(e,t,r){if(e==1){t.id=r.readVarint()}else if(e==2){Hc(r,t)}else if(e==3){t.type=r.readVarint()}else if(e==4){t._geometry=r.pos}}function Hc(e,t){var r=e.readVarint()+e.pos;while(e.pos<r){var a=t._keys[e.readVarint()],n=t._values[e.readVarint()];t.properties[a]=n}}Uc.types=["Unknown","Point","LineString","Polygon"];Uc.prototype.loadGeometry=function(){var e=this._pbf;e.pos=this._geometry;var t=e.readVarint()+e.pos,r=1,a=0,n=0,o=0,s=[],l;while(e.pos<t){if(a<=0){var u=e.readVarint();r=u&7;a=u>>3}a--;if(r===1||r===2){n+=e.readSVarint();o+=e.readSVarint();if(r===1){if(l){s.push(l)}l=[]}l.push(new i(n,o))}else if(r===7){if(l){l.push(l[0].clone())}}else{throw new Error("unknown command "+r)}}if(l){s.push(l)}return s};Uc.prototype.bbox=function(){var e=this._pbf;e.pos=this._geometry;var t=e.readVarint()+e.pos,r=1,a=0,n=0,i=0,o=Infinity,s=-Infinity,l=Infinity,u=-Infinity;while(e.pos<t){if(a<=0){var c=e.readVarint();r=c&7;a=c>>3}a--;if(r===1||r===2){n+=e.readSVarint();i+=e.readSVarint();if(n<o){o=n}if(n>s){s=n}if(i<l){l=i}if(i>u){u=i}}else if(r!==7){throw new Error("unknown command "+r)}}return[o,l,s,u]};Uc.prototype.toGeoJSON=function(e,t,r){var a=this.extent*Math.pow(2,r),n=this.extent*e,i=this.extent*t,o=this.loadGeometry(),s=Uc.types[this.type],l,u;function c(e){for(var t=0;t<e.length;t++){var r=e[t],o=180-(r.y+i)*360/a;e[t]=[(r.x+n)*360/a-180,360/Math.PI*Math.atan(Math.exp(o*Math.PI/180))-90]}}switch(this.type){case 1:var f=[];for(l=0;l<o.length;l++){f[l]=o[l][0]}o=f;c(o);break;case 2:for(l=0;l<o.length;l++){c(o[l])}break;case 3:o=qc(o);for(l=0;l<o.length;l++){for(u=0;u<o[l].length;u++){c(o[l][u])}}break}if(o.length===1){o=o[0]}else{s="Multi"+s}var h={type:"Feature",geometry:{type:s,coordinates:o},properties:this.properties};if("id"in this){h.id=this.id}return h};function qc(e){var t=e.length;if(t<=1){return[e]}var r=[],a,n;for(var i=0;i<t;i++){var o=Gc(e[i]);if(o===0){continue}if(n===undefined){n=o<0}if(n===o<0){if(a){r.push(a)}a=[e[i]]}else{a.push(e[i])}}if(a){r.push(a)}return r}function Gc(e){var t=0;for(var r=0,a=e.length,n=a-1,i,o;r<a;n=r++){i=e[r];o=e[n];t+=(o.x-i.x)*(i.y+o.y)}return t}var Yc=Wc;function Wc(e,t){this.version=1;this.name=null;this.extent=4096;this.length=0;this._pbf=e;this._keys=[];this._values=[];this._features=[];e.readFields(Xc,this,t);this.length=this._features.length}function Xc(e,t,r){if(e===15){t.version=r.readVarint()}else if(e===1){t.name=r.readString()}else if(e===5){t.extent=r.readVarint()}else if(e===2){t._features.push(r.pos)}else if(e===3){t._keys.push(r.readString())}else if(e===4){t._values.push(Zc(r))}}function Zc(e){var t=null,r=e.readVarint()+e.pos;while(e.pos<r){var a=e.readVarint()>>3;t=a===1?e.readString():a===2?e.readFloat():a===3?e.readDouble():a===4?e.readVarint64():a===5?e.readVarint():a===6?e.readSVarint():a===7?e.readBoolean():null}return t}Wc.prototype.feature=function(e){if(e<0||e>=this._features.length){throw new Error("feature index out of bounds")}this._pbf.pos=this._features[e];var t=this._pbf.readVarint()+this._pbf.pos;return new jc(this._pbf,t,this.extent,this._keys,this._values)};var Jc=Kc;function Kc(e,t){this.layers=e.readFields(Qc,{},t)}function Qc(e,t,r){if(e===3){var a=new Yc(r,r.readVarint()+r.pos);if(a.length){t[a.name]=a}}}var $c=Jc;var ef=jc;var tf=Yc;var rf={VectorTile:$c,VectorTileFeature:ef,VectorTileLayer:tf};var af=rf.VectorTileFeature.types;var nf=500;var of=Math.pow(2,13);function sf(e,t,r,a,n,i,o,s){e.emplaceBack(t,r,Math.floor(a*of)*2+o,n*of*2,i*of*2,Math.round(s))}var lf=function e(t){this.zoom=t.zoom;this.overscaling=t.overscaling;this.layers=t.layers;this.layerIds=this.layers.map((function(e){return e.id}));this.index=t.index;this.hasPattern=false;this.layoutVertexArray=new ss;this.indexArray=new gs;this.programConfigurations=new vl(Nc,t.layers,t.zoom);this.segments=new Ns;this.stateDependentLayerIds=this.layers.filter((function(e){return e.isStateDependent()})).map((function(e){return e.id}))};lf.prototype.populate=function e(t,r,a){this.features=[];this.hasPattern=Cc("fill-extrusion",this.layers,r);for(var n=0,i=t;n<i.length;n+=1){var o=i[n];var s=o.feature;var l=o.id;var u=o.index;var c=o.sourceLayerIndex;var f=this.layers[0]._featureFilter.needGeometry;var h={type:s.type,id:l,properties:s.properties,geometry:f?_l(s):[]};if(!this.layers[0]._featureFilter.filter(new zo(this.zoom),h,a)){continue}var p={id:l,sourceLayerIndex:c,index:u,geometry:f?h.geometry:_l(s),properties:s.properties,type:s.type,patterns:{}};if(typeof s.id!=="undefined"){p.id=s.id}if(this.hasPattern){this.features.push(Ic("fill-extrusion",this.layers,p,this.zoom,r))}else{this.addFeature(p,p.geometry,u,a,{})}r.featureIndex.insert(s,p.geometry,u,c,this.index,true)}};lf.prototype.addFeatures=function e(t,r,a){for(var n=0,i=this.features;n<i.length;n+=1){var o=i[n];var s=o.geometry;this.addFeature(o,s,o.index,r,a)}};lf.prototype.update=function e(t,r,a){if(!this.stateDependentLayers.length){return}this.programConfigurations.updatePaintArrays(t,r,this.stateDependentLayers,a)};lf.prototype.isEmpty=function e(){return this.layoutVertexArray.length===0};lf.prototype.uploadPending=function e(){return!this.uploaded||this.programConfigurations.needsUpload};lf.prototype.upload=function e(t){if(!this.uploaded){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Nc);this.indexBuffer=t.createIndexBuffer(this.indexArray)}this.programConfigurations.upload(t);this.uploaded=true};lf.prototype.destroy=function e(){if(!this.layoutVertexBuffer){return}this.layoutVertexBuffer.destroy();this.indexBuffer.destroy();this.programConfigurations.destroy();this.segments.destroy()};lf.prototype.addFeature=function e(t,r,a,n,i){for(var o=0,s=Ec(r,nf);o<s.length;o+=1){var l=s[o];var u=0;for(var c=0,f=l;c<f.length;c+=1){var h=f[c];u+=h.length}var p=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(var v=0,d=l;v<d.length;v+=1){var m=d[v];if(m.length===0){continue}if(cf(m)){continue}var g=0;for(var y=0;y<m.length;y++){var x=m[y];if(y>=1){var b=m[y-1];if(!uf(x,b)){if(p.vertexLength+4>Ns.MAX_VERTEX_ARRAY_LENGTH){p=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)}var _=x.sub(b)._perp()._unit();var w=b.dist(x);if(g+w>32768){g=0}sf(this.layoutVertexArray,x.x,x.y,_.x,_.y,0,0,g);sf(this.layoutVertexArray,x.x,x.y,_.x,_.y,0,1,g);g+=w;sf(this.layoutVertexArray,b.x,b.y,_.x,_.y,0,0,g);sf(this.layoutVertexArray,b.x,b.y,_.x,_.y,0,1,g);var T=p.vertexLength;this.indexArray.emplaceBack(T,T+2,T+1);this.indexArray.emplaceBack(T+1,T+2,T+3);p.vertexLength+=4;p.primitiveLength+=2}}}}if(p.vertexLength+u>Ns.MAX_VERTEX_ARRAY_LENGTH){p=this.segments.prepareSegment(u,this.layoutVertexArray,this.indexArray)}if(af[t.type]!=="Polygon"){continue}var k=[];var M=[];var A=p.vertexLength;for(var S=0,E=l;S<E.length;S+=1){var L=E[S];if(L.length===0){continue}if(L!==l[0]){M.push(k.length/2)}for(var C=0;C<L.length;C++){var I=L[C];sf(this.layoutVertexArray,I.x,I.y,0,0,1,1,0);k.push(I.x);k.push(I.y)}}var P=qu(k,M);for(var O=0;O<P.length;O+=3){this.indexArray.emplaceBack(A+P[O],A+P[O+2],A+P[O+1])}p.primitiveLength+=P.length/3;p.vertexLength+=u}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,a,i,n)};eo("FillExtrusionBucket",lf,{omit:["layers","features"]});function uf(e,t){return e.x===t.x&&(e.x<0||e.x>yl)||e.y===t.y&&(e.y<0||e.y>yl)}function cf(e){return e.every((function(e){return e.x<0}))||e.every((function(e){return e.x>yl}))||e.every((function(e){return e.y<0}))||e.every((function(e){return e.y>yl}))}var ff=new Xo({"fill-extrusion-opacity":new Ho(Wt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new qo(Wt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Ho(Wt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Ho(Wt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Go(Wt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new qo(Wt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new qo(Wt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Ho(Wt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])});var hf={paint:ff};var pf=function(e){function t(t){e.call(this,t,hf)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype.createBucket=function e(t){return new lf(t)};t.prototype.queryRadius=function e(){return Bl(this.paint.get("fill-extrusion-translate"))};t.prototype.is3D=function e(){return true};t.prototype.queryIntersectsFeature=function e(t,r,a,n,i,o,s,l){var u=Nl(t,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),o.angle,s);var c=this.paint.get("fill-extrusion-height").evaluate(r,a);var f=this.paint.get("fill-extrusion-base").evaluate(r,a);var h=yf(u,l,o,0);var p=gf(n,f,c,l);var v=p[0];var d=p[1];return mf(v,d,h)};return t}(Jo);function vf(e,t){return e.x*t.x+e.y*t.y}function df(e,t){if(e.length===1){var r=0;var a=t[r++];var n;while(!n||a.equals(n)){n=t[r++];if(!n){return Infinity}}for(;r<t.length;r++){var i=t[r];var o=e[0];var s=n.sub(a);var l=i.sub(a);var u=o.sub(a);var c=vf(s,s);var f=vf(s,l);var h=vf(l,l);var p=vf(u,s);var v=vf(u,l);var d=c*h-f*f;var m=(h*p-f*v)/d;var g=(c*v-f*p)/d;var y=1-m-g;var x=a.z*y+n.z*m+i.z*g;if(isFinite(x)){return x}}return Infinity}else{var b=Infinity;for(var _=0,w=t;_<w.length;_+=1){var T=w[_];b=Math.min(b,T.z)}return b}}function mf(e,t,r){var a=Infinity;if(Al(r,t)){a=df(r,t[0])}for(var n=0;n<t.length;n++){var i=t[n];var o=e[n];for(var s=0;s<i.length-1;s++){var l=i[s];var u=i[s+1];var c=o[s];var f=o[s+1];var h=[l,u,f,c,l];if(kl(r,h)){a=Math.min(a,df(r,h))}}}return a===Infinity?false:a}function gf(e,t,r,a){var n=[];var o=[];var s=a[8]*t;var l=a[9]*t;var u=a[10]*t;var c=a[11]*t;var f=a[8]*r;var h=a[9]*r;var p=a[10]*r;var v=a[11]*r;for(var d=0,m=e;d<m.length;d+=1){var g=m[d];var y=[];var x=[];for(var b=0,_=g;b<_.length;b+=1){var w=_[b];var T=w.x;var k=w.y;var M=a[0]*T+a[4]*k+a[12];var A=a[1]*T+a[5]*k+a[13];var S=a[2]*T+a[6]*k+a[14];var E=a[3]*T+a[7]*k+a[15];var L=M+s;var C=A+l;var I=S+u;var P=E+c;var O=M+f;var z=A+h;var D=S+p;var R=E+v;var F=new i(L/P,C/P);F.z=I/P;y.push(F);var B=new i(O/R,z/R);B.z=D/R;x.push(B)}n.push(y);o.push(x)}return[n,o]}function yf(e,t,r,a){var n=[];for(var o=0,s=e;o<s.length;o+=1){var l=s[o];var u=[l.x,l.y,a,1];bu(u,u,t);n.push(new i(u[0]/u[3],u[1]/u[3]))}return n}var xf=rs([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4);var bf=xf.members;var _f=rf.VectorTileFeature.types;var wf=63;var Tf=Math.cos(75/2*(Math.PI/180));var kf=15;var Mf=20;var Af=15;var Sf=1/2;var Ef=Math.pow(2,Af-1)/Sf;var Lf=function e(t){this.zoom=t.zoom;this.overscaling=t.overscaling;this.layers=t.layers;this.layerIds=this.layers.map((function(e){return e.id}));this.index=t.index;this.hasPattern=false;this.patternFeatures=[];this.layoutVertexArray=new ls;this.indexArray=new gs;this.programConfigurations=new vl(bf,t.layers,t.zoom);this.segments=new Ns;this.stateDependentLayerIds=this.layers.filter((function(e){return e.isStateDependent()})).map((function(e){return e.id}))};Lf.prototype.populate=function e(t,r,a){this.hasPattern=Cc("line",this.layers,r);var n=this.layers[0].layout.get("line-sort-key");var i=[];for(var o=0,s=t;o<s.length;o+=1){var l=s[o];var u=l.feature;var c=l.id;var f=l.index;var h=l.sourceLayerIndex;var p=this.layers[0]._featureFilter.needGeometry;var v={type:u.type,id:c,properties:u.properties,geometry:p?_l(u):[]};if(!this.layers[0]._featureFilter.filter(new zo(this.zoom),v,a)){continue}if(!p){v.geometry=_l(u)}var d=n?n.evaluate(v,{},a):undefined;var m={id:c,properties:u.properties,type:u.type,sourceLayerIndex:h,index:f,geometry:v.geometry,patterns:{},sortKey:d};i.push(m)}if(n){i.sort((function(e,t){return e.sortKey-t.sortKey}))}for(var g=0,y=i;g<y.length;g+=1){var x=y[g];var b=x;var _=b.geometry;var w=b.index;var T=b.sourceLayerIndex;if(this.hasPattern){var k=Ic("line",this.layers,x,this.zoom,r);this.patternFeatures.push(k)}else{this.addFeature(x,_,w,a,{})}var M=t[w].feature;r.featureIndex.insert(M,_,w,T,this.index)}};Lf.prototype.update=function e(t,r,a){if(!this.stateDependentLayers.length){return}this.programConfigurations.updatePaintArrays(t,r,this.stateDependentLayers,a)};Lf.prototype.addFeatures=function e(t,r,a){for(var n=0,i=this.patternFeatures;n<i.length;n+=1){var o=i[n];this.addFeature(o,o.geometry,o.index,r,a)}};Lf.prototype.isEmpty=function e(){return this.layoutVertexArray.length===0};Lf.prototype.uploadPending=function e(){return!this.uploaded||this.programConfigurations.needsUpload};Lf.prototype.upload=function e(t){if(!this.uploaded){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,bf);this.indexBuffer=t.createIndexBuffer(this.indexArray)}this.programConfigurations.upload(t);this.uploaded=true};Lf.prototype.destroy=function e(){if(!this.layoutVertexBuffer){return}this.layoutVertexBuffer.destroy();this.indexBuffer.destroy();this.programConfigurations.destroy();this.segments.destroy()};Lf.prototype.addFeature=function e(t,r,a,n,i){var o=this.layers[0].layout;var s=o.get("line-join").evaluate(t,{});var l=o.get("line-cap");var u=o.get("line-miter-limit");var c=o.get("line-round-limit");for(var f=0,h=r;f<h.length;f+=1){var p=h[f];this.addLine(p,t,s,l,u,c)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,a,i,n)};Lf.prototype.addLine=function e(t,r,a,n,i,o){this.distance=0;this.scaledDistance=0;this.totalDistance=0;if(!!r.properties&&r.properties.hasOwnProperty("mapbox_clip_start")&&r.properties.hasOwnProperty("mapbox_clip_end")){this.clipStart=+r.properties["mapbox_clip_start"];this.clipEnd=+r.properties["mapbox_clip_end"];for(var s=0;s<t.length-1;s++){this.totalDistance+=t[s].dist(t[s+1])}this.updateScaledDistance()}var l=_f[r.type]==="Polygon";var u=t.length;while(u>=2&&t[u-1].equals(t[u-2])){u--}var c=0;while(c<u-1&&t[c].equals(t[c+1])){c++}if(u<(l?3:2)){return}if(a==="bevel"){i=1.05}var f=this.overscaling<=16?kf*yl/(512*this.overscaling):0;var h=this.segments.prepareSegment(u*10,this.layoutVertexArray,this.indexArray);var p;var v=undefined;var d=undefined;var m=undefined;var g=undefined;this.e1=this.e2=-1;if(l){p=t[u-2];g=t[c].sub(p)._unit()._perp()}for(var y=c;y<u;y++){d=y===u-1?l?t[c+1]:undefined:t[y+1];if(d&&t[y].equals(d)){continue}if(g){m=g}if(p){v=p}p=t[y];g=d?d.sub(p)._unit()._perp():m;m=m||g;var x=m.add(g);if(x.x!==0||x.y!==0){x._unit()}var b=m.x*g.x+m.y*g.y;var _=x.x*g.x+x.y*g.y;var w=_!==0?1/_:Infinity;var T=2*Math.sqrt(2-2*_);var k=_<Tf&&v&&d;var M=m.x*g.y-m.y*g.x>0;if(k&&y>c){var A=p.dist(v);if(A>2*f){var S=p.sub(p.sub(v)._mult(f/A)._round());this.updateDistance(v,S);this.addCurrentVertex(S,m,0,0,h);v=S}}var E=v&&d;var L=E?a:l?"butt":n;if(E&&L==="round"){if(w<o){L="miter"}else if(w<=2){L="fakeround"}}if(L==="miter"&&w>i){L="bevel"}if(L==="bevel"){if(w>2){L="flipbevel"}if(w<i){L="miter"}}if(v){this.updateDistance(v,p)}if(L==="miter"){x._mult(w);this.addCurrentVertex(p,x,0,0,h)}else if(L==="flipbevel"){if(w>100){x=g.mult(-1)}else{var C=w*m.add(g).mag()/m.sub(g).mag();x._perp()._mult(C*(M?-1:1))}this.addCurrentVertex(p,x,0,0,h);this.addCurrentVertex(p,x.mult(-1),0,0,h)}else if(L==="bevel"||L==="fakeround"){var I=-Math.sqrt(w*w-1);var P=M?I:0;var O=M?0:I;if(v){this.addCurrentVertex(p,m,P,O,h)}if(L==="fakeround"){var z=Math.round(T*180/Math.PI/Mf);for(var D=1;D<z;D++){var R=D/z;if(R!==.5){var F=R-.5;var B=1.0904+b*(-3.2452+b*(3.55645-b*1.43519));var N=.848013+b*(-1.06021+b*.215638);R=R+R*F*(R-1)*(B*F*F+N)}var j=g.sub(m)._mult(R)._add(m)._unit()._mult(M?-1:1);this.addHalfVertex(p,j.x,j.y,false,M,0,h)}}if(d){this.addCurrentVertex(p,g,-P,-O,h)}}else if(L==="butt"){this.addCurrentVertex(p,x,0,0,h)}else if(L==="square"){var U=v?1:-1;this.addCurrentVertex(p,x,U,U,h)}else if(L==="round"){if(v){this.addCurrentVertex(p,m,0,0,h);this.addCurrentVertex(p,m,1,1,h,true)}if(d){this.addCurrentVertex(p,g,-1,-1,h,true);this.addCurrentVertex(p,g,0,0,h)}}if(k&&y<u-1){var V=p.dist(d);if(V>2*f){var H=p.add(d.sub(p)._mult(f/V)._round());this.updateDistance(p,H);this.addCurrentVertex(H,g,0,0,h);p=H}}}};Lf.prototype.addCurrentVertex=function e(t,r,a,n,i,o){if(o===void 0)o=false;var s=r.x+r.y*a;var l=r.y-r.x*a;var u=-r.x+r.y*n;var c=-r.y-r.x*n;this.addHalfVertex(t,s,l,o,false,a,i);this.addHalfVertex(t,u,c,o,true,-n,i);if(this.distance>Ef/2&&this.totalDistance===0){this.distance=0;this.addCurrentVertex(t,r,a,n,i,o)}};Lf.prototype.addHalfVertex=function e(t,r,a,n,i,o,s){var l=t.x;var u=t.y;var c=this.scaledDistance*Sf;this.layoutVertexArray.emplaceBack((l<<1)+(n?1:0),(u<<1)+(i?1:0),Math.round(wf*r)+128,Math.round(wf*a)+128,(o===0?0:o<0?-1:1)+1|(c&63)<<2,c>>6);var f=s.vertexLength++;if(this.e1>=0&&this.e2>=0){this.indexArray.emplaceBack(this.e1,this.e2,f);s.primitiveLength++}if(i){this.e2=f}else{this.e1=f}};Lf.prototype.updateScaledDistance=function e(){this.scaledDistance=this.totalDistance>0?(this.clipStart+(this.clipEnd-this.clipStart)*this.distance/this.totalDistance)*(Ef-1):this.distance};Lf.prototype.updateDistance=function e(t,r){this.distance+=t.dist(r);this.updateScaledDistance()};eo("LineBucket",Lf,{omit:["layers","patternFeatures"]});var Cf=new Xo({"line-cap":new Ho(Wt["layout_line"]["line-cap"]),"line-join":new qo(Wt["layout_line"]["line-join"]),"line-miter-limit":new Ho(Wt["layout_line"]["line-miter-limit"]),"line-round-limit":new Ho(Wt["layout_line"]["line-round-limit"]),"line-sort-key":new qo(Wt["layout_line"]["line-sort-key"])});var If=new Xo({"line-opacity":new qo(Wt["paint_line"]["line-opacity"]),"line-color":new qo(Wt["paint_line"]["line-color"]),"line-translate":new Ho(Wt["paint_line"]["line-translate"]),"line-translate-anchor":new Ho(Wt["paint_line"]["line-translate-anchor"]),"line-width":new qo(Wt["paint_line"]["line-width"]),"line-gap-width":new qo(Wt["paint_line"]["line-gap-width"]),"line-offset":new qo(Wt["paint_line"]["line-offset"]),"line-blur":new qo(Wt["paint_line"]["line-blur"]),"line-dasharray":new Yo(Wt["paint_line"]["line-dasharray"]),"line-pattern":new Go(Wt["paint_line"]["line-pattern"]),"line-gradient":new Wo(Wt["paint_line"]["line-gradient"])});var Pf={paint:If,layout:Cf};var Of=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype.possiblyEvaluate=function t(r,a){a=new zo(Math.floor(a.zoom),{now:a.now,fadeDuration:a.fadeDuration,zoomHistory:a.zoomHistory,transition:a.transition});return e.prototype.possiblyEvaluate.call(this,r,a)};t.prototype.evaluate=function t(r,a,n,i){a=m({},a,{zoom:Math.floor(a.zoom)});return e.prototype.evaluate.call(this,r,a,n,i)};return t}(qo);var zf=new Of(Pf.paint.properties["line-width"].specification);zf.useIntegerZoom=true;var Df=function(e){function t(t){e.call(this,t,Pf)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype._handleSpecialPaintPropertyUpdate=function e(t){if(t==="line-gradient"){this._updateGradient()}};t.prototype._updateGradient=function e(){var t=this._transitionablePaint._values["line-gradient"].value.expression;this.gradient=Fu(t,"lineProgress");this.gradientTexture=null};t.prototype.recalculate=function t(r,a){e.prototype.recalculate.call(this,r,a);this.paint._values["line-floorwidth"]=zf.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,r)};t.prototype.createBucket=function e(t){return new Lf(t)};t.prototype.queryRadius=function e(t){var r=t;var a=Rf(Fl("line-width",this,r),Fl("line-gap-width",this,r));var n=Fl("line-offset",this,r);return a/2+Math.abs(n)+Bl(this.paint.get("line-translate"))};t.prototype.queryIntersectsFeature=function e(t,r,a,n,i,o,s){var l=Nl(t,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),o.angle,s);var u=s/2*Rf(this.paint.get("line-width").evaluate(r,a),this.paint.get("line-gap-width").evaluate(r,a));var c=this.paint.get("line-offset").evaluate(r,a);if(c){n=Ff(n,c*s)}return Sl(l,n,u)};t.prototype.isTileClipped=function e(){return true};return t}(Jo);function Rf(e,t){if(t>0){return t+2*e}else{return e}}function Ff(e,t){var r=[];var a=new i(0,0);for(var n=0;n<e.length;n++){var o=e[n];var s=[];for(var l=0;l<o.length;l++){var u=o[l-1];var c=o[l];var f=o[l+1];var h=l===0?a:c.sub(u)._unit()._perp();var p=l===o.length-1?a:f.sub(c)._unit()._perp();var v=h._add(p)._unit();var d=v.x*p.x+v.y*p.y;v._mult(1/d);s.push(v._mult(t)._add(c))}r.push(s)}return r}var Bf=rs([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4);var Nf=rs([{name:"a_projected_pos",components:3,type:"Float32"}],4);var jf=rs([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);var Uf=rs([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);var Vf=rs([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);var Hf=rs([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4);var qf=rs([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);var Gf=rs([{name:"triangle",components:3,type:"Uint16"}]);var Yf=rs([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]);var Wf=rs([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]);var Xf=rs([{type:"Float32",name:"offsetX"}]);var Zf=rs([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);function Jf(e,t,r){var a=t.layout.get("text-transform").evaluate(r,{});if(a==="uppercase"){e=e.toLocaleUpperCase()}else if(a==="lowercase"){e=e.toLocaleLowerCase()}if(Po.applyArabicShaping){e=Po.applyArabicShaping(e)}return e}function Kf(e,t,r){e.sections.forEach((function(e){e.text=Jf(e.text,t,r)}));return e}function Qf(e){var t={};var r={};var a=[];var n=0;function i(t){a.push(e[t]);n++}function o(e,t,n){var i=r[e];delete r[e];r[t]=i;a[i].geometry[0].pop();a[i].geometry[0]=a[i].geometry[0].concat(n[0]);return i}function s(e,r,n){var i=t[r];delete t[r];t[e]=i;a[i].geometry[0].shift();a[i].geometry[0]=n[0].concat(a[i].geometry[0]);return i}function l(e,t,r){var a=r?t[0][t[0].length-1]:t[0][0];return e+":"+a.x+":"+a.y}for(var u=0;u<e.length;u++){var c=e[u];var f=c.geometry;var h=c.text?c.text.toString():null;if(!h){i(u);continue}var p=l(h,f),v=l(h,f,true);if(p in r&&v in t&&r[p]!==t[v]){var d=s(p,v,f);var m=o(p,v,a[d].geometry);delete t[p];delete r[v];r[l(h,a[m].geometry,true)]=m;a[d].geometry=null}else if(p in r){o(p,v,f)}else if(v in t){s(p,v,f)}else{i(u);t[p]=n-1;r[v]=n-1}}return a.filter((function(e){return e.geometry}))}var $f={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"};function eh(e){var t="";for(var r=0;r<e.length;r++){var a=e.charCodeAt(r+1)||null;var n=e.charCodeAt(r-1)||null;var i=(!a||!vo(a)||$f[e[r+1]])&&(!n||!vo(n)||$f[e[r-1]]);if(i&&$f[e[r]]){t+=$f[e[r]]}else{t+=e[r]}}return t}var th=24;var rh=function(e,t,r,a,n){var i,o;var s=n*8-a-1;var l=(1<<s)-1;var u=l>>1;var c=-7;var f=r?n-1:0;var h=r?-1:1;var p=e[t+f];f+=h;i=p&(1<<-c)-1;p>>=-c;c+=s;for(;c>0;i=i*256+e[t+f],f+=h,c-=8){}o=i&(1<<-c)-1;i>>=-c;c+=a;for(;c>0;o=o*256+e[t+f],f+=h,c-=8){}if(i===0){i=1-u}else if(i===l){return o?NaN:(p?-1:1)*Infinity}else{o=o+Math.pow(2,a);i=i-u}return(p?-1:1)*o*Math.pow(2,i-a)};var ah=function(e,t,r,a,n,i){var o,s,l;var u=i*8-n-1;var c=(1<<u)-1;var f=c>>1;var h=n===23?Math.pow(2,-24)-Math.pow(2,-77):0;var p=a?0:i-1;var v=a?1:-1;var d=t<0||t===0&&1/t<0?1:0;t=Math.abs(t);if(isNaN(t)||t===Infinity){s=isNaN(t)?1:0;o=c}else{o=Math.floor(Math.log(t)/Math.LN2);if(t*(l=Math.pow(2,-o))<1){o--;l*=2}if(o+f>=1){t+=h/l}else{t+=h*Math.pow(2,1-f)}if(t*l>=2){o++;l/=2}if(o+f>=c){s=0;o=c}else if(o+f>=1){s=(t*l-1)*Math.pow(2,n);o=o+f}else{s=t*Math.pow(2,f-1)*Math.pow(2,n);o=0}}for(;n>=8;e[r+p]=s&255,p+=v,s/=256,n-=8){}o=o<<n|s;u+=n;for(;u>0;e[r+p]=o&255,p+=v,o/=256,u-=8){}e[r+p-v]|=d*128};var nh={read:rh,write:ah};var ih=oh;function oh(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0);this.pos=0;this.type=0;this.length=this.buf.length}oh.Varint=0;oh.Fixed64=1;oh.Bytes=2;oh.Fixed32=5;var sh=(1<<16)*(1<<16),lh=1/sh;var uh=12;var ch=typeof TextDecoder==="undefined"?null:new TextDecoder("utf8");oh.prototype={destroy:function(){this.buf=null},readFields:function(e,t,r){r=r||this.length;while(this.pos<r){var a=this.readVarint(),n=a>>3,i=this.pos;this.type=a&7;e(n,t,this);if(this.pos===i){this.skip(a)}}return t},readMessage:function(e,t){return this.readFields(e,t,this.readVarint()+this.pos)},readFixed32:function(){var e=Sh(this.buf,this.pos);this.pos+=4;return e},readSFixed32:function(){var e=Lh(this.buf,this.pos);this.pos+=4;return e},readFixed64:function(){var e=Sh(this.buf,this.pos)+Sh(this.buf,this.pos+4)*sh;this.pos+=8;return e},readSFixed64:function(){var e=Sh(this.buf,this.pos)+Lh(this.buf,this.pos+4)*sh;this.pos+=8;return e},readFloat:function(){var e=nh.read(this.buf,this.pos,true,23,4);this.pos+=4;return e},readDouble:function(){var e=nh.read(this.buf,this.pos,true,52,8);this.pos+=8;return e},readVarint:function(e){var t=this.buf,r,a;a=t[this.pos++];r=a&127;if(a<128){return r}a=t[this.pos++];r|=(a&127)<<7;if(a<128){return r}a=t[this.pos++];r|=(a&127)<<14;if(a<128){return r}a=t[this.pos++];r|=(a&127)<<21;if(a<128){return r}a=t[this.pos];r|=(a&15)<<28;return fh(r,e,this)},readVarint64:function(){return this.readVarint(true)},readSVarint:function(){var e=this.readVarint();return e%2===1?(e+1)/-2:e/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var e=this.readVarint()+this.pos;var t=this.pos;this.pos=e;if(e-t>=uh&&ch){return Ih(this.buf,t,e)}return Ch(this.buf,t,e)},readBytes:function(){var e=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,e);this.pos=e;return t},readPackedVarint:function(e,t){if(this.type!==oh.Bytes){return e.push(this.readVarint(t))}var r=hh(this);e=e||[];while(this.pos<r){e.push(this.readVarint(t))}return e},readPackedSVarint:function(e){if(this.type!==oh.Bytes){return e.push(this.readSVarint())}var t=hh(this);e=e||[];while(this.pos<t){e.push(this.readSVarint())}return e},readPackedBoolean:function(e){if(this.type!==oh.Bytes){return e.push(this.readBoolean())}var t=hh(this);e=e||[];while(this.pos<t){e.push(this.readBoolean())}return e},readPackedFloat:function(e){if(this.type!==oh.Bytes){return e.push(this.readFloat())}var t=hh(this);e=e||[];while(this.pos<t){e.push(this.readFloat())}return e},readPackedDouble:function(e){if(this.type!==oh.Bytes){return e.push(this.readDouble())}var t=hh(this);e=e||[];while(this.pos<t){e.push(this.readDouble())}return e},readPackedFixed32:function(e){if(this.type!==oh.Bytes){return e.push(this.readFixed32())}var t=hh(this);e=e||[];while(this.pos<t){e.push(this.readFixed32())}return e},readPackedSFixed32:function(e){if(this.type!==oh.Bytes){return e.push(this.readSFixed32())}var t=hh(this);e=e||[];while(this.pos<t){e.push(this.readSFixed32())}return e},readPackedFixed64:function(e){if(this.type!==oh.Bytes){return e.push(this.readFixed64())}var t=hh(this);e=e||[];while(this.pos<t){e.push(this.readFixed64())}return e},readPackedSFixed64:function(e){if(this.type!==oh.Bytes){return e.push(this.readSFixed64())}var t=hh(this);e=e||[];while(this.pos<t){e.push(this.readSFixed64())}return e},skip:function(e){var t=e&7;if(t===oh.Varint){while(this.buf[this.pos++]>127){}}else if(t===oh.Bytes){this.pos=this.readVarint()+this.pos}else if(t===oh.Fixed32){this.pos+=4}else if(t===oh.Fixed64){this.pos+=8}else{throw new Error("Unimplemented type: "+t)}},writeTag:function(e,t){this.writeVarint(e<<3|t)},realloc:function(e){var t=this.length||16;while(t<this.pos+e){t*=2}if(t!==this.length){var r=new Uint8Array(t);r.set(this.buf);this.buf=r;this.length=t}},finish:function(){this.length=this.pos;this.pos=0;return this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4);Eh(this.buf,e,this.pos);this.pos+=4},writeSFixed32:function(e){this.realloc(4);Eh(this.buf,e,this.pos);this.pos+=4},writeFixed64:function(e){this.realloc(8);Eh(this.buf,e&-1,this.pos);Eh(this.buf,Math.floor(e*lh),this.pos+4);this.pos+=8},writeSFixed64:function(e){this.realloc(8);Eh(this.buf,e&-1,this.pos);Eh(this.buf,Math.floor(e*lh),this.pos+4);this.pos+=8},writeVarint:function(e){e=+e||0;if(e>268435455||e<0){vh(e,this);return}this.realloc(4);this.buf[this.pos++]=e&127|(e>127?128:0);if(e<=127){return}this.buf[this.pos++]=(e>>>=7)&127|(e>127?128:0);if(e<=127){return}this.buf[this.pos++]=(e>>>=7)&127|(e>127?128:0);if(e<=127){return}this.buf[this.pos++]=e>>>7&127},writeSVarint:function(e){this.writeVarint(e<0?-e*2-1:e*2)},writeBoolean:function(e){this.writeVarint(Boolean(e))},writeString:function(e){e=String(e);this.realloc(e.length*4);this.pos++;var t=this.pos;this.pos=Ph(this.buf,e,this.pos);var r=this.pos-t;if(r>=128){gh(t,r,this)}this.pos=t-1;this.writeVarint(r);this.pos+=r},writeFloat:function(e){this.realloc(4);nh.write(this.buf,e,this.pos,true,23,4);this.pos+=4},writeDouble:function(e){this.realloc(8);nh.write(this.buf,e,this.pos,true,52,8);this.pos+=8},writeBytes:function(e){var t=e.length;this.writeVarint(t);this.realloc(t);for(var r=0;r<t;r++){this.buf[this.pos++]=e[r]}},writeRawMessage:function(e,t){this.pos++;var r=this.pos;e(t,this);var a=this.pos-r;if(a>=128){gh(r,a,this)}this.pos=r-1;this.writeVarint(a);this.pos+=a},writeMessage:function(e,t,r){this.writeTag(e,oh.Bytes);this.writeRawMessage(t,r)},writePackedVarint:function(e,t){if(t.length){this.writeMessage(e,yh,t)}},writePackedSVarint:function(e,t){if(t.length){this.writeMessage(e,xh,t)}},writePackedBoolean:function(e,t){if(t.length){this.writeMessage(e,wh,t)}},writePackedFloat:function(e,t){if(t.length){this.writeMessage(e,bh,t)}},writePackedDouble:function(e,t){if(t.length){this.writeMessage(e,_h,t)}},writePackedFixed32:function(e,t){if(t.length){this.writeMessage(e,Th,t)}},writePackedSFixed32:function(e,t){if(t.length){this.writeMessage(e,kh,t)}},writePackedFixed64:function(e,t){if(t.length){this.writeMessage(e,Mh,t)}},writePackedSFixed64:function(e,t){if(t.length){this.writeMessage(e,Ah,t)}},writeBytesField:function(e,t){this.writeTag(e,oh.Bytes);this.writeBytes(t)},writeFixed32Field:function(e,t){this.writeTag(e,oh.Fixed32);this.writeFixed32(t)},writeSFixed32Field:function(e,t){this.writeTag(e,oh.Fixed32);this.writeSFixed32(t)},writeFixed64Field:function(e,t){this.writeTag(e,oh.Fixed64);this.writeFixed64(t)},writeSFixed64Field:function(e,t){this.writeTag(e,oh.Fixed64);this.writeSFixed64(t)},writeVarintField:function(e,t){this.writeTag(e,oh.Varint);this.writeVarint(t)},writeSVarintField:function(e,t){this.writeTag(e,oh.Varint);this.writeSVarint(t)},writeStringField:function(e,t){this.writeTag(e,oh.Bytes);this.writeString(t)},writeFloatField:function(e,t){this.writeTag(e,oh.Fixed32);this.writeFloat(t)},writeDoubleField:function(e,t){this.writeTag(e,oh.Fixed64);this.writeDouble(t)},writeBooleanField:function(e,t){this.writeVarintField(e,Boolean(t))}};function fh(e,t,r){var a=r.buf,n,i;i=a[r.pos++];n=(i&112)>>4;if(i<128){return ph(e,n,t)}i=a[r.pos++];n|=(i&127)<<3;if(i<128){return ph(e,n,t)}i=a[r.pos++];n|=(i&127)<<10;if(i<128){return ph(e,n,t)}i=a[r.pos++];n|=(i&127)<<17;if(i<128){return ph(e,n,t)}i=a[r.pos++];n|=(i&127)<<24;if(i<128){return ph(e,n,t)}i=a[r.pos++];n|=(i&1)<<31;if(i<128){return ph(e,n,t)}throw new Error("Expected varint not more than 10 bytes")}function hh(e){return e.type===oh.Bytes?e.readVarint()+e.pos:e.pos+1}function ph(e,t,r){if(r){return t*4294967296+(e>>>0)}return(t>>>0)*4294967296+(e>>>0)}function vh(e,t){var r,a;if(e>=0){r=e%4294967296|0;a=e/4294967296|0}else{r=~(-e%4294967296);a=~(-e/4294967296);if(r^4294967295){r=r+1|0}else{r=0;a=a+1|0}}if(e>=0x10000000000000000||e<-0x10000000000000000){throw new Error("Given varint doesn't fit into 10 bytes")}t.realloc(10);dh(r,a,t);mh(a,t)}function dh(e,t,r){r.buf[r.pos++]=e&127|128;e>>>=7;r.buf[r.pos++]=e&127|128;e>>>=7;r.buf[r.pos++]=e&127|128;e>>>=7;r.buf[r.pos++]=e&127|128;e>>>=7;r.buf[r.pos]=e&127}function mh(e,t){var r=(e&7)<<4;t.buf[t.pos++]|=r|((e>>>=3)?128:0);if(!e){return}t.buf[t.pos++]=e&127|((e>>>=7)?128:0);if(!e){return}t.buf[t.pos++]=e&127|((e>>>=7)?128:0);if(!e){return}t.buf[t.pos++]=e&127|((e>>>=7)?128:0);if(!e){return}t.buf[t.pos++]=e&127|((e>>>=7)?128:0);if(!e){return}t.buf[t.pos++]=e&127}function gh(e,t,r){var a=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(Math.LN2*7));r.realloc(a);for(var n=r.pos-1;n>=e;n--){r.buf[n+a]=r.buf[n]}}function yh(e,t){for(var r=0;r<e.length;r++){t.writeVarint(e[r])}}function xh(e,t){for(var r=0;r<e.length;r++){t.writeSVarint(e[r])}}function bh(e,t){for(var r=0;r<e.length;r++){t.writeFloat(e[r])}}function _h(e,t){for(var r=0;r<e.length;r++){t.writeDouble(e[r])}}function wh(e,t){for(var r=0;r<e.length;r++){t.writeBoolean(e[r])}}function Th(e,t){for(var r=0;r<e.length;r++){t.writeFixed32(e[r])}}function kh(e,t){for(var r=0;r<e.length;r++){t.writeSFixed32(e[r])}}function Mh(e,t){for(var r=0;r<e.length;r++){t.writeFixed64(e[r])}}function Ah(e,t){for(var r=0;r<e.length;r++){t.writeSFixed64(e[r])}}function Sh(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+e[t+3]*16777216}function Eh(e,t,r){e[r]=t;e[r+1]=t>>>8;e[r+2]=t>>>16;e[r+3]=t>>>24}function Lh(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+(e[t+3]<<24)}function Ch(e,t,r){var a="";var n=t;while(n<r){var i=e[n];var o=null;var s=i>239?4:i>223?3:i>191?2:1;if(n+s>r){break}var l,u,c;if(s===1){if(i<128){o=i}}else if(s===2){l=e[n+1];if((l&192)===128){o=(i&31)<<6|l&63;if(o<=127){o=null}}}else if(s===3){l=e[n+1];u=e[n+2];if((l&192)===128&&(u&192)===128){o=(i&15)<<12|(l&63)<<6|u&63;if(o<=2047||o>=55296&&o<=57343){o=null}}}else if(s===4){l=e[n+1];u=e[n+2];c=e[n+3];if((l&192)===128&&(u&192)===128&&(c&192)===128){o=(i&15)<<18|(l&63)<<12|(u&63)<<6|c&63;if(o<=65535||o>=1114112){o=null}}}if(o===null){o=65533;s=1}else if(o>65535){o-=65536;a+=String.fromCharCode(o>>>10&1023|55296);o=56320|o&1023}a+=String.fromCharCode(o);n+=s}return a}function Ih(e,t,r){return ch.decode(e.subarray(t,r))}function Ph(e,t,r){for(var a=0,n,i;a<t.length;a++){n=t.charCodeAt(a);if(n>55295&&n<57344){if(i){if(n<56320){e[r++]=239;e[r++]=191;e[r++]=189;i=n;continue}else{n=i-55296<<10|n-56320|65536;i=null}}else{if(n>56319||a+1===t.length){e[r++]=239;e[r++]=191;e[r++]=189}else{i=n}continue}}else if(i){e[r++]=239;e[r++]=191;e[r++]=189;i=null}if(n<128){e[r++]=n}else{if(n<2048){e[r++]=n>>6|192}else{if(n<65536){e[r++]=n>>12|224}else{e[r++]=n>>18|240;e[r++]=n>>12&63|128}e[r++]=n>>6&63|128}e[r++]=n&63|128}}return r}var Oh=3;function zh(e,t,r){if(e===1){r.readMessage(Dh,t)}}function Dh(e,t,r){if(e===3){var a=r.readMessage(Rh,{});var n=a.id;var i=a.bitmap;var o=a.width;var s=a.height;var l=a.left;var u=a.top;var c=a.advance;t.push({id:n,bitmap:new Ou({width:o+2*Oh,height:s+2*Oh},i),metrics:{width:o,height:s,left:l,top:u,advance:c}})}}function Rh(e,t,r){if(e===1){t.id=r.readVarint()}else if(e===2){t.bitmap=r.readBytes()}else if(e===3){t.width=r.readVarint()}else if(e===4){t.height=r.readVarint()}else if(e===5){t.left=r.readSVarint()}else if(e===6){t.top=r.readSVarint()}else if(e===7){t.advance=r.readVarint()}}function Fh(e){return new ih(e).readFields(zh,[])}var Bh=Oh;function Nh(e){var t=0;var r=0;for(var a=0,n=e;a<n.length;a+=1){var i=n[a];t+=i.w*i.h;r=Math.max(r,i.w)}e.sort((function(e,t){return t.h-e.h}));var o=Math.max(Math.ceil(Math.sqrt(t/.95)),r);var s=[{x:0,y:0,w:o,h:Infinity}];var l=0;var u=0;for(var c=0,f=e;c<f.length;c+=1){var h=f[c];for(var p=s.length-1;p>=0;p--){var v=s[p];if(h.w>v.w||h.h>v.h){continue}h.x=v.x;h.y=v.y;u=Math.max(u,h.y+h.h);l=Math.max(l,h.x+h.w);if(h.w===v.w&&h.h===v.h){var d=s.pop();if(p<s.length){s[p]=d}}else if(h.h===v.h){v.x+=h.w;v.w-=h.w}else if(h.w===v.w){v.y+=h.h;v.h-=h.h}else{s.push({x:v.x+h.w,y:v.y,w:v.w-h.w,h:h.h});v.y+=h.h;v.h-=h.h}break}}return{w:l,h:u,fill:t/(l*u)||0}}var jh=1;var Uh=function e(t,r){var a=r.pixelRatio;var n=r.version;var i=r.stretchX;var o=r.stretchY;var s=r.content;this.paddedRect=t;this.pixelRatio=a;this.stretchX=i;this.stretchY=o;this.content=s;this.version=n};var Vh={tl:{configurable:true},br:{configurable:true},tlbr:{configurable:true},displaySize:{configurable:true}};Vh.tl.get=function(){return[this.paddedRect.x+jh,this.paddedRect.y+jh]};Vh.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-jh,this.paddedRect.y+this.paddedRect.h-jh]};Vh.tlbr.get=function(){return this.tl.concat(this.br)};Vh.displaySize.get=function(){return[(this.paddedRect.w-jh*2)/this.pixelRatio,(this.paddedRect.h-jh*2)/this.pixelRatio]};Object.defineProperties(Uh.prototype,Vh);var Hh=function e(t,r){var a={},n={};this.haveRenderCallbacks=[];var i=[];this.addImages(t,a,i);this.addImages(r,n,i);var o=Nh(i);var s=o.w;var l=o.h;var u=new zu({width:s||1,height:l||1});for(var c in t){var f=t[c];var h=a[c].paddedRect;zu.copy(f.data,u,{x:0,y:0},{x:h.x+jh,y:h.y+jh},f.data)}for(var p in r){var v=r[p];var d=n[p].paddedRect;var m=d.x+jh,g=d.y+jh,y=v.data.width,x=v.data.height;zu.copy(v.data,u,{x:0,y:0},{x:m,y:g},v.data);zu.copy(v.data,u,{x:0,y:x-1},{x:m,y:g-1},{width:y,height:1});zu.copy(v.data,u,{x:0,y:0},{x:m,y:g+x},{width:y,height:1});zu.copy(v.data,u,{x:y-1,y:0},{x:m-1,y:g},{width:1,height:x});zu.copy(v.data,u,{x:0,y:0},{x:m+y,y:g},{width:1,height:x})}this.image=u;this.iconPositions=a;this.patternPositions=n};Hh.prototype.addImages=function e(t,r,a){for(var n in t){var i=t[n];var o={x:0,y:0,w:i.data.width+2*jh,h:i.data.height+2*jh};a.push(o);r[n]=new Uh(o,i);if(i.hasRenderCallback){this.haveRenderCallbacks.push(n)}}};Hh.prototype.patchUpdatedImages=function e(t,r){t.dispatchRenderCallbacks(this.haveRenderCallbacks);for(var a in t.updatedImages){this.patchUpdatedImage(this.iconPositions[a],t.getImage(a),r);this.patchUpdatedImage(this.patternPositions[a],t.getImage(a),r)}};Hh.prototype.patchUpdatedImage=function e(t,r,a){if(!t||!r){return}if(t.version===r.version){return}t.version=r.version;var n=t.tl;var i=n[0];var o=n[1];a.update(r.data,undefined,{x:i,y:o})};eo("ImagePosition",Uh);eo("ImageAtlas",Hh);var qh={horizontal:1,vertical:2,horizontalOnly:3};var Gh=-17;function Yh(e){for(var t=0,r=e;t<r.length;t+=1){var a=r[t];if(a.positionedGlyphs.length!==0){return false}}return true}var Wh=57344;var Xh=63743;var Zh=function e(){this.scale=1;this.fontStack="";this.imageName=null};Zh.forText=function e(t,r){var a=new Zh;a.scale=t||1;a.fontStack=r;return a};Zh.forImage=function e(t){var r=new Zh;r.imageName=t;return r};var Jh=function e(){this.text="";this.sectionIndex=[];this.sections=[];this.imageSectionID=null};Jh.fromFeature=function e(t,r){var a=new Jh;for(var n=0;n<t.sections.length;n++){var i=t.sections[n];if(!i.image){a.addTextSection(i,r)}else{a.addImageSection(i)}}return a};Jh.prototype.length=function e(){return this.text.length};Jh.prototype.getSection=function e(t){return this.sections[this.sectionIndex[t]]};Jh.prototype.getSectionIndex=function e(t){return this.sectionIndex[t]};Jh.prototype.getCharCode=function e(t){return this.text.charCodeAt(t)};Jh.prototype.verticalizePunctuation=function e(){this.text=eh(this.text)};Jh.prototype.trim=function e(){var t=0;for(var r=0;r<this.text.length&&$h[this.text.charCodeAt(r)];r++){t++}var a=this.text.length;for(var n=this.text.length-1;n>=0&&n>=t&&$h[this.text.charCodeAt(n)];n--){a--}this.text=this.text.substring(t,a);this.sectionIndex=this.sectionIndex.slice(t,a)};Jh.prototype.substring=function e(t,r){var e=new Jh;e.text=this.text.substring(t,r);e.sectionIndex=this.sectionIndex.slice(t,r);e.sections=this.sections;return e};Jh.prototype.toString=function e(){return this.text};Jh.prototype.getMaxScale=function e(){var t=this;return this.sectionIndex.reduce((function(e,r){return Math.max(e,t.sections[r].scale)}),0)};Jh.prototype.addTextSection=function e(t,r){this.text+=t.text;this.sections.push(Zh.forText(t.scale,t.fontStack||r));var a=this.sections.length-1;for(var n=0;n<t.text.length;++n){this.sectionIndex.push(a)}};Jh.prototype.addImageSection=function e(t){var r=t.image?t.image.name:"";if(r.length===0){L("Can't add FormattedSection with an empty image.");return}var a=this.getNextImageSectionCharCode();if(!a){L("Reached maximum number of images "+(Xh-Wh+2));return}this.text+=String.fromCharCode(a);this.sections.push(Zh.forImage(r));this.sectionIndex.push(this.sections.length-1)};Jh.prototype.getNextImageSectionCharCode=function e(){if(!this.imageSectionID){this.imageSectionID=Wh;return this.imageSectionID}if(this.imageSectionID>=Xh){return null}return++this.imageSectionID};function Kh(e,t){var r=[];var a=e.text;var n=0;for(var i=0,o=t;i<o.length;i+=1){var s=o[i];r.push(e.substring(n,s));n=s}if(n<a.length){r.push(e.substring(n,a.length))}return r}function Qh(e,t,r,a,n,i,o,s,l,u,c,f,h,p,v,d){var m=Jh.fromFeature(e,n);if(f===qh.vertical){m.verticalizePunctuation()}var g;var y=Po.processBidirectionalText;var x=Po.processStyledBidirectionalText;if(y&&m.sections.length===1){g=[];var b=y(m.toString(),sp(m,u,i,t,a,p,v));for(var _=0,w=b;_<w.length;_+=1){var T=w[_];var k=new Jh;k.text=T;k.sections=m.sections;for(var M=0;M<T.length;M++){k.sectionIndex.push(0)}g.push(k)}}else if(x){g=[];var A=x(m.text,m.sectionIndex,sp(m,u,i,t,a,p,v));for(var S=0,E=A;S<E.length;S+=1){var L=E[S];var C=new Jh;C.text=L[0];C.sectionIndex=L[1];C.sections=m.sections;g.push(C)}}else{g=Kh(m,sp(m,u,i,t,a,p,v))}var I=[];var P={positionedLines:I,text:m.toString(),top:c[1],bottom:c[1],left:c[0],right:c[0],writingMode:f,iconsInText:false,verticalizable:false};up(P,t,r,a,g,o,s,l,f,u,h,d);if(Yh(I)){return false}return P}var $h={};$h[9]=true;$h[10]=true;$h[11]=true;$h[12]=true;$h[13]=true;$h[32]=true;var ep={};ep[10]=true;ep[32]=true;ep[38]=true;ep[40]=true;ep[41]=true;ep[43]=true;ep[45]=true;ep[47]=true;ep[173]=true;ep[183]=true;ep[8203]=true;ep[8208]=true;ep[8211]=true;ep[8231]=true;function tp(e,t,r,a,n,i){if(!t.imageName){var o=r[t.fontStack];var s=o&&o[e];if(!s){return 0}return s.metrics.advance*t.scale+n}else{var l=a[t.imageName];if(!l){return 0}return l.displaySize[0]*t.scale*th/i+n}}function rp(e,t,r,a,n,i){var o=0;for(var s=0;s<e.length();s++){var l=e.getSection(s);o+=tp(e.getCharCode(s),l,a,n,t,i)}var u=Math.max(1,Math.ceil(o/r));return o/u}function ap(e,t,r,a){var n=Math.pow(e-t,2);if(a){if(e<t){return n/2}else{return n*2}}return n+Math.abs(r)*r}function np(e,t,r){var a=0;if(e===10){a-=1e4}if(r){a+=150}if(e===40||e===65288){a+=50}if(t===41||t===65289){a+=50}return a}function ip(e,t,r,a,n,i){var o=null;var s=ap(t,r,n,i);for(var l=0,u=a;l<u.length;l+=1){var c=u[l];var f=t-c.x;var h=ap(f,r,n,i)+c.badness;if(h<=s){o=c;s=h}}return{index:e,x:t,priorBreak:o,badness:s}}function op(e){if(!e){return[]}return op(e.priorBreak).concat(e.index)}function sp(e,t,r,a,n,i,o){if(i!=="point"){return[]}if(!e){return[]}var s=[];var l=rp(e,t,r,a,n,o);var u=e.text.indexOf("​")>=0;var c=0;for(var f=0;f<e.length();f++){var h=e.getSection(f);var p=e.getCharCode(f);if(!$h[p]){c+=tp(p,h,a,n,t,o)}if(f<e.length()-1){var v=fo(p);if(ep[p]||v||h.imageName){s.push(ip(f+1,c,l,s,np(p,e.getCharCode(f+1),v&&u),false))}}}return op(ip(e.length(),c,l,s,0,true))}function lp(e){var t=.5,r=.5;switch(e){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0;break}switch(e){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0;break}return{horizontalAlign:t,verticalAlign:r}}function up(e,t,r,a,n,i,o,s,l,u,c,f){var h=0;var p=Gh;var v=0;var d=0;var m=s==="right"?1:s==="left"?0:.5;var g=0;for(var y=0,x=n;y<x.length;y+=1){var b=x[y];b.trim();var _=b.getMaxScale();var w=(_-1)*th;var T={positionedGlyphs:[],lineOffset:0};e.positionedLines[g]=T;var k=T.positionedGlyphs;var M=0;if(!b.length()){p+=i;++g;continue}for(var A=0;A<b.length();A++){var S=b.getSection(A);var E=b.getSectionIndex(A);var L=b.getCharCode(A);var C=0;var I=null;var P=null;var O=null;var z=th;var D=!(l===qh.horizontal||!c&&!ho(L)||c&&($h[L]||mo(L)));if(!S.imageName){var R=r[S.fontStack];var F=R&&R[L];if(F&&F.rect){P=F.rect;I=F.metrics}else{var B=t[S.fontStack];var N=B&&B[L];if(!N){continue}I=N.metrics}C=(_-S.scale)*th}else{var j=a[S.imageName];if(!j){continue}O=S.imageName;e.iconsInText=e.iconsInText||true;P=j.paddedRect;var U=j.displaySize;S.scale=S.scale*th/f;I={width:U[0],height:U[1],left:jh,top:-Bh,advance:D?U[1]:U[0]};var V=th-U[1]*S.scale;C=w+V;z=I.advance;var H=D?U[0]*S.scale-th*_:U[1]*S.scale-th*_;if(H>0&&H>M){M=H}}if(!D){k.push({glyph:L,imageName:O,x:h,y:p+C,vertical:D,scale:S.scale,fontStack:S.fontStack,sectionIndex:E,metrics:I,rect:P});h+=I.advance*S.scale+u}else{e.verticalizable=true;k.push({glyph:L,imageName:O,x:h,y:p+C,vertical:D,scale:S.scale,fontStack:S.fontStack,sectionIndex:E,metrics:I,rect:P});h+=z*S.scale+u}}if(k.length!==0){var q=h-u;v=Math.max(q,v);cp(k,0,k.length-1,m,M)}h=0;var G=i*_+M;T.lineOffset=Math.max(M,w);p+=G;d=Math.max(G,d);++g}var Y=p-Gh;var W=lp(o);var X=W.horizontalAlign;var Z=W.verticalAlign;fp(e.positionedLines,m,X,Z,v,d,i,Y,n.length);e.top+=-Z*Y;e.bottom=e.top+Y;e.left+=-X*v;e.right=e.left+v}function cp(e,t,r,a,n){if(!a&&!n){return}var i=e[r];var o=i.metrics.advance*i.scale;var s=(e[r].x+o)*a;for(var l=t;l<=r;l++){e[l].x-=s;e[l].y+=n}}function fp(e,t,r,a,n,i,o,s,l){var u=(t-r)*n;var c=0;if(i!==o){c=-s*a-Gh}else{c=(-a*l+.5)*o}for(var f=0,h=e;f<h.length;f+=1){var p=h[f];for(var v=0,d=p.positionedGlyphs;v<d.length;v+=1){var m=d[v];m.x+=u;m.y+=c}}}function hp(e,t,r){var a=lp(r);var n=a.horizontalAlign;var i=a.verticalAlign;var o=t[0];var s=t[1];var l=o-e.displaySize[0]*n;var u=l+e.displaySize[0];var c=s-e.displaySize[1]*i;var f=c+e.displaySize[1];return{image:e,top:c,bottom:f,left:l,right:u}}function pp(e,t,r,a,n,i){var o=e.image;var s;if(o.content){var l=o.content;var u=o.pixelRatio||1;s=[l[0]/u,l[1]/u,o.displaySize[0]-l[2]/u,o.displaySize[1]-l[3]/u]}var c=t.left*i;var f=t.right*i;var h,p,v,d;if(r==="width"||r==="both"){d=n[0]+c-a[3];p=n[0]+f+a[1]}else{d=n[0]+(c+f-o.displaySize[0])/2;p=d+o.displaySize[0]}var m=t.top*i;var g=t.bottom*i;if(r==="height"||r==="both"){h=n[1]+m-a[0];v=n[1]+g+a[2]}else{h=n[1]+(m+g-o.displaySize[1])/2;v=h+o.displaySize[1]}return{image:o,top:h,right:p,bottom:v,left:d,collisionPadding:s}}var vp=function(e){function t(t,r,a,n){e.call(this,t,r);this.angle=a;if(n!==undefined){this.segment=n}}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype.clone=function e(){return new t(this.x,this.y,this.angle,this.segment)};return t}(i);eo("Anchor",vp);var dp=128;function mp(e,t){var r=t.expression;if(r.kind==="constant"){var a=r.evaluate(new zo(e+1));return{kind:"constant",layoutSize:a}}else if(r.kind==="source"){return{kind:"source"}}else{var n=r.zoomStops;var i=r.interpolationType;var o=0;while(o<n.length&&n[o]<=e){o++}o=Math.max(0,o-1);var s=o;while(s<n.length&&n[s]<e+1){s++}s=Math.min(n.length-1,s);var l=n[o];var u=n[s];if(r.kind==="composite"){return{kind:"composite",minZoom:l,maxZoom:u,interpolationType:i}}var c=r.evaluate(new zo(l));var f=r.evaluate(new zo(u));return{kind:"camera",minZoom:l,maxZoom:u,minSize:c,maxSize:f,interpolationType:i}}}function gp(e,t,r){var a=t.uSize;var n=t.uSizeT;var i=r.lowerSize;var o=r.upperSize;if(e.kind==="source"){return i/dp}else if(e.kind==="composite"){return _a(i/dp,o/dp,n)}return a}function yp(e,t){var r=0;var a=0;if(e.kind==="constant"){a=e.layoutSize}else if(e.kind!=="source"){var n=e.interpolationType;var i=e.minZoom;var o=e.maxZoom;var s=!n?0:f(Xa.interpolationFactor(n,t,i,o),0,1);if(e.kind==="camera"){a=_a(e.minSize,e.maxSize,s)}else{r=s}}return{uSizeT:r,uSize:a}}var xp=Object.freeze({__proto__:null,getSizeData:mp,evaluateSizeForFeature:gp,evaluateSizeForZoom:yp,SIZE_PACK_FACTOR:dp});function bp(e,t,r,a,n){if(t.segment===undefined){return true}var i=t;var o=t.segment+1;var s=0;while(s>-r/2){o--;if(o<0){return false}s-=e[o].dist(i);i=e[o]}s+=e[o].dist(e[o+1]);o++;var l=[];var u=0;while(s<r/2){var c=e[o-1];var f=e[o];var h=e[o+1];if(!h){return false}var p=c.angleTo(f)-f.angleTo(h);p=Math.abs((p+3*Math.PI)%(Math.PI*2)-Math.PI);l.push({distance:s,angleDelta:p});u+=p;while(s-l[0].distance>a){u-=l.shift().angleDelta}if(u>n){return false}o++;s+=f.dist(h)}return true}function _p(e){var t=0;for(var r=0;r<e.length-1;r++){t+=e[r].dist(e[r+1])}return t}function wp(e,t,r){return e?3/5*t*r:0}function Tp(e,t){return Math.max(e?e.right-e.left:0,t?t.right-t.left:0)}function kp(e,t,r,a,n,i){var o=wp(r,n,i);var s=Tp(r,a)*i;var l=0;var u=_p(e)/2;for(var c=0;c<e.length-1;c++){var f=e[c],h=e[c+1];var p=f.dist(h);if(l+p>u){var v=(u-l)/p,d=_a(f.x,h.x,v),m=_a(f.y,h.y,v);var g=new vp(d,m,h.angleTo(f),c);g._round();if(!o||bp(e,g,s,o,t)){return g}else{return}}l+=p}}function Mp(e,t,r,a,n,i,o,s,l){var u=wp(a,i,o);var c=Tp(a,n);var f=c*o;var h=e[0].x===0||e[0].x===l||e[0].y===0||e[0].y===l;if(t-f<t/4){t=f+t/4}var p=i*2;var v=!h?(c/2+p)*o*s%t:t/2*s%t;return Ap(e,v,t,u,r,f,h,false,l)}function Ap(e,t,r,a,n,i,o,s,l){var u=i/2;var c=_p(e);var f=0,h=t-r;var p=[];for(var v=0;v<e.length-1;v++){var d=e[v],m=e[v+1];var g=d.dist(m),y=m.angleTo(d);while(h+r<f+g){h+=r;var x=(h-f)/g,b=_a(d.x,m.x,x),_=_a(d.y,m.y,x);if(b>=0&&b<l&&_>=0&&_<l&&h-u>=0&&h+u<=c){var w=new vp(b,_,y,v);w._round();if(!a||bp(e,w,i,a,n)){p.push(w)}}}f+=g}if(!s&&!p.length&&!o){p=Ap(e,f/2,r,a,n,i,o,true,l)}return p}function Sp(e,t,r,a,n){var o=[];for(var s=0;s<e.length;s++){var l=e[s];var u=void 0;for(var c=0;c<l.length-1;c++){var f=l[c];var h=l[c+1];if(f.x<t&&h.x<t){continue}else if(f.x<t){f=new i(t,f.y+(h.y-f.y)*((t-f.x)/(h.x-f.x)))._round()}else if(h.x<t){h=new i(t,f.y+(h.y-f.y)*((t-f.x)/(h.x-f.x)))._round()}if(f.y<r&&h.y<r){continue}else if(f.y<r){f=new i(f.x+(h.x-f.x)*((r-f.y)/(h.y-f.y)),r)._round()}else if(h.y<r){h=new i(f.x+(h.x-f.x)*((r-f.y)/(h.y-f.y)),r)._round()}if(f.x>=a&&h.x>=a){continue}else if(f.x>=a){f=new i(a,f.y+(h.y-f.y)*((a-f.x)/(h.x-f.x)))._round()}else if(h.x>=a){h=new i(a,f.y+(h.y-f.y)*((a-f.x)/(h.x-f.x)))._round()}if(f.y>=n&&h.y>=n){continue}else if(f.y>=n){f=new i(f.x+(h.x-f.x)*((n-f.y)/(h.y-f.y)),n)._round()}else if(h.y>=n){h=new i(f.x+(h.x-f.x)*((n-f.y)/(h.y-f.y)),n)._round()}if(!u||!f.equals(u[u.length-1])){u=[f];o.push(u)}u.push(h)}}return o}var Ep=jh;function Lp(e,t,r,a){var n=[];var o=e.image;var s=o.pixelRatio;var l=o.paddedRect.w-2*Ep;var u=o.paddedRect.h-2*Ep;var c=e.right-e.left;var f=e.bottom-e.top;var h=o.stretchX||[[0,l]];var p=o.stretchY||[[0,u]];var v=function(e,t){return e+t[1]-t[0]};var d=h.reduce(v,0);var m=p.reduce(v,0);var g=l-d;var y=u-m;var x=0;var b=d;var _=0;var w=m;var T=0;var k=g;var M=0;var A=y;if(o.content&&a){var S=o.content;x=Cp(h,0,S[0]);_=Cp(p,0,S[1]);b=Cp(h,S[0],S[2]);w=Cp(p,S[1],S[3]);T=S[0]-x;M=S[1]-_;k=S[2]-S[0]-b;A=S[3]-S[1]-w}var E=function(a,n,l,u){var h=Pp(a.stretch-x,b,c,e.left);var p=Op(a.fixed-T,k,a.stretch,d);var v=Pp(n.stretch-_,w,f,e.top);var g=Op(n.fixed-M,A,n.stretch,m);var y=Pp(l.stretch-x,b,c,e.left);var S=Op(l.fixed-T,k,l.stretch,d);var E=Pp(u.stretch-_,w,f,e.top);var L=Op(u.fixed-M,A,u.stretch,m);var C=new i(h,v);var I=new i(y,v);var P=new i(y,E);var O=new i(h,E);var z=new i(p/s,g/s);var D=new i(S/s,L/s);var R=t*Math.PI/180;if(R){var F=Math.sin(R),B=Math.cos(R),N=[B,-F,F,B];C._matMult(N);I._matMult(N);O._matMult(N);P._matMult(N)}var j=a.stretch+a.fixed;var U=l.stretch+l.fixed;var V=n.stretch+n.fixed;var H=u.stretch+u.fixed;var q={x:o.paddedRect.x+Ep+j,y:o.paddedRect.y+Ep+V,w:U-j,h:H-V};var G=k/s/c;var Y=A/s/f;return{tl:C,tr:I,bl:O,br:P,tex:q,writingMode:undefined,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:z,pixelOffsetBR:D,minFontScaleX:G,minFontScaleY:Y,isSDF:r}};if(!a||!o.stretchX&&!o.stretchY){n.push(E({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:l+1},{fixed:0,stretch:u+1}))}else{var L=Ip(h,g,d);var C=Ip(p,y,m);for(var I=0;I<L.length-1;I++){var P=L[I];var O=L[I+1];for(var z=0;z<C.length-1;z++){var D=C[z];var R=C[z+1];n.push(E(P,D,O,R))}}}return n}function Cp(e,t,r){var a=0;for(var n=0,i=e;n<i.length;n+=1){var o=i[n];a+=Math.max(t,Math.min(r,o[1]))-Math.max(t,Math.min(r,o[0]))}return a}function Ip(e,t,r){var a=[{fixed:-Ep,stretch:0}];for(var n=0,i=e;n<i.length;n+=1){var o=i[n];var s=o[0];var l=o[1];var u=a[a.length-1];a.push({fixed:s-u.stretch,stretch:u.stretch});a.push({fixed:s-u.stretch,stretch:u.stretch+(l-s)})}a.push({fixed:t+Ep,stretch:r});return a}function Pp(e,t,r,a){return e/t*r+a}function Op(e,t,r,a){return e-t*r/a}function zp(e,t,r,a,n,o,s,l){var u=a.layout.get("text-rotate").evaluate(o,{})*Math.PI/180;var c=[];for(var f=0,h=t.positionedLines;f<h.length;f+=1){var p=h[f];for(var v=0,d=p.positionedGlyphs;v<d.length;v+=1){var m=d[v];if(!m.rect){continue}var g=m.rect||{};var y=1;var x=Bh+y;var b=true;var _=1;var w=0;var T=(n||l)&&m.vertical;var k=m.metrics.advance*m.scale/2;if(l&&t.verticalizable){var M=(m.scale-1)*th;var A=(th-m.metrics.width*m.scale)/2;w=p.lineOffset/2-(m.imageName?-A:M)}if(m.imageName){var S=s[m.imageName];b=S.sdf;_=S.pixelRatio;x=jh/_}var E=n?[m.x+k,m.y]:[0,0];var L=n?[0,0]:[m.x+k+r[0],m.y+r[1]-w];var C=[0,0];if(T){C=L;L=[0,0]}var I=(m.metrics.left-x)*m.scale-k+L[0];var P=(-m.metrics.top-x)*m.scale+L[1];var O=I+g.w*m.scale/_;var z=P+g.h*m.scale/_;var D=new i(I,P);var R=new i(O,P);var F=new i(I,z);var B=new i(O,z);if(T){var N=new i(-k,k-Gh);var j=-Math.PI/2;var U=th/2-k;var V=m.imageName?U:0;var H=new i(5-Gh-U,-V);var q=new(Function.prototype.bind.apply(i,[null].concat(C)));D._rotateAround(j,N)._add(H)._add(q);R._rotateAround(j,N)._add(H)._add(q);F._rotateAround(j,N)._add(H)._add(q);B._rotateAround(j,N)._add(H)._add(q)}if(u){var G=Math.sin(u),Y=Math.cos(u),W=[Y,-G,G,Y];D._matMult(W);R._matMult(W);F._matMult(W);B._matMult(W)}var X=new i(0,0);var Z=new i(0,0);var J=0;var K=0;c.push({tl:D,tr:R,bl:F,br:B,tex:g,writingMode:t.writingMode,glyphOffset:E,sectionIndex:m.sectionIndex,isSDF:b,pixelOffsetTL:X,pixelOffsetBR:Z,minFontScaleX:J,minFontScaleY:K})}}return c}var Dp=function e(t,r,a,n,o,s,l,u,c,f){this.boxStartIndex=t.length;if(c){var h=s.top;var p=s.bottom;var v=s.collisionPadding;if(v){h-=v[1];p+=v[3]}var d=p-h;if(d>0){d=Math.max(10,d);this.circleDiameter=d}}else{var m=s.top*l-u;var g=s.bottom*l+u;var y=s.left*l-u;var x=s.right*l+u;var b=s.collisionPadding;if(b){y-=b[0]*l;m-=b[1]*l;x+=b[2]*l;g+=b[3]*l}if(f){var _=new i(y,m);var w=new i(x,m);var T=new i(y,g);var k=new i(x,g);var M=f*Math.PI/180;_._rotate(M);w._rotate(M);T._rotate(M);k._rotate(M);y=Math.min(_.x,w.x,T.x,k.x);x=Math.max(_.x,w.x,T.x,k.x);m=Math.min(_.y,w.y,T.y,k.y);g=Math.max(_.y,w.y,T.y,k.y)}t.emplaceBack(r.x,r.y,y,m,x,g,a,n,o)}this.boxEndIndex=t.length};var Rp=function e(t,r){if(t===void 0)t=[];if(r===void 0)r=Fp;this.data=t;this.length=this.data.length;this.compare=r;if(this.length>0){for(var a=(this.length>>1)-1;a>=0;a--){this._down(a)}}};Rp.prototype.push=function e(t){this.data.push(t);this.length++;this._up(this.length-1)};Rp.prototype.pop=function e(){if(this.length===0){return undefined}var t=this.data[0];var r=this.data.pop();this.length--;if(this.length>0){this.data[0]=r;this._down(0)}return t};Rp.prototype.peek=function e(){return this.data[0]};Rp.prototype._up=function e(t){var r=this;var a=r.data;var n=r.compare;var i=a[t];while(t>0){var o=t-1>>1;var s=a[o];if(n(i,s)>=0){break}a[t]=s;t=o}a[t]=i};Rp.prototype._down=function e(t){var r=this;var a=r.data;var n=r.compare;var i=this.length>>1;var o=a[t];while(t<i){var s=(t<<1)+1;var l=a[s];var u=s+1;if(u<this.length&&n(a[u],l)<0){s=u;l=a[u]}if(n(l,o)>=0){break}a[t]=l;t=s}a[t]=o};function Fp(e,t){return e<t?-1:e>t?1:0}function Bp(e,t,r){if(t===void 0)t=1;if(r===void 0)r=false;var a=Infinity,n=Infinity,o=-Infinity,s=-Infinity;var l=e[0];for(var u=0;u<l.length;u++){var c=l[u];if(!u||c.x<a){a=c.x}if(!u||c.y<n){n=c.y}if(!u||c.x>o){o=c.x}if(!u||c.y>s){s=c.y}}var f=o-a;var h=s-n;var p=Math.min(f,h);var v=p/2;var d=new Rp([],Np);if(p===0){return new i(a,n)}for(var m=a;m<o;m+=p){for(var g=n;g<s;g+=p){d.push(new jp(m+v,g+v,v,e))}}var y=Vp(e);var x=d.length;while(d.length){var b=d.pop();if(b.d>y.d||!y.d){y=b;if(r){console.log("found best %d after %d probes",Math.round(1e4*b.d)/1e4,x)}}if(b.max-y.d<=t){continue}v=b.h/2;d.push(new jp(b.p.x-v,b.p.y-v,v,e));d.push(new jp(b.p.x+v,b.p.y-v,v,e));d.push(new jp(b.p.x-v,b.p.y+v,v,e));d.push(new jp(b.p.x+v,b.p.y+v,v,e));x+=4}if(r){console.log("num probes: "+x);console.log("best distance: "+y.d)}return y.p}function Np(e,t){return t.max-e.max}function jp(e,t,r,a){this.p=new i(e,t);this.h=r;this.d=Up(this.p,a);this.max=this.d+this.h*Math.SQRT2}function Up(e,t){var r=false;var a=Infinity;for(var n=0;n<t.length;n++){var i=t[n];for(var o=0,s=i.length,l=s-1;o<s;l=o++){var u=i[o];var c=i[l];if(u.y>e.y!==c.y>e.y&&e.x<(c.x-u.x)*(e.y-u.y)/(c.y-u.y)+u.x){r=!r}a=Math.min(a,Pl(e,u,c))}}return(r?1:-1)*Math.sqrt(a)}function Vp(e){var t=0;var r=0;var a=0;var n=e[0];for(var i=0,o=n.length,s=o-1;i<o;s=i++){var l=n[i];var u=n[s];var c=l.x*u.y-u.x*l.y;r+=(l.x+u.x)*c;a+=(l.y+u.y)*c;t+=c*3}return new jp(r/t,a/t,0,e)}var Hp=7;var qp=Number.POSITIVE_INFINITY;function Gp(e,t){function r(e,t){var r=0,a=0;if(t<0){t=0}var n=t/Math.sqrt(2);switch(e){case"top-right":case"top-left":a=n-Hp;break;case"bottom-right":case"bottom-left":a=-n+Hp;break;case"bottom":a=-t+Hp;break;case"top":a=t-Hp;break}switch(e){case"top-right":case"bottom-right":r=-n;break;case"top-left":case"bottom-left":r=n;break;case"left":r=t;break;case"right":r=-t;break}return[r,a]}function a(e,t,r){var a=0,n=0;t=Math.abs(t);r=Math.abs(r);switch(e){case"top-right":case"top-left":case"top":n=r-Hp;break;case"bottom-right":case"bottom-left":case"bottom":n=-r+Hp;break}switch(e){case"top-right":case"bottom-right":case"right":a=-t;break;case"top-left":case"bottom-left":case"left":a=t;break}return[a,n]}return t[1]!==qp?a(e,t[0],t[1]):r(e,t[0])}function Yp(e,t,r,a,n,i,o){e.createArrays();var s=512*e.overscaling;e.tilePixelRatio=yl/s;e.compareText={};e.iconsNeedLinear=false;var l=e.layers[0].layout;var u=e.layers[0]._unevaluatedLayout._values;var c={};if(e.textSizeData.kind==="composite"){var f=e.textSizeData;var h=f.minZoom;var p=f.maxZoom;c.compositeTextSizes=[u["text-size"].possiblyEvaluate(new zo(h),o),u["text-size"].possiblyEvaluate(new zo(p),o)]}if(e.iconSizeData.kind==="composite"){var v=e.iconSizeData;var d=v.minZoom;var m=v.maxZoom;c.compositeIconSizes=[u["icon-size"].possiblyEvaluate(new zo(d),o),u["icon-size"].possiblyEvaluate(new zo(m),o)]}c.layoutTextSize=u["text-size"].possiblyEvaluate(new zo(e.zoom+1),o);c.layoutIconSize=u["icon-size"].possiblyEvaluate(new zo(e.zoom+1),o);c.textMaxSize=u["text-size"].possiblyEvaluate(new zo(18));var g=l.get("text-line-height")*th;var y=l.get("text-rotation-alignment")==="map"&&l.get("symbol-placement")!=="point";var x=l.get("text-keep-upright");var b=l.get("text-size");var _=function(){var i=T[w];var s=l.get("text-font").evaluate(i,{},o).join(",");var u=b.evaluate(i,{},o);var f=c.layoutTextSize.evaluate(i,{},o);var h=c.layoutIconSize.evaluate(i,{},o);var p={horizontal:{},vertical:undefined};var v=i.text;var d=[0,0];if(v){var m=v.toString();var _=l.get("text-letter-spacing").evaluate(i,{},o)*th;var k=uo(m)?_:0;var M=l.get("text-anchor").evaluate(i,{},o);var A=l.get("text-variable-anchor");if(!A){var S=l.get("text-radial-offset").evaluate(i,{},o);if(S){d=Gp(M,[S*th,qp])}else{d=l.get("text-offset").evaluate(i,{},o).map((function(e){return e*th}))}}var E=y?"center":l.get("text-justify").evaluate(i,{},o);var C=l.get("symbol-placement");var I=C==="point"?l.get("text-max-width").evaluate(i,{},o)*th:0;var P=function(){if(e.allowVerticalPlacement&&lo(m)){p.vertical=Qh(v,t,r,n,s,I,g,M,"left",k,d,qh.vertical,true,C,f,u)}};if(!y&&A){var O=E==="auto"?A.map((function(e){return Wp(e)})):[E];var z=false;for(var D=0;D<O.length;D++){var R=O[D];if(p.horizontal[R]){continue}if(z){p.horizontal[R]=p.horizontal[0]}else{var F=Qh(v,t,r,n,s,I,g,"center",R,k,d,qh.horizontal,false,C,f,u);if(F){p.horizontal[R]=F;z=F.positionedLines.length===1}}}P()}else{if(E==="auto"){E=Wp(M)}var B=Qh(v,t,r,n,s,I,g,M,E,k,d,qh.horizontal,false,C,f,u);if(B){p.horizontal[E]=B}P();if(lo(m)&&y&&x){p.vertical=Qh(v,t,r,n,s,I,g,M,E,k,d,qh.vertical,false,C,f,u)}}}var N=void 0;var j=false;if(i.icon&&i.icon.name){var U=a[i.icon.name];if(U){N=hp(n[i.icon.name],l.get("icon-offset").evaluate(i,{},o),l.get("icon-anchor").evaluate(i,{},o));j=U.sdf;if(e.sdfIcons===undefined){e.sdfIcons=U.sdf}else if(e.sdfIcons!==U.sdf){L("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer")}if(U.pixelRatio!==e.pixelRatio){e.iconsNeedLinear=true}else if(l.get("icon-rotate").constantOr(1)!==0){e.iconsNeedLinear=true}}}var V=Qp(p.horizontal)||p.vertical;e.iconsInText=V?V.iconsInText:false;if(V||N){Xp(e,i,p,N,a,c,f,h,d,j,o)}};for(var w=0,T=e.features;w<T.length;w+=1)_();if(i){e.generateCollisionDebugBuffers()}}function Wp(e){switch(e){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Xp(e,t,r,a,n,i,o,s,l,u,c){var f=i.textMaxSize.evaluate(t,{});if(f===undefined){f=o}var h=e.layers[0].layout;var p=h.get("icon-offset").evaluate(t,{},c);var v=Qp(r.horizontal);var d=24,m=o/d,g=e.tilePixelRatio*m,y=e.tilePixelRatio*f/d,x=e.tilePixelRatio*s,b=e.tilePixelRatio*h.get("symbol-spacing"),_=h.get("text-padding")*e.tilePixelRatio,w=h.get("icon-padding")*e.tilePixelRatio,T=h.get("text-max-angle")/180*Math.PI,k=h.get("text-rotation-alignment")==="map"&&h.get("symbol-placement")!=="point",M=h.get("icon-rotation-alignment")==="map"&&h.get("symbol-placement")!=="point",A=h.get("symbol-placement"),S=b/2;var E=h.get("icon-text-fit");var L;if(a&&E!=="none"){if(e.allowVerticalPlacement&&r.vertical){L=pp(a,r.vertical,E,h.get("icon-text-fit-padding"),p,m)}if(v){a=pp(a,v,E,h.get("icon-text-fit-padding"),p,m)}}var C=function(s,f){if(f.x<0||f.x>=yl||f.y<0||f.y>=yl){return}$p(e,f,s,r,a,n,L,e.layers[0],e.collisionBoxArray,t.index,t.sourceLayerIndex,e.index,g,_,k,l,x,w,M,p,t,i,u,c,o)};if(A==="line"){for(var I=0,P=Sp(t.geometry,0,0,yl,yl);I<P.length;I+=1){var O=P[I];var z=Mp(O,b,T,r.vertical||v,a,d,y,e.overscaling,yl);for(var D=0,R=z;D<R.length;D+=1){var F=R[D];var B=v;if(!B||!ev(e,B.text,S,F)){C(O,F)}}}}else if(A==="line-center"){for(var N=0,j=t.geometry;N<j.length;N+=1){var U=j[N];if(U.length>1){var V=kp(U,T,r.vertical||v,a,d,y);if(V){C(U,V)}}}}else if(t.type==="Polygon"){for(var H=0,q=Ec(t.geometry,0);H<q.length;H+=1){var G=q[H];var Y=Bp(G,16);C(G[0],new vp(Y.x,Y.y,0))}}else if(t.type==="LineString"){for(var W=0,X=t.geometry;W<X.length;W+=1){var Z=X[W];C(Z,new vp(Z[0].x,Z[0].y,0))}}else if(t.type==="Point"){for(var J=0,K=t.geometry;J<K.length;J+=1){var Q=K[J];for(var $=0,ee=Q;$<ee.length;$+=1){var te=ee[$];C([te],new vp(te.x,te.y,0))}}}}var Zp=255;var Jp=Zp*dp;function Kp(e,t,r,a,n,i,o,s,l,u,c,f,h,p,v){var d=zp(t,r,s,n,i,o,a,e.allowVerticalPlacement);var m=e.textSizeData;var g=null;if(m.kind==="source"){g=[dp*n.layout.get("text-size").evaluate(o,{})];if(g[0]>Jp){L(e.layerIds[0]+': Value for "text-size" is >= '+Zp+'. Reduce your "text-size".')}}else if(m.kind==="composite"){g=[dp*p.compositeTextSizes[0].evaluate(o,{},v),dp*p.compositeTextSizes[1].evaluate(o,{},v)];if(g[0]>Jp||g[1]>Jp){L(e.layerIds[0]+': Value for "text-size" is >= '+Zp+'. Reduce your "text-size".')}}e.addSymbols(e.text,d,g,s,i,o,u,t,l.lineStartIndex,l.lineLength,h,v);for(var y=0,x=c;y<x.length;y+=1){var b=x[y];f[b]=e.text.placedSymbolArray.length-1}return d.length*4}function Qp(e){for(var t in e){return e[t]}return null}function $p(e,t,r,a,n,i,o,s,l,u,c,f,h,p,v,d,m,g,y,x,b,_,w,T,k){var M;var A=e.addToLineVertexArray(t,r);var S,E,C,I;var P=0;var O=0;var z=0;var D=0;var R=-1;var F=-1;var B={};var N=qs("");var j=0;var U=0;if(s._unevaluatedLayout.getValue("text-radial-offset")===undefined){M=s.layout.get("text-offset").evaluate(b,{},T).map((function(e){return e*th})),j=M[0],U=M[1]}else{j=s.layout.get("text-radial-offset").evaluate(b,{},T)*th;U=qp}if(e.allowVerticalPlacement&&a.vertical){var V=s.layout.get("text-rotate").evaluate(b,{},T);var H=V+90;var q=a.vertical;C=new Dp(l,t,u,c,f,q,h,p,v,H);if(o){I=new Dp(l,t,u,c,f,o,m,g,v,H)}}if(n){var G=s.layout.get("icon-rotate").evaluate(b,{});var Y=s.layout.get("icon-text-fit")!=="none";var W=Lp(n,G,w,Y);var X=o?Lp(o,G,w,Y):undefined;E=new Dp(l,t,u,c,f,n,m,g,false,G);P=W.length*4;var Z=e.iconSizeData;var J=null;if(Z.kind==="source"){J=[dp*s.layout.get("icon-size").evaluate(b,{})];if(J[0]>Jp){L(e.layerIds[0]+': Value for "icon-size" is >= '+Zp+'. Reduce your "icon-size".')}}else if(Z.kind==="composite"){J=[dp*_.compositeIconSizes[0].evaluate(b,{},T),dp*_.compositeIconSizes[1].evaluate(b,{},T)];if(J[0]>Jp||J[1]>Jp){L(e.layerIds[0]+': Value for "icon-size" is >= '+Zp+'. Reduce your "icon-size".')}}e.addSymbols(e.icon,W,J,x,y,b,false,t,A.lineStartIndex,A.lineLength,-1,T);R=e.icon.placedSymbolArray.length-1;if(X){O=X.length*4;e.addSymbols(e.icon,X,J,x,y,b,qh.vertical,t,A.lineStartIndex,A.lineLength,-1,T);F=e.icon.placedSymbolArray.length-1}}for(var K in a.horizontal){var Q=a.horizontal[K];if(!S){N=qs(Q.text);var $=s.layout.get("text-rotate").evaluate(b,{},T);S=new Dp(l,t,u,c,f,Q,h,p,v,$)}var ee=Q.positionedLines.length===1;z+=Kp(e,t,Q,i,s,v,b,d,A,a.vertical?qh.horizontal:qh.horizontalOnly,ee?Object.keys(a.horizontal):[K],B,R,_,T);if(ee){break}}if(a.vertical){D+=Kp(e,t,a.vertical,i,s,v,b,d,A,qh.vertical,["vertical"],B,F,_,T)}var te=S?S.boxStartIndex:e.collisionBoxArray.length;var re=S?S.boxEndIndex:e.collisionBoxArray.length;var ae=C?C.boxStartIndex:e.collisionBoxArray.length;var ne=C?C.boxEndIndex:e.collisionBoxArray.length;var ie=E?E.boxStartIndex:e.collisionBoxArray.length;var oe=E?E.boxEndIndex:e.collisionBoxArray.length;var se=I?I.boxStartIndex:e.collisionBoxArray.length;var le=I?I.boxEndIndex:e.collisionBoxArray.length;var ue=-1;var ce=function(e,t){if(e&&e.circleDiameter){return Math.max(e.circleDiameter,t)}return t};ue=ce(S,ue);ue=ce(C,ue);ue=ce(E,ue);ue=ce(I,ue);var fe=ue>-1?1:0;if(fe){ue*=k/th}if(e.glyphOffsetArray.length>=lv.MAX_GLYPHS){L("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907")}if(b.sortKey!==undefined){e.addToSortKeyRanges(e.symbolInstances.length,b.sortKey)}e.symbolInstances.emplaceBack(t.x,t.y,B.right>=0?B.right:-1,B.center>=0?B.center:-1,B.left>=0?B.left:-1,B.vertical||-1,R,F,N,te,re,ae,ne,ie,oe,se,le,u,z,D,P,O,fe,0,h,j,U,ue)}function ev(e,t,r,a){var n=e.compareText;if(!(t in n)){n[t]=[]}else{var i=n[t];for(var o=i.length-1;o>=0;o--){if(a.dist(i[o])<r){return true}}}n[t].push(a);return false}var tv=rf.VectorTileFeature.types;var rv=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function av(e,t,r,a,n,i,o,s,l,u,c,f,h){var p=s?Math.min(Jp,Math.round(s[0])):0;var v=s?Math.min(Jp,Math.round(s[1])):0;e.emplaceBack(t,r,Math.round(a*32),Math.round(n*32),i,o,(p<<1)+(l?1:0),v,u*16,c*16,f*256,h*256)}function nv(e,t,r){e.emplaceBack(t.x,t.y,r);e.emplaceBack(t.x,t.y,r);e.emplaceBack(t.x,t.y,r);e.emplaceBack(t.x,t.y,r)}function iv(e){for(var t=0,r=e.sections;t<r.length;t+=1){var a=r[t];if(xo(a.text)){return true}}return false}var ov=function e(t){this.layoutVertexArray=new cs;this.indexArray=new gs;this.programConfigurations=t;this.segments=new Ns;this.dynamicLayoutVertexArray=new fs;this.opacityVertexArray=new hs;this.placedSymbolArray=new Cs};ov.prototype.isEmpty=function e(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0};ov.prototype.upload=function e(t,r,a,n){if(this.isEmpty()){return}if(a){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Bf.members);this.indexBuffer=t.createIndexBuffer(this.indexArray,r);this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,Nf.members,true);this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,rv,true);this.opacityVertexBuffer.itemSize=1}if(a||n){this.programConfigurations.upload(t)}};ov.prototype.destroy=function e(){if(!this.layoutVertexBuffer){return}this.layoutVertexBuffer.destroy();this.indexBuffer.destroy();this.programConfigurations.destroy();this.segments.destroy();this.dynamicLayoutVertexBuffer.destroy();this.opacityVertexBuffer.destroy()};eo("SymbolBuffers",ov);var sv=function e(t,r,a){this.layoutVertexArray=new t;this.layoutAttributes=r;this.indexArray=new a;this.segments=new Ns;this.collisionVertexArray=new ms};sv.prototype.upload=function e(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes);this.indexBuffer=t.createIndexBuffer(this.indexArray);this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,Uf.members,true)};sv.prototype.destroy=function e(){if(!this.layoutVertexBuffer){return}this.layoutVertexBuffer.destroy();this.indexBuffer.destroy();this.segments.destroy();this.collisionVertexBuffer.destroy()};eo("CollisionBuffers",sv);var lv=function e(t){this.collisionBoxArray=t.collisionBoxArray;this.zoom=t.zoom;this.overscaling=t.overscaling;this.layers=t.layers;this.layerIds=this.layers.map((function(e){return e.id}));this.index=t.index;this.pixelRatio=t.pixelRatio;this.sourceLayerIndex=t.sourceLayerIndex;this.hasPattern=false;this.hasRTLText=false;this.sortKeyRanges=[];this.collisionCircleArray=[];this.placementInvProjMatrix=Jl([]);this.placementViewportMatrix=Jl([]);var r=this.layers[0];var a=r._unevaluatedLayout._values;this.textSizeData=mp(this.zoom,a["text-size"]);this.iconSizeData=mp(this.zoom,a["icon-size"]);var n=this.layers[0].layout;var i=n.get("symbol-sort-key");var o=n.get("symbol-z-order");this.sortFeaturesByKey=o!=="viewport-y"&&i.constantOr(1)!==undefined;var s=o==="viewport-y"||o==="auto"&&!this.sortFeaturesByKey;this.sortFeaturesByY=s&&(n.get("text-allow-overlap")||n.get("icon-allow-overlap")||n.get("text-ignore-placement")||n.get("icon-ignore-placement"));if(n.get("symbol-placement")==="point"){this.writingModes=n.get("text-writing-mode").map((function(e){return qh[e]}))}this.stateDependentLayerIds=this.layers.filter((function(e){return e.isStateDependent()})).map((function(e){return e.id}));this.sourceID=t.sourceID};lv.prototype.createArrays=function e(){this.text=new ov(new vl(Bf.members,this.layers,this.zoom,(function(e){return/^text/.test(e)})));this.icon=new ov(new vl(Bf.members,this.layers,this.zoom,(function(e){return/^icon/.test(e)})));this.glyphOffsetArray=new Os;this.lineVertexArray=new zs;this.symbolInstances=new Ps};lv.prototype.calculateGlyphDependencies=function e(t,r,a,n,i){for(var o=0;o<t.length;o++){r[t.charCodeAt(o)]=true;if((a||n)&&i){var s=$f[t.charAt(o)];if(s){r[s.charCodeAt(0)]=true}}}};lv.prototype.populate=function e(t,r,a){var n=this.layers[0];var i=n.layout;var o=i.get("text-font");var s=i.get("text-field");var l=i.get("icon-image");var u=(s.value.kind!=="constant"||s.value.value instanceof Tr&&!s.value.value.isEmpty()||s.value.value.toString().length>0)&&(o.value.kind!=="constant"||o.value.value.length>0);var c=l.value.kind!=="constant"||!!l.value.value||Object.keys(l.parameters).length>0;var f=i.get("symbol-sort-key");this.features=[];if(!u&&!c){return}var h=r.iconDependencies;var p=r.glyphDependencies;var v=r.availableImages;var d=new zo(this.zoom);for(var m=0,g=t;m<g.length;m+=1){var y=g[m];var x=y.feature;var b=y.id;var _=y.index;var w=y.sourceLayerIndex;var T=n._featureFilter.needGeometry;var k={type:x.type,id:b,properties:x.properties,geometry:T?_l(x):[]};if(!n._featureFilter.filter(d,k,a)){continue}if(!T){k.geometry=_l(x)}var M=void 0;if(u){var A=n.getValueAndResolveTokens("text-field",k,a,v);var S=Tr.factory(A);if(iv(S)){this.hasRTLText=true}if(!this.hasRTLText||Eo()==="unavailable"||this.hasRTLText&&Po.isParsed()){M=Kf(S,n,k)}}var E=void 0;if(c){var L=n.getValueAndResolveTokens("icon-image",k,a,v);if(L instanceof kr){E=L}else{E=kr.fromString(L)}}if(!M&&!E){continue}var C=this.sortFeaturesByKey?f.evaluate(k,{},a):undefined;var I={id:b,text:M,icon:E,index:_,sourceLayerIndex:w,geometry:_l(x),properties:x.properties,type:tv[x.type],sortKey:C};this.features.push(I);if(E){h[E.name]=true}if(M){var P=o.evaluate(k,{},a).join(",");var O=i.get("text-rotation-alignment")==="map"&&i.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(qh.vertical)>=0;for(var z=0,D=M.sections;z<D.length;z+=1){var R=D[z];if(!R.image){var F=lo(M.toString());var B=R.fontStack||P;var N=p[B]=p[B]||{};this.calculateGlyphDependencies(R.text,N,O,this.allowVerticalPlacement,F)}else{h[R.image.name]=true}}}}if(i.get("symbol-placement")==="line"){this.features=Qf(this.features)}if(this.sortFeaturesByKey){this.features.sort((function(e,t){return e.sortKey-t.sortKey}))}};lv.prototype.update=function e(t,r,a){if(!this.stateDependentLayers.length){return}this.text.programConfigurations.updatePaintArrays(t,r,this.layers,a);this.icon.programConfigurations.updatePaintArrays(t,r,this.layers,a)};lv.prototype.isEmpty=function e(){return this.symbolInstances.length===0&&!this.hasRTLText};lv.prototype.uploadPending=function e(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload};lv.prototype.upload=function e(t){if(!this.uploaded&&this.hasDebugData()){this.textCollisionBox.upload(t);this.iconCollisionBox.upload(t)}this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload);this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload);this.uploaded=true};lv.prototype.destroyDebugData=function e(){this.textCollisionBox.destroy();this.iconCollisionBox.destroy()};lv.prototype.destroy=function e(){this.text.destroy();this.icon.destroy();if(this.hasDebugData()){this.destroyDebugData()}};lv.prototype.addToLineVertexArray=function e(t,r){var a=this.lineVertexArray.length;if(t.segment!==undefined){var n=t.dist(r[t.segment+1]);var i=t.dist(r[t.segment]);var o={};for(var s=t.segment+1;s<r.length;s++){o[s]={x:r[s].x,y:r[s].y,tileUnitDistanceFromAnchor:n};if(s<r.length-1){n+=r[s+1].dist(r[s])}}for(var l=t.segment||0;l>=0;l--){o[l]={x:r[l].x,y:r[l].y,tileUnitDistanceFromAnchor:i};if(l>0){i+=r[l-1].dist(r[l])}}for(var u=0;u<r.length;u++){var c=o[u];this.lineVertexArray.emplaceBack(c.x,c.y,c.tileUnitDistanceFromAnchor)}}return{lineStartIndex:a,lineLength:this.lineVertexArray.length-a}};lv.prototype.addSymbols=function e(t,r,a,n,i,o,s,l,u,c,f,h){var p=t.indexArray;var v=t.layoutVertexArray;var d=t.segments.prepareSegment(4*r.length,v,p,o.sortKey);var m=this.glyphOffsetArray.length;var g=d.vertexLength;var y=this.allowVerticalPlacement&&s===qh.vertical?Math.PI/2:0;var x=o.text&&o.text.sections;for(var b=0;b<r.length;b++){var _=r[b];var w=_.tl;var T=_.tr;var k=_.bl;var M=_.br;var A=_.tex;var S=_.pixelOffsetTL;var E=_.pixelOffsetBR;var L=_.minFontScaleX;var C=_.minFontScaleY;var I=_.glyphOffset;var P=_.isSDF;var O=_.sectionIndex;var z=d.vertexLength;var D=I[1];av(v,l.x,l.y,w.x,D+w.y,A.x,A.y,a,P,S.x,S.y,L,C);av(v,l.x,l.y,T.x,D+T.y,A.x+A.w,A.y,a,P,E.x,S.y,L,C);av(v,l.x,l.y,k.x,D+k.y,A.x,A.y+A.h,a,P,S.x,E.y,L,C);av(v,l.x,l.y,M.x,D+M.y,A.x+A.w,A.y+A.h,a,P,E.x,E.y,L,C);nv(t.dynamicLayoutVertexArray,l,y);p.emplaceBack(z,z+1,z+2);p.emplaceBack(z+1,z+2,z+3);d.vertexLength+=4;d.primitiveLength+=2;this.glyphOffsetArray.emplaceBack(I[0]);if(b===r.length-1||O!==r[b+1].sectionIndex){t.programConfigurations.populatePaintArrays(v.length,o,o.index,{},h,x&&x[O])}}t.placedSymbolArray.emplaceBack(l.x,l.y,m,this.glyphOffsetArray.length-m,g,u,c,l.segment,a?a[0]:0,a?a[1]:0,n[0],n[1],s,0,false,0,f)};lv.prototype._addCollisionDebugVertex=function e(t,r,a,n,i,o){r.emplaceBack(0,0);return t.emplaceBack(a.x,a.y,n,i,Math.round(o.x),Math.round(o.y))};lv.prototype.addCollisionDebugVertices=function e(t,r,a,n,o,s,l){var u=o.segments.prepareSegment(4,o.layoutVertexArray,o.indexArray);var c=u.vertexLength;var f=o.layoutVertexArray;var h=o.collisionVertexArray;var p=l.anchorX;var v=l.anchorY;this._addCollisionDebugVertex(f,h,s,p,v,new i(t,r));this._addCollisionDebugVertex(f,h,s,p,v,new i(a,r));this._addCollisionDebugVertex(f,h,s,p,v,new i(a,n));this._addCollisionDebugVertex(f,h,s,p,v,new i(t,n));u.vertexLength+=4;var d=o.indexArray;d.emplaceBack(c,c+1);d.emplaceBack(c+1,c+2);d.emplaceBack(c+2,c+3);d.emplaceBack(c+3,c);u.primitiveLength+=4};lv.prototype.addDebugCollisionBoxes=function e(t,r,a,n){for(var i=t;i<r;i++){var o=this.collisionBoxArray.get(i);var s=o.x1;var l=o.y1;var u=o.x2;var c=o.y2;this.addCollisionDebugVertices(s,l,u,c,n?this.textCollisionBox:this.iconCollisionBox,o.anchorPoint,a)}};lv.prototype.generateCollisionDebugBuffers=function e(){if(this.hasDebugData()){this.destroyDebugData()}this.textCollisionBox=new sv(vs,Hf.members,Ts);this.iconCollisionBox=new sv(vs,Hf.members,Ts);for(var t=0;t<this.symbolInstances.length;t++){var r=this.symbolInstances.get(t);this.addDebugCollisionBoxes(r.textBoxStartIndex,r.textBoxEndIndex,r,true);this.addDebugCollisionBoxes(r.verticalTextBoxStartIndex,r.verticalTextBoxEndIndex,r,true);this.addDebugCollisionBoxes(r.iconBoxStartIndex,r.iconBoxEndIndex,r,false);this.addDebugCollisionBoxes(r.verticalIconBoxStartIndex,r.verticalIconBoxEndIndex,r,false)}};lv.prototype._deserializeCollisionBoxesForSymbol=function e(t,r,a,n,i,o,s,l,u){var c={};for(var f=r;f<a;f++){var h=t.get(f);c.textBox={x1:h.x1,y1:h.y1,x2:h.x2,y2:h.y2,anchorPointX:h.anchorPointX,anchorPointY:h.anchorPointY};c.textFeatureIndex=h.featureIndex;break}for(var p=n;p<i;p++){var v=t.get(p);c.verticalTextBox={x1:v.x1,y1:v.y1,x2:v.x2,y2:v.y2,anchorPointX:v.anchorPointX,anchorPointY:v.anchorPointY};c.verticalTextFeatureIndex=v.featureIndex;break}for(var d=o;d<s;d++){var m=t.get(d);c.iconBox={x1:m.x1,y1:m.y1,x2:m.x2,y2:m.y2,anchorPointX:m.anchorPointX,anchorPointY:m.anchorPointY};c.iconFeatureIndex=m.featureIndex;break}for(var g=l;g<u;g++){var y=t.get(g);c.verticalIconBox={x1:y.x1,y1:y.y1,x2:y.x2,y2:y.y2,anchorPointX:y.anchorPointX,anchorPointY:y.anchorPointY};c.verticalIconFeatureIndex=y.featureIndex;break}return c};lv.prototype.deserializeCollisionBoxes=function e(t){this.collisionArrays=[];for(var r=0;r<this.symbolInstances.length;r++){var a=this.symbolInstances.get(r);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,a.textBoxStartIndex,a.textBoxEndIndex,a.verticalTextBoxStartIndex,a.verticalTextBoxEndIndex,a.iconBoxStartIndex,a.iconBoxEndIndex,a.verticalIconBoxStartIndex,a.verticalIconBoxEndIndex))}};lv.prototype.hasTextData=function e(){return this.text.segments.get().length>0};lv.prototype.hasIconData=function e(){return this.icon.segments.get().length>0};lv.prototype.hasDebugData=function e(){return this.textCollisionBox&&this.iconCollisionBox};lv.prototype.hasTextCollisionBoxData=function e(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0};lv.prototype.hasIconCollisionBoxData=function e(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0};lv.prototype.addIndicesForPlacedSymbol=function e(t,r){var a=t.placedSymbolArray.get(r);var n=a.vertexStartIndex+a.numGlyphs*4;for(var i=a.vertexStartIndex;i<n;i+=4){t.indexArray.emplaceBack(i,i+1,i+2);t.indexArray.emplaceBack(i+1,i+2,i+3)}};lv.prototype.getSortedSymbolIndexes=function e(t){if(this.sortedAngle===t&&this.symbolInstanceIndexes!==undefined){return this.symbolInstanceIndexes}var r=Math.sin(t);var a=Math.cos(t);var n=[];var i=[];var o=[];for(var s=0;s<this.symbolInstances.length;++s){o.push(s);var l=this.symbolInstances.get(s);n.push(Math.round(r*l.anchorX+a*l.anchorY)|0);i.push(l.featureIndex)}o.sort((function(e,t){return n[e]-n[t]||i[t]-i[e]}));return o};lv.prototype.addToSortKeyRanges=function e(t,r){var a=this.sortKeyRanges[this.sortKeyRanges.length-1];if(a&&a.sortKey===r){a.symbolInstanceEnd=t+1}else{this.sortKeyRanges.push({sortKey:r,symbolInstanceStart:t,symbolInstanceEnd:t+1})}};lv.prototype.sortFeatures=function e(t){var r=this;if(!this.sortFeaturesByY){return}if(this.sortedAngle===t){return}if(this.text.segments.get().length>1||this.icon.segments.get().length>1){return}this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t);this.sortedAngle=t;this.text.indexArray.clear();this.icon.indexArray.clear();this.featureSortOrder=[];for(var a=0,n=this.symbolInstanceIndexes;a<n.length;a+=1){var i=n[a];var o=this.symbolInstances.get(i);this.featureSortOrder.push(o.featureIndex);[o.rightJustifiedTextSymbolIndex,o.centerJustifiedTextSymbolIndex,o.leftJustifiedTextSymbolIndex].forEach((function(e,t,a){if(e>=0&&a.indexOf(e)===t){r.addIndicesForPlacedSymbol(r.text,e)}}));if(o.verticalPlacedTextSymbolIndex>=0){this.addIndicesForPlacedSymbol(this.text,o.verticalPlacedTextSymbolIndex)}if(o.placedIconSymbolIndex>=0){this.addIndicesForPlacedSymbol(this.icon,o.placedIconSymbolIndex)}if(o.verticalPlacedIconSymbolIndex>=0){this.addIndicesForPlacedSymbol(this.icon,o.verticalPlacedIconSymbolIndex)}}if(this.text.indexBuffer){this.text.indexBuffer.updateData(this.text.indexArray)}if(this.icon.indexBuffer){this.icon.indexBuffer.updateData(this.icon.indexArray)}};eo("SymbolBucket",lv,{omit:["layers","collisionBoxArray","features","compareText"]});lv.MAX_GLYPHS=65535;lv.addDynamicAttributes=nv;function uv(e,t){return t.replace(/{([^{}]+)}/g,(function(t,r){return r in e?String(e[r]):""}))}var cv=new Xo({"symbol-placement":new Ho(Wt["layout_symbol"]["symbol-placement"]),"symbol-spacing":new Ho(Wt["layout_symbol"]["symbol-spacing"]),"symbol-avoid-edges":new Ho(Wt["layout_symbol"]["symbol-avoid-edges"]),"symbol-sort-key":new qo(Wt["layout_symbol"]["symbol-sort-key"]),"symbol-z-order":new Ho(Wt["layout_symbol"]["symbol-z-order"]),"icon-allow-overlap":new Ho(Wt["layout_symbol"]["icon-allow-overlap"]),"icon-ignore-placement":new Ho(Wt["layout_symbol"]["icon-ignore-placement"]),"icon-optional":new Ho(Wt["layout_symbol"]["icon-optional"]),"icon-rotation-alignment":new Ho(Wt["layout_symbol"]["icon-rotation-alignment"]),"icon-size":new qo(Wt["layout_symbol"]["icon-size"]),"icon-text-fit":new Ho(Wt["layout_symbol"]["icon-text-fit"]),"icon-text-fit-padding":new Ho(Wt["layout_symbol"]["icon-text-fit-padding"]),"icon-image":new qo(Wt["layout_symbol"]["icon-image"]),"icon-rotate":new qo(Wt["layout_symbol"]["icon-rotate"]),"icon-padding":new Ho(Wt["layout_symbol"]["icon-padding"]),"icon-keep-upright":new Ho(Wt["layout_symbol"]["icon-keep-upright"]),"icon-offset":new qo(Wt["layout_symbol"]["icon-offset"]),"icon-anchor":new qo(Wt["layout_symbol"]["icon-anchor"]),"icon-pitch-alignment":new Ho(Wt["layout_symbol"]["icon-pitch-alignment"]),"text-pitch-alignment":new Ho(Wt["layout_symbol"]["text-pitch-alignment"]),"text-rotation-alignment":new Ho(Wt["layout_symbol"]["text-rotation-alignment"]),"text-field":new qo(Wt["layout_symbol"]["text-field"]),"text-font":new qo(Wt["layout_symbol"]["text-font"]),"text-size":new qo(Wt["layout_symbol"]["text-size"]),"text-max-width":new qo(Wt["layout_symbol"]["text-max-width"]),"text-line-height":new Ho(Wt["layout_symbol"]["text-line-height"]),"text-letter-spacing":new qo(Wt["layout_symbol"]["text-letter-spacing"]),"text-justify":new qo(Wt["layout_symbol"]["text-justify"]),"text-radial-offset":new qo(Wt["layout_symbol"]["text-radial-offset"]),"text-variable-anchor":new Ho(Wt["layout_symbol"]["text-variable-anchor"]),"text-anchor":new qo(Wt["layout_symbol"]["text-anchor"]),"text-max-angle":new Ho(Wt["layout_symbol"]["text-max-angle"]),"text-writing-mode":new Ho(Wt["layout_symbol"]["text-writing-mode"]),"text-rotate":new qo(Wt["layout_symbol"]["text-rotate"]),"text-padding":new Ho(Wt["layout_symbol"]["text-padding"]),"text-keep-upright":new Ho(Wt["layout_symbol"]["text-keep-upright"]),"text-transform":new qo(Wt["layout_symbol"]["text-transform"]),"text-offset":new qo(Wt["layout_symbol"]["text-offset"]),"text-allow-overlap":new Ho(Wt["layout_symbol"]["text-allow-overlap"]),"text-ignore-placement":new Ho(Wt["layout_symbol"]["text-ignore-placement"]),"text-optional":new Ho(Wt["layout_symbol"]["text-optional"])});var fv=new Xo({"icon-opacity":new qo(Wt["paint_symbol"]["icon-opacity"]),"icon-color":new qo(Wt["paint_symbol"]["icon-color"]),"icon-halo-color":new qo(Wt["paint_symbol"]["icon-halo-color"]),"icon-halo-width":new qo(Wt["paint_symbol"]["icon-halo-width"]),"icon-halo-blur":new qo(Wt["paint_symbol"]["icon-halo-blur"]),"icon-translate":new Ho(Wt["paint_symbol"]["icon-translate"]),"icon-translate-anchor":new Ho(Wt["paint_symbol"]["icon-translate-anchor"]),"text-opacity":new qo(Wt["paint_symbol"]["text-opacity"]),"text-color":new qo(Wt["paint_symbol"]["text-color"],{runtimeType:ir,getOverride:function(e){return e.textColor},hasOverride:function(e){return!!e.textColor}}),"text-halo-color":new qo(Wt["paint_symbol"]["text-halo-color"]),"text-halo-width":new qo(Wt["paint_symbol"]["text-halo-width"]),"text-halo-blur":new qo(Wt["paint_symbol"]["text-halo-blur"]),"text-translate":new Ho(Wt["paint_symbol"]["text-translate"]),"text-translate-anchor":new Ho(Wt["paint_symbol"]["text-translate-anchor"])});var hv={paint:fv,layout:cv};var pv=function e(t){this.type=t.property.overrides?t.property.overrides.runtimeType:tr;this.defaultValue=t};pv.prototype.evaluate=function e(t){if(t.formattedSection){var r=this.defaultValue.property.overrides;if(r&&r.hasOverride(t.formattedSection)){return r.getOverride(t.formattedSection)}}if(t.feature&&t.featureState){return this.defaultValue.evaluate(t.feature,t.featureState)}return this.defaultValue.property.specification.default};pv.prototype.eachChild=function e(t){if(!this.defaultValue.isConstant()){var r=this.defaultValue.value;t(r._styleExpression.expression)}};pv.prototype.outputDefined=function e(){return false};pv.prototype.serialize=function e(){return null};eo("FormatSectionOverride",pv,{omit:["defaultValue"]});var vv=function(e){function t(t){e.call(this,t,hv)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype.recalculate=function t(r,a){e.prototype.recalculate.call(this,r,a);if(this.layout.get("icon-rotation-alignment")==="auto"){if(this.layout.get("symbol-placement")!=="point"){this.layout._values["icon-rotation-alignment"]="map"}else{this.layout._values["icon-rotation-alignment"]="viewport"}}if(this.layout.get("text-rotation-alignment")==="auto"){if(this.layout.get("symbol-placement")!=="point"){this.layout._values["text-rotation-alignment"]="map"}else{this.layout._values["text-rotation-alignment"]="viewport"}}if(this.layout.get("text-pitch-alignment")==="auto"){this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")}if(this.layout.get("icon-pitch-alignment")==="auto"){this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")}if(this.layout.get("symbol-placement")==="point"){var n=this.layout.get("text-writing-mode");if(n){var i=[];for(var o=0,s=n;o<s.length;o+=1){var l=s[o];if(i.indexOf(l)<0){i.push(l)}}this.layout._values["text-writing-mode"]=i}else{this.layout._values["text-writing-mode"]=["horizontal"]}}this._setPaintOverrides()};t.prototype.getValueAndResolveTokens=function e(t,r,a,n){var i=this.layout.get(t).evaluate(r,{},a,n);var o=this._unevaluatedLayout._values[t];if(!o.isDataDriven()&&!Zn(o.value)&&i){return uv(r.properties,i)}return i};t.prototype.createBucket=function e(t){return new lv(t)};t.prototype.queryRadius=function e(){return 0};t.prototype.queryIntersectsFeature=function e(){return false};t.prototype._setPaintOverrides=function e(){for(var r=0,a=hv.paint.overridableProperties;r<a.length;r+=1){var n=a[r];if(!t.hasPaintOverride(this.layout,n)){continue}var i=this.paint.get(n);var o=new pv(i);var s=new Xn(o,i.property.specification);var l=null;if(i.value.kind==="constant"||i.value.kind==="source"){l=new Kn("source",s)}else{l=new Qn("composite",s,i.value.zoomStops,i.value._interpolationType)}this.paint._values[n]=new Uo(i.property,l,i.parameters)}};t.prototype._handleOverridablePaintPropertyUpdate=function e(r,a,n){if(!this.layout||a.isDataDriven()||n.isDataDriven()){return false}return t.hasPaintOverride(this.layout,r)};t.hasPaintOverride=function e(t,r){var a=t.get("text-field");var n=hv.paint.properties[r];var i=false;var o=function(e){for(var t=0,r=e;t<r.length;t+=1){var a=r[t];if(n.overrides&&n.overrides.hasOverride(a)){i=true;return}}};if(a.value.kind==="constant"&&a.value.value instanceof Tr){o(a.value.value.sections)}else if(a.value.kind==="source"){var s=function(e){if(i){return}if(e instanceof Lr&&Sr(e.value)===cr){var t=e.value;o(t.sections)}else if(e instanceof Or){o(e.sections)}else{e.eachChild(s)}};var l=a.value;if(l._styleExpression){s(l._styleExpression.expression)}}return i};return t}(Jo);var dv=new Xo({"background-color":new Ho(Wt["paint_background"]["background-color"]),"background-pattern":new Yo(Wt["paint_background"]["background-pattern"]),"background-opacity":new Ho(Wt["paint_background"]["background-opacity"])});var mv={paint:dv};var gv=function(e){function t(t){e.call(this,t,mv)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;return t}(Jo);var yv=new Xo({"raster-opacity":new Ho(Wt["paint_raster"]["raster-opacity"]),"raster-hue-rotate":new Ho(Wt["paint_raster"]["raster-hue-rotate"]),"raster-brightness-min":new Ho(Wt["paint_raster"]["raster-brightness-min"]),"raster-brightness-max":new Ho(Wt["paint_raster"]["raster-brightness-max"]),"raster-saturation":new Ho(Wt["paint_raster"]["raster-saturation"]),"raster-contrast":new Ho(Wt["paint_raster"]["raster-contrast"]),"raster-resampling":new Ho(Wt["paint_raster"]["raster-resampling"]),"raster-fade-duration":new Ho(Wt["paint_raster"]["raster-fade-duration"])});var xv={paint:yv};var bv=function(e){function t(t){e.call(this,t,xv)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;return t}(Jo);function _v(e){var t=[];var r=e.id;if(r===undefined){t.push({message:"layers."+r+': missing required property "id"'})}if(e.render===undefined){t.push({message:"layers."+r+': missing required method "render"'})}if(e.renderingMode&&e.renderingMode!=="2d"&&e.renderingMode!=="3d"){t.push({message:"layers."+r+': property "renderingMode" must be either "2d" or "3d"'})}return t}var wv=function(e){function t(t){e.call(this,t,{});this.implementation=t}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype.is3D=function e(){return this.implementation.renderingMode==="3d"};t.prototype.hasOffscreenPass=function e(){return this.implementation.prerender!==undefined};t.prototype.recalculate=function e(){};t.prototype.updateTransitions=function e(){};t.prototype.hasTransition=function e(){};t.prototype.serialize=function e(){};t.prototype.onAdd=function e(t){if(this.implementation.onAdd){this.implementation.onAdd(t,t.painter.context.gl)}};t.prototype.onRemove=function e(t){if(this.implementation.onRemove){this.implementation.onRemove(t,t.painter.context.gl)}};return t}(Jo);var Tv={circle:Au,heatmap:Bu,hillshade:Uu,fill:Fc,"fill-extrusion":pf,line:Df,symbol:vv,background:gv,raster:bv};function kv(e){if(e.type==="custom"){return new wv(e)}else{return new Tv[e.type](e)}}var Mv=self.HTMLImageElement;var Av=self.HTMLCanvasElement;var Sv=self.HTMLVideoElement;var Ev=self.ImageData;var Lv=self.ImageBitmap;var Cv=function e(t,r,a,n){this.context=t;this.format=a;this.texture=t.gl.createTexture();this.update(r,n)};Cv.prototype.update=function e(t,r,a){var n=t.width;var i=t.height;var o=(!this.size||this.size[0]!==n||this.size[1]!==i)&&!a;var s=this;var l=s.context;var u=l.gl;this.useMipmap=Boolean(r&&r.useMipmap);u.bindTexture(u.TEXTURE_2D,this.texture);l.pixelStoreUnpackFlipY.set(false);l.pixelStoreUnpack.set(1);l.pixelStoreUnpackPremultiplyAlpha.set(this.format===u.RGBA&&(!r||r.premultiply!==false));if(o){this.size=[n,i];if(t instanceof Mv||t instanceof Av||t instanceof Sv||t instanceof Ev||Lv&&t instanceof Lv){u.texImage2D(u.TEXTURE_2D,0,this.format,this.format,u.UNSIGNED_BYTE,t)}else{u.texImage2D(u.TEXTURE_2D,0,this.format,n,i,0,this.format,u.UNSIGNED_BYTE,t.data)}}else{var c=a||{x:0,y:0};var f=c.x;var h=c.y;if(t instanceof Mv||t instanceof Av||t instanceof Sv||t instanceof Ev||Lv&&t instanceof Lv){u.texSubImage2D(u.TEXTURE_2D,0,f,h,u.RGBA,u.UNSIGNED_BYTE,t)}else{u.texSubImage2D(u.TEXTURE_2D,0,f,h,n,i,u.RGBA,u.UNSIGNED_BYTE,t.data)}}if(this.useMipmap&&this.isSizePowerOfTwo()){u.generateMipmap(u.TEXTURE_2D)}};Cv.prototype.bind=function e(t,r,a){var n=this;var i=n.context;var o=i.gl;o.bindTexture(o.TEXTURE_2D,this.texture);if(a===o.LINEAR_MIPMAP_NEAREST&&!this.isSizePowerOfTwo()){a=o.LINEAR}if(t!==this.filter){o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,t);o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,a||t);this.filter=t}if(r!==this.wrap){o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,r);o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,r);this.wrap=r}};Cv.prototype.isSizePowerOfTwo=function e(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1===0};Cv.prototype.destroy=function e(){var t=this.context;var r=t.gl;r.deleteTexture(this.texture);this.texture=null};var Iv=function e(t){var r=this;this._callback=t;this._triggered=false;if(typeof MessageChannel!=="undefined"){this._channel=new MessageChannel;this._channel.port2.onmessage=function(){r._triggered=false;r._callback()}}};Iv.prototype.trigger=function e(){var t=this;if(!this._triggered){this._triggered=true;if(this._channel){this._channel.port1.postMessage(true)}else{setTimeout((function(){t._triggered=false;t._callback()}),0)}}};Iv.prototype.remove=function e(){delete this._channel;this._callback=function(){}};var Pv=function e(t,r,a){this.target=t;this.parent=r;this.mapId=a;this.callbacks={};this.tasks={};this.taskQueue=[];this.cancelCallbacks={};w(["receive","process"],this);this.invoker=new Iv(this.process);this.target.addEventListener("message",this.receive,false);this.globalScope=O()?t:self};Pv.prototype.send=function e(t,r,a,n,i){var o=this;if(i===void 0)i=false;var s=Math.round(Math.random()*1e18).toString(36).substring(0,10);if(a){this.callbacks[s]=a}var l=R(this.globalScope)?undefined:[];this.target.postMessage({id:s,type:t,hasCallback:!!a,targetMapId:n,mustQueue:i,sourceMapId:this.mapId,data:no(r,l)},l);return{cancel:function(){if(a){delete o.callbacks[s]}o.target.postMessage({id:s,type:"<cancel>",targetMapId:n,sourceMapId:o.mapId})}}};Pv.prototype.receive=function e(t){var r=t.data,a=r.id;if(!a){return}if(r.targetMapId&&this.mapId!==r.targetMapId){return}if(r.type==="<cancel>"){delete this.tasks[a];var n=this.cancelCallbacks[a];delete this.cancelCallbacks[a];if(n){n()}}else{if(O()||r.mustQueue){this.tasks[a]=r;this.taskQueue.push(a);this.invoker.trigger()}else{this.processTask(a,r)}}};Pv.prototype.process=function e(){if(!this.taskQueue.length){return}var t=this.taskQueue.shift();var r=this.tasks[t];delete this.tasks[t];if(this.taskQueue.length){this.invoker.trigger()}if(!r){return}this.processTask(t,r)};Pv.prototype.processTask=function e(t,r){var a=this;if(r.type==="<response>"){var n=this.callbacks[t];delete this.callbacks[t];if(n){if(r.error){n(io(r.error))}else{n(null,io(r.data))}}}else{var i=false;var o=R(this.globalScope)?undefined:[];var s=r.hasCallback?function(e,r){i=true;delete a.cancelCallbacks[t];a.target.postMessage({id:t,type:"<response>",sourceMapId:a.mapId,error:e?no(e):null,data:no(r,o)},o)}:function(e){i=true};var l=null;var u=io(r.data);if(this.parent[r.type]){l=this.parent[r.type](r.sourceMapId,u,s)}else if(this.parent.getWorkerSource){var c=r.type.split(".");var f=this.parent.getWorkerSource(r.sourceMapId,c[0],u.source);l=f[c[1]](u,s)}else{s(new Error("Could not find function "+r.type))}if(!i&&l&&l.cancel){this.cancelCallbacks[t]=l.cancel}}};Pv.prototype.remove=function e(){this.invoker.remove();this.target.removeEventListener("message",this.receive,false)};function Ov(e,t,r){t=Math.pow(2,r)-t-1;var a=zv(e*256,t*256,r),n=zv((e+1)*256,(t+1)*256,r);return a[0]+","+a[1]+","+n[0]+","+n[1]}function zv(e,t,r){var a=2*Math.PI*6378137/256/Math.pow(2,r),n=e*a-2*Math.PI*6378137/2,i=t*a-2*Math.PI*6378137/2;return[n,i]}var Dv=function e(t,r){if(!t);else if(r){this.setSouthWest(t).setNorthEast(r)}else if(t.length===4){this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]])}else{this.setSouthWest(t[0]).setNorthEast(t[1])}};Dv.prototype.setNorthEast=function e(t){this._ne=t instanceof Fv?new Fv(t.lng,t.lat):Fv.convert(t);return this};Dv.prototype.setSouthWest=function e(t){this._sw=t instanceof Fv?new Fv(t.lng,t.lat):Fv.convert(t);return this};Dv.prototype.extend=function e(t){var r=this._sw,a=this._ne;var n,i;if(t instanceof Fv){n=t;i=t}else if(t instanceof Dv){n=t._sw;i=t._ne;if(!n||!i){return this}}else{if(Array.isArray(t)){if(t.length===4||t.every(Array.isArray)){var o=t;return this.extend(Dv.convert(o))}else{var s=t;return this.extend(Fv.convert(s))}}return this}if(!r&&!a){this._sw=new Fv(n.lng,n.lat);this._ne=new Fv(i.lng,i.lat)}else{r.lng=Math.min(n.lng,r.lng);r.lat=Math.min(n.lat,r.lat);a.lng=Math.max(i.lng,a.lng);a.lat=Math.max(i.lat,a.lat)}return this};Dv.prototype.getCenter=function e(){return new Fv((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)};Dv.prototype.getSouthWest=function e(){return this._sw};Dv.prototype.getNorthEast=function e(){return this._ne};Dv.prototype.getNorthWest=function e(){return new Fv(this.getWest(),this.getNorth())};Dv.prototype.getSouthEast=function e(){return new Fv(this.getEast(),this.getSouth())};Dv.prototype.getWest=function e(){return this._sw.lng};Dv.prototype.getSouth=function e(){return this._sw.lat};Dv.prototype.getEast=function e(){return this._ne.lng};Dv.prototype.getNorth=function e(){return this._ne.lat};Dv.prototype.toArray=function e(){return[this._sw.toArray(),this._ne.toArray()]};Dv.prototype.toString=function e(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"};Dv.prototype.isEmpty=function e(){return!(this._sw&&this._ne)};Dv.prototype.contains=function e(t){var r=Fv.convert(t);var a=r.lng;var n=r.lat;var i=this._sw.lat<=n&&n<=this._ne.lat;var o=this._sw.lng<=a&&a<=this._ne.lng;if(this._sw.lng>this._ne.lng){o=this._sw.lng>=a&&a>=this._ne.lng}return i&&o};Dv.convert=function e(t){if(!t||t instanceof Dv){return t}return new Dv(t)};var Rv=6371008.8;var Fv=function e(t,r){if(isNaN(t)||isNaN(r)){throw new Error("Invalid LngLat object: ("+t+", "+r+")")}this.lng=+t;this.lat=+r;if(this.lat>90||this.lat<-90){throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}};Fv.prototype.wrap=function e(){return new Fv(h(this.lng,-180,180),this.lat)};Fv.prototype.toArray=function e(){return[this.lng,this.lat]};Fv.prototype.toString=function e(){return"LngLat("+this.lng+", "+this.lat+")"};Fv.prototype.distanceTo=function e(t){var r=Math.PI/180;var a=this.lat*r;var n=t.lat*r;var i=Math.sin(a)*Math.sin(n)+Math.cos(a)*Math.cos(n)*Math.cos((t.lng-this.lng)*r);var o=Rv*Math.acos(Math.min(i,1));return o};Fv.prototype.toBounds=function e(t){if(t===void 0)t=0;var r=40075017;var a=360*t/r,n=a/Math.cos(Math.PI/180*this.lat);return new Dv(new Fv(this.lng-n,this.lat-a),new Fv(this.lng+n,this.lat+a))};Fv.convert=function e(t){if(t instanceof Fv){return t}if(Array.isArray(t)&&(t.length===2||t.length===3)){return new Fv(Number(t[0]),Number(t[1]))}if(!Array.isArray(t)&&typeof t==="object"&&t!==null){return new Fv(Number("lng"in t?t.lng:t.lon),Number(t.lat))}throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var Bv=2*Math.PI*Rv;function Nv(e){return Bv*Math.cos(e*Math.PI/180)}function jv(e){return(180+e)/360}function Uv(e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360}function Vv(e,t){return e/Nv(t)}function Hv(e){return e*360-180}function qv(e){var t=180-e*360;return 360/Math.PI*Math.atan(Math.exp(t*Math.PI/180))-90}function Gv(e,t){return e*Nv(qv(t))}function Yv(e){return 1/Math.cos(e*Math.PI/180)}var Wv=function e(t,r,a){if(a===void 0)a=0;this.x=+t;this.y=+r;this.z=+a};Wv.fromLngLat=function e(t,r){if(r===void 0)r=0;var a=Fv.convert(t);return new Wv(jv(a.lng),Uv(a.lat),Vv(r,a.lat))};Wv.prototype.toLngLat=function e(){return new Fv(Hv(this.x),qv(this.y))};Wv.prototype.toAltitude=function e(){return Gv(this.z,this.y)};Wv.prototype.meterInMercatorCoordinateUnits=function e(){return 1/Bv*Yv(qv(this.y))};var Xv=function e(t,r,a){this.z=t;this.x=r;this.y=a;this.key=Kv(0,t,t,r,a)};Xv.prototype.equals=function e(t){return this.z===t.z&&this.x===t.x&&this.y===t.y};Xv.prototype.url=function e(t,r){var a=Ov(this.x,this.y,this.z);var n=Qv(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String(r==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",n).replace("{bbox-epsg-3857}",a)};Xv.prototype.getTilePoint=function e(t){var r=Math.pow(2,this.z);return new i((t.x*r-this.x)*yl,(t.y*r-this.y)*yl)};Xv.prototype.toString=function e(){return this.z+"/"+this.x+"/"+this.y};var Zv=function e(t,r){this.wrap=t;this.canonical=r;this.key=Kv(t,r.z,r.z,r.x,r.y)};var Jv=function e(t,r,a,n,i){this.overscaledZ=t;this.wrap=r;this.canonical=new Xv(a,+n,+i);this.key=Kv(r,t,a,n,i)};Jv.prototype.equals=function e(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)};Jv.prototype.scaledTo=function e(t){var r=this.canonical.z-t;if(t>this.canonical.z){return new Jv(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}else{return new Jv(t,this.wrap,t,this.canonical.x>>r,this.canonical.y>>r)}};Jv.prototype.calculateScaledKey=function e(t,r){var a=this.canonical.z-t;if(t>this.canonical.z){return Kv(this.wrap*+r,t,this.canonical.z,this.canonical.x,this.canonical.y)}else{return Kv(this.wrap*+r,t,t,this.canonical.x>>a,this.canonical.y>>a)}};Jv.prototype.isChildOf=function e(t){if(t.wrap!==this.wrap){return false}var r=this.canonical.z-t.canonical.z;return t.overscaledZ===0||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>r&&t.canonical.y===this.canonical.y>>r};Jv.prototype.children=function e(t){if(this.overscaledZ>=t){return[new Jv(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)]}var r=this.canonical.z+1;var a=this.canonical.x*2;var n=this.canonical.y*2;return[new Jv(r,this.wrap,r,a,n),new Jv(r,this.wrap,r,a+1,n),new Jv(r,this.wrap,r,a,n+1),new Jv(r,this.wrap,r,a+1,n+1)]};Jv.prototype.isLessThan=function e(t){if(this.wrap<t.wrap){return true}if(this.wrap>t.wrap){return false}if(this.overscaledZ<t.overscaledZ){return true}if(this.overscaledZ>t.overscaledZ){return false}if(this.canonical.x<t.canonical.x){return true}if(this.canonical.x>t.canonical.x){return false}if(this.canonical.y<t.canonical.y){return true}return false};Jv.prototype.wrapped=function e(){return new Jv(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)};Jv.prototype.unwrapTo=function e(t){return new Jv(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)};Jv.prototype.overscaleFactor=function e(){return Math.pow(2,this.overscaledZ-this.canonical.z)};Jv.prototype.toUnwrapped=function e(){return new Zv(this.wrap,this.canonical)};Jv.prototype.toString=function e(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y};Jv.prototype.getTilePoint=function e(t){return this.canonical.getTilePoint(new Wv(t.x-this.wrap,t.y))};function Kv(e,t,r,a,n){e*=2;if(e<0){e=e*-1-1}var i=1<<r;return(i*i*e+i*n+a).toString(36)+r.toString(36)+t.toString(36)}function Qv(e,t,r){var a="",n;for(var i=e;i>0;i--){n=1<<i-1;a+=(t&n?1:0)+(r&n?2:0)}return a}eo("CanonicalTileID",Xv);eo("OverscaledTileID",Jv,{omit:["posMatrix"]});var $v=function e(t,r,a){this.uid=t;if(r.height!==r.width){throw new RangeError("DEM tiles must be square")}if(a&&a!=="mapbox"&&a!=="terrarium"){return L('"'+a+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".')}this.stride=r.height;var n=this.dim=r.height-2;this.data=new Uint32Array(r.data.buffer);this.encoding=a||"mapbox";for(var i=0;i<n;i++){this.data[this._idx(-1,i)]=this.data[this._idx(0,i)];this.data[this._idx(n,i)]=this.data[this._idx(n-1,i)];this.data[this._idx(i,-1)]=this.data[this._idx(i,0)];this.data[this._idx(i,n)]=this.data[this._idx(i,n-1)]}this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)];this.data[this._idx(n,-1)]=this.data[this._idx(n-1,0)];this.data[this._idx(-1,n)]=this.data[this._idx(0,n-1)];this.data[this._idx(n,n)]=this.data[this._idx(n-1,n-1)]};$v.prototype.get=function e(t,r){var a=new Uint8Array(this.data.buffer);var n=this._idx(t,r)*4;var i=this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox;return i(a[n],a[n+1],a[n+2])};$v.prototype.getUnpackVector=function e(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]};$v.prototype._idx=function e(t,r){if(t<-1||t>=this.dim+1||r<-1||r>=this.dim+1){throw new RangeError("out of range source coordinates for DEM data")}return(r+1)*this.stride+(t+1)};$v.prototype._unpackMapbox=function e(t,r,a){return(t*256*256+r*256+a)/10-1e4};$v.prototype._unpackTerrarium=function e(t,r,a){return t*256+r+a/256-32768};$v.prototype.getPixels=function e(){return new zu({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))};$v.prototype.backfillBorder=function e(t,r,a){if(this.dim!==t.dim){throw new Error("dem dimension mismatch")}var n=r*this.dim,i=r*this.dim+this.dim,o=a*this.dim,s=a*this.dim+this.dim;switch(r){case-1:n=i-1;break;case 1:i=n+1;break}switch(a){case-1:o=s-1;break;case 1:s=o+1;break}var l=-r*this.dim;var u=-a*this.dim;for(var c=o;c<s;c++){for(var f=n;f<i;f++){this.data[this._idx(f,c)]=t.data[this._idx(f+l,c+u)]}}};eo("DEMData",$v);function ed(e,t){var r={};if(!t){return r}var a=function(){var e=i[n];var a=e.layerIds.map((function(e){return t.getLayer(e)})).filter(Boolean);if(a.length===0){return}e.layers=a;if(e.stateDependentLayerIds){e.stateDependentLayers=e.stateDependentLayerIds.map((function(e){return a.filter((function(t){return t.id===e}))[0]}))}for(var o=0,s=a;o<s.length;o+=1){var l=s[o];r[l.id]=e}};for(var n=0,i=e;n<i.length;n+=1)a();return r}var td=function e(t){this._stringToNumber={};this._numberToString=[];for(var r=0;r<t.length;r++){var a=t[r];this._stringToNumber[a]=r;this._numberToString[r]=a}};td.prototype.encode=function e(t){return this._stringToNumber[t]};td.prototype.decode=function e(t){return this._numberToString[t]};var rd=function e(t,r,a,n,i){this.type="Feature";this._vectorTileFeature=t;t._z=r;t._x=a;t._y=n;this.properties=t.properties;this.id=i};var ad={geometry:{configurable:true}};ad.geometry.get=function(){if(this._geometry===undefined){this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry}return this._geometry};ad.geometry.set=function(e){this._geometry=e};rd.prototype.toJSON=function e(){var t={geometry:this.geometry};for(var r in this){if(r==="_geometry"||r==="_vectorTileFeature"){continue}t[r]=this[r]}return t};Object.defineProperties(rd.prototype,ad);var nd=function e(){this.state={};this.stateChanges={};this.deletedStates={}};nd.prototype.updateState=function e(t,r,a){var n=String(r);this.stateChanges[t]=this.stateChanges[t]||{};this.stateChanges[t][n]=this.stateChanges[t][n]||{};m(this.stateChanges[t][n],a);if(this.deletedStates[t]===null){this.deletedStates[t]={};for(var i in this.state[t]){if(i!==n){this.deletedStates[t][i]=null}}}else{var o=this.deletedStates[t]&&this.deletedStates[t][n]===null;if(o){this.deletedStates[t][n]={};for(var s in this.state[t][n]){if(!a[s]){this.deletedStates[t][n][s]=null}}}else{for(var l in a){var u=this.deletedStates[t]&&this.deletedStates[t][n]&&this.deletedStates[t][n][l]===null;if(u){delete this.deletedStates[t][n][l]}}}}};nd.prototype.removeFeatureState=function e(t,r,a){var n=this.deletedStates[t]===null;if(n){return}var i=String(r);this.deletedStates[t]=this.deletedStates[t]||{};if(a&&r!==undefined){if(this.deletedStates[t][i]!==null){this.deletedStates[t][i]=this.deletedStates[t][i]||{};this.deletedStates[t][i][a]=null}}else if(r!==undefined){var o=this.stateChanges[t]&&this.stateChanges[t][i];if(o){this.deletedStates[t][i]={};for(a in this.stateChanges[t][i]){this.deletedStates[t][i][a]=null}}else{this.deletedStates[t][i]=null}}else{this.deletedStates[t]=null}};nd.prototype.getState=function e(t,r){var a=String(r);var n=this.state[t]||{};var i=this.stateChanges[t]||{};var o=m({},n[a],i[a]);if(this.deletedStates[t]===null){return{}}else if(this.deletedStates[t]){var s=this.deletedStates[t][r];if(s===null){return{}}for(var l in s){delete o[l]}}return o};nd.prototype.initializeTileState=function e(t,r){t.setFeatureState(this.state,r)};nd.prototype.coalesceChanges=function e(t,r){var a={};for(var n in this.stateChanges){this.state[n]=this.state[n]||{};var i={};for(var o in this.stateChanges[n]){if(!this.state[n][o]){this.state[n][o]={}}m(this.state[n][o],this.stateChanges[n][o]);i[o]=this.state[n][o]}a[n]=i}for(var s in this.deletedStates){this.state[s]=this.state[s]||{};var l={};if(this.deletedStates[s]===null){for(var u in this.state[s]){l[u]={};this.state[s][u]={}}}else{for(var c in this.deletedStates[s]){var f=this.deletedStates[s][c]===null;if(f){this.state[s][c]={}}else{for(var h=0,p=Object.keys(this.deletedStates[s][c]);h<p.length;h+=1){var v=p[h];delete this.state[s][c][v]}}l[c]=this.state[s][c]}}a[s]=a[s]||{};m(a[s],l)}this.stateChanges={};this.deletedStates={};if(Object.keys(a).length===0){return}for(var d in t){var g=t[d];g.setFeatureState(a,r)}};var id=function e(t,r){this.tileID=t;this.x=t.canonical.x;this.y=t.canonical.y;this.z=t.canonical.z;this.grid=new Xi(yl,16,0);this.grid3D=new Xi(yl,16,0);this.featureIndexArray=new Rs;this.promoteId=r};id.prototype.insert=function e(t,r,a,n,i,o){var s=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(a,n,i);var l=o?this.grid3D:this.grid;for(var u=0;u<r.length;u++){var c=r[u];var f=[Infinity,Infinity,-Infinity,-Infinity];for(var h=0;h<c.length;h++){var p=c[h];f[0]=Math.min(f[0],p.x);f[1]=Math.min(f[1],p.y);f[2]=Math.max(f[2],p.x);f[3]=Math.max(f[3],p.y)}if(f[0]<yl&&f[1]<yl&&f[2]>=0&&f[3]>=0){l.insert(s,f[0],f[1],f[2],f[3])}}};id.prototype.loadVTLayers=function e(){if(!this.vtLayers){this.vtLayers=new rf.VectorTile(new ih(this.rawTileData)).layers;this.sourceLayerCoder=new td(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])}return this.vtLayers};id.prototype.query=function e(t,r,a,n){var i=this;this.loadVTLayers();var o=t.params||{},s=yl/t.tileSize/t.scale,l=di(o.filter);var u=t.queryGeometry;var c=t.queryPadding*s;var f=sd(u);var h=this.grid.query(f.minX-c,f.minY-c,f.maxX+c,f.maxY+c);var p=sd(t.cameraQueryGeometry);var v=this.grid3D.query(p.minX-c,p.minY-c,p.maxX+c,p.maxY+c,(function(e,r,a,n){return Dl(t.cameraQueryGeometry,e-c,r-c,a+c,n+c)}));for(var d=0,m=v;d<m.length;d+=1){var g=m[d];h.push(g)}h.sort(ld);var y={};var x;var b=function(e){var c=h[e];if(c===x){return}x=c;var f=i.featureIndexArray.get(c);var p=null;i.loadMatchingFeature(y,f.bucketIndex,f.sourceLayerIndex,f.featureIndex,l,o.layers,o.availableImages,r,a,n,(function(e,r,a){if(!p){p=_l(e)}return r.queryIntersectsFeature(u,e,a,p,i.z,t.transform,s,t.pixelPosMatrix)}))};for(var _=0;_<h.length;_++)b(_);return y};id.prototype.loadMatchingFeature=function e(t,r,a,n,i,o,s,l,u,c,f){var h=this.bucketLayerIDs[r];if(o&&!S(o,h)){return}var p=this.sourceLayerCoder.decode(a);var v=this.vtLayers[p];var d=v.feature(n);if(!i.filter(new zo(this.tileID.overscaledZ),d)){return}var m=this.getId(d,p);for(var g=0;g<h.length;g++){var y=h[g];if(o&&o.indexOf(y)<0){continue}var x=l[y];if(!x){continue}var b={};if(m!==undefined&&c){b=c.getState(x.sourceLayer||"_geojsonTileLayer",m)}var _=u[y];_.paint=od(_.paint,x.paint,d,b,s);_.layout=od(_.layout,x.layout,d,b,s);var w=!f||f(d,x,b);if(!w){continue}var T=new rd(d,this.z,this.x,this.y,m);T.layer=_;var k=t[y];if(k===undefined){k=t[y]=[]}k.push({featureIndex:n,feature:T,intersectionZ:w})}};id.prototype.lookupSymbolFeatures=function e(t,r,a,n,i,o,s,l){var u={};this.loadVTLayers();var c=di(i);for(var f=0,h=t;f<h.length;f+=1){var p=h[f];this.loadMatchingFeature(u,a,n,p,c,o,s,l,r)}return u};id.prototype.hasLayer=function e(t){for(var r=0,a=this.bucketLayerIDs;r<a.length;r+=1){var n=a[r];for(var i=0,o=n;i<o.length;i+=1){var s=o[i];if(t===s){return true}}}return false};id.prototype.getId=function e(t,r){var a=t.id;if(this.promoteId){var n=typeof this.promoteId==="string"?this.promoteId:this.promoteId[r];a=t.properties[n];if(typeof a==="boolean"){a=Number(a)}}return a};eo("FeatureIndex",id,{omit:["rawTileData","sourceLayerCoder"]});function od(e,t,r,a,n){return k(e,(function(e,i){var o=t instanceof Vo?t.get(i):null;return o&&o.evaluate?o.evaluate(r,a,n):o}))}function sd(e){var t=Infinity;var r=Infinity;var a=-Infinity;var n=-Infinity;for(var i=0,o=e;i<o.length;i+=1){var s=o[i];t=Math.min(t,s.x);r=Math.min(r,s.y);a=Math.max(a,s.x);n=Math.max(n,s.y)}return{minX:t,minY:r,maxX:a,maxY:n}}function ld(e,t){return t-e}var ud=3e4;var cd=function e(t,r){this.tileID=t;this.uid=x();this.uses=0;this.tileSize=r;this.buckets={};this.expirationTime=null;this.queryPadding=0;this.hasSymbolBuckets=false;this.hasRTLText=false;this.dependencies={};this.expiredRequestCount=0;this.state="loading"};cd.prototype.registerFadeDuration=function e(t){var r=t+this.timeAdded;if(r<G.now()){return}if(this.fadeEndTime&&r<this.fadeEndTime){return}this.fadeEndTime=r};cd.prototype.wasRequested=function e(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"};cd.prototype.loadVectorData=function e(t,r,a){if(this.hasData()){this.unloadVectorData()}this.state="loaded";if(!t){this.collisionBoxArray=new Es;return}if(t.featureIndex){this.latestFeatureIndex=t.featureIndex;if(t.rawTileData){this.latestRawTileData=t.rawTileData;this.latestFeatureIndex.rawTileData=t.rawTileData}else if(this.latestRawTileData){this.latestFeatureIndex.rawTileData=this.latestRawTileData}}this.collisionBoxArray=t.collisionBoxArray;this.buckets=ed(t.buckets,r.style);this.hasSymbolBuckets=false;for(var n in this.buckets){var i=this.buckets[n];if(i instanceof lv){this.hasSymbolBuckets=true;if(a){i.justReloaded=true}else{break}}}this.hasRTLText=false;if(this.hasSymbolBuckets){for(var o in this.buckets){var s=this.buckets[o];if(s instanceof lv){if(s.hasRTLText){this.hasRTLText=true;Oo();break}}}}this.queryPadding=0;for(var l in this.buckets){var u=this.buckets[l];this.queryPadding=Math.max(this.queryPadding,r.style.getLayer(l).queryRadius(u))}if(t.imageAtlas){this.imageAtlas=t.imageAtlas}if(t.glyphAtlasImage){this.glyphAtlasImage=t.glyphAtlasImage}};cd.prototype.unloadVectorData=function e(){for(var t in this.buckets){this.buckets[t].destroy()}this.buckets={};if(this.imageAtlasTexture){this.imageAtlasTexture.destroy()}if(this.imageAtlas){this.imageAtlas=null}if(this.glyphAtlasTexture){this.glyphAtlasTexture.destroy()}this.latestFeatureIndex=null;this.state="unloaded"};cd.prototype.getBucket=function e(t){return this.buckets[t.id]};cd.prototype.upload=function e(t){for(var r in this.buckets){var a=this.buckets[r];if(a.uploadPending()){a.upload(t)}}var n=t.gl;if(this.imageAtlas&&!this.imageAtlas.uploaded){this.imageAtlasTexture=new Cv(t,this.imageAtlas.image,n.RGBA);this.imageAtlas.uploaded=true}if(this.glyphAtlasImage){this.glyphAtlasTexture=new Cv(t,this.glyphAtlasImage,n.ALPHA);this.glyphAtlasImage=null}};cd.prototype.prepare=function e(t){if(this.imageAtlas){this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture)}};cd.prototype.queryRenderedFeatures=function e(t,r,a,n,i,o,s,l,u,c){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData){return{}}return this.latestFeatureIndex.query({queryGeometry:n,cameraQueryGeometry:i,scale:o,tileSize:this.tileSize,pixelPosMatrix:c,transform:l,params:s,queryPadding:this.queryPadding*u},t,r,a)};cd.prototype.querySourceFeatures=function e(t,r){var a=this.latestFeatureIndex;if(!a||!a.rawTileData){return}var n=a.loadVTLayers();var i=r?r.sourceLayer:"";var o=n._geojsonTileLayer||n[i];if(!o){return}var s=di(r&&r.filter);var l=this.tileID.canonical;var u=l.z;var c=l.x;var f=l.y;var h={z:u,x:c,y:f};for(var p=0;p<o.length;p++){var v=o.feature(p);if(s.filter(new zo(this.tileID.overscaledZ),v)){var d=a.getId(v,i);var m=new rd(v,u,c,f,d);m.tile=h;t.push(m)}}};cd.prototype.hasData=function e(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"};cd.prototype.patternsLoaded=function e(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length};cd.prototype.setExpiryData=function e(t){var r=this.expirationTime;if(t.cacheControl){var a=z(t.cacheControl);if(a["max-age"]){this.expirationTime=Date.now()+a["max-age"]*1e3}}else if(t.expires){this.expirationTime=new Date(t.expires).getTime()}if(this.expirationTime){var n=Date.now();var i=false;if(this.expirationTime>n){i=false}else if(!r){i=true}else if(this.expirationTime<r){i=true}else{var o=this.expirationTime-r;if(!o){i=true}else{this.expirationTime=n+Math.max(o,ud)}}if(i){this.expiredRequestCount++;this.state="expired"}else{this.expiredRequestCount=0}}};cd.prototype.getExpiryTimeout=function e(){if(this.expirationTime){if(this.expiredRequestCount){return 1e3*(1<<Math.min(this.expiredRequestCount-1,31))}else{return Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}}};cd.prototype.setFeatureState=function e(t,r){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(t).length===0){return}var a=this.latestFeatureIndex.loadVTLayers();for(var n in this.buckets){if(!r.style.hasLayer(n)){continue}var i=this.buckets[n];var o=i.layers[0]["sourceLayer"]||"_geojsonTileLayer";var s=a[o];var l=t[o];if(!s||!l||Object.keys(l).length===0){continue}i.update(l,s,this.imageAtlas&&this.imageAtlas.patternPositions||{});var u=r&&r.style&&r.style.getLayer(n);if(u){this.queryPadding=Math.max(this.queryPadding,u.queryRadius(i))}}};cd.prototype.holdingForFade=function e(){return this.symbolFadeHoldUntil!==undefined};cd.prototype.symbolFadeFinished=function e(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<G.now()};cd.prototype.clearFadeHold=function e(){this.symbolFadeHoldUntil=undefined};cd.prototype.setHoldDuration=function e(t){this.symbolFadeHoldUntil=G.now()+t};cd.prototype.setDependencies=function e(t,r){var a={};for(var n=0,i=r;n<i.length;n+=1){var o=i[n];a[o]=true}this.dependencies[t]=a};cd.prototype.hasDependency=function e(t,r){for(var a=0,n=t;a<n.length;a+=1){var i=n[a];var o=this.dependencies[i];if(o){for(var s=0,l=r;s<l.length;s+=1){var u=l[s];if(o[u]){return true}}}}return false};var fd=["type","source","source-layer","minzoom","maxzoom","filter","layout"];var hd=self.performance;var pd=function e(t){this._marks={start:[t.url,"start"].join("#"),end:[t.url,"end"].join("#"),measure:t.url.toString()};hd.mark(this._marks.start)};pd.prototype.finish=function e(){hd.mark(this._marks.end);var t=hd.getEntriesByName(this._marks.measure);if(t.length===0){hd.measure(this._marks.measure,this._marks.start,this._marks.end);t=hd.getEntriesByName(this._marks.measure);hd.clearMarks(this._marks.start);hd.clearMarks(this._marks.end);hd.clearMeasures(this._marks.measure)}return t};e.Actor=Pv;e.AlphaImage=Ou;e.CanonicalTileID=Xv;e.CollisionBoxArray=Es;e.Color=br;e.DEMData=$v;e.DataConstantProperty=Ho;e.DictionaryCoder=td;e.EXTENT=yl;e.ErrorEvent=st;e.EvaluationParameters=zo;e.Event=ot;e.Evented=lt;e.FeatureIndex=id;e.FillBucket=Oc;e.FillExtrusionBucket=lf;e.ImageAtlas=Hh;e.ImagePosition=Uh;e.LineBucket=Lf;e.LngLat=Fv;e.LngLatBounds=Dv;e.MercatorCoordinate=Wv;e.ONE_EM=th;e.OverscaledTileID=Jv;e.Point=i;e.Point$1=i;e.Properties=Xo;e.Protobuf=ih;e.RGBAImage=zu;e.RequestManager=re;e.RequestPerformance=pd;e.ResourceType=Ne;e.SegmentVector=Ns;e.SourceFeatureState=nd;e.StructArrayLayout1ui2=ks;e.StructArrayLayout2f1f2i16=ds;e.StructArrayLayout2i4=is;e.StructArrayLayout3ui6=gs;e.StructArrayLayout4i8=os;e.SymbolBucket=lv;e.Texture=Cv;e.Tile=cd;e.Transitionable=Fo;e.Uniform1f=el;e.Uniform1i=$s;e.Uniform2f=tl;e.Uniform3f=rl;e.Uniform4f=al;e.UniformColor=nl;e.UniformMatrix4f=ol;e.UnwrappedTileID=Zv;e.ValidationError=Xt;e.WritingMode=qh;e.ZoomHistory=oo;e.add=lu;e.addDynamicAttributes=nv;e.asyncAll=p;e.bezier=u;e.bindAll=w;e.browser=G;e.cacheEntryPossiblyAdded=Oe;e.clamp=f;e.clearTileCache=De;e.clipLine=Sp;e.clone=Zl;e.clone$1=A;e.clone$2=su;e.collisionCircleLayout=qf;e.config=Y;e.create=Xl;e.create$1=Yl;e.create$2=ql;e.createCommonjsModule=t;e.createExpression=Jn;e.createLayout=rs;e.createStyleLayer=kv;e.cross=pu;e.deepEqual=s;e.dot=hu;e.dot$1=xu;e.ease=c;e.emitValidationErrors=Wi;e.endsWith=T;e.enforceCacheSizeLimit=ze;e.evaluateSizeForFeature=gp;e.evaluateSizeForZoom=yp;e.evaluateVariableOffset=Gp;e.evented=So;e.extend=m;e.featureFilter=di;e.filterObject=M;e.fromRotation=Wl;e.getAnchorAlignment=lp;e.getAnchorJustification=Wp;e.getArrayBuffer=We;e.getImage=rt;e.getJSON=Ye;e.getRTLTextPluginStatus=Eo;e.getReferrer=Ue;e.getVideo=at;e.identity=Jl;e.invert=Kl;e.isChar=so;e.isMapboxURL=ae;e.keysDifference=d;e.makeRequest=Ge;e.mapObject=k;e.mercatorXfromLng=jv;e.mercatorYfromLat=Uv;e.mercatorZfromAltitude=Vv;e.mul=iu;e.multiply=Ql;e.mvt=rf;e.normalize=fu;e.number=_a;e.offscreenCanvasSupported=Be;e.ortho=nu;e.parseGlyphPBF=Fh;e.pbf=ih;e.performSymbolLayout=Yp;e.perspective=au;e.pick=g;e.plugin=Po;e.polygonIntersectsPolygon=kl;e.postMapLoadEvent=xe;e.postTurnstileEvent=ge;e.potpack=Nh;e.refProperties=fd;e.register=eo;e.registerForPluginStateChange=Lo;e.rotate=Gl;e.rotateX=tu;e.rotateZ=ru;e.scale=eu;e.scale$1=yu;e.scale$2=cu;e.setCacheLimits=Re;e.setRTLTextPlugin=Co;e.sphericalToCartesian=P;e.sqrLen=ku;e.styleSpec=Wt;e.sub=du;e.symbolSize=xp;e.transformMat3=vu;e.transformMat4=bu;e.translate=$l;e.triggerPluginCompletionEvent=Mo;e.uniqueId=x;e.validateCustomStyleLayer=_v;e.validateLight=qi;e.validateStyle=Hi;e.values=v;e.vectorTile=rf;e.version=r;e.warnOnce=L;e.webpSupported=W;e.window=self;e.wrap=h}));a(["./shared"],(function(e){"use strict";function t(e){var r=typeof e;if(r==="number"||r==="boolean"||r==="string"||e===undefined||e===null){return JSON.stringify(e)}if(Array.isArray(e)){var a="[";for(var n=0,i=e;n<i.length;n+=1){var o=i[n];a+=t(o)+","}return a+"]"}var s=Object.keys(e).sort();var l="{";for(var u=0;u<s.length;u++){l+=JSON.stringify(s[u])+":"+t(e[s[u]])+","}return l+"}"}function r(r){var a="";for(var n=0,i=e.refProperties;n<i.length;n+=1){var o=i[n];a+="/"+t(r[o])}return a}function a(e,t){var a={};for(var n=0;n<e.length;n++){var i=t&&t[e[n].id]||r(e[n]);if(t){t[e[n].id]=i}var o=a[i];if(!o){o=a[i]=[]}o.push(e[n])}var s=[];for(var l in a){s.push(a[l])}return s}var n=function e(t){this.keyCache={};if(t){this.replace(t)}};n.prototype.replace=function e(t){this._layerConfigs={};this._layers={};this.update(t,[])};n.prototype.update=function t(r,n){var i=this;for(var o=0,s=r;o<s.length;o+=1){var l=s[o];this._layerConfigs[l.id]=l;var u=this._layers[l.id]=e.createStyleLayer(l);u._featureFilter=e.featureFilter(u.filter);if(this.keyCache[l.id]){delete this.keyCache[l.id]}}for(var c=0,f=n;c<f.length;c+=1){var h=f[c];delete this.keyCache[h];delete this._layerConfigs[h];delete this._layers[h]}this.familiesBySource={};var p=a(e.values(this._layerConfigs),this.keyCache);for(var v=0,d=p;v<d.length;v+=1){var m=d[v];var g=m.map((function(e){return i._layers[e.id]}));var y=g[0];if(y.visibility==="none"){continue}var x=y.source||"";var b=this.familiesBySource[x];if(!b){b=this.familiesBySource[x]={}}var _=y.sourceLayer||"_geojsonTileLayer";var w=b[_];if(!w){w=b[_]=[]}w.push(g)}};var i=1;var o=function t(r){var a={};var n=[];for(var o in r){var s=r[o];var l=a[o]={};for(var u in s){var c=s[+u];if(!c||c.bitmap.width===0||c.bitmap.height===0){continue}var f={x:0,y:0,w:c.bitmap.width+2*i,h:c.bitmap.height+2*i};n.push(f);l[u]={rect:f,metrics:c.metrics}}}var h=e.potpack(n);var p=h.w;var v=h.h;var d=new e.AlphaImage({width:p||1,height:v||1});for(var m in r){var g=r[m];for(var y in g){var x=g[+y];if(!x||x.bitmap.width===0||x.bitmap.height===0){continue}var b=a[m][y].rect;e.AlphaImage.copy(x.bitmap,d,{x:0,y:0},{x:b.x+i,y:b.y+i},x.bitmap)}}this.image=d;this.positions=a};e.register("GlyphAtlas",o);var s=function t(r){this.tileID=new e.OverscaledTileID(r.tileID.overscaledZ,r.tileID.wrap,r.tileID.canonical.z,r.tileID.canonical.x,r.tileID.canonical.y);this.uid=r.uid;this.zoom=r.zoom;this.pixelRatio=r.pixelRatio;this.tileSize=r.tileSize;this.source=r.source;this.overscaling=this.tileID.overscaleFactor();this.showCollisionBoxes=r.showCollisionBoxes;this.collectResourceTiming=!!r.collectResourceTiming;this.returnDependencies=!!r.returnDependencies;this.promoteId=r.promoteId};s.prototype.parse=function t(r,a,n,i,s){var u=this;this.status="parsing";this.data=r;this.collisionBoxArray=new e.CollisionBoxArray;var c=new e.DictionaryCoder(Object.keys(r.layers).sort());var f=new e.FeatureIndex(this.tileID,this.promoteId);f.bucketLayerIDs=[];var h={};var p={featureIndex:f,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:n};var v=a.familiesBySource[this.source];for(var d in v){var m=r.layers[d];if(!m){continue}if(m.version===1){e.warnOnce('Vector tile source "'+this.source+'" layer "'+d+'" '+"does not use vector tile spec v2 and therefore may have some rendering errors.")}var g=c.encode(d);var y=[];for(var x=0;x<m.length;x++){var b=m.feature(x);var _=f.getId(b,d);y.push({feature:b,id:_,index:x,sourceLayerIndex:g})}for(var w=0,T=v[d];w<T.length;w+=1){var k=T[w];var M=k[0];if(M.minzoom&&this.zoom<Math.floor(M.minzoom)){continue}if(M.maxzoom&&this.zoom>=M.maxzoom){continue}if(M.visibility==="none"){continue}l(k,this.zoom,n);var A=h[M.id]=M.createBucket({index:f.bucketLayerIDs.length,layers:k,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:g,sourceID:this.source});A.populate(y,p,this.tileID.canonical);f.bucketLayerIDs.push(k.map((function(e){return e.id})))}}var S;var E;var L;var C;var I=e.mapObject(p.glyphDependencies,(function(e){return Object.keys(e).map(Number)}));if(Object.keys(I).length){i.send("getGlyphs",{uid:this.uid,stacks:I},(function(e,t){if(!S){S=e;E=t;z.call(u)}}))}else{E={}}var P=Object.keys(p.iconDependencies);if(P.length){i.send("getImages",{icons:P,source:this.source,tileID:this.tileID,type:"icons"},(function(e,t){if(!S){S=e;L=t;z.call(u)}}))}else{L={}}var O=Object.keys(p.patternDependencies);if(O.length){i.send("getImages",{icons:O,source:this.source,tileID:this.tileID,type:"patterns"},(function(e,t){if(!S){S=e;C=t;z.call(u)}}))}else{C={}}z.call(this);function z(){if(S){return s(S)}else if(E&&L&&C){var t=new o(E);var r=new e.ImageAtlas(L,C);for(var a in h){var i=h[a];if(i instanceof e.SymbolBucket){l(i.layers,this.zoom,n);e.performSymbolLayout(i,E,t.positions,L,r.iconPositions,this.showCollisionBoxes,this.tileID.canonical)}else if(i.hasPattern&&(i instanceof e.LineBucket||i instanceof e.FillBucket||i instanceof e.FillExtrusionBucket)){l(i.layers,this.zoom,n);i.addFeatures(p,this.tileID.canonical,r.patternPositions)}}this.status="done";s(null,{buckets:e.values(h).filter((function(e){return!e.isEmpty()})),featureIndex:f,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:t.image,imageAtlas:r,glyphMap:this.returnDependencies?E:null,iconMap:this.returnDependencies?L:null,glyphPositions:this.returnDependencies?t.positions:null})}}};function l(t,r,a){var n=new e.EvaluationParameters(r);for(var i=0,o=t;i<o.length;i+=1){var s=o[i];s.recalculate(n,a)}}function u(t,r){var a=e.getArrayBuffer(t.request,(function(t,a,n,i){if(t){r(t)}else if(a){r(null,{vectorTile:new e.vectorTile.VectorTile(new e.pbf(a)),rawData:a,cacheControl:n,expires:i})}}));return function(){a.cancel();r()}}var c=function e(t,r,a,n){this.actor=t;this.layerIndex=r;this.availableImages=a;this.loadVectorData=n||u;this.loading={};this.loaded={}};c.prototype.loadTile=function t(r,a){var n=this;var i=r.uid;if(!this.loading){this.loading={}}var o=r&&r.request&&r.request.collectResourceTiming?new e.RequestPerformance(r.request):false;var l=this.loading[i]=new s(r);l.abort=this.loadVectorData(r,(function(t,r){delete n.loading[i];if(t||!r){l.status="done";n.loaded[i]=l;return a(t)}var s=r.rawData;var u={};if(r.expires){u.expires=r.expires}if(r.cacheControl){u.cacheControl=r.cacheControl}var c={};if(o){var f=o.finish();if(f){c.resourceTiming=JSON.parse(JSON.stringify(f))}}l.vectorTile=r.vectorTile;l.parse(r.vectorTile,n.layerIndex,n.availableImages,n.actor,(function(t,r){if(t||!r){return a(t)}a(null,e.extend({rawTileData:s.slice(0)},r,u,c))}));n.loaded=n.loaded||{};n.loaded[i]=l}))};c.prototype.reloadTile=function e(t,r){var a=this;var n=this.loaded,i=t.uid,o=this;if(n&&n[i]){var s=n[i];s.showCollisionBoxes=t.showCollisionBoxes;var l=function(e,t){var n=s.reloadCallback;if(n){delete s.reloadCallback;s.parse(s.vectorTile,o.layerIndex,a.availableImages,o.actor,n)}r(e,t)};if(s.status==="parsing"){s.reloadCallback=l}else if(s.status==="done"){if(s.vectorTile){s.parse(s.vectorTile,this.layerIndex,this.availableImages,this.actor,l)}else{l()}}}};c.prototype.abortTile=function e(t,r){var a=this.loading,n=t.uid;if(a&&a[n]&&a[n].abort){a[n].abort();delete a[n]}r()};c.prototype.removeTile=function e(t,r){var a=this.loaded,n=t.uid;if(a&&a[n]){delete a[n]}r()};var f=e.window.ImageBitmap;var h=function e(){this.loaded={}};h.prototype.loadTile=function t(r,a){var n=r.uid;var i=r.encoding;var o=r.rawImageData;var s=f&&o instanceof f?this.getImageData(o):o;var l=new e.DEMData(n,s,i);this.loaded=this.loaded||{};this.loaded[n]=l;a(null,l)};h.prototype.getImageData=function t(r){if(!this.offscreenCanvas||!this.offscreenCanvasContext){this.offscreenCanvas=new OffscreenCanvas(r.width,r.height);this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")}this.offscreenCanvas.width=r.width;this.offscreenCanvas.height=r.height;this.offscreenCanvasContext.drawImage(r,0,0,r.width,r.height);var a=this.offscreenCanvasContext.getImageData(-1,-1,r.width+2,r.height+2);this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height);return new e.RGBAImage({width:a.width,height:a.height},a.data)};h.prototype.removeTile=function e(t){var r=this.loaded,a=t.uid;if(r&&r[a]){delete r[a]}};var p=v;function v(e,t){var r=e&&e.type,a;if(r==="FeatureCollection"){for(a=0;a<e.features.length;a++){v(e.features[a],t)}}else if(r==="GeometryCollection"){for(a=0;a<e.geometries.length;a++){v(e.geometries[a],t)}}else if(r==="Feature"){v(e.geometry,t)}else if(r==="Polygon"){d(e.coordinates,t)}else if(r==="MultiPolygon"){for(a=0;a<e.coordinates.length;a++){d(e.coordinates[a],t)}}return e}function d(e,t){if(e.length===0){return}m(e[0],t);for(var r=1;r<e.length;r++){m(e[r],!t)}}function m(e,t){var r=0;for(var a=0,n=e.length,i=n-1;a<n;i=a++){r+=(e[a][0]-e[i][0])*(e[i][1]+e[a][1])}if(r>=0!==!!t){e.reverse()}}var g=e.vectorTile.VectorTileFeature.prototype.toGeoJSON;var y=function t(r){this._feature=r;this.extent=e.EXTENT;this.type=r.type;this.properties=r.tags;if("id"in r&&!isNaN(r.id)){this.id=parseInt(r.id,10)}};y.prototype.loadGeometry=function t(){if(this._feature.type===1){var r=[];for(var a=0,n=this._feature.geometry;a<n.length;a+=1){var i=n[a];r.push([new e.Point$1(i[0],i[1])])}return r}else{var o=[];for(var s=0,l=this._feature.geometry;s<l.length;s+=1){var u=l[s];var c=[];for(var f=0,h=u;f<h.length;f+=1){var p=h[f];c.push(new e.Point$1(p[0],p[1]))}o.push(c)}return o}};y.prototype.toGeoJSON=function e(t,r,a){return g.call(this,t,r,a)};var x=function t(r){this.layers={_geojsonTileLayer:this};this.name="_geojsonTileLayer";this.extent=e.EXTENT;this.length=r.length;this._features=r};x.prototype.feature=function e(t){return new y(this._features[t])};var b=e.vectorTile.VectorTileFeature;var _=w;function w(e,t){this.options=t||{};this.features=e;this.length=e.length}w.prototype.feature=function(e){return new T(this.features[e],this.options.extent)};function T(e,t){this.id=typeof e.id==="number"?e.id:undefined;this.type=e.type;this.rawGeometry=e.type===1?[e.geometry]:e.geometry;this.properties=e.tags;this.extent=t||4096}T.prototype.loadGeometry=function(){var t=this.rawGeometry;this.geometry=[];for(var r=0;r<t.length;r++){var a=t[r];var n=[];for(var i=0;i<a.length;i++){n.push(new e.Point$1(a[i][0],a[i][1]))}this.geometry.push(n)}return this.geometry};T.prototype.bbox=function(){if(!this.geometry){this.loadGeometry()}var e=this.geometry;var t=Infinity;var r=-Infinity;var a=Infinity;var n=-Infinity;for(var i=0;i<e.length;i++){var o=e[i];for(var s=0;s<o.length;s++){var l=o[s];t=Math.min(t,l.x);r=Math.max(r,l.x);a=Math.min(a,l.y);n=Math.max(n,l.y)}}return[t,a,r,n]};T.prototype.toGeoJSON=b.prototype.toGeoJSON;var k=E;var M=E;var A=L;var S=_;function E(t){var r=new e.pbf;C(t,r);return r.finish()}function L(e,t){t=t||{};var r={};for(var a in e){r[a]=new _(e[a].features,t);r[a].name=a;r[a].version=t.version;r[a].extent=t.extent}return E({layers:r})}function C(e,t){for(var r in e.layers){t.writeMessage(3,I,e.layers[r])}}function I(e,t){t.writeVarintField(15,e.version||1);t.writeStringField(1,e.name||"");t.writeVarintField(5,e.extent||4096);var r;var a={keys:[],values:[],keycache:{},valuecache:{}};for(r=0;r<e.length;r++){a.feature=e.feature(r);t.writeMessage(2,P,a)}var n=a.keys;for(r=0;r<n.length;r++){t.writeStringField(3,n[r])}var i=a.values;for(r=0;r<i.length;r++){t.writeMessage(4,F,i[r])}}function P(e,t){var r=e.feature;if(r.id!==undefined){t.writeVarintField(1,r.id)}t.writeMessage(2,O,e);t.writeVarintField(3,r.type);t.writeMessage(4,R,r)}function O(e,t){var r=e.feature;var a=e.keys;var n=e.values;var i=e.keycache;var o=e.valuecache;for(var s in r.properties){var l=i[s];if(typeof l==="undefined"){a.push(s);l=a.length-1;i[s]=l}t.writeVarint(l);var u=r.properties[s];var c=typeof u;if(c!=="string"&&c!=="boolean"&&c!=="number"){u=JSON.stringify(u)}var f=c+":"+u;var h=o[f];if(typeof h==="undefined"){n.push(u);h=n.length-1;o[f]=h}t.writeVarint(h)}}function z(e,t){return(t<<3)+(e&7)}function D(e){return e<<1^e>>31}function R(e,t){var r=e.loadGeometry();var a=e.type;var n=0;var i=0;var o=r.length;for(var s=0;s<o;s++){var l=r[s];var u=1;if(a===1){u=l.length}t.writeVarint(z(1,u));var c=a===3?l.length-1:l.length;for(var f=0;f<c;f++){if(f===1&&a!==1){t.writeVarint(z(2,c-1))}var h=l[f].x-n;var p=l[f].y-i;t.writeVarint(D(h));t.writeVarint(D(p));n+=h;i+=p}if(a===3){t.writeVarint(z(7,1))}}}function F(e,t){var r=typeof e;if(r==="string"){t.writeStringField(1,e)}else if(r==="boolean"){t.writeBooleanField(7,e)}else if(r==="number"){if(e%1!==0){t.writeDoubleField(3,e)}else if(e<0){t.writeSVarintField(6,e)}else{t.writeVarintField(5,e)}}}k.fromVectorTileJs=M;k.fromGeojsonVt=A;k.GeoJSONWrapper=S;function B(e,t,r,a,n,i){if(n-a<=r){return}var o=a+n>>1;N(e,t,o,a,n,i%2);B(e,t,r,a,o-1,i+1);B(e,t,r,o+1,n,i+1)}function N(e,t,r,a,n,i){while(n>a){if(n-a>600){var o=n-a+1;var s=r-a+1;var l=Math.log(o);var u=.5*Math.exp(2*l/3);var c=.5*Math.sqrt(l*u*(o-u)/o)*(s-o/2<0?-1:1);var f=Math.max(a,Math.floor(r-s*u/o+c));var h=Math.min(n,Math.floor(r+(o-s)*u/o+c));N(e,t,r,f,h,i)}var p=t[2*r+i];var v=a;var d=n;j(e,t,a,r);if(t[2*n+i]>p){j(e,t,a,n)}while(v<d){j(e,t,v,d);v++;d--;while(t[2*v+i]<p){v++}while(t[2*d+i]>p){d--}}if(t[2*a+i]===p){j(e,t,a,d)}else{d++;j(e,t,d,n)}if(d<=r){a=d+1}if(r<=d){n=d-1}}}function j(e,t,r,a){U(e,r,a);U(t,2*r,2*a);U(t,2*r+1,2*a+1)}function U(e,t,r){var a=e[t];e[t]=e[r];e[r]=a}function V(e,t,r,a,n,i,o){var s=[0,e.length-1,0];var l=[];var u,c;while(s.length){var f=s.pop();var h=s.pop();var p=s.pop();if(h-p<=o){for(var v=p;v<=h;v++){u=t[2*v];c=t[2*v+1];if(u>=r&&u<=n&&c>=a&&c<=i){l.push(e[v])}}continue}var d=Math.floor((p+h)/2);u=t[2*d];c=t[2*d+1];if(u>=r&&u<=n&&c>=a&&c<=i){l.push(e[d])}var m=(f+1)%2;if(f===0?r<=u:a<=c){s.push(p);s.push(d-1);s.push(m)}if(f===0?n>=u:i>=c){s.push(d+1);s.push(h);s.push(m)}}return l}function H(e,t,r,a,n,i){var o=[0,e.length-1,0];var s=[];var l=n*n;while(o.length){var u=o.pop();var c=o.pop();var f=o.pop();if(c-f<=i){for(var h=f;h<=c;h++){if(q(t[2*h],t[2*h+1],r,a)<=l){s.push(e[h])}}continue}var p=Math.floor((f+c)/2);var v=t[2*p];var d=t[2*p+1];if(q(v,d,r,a)<=l){s.push(e[p])}var m=(u+1)%2;if(u===0?r-n<=v:a-n<=d){o.push(f);o.push(p-1);o.push(m)}if(u===0?r+n>=v:a+n>=d){o.push(p+1);o.push(c);o.push(m)}}return s}function q(e,t,r,a){var n=e-r;var i=t-a;return n*n+i*i}var G=function(e){return e[0]};var Y=function(e){return e[1]};var W=function e(t,r,a,n,i){if(r===void 0)r=G;if(a===void 0)a=Y;if(n===void 0)n=64;if(i===void 0)i=Float64Array;this.nodeSize=n;this.points=t;var o=t.length<65536?Uint16Array:Uint32Array;var s=this.ids=new o(t.length);var l=this.coords=new i(t.length*2);for(var u=0;u<t.length;u++){s[u]=u;l[2*u]=r(t[u]);l[2*u+1]=a(t[u])}B(s,l,n,0,s.length-1,0)};W.prototype.range=function e(t,r,a,n){return V(this.ids,this.coords,t,r,a,n,this.nodeSize)};W.prototype.within=function e(t,r,a){return H(this.ids,this.coords,t,r,a,this.nodeSize)};var X={minZoom:0,maxZoom:16,radius:40,extent:512,nodeSize:64,log:false,generateId:false,reduce:null,map:function(e){return e}};var Z=function e(t){this.options=ne(Object.create(X),t);this.trees=new Array(this.options.maxZoom+1)};Z.prototype.load=function e(t){var r=this.options;var a=r.log;var n=r.minZoom;var i=r.maxZoom;var o=r.nodeSize;if(a){console.time("total time")}var s="prepare "+t.length+" points";if(a){console.time(s)}this.points=t;var l=[];for(var u=0;u<t.length;u++){if(!t[u].geometry){continue}l.push(K(t[u],u))}this.trees[i+1]=new W(l,ie,oe,o,Float32Array);if(a){console.timeEnd(s)}for(var c=i;c>=n;c--){var f=+Date.now();l=this._cluster(l,c);this.trees[c]=new W(l,ie,oe,o,Float32Array);if(a){console.log("z%d: %d clusters in %dms",c,l.length,+Date.now()-f)}}if(a){console.timeEnd("total time")}return this};Z.prototype.getClusters=function e(t,r){var a=((t[0]+180)%360+360)%360-180;var n=Math.max(-90,Math.min(90,t[1]));var i=t[2]===180?180:((t[2]+180)%360+360)%360-180;var o=Math.max(-90,Math.min(90,t[3]));if(t[2]-t[0]>=360){a=-180;i=180}else if(a>i){var s=this.getClusters([a,n,180,o],r);var l=this.getClusters([-180,n,i,o],r);return s.concat(l)}var u=this.trees[this._limitZoom(r)];var c=u.range(ee(a),te(o),ee(i),te(n));var f=[];for(var h=0,p=c;h<p.length;h+=1){var v=p[h];var d=u.points[v];f.push(d.numPoints?Q(d):this.points[d.index])}return f};Z.prototype.getChildren=function e(t){var r=this._getOriginId(t);var a=this._getOriginZoom(t);var n="No cluster with the specified id.";var i=this.trees[a];if(!i){throw new Error(n)}var o=i.points[r];if(!o){throw new Error(n)}var s=this.options.radius/(this.options.extent*Math.pow(2,a-1));var l=i.within(o.x,o.y,s);var u=[];for(var c=0,f=l;c<f.length;c+=1){var h=f[c];var p=i.points[h];if(p.parentId===t){u.push(p.numPoints?Q(p):this.points[p.index])}}if(u.length===0){throw new Error(n)}return u};Z.prototype.getLeaves=function e(t,r,a){r=r||10;a=a||0;var n=[];this._appendLeaves(n,t,r,a,0);return n};Z.prototype.getTile=function e(t,r,a){var n=this.trees[this._limitZoom(t)];var i=Math.pow(2,t);var o=this.options;var s=o.extent;var l=o.radius;var u=l/s;var c=(a-u)/i;var f=(a+1+u)/i;var h={features:[]};this._addTileFeatures(n.range((r-u)/i,c,(r+1+u)/i,f),n.points,r,a,i,h);if(r===0){this._addTileFeatures(n.range(1-u/i,c,1,f),n.points,i,a,i,h)}if(r===i-1){this._addTileFeatures(n.range(0,c,u/i,f),n.points,-1,a,i,h)}return h.features.length?h:null};Z.prototype.getClusterExpansionZoom=function e(t){var r=this._getOriginZoom(t)-1;while(r<=this.options.maxZoom){var a=this.getChildren(t);r++;if(a.length!==1){break}t=a[0].properties.cluster_id}return r};Z.prototype._appendLeaves=function e(t,r,a,n,i){var o=this.getChildren(r);for(var s=0,l=o;s<l.length;s+=1){var u=l[s];var c=u.properties;if(c&&c.cluster){if(i+c.point_count<=n){i+=c.point_count}else{i=this._appendLeaves(t,c.cluster_id,a,n,i)}}else if(i<n){i++}else{t.push(u)}if(t.length===a){break}}return i};Z.prototype._addTileFeatures=function e(t,r,a,n,i,o){for(var s=0,l=t;s<l.length;s+=1){var u=l[s];var c=r[u];var f=c.numPoints;var h={type:1,geometry:[[Math.round(this.options.extent*(c.x*i-a)),Math.round(this.options.extent*(c.y*i-n))]],tags:f?$(c):this.points[c.index].properties};var p=void 0;if(f){p=c.id}else if(this.options.generateId){p=c.index}else if(this.points[c.index].id){p=this.points[c.index].id}if(p!==undefined){h.id=p}o.features.push(h)}};Z.prototype._limitZoom=function e(t){return Math.max(this.options.minZoom,Math.min(t,this.options.maxZoom+1))};Z.prototype._cluster=function e(t,r){var a=[];var n=this.options;var i=n.radius;var o=n.extent;var s=n.reduce;var l=i/(o*Math.pow(2,r));for(var u=0;u<t.length;u++){var c=t[u];if(c.zoom<=r){continue}c.zoom=r;var f=this.trees[r+1];var h=f.within(c.x,c.y,l);var p=c.numPoints||1;var v=c.x*p;var d=c.y*p;var m=s&&p>1?this._map(c,true):null;var g=(u<<5)+(r+1)+this.points.length;for(var y=0,x=h;y<x.length;y+=1){var b=x[y];var _=f.points[b];if(_.zoom<=r){continue}_.zoom=r;var w=_.numPoints||1;v+=_.x*w;d+=_.y*w;p+=w;_.parentId=g;if(s){if(!m){m=this._map(c,true)}s(m,this._map(_))}}if(p===1){a.push(c)}else{c.parentId=g;a.push(J(v/p,d/p,g,p,m))}}return a};Z.prototype._getOriginId=function e(t){return t-this.points.length>>5};Z.prototype._getOriginZoom=function e(t){return(t-this.points.length)%32};Z.prototype._map=function e(t,r){if(t.numPoints){return r?ne({},t.properties):t.properties}var a=this.points[t.index].properties;var n=this.options.map(a);return r&&n===a?ne({},n):n};function J(e,t,r,a,n){return{x:e,y:t,zoom:Infinity,id:r,parentId:-1,numPoints:a,properties:n}}function K(e,t){var r=e.geometry.coordinates;var a=r[0];var n=r[1];return{x:ee(a),y:te(n),zoom:Infinity,index:t,parentId:-1}}function Q(e){return{type:"Feature",id:e.id,properties:$(e),geometry:{type:"Point",coordinates:[re(e.x),ae(e.y)]}}}function $(e){var t=e.numPoints;var r=t>=1e4?Math.round(t/1e3)+"k":t>=1e3?Math.round(t/100)/10+"k":t;return ne(ne({},e.properties),{cluster:true,cluster_id:e.id,point_count:t,point_count_abbreviated:r})}function ee(e){return e/360+.5}function te(e){var t=Math.sin(e*Math.PI/180);var r=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return r<0?0:r>1?1:r}function re(e){return(e-.5)*360}function ae(e){var t=(180-e*360)*Math.PI/180;return 360*Math.atan(Math.exp(t))/Math.PI-90}function ne(e,t){for(var r in t){e[r]=t[r]}return e}function ie(e){return e.x}function oe(e){return e.y}function se(e,t,r,a){var n=a;var i=r-t>>1;var o=r-t;var s;var l=e[t];var u=e[t+1];var c=e[r];var f=e[r+1];for(var h=t+3;h<r;h+=3){var p=le(e[h],e[h+1],l,u,c,f);if(p>n){s=h;n=p}else if(p===n){var v=Math.abs(h-i);if(v<o){s=h;o=v}}}if(n>a){if(s-t>3){se(e,t,s,a)}e[s+2]=n;if(r-s>3){se(e,s,r,a)}}}function le(e,t,r,a,n,i){var o=n-r;var s=i-a;if(o!==0||s!==0){var l=((e-r)*o+(t-a)*s)/(o*o+s*s);if(l>1){r=n;a=i}else if(l>0){r+=o*l;a+=s*l}}o=e-r;s=t-a;return o*o+s*s}function ue(e,t,r,a){var n={id:typeof e==="undefined"?null:e,type:t,geometry:r,tags:a,minX:Infinity,minY:Infinity,maxX:-Infinity,maxY:-Infinity};ce(n);return n}function ce(e){var t=e.geometry;var r=e.type;if(r==="Point"||r==="MultiPoint"||r==="LineString"){fe(e,t)}else if(r==="Polygon"||r==="MultiLineString"){for(var a=0;a<t.length;a++){fe(e,t[a])}}else if(r==="MultiPolygon"){for(a=0;a<t.length;a++){for(var n=0;n<t[a].length;n++){fe(e,t[a][n])}}}}function fe(e,t){for(var r=0;r<t.length;r+=3){e.minX=Math.min(e.minX,t[r]);e.minY=Math.min(e.minY,t[r+1]);e.maxX=Math.max(e.maxX,t[r]);e.maxY=Math.max(e.maxY,t[r+1])}}function he(e,t){var r=[];if(e.type==="FeatureCollection"){for(var a=0;a<e.features.length;a++){pe(r,e.features[a],t,a)}}else if(e.type==="Feature"){pe(r,e,t)}else{pe(r,{geometry:e},t)}return r}function pe(e,t,r,a){if(!t.geometry){return}var n=t.geometry.coordinates;var i=t.geometry.type;var o=Math.pow(r.tolerance/((1<<r.maxZoom)*r.extent),2);var s=[];var l=t.id;if(r.promoteId){l=t.properties[r.promoteId]}else if(r.generateId){l=a||0}if(i==="Point"){ve(n,s)}else if(i==="MultiPoint"){for(var u=0;u<n.length;u++){ve(n[u],s)}}else if(i==="LineString"){de(n,s,o,false)}else if(i==="MultiLineString"){if(r.lineMetrics){for(u=0;u<n.length;u++){s=[];de(n[u],s,o,false);e.push(ue(l,"LineString",s,t.properties))}return}else{me(n,s,o,false)}}else if(i==="Polygon"){me(n,s,o,true)}else if(i==="MultiPolygon"){for(u=0;u<n.length;u++){var c=[];me(n[u],c,o,true);s.push(c)}}else if(i==="GeometryCollection"){for(u=0;u<t.geometry.geometries.length;u++){pe(e,{id:l,geometry:t.geometry.geometries[u],properties:t.properties},r,a)}return}else{throw new Error("Input data is not a valid GeoJSON object.")}e.push(ue(l,i,s,t.properties))}function ve(e,t){t.push(ge(e[0]));t.push(ye(e[1]));t.push(0)}function de(e,t,r,a){var n,i;var o=0;for(var s=0;s<e.length;s++){var l=ge(e[s][0]);var u=ye(e[s][1]);t.push(l);t.push(u);t.push(0);if(s>0){if(a){o+=(n*u-l*i)/2}else{o+=Math.sqrt(Math.pow(l-n,2)+Math.pow(u-i,2))}}n=l;i=u}var c=t.length-3;t[2]=1;se(t,0,c,r);t[c+2]=1;t.size=Math.abs(o);t.start=0;t.end=t.size}function me(e,t,r,a){for(var n=0;n<e.length;n++){var i=[];de(e[n],i,r,a);t.push(i)}}function ge(e){return e/360+.5}function ye(e){var t=Math.sin(e*Math.PI/180);var r=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return r<0?0:r>1?1:r}function xe(e,t,r,a,n,i,o,s){r/=t;a/=t;if(i>=r&&o<a){return e}else if(o<r||i>=a){return null}var l=[];for(var u=0;u<e.length;u++){var c=e[u];var f=c.geometry;var h=c.type;var p=n===0?c.minX:c.minY;var v=n===0?c.maxX:c.maxY;if(p>=r&&v<a){l.push(c);continue}else if(v<r||p>=a){continue}var d=[];if(h==="Point"||h==="MultiPoint"){be(f,d,r,a,n)}else if(h==="LineString"){_e(f,d,r,a,n,false,s.lineMetrics)}else if(h==="MultiLineString"){Te(f,d,r,a,n,false)}else if(h==="Polygon"){Te(f,d,r,a,n,true)}else if(h==="MultiPolygon"){for(var m=0;m<f.length;m++){var g=[];Te(f[m],g,r,a,n,true);if(g.length){d.push(g)}}}if(d.length){if(s.lineMetrics&&h==="LineString"){for(m=0;m<d.length;m++){l.push(ue(c.id,h,d[m],c.tags))}continue}if(h==="LineString"||h==="MultiLineString"){if(d.length===1){h="LineString";d=d[0]}else{h="MultiLineString"}}if(h==="Point"||h==="MultiPoint"){h=d.length===3?"Point":"MultiPoint"}l.push(ue(c.id,h,d,c.tags))}}return l.length?l:null}function be(e,t,r,a,n){for(var i=0;i<e.length;i+=3){var o=e[i+n];if(o>=r&&o<=a){t.push(e[i]);t.push(e[i+1]);t.push(e[i+2])}}}function _e(e,t,r,a,n,i,o){var s=we(e);var l=n===0?Me:Ae;var u=e.start;var c,f;for(var h=0;h<e.length-3;h+=3){var p=e[h];var v=e[h+1];var d=e[h+2];var m=e[h+3];var g=e[h+4];var y=n===0?p:v;var x=n===0?m:g;var b=false;if(o){c=Math.sqrt(Math.pow(p-m,2)+Math.pow(v-g,2))}if(y<r){if(x>r){f=l(s,p,v,m,g,r);if(o){s.start=u+c*f}}}else if(y>a){if(x<a){f=l(s,p,v,m,g,a);if(o){s.start=u+c*f}}}else{ke(s,p,v,d)}if(x<r&&y>=r){f=l(s,p,v,m,g,r);b=true}if(x>a&&y<=a){f=l(s,p,v,m,g,a);b=true}if(!i&&b){if(o){s.end=u+c*f}t.push(s);s=we(e)}if(o){u+=c}}var _=e.length-3;p=e[_];v=e[_+1];d=e[_+2];y=n===0?p:v;if(y>=r&&y<=a){ke(s,p,v,d)}_=s.length-3;if(i&&_>=3&&(s[_]!==s[0]||s[_+1]!==s[1])){ke(s,s[0],s[1],s[2])}if(s.length){t.push(s)}}function we(e){var t=[];t.size=e.size;t.start=e.start;t.end=e.end;return t}function Te(e,t,r,a,n,i){for(var o=0;o<e.length;o++){_e(e[o],t,r,a,n,i,false)}}function ke(e,t,r,a){e.push(t);e.push(r);e.push(a)}function Me(e,t,r,a,n,i){var o=(i-t)/(a-t);e.push(i);e.push(r+(n-r)*o);e.push(1);return o}function Ae(e,t,r,a,n,i){var o=(i-r)/(n-r);e.push(t+(a-t)*o);e.push(i);e.push(1);return o}function Se(e,t){var r=t.buffer/t.extent;var a=e;var n=xe(e,1,-1-r,r,0,-1,2,t);var i=xe(e,1,1-r,2+r,0,-1,2,t);if(n||i){a=xe(e,1,-r,1+r,0,-1,2,t)||[];if(n){a=Ee(n,1).concat(a)}if(i){a=a.concat(Ee(i,-1))}}return a}function Ee(e,t){var r=[];for(var a=0;a<e.length;a++){var n=e[a],i=n.type;var o;if(i==="Point"||i==="MultiPoint"||i==="LineString"){o=Le(n.geometry,t)}else if(i==="MultiLineString"||i==="Polygon"){o=[];for(var s=0;s<n.geometry.length;s++){o.push(Le(n.geometry[s],t))}}else if(i==="MultiPolygon"){o=[];for(s=0;s<n.geometry.length;s++){var l=[];for(var u=0;u<n.geometry[s].length;u++){l.push(Le(n.geometry[s][u],t))}o.push(l)}}r.push(ue(n.id,i,o,n.tags))}return r}function Le(e,t){var r=[];r.size=e.size;if(e.start!==undefined){r.start=e.start;r.end=e.end}for(var a=0;a<e.length;a+=3){r.push(e[a]+t,e[a+1],e[a+2])}return r}function Ce(e,t){if(e.transformed){return e}var r=1<<e.z,a=e.x,n=e.y,i,o,s;for(i=0;i<e.features.length;i++){var l=e.features[i],u=l.geometry,c=l.type;l.geometry=[];if(c===1){for(o=0;o<u.length;o+=2){l.geometry.push(Ie(u[o],u[o+1],t,r,a,n))}}else{for(o=0;o<u.length;o++){var f=[];for(s=0;s<u[o].length;s+=2){f.push(Ie(u[o][s],u[o][s+1],t,r,a,n))}l.geometry.push(f)}}}e.transformed=true;return e}function Ie(e,t,r,a,n,i){return[Math.round(r*(e*a-n)),Math.round(r*(t*a-i))]}function Pe(e,t,r,a,n){var i=t===n.maxZoom?0:n.tolerance/((1<<t)*n.extent);var o={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:r,y:a,z:t,transformed:false,minX:2,minY:1,maxX:-1,maxY:0};for(var s=0;s<e.length;s++){o.numFeatures++;Oe(o,e[s],i,n);var l=e[s].minX;var u=e[s].minY;var c=e[s].maxX;var f=e[s].maxY;if(l<o.minX){o.minX=l}if(u<o.minY){o.minY=u}if(c>o.maxX){o.maxX=c}if(f>o.maxY){o.maxY=f}}return o}function Oe(e,t,r,a){var n=t.geometry,i=t.type,o=[];if(i==="Point"||i==="MultiPoint"){for(var s=0;s<n.length;s+=3){o.push(n[s]);o.push(n[s+1]);e.numPoints++;e.numSimplified++}}else if(i==="LineString"){ze(o,n,e,r,false,false)}else if(i==="MultiLineString"||i==="Polygon"){for(s=0;s<n.length;s++){ze(o,n[s],e,r,i==="Polygon",s===0)}}else if(i==="MultiPolygon"){for(var l=0;l<n.length;l++){var u=n[l];for(s=0;s<u.length;s++){ze(o,u[s],e,r,true,s===0)}}}if(o.length){var c=t.tags||null;if(i==="LineString"&&a.lineMetrics){c={};for(var f in t.tags){c[f]=t.tags[f]}c["mapbox_clip_start"]=n.start/n.size;c["mapbox_clip_end"]=n.end/n.size}var h={geometry:o,type:i==="Polygon"||i==="MultiPolygon"?3:i==="LineString"||i==="MultiLineString"?2:1,tags:c};if(t.id!==null){h.id=t.id}e.features.push(h)}}function ze(e,t,r,a,n,i){var o=a*a;if(a>0&&t.size<(n?o:a)){r.numPoints+=t.length/3;return}var s=[];for(var l=0;l<t.length;l+=3){if(a===0||t[l+2]>o){r.numSimplified++;s.push(t[l]);s.push(t[l+1])}r.numPoints++}if(n){De(s,i)}e.push(s)}function De(e,t){var r=0;for(var a=0,n=e.length,i=n-2;a<n;i=a,a+=2){r+=(e[a]-e[i])*(e[a+1]+e[i+1])}if(r>0===t){for(a=0,n=e.length;a<n/2;a+=2){var o=e[a];var s=e[a+1];e[a]=e[n-2-a];e[a+1]=e[n-1-a];e[n-2-a]=o;e[n-1-a]=s}}}function Re(e,t){return new Fe(e,t)}function Fe(e,t){t=this.options=Ne(Object.create(this.options),t);var r=t.debug;if(r){console.time("preprocess data")}if(t.maxZoom<0||t.maxZoom>24){throw new Error("maxZoom should be in the 0-24 range")}if(t.promoteId&&t.generateId){throw new Error("promoteId and generateId cannot be used together.")}var a=he(e,t);this.tiles={};this.tileCoords=[];if(r){console.timeEnd("preprocess data");console.log("index: maxZoom: %d, maxPoints: %d",t.indexMaxZoom,t.indexMaxPoints);console.time("generate tiles");this.stats={};this.total=0}a=Se(a,t);if(a.length){this.splitTile(a,0,0,0)}if(r){if(a.length){console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints)}console.timeEnd("generate tiles");console.log("tiles generated:",this.total,JSON.stringify(this.stats))}}Fe.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:false,promoteId:null,generateId:false,debug:0};Fe.prototype.splitTile=function(e,t,r,a,n,i,o){var s=[e,t,r,a],l=this.options,u=l.debug;while(s.length){a=s.pop();r=s.pop();t=s.pop();e=s.pop();var c=1<<t,f=Be(t,r,a),h=this.tiles[f];if(!h){if(u>1){console.time("creation")}h=this.tiles[f]=Pe(e,t,r,a,l);this.tileCoords.push({z:t,x:r,y:a});if(u){if(u>1){console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",t,r,a,h.numFeatures,h.numPoints,h.numSimplified);console.timeEnd("creation")}var p="z"+t;this.stats[p]=(this.stats[p]||0)+1;this.total++}}h.source=e;if(!n){if(t===l.indexMaxZoom||h.numPoints<=l.indexMaxPoints){continue}}else{if(t===l.maxZoom||t===n){continue}var v=1<<n-t;if(r!==Math.floor(i/v)||a!==Math.floor(o/v)){continue}}h.source=null;if(e.length===0){continue}if(u>1){console.time("clipping")}var d=.5*l.buffer/l.extent,m=.5-d,g=.5+d,y=1+d,x,b,_,w,T,k;x=b=_=w=null;T=xe(e,c,r-d,r+g,0,h.minX,h.maxX,l);k=xe(e,c,r+m,r+y,0,h.minX,h.maxX,l);e=null;if(T){x=xe(T,c,a-d,a+g,1,h.minY,h.maxY,l);b=xe(T,c,a+m,a+y,1,h.minY,h.maxY,l);T=null}if(k){_=xe(k,c,a-d,a+g,1,h.minY,h.maxY,l);w=xe(k,c,a+m,a+y,1,h.minY,h.maxY,l);k=null}if(u>1){console.timeEnd("clipping")}s.push(x||[],t+1,r*2,a*2);s.push(b||[],t+1,r*2,a*2+1);s.push(_||[],t+1,r*2+1,a*2);s.push(w||[],t+1,r*2+1,a*2+1)}};Fe.prototype.getTile=function(e,t,r){var a=this.options,n=a.extent,i=a.debug;if(e<0||e>24){return null}var o=1<<e;t=(t%o+o)%o;var s=Be(e,t,r);if(this.tiles[s]){return Ce(this.tiles[s],n)}if(i>1){console.log("drilling down to z%d-%d-%d",e,t,r)}var l=e,u=t,c=r,f;while(!f&&l>0){l--;u=Math.floor(u/2);c=Math.floor(c/2);f=this.tiles[Be(l,u,c)]}if(!f||!f.source){return null}if(i>1){console.log("found parent tile z%d-%d-%d",l,u,c)}if(i>1){console.time("drilling down")}this.splitTile(f.source,l,u,c,e,t,r);if(i>1){console.timeEnd("drilling down")}return this.tiles[s]?Ce(this.tiles[s],n):null};function Be(e,t,r){return((1<<e)*r+t)*32+e}function Ne(e,t){for(var r in t){e[r]=t[r]}return e}function je(e,t){var r=e.tileID.canonical;if(!this._geoJSONIndex){return t(null,null)}var a=this._geoJSONIndex.getTile(r.z,r.x,r.y);if(!a){return t(null,null)}var n=new x(a.features);var i=k(n);if(i.byteOffset!==0||i.byteLength!==i.buffer.byteLength){i=new Uint8Array(i)}t(null,{vectorTile:n,rawData:i.buffer})}var Ue=function(t){function r(e,r,a,n){t.call(this,e,r,a,je);if(n){this.loadGeoJSON=n}}if(t)r.__proto__=t;r.prototype=Object.create(t&&t.prototype);r.prototype.constructor=r;r.prototype.loadData=function e(t,r){if(this._pendingCallback){this._pendingCallback(null,{abandoned:true})}this._pendingCallback=r;this._pendingLoadDataParams=t;if(this._state&&this._state!=="Idle"){this._state="NeedsLoadData"}else{this._state="Coalescing";this._loadData()}};r.prototype._loadData=function t(){var r=this;if(!this._pendingCallback||!this._pendingLoadDataParams){return}var a=this._pendingCallback;var n=this._pendingLoadDataParams;delete this._pendingCallback;delete this._pendingLoadDataParams;var i=n&&n.request&&n.request.collectResourceTiming?new e.RequestPerformance(n.request):false;this.loadGeoJSON(n,(function(e,t){if(e||!t){return a(e)}else if(typeof t!=="object"){return a(new Error("Input data given to '"+n.source+"' is not a valid GeoJSON object."))}else{p(t,true);try{r._geoJSONIndex=n.cluster?new Z(Ve(n)).load(t.features):Re(t,n.geojsonVtOptions)}catch(e){return a(e)}r.loaded={};var o={};if(i){var s=i.finish();if(s){o.resourceTiming={};o.resourceTiming[n.source]=JSON.parse(JSON.stringify(s))}}a(null,o)}}))};r.prototype.coalesce=function e(){if(this._state==="Coalescing"){this._state="Idle"}else if(this._state==="NeedsLoadData"){this._state="Coalescing";this._loadData()}};r.prototype.reloadTile=function e(r,a){var n=this.loaded,i=r.uid;if(n&&n[i]){return t.prototype.reloadTile.call(this,r,a)}else{return this.loadTile(r,a)}};r.prototype.loadGeoJSON=function t(r,a){if(r.request){e.getJSON(r.request,a)}else if(typeof r.data==="string"){try{return a(null,JSON.parse(r.data))}catch(n){return a(new Error("Input data given to '"+r.source+"' is not a valid GeoJSON object."))}}else{return a(new Error("Input data given to '"+r.source+"' is not a valid GeoJSON object."))}};r.prototype.removeSource=function e(t,r){if(this._pendingCallback){this._pendingCallback(null,{abandoned:true})}r()};r.prototype.getClusterExpansionZoom=function e(t,r){try{r(null,this._geoJSONIndex.getClusterExpansionZoom(t.clusterId))}catch(a){r(a)}};r.prototype.getClusterChildren=function e(t,r){try{r(null,this._geoJSONIndex.getChildren(t.clusterId))}catch(a){r(a)}};r.prototype.getClusterLeaves=function e(t,r){try{r(null,this._geoJSONIndex.getLeaves(t.clusterId,t.limit,t.offset))}catch(a){r(a)}};return r}(c);function Ve(t){var r=t.superclusterOptions;var a=t.clusterProperties;if(!a||!r){return r}var n={};var i={};var o={accumulated:null,zoom:0};var s={properties:null};var l=Object.keys(a);for(var u=0,c=l;u<c.length;u+=1){var f=c[u];var h=a[f];var p=h[0];var v=h[1];var d=e.createExpression(v);var m=e.createExpression(typeof p==="string"?[p,["accumulated"],["get",f]]:p);n[f]=d.value;i[f]=m.value}r.map=function(e){s.properties=e;var t={};for(var r=0,a=l;r<a.length;r+=1){var i=a[r];t[i]=n[i].evaluate(o,s)}return t};r.reduce=function(e,t){s.properties=t;for(var r=0,a=l;r<a.length;r+=1){var n=a[r];o.accumulated=e[n];e[n]=i[n].evaluate(o,s)}};return r}var He=function t(r){var a=this;this.self=r;this.actor=new e.Actor(r,this);this.layerIndexes={};this.availableImages={};this.workerSourceTypes={vector:c,geojson:Ue};this.workerSources={};this.demWorkerSources={};this.self.registerWorkerSource=function(e,t){if(a.workerSourceTypes[e]){throw new Error('Worker source with name "'+e+'" already registered.')}a.workerSourceTypes[e]=t};this.self.registerRTLTextPlugin=function(t){if(e.plugin.isParsed()){throw new Error("RTL text plugin already registered.")}e.plugin["applyArabicShaping"]=t.applyArabicShaping;e.plugin["processBidirectionalText"]=t.processBidirectionalText;e.plugin["processStyledBidirectionalText"]=t.processStyledBidirectionalText}};He.prototype.setReferrer=function e(t,r){this.referrer=r};He.prototype.setImages=function e(t,r,a){this.availableImages[t]=r;for(var n in this.workerSources[t]){var i=this.workerSources[t][n];for(var o in i){i[o].availableImages=r}}a()};He.prototype.setLayers=function e(t,r,a){this.getLayerIndex(t).replace(r);a()};He.prototype.updateLayers=function e(t,r,a){this.getLayerIndex(t).update(r.layers,r.removedIds);a()};He.prototype.loadTile=function e(t,r,a){this.getWorkerSource(t,r.type,r.source).loadTile(r,a)};He.prototype.loadDEMTile=function e(t,r,a){this.getDEMWorkerSource(t,r.source).loadTile(r,a)};He.prototype.reloadTile=function e(t,r,a){this.getWorkerSource(t,r.type,r.source).reloadTile(r,a)};He.prototype.abortTile=function e(t,r,a){this.getWorkerSource(t,r.type,r.source).abortTile(r,a)};He.prototype.removeTile=function e(t,r,a){this.getWorkerSource(t,r.type,r.source).removeTile(r,a)};He.prototype.removeDEMTile=function e(t,r){this.getDEMWorkerSource(t,r.source).removeTile(r)};He.prototype.removeSource=function e(t,r,a){if(!this.workerSources[t]||!this.workerSources[t][r.type]||!this.workerSources[t][r.type][r.source]){return}var n=this.workerSources[t][r.type][r.source];delete this.workerSources[t][r.type][r.source];if(n.removeSource!==undefined){n.removeSource(r,a)}else{a()}};He.prototype.loadWorkerSource=function e(t,r,a){try{this.self.importScripts(r.url);a()}catch(n){a(n.toString())}};He.prototype.syncRTLPluginState=function t(r,a,n){try{e.plugin.setState(a);var i=e.plugin.getPluginURL();if(e.plugin.isLoaded()&&!e.plugin.isParsed()&&i!=null){this.self.importScripts(i);var o=e.plugin.isParsed();var s=o?undefined:new Error("RTL Text Plugin failed to import scripts from "+i);n(s,o)}}catch(l){n(l.toString())}};He.prototype.getAvailableImages=function e(t){var r=this.availableImages[t];if(!r){r=[]}return r};He.prototype.getLayerIndex=function e(t){var r=this.layerIndexes[t];if(!r){r=this.layerIndexes[t]=new n}return r};He.prototype.getWorkerSource=function e(t,r,a){var n=this;if(!this.workerSources[t]){this.workerSources[t]={}}if(!this.workerSources[t][r]){this.workerSources[t][r]={}}if(!this.workerSources[t][r][a]){var i={send:function(e,r,a){n.actor.send(e,r,a,t)}};this.workerSources[t][r][a]=new this.workerSourceTypes[r](i,this.getLayerIndex(t),this.getAvailableImages(t))}return this.workerSources[t][r][a]};He.prototype.getDEMWorkerSource=function e(t,r){if(!this.demWorkerSources[t]){this.demWorkerSources[t]={}}if(!this.demWorkerSources[t][r]){this.demWorkerSources[t][r]=new h}return this.demWorkerSources[t][r]};He.prototype.enforceCacheSizeLimit=function t(r,a){e.enforceCacheSizeLimit(a)};if(typeof WorkerGlobalScope!=="undefined"&&typeof e.window!=="undefined"&&e.window instanceof WorkerGlobalScope){e.window.worker=new He(e.window)}return He}));a(["./shared"],(function(e){"use strict";var t=e.createCommonjsModule((function(e){if(e.exports){e.exports=t}else if(window){window.mapboxgl=window.mapboxgl||{};window.mapboxgl.supported=t;window.mapboxgl.notSupportedReason=r}function t(e){return!r(e)}function r(e){if(!a()){return"not a browser"}if(!n()){return"insufficent Array support"}if(!i()){return"insufficient Function support"}if(!o()){return"insufficient Object support"}if(!s()){return"insufficient JSON support"}if(!l()){return"insufficient worker support"}if(!u()){return"insufficient Uint8ClampedArray support"}if(!c()){return"insufficient ArrayBuffer support"}if(!f()){return"insufficient Canvas/getImageData support"}if(!p(e&&e.failIfMajorPerformanceCaveat)){return"insufficient WebGL support"}}function a(){return typeof window!=="undefined"&&typeof document!=="undefined"}function n(){return Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray}function i(){return Function.prototype&&Function.prototype.bind}function o(){return Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions}function s(){return"JSON"in window&&"parse"in JSON&&"stringify"in JSON}function l(){if(!("Worker"in window&&"Blob"in window&&"URL"in window)){return false}var e=new Blob([""],{type:"text/javascript"});var t=URL.createObjectURL(e);var r;var a;try{a=new Worker(t);r=true}catch(n){r=false}if(a){a.terminate()}URL.revokeObjectURL(t);return r}function u(){return"Uint8ClampedArray"in window}function c(){return ArrayBuffer.isView}function f(){var e=document.createElement("canvas");e.width=e.height=1;var t=e.getContext("2d");if(!t){return false}var r=t.getImageData(0,0,1,1);return r&&r.width===e.width}var h={};function p(e){if(h[e]===undefined){h[e]=d(e)}return h[e]}t.webGLContextAttributes={antialias:false,alpha:true,stencil:true,depth:true};function v(e){var r=document.createElement("canvas");var a=Object.create(t.webGLContextAttributes);a.failIfMajorPerformanceCaveat=e;if(r.probablySupportsContext){return r.probablySupportsContext("webgl",a)||r.probablySupportsContext("experimental-webgl",a)}else if(r.supportsContext){return r.supportsContext("webgl",a)||r.supportsContext("experimental-webgl",a)}else{return r.getContext("webgl",a)||r.getContext("experimental-webgl",a)}}function d(e){var t=v(e);if(!t){return false}var r=t.createShader(t.VERTEX_SHADER);if(!r||t.isContextLost()){return false}t.shaderSource(r,"void main() {}");t.compileShader(r);return t.getShaderParameter(r,t.COMPILE_STATUS)===true}}));var r={};r.create=function(t,r,a){var n=e.window.document.createElement(t);if(r!==undefined){n.className=r}if(a){a.appendChild(n)}return n};r.createNS=function(t,r){var a=e.window.document.createElementNS(t,r);return a};var a=e.window.document.documentElement.style;function n(e){if(!a){return e[0]}for(var t=0;t<e.length;t++){if(e[t]in a){return e[t]}}return e[0]}var i=n(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);var o;r.disableDrag=function(){if(a&&i){o=a[i];a[i]="none"}};r.enableDrag=function(){if(a&&i){a[i]=o}};var s=n(["transform","WebkitTransform"]);r.setTransform=function(e,t){e.style[s]=t};var l=false;try{var u=Object.defineProperty({},"passive",{get:function e(){l=true}});e.window.addEventListener("test",u,u);e.window.removeEventListener("test",u,u)}catch(Bs){l=false}r.addEventListener=function(e,t,r,a){if(a===void 0)a={};if("passive"in a&&l){e.addEventListener(t,r,a)}else{e.addEventListener(t,r,a.capture)}};r.removeEventListener=function(e,t,r,a){if(a===void 0)a={};if("passive"in a&&l){e.removeEventListener(t,r,a)}else{e.removeEventListener(t,r,a.capture)}};var c=function(t){t.preventDefault();t.stopPropagation();e.window.removeEventListener("click",c,true)};r.suppressClick=function(){e.window.addEventListener("click",c,true);e.window.setTimeout((function(){e.window.removeEventListener("click",c,true)}),0)};r.mousePos=function(t,r){var a=t.getBoundingClientRect();return new e.Point(r.clientX-a.left-t.clientLeft,r.clientY-a.top-t.clientTop)};r.touchPos=function(t,r){var a=t.getBoundingClientRect(),n=[];for(var i=0;i<r.length;i++){n.push(new e.Point(r[i].clientX-a.left-t.clientLeft,r[i].clientY-a.top-t.clientTop))}return n};r.mouseButton=function(t){if(typeof e.window.InstallTrigger!=="undefined"&&t.button===2&&t.ctrlKey&&e.window.navigator.platform.toUpperCase().indexOf("MAC")>=0){return 0}return t.button};r.remove=function(e){if(e.parentNode){e.parentNode.removeChild(e)}};function f(t,r,a){var n,i,o;var s=e.browser.devicePixelRatio>1?"@2x":"";var l=e.getJSON(r.transformRequest(r.normalizeSpriteURL(t,s,".json"),e.ResourceType.SpriteJSON),(function(e,t){l=null;if(!o){o=e;n=t;c()}}));var u=e.getImage(r.transformRequest(r.normalizeSpriteURL(t,s,".png"),e.ResourceType.SpriteImage),(function(e,t){u=null;if(!o){o=e;i=t;c()}}));function c(){if(o){a(o)}else if(n&&i){var t=e.browser.getImageData(i);var r={};for(var s in n){var l=n[s];var u=l.width;var c=l.height;var f=l.x;var h=l.y;var p=l.sdf;var v=l.pixelRatio;var d=l.stretchX;var m=l.stretchY;var g=l.content;var y=new e.RGBAImage({width:u,height:c});e.RGBAImage.copy(t,y,{x:f,y:h},{x:0,y:0},{width:u,height:c});r[s]={data:y,pixelRatio:v,sdf:p,stretchX:d,stretchY:m,content:g}}a(null,r)}}return{cancel:function e(){if(l){l.cancel();l=null}if(u){u.cancel();u=null}}}}function h(e){var t=e.userImage;if(t&&t.render){var r=t.render();if(r){e.data.replace(new Uint8Array(t.data.buffer));return true}}return false}var p=1;var v=function(t){function r(){t.call(this);this.images={};this.updatedImages={};this.callbackDispatchedThisFrame={};this.loaded=false;this.requestors=[];this.patterns={};this.atlasImage=new e.RGBAImage({width:1,height:1});this.dirty=true}if(t)r.__proto__=t;r.prototype=Object.create(t&&t.prototype);r.prototype.constructor=r;r.prototype.isLoaded=function e(){return this.loaded};r.prototype.setLoaded=function e(t){if(this.loaded===t){return}this.loaded=t;if(t){for(var r=0,a=this.requestors;r<a.length;r+=1){var n=a[r];var i=n.ids;var o=n.callback;this._notify(i,o)}this.requestors=[]}};r.prototype.getImage=function e(t){return this.images[t]};r.prototype.addImage=function e(t,r){if(this._validate(t,r)){this.images[t]=r}};r.prototype._validate=function t(r,a){var n=true;if(!this._validateStretch(a.stretchX,a.data&&a.data.width)){this.fire(new e.ErrorEvent(new Error('Image "'+r+'" has invalid "stretchX" value')));n=false}if(!this._validateStretch(a.stretchY,a.data&&a.data.height)){this.fire(new e.ErrorEvent(new Error('Image "'+r+'" has invalid "stretchY" value')));n=false}if(!this._validateContent(a.content,a)){this.fire(new e.ErrorEvent(new Error('Image "'+r+'" has invalid "content" value')));n=false}return n};r.prototype._validateStretch=function e(t,r){if(!t){return true}var a=0;for(var n=0,i=t;n<i.length;n+=1){var o=i[n];if(o[0]<a||o[1]<o[0]||r<o[1]){return false}a=o[1]}return true};r.prototype._validateContent=function e(t,r){if(!t){return true}if(t.length!==4){return false}if(t[0]<0||r.data.width<t[0]){return false}if(t[1]<0||r.data.height<t[1]){return false}if(t[2]<0||r.data.width<t[2]){return false}if(t[3]<0||r.data.height<t[3]){return false}if(t[2]<t[0]){return false}if(t[3]<t[1]){return false}return true};r.prototype.updateImage=function e(t,r){var a=this.images[t];r.version=a.version+1;this.images[t]=r;this.updatedImages[t]=true};r.prototype.removeImage=function e(t){var r=this.images[t];delete this.images[t];delete this.patterns[t];if(r.userImage&&r.userImage.onRemove){r.userImage.onRemove()}};r.prototype.listImages=function e(){return Object.keys(this.images)};r.prototype.getImages=function e(t,r){var a=true;if(!this.isLoaded()){for(var n=0,i=t;n<i.length;n+=1){var o=i[n];if(!this.images[o]){a=false}}}if(this.isLoaded()||a){this._notify(t,r)}else{this.requestors.push({ids:t,callback:r})}};r.prototype._notify=function t(r,a){var n={};for(var i=0,o=r;i<o.length;i+=1){var s=o[i];if(!this.images[s]){this.fire(new e.Event("styleimagemissing",{id:s}))}var l=this.images[s];if(l){n[s]={data:l.data.clone(),pixelRatio:l.pixelRatio,sdf:l.sdf,version:l.version,stretchX:l.stretchX,stretchY:l.stretchY,content:l.content,hasRenderCallback:Boolean(l.userImage&&l.userImage.render)}}else{e.warnOnce('Image "'+s+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}}a(null,n)};r.prototype.getPixelSize=function e(){var t=this.atlasImage;var r=t.width;var a=t.height;return{width:r,height:a}};r.prototype.getPattern=function t(r){var a=this.patterns[r];var n=this.getImage(r);if(!n){return null}if(a&&a.position.version===n.version){return a.position}if(!a){var i=n.data.width+p*2;var o=n.data.height+p*2;var s={w:i,h:o,x:0,y:0};var l=new e.ImagePosition(s,n);this.patterns[r]={bin:s,position:l}}else{a.position.version=n.version}this._updatePatternAtlas();return this.patterns[r].position};r.prototype.bind=function t(r){var a=r.gl;if(!this.atlasTexture){this.atlasTexture=new e.Texture(r,this.atlasImage,a.RGBA)}else if(this.dirty){this.atlasTexture.update(this.atlasImage);this.dirty=false}this.atlasTexture.bind(a.LINEAR,a.CLAMP_TO_EDGE)};r.prototype._updatePatternAtlas=function t(){var r=[];for(var a in this.patterns){r.push(this.patterns[a].bin)}var n=e.potpack(r);var i=n.w;var o=n.h;var s=this.atlasImage;s.resize({width:i||1,height:o||1});for(var l in this.patterns){var u=this.patterns[l];var c=u.bin;var f=c.x+p;var h=c.y+p;var v=this.images[l].data;var d=v.width;var m=v.height;e.RGBAImage.copy(v,s,{x:0,y:0},{x:f,y:h},{width:d,height:m});e.RGBAImage.copy(v,s,{x:0,y:m-1},{x:f,y:h-1},{width:d,height:1});e.RGBAImage.copy(v,s,{x:0,y:0},{x:f,y:h+m},{width:d,height:1});e.RGBAImage.copy(v,s,{x:d-1,y:0},{x:f-1,y:h},{width:1,height:m});e.RGBAImage.copy(v,s,{x:0,y:0},{x:f+d,y:h},{width:1,height:m})}this.dirty=true};r.prototype.beginFrame=function e(){this.callbackDispatchedThisFrame={}};r.prototype.dispatchRenderCallbacks=function e(t){for(var r=0,a=t;r<a.length;r+=1){var n=a[r];if(this.callbackDispatchedThisFrame[n]){continue}this.callbackDispatchedThisFrame[n]=true;var i=this.images[n];var o=h(i);if(o){this.updateImage(n,i)}}};return r}(e.Evented);function d(t,r,a,n,i){var o=r*256;var s=o+255;var l=n.transformRequest(n.normalizeGlyphsURL(a).replace("{fontstack}",t).replace("{range}",o+"-"+s),e.ResourceType.Glyphs);e.getArrayBuffer(l,(function(t,r){if(t){i(t)}else if(r){var a={};for(var n=0,o=e.parseGlyphPBF(r);n<o.length;n+=1){var s=o[n];a[s.id]=s}i(null,a)}}))}var m=x;var g=x;var y=1e20;function x(e,t,r,a,n,i){this.fontSize=e||24;this.buffer=t===undefined?3:t;this.cutoff=a||.25;this.fontFamily=n||"sans-serif";this.fontWeight=i||"normal";this.radius=r||8;var o=this.size=this.fontSize+this.buffer*2;this.canvas=document.createElement("canvas");this.canvas.width=this.canvas.height=o;this.ctx=this.canvas.getContext("2d");this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily;this.ctx.textBaseline="middle";this.ctx.fillStyle="black";this.gridOuter=new Float64Array(o*o);this.gridInner=new Float64Array(o*o);this.f=new Float64Array(o);this.d=new Float64Array(o);this.z=new Float64Array(o+1);this.v=new Int16Array(o);this.middle=Math.round(o/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}x.prototype.draw=function(e){this.ctx.clearRect(0,0,this.size,this.size);this.ctx.fillText(e,this.buffer,this.middle);var t=this.ctx.getImageData(0,0,this.size,this.size);var r=new Uint8ClampedArray(this.size*this.size);for(var a=0;a<this.size*this.size;a++){var n=t.data[a*4+3]/255;this.gridOuter[a]=n===1?0:n===0?y:Math.pow(Math.max(0,.5-n),2);this.gridInner[a]=n===1?y:n===0?0:Math.pow(Math.max(0,n-.5),2)}b(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z);b(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z);for(a=0;a<this.size*this.size;a++){var i=this.gridOuter[a]-this.gridInner[a];r[a]=Math.max(0,Math.min(255,Math.round(255-255*(i/this.radius+this.cutoff))))}return r};function b(e,t,r,a,n,i,o){for(var s=0;s<t;s++){for(var l=0;l<r;l++){a[l]=e[l*t+s]}_(a,n,i,o,r);for(l=0;l<r;l++){e[l*t+s]=n[l]}}for(l=0;l<r;l++){for(s=0;s<t;s++){a[s]=e[l*t+s]}_(a,n,i,o,t);for(s=0;s<t;s++){e[l*t+s]=Math.sqrt(n[s])}}}function _(e,t,r,a,n){r[0]=0;a[0]=-y;a[1]=+y;for(var i=1,o=0;i<n;i++){var s=(e[i]+i*i-(e[r[o]]+r[o]*r[o]))/(2*i-2*r[o]);while(s<=a[o]){o--;s=(e[i]+i*i-(e[r[o]]+r[o]*r[o]))/(2*i-2*r[o])}o++;r[o]=i;a[o]=s;a[o+1]=+y}for(i=0,o=0;i<n;i++){while(a[o+1]<i){o++}t[i]=(i-r[o])*(i-r[o])+e[r[o]]}}m.default=g;var w=function e(t,r){this.requestManager=t;this.localIdeographFontFamily=r;this.entries={}};w.prototype.setURL=function e(t){this.url=t};w.prototype.getGlyphs=function t(r,a){var n=this;var i=[];for(var o in r){for(var s=0,l=r[o];s<l.length;s+=1){var u=l[s];i.push({stack:o,id:u})}}e.asyncAll(i,(function(e,t){var r=e.stack;var a=e.id;var i=n.entries[r];if(!i){i=n.entries[r]={glyphs:{},requests:{},ranges:{}}}var o=i.glyphs[a];if(o!==undefined){t(null,{stack:r,id:a,glyph:o});return}o=n._tinySDF(i,r,a);if(o){i.glyphs[a]=o;t(null,{stack:r,id:a,glyph:o});return}var s=Math.floor(a/256);if(s*256>65535){t(new Error("glyphs > 65535 not supported"));return}if(i.ranges[s]){t(null,{stack:r,id:a,glyph:o});return}var l=i.requests[s];if(!l){l=i.requests[s]=[];w.loadGlyphRange(r,s,n.url,n.requestManager,(function(e,t){if(t){for(var r in t){if(!n._doesCharSupportLocalGlyph(+r)){i.glyphs[+r]=t[+r]}}i.ranges[s]=true}for(var a=0,o=l;a<o.length;a+=1){var u=o[a];u(e,t)}delete i.requests[s]}))}l.push((function(e,n){if(e){t(e)}else if(n){t(null,{stack:r,id:a,glyph:n[a]||null})}}))}),(function(e,t){if(e){a(e)}else if(t){var r={};for(var n=0,i=t;n<i.length;n+=1){var o=i[n];var s=o.stack;var l=o.id;var u=o.glyph;(r[s]||(r[s]={}))[l]=u&&{id:u.id,bitmap:u.bitmap.clone(),metrics:u.metrics}}a(null,r)}}))};w.prototype._doesCharSupportLocalGlyph=function t(r){return!!this.localIdeographFontFamily&&(e.isChar["CJK Unified Ideographs"](r)||e.isChar["Hangul Syllables"](r)||e.isChar["Hiragana"](r)||e.isChar["Katakana"](r))};w.prototype._tinySDF=function t(r,a,n){var i=this.localIdeographFontFamily;if(!i){return}if(!this._doesCharSupportLocalGlyph(n)){return}var o=r.tinySDF;if(!o){var s="400";if(/bold/i.test(a)){s="900"}else if(/medium/i.test(a)){s="500"}else if(/light/i.test(a)){s="200"}o=r.tinySDF=new w.TinySDF(24,3,8,.25,i,s)}return{id:n,bitmap:new e.AlphaImage({width:30,height:30},o.draw(String.fromCharCode(n))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}};w.loadGlyphRange=d;w.TinySDF=m;var T=function t(){this.specification=e.styleSpec.light.position};T.prototype.possiblyEvaluate=function t(r,a){return e.sphericalToCartesian(r.expression.evaluate(a))};T.prototype.interpolate=function t(r,a,n){return{x:e.number(r.x,a.x,n),y:e.number(r.y,a.y,n),z:e.number(r.z,a.z,n)}};var k=new e.Properties({anchor:new e.DataConstantProperty(e.styleSpec.light.anchor),position:new T,color:new e.DataConstantProperty(e.styleSpec.light.color),intensity:new e.DataConstantProperty(e.styleSpec.light.intensity)});var M="-transition";var A=function(t){function r(r){t.call(this);this._transitionable=new e.Transitionable(k);this.setLight(r);this._transitioning=this._transitionable.untransitioned()}if(t)r.__proto__=t;r.prototype=Object.create(t&&t.prototype);r.prototype.constructor=r;r.prototype.getLight=function e(){return this._transitionable.serialize()};r.prototype.setLight=function t(r,a){if(a===void 0)a={};if(this._validate(e.validateLight,r,a)){return}for(var n in r){var i=r[n];if(e.endsWith(n,M)){this._transitionable.setTransition(n.slice(0,-M.length),i)}else{this._transitionable.setValue(n,i)}}};r.prototype.updateTransitions=function e(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)};r.prototype.hasTransition=function e(){return this._transitioning.hasTransition()};r.prototype.recalculate=function e(t){this.properties=this._transitioning.possiblyEvaluate(t)};r.prototype._validate=function t(r,a,n){if(n&&n.validate===false){return false}return e.emitValidationErrors(this,r.call(e.validateStyle,e.extend({value:a,style:{glyphs:true,sprite:true},styleSpec:e.styleSpec})))};return r}(e.Evented);var S=function e(t,r){this.width=t;this.height=r;this.nextRow=0;this.data=new Uint8Array(this.width*this.height);this.dashEntry={}};S.prototype.getDash=function e(t,r){var a=t.join(",")+String(r);if(!this.dashEntry[a]){this.dashEntry[a]=this.addDash(t,r)}return this.dashEntry[a]};S.prototype.getDashRanges=function e(t,r,a){var n=t.length%2===1;var i=[];var o=n?-t[t.length-1]*a:0;var s=t[0]*a;var l=true;i.push({left:o,right:s,isDash:l,zeroLength:t[0]===0});var u=t[0];for(var c=1;c<t.length;c++){l=!l;var f=t[c];o=u*a;u+=f;s=u*a;i.push({left:o,right:s,isDash:l,zeroLength:f===0})}return i};S.prototype.addRoundDash=function e(t,r,a){var n=r/2;for(var i=-a;i<=a;i++){var o=this.nextRow+a+i;var s=this.width*o;var l=0;var u=t[l];for(var c=0;c<this.width;c++){if(c/u.right>1){u=t[++l]}var f=Math.abs(c-u.left);var h=Math.abs(c-u.right);var p=Math.min(f,h);var v=void 0;var d=i/a*(n+1);if(u.isDash){var m=n-Math.abs(d);v=Math.sqrt(p*p+m*m)}else{v=n-Math.sqrt(p*p+d*d)}this.data[s+c]=Math.max(0,Math.min(255,v+128))}}};S.prototype.addRegularDash=function e(t){for(var r=t.length-1;r>=0;--r){var a=t[r];var n=t[r+1];if(a.zeroLength){t.splice(r,1)}else if(n&&n.isDash===a.isDash){n.left=a.left;t.splice(r,1)}}var i=t[0];var o=t[t.length-1];if(i.isDash===o.isDash){i.left=o.left-this.width;o.right=i.right+this.width}var s=this.width*this.nextRow;var l=0;var u=t[l];for(var c=0;c<this.width;c++){if(c/u.right>1){u=t[++l]}var f=Math.abs(c-u.left);var h=Math.abs(c-u.right);var p=Math.min(f,h);var v=u.isDash?p:-p;this.data[s+c]=Math.max(0,Math.min(255,v+128))}};S.prototype.addDash=function t(r,a){var n=a?7:0;var i=2*n+1;if(this.nextRow+i>this.height){e.warnOnce("LineAtlas out of space");return null}var o=0;for(var s=0;s<r.length;s++){o+=r[s]}if(o!==0){var l=this.width/o;var u=this.getDashRanges(r,this.width,l);if(a){this.addRoundDash(u,l,n)}else{this.addRegularDash(u)}}var c={y:(this.nextRow+n+.5)/this.height,height:2*n/this.height,width:o};this.nextRow+=i;this.dirty=true;return c};S.prototype.bind=function e(t){var r=t.gl;if(!this.texture){this.texture=r.createTexture();r.bindTexture(r.TEXTURE_2D,this.texture);r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.REPEAT);r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.REPEAT);r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR);r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR);r.texImage2D(r.TEXTURE_2D,0,r.ALPHA,this.width,this.height,0,r.ALPHA,r.UNSIGNED_BYTE,this.data)}else{r.bindTexture(r.TEXTURE_2D,this.texture);if(this.dirty){this.dirty=false;r.texSubImage2D(r.TEXTURE_2D,0,0,0,this.width,this.height,r.ALPHA,r.UNSIGNED_BYTE,this.data)}}};var E=function t(r,a){this.workerPool=r;this.actors=[];this.currentActor=0;this.id=e.uniqueId();var n=this.workerPool.acquire(this.id);for(var i=0;i<n.length;i++){var o=n[i];var s=new t.Actor(o,a,this.id);s.name="Worker "+i;this.actors.push(s)}};E.prototype.broadcast=function t(r,a,n){n=n||function(){};e.asyncAll(this.actors,(function(e,t){e.send(r,a,t)}),n)};E.prototype.getActor=function e(){this.currentActor=(this.currentActor+1)%this.actors.length;return this.actors[this.currentActor]};E.prototype.remove=function e(){this.actors.forEach((function(e){e.remove()}));this.actors=[];this.workerPool.release(this.id)};E.Actor=e.Actor;function L(t,r,a){var n=function(n,i){if(n){return a(n)}else if(i){var o=e.pick(e.extend(i,t),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);if(i.vector_layers){o.vectorLayers=i.vector_layers;o.vectorLayerIds=o.vectorLayers.map((function(e){return e.id}))}o.tiles=r.canonicalizeTileset(o,t.url);a(null,o)}};if(t.url){return e.getJSON(r.transformRequest(r.normalizeSourceURL(t.url),e.ResourceType.Source),n)}else{return e.browser.frame((function(){return n(null,t)}))}}var C=function t(r,a,n){this.bounds=e.LngLatBounds.convert(this.validateBounds(r));this.minzoom=a||0;this.maxzoom=n||24};C.prototype.validateBounds=function e(t){if(!Array.isArray(t)||t.length!==4){return[-180,-90,180,90]}return[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]};C.prototype.contains=function t(r){var a=Math.pow(2,r.z);var n={minX:Math.floor(e.mercatorXfromLng(this.bounds.getWest())*a),minY:Math.floor(e.mercatorYfromLat(this.bounds.getNorth())*a),maxX:Math.ceil(e.mercatorXfromLng(this.bounds.getEast())*a),maxY:Math.ceil(e.mercatorYfromLat(this.bounds.getSouth())*a)};var i=r.x>=n.minX&&r.x<n.maxX&&r.y>=n.minY&&r.y<n.maxY;return i};var I=function(t){function r(r,a,n,i){t.call(this);this.id=r;this.dispatcher=n;this.type="vector";this.minzoom=0;this.maxzoom=22;this.scheme="xyz";this.tileSize=512;this.reparseOverscaled=true;this.isTileClipped=true;this._loaded=false;e.extend(this,e.pick(a,["url","scheme","tileSize","promoteId"]));this._options=e.extend({type:"vector"},a);this._collectResourceTiming=a.collectResourceTiming;if(this.tileSize!==512){throw new Error("vector tile sources must have a tileSize of 512")}this.setEventedParent(i)}if(t)r.__proto__=t;r.prototype=Object.create(t&&t.prototype);r.prototype.constructor=r;r.prototype.load=function t(){var r=this;this._loaded=false;this.fire(new e.Event("dataloading",{dataType:"source"}));this._tileJSONRequest=L(this._options,this.map._requestManager,(function(t,a){r._tileJSONRequest=null;r._loaded=true;if(t){r.fire(new e.ErrorEvent(t))}else if(a){e.extend(r,a);if(a.bounds){r.tileBounds=new C(a.bounds,r.minzoom,r.maxzoom)}e.postTurnstileEvent(a.tiles,r.map._requestManager._customAccessToken);e.postMapLoadEvent(a.tiles,r.map._getMapId(),r.map._requestManager._skuToken,r.map._requestManager._customAccessToken);r.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"}));r.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"}))}}))};r.prototype.loaded=function e(){return this._loaded};r.prototype.hasTile=function e(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)};r.prototype.onAdd=function e(t){this.map=t;this.load()};r.prototype.onRemove=function e(){if(this._tileJSONRequest){this._tileJSONRequest.cancel();this._tileJSONRequest=null}};r.prototype.serialize=function t(){return e.extend({},this._options)};r.prototype.loadTile=function t(r,a){var n=this.map._requestManager.normalizeTileURL(r.tileID.canonical.url(this.tiles,this.scheme));var i={request:this.map._requestManager.transformRequest(n,e.ResourceType.Tile),uid:r.uid,tileID:r.tileID,zoom:r.tileID.overscaledZ,tileSize:this.tileSize*r.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:e.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};i.request.collectResourceTiming=this._collectResourceTiming;if(!r.actor||r.state==="expired"){r.actor=this.dispatcher.getActor();r.request=r.actor.send("loadTile",i,o.bind(this))}else if(r.state==="loading"){r.reloadCallback=a}else{r.request=r.actor.send("reloadTile",i,o.bind(this))}function o(t,n){delete r.request;if(r.aborted){return a(null)}if(t&&t.status!==404){return a(t)}if(n&&n.resourceTiming){r.resourceTiming=n.resourceTiming}if(this.map._refreshExpiredTiles&&n){r.setExpiryData(n)}r.loadVectorData(n,this.map.painter);e.cacheEntryPossiblyAdded(this.dispatcher);a(null);if(r.reloadCallback){this.loadTile(r,r.reloadCallback);r.reloadCallback=null}}};r.prototype.abortTile=function e(t){if(t.request){t.request.cancel();delete t.request}if(t.actor){t.actor.send("abortTile",{uid:t.uid,type:this.type,source:this.id},undefined)}};r.prototype.unloadTile=function e(t){t.unloadVectorData();if(t.actor){t.actor.send("removeTile",{uid:t.uid,type:this.type,source:this.id},undefined)}};r.prototype.hasTransition=function e(){return false};return r}(e.Evented);var P=function(t){function r(r,a,n,i){t.call(this);this.id=r;this.dispatcher=n;this.setEventedParent(i);this.type="raster";this.minzoom=0;this.maxzoom=22;this.roundZoom=true;this.scheme="xyz";this.tileSize=512;this._loaded=false;this._options=e.extend({type:"raster"},a);e.extend(this,e.pick(a,["url","scheme","tileSize"]))}if(t)r.__proto__=t;r.prototype=Object.create(t&&t.prototype);r.prototype.constructor=r;r.prototype.load=function t(){var r=this;this._loaded=false;this.fire(new e.Event("dataloading",{dataType:"source"}));this._tileJSONRequest=L(this._options,this.map._requestManager,(function(t,a){r._tileJSONRequest=null;r._loaded=true;if(t){r.fire(new e.ErrorEvent(t))}else if(a){e.extend(r,a);if(a.bounds){r.tileBounds=new C(a.bounds,r.minzoom,r.maxzoom)}e.postTurnstileEvent(a.tiles);e.postMapLoadEvent(a.tiles,r.map._getMapId(),r.map._requestManager._skuToken);r.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"}));r.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"}))}}))};r.prototype.loaded=function e(){return this._loaded};r.prototype.onAdd=function e(t){this.map=t;this.load()};r.prototype.onRemove=function e(){if(this._tileJSONRequest){this._tileJSONRequest.cancel();this._tileJSONRequest=null}};r.prototype.serialize=function t(){return e.extend({},this._options)};r.prototype.hasTile=function e(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)};r.prototype.loadTile=function t(r,a){var n=this;var i=this.map._requestManager.normalizeTileURL(r.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);r.request=e.getImage(this.map._requestManager.transformRequest(i,e.ResourceType.Tile),(function(t,i){delete r.request;if(r.aborted){r.state="unloaded";a(null)}else if(t){r.state="errored";a(t)}else if(i){if(n.map._refreshExpiredTiles){r.setExpiryData(i)}delete i.cacheControl;delete i.expires;var o=n.map.painter.context;var s=o.gl;r.texture=n.map.painter.getTileTexture(i.width);if(r.texture){r.texture.update(i,{useMipmap:true})}else{r.texture=new e.Texture(o,i,s.RGBA,{useMipmap:true});r.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE,s.LINEAR_MIPMAP_NEAREST);if(o.extTextureFilterAnisotropic){s.texParameterf(s.TEXTURE_2D,o.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,o.extTextureFilterAnisotropicMax)}}r.state="loaded";e.cacheEntryPossiblyAdded(n.dispatcher);a(null)}}))};r.prototype.abortTile=function e(t,r){if(t.request){t.request.cancel();delete t.request}r()};r.prototype.unloadTile=function e(t,r){if(t.texture){this.map.painter.saveTileTexture(t.texture)}r()};r.prototype.hasTransition=function e(){return false};return r}(e.Evented);var O=function(t){function r(r,a,n,i){t.call(this,r,a,n,i);this.type="raster-dem";this.maxzoom=22;this._options=e.extend({type:"raster-dem"},a);this.encoding=a.encoding||"mapbox"}if(t)r.__proto__=t;r.prototype=Object.create(t&&t.prototype);r.prototype.constructor=r;r.prototype.serialize=function e(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}};r.prototype.loadTile=function t(r,a){var n=this.map._requestManager.normalizeTileURL(r.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);r.request=e.getImage(this.map._requestManager.transformRequest(n,e.ResourceType.Tile),i.bind(this));r.neighboringTiles=this._getNeighboringTiles(r.tileID);function i(t,n){delete r.request;if(r.aborted){r.state="unloaded";a(null)}else if(t){r.state="errored";a(t)}else if(n){if(this.map._refreshExpiredTiles){r.setExpiryData(n)}delete n.cacheControl;delete n.expires;var i=e.window.ImageBitmap&&n instanceof e.window.ImageBitmap&&e.offscreenCanvasSupported();var s=i?n:e.browser.getImageData(n,1);var l={uid:r.uid,coord:r.tileID,source:this.id,rawImageData:s,encoding:this.encoding};if(!r.actor||r.state==="expired"){r.actor=this.dispatcher.getActor();r.actor.send("loadDEMTile",l,o.bind(this))}}}function o(e,t){if(e){r.state="errored";a(e)}if(t){r.dem=t;r.needsHillshadePrepare=true;r.state="loaded";a(null)}}};r.prototype._getNeighboringTiles=function t(r){var a=r.canonical;var n=Math.pow(2,a.z);var i=(a.x-1+n)%n;var o=a.x===0?r.wrap-1:r.wrap;var s=(a.x+1+n)%n;var l=a.x+1===n?r.wrap+1:r.wrap;var u={};u[new e.OverscaledTileID(r.overscaledZ,o,a.z,i,a.y).key]={backfilled:false};u[new e.OverscaledTileID(r.overscaledZ,l,a.z,s,a.y).key]={backfilled:false};if(a.y>0){u[new e.OverscaledTileID(r.overscaledZ,o,a.z,i,a.y-1).key]={backfilled:false};u[new e.OverscaledTileID(r.overscaledZ,r.wrap,a.z,a.x,a.y-1).key]={backfilled:false};u[new e.OverscaledTileID(r.overscaledZ,l,a.z,s,a.y-1).key]={backfilled:false}}if(a.y+1<n){u[new e.OverscaledTileID(r.overscaledZ,o,a.z,i,a.y+1).key]={backfilled:false};u[new e.OverscaledTileID(r.overscaledZ,r.wrap,a.z,a.x,a.y+1).key]={backfilled:false};u[new e.OverscaledTileID(r.overscaledZ,l,a.z,s,a.y+1).key]={backfilled:false}}return u};r.prototype.unloadTile=function e(t){if(t.demTexture){this.map.painter.saveTileTexture(t.demTexture)}if(t.fbo){t.fbo.destroy();delete t.fbo}if(t.dem){delete t.dem}delete t.neighboringTiles;t.state="unloaded";if(t.actor){t.actor.send("removeDEMTile",{uid:t.uid,source:this.id})}};return r}(P);var z=function(t){function r(r,a,n,i){t.call(this);this.id=r;this.type="geojson";this.minzoom=0;this.maxzoom=18;this.tileSize=512;this.isTileClipped=true;this.reparseOverscaled=true;this._removed=false;this._loaded=false;this.actor=n.getActor();this.setEventedParent(i);this._data=a.data;this._options=e.extend({},a);this._collectResourceTiming=a.collectResourceTiming;this._resourceTiming=[];if(a.maxzoom!==undefined){this.maxzoom=a.maxzoom}if(a.type){this.type=a.type}if(a.attribution){this.attribution=a.attribution}this.promoteId=a.promoteId;var o=e.EXTENT/this.tileSize;this.workerOptions=e.extend({source:this.id,cluster:a.cluster||false,geojsonVtOptions:{buffer:(a.buffer!==undefined?a.buffer:128)*o,tolerance:(a.tolerance!==undefined?a.tolerance:.375)*o,extent:e.EXTENT,maxZoom:this.maxzoom,lineMetrics:a.lineMetrics||false,generateId:a.generateId||false},superclusterOptions:{maxZoom:a.clusterMaxZoom!==undefined?Math.min(a.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,extent:e.EXTENT,radius:(a.clusterRadius||50)*o,log:false,generateId:a.generateId||false},clusterProperties:a.clusterProperties},a.workerOptions)}if(t)r.__proto__=t;r.prototype=Object.create(t&&t.prototype);r.prototype.constructor=r;r.prototype.load=function t(){var r=this;this.fire(new e.Event("dataloading",{dataType:"source"}));this._updateWorkerData((function(t){if(t){r.fire(new e.ErrorEvent(t));return}var a={dataType:"source",sourceDataType:"metadata"};if(r._collectResourceTiming&&r._resourceTiming&&r._resourceTiming.length>0){a.resourceTiming=r._resourceTiming;r._resourceTiming=[]}r.fire(new e.Event("data",a))}))};r.prototype.onAdd=function e(t){this.map=t;this.load()};r.prototype.setData=function t(r){var a=this;this._data=r;this.fire(new e.Event("dataloading",{dataType:"source"}));this._updateWorkerData((function(t){if(t){a.fire(new e.ErrorEvent(t));return}var r={dataType:"source",sourceDataType:"content"};if(a._collectResourceTiming&&a._resourceTiming&&a._resourceTiming.length>0){r.resourceTiming=a._resourceTiming;a._resourceTiming=[]}a.fire(new e.Event("data",r))}));return this};r.prototype.getClusterExpansionZoom=function e(t,r){this.actor.send("geojson.getClusterExpansionZoom",{clusterId:t,source:this.id},r);return this};r.prototype.getClusterChildren=function e(t,r){this.actor.send("geojson.getClusterChildren",{clusterId:t,source:this.id},r);return this};r.prototype.getClusterLeaves=function e(t,r,a,n){this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:t,limit:r,offset:a},n);return this};r.prototype._updateWorkerData=function t(r){var a=this;this._loaded=false;var n=e.extend({},this.workerOptions);var i=this._data;if(typeof i==="string"){n.request=this.map._requestManager.transformRequest(e.browser.resolveURL(i),e.ResourceType.Source);n.request.collectResourceTiming=this._collectResourceTiming}else{n.data=JSON.stringify(i)}this.actor.send(this.type+".loadData",n,(function(e,t){if(a._removed||t&&t.abandoned){return}a._loaded=true;if(t&&t.resourceTiming&&t.resourceTiming[a.id]){a._resourceTiming=t.resourceTiming[a.id].slice(0)}a.actor.send(a.type+".coalesce",{source:n.source},null);r(e)}))};r.prototype.loaded=function e(){return this._loaded};r.prototype.loadTile=function t(r,a){var n=this;var i=!r.actor?"loadTile":"reloadTile";r.actor=this.actor;var o={type:this.type,uid:r.uid,tileID:r.tileID,zoom:r.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:e.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};r.request=this.actor.send(i,o,(function(e,t){delete r.request;r.unloadVectorData();if(r.aborted){return a(null)}if(e){return a(e)}r.loadVectorData(t,n.map.painter,i==="reloadTile");return a(null)}))};r.prototype.abortTile=function e(t){if(t.request){t.request.cancel();delete t.request}t.aborted=true};r.prototype.unloadTile=function e(t){t.unloadVectorData();this.actor.send("removeTile",{uid:t.uid,type:this.type,source:this.id})};r.prototype.onRemove=function e(){this._removed=true;this.actor.send("removeSource",{type:this.type,source:this.id})};r.prototype.serialize=function t(){return e.extend({},this._options,{type:this.type,data:this._data})};r.prototype.hasTransition=function e(){return false};return r}(e.Evented);var D=e.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);var R=function(t){function r(e,r,a,n){t.call(this);this.id=e;this.dispatcher=a;this.coordinates=r.coordinates;this.type="image";this.minzoom=0;this.maxzoom=22;this.tileSize=512;this.tiles={};this._loaded=false;this.setEventedParent(n);this.options=r}if(t)r.__proto__=t;r.prototype=Object.create(t&&t.prototype);r.prototype.constructor=r;r.prototype.load=function t(r,a){var n=this;this._loaded=false;this.fire(new e.Event("dataloading",{dataType:"source"}));this.url=this.options.url;e.getImage(this.map._requestManager.transformRequest(this.url,e.ResourceType.Image),(function(t,i){n._loaded=true;if(t){n.fire(new e.ErrorEvent(t))}else if(i){n.image=i;if(r){n.coordinates=r}if(a){a()}n._finishLoading()}}))};r.prototype.loaded=function e(){return this._loaded};r.prototype.updateImage=function e(t){var r=this;if(!this.image||!t.url){return this}this.options.url=t.url;this.load(t.coordinates,(function(){r.texture=null}));return this};r.prototype._finishLoading=function t(){if(this.map){this.setCoordinates(this.coordinates);this.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"}))}};r.prototype.onAdd=function e(t){this.map=t;this.load()};r.prototype.setCoordinates=function t(r){var a=this;this.coordinates=r;var n=r.map(e.MercatorCoordinate.fromLngLat);this.tileID=F(n);this.minzoom=this.maxzoom=this.tileID.z;var i=n.map((function(e){return a.tileID.getTilePoint(e)._round()}));this._boundsArray=new e.StructArrayLayout4i8;this._boundsArray.emplaceBack(i[0].x,i[0].y,0,0);this._boundsArray.emplaceBack(i[1].x,i[1].y,e.EXTENT,0);this._boundsArray.emplaceBack(i[3].x,i[3].y,0,e.EXTENT);this._boundsArray.emplaceBack(i[2].x,i[2].y,e.EXTENT,e.EXTENT);if(this.boundsBuffer){this.boundsBuffer.destroy();delete this.boundsBuffer}this.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"}));return this};r.prototype.prepare=function t(){if(Object.keys(this.tiles).length===0||!this.image){return}var r=this.map.painter.context;var a=r.gl;if(!this.boundsBuffer){this.boundsBuffer=r.createVertexBuffer(this._boundsArray,D.members)}if(!this.boundsSegments){this.boundsSegments=e.SegmentVector.simpleSegment(0,0,4,2)}if(!this.texture){this.texture=new e.Texture(r,this.image,a.RGBA);this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE)}for(var n in this.tiles){var i=this.tiles[n];if(i.state!=="loaded"){i.state="loaded";i.texture=this.texture}}};r.prototype.loadTile=function e(t,r){if(this.tileID&&this.tileID.equals(t.tileID.canonical)){this.tiles[String(t.tileID.wrap)]=t;t.buckets={};r(null)}else{t.state="errored";r(null)}};r.prototype.serialize=function e(){return{type:"image",url:this.options.url,coordinates:this.coordinates}};r.prototype.hasTransition=function e(){return false};return r}(e.Evented);function F(t){var r=Infinity;var a=Infinity;var n=-Infinity;var i=-Infinity;for(var o=0,s=t;o<s.length;o+=1){var l=s[o];r=Math.min(r,l.x);a=Math.min(a,l.y);n=Math.max(n,l.x);i=Math.max(i,l.y)}var u=n-r;var c=i-a;var f=Math.max(u,c);var h=Math.max(0,Math.floor(-Math.log(f)/Math.LN2));var p=Math.pow(2,h);return new e.CanonicalTileID(h,Math.floor((r+n)/2*p),Math.floor((a+i)/2*p))}var B=function(t){function r(e,r,a,n){t.call(this,e,r,a,n);this.roundZoom=true;this.type="video";this.options=r}if(t)r.__proto__=t;r.prototype=Object.create(t&&t.prototype);r.prototype.constructor=r;r.prototype.load=function t(){var r=this;this._loaded=false;var a=this.options;this.urls=[];for(var n=0,i=a.urls;n<i.length;n+=1){var o=i[n];this.urls.push(this.map._requestManager.transformRequest(o,e.ResourceType.Source).url)}e.getVideo(this.urls,(function(t,a){r._loaded=true;if(t){r.fire(new e.ErrorEvent(t))}else if(a){r.video=a;r.video.loop=true;r.video.addEventListener("playing",(function(){r.map.triggerRepaint()}));if(r.map){r.video.play()}r._finishLoading()}}))};r.prototype.pause=function e(){if(this.video){this.video.pause()}};r.prototype.play=function e(){if(this.video){this.video.play()}};r.prototype.seek=function t(r){if(this.video){var a=this.video.seekable;if(r<a.start(0)||r>a.end(0)){this.fire(new e.ErrorEvent(new e.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+a.start(0)+" and "+a.end(0)+"-second mark.")))}else{this.video.currentTime=r}}};r.prototype.getVideo=function e(){return this.video};r.prototype.onAdd=function e(t){if(this.map){return}this.map=t;this.load();if(this.video){this.video.play();this.setCoordinates(this.coordinates)}};r.prototype.prepare=function t(){if(Object.keys(this.tiles).length===0||this.video.readyState<2){return}var r=this.map.painter.context;var a=r.gl;if(!this.boundsBuffer){this.boundsBuffer=r.createVertexBuffer(this._boundsArray,D.members)}if(!this.boundsSegments){this.boundsSegments=e.SegmentVector.simpleSegment(0,0,4,2)}if(!this.texture){this.texture=new e.Texture(r,this.video,a.RGBA);this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE)}else if(!this.video.paused){this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE);a.texSubImage2D(a.TEXTURE_2D,0,0,0,a.RGBA,a.UNSIGNED_BYTE,this.video)}for(var n in this.tiles){var i=this.tiles[n];if(i.state!=="loaded"){i.state="loaded";i.texture=this.texture}}};r.prototype.serialize=function e(){return{type:"video",urls:this.urls,coordinates:this.coordinates}};r.prototype.hasTransition=function e(){return this.video&&!this.video.paused};return r}(R);var N=function(t){function r(r,a,n,i){t.call(this,r,a,n,i);if(!a.coordinates){this.fire(new e.ErrorEvent(new e.ValidationError("sources."+r,null,'missing required property "coordinates"')))}else if(!Array.isArray(a.coordinates)||a.coordinates.length!==4||a.coordinates.some((function(e){return!Array.isArray(e)||e.length!==2||e.some((function(e){return typeof e!=="number"}))}))){this.fire(new e.ErrorEvent(new e.ValidationError("sources."+r,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs')))}if(a.animate&&typeof a.animate!=="boolean"){this.fire(new e.ErrorEvent(new e.ValidationError("sources."+r,null,'optional "animate" property must be a boolean value')))}if(!a.canvas){this.fire(new e.ErrorEvent(new e.ValidationError("sources."+r,null,'missing required property "canvas"')))}else if(typeof a.canvas!=="string"&&!(a.canvas instanceof e.window.HTMLCanvasElement)){this.fire(new e.ErrorEvent(new e.ValidationError("sources."+r,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance')))}this.options=a;this.animate=a.animate!==undefined?a.animate:true}if(t)r.__proto__=t;r.prototype=Object.create(t&&t.prototype);r.prototype.constructor=r;r.prototype.load=function t(){this._loaded=true;if(!this.canvas){this.canvas=this.options.canvas instanceof e.window.HTMLCanvasElement?this.options.canvas:e.window.document.getElementById(this.options.canvas)}this.width=this.canvas.width;this.height=this.canvas.height;if(this._hasInvalidDimensions()){this.fire(new e.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero.")));return}this.play=function(){this._playing=true;this.map.triggerRepaint()};this.pause=function(){if(this._playing){this.prepare();this._playing=false}};this._finishLoading()};r.prototype.getCanvas=function e(){return this.canvas};r.prototype.onAdd=function e(t){this.map=t;this.load();if(this.canvas){if(this.animate){this.play()}}};r.prototype.onRemove=function e(){this.pause()};r.prototype.prepare=function t(){var r=false;if(this.canvas.width!==this.width){this.width=this.canvas.width;r=true}if(this.canvas.height!==this.height){this.height=this.canvas.height;r=true}if(this._hasInvalidDimensions()){return}if(Object.keys(this.tiles).length===0){return}var a=this.map.painter.context;var n=a.gl;if(!this.boundsBuffer){this.boundsBuffer=a.createVertexBuffer(this._boundsArray,D.members)}if(!this.boundsSegments){this.boundsSegments=e.SegmentVector.simpleSegment(0,0,4,2)}if(!this.texture){this.texture=new e.Texture(a,this.canvas,n.RGBA,{premultiply:true})}else if(r||this._playing){this.texture.update(this.canvas,{premultiply:true})}for(var i in this.tiles){var o=this.tiles[i];if(o.state!=="loaded"){o.state="loaded";o.texture=this.texture}}};r.prototype.serialize=function e(){return{type:"canvas",coordinates:this.coordinates}};r.prototype.hasTransition=function e(){return this._playing};r.prototype._hasInvalidDimensions=function e(){for(var t=0,r=[this.canvas.width,this.canvas.height];t<r.length;t+=1){var a=r[t];if(isNaN(a)||a<=0){return true}}return false};return r}(R);var j={vector:I,raster:P,"raster-dem":O,geojson:z,video:B,image:R,canvas:N};var U=function(t,r,a,n){var i=new j[r.type](t,r,a,n);if(i.id!==t){throw new Error("Expected Source id to be "+t+" instead of "+i.id)}e.bindAll(["load","abort","unload","serialize","prepare"],i);return i};var V=function(e){return j[e]};var H=function(e,t){j[e]=t};function q(t,r){var a=e.identity([]);e.translate(a,a,[1,1,0]);e.scale(a,a,[t.width*.5,t.height*.5,1]);return e.multiply(a,a,t.calculatePosMatrix(r.toUnwrapped()))}function G(e,t,r){if(e){for(var a=0,n=e;a<n.length;a+=1){var i=n[a];var o=t[i];if(o&&o.source===r&&o.type==="fill-extrusion"){return true}}}else{for(var s in t){var l=t[s];if(l.source===r&&l.type==="fill-extrusion"){return true}}}return false}function Y(e,t,r,a,n,i){var o=G(n&&n.layers,t,e.id);var s=i.maxPitchScaleFactor();var l=e.tilesIn(a,s,o);l.sort(Z);var u=[];for(var c=0,f=l;c<f.length;c+=1){var h=f[c];u.push({wrappedTileID:h.tileID.wrapped().key,queryResults:h.tile.queryRenderedFeatures(t,r,e._state,h.queryGeometry,h.cameraQueryGeometry,h.scale,n,i,s,q(e.transform,h.tileID))})}var p=J(u);for(var v in p){p[v].forEach((function(t){var r=t.feature;var a=e.getFeatureState(r.layer["source-layer"],r.id);r.source=r.layer.source;if(r.layer["source-layer"]){r.sourceLayer=r.layer["source-layer"]}r.state=a}))}return p}function W(e,t,r,a,n,i,o){var s={};var l=i.queryRenderedSymbols(a);var u=[];for(var c=0,f=Object.keys(l).map(Number);c<f.length;c+=1){var h=f[c];u.push(o[h])}u.sort(Z);var p=function(){var r=d[v];var a=r.featureIndex.lookupSymbolFeatures(l[r.bucketInstanceId],t,r.bucketIndex,r.sourceLayerIndex,n.filter,n.layers,n.availableImages,e);for(var i in a){var o=s[i]=s[i]||[];var u=a[i];u.sort((function(e,t){var a=r.featureSortOrder;if(a){var n=a.indexOf(e.featureIndex);var i=a.indexOf(t.featureIndex);return i-n}else{return t.featureIndex-e.featureIndex}}));for(var c=0,f=u;c<f.length;c+=1){var h=f[c];o.push(h)}}};for(var v=0,d=u;v<d.length;v+=1)p();var m=function(t){s[t].forEach((function(a){var n=a.feature;var i=e[t];var o=r[i.source];var s=o.getFeatureState(n.layer["source-layer"],n.id);n.source=n.layer.source;if(n.layer["source-layer"]){n.sourceLayer=n.layer["source-layer"]}n.state=s}))};for(var g in s)m(g);return s}function X(e,t){var r=e.getRenderableIds().map((function(t){return e.getTileByID(t)}));var a=[];var n={};for(var i=0;i<r.length;i++){var o=r[i];var s=o.tileID.canonical.key;if(!n[s]){n[s]=true;o.querySourceFeatures(a,t)}}return a}function Z(e,t){var r=e.tileID;var a=t.tileID;return r.overscaledZ-a.overscaledZ||r.canonical.y-a.canonical.y||r.wrap-a.wrap||r.canonical.x-a.canonical.x}function J(e){var t={};var r={};for(var a=0,n=e;a<n.length;a+=1){var i=n[a];var o=i.queryResults;var s=i.wrappedTileID;var l=r[s]=r[s]||{};for(var u in o){var c=o[u];var f=l[u]=l[u]||{};var h=t[u]=t[u]||[];for(var p=0,v=c;p<v.length;p+=1){var d=v[p];if(!f[d.featureIndex]){f[d.featureIndex]=true;h.push(d)}}}}return t}var K=function e(t,r){this.max=t;this.onRemove=r;this.reset()};K.prototype.reset=function e(){for(var t in this.data){for(var r=0,a=this.data[t];r<a.length;r+=1){var n=a[r];if(n.timeout){clearTimeout(n.timeout)}this.onRemove(n.value)}}this.data={};this.order=[];return this};K.prototype.add=function e(t,r,a){var n=this;var i=t.wrapped().key;if(this.data[i]===undefined){this.data[i]=[]}var o={value:r,timeout:undefined};if(a!==undefined){o.timeout=setTimeout((function(){n.remove(t,o)}),a)}this.data[i].push(o);this.order.push(i);if(this.order.length>this.max){var s=this._getAndRemoveByKey(this.order[0]);if(s){this.onRemove(s)}}return this};K.prototype.has=function e(t){return t.wrapped().key in this.data};K.prototype.getAndRemove=function e(t){if(!this.has(t)){return null}return this._getAndRemoveByKey(t.wrapped().key)};K.prototype._getAndRemoveByKey=function e(t){var r=this.data[t].shift();if(r.timeout){clearTimeout(r.timeout)}if(this.data[t].length===0){delete this.data[t]}this.order.splice(this.order.indexOf(t),1);return r.value};K.prototype.getByKey=function e(t){var r=this.data[t];return r?r[0].value:null};K.prototype.get=function e(t){if(!this.has(t)){return null}var r=this.data[t.wrapped().key][0];return r.value};K.prototype.remove=function e(t,r){if(!this.has(t)){return this}var a=t.wrapped().key;var n=r===undefined?0:this.data[a].indexOf(r);var i=this.data[a][n];this.data[a].splice(n,1);if(i.timeout){clearTimeout(i.timeout)}if(this.data[a].length===0){delete this.data[a]}this.onRemove(i.value);this.order.splice(this.order.indexOf(a),1);return this};K.prototype.setMaxSize=function e(t){this.max=t;while(this.order.length>this.max){var r=this._getAndRemoveByKey(this.order[0]);if(r){this.onRemove(r)}}return this};K.prototype.filter=function e(t){var r=[];for(var a in this.data){for(var n=0,i=this.data[a];n<i.length;n+=1){var o=i[n];if(!t(o.value)){r.push(o)}}}for(var s=0,l=r;s<l.length;s+=1){var u=l[s];this.remove(u.value.tileID,u)}};var Q=function e(t,r,a){this.context=t;var n=t.gl;this.buffer=n.createBuffer();this.dynamicDraw=Boolean(a);this.context.unbindVAO();t.bindElementBuffer.set(this.buffer);n.bufferData(n.ELEMENT_ARRAY_BUFFER,r.arrayBuffer,this.dynamicDraw?n.DYNAMIC_DRAW:n.STATIC_DRAW);if(!this.dynamicDraw){delete r.arrayBuffer}};Q.prototype.bind=function e(){this.context.bindElementBuffer.set(this.buffer)};Q.prototype.updateData=function e(t){var r=this.context.gl;this.context.unbindVAO();this.bind();r.bufferSubData(r.ELEMENT_ARRAY_BUFFER,0,t.arrayBuffer)};Q.prototype.destroy=function e(){var t=this.context.gl;if(this.buffer){t.deleteBuffer(this.buffer);delete this.buffer}};var $={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};var ee=function e(t,r,a,n){this.length=r.length;this.attributes=a;this.itemSize=r.bytesPerElement;this.dynamicDraw=n;this.context=t;var i=t.gl;this.buffer=i.createBuffer();t.bindVertexBuffer.set(this.buffer);i.bufferData(i.ARRAY_BUFFER,r.arrayBuffer,this.dynamicDraw?i.DYNAMIC_DRAW:i.STATIC_DRAW);if(!this.dynamicDraw){delete r.arrayBuffer}};ee.prototype.bind=function e(){this.context.bindVertexBuffer.set(this.buffer)};ee.prototype.updateData=function e(t){var r=this.context.gl;this.bind();r.bufferSubData(r.ARRAY_BUFFER,0,t.arrayBuffer)};ee.prototype.enableAttributes=function e(t,r){for(var a=0;a<this.attributes.length;a++){var n=this.attributes[a];var i=r.attributes[n.name];if(i!==undefined){t.enableVertexAttribArray(i)}}};ee.prototype.setVertexAttribPointers=function e(t,r,a){for(var n=0;n<this.attributes.length;n++){var i=this.attributes[n];var o=r.attributes[i.name];if(o!==undefined){t.vertexAttribPointer(o,i.components,t[$[i.type]],false,this.itemSize,i.offset+this.itemSize*(a||0))}}};ee.prototype.destroy=function e(){var t=this.context.gl;if(this.buffer){t.deleteBuffer(this.buffer);delete this.buffer}};var te=function e(t){this.gl=t.gl;this.default=this.getDefault();this.current=this.default;this.dirty=false};te.prototype.get=function e(){return this.current};te.prototype.set=function e(t){};te.prototype.getDefault=function e(){return this.default};te.prototype.setDefault=function e(){this.set(this.default)};var re=function(t){function r(){t.apply(this,arguments)}if(t)r.__proto__=t;r.prototype=Object.create(t&&t.prototype);r.prototype.constructor=r;r.prototype.getDefault=function t(){return e.Color.transparent};r.prototype.set=function e(t){var r=this.current;if(t.r===r.r&&t.g===r.g&&t.b===r.b&&t.a===r.a&&!this.dirty){return}this.gl.clearColor(t.r,t.g,t.b,t.a);this.current=t;this.dirty=false};return r}(te);var ae=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype.getDefault=function e(){return 1};t.prototype.set=function e(t){if(t===this.current&&!this.dirty){return}this.gl.clearDepth(t);this.current=t;this.dirty=false};return t}(te);var ne=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype.getDefault=function e(){return 0};t.prototype.set=function e(t){if(t===this.current&&!this.dirty){return}this.gl.clearStencil(t);this.current=t;this.dirty=false};return t}(te);var ie=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype.getDefault=function e(){return[true,true,true,true]};t.prototype.set=function e(t){var r=this.current;if(t[0]===r[0]&&t[1]===r[1]&&t[2]===r[2]&&t[3]===r[3]&&!this.dirty){return}this.gl.colorMask(t[0],t[1],t[2],t[3]);this.current=t;this.dirty=false};return t}(te);var oe=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype.getDefault=function e(){return true};t.prototype.set=function e(t){if(t===this.current&&!this.dirty){return}this.gl.depthMask(t);this.current=t;this.dirty=false};return t}(te);var se=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype.getDefault=function e(){return 255};t.prototype.set=function e(t){if(t===this.current&&!this.dirty){return}this.gl.stencilMask(t);this.current=t;this.dirty=false};return t}(te);var le=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype.getDefault=function e(){return{func:this.gl.ALWAYS,ref:0,mask:255}};t.prototype.set=function e(t){var r=this.current;if(t.func===r.func&&t.ref===r.ref&&t.mask===r.mask&&!this.dirty){return}this.gl.stencilFunc(t.func,t.ref,t.mask);this.current=t;this.dirty=false};return t}(te);var ue=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype.getDefault=function e(){var t=this.gl;return[t.KEEP,t.KEEP,t.KEEP]};t.prototype.set=function e(t){var r=this.current;if(t[0]===r[0]&&t[1]===r[1]&&t[2]===r[2]&&!this.dirty){return}this.gl.stencilOp(t[0],t[1],t[2]);this.current=t;this.dirty=false};return t}(te);var ce=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype.getDefault=function e(){return false};t.prototype.set=function e(t){if(t===this.current&&!this.dirty){return}var r=this.gl;if(t){r.enable(r.STENCIL_TEST)}else{r.disable(r.STENCIL_TEST)}this.current=t;this.dirty=false};return t}(te);var fe=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype.getDefault=function e(){return[0,1]};t.prototype.set=function e(t){var r=this.current;if(t[0]===r[0]&&t[1]===r[1]&&!this.dirty){return}this.gl.depthRange(t[0],t[1]);this.current=t;this.dirty=false};return t}(te);var he=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype.getDefault=function e(){return false};t.prototype.set=function e(t){if(t===this.current&&!this.dirty){return}var r=this.gl;if(t){r.enable(r.DEPTH_TEST)}else{r.disable(r.DEPTH_TEST)}this.current=t;this.dirty=false};return t}(te);var pe=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype.getDefault=function e(){return this.gl.LESS};t.prototype.set=function e(t){if(t===this.current&&!this.dirty){return}this.gl.depthFunc(t);this.current=t;this.dirty=false};return t}(te);var ve=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype.getDefault=function e(){return false};t.prototype.set=function e(t){if(t===this.current&&!this.dirty){return}var r=this.gl;if(t){r.enable(r.BLEND)}else{r.disable(r.BLEND)}this.current=t;this.dirty=false};return t}(te);var de=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype.getDefault=function e(){var t=this.gl;return[t.ONE,t.ZERO]};t.prototype.set=function e(t){var r=this.current;if(t[0]===r[0]&&t[1]===r[1]&&!this.dirty){return}this.gl.blendFunc(t[0],t[1]);this.current=t;this.dirty=false};return t}(te);var me=function(t){function r(){t.apply(this,arguments)}if(t)r.__proto__=t;r.prototype=Object.create(t&&t.prototype);r.prototype.constructor=r;r.prototype.getDefault=function t(){return e.Color.transparent};r.prototype.set=function e(t){var r=this.current;if(t.r===r.r&&t.g===r.g&&t.b===r.b&&t.a===r.a&&!this.dirty){return}this.gl.blendColor(t.r,t.g,t.b,t.a);this.current=t;this.dirty=false};return r}(te);var ge=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype.getDefault=function e(){return this.gl.FUNC_ADD};t.prototype.set=function e(t){if(t===this.current&&!this.dirty){return}this.gl.blendEquation(t);this.current=t;this.dirty=false};return t}(te);var ye=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype.getDefault=function e(){return false};t.prototype.set=function e(t){if(t===this.current&&!this.dirty){return}var r=this.gl;if(t){r.enable(r.CULL_FACE)}else{r.disable(r.CULL_FACE)}this.current=t;this.dirty=false};return t}(te);var xe=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype.getDefault=function e(){return this.gl.BACK};t.prototype.set=function e(t){if(t===this.current&&!this.dirty){return}this.gl.cullFace(t);this.current=t;this.dirty=false};return t}(te);var be=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype.getDefault=function e(){return this.gl.CCW};t.prototype.set=function e(t){if(t===this.current&&!this.dirty){return}this.gl.frontFace(t);this.current=t;this.dirty=false};return t}(te);var _e=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype.getDefault=function e(){return null};t.prototype.set=function e(t){if(t===this.current&&!this.dirty){return}this.gl.useProgram(t);this.current=t;this.dirty=false};return t}(te);var we=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype.getDefault=function e(){return this.gl.TEXTURE0};t.prototype.set=function e(t){if(t===this.current&&!this.dirty){return}this.gl.activeTexture(t);this.current=t;this.dirty=false};return t}(te);var Te=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype.getDefault=function e(){var t=this.gl;return[0,0,t.drawingBufferWidth,t.drawingBufferHeight]};t.prototype.set=function e(t){var r=this.current;if(t[0]===r[0]&&t[1]===r[1]&&t[2]===r[2]&&t[3]===r[3]&&!this.dirty){return}this.gl.viewport(t[0],t[1],t[2],t[3]);this.current=t;this.dirty=false};return t}(te);var ke=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype.getDefault=function e(){return null};t.prototype.set=function e(t){if(t===this.current&&!this.dirty){return}var r=this.gl;r.bindFramebuffer(r.FRAMEBUFFER,t);this.current=t;this.dirty=false};return t}(te);var Me=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype.getDefault=function e(){return null};t.prototype.set=function e(t){if(t===this.current&&!this.dirty){return}var r=this.gl;r.bindRenderbuffer(r.RENDERBUFFER,t);this.current=t;this.dirty=false};return t}(te);var Ae=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype.getDefault=function e(){return null};t.prototype.set=function e(t){if(t===this.current&&!this.dirty){return}var r=this.gl;r.bindTexture(r.TEXTURE_2D,t);this.current=t;this.dirty=false};return t}(te);var Se=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype.getDefault=function e(){return null};t.prototype.set=function e(t){if(t===this.current&&!this.dirty){return}var r=this.gl;r.bindBuffer(r.ARRAY_BUFFER,t);this.current=t;this.dirty=false};return t}(te);var Ee=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype.getDefault=function e(){return null};t.prototype.set=function e(t){var r=this.gl;r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,t);this.current=t;this.dirty=false};return t}(te);var Le=function(e){function t(t){e.call(this,t);this.vao=t.extVertexArrayObject}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype.getDefault=function e(){return null};t.prototype.set=function e(t){if(!this.vao||t===this.current&&!this.dirty){return}this.vao.bindVertexArrayOES(t);this.current=t;this.dirty=false};return t}(te);var Ce=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype.getDefault=function e(){return 4};t.prototype.set=function e(t){if(t===this.current&&!this.dirty){return}var r=this.gl;r.pixelStorei(r.UNPACK_ALIGNMENT,t);this.current=t;this.dirty=false};return t}(te);var Ie=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype.getDefault=function e(){return false};t.prototype.set=function e(t){if(t===this.current&&!this.dirty){return}var r=this.gl;r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t);this.current=t;this.dirty=false};return t}(te);var Pe=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype.getDefault=function e(){return false};t.prototype.set=function e(t){if(t===this.current&&!this.dirty){return}var r=this.gl;r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,t);this.current=t;this.dirty=false};return t}(te);var Oe=function(e){function t(t,r){e.call(this,t);this.context=t;this.parent=r}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype.getDefault=function e(){return null};return t}(te);var ze=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype.setDirty=function e(){this.dirty=true};t.prototype.set=function e(t){if(t===this.current&&!this.dirty){return}this.context.bindFramebuffer.set(this.parent);var r=this.gl;r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,t,0);this.current=t;this.dirty=false};return t}(Oe);var De=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype.set=function e(t){if(t===this.current&&!this.dirty){return}this.context.bindFramebuffer.set(this.parent);var r=this.gl;r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_ATTACHMENT,r.RENDERBUFFER,t);this.current=t;this.dirty=false};return t}(Oe);var Re=function e(t,r,a,n){this.context=t;this.width=r;this.height=a;var i=t.gl;var o=this.framebuffer=i.createFramebuffer();this.colorAttachment=new ze(t,o);if(n){this.depthAttachment=new De(t,o)}};Re.prototype.destroy=function e(){var t=this.context.gl;var r=this.colorAttachment.get();if(r){t.deleteTexture(r)}if(this.depthAttachment){var a=this.depthAttachment.get();if(a){t.deleteRenderbuffer(a)}}t.deleteFramebuffer(this.framebuffer)};var Fe=519;var Be=function e(t,r,a){this.func=t;this.mask=r;this.range=a};Be.ReadOnly=false;Be.ReadWrite=true;Be.disabled=new Be(Fe,Be.ReadOnly,[0,1]);var Ne=519;var je=7680;var Ue=function e(t,r,a,n,i,o){this.test=t;this.ref=r;this.mask=a;this.fail=n;this.depthFail=i;this.pass=o};Ue.disabled=new Ue({func:Ne,mask:0},0,0,je,je,je);var Ve=0;var He=1;var qe=771;var Ge=function e(t,r,a){this.blendFunction=t;this.blendColor=r;this.mask=a};Ge.Replace=[He,Ve];Ge.disabled=new Ge(Ge.Replace,e.Color.transparent,[false,false,false,false]);Ge.unblended=new Ge(Ge.Replace,e.Color.transparent,[true,true,true,true]);Ge.alphaBlended=new Ge([He,qe],e.Color.transparent,[true,true,true,true]);var Ye=1029;var We=2305;var Xe=function e(t,r,a){this.enable=t;this.mode=r;this.frontFace=a};Xe.disabled=new Xe(false,Ye,We);Xe.backCCW=new Xe(true,Ye,We);var Ze=function e(t){this.gl=t;this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object");this.clearColor=new re(this);this.clearDepth=new ae(this);this.clearStencil=new ne(this);this.colorMask=new ie(this);this.depthMask=new oe(this);this.stencilMask=new se(this);this.stencilFunc=new le(this);this.stencilOp=new ue(this);this.stencilTest=new ce(this);this.depthRange=new fe(this);this.depthTest=new he(this);this.depthFunc=new pe(this);this.blend=new ve(this);this.blendFunc=new de(this);this.blendColor=new me(this);this.blendEquation=new ge(this);this.cullFace=new ye(this);this.cullFaceSide=new xe(this);this.frontFace=new be(this);this.program=new _e(this);this.activeTexture=new we(this);this.viewport=new Te(this);this.bindFramebuffer=new ke(this);this.bindRenderbuffer=new Me(this);this.bindTexture=new Ae(this);this.bindVertexBuffer=new Se(this);this.bindElementBuffer=new Ee(this);this.bindVertexArrayOES=this.extVertexArrayObject&&new Le(this);this.pixelStoreUnpack=new Ce(this);this.pixelStoreUnpackPremultiplyAlpha=new Ie(this);this.pixelStoreUnpackFlipY=new Pe(this);this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");if(this.extTextureFilterAnisotropic){this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}this.extTextureHalfFloat=t.getExtension("OES_texture_half_float");if(this.extTextureHalfFloat){t.getExtension("OES_texture_half_float_linear");this.extRenderToTextureHalfFloat=t.getExtension("EXT_color_buffer_half_float")}this.extTimerQuery=t.getExtension("EXT_disjoint_timer_query")};Ze.prototype.setDefault=function e(){this.unbindVAO();this.clearColor.setDefault();this.clearDepth.setDefault();this.clearStencil.setDefault();this.colorMask.setDefault();this.depthMask.setDefault();this.stencilMask.setDefault();this.stencilFunc.setDefault();this.stencilOp.setDefault();this.stencilTest.setDefault();this.depthRange.setDefault();this.depthTest.setDefault();this.depthFunc.setDefault();this.blend.setDefault();this.blendFunc.setDefault();this.blendColor.setDefault();this.blendEquation.setDefault();this.cullFace.setDefault();this.cullFaceSide.setDefault();this.frontFace.setDefault();this.program.setDefault();this.activeTexture.setDefault();this.bindFramebuffer.setDefault();this.pixelStoreUnpack.setDefault();this.pixelStoreUnpackPremultiplyAlpha.setDefault();this.pixelStoreUnpackFlipY.setDefault()};Ze.prototype.setDirty=function e(){this.clearColor.dirty=true;this.clearDepth.dirty=true;this.clearStencil.dirty=true;this.colorMask.dirty=true;this.depthMask.dirty=true;this.stencilMask.dirty=true;this.stencilFunc.dirty=true;this.stencilOp.dirty=true;this.stencilTest.dirty=true;this.depthRange.dirty=true;this.depthTest.dirty=true;this.depthFunc.dirty=true;this.blend.dirty=true;this.blendFunc.dirty=true;this.blendColor.dirty=true;this.blendEquation.dirty=true;this.cullFace.dirty=true;this.cullFaceSide.dirty=true;this.frontFace.dirty=true;this.program.dirty=true;this.activeTexture.dirty=true;this.viewport.dirty=true;this.bindFramebuffer.dirty=true;this.bindRenderbuffer.dirty=true;this.bindTexture.dirty=true;this.bindVertexBuffer.dirty=true;this.bindElementBuffer.dirty=true;if(this.extVertexArrayObject){this.bindVertexArrayOES.dirty=true}this.pixelStoreUnpack.dirty=true;this.pixelStoreUnpackPremultiplyAlpha.dirty=true;this.pixelStoreUnpackFlipY.dirty=true};Ze.prototype.createIndexBuffer=function e(t,r){return new Q(this,t,r)};Ze.prototype.createVertexBuffer=function e(t,r,a){return new ee(this,t,r,a)};Ze.prototype.createRenderbuffer=function e(t,r,a){var n=this.gl;var i=n.createRenderbuffer();this.bindRenderbuffer.set(i);n.renderbufferStorage(n.RENDERBUFFER,t,r,a);this.bindRenderbuffer.set(null);return i};Ze.prototype.createFramebuffer=function e(t,r,a){return new Re(this,t,r,a)};Ze.prototype.clear=function e(t){var r=t.color;var a=t.depth;var n=this.gl;var i=0;if(r){i|=n.COLOR_BUFFER_BIT;this.clearColor.set(r);this.colorMask.set([true,true,true,true])}if(typeof a!=="undefined"){i|=n.DEPTH_BUFFER_BIT;this.depthRange.set([0,1]);this.clearDepth.set(a);this.depthMask.set(true)}n.clear(i)};Ze.prototype.setCullFace=function e(t){if(t.enable===false){this.cullFace.set(false)}else{this.cullFace.set(true);this.cullFaceSide.set(t.mode);this.frontFace.set(t.frontFace)}};Ze.prototype.setDepthMode=function e(t){if(t.func===this.gl.ALWAYS&&!t.mask){this.depthTest.set(false)}else{this.depthTest.set(true);this.depthFunc.set(t.func);this.depthMask.set(t.mask);this.depthRange.set(t.range)}};Ze.prototype.setStencilMode=function e(t){if(t.test.func===this.gl.ALWAYS&&!t.mask){this.stencilTest.set(false)}else{this.stencilTest.set(true);this.stencilMask.set(t.mask);this.stencilOp.set([t.fail,t.depthFail,t.pass]);this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})}};Ze.prototype.setColorMode=function t(r){if(e.deepEqual(r.blendFunction,Ge.Replace)){this.blend.set(false)}else{this.blend.set(true);this.blendFunc.set(r.blendFunction);this.blendColor.set(r.blendColor)}this.colorMask.set(r.mask)};Ze.prototype.unbindVAO=function e(){if(this.extVertexArrayObject){this.bindVertexArrayOES.set(null)}};var Je=function(t){function r(r,a,n){var i=this;t.call(this);this.id=r;this.dispatcher=n;this.on("data",(function(e){if(e.dataType==="source"&&e.sourceDataType==="metadata"){i._sourceLoaded=true}if(i._sourceLoaded&&!i._paused&&e.dataType==="source"&&e.sourceDataType==="content"){i.reload();if(i.transform){i.update(i.transform)}}}));this.on("error",(function(){i._sourceErrored=true}));this._source=U(r,a,n,this);this._tiles={};this._cache=new K(0,this._unloadTile.bind(this));this._timers={};this._cacheTimers={};this._maxTileCacheSize=null;this._loadedParentTiles={};this._coveredTiles={};this._state=new e.SourceFeatureState}if(t)r.__proto__=t;r.prototype=Object.create(t&&t.prototype);r.prototype.constructor=r;r.prototype.onAdd=function e(t){this.map=t;this._maxTileCacheSize=t?t._maxTileCacheSize:null;if(this._source&&this._source.onAdd){this._source.onAdd(t)}};r.prototype.onRemove=function e(t){if(this._source&&this._source.onRemove){this._source.onRemove(t)}};r.prototype.loaded=function e(){if(this._sourceErrored){return true}if(!this._sourceLoaded){return false}if(!this._source.loaded()){return false}for(var t in this._tiles){var r=this._tiles[t];if(r.state!=="loaded"&&r.state!=="errored"){return false}}return true};r.prototype.getSource=function e(){return this._source};r.prototype.pause=function e(){this._paused=true};r.prototype.resume=function e(){if(!this._paused){return}var t=this._shouldReloadOnResume;this._paused=false;this._shouldReloadOnResume=false;if(t){this.reload()}if(this.transform){this.update(this.transform)}};r.prototype._loadTile=function e(t,r){return this._source.loadTile(t,r)};r.prototype._unloadTile=function e(t){if(this._source.unloadTile){return this._source.unloadTile(t,(function(){}))}};r.prototype._abortTile=function e(t){if(this._source.abortTile){return this._source.abortTile(t,(function(){}))}};r.prototype.serialize=function e(){return this._source.serialize()};r.prototype.prepare=function e(t){if(this._source.prepare){this._source.prepare()}this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(var r in this._tiles){var a=this._tiles[r];a.upload(t);a.prepare(this.map.style.imageManager)}};r.prototype.getIds=function t(){return e.values(this._tiles).map((function(e){return e.tileID})).sort(Ke).map((function(e){return e.key}))};r.prototype.getRenderableIds=function t(r){var a=this;var n=[];for(var i in this._tiles){if(this._isIdRenderable(i,r)){n.push(this._tiles[i])}}if(r){return n.sort((function(t,r){var n=t.tileID;var i=r.tileID;var o=new e.Point(n.canonical.x,n.canonical.y)._rotate(a.transform.angle);var s=new e.Point(i.canonical.x,i.canonical.y)._rotate(a.transform.angle);return n.overscaledZ-i.overscaledZ||s.y-o.y||s.x-o.x})).map((function(e){return e.tileID.key}))}return n.map((function(e){return e.tileID})).sort(Ke).map((function(e){return e.key}))};r.prototype.hasRenderableParent=function e(t){var r=this.findLoadedParent(t,0);if(r){return this._isIdRenderable(r.tileID.key)}return false};r.prototype._isIdRenderable=function e(t,r){return this._tiles[t]&&this._tiles[t].hasData()&&!this._coveredTiles[t]&&(r||!this._tiles[t].holdingForFade())};r.prototype.reload=function e(){if(this._paused){this._shouldReloadOnResume=true;return}this._cache.reset();for(var t in this._tiles){if(this._tiles[t].state!=="errored"){this._reloadTile(t,"reloading")}}};r.prototype._reloadTile=function e(t,r){var a=this._tiles[t];if(!a){return}if(a.state!=="loading"){a.state=r}this._loadTile(a,this._tileLoaded.bind(this,a,t,r))};r.prototype._tileLoaded=function t(r,a,n,i){if(i){r.state="errored";if(i.status!==404){this._source.fire(new e.ErrorEvent(i,{tile:r}))}else{this.update(this.transform)}return}r.timeAdded=e.browser.now();if(n==="expired"){r.refreshedUponExpiration=true}this._setTileReloadTimer(a,r);if(this.getSource().type==="raster-dem"&&r.dem){this._backfillDEM(r)}this._state.initializeTileState(r,this.map?this.map.painter:null);this._source.fire(new e.Event("data",{dataType:"source",tile:r,coord:r.tileID}))};r.prototype._backfillDEM=function e(t){var r=this.getRenderableIds();for(var a=0;a<r.length;a++){var n=r[a];if(t.neighboringTiles&&t.neighboringTiles[n]){var i=this.getTileByID(n);o(t,i);o(i,t)}}function o(e,t){e.needsHillshadePrepare=true;var r=t.tileID.canonical.x-e.tileID.canonical.x;var a=t.tileID.canonical.y-e.tileID.canonical.y;var n=Math.pow(2,e.tileID.canonical.z);var i=t.tileID.key;if(r===0&&a===0){return}if(Math.abs(a)>1){return}if(Math.abs(r)>1){if(Math.abs(r+n)===1){r+=n}else if(Math.abs(r-n)===1){r-=n}}if(!t.dem||!e.dem){return}e.dem.backfillBorder(t.dem,r,a);if(e.neighboringTiles&&e.neighboringTiles[i]){e.neighboringTiles[i].backfilled=true}}};r.prototype.getTile=function e(t){return this.getTileByID(t.key)};r.prototype.getTileByID=function e(t){return this._tiles[t]};r.prototype._retainLoadedChildren=function e(t,r,a,n){for(var i in this._tiles){var o=this._tiles[i];if(n[i]||!o.hasData()||o.tileID.overscaledZ<=r||o.tileID.overscaledZ>a){continue}var s=o.tileID;while(o&&o.tileID.overscaledZ>r+1){var l=o.tileID.scaledTo(o.tileID.overscaledZ-1);o=this._tiles[l.key];if(o&&o.hasData()){s=l}}var u=s;while(u.overscaledZ>r){u=u.scaledTo(u.overscaledZ-1);if(t[u.key]){n[s.key]=s;break}}}};r.prototype.findLoadedParent=function e(t,r){if(t.key in this._loadedParentTiles){var a=this._loadedParentTiles[t.key];if(a&&a.tileID.overscaledZ>=r){return a}else{return null}}for(var n=t.overscaledZ-1;n>=r;n--){var i=t.scaledTo(n);var o=this._getLoadedTile(i);if(o){return o}}};r.prototype._getLoadedTile=function e(t){var r=this._tiles[t.key];if(r&&r.hasData()){return r}var a=this._cache.getByKey(t.wrapped().key);return a};r.prototype.updateCacheSize=function e(t){var r=Math.ceil(t.width/this._source.tileSize)+1;var a=Math.ceil(t.height/this._source.tileSize)+1;var n=r*a;var i=5;var o=Math.floor(n*i);var s=typeof this._maxTileCacheSize==="number"?Math.min(this._maxTileCacheSize,o):o;this._cache.setMaxSize(s)};r.prototype.handleWrapJump=function e(t){var r=this._prevLng===undefined?t:this._prevLng;var a=t-r;var n=a/360;var i=Math.round(n);this._prevLng=t;if(i){var o={};for(var s in this._tiles){var l=this._tiles[s];l.tileID=l.tileID.unwrapTo(l.tileID.wrap+i);o[l.tileID.key]=l}this._tiles=o;for(var u in this._timers){clearTimeout(this._timers[u]);delete this._timers[u]}for(var c in this._tiles){var f=this._tiles[c];this._setTileReloadTimer(c,f)}}};r.prototype.update=function t(a){var n=this;this.transform=a;if(!this._sourceLoaded||this._paused){return}this.updateCacheSize(a);this.handleWrapJump(this.transform.center.lng);this._coveredTiles={};var i;if(!this.used){i=[]}else if(this._source.tileID){i=a.getVisibleUnwrappedCoordinates(this._source.tileID).map((function(t){return new e.OverscaledTileID(t.canonical.z,t.wrap,t.canonical.z,t.canonical.x,t.canonical.y)}))}else{i=a.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled});if(this._source.hasTile){i=i.filter((function(e){return n._source.hasTile(e)}))}}var o=a.coveringZoomLevel(this._source);var s=Math.max(o-r.maxOverzooming,this._source.minzoom);var l=Math.max(o+r.maxUnderzooming,this._source.minzoom);var u=this._updateRetainedTiles(i,o);if(Qe(this._source.type)){var c={};var f={};var h=Object.keys(u);for(var p=0,v=h;p<v.length;p+=1){var d=v[p];var m=u[d];var g=this._tiles[d];if(!g||g.fadeEndTime&&g.fadeEndTime<=e.browser.now()){continue}var y=this.findLoadedParent(m,s);if(y){this._addTile(y.tileID);c[y.tileID.key]=y.tileID}f[d]=m}this._retainLoadedChildren(f,o,l,u);for(var x in c){if(!u[x]){this._coveredTiles[x]=true;u[x]=c[x]}}}for(var b in u){this._tiles[b].clearFadeHold()}var _=e.keysDifference(this._tiles,u);for(var w=0,T=_;w<T.length;w+=1){var k=T[w];var M=this._tiles[k];if(M.hasSymbolBuckets&&!M.holdingForFade()){M.setHoldDuration(this.map._fadeDuration)}else if(!M.hasSymbolBuckets||M.symbolFadeFinished()){this._removeTile(k)}}this._updateLoadedParentTileCache()};r.prototype.releaseSymbolFadeTiles=function e(){for(var t in this._tiles){if(this._tiles[t].holdingForFade()){this._removeTile(t)}}};r.prototype._updateRetainedTiles=function e(t,a){var n={};var i={};var o=Math.max(a-r.maxOverzooming,this._source.minzoom);var s=Math.max(a+r.maxUnderzooming,this._source.minzoom);var l={};for(var u=0,c=t;u<c.length;u+=1){var f=c[u];var h=this._addTile(f);n[f.key]=f;if(h.hasData()){continue}if(a<this._source.maxzoom){l[f.key]=f}}this._retainLoadedChildren(l,a,s,n);for(var p=0,v=t;p<v.length;p+=1){var d=v[p];var m=this._tiles[d.key];if(m.hasData()){continue}if(a+1>this._source.maxzoom){var g=d.children(this._source.maxzoom)[0];var y=this.getTile(g);if(!!y&&y.hasData()){n[g.key]=g;continue}}else{var x=d.children(this._source.maxzoom);if(n[x[0].key]&&n[x[1].key]&&n[x[2].key]&&n[x[3].key]){continue}}var b=m.wasRequested();for(var _=d.overscaledZ-1;_>=o;--_){var w=d.scaledTo(_);if(i[w.key]){break}i[w.key]=true;m=this.getTile(w);if(!m&&b){m=this._addTile(w)}if(m){n[w.key]=w;b=m.wasRequested();if(m.hasData()){break}}}}return n};r.prototype._updateLoadedParentTileCache=function e(){this._loadedParentTiles={};for(var t in this._tiles){var r=[];var a=void 0;var n=this._tiles[t].tileID;while(n.overscaledZ>0){if(n.key in this._loadedParentTiles){a=this._loadedParentTiles[n.key];break}r.push(n.key);var i=n.scaledTo(n.overscaledZ-1);a=this._getLoadedTile(i);if(a){break}n=i}for(var o=0,s=r;o<s.length;o+=1){var l=s[o];this._loadedParentTiles[l]=a}}};r.prototype._addTile=function t(r){var a=this._tiles[r.key];if(a){return a}a=this._cache.getAndRemove(r);if(a){this._setTileReloadTimer(r.key,a);a.tileID=r;this._state.initializeTileState(a,this.map?this.map.painter:null);if(this._cacheTimers[r.key]){clearTimeout(this._cacheTimers[r.key]);delete this._cacheTimers[r.key];this._setTileReloadTimer(r.key,a)}}var n=Boolean(a);if(!n){a=new e.Tile(r,this._source.tileSize*r.overscaleFactor());this._loadTile(a,this._tileLoaded.bind(this,a,r.key,a.state))}if(!a){return null}a.uses++;this._tiles[r.key]=a;if(!n){this._source.fire(new e.Event("dataloading",{tile:a,coord:a.tileID,dataType:"source"}))}return a};r.prototype._setTileReloadTimer=function e(t,r){var a=this;if(t in this._timers){clearTimeout(this._timers[t]);delete this._timers[t]}var n=r.getExpiryTimeout();if(n){this._timers[t]=setTimeout((function(){a._reloadTile(t,"expired");delete a._timers[t]}),n)}};r.prototype._removeTile=function e(t){var r=this._tiles[t];if(!r){return}r.uses--;delete this._tiles[t];if(this._timers[t]){clearTimeout(this._timers[t]);delete this._timers[t]}if(r.uses>0){return}if(r.hasData()&&r.state!=="reloading"){this._cache.add(r.tileID,r,r.getExpiryTimeout())}else{r.aborted=true;this._abortTile(r);this._unloadTile(r)}};r.prototype.clearTiles=function e(){this._shouldReloadOnResume=false;this._paused=false;for(var t in this._tiles){this._removeTile(t)}this._cache.reset()};r.prototype.tilesIn=function t(r,a,n){var i=this;var o=[];var s=this.transform;if(!s){return o}var l=n?s.getCameraQueryGeometry(r):r;var u=r.map((function(e){return s.pointCoordinate(e)}));var c=l.map((function(e){return s.pointCoordinate(e)}));var f=this.getIds();var h=Infinity;var p=Infinity;var v=-Infinity;var d=-Infinity;for(var m=0,g=c;m<g.length;m+=1){var y=g[m];h=Math.min(h,y.x);p=Math.min(p,y.y);v=Math.max(v,y.x);d=Math.max(d,y.y)}var x=function(t){var r=i._tiles[f[t]];if(r.holdingForFade()){return}var n=r.tileID;var l=Math.pow(2,s.zoom-r.tileID.overscaledZ);var m=a*r.queryPadding*e.EXTENT/r.tileSize/l;var g=[n.getTilePoint(new e.MercatorCoordinate(h,p)),n.getTilePoint(new e.MercatorCoordinate(v,d))];if(g[0].x-m<e.EXTENT&&g[0].y-m<e.EXTENT&&g[1].x+m>=0&&g[1].y+m>=0){var y=u.map((function(e){return n.getTilePoint(e)}));var x=c.map((function(e){return n.getTilePoint(e)}));o.push({tile:r,tileID:n,queryGeometry:y,cameraQueryGeometry:x,scale:l})}};for(var b=0;b<f.length;b++)x(b);return o};r.prototype.getVisibleCoordinates=function e(t){var r=this;var a=this.getRenderableIds(t).map((function(e){return r._tiles[e].tileID}));for(var n=0,i=a;n<i.length;n+=1){var o=i[n];o.posMatrix=this.transform.calculatePosMatrix(o.toUnwrapped())}return a};r.prototype.hasTransition=function t(){if(this._source.hasTransition()){return true}if(Qe(this._source.type)){for(var r in this._tiles){var a=this._tiles[r];if(a.fadeEndTime!==undefined&&a.fadeEndTime>=e.browser.now()){return true}}}return false};r.prototype.setFeatureState=function e(t,r,a){t=t||"_geojsonTileLayer";this._state.updateState(t,r,a)};r.prototype.removeFeatureState=function e(t,r,a){t=t||"_geojsonTileLayer";this._state.removeFeatureState(t,r,a)};r.prototype.getFeatureState=function e(t,r){t=t||"_geojsonTileLayer";return this._state.getState(t,r)};r.prototype.setDependencies=function e(t,r,a){var n=this._tiles[t];if(n){n.setDependencies(r,a)}};r.prototype.reloadTilesForDependencies=function e(t,r){for(var a in this._tiles){var n=this._tiles[a];if(n.hasDependency(t,r)){this._reloadTile(a,"reloading")}}this._cache.filter((function(e){return!e.hasDependency(t,r)}))};return r}(e.Evented);Je.maxOverzooming=10;Je.maxUnderzooming=3;function Ke(e,t){var r=Math.abs(e.wrap*2)-+(e.wrap<0);var a=Math.abs(t.wrap*2)-+(t.wrap<0);return e.overscaledZ-t.overscaledZ||a-r||t.canonical.y-e.canonical.y||t.canonical.x-e.canonical.x}function Qe(e){return e==="raster"||e==="image"||e==="video"}function $e(){return new e.window.Worker(Fs.workerUrl)}var et="mapboxgl_preloaded_worker_pool";var tt=function e(){this.active={}};tt.prototype.acquire=function e(t){if(!this.workers){this.workers=[];while(this.workers.length<tt.workerCount){this.workers.push(new $e)}}this.active[t]=true;return this.workers.slice()};tt.prototype.release=function e(t){delete this.active[t];if(this.numActive()===0){this.workers.forEach((function(e){e.terminate()}));this.workers=null}};tt.prototype.isPreloaded=function e(){return!!this.active[et]};tt.prototype.numActive=function e(){return Object.keys(this.active).length};var rt=Math.floor(e.browser.hardwareConcurrency/2);tt.workerCount=Math.max(Math.min(rt,6),1);var at;function nt(){if(!at){at=new tt}return at}function it(){var e=nt();e.acquire(et)}function ot(){var e=at;if(e){if(e.isPreloaded()&&e.numActive()===1){e.release(et);at=null}else{console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()")}}}function st(t,r){var a={};for(var n in t){if(n!=="ref"){a[n]=t[n]}}e.refProperties.forEach((function(e){if(e in r){a[e]=r[e]}}));return a}function lt(e){e=e.slice();var t=Object.create(null);for(var r=0;r<e.length;r++){t[e[r].id]=e[r]}for(var a=0;a<e.length;a++){if("ref"in e[a]){e[a]=st(e[a],t[e[a].ref])}}return e}function ut(){var t={};var r=e.styleSpec["$version"];for(var a in e.styleSpec["$root"]){var n=e.styleSpec["$root"][a];if(n.required){var i=null;if(a==="version"){i=r}else{if(n.type==="array"){i=[]}else{i={}}}if(i!=null){t[a]=i}}}return t}var ct={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function ft(e,t,r){r.push({command:ct.addSource,args:[e,t[e]]})}function ht(e,t,r){t.push({command:ct.removeSource,args:[e]});r[e]=true}function pt(e,t,r,a){ht(e,r,a);ft(e,t,r)}function vt(t,r,a){var n;for(n in t[a]){if(!t[a].hasOwnProperty(n)){continue}if(n!=="data"&&!e.deepEqual(t[a][n],r[a][n])){return false}}for(n in r[a]){if(!r[a].hasOwnProperty(n)){continue}if(n!=="data"&&!e.deepEqual(t[a][n],r[a][n])){return false}}return true}function dt(t,r,a,n){t=t||{};r=r||{};var i;for(i in t){if(!t.hasOwnProperty(i)){continue}if(!r.hasOwnProperty(i)){ht(i,a,n)}}for(i in r){if(!r.hasOwnProperty(i)){continue}if(!t.hasOwnProperty(i)){ft(i,r,a)}else if(!e.deepEqual(t[i],r[i])){if(t[i].type==="geojson"&&r[i].type==="geojson"&&vt(t,r,i)){a.push({command:ct.setGeoJSONSourceData,args:[i,r[i].data]})}else{pt(i,r,a,n)}}}}function mt(t,r,a,n,i,o){t=t||{};r=r||{};var s;for(s in t){if(!t.hasOwnProperty(s)){continue}if(!e.deepEqual(t[s],r[s])){a.push({command:o,args:[n,s,r[s],i]})}}for(s in r){if(!r.hasOwnProperty(s)||t.hasOwnProperty(s)){continue}if(!e.deepEqual(t[s],r[s])){a.push({command:o,args:[n,s,r[s],i]})}}}function gt(e){return e.id}function yt(e,t){e[t.id]=t;return e}function xt(t,r,a){t=t||[];r=r||[];var n=t.map(gt);var i=r.map(gt);var o=t.reduce(yt,{});var s=r.reduce(yt,{});var l=n.slice();var u=Object.create(null);var c,f,h,p,v,d,m;for(c=0,f=0;c<n.length;c++){h=n[c];if(!s.hasOwnProperty(h)){a.push({command:ct.removeLayer,args:[h]});l.splice(l.indexOf(h,f),1)}else{f++}}for(c=0,f=0;c<i.length;c++){h=i[i.length-1-c];if(l[l.length-1-c]===h){continue}if(o.hasOwnProperty(h)){a.push({command:ct.removeLayer,args:[h]});l.splice(l.lastIndexOf(h,l.length-f),1)}else{f++}d=l[l.length-c];a.push({command:ct.addLayer,args:[s[h],d]});l.splice(l.length-c,0,h);u[h]=true}for(c=0;c<i.length;c++){h=i[c];p=o[h];v=s[h];if(u[h]||e.deepEqual(p,v)){continue}if(!e.deepEqual(p.source,v.source)||!e.deepEqual(p["source-layer"],v["source-layer"])||!e.deepEqual(p.type,v.type)){a.push({command:ct.removeLayer,args:[h]});d=l[l.lastIndexOf(h)+1];a.push({command:ct.addLayer,args:[v,d]});continue}mt(p.layout,v.layout,a,h,null,ct.setLayoutProperty);mt(p.paint,v.paint,a,h,null,ct.setPaintProperty);if(!e.deepEqual(p.filter,v.filter)){a.push({command:ct.setFilter,args:[h,v.filter]})}if(!e.deepEqual(p.minzoom,v.minzoom)||!e.deepEqual(p.maxzoom,v.maxzoom)){a.push({command:ct.setLayerZoomRange,args:[h,v.minzoom,v.maxzoom]})}for(m in p){if(!p.hasOwnProperty(m)){continue}if(m==="layout"||m==="paint"||m==="filter"||m==="metadata"||m==="minzoom"||m==="maxzoom"){continue}if(m.indexOf("paint.")===0){mt(p[m],v[m],a,h,m.slice(6),ct.setPaintProperty)}else if(!e.deepEqual(p[m],v[m])){a.push({command:ct.setLayerProperty,args:[h,m,v[m]]})}}for(m in v){if(!v.hasOwnProperty(m)||p.hasOwnProperty(m)){continue}if(m==="layout"||m==="paint"||m==="filter"||m==="metadata"||m==="minzoom"||m==="maxzoom"){continue}if(m.indexOf("paint.")===0){mt(p[m],v[m],a,h,m.slice(6),ct.setPaintProperty)}else if(!e.deepEqual(p[m],v[m])){a.push({command:ct.setLayerProperty,args:[h,m,v[m]]})}}}}function bt(t,r){if(!t){return[{command:ct.setStyle,args:[r]}]}var a=[];try{if(!e.deepEqual(t.version,r.version)){return[{command:ct.setStyle,args:[r]}]}if(!e.deepEqual(t.center,r.center)){a.push({command:ct.setCenter,args:[r.center]})}if(!e.deepEqual(t.zoom,r.zoom)){a.push({command:ct.setZoom,args:[r.zoom]})}if(!e.deepEqual(t.bearing,r.bearing)){a.push({command:ct.setBearing,args:[r.bearing]})}if(!e.deepEqual(t.pitch,r.pitch)){a.push({command:ct.setPitch,args:[r.pitch]})}if(!e.deepEqual(t.sprite,r.sprite)){a.push({command:ct.setSprite,args:[r.sprite]})}if(!e.deepEqual(t.glyphs,r.glyphs)){a.push({command:ct.setGlyphs,args:[r.glyphs]})}if(!e.deepEqual(t.transition,r.transition)){a.push({command:ct.setTransition,args:[r.transition]})}if(!e.deepEqual(t.light,r.light)){a.push({command:ct.setLight,args:[r.light]})}var n={};var i=[];dt(t.sources,r.sources,i,n);var o=[];if(t.layers){t.layers.forEach((function(e){if(n[e.source]){a.push({command:ct.removeLayer,args:[e.id]})}else{o.push(e)}}))}a=a.concat(i);xt(o,r.layers,a)}catch(s){console.warn("Unable to compute style diff:",s);a=[{command:ct.setStyle,args:[r]}]}return a}var _t=function e(t,r){this.reset(t,r)};_t.prototype.reset=function e(t,r){this.points=t||[];this._distances=[0];for(var a=1;a<this.points.length;a++){this._distances[a]=this._distances[a-1]+this.points[a].dist(this.points[a-1])}this.length=this._distances[this._distances.length-1];this.padding=Math.min(r||0,this.length*.5);this.paddedLength=this.length-this.padding*2};_t.prototype.lerp=function t(r){if(this.points.length===1){return this.points[0]}r=e.clamp(r,0,1);var a=1;var n=this._distances[a];var i=r*this.paddedLength+this.padding;while(n<i&&a<this._distances.length){n=this._distances[++a]}var o=a-1;var s=this._distances[o];var l=n-s;var u=l>0?(i-s)/l:0;return this.points[o].mult(1-u).add(this.points[a].mult(u))};var wt=function e(t,r,a){var n=this.boxCells=[];var i=this.circleCells=[];this.xCellCount=Math.ceil(t/a);this.yCellCount=Math.ceil(r/a);for(var o=0;o<this.xCellCount*this.yCellCount;o++){n.push([]);i.push([])}this.circleKeys=[];this.boxKeys=[];this.bboxes=[];this.circles=[];this.width=t;this.height=r;this.xScale=this.xCellCount/t;this.yScale=this.yCellCount/r;this.boxUid=0;this.circleUid=0};wt.prototype.keysLength=function e(){return this.boxKeys.length+this.circleKeys.length};wt.prototype.insert=function e(t,r,a,n,i){this._forEachCell(r,a,n,i,this._insertBoxCell,this.boxUid++);this.boxKeys.push(t);this.bboxes.push(r);this.bboxes.push(a);this.bboxes.push(n);this.bboxes.push(i)};wt.prototype.insertCircle=function e(t,r,a,n){this._forEachCell(r-n,a-n,r+n,a+n,this._insertCircleCell,this.circleUid++);this.circleKeys.push(t);this.circles.push(r);this.circles.push(a);this.circles.push(n)};wt.prototype._insertBoxCell=function e(t,r,a,n,i,o){this.boxCells[i].push(o)};wt.prototype._insertCircleCell=function e(t,r,a,n,i,o){this.circleCells[i].push(o)};wt.prototype._query=function e(t,r,a,n,i,o){if(a<0||t>this.width||n<0||r>this.height){return i?false:[]}var s=[];if(t<=0&&r<=0&&this.width<=a&&this.height<=n){if(i){return true}for(var l=0;l<this.boxKeys.length;l++){s.push({key:this.boxKeys[l],x1:this.bboxes[l*4],y1:this.bboxes[l*4+1],x2:this.bboxes[l*4+2],y2:this.bboxes[l*4+3]})}for(var u=0;u<this.circleKeys.length;u++){var c=this.circles[u*3];var f=this.circles[u*3+1];var h=this.circles[u*3+2];s.push({key:this.circleKeys[u],x1:c-h,y1:f-h,x2:c+h,y2:f+h})}return o?s.filter(o):s}else{var p={hitTest:i,seenUids:{box:{},circle:{}}};this._forEachCell(t,r,a,n,this._queryCell,s,p,o);return i?s.length>0:s}};wt.prototype._queryCircle=function e(t,r,a,n,i){var o=t-a;var s=t+a;var l=r-a;var u=r+a;if(s<0||o>this.width||u<0||l>this.height){return n?false:[]}var c=[];var f={hitTest:n,circle:{x:t,y:r,radius:a},seenUids:{box:{},circle:{}}};this._forEachCell(o,l,s,u,this._queryCellCircle,c,f,i);return n?c.length>0:c};wt.prototype.query=function e(t,r,a,n,i){return this._query(t,r,a,n,false,i)};wt.prototype.hitTest=function e(t,r,a,n,i){return this._query(t,r,a,n,true,i)};wt.prototype.hitTestCircle=function e(t,r,a,n){return this._queryCircle(t,r,a,true,n)};wt.prototype._queryCell=function e(t,r,a,n,i,o,s,l){var u=s.seenUids;var c=this.boxCells[i];if(c!==null){var f=this.bboxes;for(var h=0,p=c;h<p.length;h+=1){var v=p[h];if(!u.box[v]){u.box[v]=true;var d=v*4;if(t<=f[d+2]&&r<=f[d+3]&&a>=f[d+0]&&n>=f[d+1]&&(!l||l(this.boxKeys[v]))){if(s.hitTest){o.push(true);return true}else{o.push({key:this.boxKeys[v],x1:f[d],y1:f[d+1],x2:f[d+2],y2:f[d+3]})}}}}}var m=this.circleCells[i];if(m!==null){var g=this.circles;for(var y=0,x=m;y<x.length;y+=1){var b=x[y];if(!u.circle[b]){u.circle[b]=true;var _=b*3;if(this._circleAndRectCollide(g[_],g[_+1],g[_+2],t,r,a,n)&&(!l||l(this.circleKeys[b]))){if(s.hitTest){o.push(true);return true}else{var w=g[_];var T=g[_+1];var k=g[_+2];o.push({key:this.circleKeys[b],x1:w-k,y1:T-k,x2:w+k,y2:T+k})}}}}}};wt.prototype._queryCellCircle=function e(t,r,a,n,i,o,s,l){var u=s.circle;var c=s.seenUids;var f=this.boxCells[i];if(f!==null){var h=this.bboxes;for(var p=0,v=f;p<v.length;p+=1){var d=v[p];if(!c.box[d]){c.box[d]=true;var m=d*4;if(this._circleAndRectCollide(u.x,u.y,u.radius,h[m+0],h[m+1],h[m+2],h[m+3])&&(!l||l(this.boxKeys[d]))){o.push(true);return true}}}}var g=this.circleCells[i];if(g!==null){var y=this.circles;for(var x=0,b=g;x<b.length;x+=1){var _=b[x];if(!c.circle[_]){c.circle[_]=true;var w=_*3;if(this._circlesCollide(y[w],y[w+1],y[w+2],u.x,u.y,u.radius)&&(!l||l(this.circleKeys[_]))){o.push(true);return true}}}}};wt.prototype._forEachCell=function e(t,r,a,n,i,o,s,l){var u=this._convertToXCellCoord(t);var c=this._convertToYCellCoord(r);var f=this._convertToXCellCoord(a);var h=this._convertToYCellCoord(n);for(var p=u;p<=f;p++){for(var v=c;v<=h;v++){var d=this.xCellCount*v+p;if(i.call(this,t,r,a,n,d,o,s,l)){return}}}};wt.prototype._convertToXCellCoord=function e(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))};wt.prototype._convertToYCellCoord=function e(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))};wt.prototype._circlesCollide=function e(t,r,a,n,i,o){var s=n-t;var l=i-r;var u=a+o;return u*u>s*s+l*l};wt.prototype._circleAndRectCollide=function e(t,r,a,n,i,o,s){var l=(o-n)/2;var u=Math.abs(t-(n+l));if(u>l+a){return false}var c=(s-i)/2;var f=Math.abs(r-(i+c));if(f>c+a){return false}if(u<=l||f<=c){return true}var h=u-l;var p=f-c;return h*h+p*p<=a*a};function Tt(t,r,a,n,i){var o=e.create();if(r){e.scale(o,o,[1/i,1/i,1]);if(!a){e.rotateZ(o,o,n.angle)}}else{e.multiply(o,n.labelPlaneMatrix,t)}return o}function kt(t,r,a,n,i){if(r){var o=e.clone(t);e.scale(o,o,[i,i,1]);if(!a){e.rotateZ(o,o,-n.angle)}return o}else{return n.glCoordMatrix}}function Mt(t,r){var a=[t.x,t.y,0,1];Rt(a,a,r);var n=a[3];return{point:new e.Point(a[0]/n,a[1]/n),signedDistanceFromCamera:n}}function At(e,t){return.5+.5*(e/t)}function St(e,t){var r=e[0]/e[3];var a=e[1]/e[3];var n=r>=-t[0]&&r<=t[0]&&a>=-t[1]&&a<=t[1];return n}function Et(t,r,a,n,i,o,s,l){var u=n?t.textSizeData:t.iconSizeData;var c=e.evaluateSizeForZoom(u,a.transform.zoom);var f=[256/a.width*2+1,256/a.height*2+1];var h=n?t.text.dynamicLayoutVertexArray:t.icon.dynamicLayoutVertexArray;h.clear();var p=t.lineVertexArray;var v=n?t.text.placedSymbolArray:t.icon.placedSymbolArray;var d=a.transform.width/a.transform.height;var m=false;for(var g=0;g<v.length;g++){var y=v.get(g);if(y.hidden||y.writingMode===e.WritingMode.vertical&&!m){Dt(y.numGlyphs,h);continue}m=false;var x=[y.anchorX,y.anchorY,0,1];e.transformMat4(x,x,r);if(!St(x,f)){Dt(y.numGlyphs,h);continue}var b=x[3];var _=At(a.transform.cameraToCenterDistance,b);var w=e.evaluateSizeForFeature(u,c,y);var T=s?w/_:w*_;var k=new e.Point(y.anchorX,y.anchorY);var M=Mt(k,i).point;var A={};var S=It(y,T,false,l,r,i,o,t.glyphOffsetArray,p,h,M,k,A,d);m=S.useVertical;if(S.notEnoughRoom||m||S.needsFlipping&&It(y,T,true,l,r,i,o,t.glyphOffsetArray,p,h,M,k,A,d).notEnoughRoom){Dt(y.numGlyphs,h)}}if(n){t.text.dynamicLayoutVertexBuffer.updateData(h)}else{t.icon.dynamicLayoutVertexBuffer.updateData(h)}}function Lt(e,t,r,a,n,i,o,s,l,u,c){var f=s.glyphStartIndex+s.numGlyphs;var h=s.lineStartIndex;var p=s.lineStartIndex+s.lineLength;var v=t.getoffsetX(s.glyphStartIndex);var d=t.getoffsetX(f-1);var m=Ot(e*v,r,a,n,i,o,s.segment,h,p,l,u,c);if(!m){return null}var g=Ot(e*d,r,a,n,i,o,s.segment,h,p,l,u,c);if(!g){return null}return{first:m,last:g}}function Ct(t,r,a,n){if(t===e.WritingMode.horizontal){var i=Math.abs(a.y-r.y);var o=Math.abs(a.x-r.x)*n;if(i>o){return{useVertical:true}}}if(t===e.WritingMode.vertical?r.y<a.y:r.x>a.x){return{needsFlipping:true}}return null}function It(t,r,a,n,i,o,s,l,u,c,f,h,p,v){var d=r/24;var m=t.lineOffsetX*d;var g=t.lineOffsetY*d;var y;if(t.numGlyphs>1){var x=t.glyphStartIndex+t.numGlyphs;var b=t.lineStartIndex;var _=t.lineStartIndex+t.lineLength;var w=Lt(d,l,m,g,a,f,h,t,u,o,p);if(!w){return{notEnoughRoom:true}}var T=Mt(w.first.point,s).point;var k=Mt(w.last.point,s).point;if(n&&!a){var M=Ct(t.writingMode,T,k,v);if(M){return M}}y=[w.first];for(var A=t.glyphStartIndex+1;A<x-1;A++){y.push(Ot(d*l.getoffsetX(A),m,g,a,f,h,t.segment,b,_,u,o,p))}y.push(w.last)}else{if(n&&!a){var S=Mt(h,i).point;var E=t.lineStartIndex+t.segment+1;var L=new e.Point(u.getx(E),u.gety(E));var C=Mt(L,i);var I=C.signedDistanceFromCamera>0?C.point:Pt(h,L,S,1,i);var P=Ct(t.writingMode,S,I,v);if(P){return P}}var O=Ot(d*l.getoffsetX(t.glyphStartIndex),m,g,a,f,h,t.segment,t.lineStartIndex,t.lineStartIndex+t.lineLength,u,o,p);if(!O){return{notEnoughRoom:true}}y=[O]}for(var z=0,D=y;z<D.length;z+=1){var R=D[z];e.addDynamicAttributes(c,R.point,R.angle)}return{}}function Pt(e,t,r,a,n){var i=Mt(e.add(e.sub(t)._unit()),n).point;var o=r.sub(i);return r.add(o._mult(a/o.mag()))}function Ot(t,r,a,n,i,o,s,l,u,c,f,h){var p=n?t-r:t+r;var v=p>0?1:-1;var d=0;if(n){v*=-1;d=Math.PI}if(v<0){d+=Math.PI}var m=v>0?l+s:l+s+1;var g=i;var y=i;var x=0;var b=0;var _=Math.abs(p);var w=[];while(x+b<=_){m+=v;if(m<l||m>=u){return null}y=g;w.push(g);g=h[m];if(g===undefined){var T=new e.Point(c.getx(m),c.gety(m));var k=Mt(T,f);if(k.signedDistanceFromCamera>0){g=h[m]=k.point}else{var M=m-v;var A=x===0?o:new e.Point(c.getx(M),c.gety(M));g=Pt(A,T,y,_-x+1,f)}}x+=b;b=y.dist(g)}var S=(_-x)/b;var E=g.sub(y);var L=E.mult(S)._add(y);L._add(E._unit()._perp()._mult(a*v));var C=d+Math.atan2(g.y-y.y,g.x-y.x);w.push(L);return{point:L,angle:C,path:w}}var zt=new Float32Array([-Infinity,-Infinity,0,-Infinity,-Infinity,0,-Infinity,-Infinity,0,-Infinity,-Infinity,0]);function Dt(e,t){for(var r=0;r<e;r++){var a=t.length;t.resize(a+4);t.float32.set(zt,a*3)}}function Rt(e,t,r){var a=t[0],n=t[1];e[0]=r[0]*a+r[4]*n+r[12];e[1]=r[1]*a+r[5]*n+r[13];e[3]=r[3]*a+r[7]*n+r[15];return e}var Ft=100;var Bt=function e(t,r,a){if(r===void 0)r=new wt(t.width+2*Ft,t.height+2*Ft,25);if(a===void 0)a=new wt(t.width+2*Ft,t.height+2*Ft,25);this.transform=t;this.grid=r;this.ignoredGrid=a;this.pitchfactor=Math.cos(t._pitch)*t.cameraToCenterDistance;this.screenRightBoundary=t.width+Ft;this.screenBottomBoundary=t.height+Ft;this.gridRightBoundary=t.width+2*Ft;this.gridBottomBoundary=t.height+2*Ft};Bt.prototype.placeCollisionBox=function e(t,r,a,n,i){var o=this.projectAndGetPerspectiveRatio(n,t.anchorPointX,t.anchorPointY);var s=a*o.perspectiveRatio;var l=t.x1*s+o.point.x;var u=t.y1*s+o.point.y;var c=t.x2*s+o.point.x;var f=t.y2*s+o.point.y;if(!this.isInsideGrid(l,u,c,f)||!r&&this.grid.hitTest(l,u,c,f,i)){return{box:[],offscreen:false}}return{box:[l,u,c,f],offscreen:this.isOffscreen(l,u,c,f)}};Bt.prototype.placeCollisionCircles=function t(r,a,n,i,o,s,l,u,c,f,h,p,v){var d=[];var m=new e.Point(a.anchorX,a.anchorY);var g=Mt(m,s);var y=At(this.transform.cameraToCenterDistance,g.signedDistanceFromCamera);var x=f?o/y:o*y;var b=x/e.ONE_EM;var _=Mt(m,l).point;var w={};var T=a.lineOffsetX*b;var k=a.lineOffsetY*b;var M=Lt(b,i,T,k,false,_,m,a,n,l,w);var A=false;var S=false;var E=true;if(M){var L=p*.5*y+v;var C=new e.Point(-Ft,-Ft);var I=new e.Point(this.screenRightBoundary,this.screenBottomBoundary);var P=new _t;var O=M.first;var z=M.last;var D=[];for(var R=O.path.length-1;R>=1;R--){D.push(O.path[R])}for(var F=1;F<z.path.length;F++){D.push(z.path[F])}var B=L*2.5;if(u){var N=D.map((function(e){return Mt(e,u)}));if(N.some((function(e){return e.signedDistanceFromCamera<=0}))){D=[]}else{D=N.map((function(e){return e.point}))}}var j=[];if(D.length>0){var U=D[0].clone();var V=D[0].clone();for(var H=1;H<D.length;H++){U.x=Math.min(U.x,D[H].x);U.y=Math.min(U.y,D[H].y);V.x=Math.max(V.x,D[H].x);V.y=Math.max(V.y,D[H].y)}if(U.x>=C.x&&V.x<=I.x&&U.y>=C.y&&V.y<=I.y){j=[D]}else if(V.x<C.x||U.x>I.x||V.y<C.y||U.y>I.y){j=[]}else{j=e.clipLine([D],C.x,C.y,I.x,I.y)}}for(var q=0,G=j;q<G.length;q+=1){var Y=G[q];P.reset(Y,L*.25);var W=0;if(P.length<=.5*L){W=1}else{W=Math.ceil(P.paddedLength/B)+1}for(var X=0;X<W;X++){var Z=X/Math.max(W-1,1);var J=P.lerp(Z);var K=J.x+Ft;var Q=J.y+Ft;d.push(K,Q,L,0);var $=K-L;var ee=Q-L;var te=K+L;var re=Q+L;E=E&&this.isOffscreen($,ee,te,re);S=S||this.isInsideGrid($,ee,te,re);if(!r){if(this.grid.hitTestCircle(K,Q,L,h)){A=true;if(!c){return{circles:[],offscreen:false,collisionDetected:A}}}}}}}return{circles:!c&&A||!S?[]:d,offscreen:E,collisionDetected:A}};Bt.prototype.queryRenderedSymbols=function t(r){if(r.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0){return{}}var a=[];var n=Infinity;var i=Infinity;var o=-Infinity;var s=-Infinity;for(var l=0,u=r;l<u.length;l+=1){var c=u[l];var f=new e.Point(c.x+Ft,c.y+Ft);n=Math.min(n,f.x);i=Math.min(i,f.y);o=Math.max(o,f.x);s=Math.max(s,f.y);a.push(f)}var h=this.grid.query(n,i,o,s).concat(this.ignoredGrid.query(n,i,o,s));var p={};var v={};for(var d=0,m=h;d<m.length;d+=1){var g=m[d];var y=g.key;if(p[y.bucketInstanceId]===undefined){p[y.bucketInstanceId]={}}if(p[y.bucketInstanceId][y.featureIndex]){continue}var x=[new e.Point(g.x1,g.y1),new e.Point(g.x2,g.y1),new e.Point(g.x2,g.y2),new e.Point(g.x1,g.y2)];if(!e.polygonIntersectsPolygon(a,x)){continue}p[y.bucketInstanceId][y.featureIndex]=true;if(v[y.bucketInstanceId]===undefined){v[y.bucketInstanceId]=[]}v[y.bucketInstanceId].push(y.featureIndex)}return v};Bt.prototype.insertCollisionBox=function e(t,r,a,n,i){var o=r?this.ignoredGrid:this.grid;var s={bucketInstanceId:a,featureIndex:n,collisionGroupID:i};o.insert(s,t[0],t[1],t[2],t[3])};Bt.prototype.insertCollisionCircles=function e(t,r,a,n,i){var o=r?this.ignoredGrid:this.grid;var s={bucketInstanceId:a,featureIndex:n,collisionGroupID:i};for(var l=0;l<t.length;l+=4){o.insertCircle(s,t[l],t[l+1],t[l+2])}};Bt.prototype.projectAndGetPerspectiveRatio=function t(r,a,n){var i=[a,n,0,1];Rt(i,i,r);var o=new e.Point((i[0]/i[3]+1)/2*this.transform.width+Ft,(-i[1]/i[3]+1)/2*this.transform.height+Ft);return{point:o,perspectiveRatio:.5+.5*(this.transform.cameraToCenterDistance/i[3])}};Bt.prototype.isOffscreen=function e(t,r,a,n){return a<Ft||t>=this.screenRightBoundary||n<Ft||r>this.screenBottomBoundary};Bt.prototype.isInsideGrid=function e(t,r,a,n){return a>=0&&t<this.gridRightBoundary&&n>=0&&r<this.gridBottomBoundary};Bt.prototype.getViewportMatrix=function t(){var r=e.identity([]);e.translate(r,r,[-Ft,-Ft,0]);return r};function Nt(t,r,a){return r*(e.EXTENT/(t.tileSize*Math.pow(2,a-t.tileID.overscaledZ)))}var jt=function e(t,r,a,n){if(t){this.opacity=Math.max(0,Math.min(1,t.opacity+(t.placed?r:-r)))}else{this.opacity=n&&a?1:0}this.placed=a};jt.prototype.isHidden=function e(){return this.opacity===0&&!this.placed};var Ut=function e(t,r,a,n,i){this.text=new jt(t?t.text:null,r,a,i);this.icon=new jt(t?t.icon:null,r,n,i)};Ut.prototype.isHidden=function e(){return this.text.isHidden()&&this.icon.isHidden()};var Vt=function e(t,r,a){this.text=t;this.icon=r;this.skipFade=a};var Ht=function t(){this.invProjMatrix=e.create();this.viewportMatrix=e.create();this.circles=[]};var qt=function e(t,r,a,n,i){this.bucketInstanceId=t;this.featureIndex=r;this.sourceLayerIndex=a;this.bucketIndex=n;this.tileID=i};var Gt=function e(t){this.crossSourceCollisions=t;this.maxGroupID=0;this.collisionGroups={}};Gt.prototype.get=function e(t){if(!this.crossSourceCollisions){if(!this.collisionGroups[t]){var r=++this.maxGroupID;this.collisionGroups[t]={ID:r,predicate:function(e){return e.collisionGroupID===r}}}return this.collisionGroups[t]}else{return{ID:0,predicate:null}}};function Yt(t,r,a,n,i){var o=e.getAnchorAlignment(t);var s=o.horizontalAlign;var l=o.verticalAlign;var u=-(s-.5)*r;var c=-(l-.5)*a;var f=e.evaluateVariableOffset(t,n);return new e.Point(u+f[0]*i,c+f[1]*i)}function Wt(t,r,a,n,i,o){var s=t.x1;var l=t.x2;var u=t.y1;var c=t.y2;var f=t.anchorPointX;var h=t.anchorPointY;var p=new e.Point(r,a);if(n){p._rotate(i?o:-o)}return{x1:s+p.x,y1:u+p.y,x2:l+p.x,y2:c+p.y,anchorPointX:f,anchorPointY:h}}var Xt=function e(t,r,a,n){this.transform=t.clone();this.collisionIndex=new Bt(this.transform);this.placements={};this.opacities={};this.variableOffsets={};this.stale=false;this.commitTime=0;this.fadeDuration=r;this.retainedQueryData={};this.collisionGroups=new Gt(a);this.collisionCircleArrays={};this.prevPlacement=n;if(n){n.prevPlacement=undefined}this.placedOrientations={}};Xt.prototype.getBucketParts=function t(r,a,n,i){var o=n.getBucket(a);var s=n.latestFeatureIndex;if(!o||!s||a.id!==o.layerIds[0]){return}var l=n.collisionBoxArray;var u=o.layers[0].layout;var c=Math.pow(2,this.transform.zoom-n.tileID.overscaledZ);var f=n.tileSize/e.EXTENT;var h=this.transform.calculatePosMatrix(n.tileID.toUnwrapped());var p=u.get("text-pitch-alignment")==="map";var v=u.get("text-rotation-alignment")==="map";var d=Nt(n,1,this.transform.zoom);var m=Tt(h,p,v,this.transform,d);var g=null;if(p){var y=kt(h,p,v,this.transform,d);g=e.multiply([],this.transform.labelPlaneMatrix,y)}this.retainedQueryData[o.bucketInstanceId]=new qt(o.bucketInstanceId,s,o.sourceLayerIndex,o.index,n.tileID);var x={bucket:o,layout:u,posMatrix:h,textLabelPlaneMatrix:m,labelToScreenMatrix:g,scale:c,textPixelRatio:f,holdingForFade:n.holdingForFade(),collisionBoxArray:l,partiallyEvaluatedTextSize:e.evaluateSizeForZoom(o.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(o.sourceID)};if(i){for(var b=0,_=o.sortKeyRanges;b<_.length;b+=1){var w=_[b];var T=w.sortKey;var k=w.symbolInstanceStart;var M=w.symbolInstanceEnd;r.push({sortKey:T,symbolInstanceStart:k,symbolInstanceEnd:M,parameters:x})}}else{r.push({symbolInstanceStart:0,symbolInstanceEnd:o.symbolInstances.length,parameters:x})}};Xt.prototype.attemptAnchorPlacement=function e(t,r,a,n,i,o,s,l,u,c,f,h,p,v,d){var m=[h.textOffset0,h.textOffset1];var g=Yt(t,a,n,m,i);var y=this.collisionIndex.placeCollisionBox(Wt(r,g.x,g.y,o,s,this.transform.angle),f,l,u,c.predicate);if(d){var x=this.collisionIndex.placeCollisionBox(Wt(d,g.x,g.y,o,s,this.transform.angle),f,l,u,c.predicate);if(x.box.length===0){return}}if(y.box.length>0){var b;if(this.prevPlacement&&this.prevPlacement.variableOffsets[h.crossTileID]&&this.prevPlacement.placements[h.crossTileID]&&this.prevPlacement.placements[h.crossTileID].text){b=this.prevPlacement.variableOffsets[h.crossTileID].anchor}this.variableOffsets[h.crossTileID]={textOffset:m,width:a,height:n,anchor:t,textBoxScale:i,prevAnchor:b};this.markUsedJustification(p,t,h,v);if(p.allowVerticalPlacement){this.markUsedOrientation(p,v,h);this.placedOrientations[h.crossTileID]=v}return{shift:g,placedGlyphBoxes:y}}};Xt.prototype.placeLayerBucketPart=function t(r,a,n){var i=this;var o=r.parameters;var s=o.bucket;var l=o.layout;var u=o.posMatrix;var c=o.textLabelPlaneMatrix;var f=o.labelToScreenMatrix;var h=o.textPixelRatio;var p=o.holdingForFade;var v=o.collisionBoxArray;var d=o.partiallyEvaluatedTextSize;var m=o.collisionGroup;var g=l.get("text-optional");var y=l.get("icon-optional");var x=l.get("text-allow-overlap");var b=l.get("icon-allow-overlap");var _=l.get("text-rotation-alignment")==="map";var w=l.get("text-pitch-alignment")==="map";var T=l.get("icon-text-fit")!=="none";var k=l.get("symbol-z-order")==="viewport-y";var M=x&&(b||!s.hasIconData()||y);var A=b&&(x||!s.hasTextData()||g);if(!s.collisionArrays&&v){s.deserializeCollisionBoxes(v)}var S=function(t,r){if(a[t.crossTileID]){return}if(p){i.placements[t.crossTileID]=new Vt(false,false,false);return}var o=false;var v=false;var k=true;var S=null;var E={box:null,offscreen:null};var L={box:null,offscreen:null};var C=null;var I=null;var P=null;var O=0;var z=0;var D=0;if(r.textFeatureIndex){O=r.textFeatureIndex}else if(t.useRuntimeCollisionCircles){O=t.featureIndex}if(r.verticalTextFeatureIndex){z=r.verticalTextFeatureIndex}var R=r.textBox;if(R){var F=function(r){var a=e.WritingMode.horizontal;if(s.allowVerticalPlacement&&!r&&i.prevPlacement){var n=i.prevPlacement.placedOrientations[t.crossTileID];if(n){i.placedOrientations[t.crossTileID]=n;a=n;i.markUsedOrientation(s,a,t)}}return a};var B=function(a,n){if(s.allowVerticalPlacement&&t.numVerticalGlyphVertices>0&&r.verticalTextBox){for(var i=0,o=s.writingModes;i<o.length;i+=1){var l=o[i];if(l===e.WritingMode.vertical){E=n();L=E}else{E=a()}if(E&&E.box&&E.box.length){break}}}else{E=a()}};if(!l.get("text-variable-anchor")){var N=function(e,r){var a=i.collisionIndex.placeCollisionBox(e,x,h,u,m.predicate);if(a&&a.box&&a.box.length){i.markUsedOrientation(s,r,t);i.placedOrientations[t.crossTileID]=r}return a};var j=function(){return N(R,e.WritingMode.horizontal)};var U=function(){var a=r.verticalTextBox;if(s.allowVerticalPlacement&&t.numVerticalGlyphVertices>0&&a){return N(a,e.WritingMode.vertical)}return{box:null,offscreen:null}};B(j,U);F(E&&E.box&&E.box.length)}else{var V=l.get("text-variable-anchor");if(i.prevPlacement&&i.prevPlacement.variableOffsets[t.crossTileID]){var H=i.prevPlacement.variableOffsets[t.crossTileID];if(V.indexOf(H.anchor)>0){V=V.filter((function(e){return e!==H.anchor}));V.unshift(H.anchor)}}var q=function(e,r,a){var n=e.x2-e.x1;var l=e.y2-e.y1;var c=t.textBoxScale;var f=T&&!b?r:null;var p={box:[],offscreen:false};var v=x?V.length*2:V.length;for(var d=0;d<v;++d){var g=V[d%V.length];var y=d>=V.length;var k=i.attemptAnchorPlacement(g,e,n,l,c,_,w,h,u,m,y,t,s,a,f);if(k){p=k.placedGlyphBoxes;if(p&&p.box&&p.box.length){o=true;S=k.shift;break}}}return p};var G=function(){return q(R,r.iconBox,e.WritingMode.horizontal)};var Y=function(){var a=r.verticalTextBox;var n=E&&E.box&&E.box.length;if(s.allowVerticalPlacement&&!n&&t.numVerticalGlyphVertices>0&&a){return q(a,r.verticalIconBox,e.WritingMode.vertical)}return{box:null,offscreen:null}};B(G,Y);if(E){o=E.box;k=E.offscreen}var W=F(E&&E.box);if(!o&&i.prevPlacement){var X=i.prevPlacement.variableOffsets[t.crossTileID];if(X){i.variableOffsets[t.crossTileID]=X;i.markUsedJustification(s,X.anchor,t,W)}}}}C=E;o=C&&C.box&&C.box.length>0;k=C&&C.offscreen;if(t.useRuntimeCollisionCircles){var Z=s.text.placedSymbolArray.get(t.centerJustifiedTextSymbolIndex);var J=e.evaluateSizeForFeature(s.textSizeData,d,Z);var K=l.get("text-padding");var Q=t.collisionCircleDiameter;I=i.collisionIndex.placeCollisionCircles(x,Z,s.lineVertexArray,s.glyphOffsetArray,J,u,c,f,n,w,m.predicate,Q,K);o=x||I.circles.length>0&&!I.collisionDetected;k=k&&I.offscreen}if(r.iconFeatureIndex){D=r.iconFeatureIndex}if(r.iconBox){var $=function(e){var t=T&&S?Wt(e,S.x,S.y,_,w,i.transform.angle):e;return i.collisionIndex.placeCollisionBox(t,b,h,u,m.predicate)};if(L&&L.box&&L.box.length&&r.verticalIconBox){P=$(r.verticalIconBox);v=P.box.length>0}else{P=$(r.iconBox);v=P.box.length>0}k=k&&P.offscreen}var ee=g||t.numHorizontalGlyphVertices===0&&t.numVerticalGlyphVertices===0;var te=y||t.numIconVertices===0;if(!ee&&!te){v=o=v&&o}else if(!te){o=v&&o}else if(!ee){v=v&&o}if(o&&C&&C.box){if(L&&L.box&&z){i.collisionIndex.insertCollisionBox(C.box,l.get("text-ignore-placement"),s.bucketInstanceId,z,m.ID)}else{i.collisionIndex.insertCollisionBox(C.box,l.get("text-ignore-placement"),s.bucketInstanceId,O,m.ID)}}if(v&&P){i.collisionIndex.insertCollisionBox(P.box,l.get("icon-ignore-placement"),s.bucketInstanceId,D,m.ID)}if(I){if(o){i.collisionIndex.insertCollisionCircles(I.circles,l.get("text-ignore-placement"),s.bucketInstanceId,O,m.ID)}if(n){var re=s.bucketInstanceId;var ae=i.collisionCircleArrays[re];if(ae===undefined){ae=i.collisionCircleArrays[re]=new Ht}for(var ne=0;ne<I.circles.length;ne+=4){ae.circles.push(I.circles[ne+0]);ae.circles.push(I.circles[ne+1]);ae.circles.push(I.circles[ne+2]);ae.circles.push(I.collisionDetected?1:0)}}}i.placements[t.crossTileID]=new Vt(o||M,v||A,k||s.justReloaded);a[t.crossTileID]=true};if(k){var E=s.getSortedSymbolIndexes(this.transform.angle);for(var L=E.length-1;L>=0;--L){var C=E[L];S(s.symbolInstances.get(C),s.collisionArrays[C])}}else{for(var I=r.symbolInstanceStart;I<r.symbolInstanceEnd;I++){S(s.symbolInstances.get(I),s.collisionArrays[I])}}if(n&&s.bucketInstanceId in this.collisionCircleArrays){var P=this.collisionCircleArrays[s.bucketInstanceId];e.invert(P.invProjMatrix,u);P.viewportMatrix=this.collisionIndex.getViewportMatrix()}s.justReloaded=false};Xt.prototype.markUsedJustification=function t(r,a,n,i){var o={left:n.leftJustifiedTextSymbolIndex,center:n.centerJustifiedTextSymbolIndex,right:n.rightJustifiedTextSymbolIndex};var s;if(i===e.WritingMode.vertical){s=n.verticalPlacedTextSymbolIndex}else{s=o[e.getAnchorJustification(a)]}var l=[n.leftJustifiedTextSymbolIndex,n.centerJustifiedTextSymbolIndex,n.rightJustifiedTextSymbolIndex,n.verticalPlacedTextSymbolIndex];for(var u=0,c=l;u<c.length;u+=1){var f=c[u];if(f>=0){if(s>=0&&f!==s){r.text.placedSymbolArray.get(f).crossTileID=0}else{r.text.placedSymbolArray.get(f).crossTileID=n.crossTileID}}}};Xt.prototype.markUsedOrientation=function t(r,a,n){var i=a===e.WritingMode.horizontal||a===e.WritingMode.horizontalOnly?a:0;var o=a===e.WritingMode.vertical?a:0;var s=[n.leftJustifiedTextSymbolIndex,n.centerJustifiedTextSymbolIndex,n.rightJustifiedTextSymbolIndex];for(var l=0,u=s;l<u.length;l+=1){var c=u[l];r.text.placedSymbolArray.get(c).placedOrientation=i}if(n.verticalPlacedTextSymbolIndex){r.text.placedSymbolArray.get(n.verticalPlacedTextSymbolIndex).placedOrientation=o}};Xt.prototype.commit=function e(t){this.commitTime=t;this.zoomAtLastRecencyCheck=this.transform.zoom;var r=this.prevPlacement;var a=false;this.prevZoomAdjustment=r?r.zoomAdjustment(this.transform.zoom):0;var n=r?r.symbolFadeChange(t):1;var i=r?r.opacities:{};var o=r?r.variableOffsets:{};var s=r?r.placedOrientations:{};for(var l in this.placements){var u=this.placements[l];var c=i[l];if(c){this.opacities[l]=new Ut(c,n,u.text,u.icon);a=a||u.text!==c.text.placed||u.icon!==c.icon.placed}else{this.opacities[l]=new Ut(null,n,u.text,u.icon,u.skipFade);a=a||u.text||u.icon}}for(var f in i){var h=i[f];if(!this.opacities[f]){var p=new Ut(h,n,false,false);if(!p.isHidden()){this.opacities[f]=p;a=a||h.text.placed||h.icon.placed}}}for(var v in o){if(!this.variableOffsets[v]&&this.opacities[v]&&!this.opacities[v].isHidden()){this.variableOffsets[v]=o[v]}}for(var d in s){if(!this.placedOrientations[d]&&this.opacities[d]&&!this.opacities[d].isHidden()){this.placedOrientations[d]=s[d]}}if(a){this.lastPlacementChangeTime=t}else if(typeof this.lastPlacementChangeTime!=="number"){this.lastPlacementChangeTime=r?r.lastPlacementChangeTime:t}};Xt.prototype.updateLayerOpacities=function e(t,r){var a={};for(var n=0,i=r;n<i.length;n+=1){var o=i[n];var s=o.getBucket(t);if(s&&o.latestFeatureIndex&&t.id===s.layerIds[0]){this.updateBucketOpacities(s,a,o.collisionBoxArray)}}};Xt.prototype.updateBucketOpacities=function t(r,a,n){var i=this;if(r.hasTextData()){r.text.opacityVertexArray.clear()}if(r.hasIconData()){r.icon.opacityVertexArray.clear()}if(r.hasIconCollisionBoxData()){r.iconCollisionBox.collisionVertexArray.clear()}if(r.hasTextCollisionBoxData()){r.textCollisionBox.collisionVertexArray.clear()}var o=r.layers[0].layout;var s=new Ut(null,0,false,false,true);var l=o.get("text-allow-overlap");var u=o.get("icon-allow-overlap");var c=o.get("text-variable-anchor");var f=o.get("text-rotation-alignment")==="map";var h=o.get("text-pitch-alignment")==="map";var p=o.get("icon-text-fit")!=="none";var v=new Ut(null,0,l&&(u||!r.hasIconData()||o.get("icon-optional")),u&&(l||!r.hasTextData()||o.get("text-optional")),true);if(!r.collisionArrays&&n&&(r.hasIconCollisionBoxData()||r.hasTextCollisionBoxData())){r.deserializeCollisionBoxes(n)}var d=function(e,t,r){for(var a=0;a<t/4;a++){e.opacityVertexArray.emplaceBack(r)}};var m=function(t){var n=r.symbolInstances.get(t);var o=n.numHorizontalGlyphVertices;var l=n.numVerticalGlyphVertices;var u=n.crossTileID;var m=a[u];var g=i.opacities[u];if(m){g=s}else if(!g){g=v;i.opacities[u]=g}a[u]=true;var y=o>0||l>0;var x=n.numIconVertices>0;var b=i.placedOrientations[n.crossTileID];var _=b===e.WritingMode.vertical;var w=b===e.WritingMode.horizontal||b===e.WritingMode.horizontalOnly;if(y){var T=ar(g.text);var k=_?nr:T;d(r.text,o,k);var M=w?nr:T;d(r.text,l,M);var A=g.text.isHidden();[n.rightJustifiedTextSymbolIndex,n.centerJustifiedTextSymbolIndex,n.leftJustifiedTextSymbolIndex].forEach((function(e){if(e>=0){r.text.placedSymbolArray.get(e).hidden=A||_?1:0}}));if(n.verticalPlacedTextSymbolIndex>=0){r.text.placedSymbolArray.get(n.verticalPlacedTextSymbolIndex).hidden=A||w?1:0}var S=i.variableOffsets[n.crossTileID];if(S){i.markUsedJustification(r,S.anchor,n,b)}var E=i.placedOrientations[n.crossTileID];if(E){i.markUsedJustification(r,"left",n,E);i.markUsedOrientation(r,E,n)}}if(x){var L=ar(g.icon);var C=!(p&&n.verticalPlacedIconSymbolIndex&&_);if(n.placedIconSymbolIndex>=0){var I=C?L:nr;d(r.icon,n.numIconVertices,I);r.icon.placedSymbolArray.get(n.placedIconSymbolIndex).hidden=g.icon.isHidden()}if(n.verticalPlacedIconSymbolIndex>=0){var P=!C?L:nr;d(r.icon,n.numVerticalIconVertices,P);r.icon.placedSymbolArray.get(n.verticalPlacedIconSymbolIndex).hidden=g.icon.isHidden()}}if(r.hasIconCollisionBoxData()||r.hasTextCollisionBoxData()){var O=r.collisionArrays[t];if(O){var z=new e.Point(0,0);if(O.textBox||O.verticalTextBox){var D=true;if(c){var R=i.variableOffsets[u];if(R){z=Yt(R.anchor,R.width,R.height,R.textOffset,R.textBoxScale);if(f){z._rotate(h?i.transform.angle:-i.transform.angle)}}else{D=false}}if(O.textBox){Zt(r.textCollisionBox.collisionVertexArray,g.text.placed,!D||_,z.x,z.y)}if(O.verticalTextBox){Zt(r.textCollisionBox.collisionVertexArray,g.text.placed,!D||w,z.x,z.y)}}var F=Boolean(!w&&O.verticalIconBox);if(O.iconBox){Zt(r.iconCollisionBox.collisionVertexArray,g.icon.placed,F,p?z.x:0,p?z.y:0)}if(O.verticalIconBox){Zt(r.iconCollisionBox.collisionVertexArray,g.icon.placed,!F,p?z.x:0,p?z.y:0)}}}};for(var g=0;g<r.symbolInstances.length;g++)m(g);r.sortFeatures(this.transform.angle);if(this.retainedQueryData[r.bucketInstanceId]){this.retainedQueryData[r.bucketInstanceId].featureSortOrder=r.featureSortOrder}if(r.hasTextData()&&r.text.opacityVertexBuffer){r.text.opacityVertexBuffer.updateData(r.text.opacityVertexArray)}if(r.hasIconData()&&r.icon.opacityVertexBuffer){r.icon.opacityVertexBuffer.updateData(r.icon.opacityVertexArray)}if(r.hasIconCollisionBoxData()&&r.iconCollisionBox.collisionVertexBuffer){r.iconCollisionBox.collisionVertexBuffer.updateData(r.iconCollisionBox.collisionVertexArray)}if(r.hasTextCollisionBoxData()&&r.textCollisionBox.collisionVertexBuffer){r.textCollisionBox.collisionVertexBuffer.updateData(r.textCollisionBox.collisionVertexArray)}if(r.bucketInstanceId in this.collisionCircleArrays){var y=this.collisionCircleArrays[r.bucketInstanceId];r.placementInvProjMatrix=y.invProjMatrix;r.placementViewportMatrix=y.viewportMatrix;r.collisionCircleArray=y.circles;delete this.collisionCircleArrays[r.bucketInstanceId]}};Xt.prototype.symbolFadeChange=function e(t){return this.fadeDuration===0?1:(t-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment};Xt.prototype.zoomAdjustment=function e(t){return Math.max(0,(this.transform.zoom-t)/1.5)};Xt.prototype.hasTransitions=function e(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration};Xt.prototype.stillRecent=function e(t,r){var a=this.zoomAtLastRecencyCheck===r?1-this.zoomAdjustment(r):1;this.zoomAtLastRecencyCheck=r;return this.commitTime+this.fadeDuration*a>t};Xt.prototype.setStale=function e(){this.stale=true};function Zt(e,t,r,a,n){e.emplaceBack(t?1:0,r?1:0,a||0,n||0);e.emplaceBack(t?1:0,r?1:0,a||0,n||0);e.emplaceBack(t?1:0,r?1:0,a||0,n||0);e.emplaceBack(t?1:0,r?1:0,a||0,n||0)}var Jt=Math.pow(2,25);var Kt=Math.pow(2,24);var Qt=Math.pow(2,17);var $t=Math.pow(2,16);var er=Math.pow(2,9);var tr=Math.pow(2,8);var rr=Math.pow(2,1);function ar(e){if(e.opacity===0&&!e.placed){return 0}else if(e.opacity===1&&e.placed){return 4294967295}var t=e.placed?1:0;var r=Math.floor(e.opacity*127);return r*Jt+t*Kt+r*Qt+t*$t+r*er+t*tr+r*rr+t}var nr=0;var ir=function e(t){this._sortAcrossTiles=t.layout.get("symbol-z-order")!=="viewport-y"&&t.layout.get("symbol-sort-key").constantOr(1)!==undefined;this._currentTileIndex=0;this._currentPartIndex=0;this._seenCrossTileIDs={};this._bucketParts=[]};ir.prototype.continuePlacement=function e(t,r,a,n,i){var o=this._bucketParts;while(this._currentTileIndex<t.length){var s=t[this._currentTileIndex];r.getBucketParts(o,n,s,this._sortAcrossTiles);this._currentTileIndex++;if(i()){return true}}if(this._sortAcrossTiles){this._sortAcrossTiles=false;o.sort((function(e,t){return e.sortKey-t.sortKey}))}while(this._currentPartIndex<o.length){var l=o[this._currentPartIndex];r.placeLayerBucketPart(l,this._seenCrossTileIDs,a);this._currentPartIndex++;if(i()){return true}}return false};var or=function e(t,r,a,n,i,o,s){this.placement=new Xt(t,i,o,s);this._currentPlacementIndex=r.length-1;this._forceFullPlacement=a;this._showCollisionBoxes=n;this._done=false};or.prototype.isDone=function e(){return this._done};or.prototype.continuePlacement=function t(r,a,n){var i=this;var o=e.browser.now();var s=function(){var t=e.browser.now()-o;return i._forceFullPlacement?false:t>2};while(this._currentPlacementIndex>=0){var l=r[this._currentPlacementIndex];var u=a[l];var c=this.placement.collisionIndex.transform.zoom;if(u.type==="symbol"&&(!u.minzoom||u.minzoom<=c)&&(!u.maxzoom||u.maxzoom>c)){if(!this._inProgressLayer){this._inProgressLayer=new ir(u)}var f=this._inProgressLayer.continuePlacement(n[u.source],this.placement,this._showCollisionBoxes,u,s);if(f){return}delete this._inProgressLayer}this._currentPlacementIndex--}this._done=true};or.prototype.commit=function e(t){this.placement.commit(t);return this.placement};var sr=512/e.EXTENT/2;var lr=function e(t,r,a){this.tileID=t;this.indexedSymbolInstances={};this.bucketInstanceId=a;for(var n=0;n<r.length;n++){var i=r.get(n);var o=i.key;if(!this.indexedSymbolInstances[o]){this.indexedSymbolInstances[o]=[]}this.indexedSymbolInstances[o].push({crossTileID:i.crossTileID,coord:this.getScaledCoordinates(i,t)})}};lr.prototype.getScaledCoordinates=function t(r,a){var n=a.canonical.z-this.tileID.canonical.z;var i=sr/Math.pow(2,n);return{x:Math.floor((a.canonical.x*e.EXTENT+r.anchorX)*i),y:Math.floor((a.canonical.y*e.EXTENT+r.anchorY)*i)}};lr.prototype.findMatches=function e(t,r,a){var n=this.tileID.canonical.z<r.canonical.z?1:Math.pow(2,this.tileID.canonical.z-r.canonical.z);for(var i=0;i<t.length;i++){var o=t.get(i);if(o.crossTileID){continue}var s=this.indexedSymbolInstances[o.key];if(!s){continue}var l=this.getScaledCoordinates(o,r);for(var u=0,c=s;u<c.length;u+=1){var f=c[u];if(Math.abs(f.coord.x-l.x)<=n&&Math.abs(f.coord.y-l.y)<=n&&!a[f.crossTileID]){a[f.crossTileID]=true;o.crossTileID=f.crossTileID;break}}}};var ur=function e(){this.maxCrossTileID=0};ur.prototype.generate=function e(){return++this.maxCrossTileID};var cr=function e(){this.indexes={};this.usedCrossTileIDs={};this.lng=0};cr.prototype.handleWrapJump=function e(t){var r=Math.round((t-this.lng)/360);if(r!==0){for(var a in this.indexes){var n=this.indexes[a];var i={};for(var o in n){var s=n[o];s.tileID=s.tileID.unwrapTo(s.tileID.wrap+r);i[s.tileID.key]=s}this.indexes[a]=i}}this.lng=t};cr.prototype.addBucket=function e(t,r,a){if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===r.bucketInstanceId){return false}else{this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key])}}for(var n=0;n<r.symbolInstances.length;n++){var i=r.symbolInstances.get(n);i.crossTileID=0}if(!this.usedCrossTileIDs[t.overscaledZ]){this.usedCrossTileIDs[t.overscaledZ]={}}var o=this.usedCrossTileIDs[t.overscaledZ];for(var s in this.indexes){var l=this.indexes[s];if(Number(s)>t.overscaledZ){for(var u in l){var c=l[u];if(c.tileID.isChildOf(t)){c.findMatches(r.symbolInstances,t,o)}}}else{var f=t.scaledTo(Number(s));var h=l[f.key];if(h){h.findMatches(r.symbolInstances,t,o)}}}for(var p=0;p<r.symbolInstances.length;p++){var v=r.symbolInstances.get(p);if(!v.crossTileID){v.crossTileID=a.generate();o[v.crossTileID]=true}}if(this.indexes[t.overscaledZ]===undefined){this.indexes[t.overscaledZ]={}}this.indexes[t.overscaledZ][t.key]=new lr(t,r.symbolInstances,r.bucketInstanceId);return true};cr.prototype.removeBucketCrossTileIDs=function e(t,r){for(var a in r.indexedSymbolInstances){for(var n=0,i=r.indexedSymbolInstances[a];n<i.length;n+=1){var o=i[n];delete this.usedCrossTileIDs[t][o.crossTileID]}}};cr.prototype.removeStaleBuckets=function e(t){var r=false;for(var a in this.indexes){var n=this.indexes[a];for(var i in n){if(!t[n[i].bucketInstanceId]){this.removeBucketCrossTileIDs(a,n[i]);delete n[i];r=true}}}return r};var fr=function e(){this.layerIndexes={};this.crossTileIDs=new ur;this.maxBucketInstanceId=0;this.bucketsInCurrentPlacement={}};fr.prototype.addLayer=function e(t,r,a){var n=this.layerIndexes[t.id];if(n===undefined){n=this.layerIndexes[t.id]=new cr}var i=false;var o={};n.handleWrapJump(a);for(var s=0,l=r;s<l.length;s+=1){var u=l[s];var c=u.getBucket(t);if(!c||t.id!==c.layerIds[0]){continue}if(!c.bucketInstanceId){c.bucketInstanceId=++this.maxBucketInstanceId}if(n.addBucket(u.tileID,c,this.crossTileIDs)){i=true}o[c.bucketInstanceId]=true}if(n.removeStaleBuckets(o)){i=true}return i};fr.prototype.pruneUnusedLayers=function e(t){var r={};t.forEach((function(e){r[e]=true}));for(var a in this.layerIndexes){if(!r[a]){delete this.layerIndexes[a]}}};var hr=function(t,r){return e.emitValidationErrors(t,r&&r.filter((function(e){return e.identifier!=="source.canvas"})))};var pr=e.pick(ct,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]);var vr=e.pick(ct,["setCenter","setZoom","setBearing","setPitch"]);var dr=ut();var mr=function(t){function r(a,n){var i=this;if(n===void 0)n={};t.call(this);this.map=a;this.dispatcher=new E(nt(),this);this.imageManager=new v;this.imageManager.setEventedParent(this);this.glyphManager=new w(a._requestManager,n.localIdeographFontFamily);this.lineAtlas=new S(256,512);this.crossTileSymbolIndex=new fr;this._layers={};this._serializedLayers={};this._order=[];this.sourceCaches={};this.zoomHistory=new e.ZoomHistory;this._loaded=false;this._availableImages=[];this._resetUpdates();this.dispatcher.broadcast("setReferrer",e.getReferrer());var o=this;this._rtlTextPluginCallback=r.registerForPluginStateChange((function(t){var r={pluginStatus:t.pluginStatus,pluginURL:t.pluginURL};o.dispatcher.broadcast("syncRTLPluginState",r,(function(t,r){e.triggerPluginCompletionEvent(t);if(r){var a=r.every((function(e){return e}));if(a){for(var n in o.sourceCaches){o.sourceCaches[n].reload()}}}}))}));this.on("data",(function(e){if(e.dataType!=="source"||e.sourceDataType!=="metadata"){return}var t=i.sourceCaches[e.sourceId];if(!t){return}var r=t.getSource();if(!r||!r.vectorLayerIds){return}for(var a in i._layers){var n=i._layers[a];if(n.source===r.id){i._validateLayer(n)}}}))}if(t)r.__proto__=t;r.prototype=Object.create(t&&t.prototype);r.prototype.constructor=r;r.prototype.loadURL=function t(r,a){var n=this;if(a===void 0)a={};this.fire(new e.Event("dataloading",{dataType:"style"}));var i=typeof a.validate==="boolean"?a.validate:!e.isMapboxURL(r);r=this.map._requestManager.normalizeStyleURL(r,a.accessToken);var o=this.map._requestManager.transformRequest(r,e.ResourceType.Style);this._request=e.getJSON(o,(function(t,r){n._request=null;if(t){n.fire(new e.ErrorEvent(t))}else if(r){n._load(r,i)}}))};r.prototype.loadJSON=function t(r,a){var n=this;if(a===void 0)a={};this.fire(new e.Event("dataloading",{dataType:"style"}));this._request=e.browser.frame((function(){n._request=null;n._load(r,a.validate!==false)}))};r.prototype.loadEmpty=function t(){this.fire(new e.Event("dataloading",{dataType:"style"}));this._load(dr,false)};r.prototype._load=function t(r,a){if(a&&hr(this,e.validateStyle(r))){return}this._loaded=true;this.stylesheet=r;for(var n in r.sources){this.addSource(n,r.sources[n],{validate:false})}if(r.sprite){this._loadSprite(r.sprite)}else{this.imageManager.setLoaded(true)}this.glyphManager.setURL(r.glyphs);var i=lt(this.stylesheet.layers);this._order=i.map((function(e){return e.id}));this._layers={};this._serializedLayers={};for(var o=0,s=i;o<s.length;o+=1){var l=s[o];l=e.createStyleLayer(l);l.setEventedParent(this,{layer:{id:l.id}});this._layers[l.id]=l;this._serializedLayers[l.id]=l.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order));this.light=new A(this.stylesheet.light);this.fire(new e.Event("data",{dataType:"style"}));this.fire(new e.Event("style.load"))};r.prototype._loadSprite=function t(r){var a=this;this._spriteRequest=f(r,this.map._requestManager,(function(t,r){a._spriteRequest=null;if(t){a.fire(new e.ErrorEvent(t))}else if(r){for(var n in r){a.imageManager.addImage(n,r[n])}}a.imageManager.setLoaded(true);a._availableImages=a.imageManager.listImages();a.dispatcher.broadcast("setImages",a._availableImages);a.fire(new e.Event("data",{dataType:"style"}))}))};r.prototype._validateLayer=function t(r){var a=this.sourceCaches[r.source];if(!a){return}var n=r.sourceLayer;if(!n){return}var i=a.getSource();if(i.type==="geojson"||i.vectorLayerIds&&i.vectorLayerIds.indexOf(n)===-1){this.fire(new e.ErrorEvent(new Error('Source layer "'+n+'" '+'does not exist on source "'+i.id+'" '+'as specified by style layer "'+r.id+'"')))}};r.prototype.loaded=function e(){if(!this._loaded){return false}if(Object.keys(this._updatedSources).length){return false}for(var t in this.sourceCaches){if(!this.sourceCaches[t].loaded()){return false}}if(!this.imageManager.isLoaded()){return false}return true};r.prototype._serializeLayers=function e(t){var r=[];for(var a=0,n=t;a<n.length;a+=1){var i=n[a];var o=this._layers[i];if(o.type!=="custom"){r.push(o.serialize())}}return r};r.prototype.hasTransitions=function e(){if(this.light&&this.light.hasTransition()){return true}for(var t in this.sourceCaches){if(this.sourceCaches[t].hasTransition()){return true}}for(var r in this._layers){if(this._layers[r].hasTransition()){return true}}return false};r.prototype._checkLoaded=function e(){if(!this._loaded){throw new Error("Style is not done loading")}};r.prototype.update=function t(r){if(!this._loaded){return}var a=this._changed;if(this._changed){var n=Object.keys(this._updatedLayers);var i=Object.keys(this._removedLayers);if(n.length||i.length){this._updateWorkerLayers(n,i)}for(var o in this._updatedSources){var s=this._updatedSources[o];if(s==="reload"){this._reloadSource(o)}else if(s==="clear"){this._clearSource(o)}}this._updateTilesForChangedImages();for(var l in this._updatedPaintProps){this._layers[l].updateTransitions(r)}this.light.updateTransitions(r);this._resetUpdates()}for(var u in this.sourceCaches){this.sourceCaches[u].used=false}for(var c=0,f=this._order;c<f.length;c+=1){var h=f[c];var p=this._layers[h];p.recalculate(r,this._availableImages);if(!p.isHidden(r.zoom)&&p.source){this.sourceCaches[p.source].used=true}}this.light.recalculate(r);this.z=r.zoom;if(a){this.fire(new e.Event("data",{dataType:"style"}))}};r.prototype._updateTilesForChangedImages=function e(){var t=Object.keys(this._changedImages);if(t.length){for(var r in this.sourceCaches){this.sourceCaches[r].reloadTilesForDependencies(["icons","patterns"],t)}this._changedImages={}}};r.prototype._updateWorkerLayers=function e(t,r){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(t),removedIds:r})};r.prototype._resetUpdates=function e(){this._changed=false;this._updatedLayers={};this._removedLayers={};this._updatedSources={};this._updatedPaintProps={};this._changedImages={}};r.prototype.setState=function t(r){var a=this;this._checkLoaded();if(hr(this,e.validateStyle(r))){return false}r=e.clone$1(r);r.layers=lt(r.layers);var n=bt(this.serialize(),r).filter((function(e){return!(e.command in vr)}));if(n.length===0){return false}var i=n.filter((function(e){return!(e.command in pr)}));if(i.length>0){throw new Error("Unimplemented: "+i.map((function(e){return e.command})).join(", ")+".")}n.forEach((function(e){if(e.command==="setTransition"){return}a[e.command].apply(a,e.args)}));this.stylesheet=r;return true};r.prototype.addImage=function t(r,a){if(this.getImage(r)){return this.fire(new e.ErrorEvent(new Error("An image with this name already exists.")))}this.imageManager.addImage(r,a);this._availableImages=this.imageManager.listImages();this._changedImages[r]=true;this._changed=true;this.fire(new e.Event("data",{dataType:"style"}))};r.prototype.updateImage=function e(t,r){this.imageManager.updateImage(t,r)};r.prototype.getImage=function e(t){return this.imageManager.getImage(t)};r.prototype.removeImage=function t(r){if(!this.getImage(r)){return this.fire(new e.ErrorEvent(new Error("No image with this name exists.")))}this.imageManager.removeImage(r);this._availableImages=this.imageManager.listImages();this._changedImages[r]=true;this._changed=true;this.fire(new e.Event("data",{dataType:"style"}))};r.prototype.listImages=function e(){this._checkLoaded();return this.imageManager.listImages()};r.prototype.addSource=function t(r,a,n){var i=this;if(n===void 0)n={};this._checkLoaded();if(this.sourceCaches[r]!==undefined){throw new Error("There is already a source with this ID")}if(!a.type){throw new Error("The type property must be defined, but the only the following properties were given: "+Object.keys(a).join(", ")+".")}var o=["vector","raster","geojson","video","image"];var s=o.indexOf(a.type)>=0;if(s&&this._validate(e.validateStyle.source,"sources."+r,a,null,n)){return}if(this.map&&this.map._collectResourceTiming){a.collectResourceTiming=true}var l=this.sourceCaches[r]=new Je(r,a,this.dispatcher);l.style=this;l.setEventedParent(this,(function(){return{isSourceLoaded:i.loaded(),source:l.serialize(),sourceId:r}}));l.onAdd(this.map);this._changed=true};r.prototype.removeSource=function t(r){this._checkLoaded();if(this.sourceCaches[r]===undefined){throw new Error("There is no source with this ID")}for(var a in this._layers){if(this._layers[a].source===r){return this.fire(new e.ErrorEvent(new Error('Source "'+r+'" cannot be removed while layer "'+a+'" is using it.')))}}var n=this.sourceCaches[r];delete this.sourceCaches[r];delete this._updatedSources[r];n.fire(new e.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:r}));n.setEventedParent(null);n.clearTiles();if(n.onRemove){n.onRemove(this.map)}this._changed=true};r.prototype.setGeoJSONSourceData=function e(t,r){this._checkLoaded();var a=this.sourceCaches[t].getSource();a.setData(r);this._changed=true};r.prototype.getSource=function e(t){return this.sourceCaches[t]&&this.sourceCaches[t].getSource()};r.prototype.addLayer=function t(r,a,n){if(n===void 0)n={};this._checkLoaded();var i=r.id;if(this.getLayer(i)){this.fire(new e.ErrorEvent(new Error('Layer with id "'+i+'" already exists on this map')));return}var o;if(r.type==="custom"){if(hr(this,e.validateCustomStyleLayer(r))){return}o=e.createStyleLayer(r)}else{if(typeof r.source==="object"){this.addSource(i,r.source);r=e.clone$1(r);r=e.extend(r,{source:i})}if(this._validate(e.validateStyle.layer,"layers."+i,r,{arrayIndex:-1},n)){return}o=e.createStyleLayer(r);this._validateLayer(o);o.setEventedParent(this,{layer:{id:i}});this._serializedLayers[o.id]=o.serialize()}var s=a?this._order.indexOf(a):this._order.length;if(a&&s===-1){this.fire(new e.ErrorEvent(new Error('Layer with id "'+a+'" does not exist on this map.')));return}this._order.splice(s,0,i);this._layerOrderChanged=true;this._layers[i]=o;if(this._removedLayers[i]&&o.source&&o.type!=="custom"){var l=this._removedLayers[i];delete this._removedLayers[i];if(l.type!==o.type){this._updatedSources[o.source]="clear"}else{this._updatedSources[o.source]="reload";this.sourceCaches[o.source].pause()}}this._updateLayer(o);if(o.onAdd){o.onAdd(this.map)}};r.prototype.moveLayer=function t(r,a){this._checkLoaded();this._changed=true;var n=this._layers[r];if(!n){this.fire(new e.ErrorEvent(new Error("The layer '"+r+"' does not exist in the map's style and cannot be moved.")));return}if(r===a){return}var i=this._order.indexOf(r);this._order.splice(i,1);var o=a?this._order.indexOf(a):this._order.length;if(a&&o===-1){this.fire(new e.ErrorEvent(new Error('Layer with id "'+a+'" does not exist on this map.')));return}this._order.splice(o,0,r);this._layerOrderChanged=true};r.prototype.removeLayer=function t(r){this._checkLoaded();var a=this._layers[r];if(!a){this.fire(new e.ErrorEvent(new Error("The layer '"+r+"' does not exist in the map's style and cannot be removed.")));return}a.setEventedParent(null);var n=this._order.indexOf(r);this._order.splice(n,1);this._layerOrderChanged=true;this._changed=true;this._removedLayers[r]=a;delete this._layers[r];delete this._serializedLayers[r];delete this._updatedLayers[r];delete this._updatedPaintProps[r];if(a.onRemove){a.onRemove(this.map)}};r.prototype.getLayer=function e(t){return this._layers[t]};r.prototype.hasLayer=function e(t){return t in this._layers};r.prototype.setLayerZoomRange=function t(r,a,n){this._checkLoaded();var i=this.getLayer(r);if(!i){this.fire(new e.ErrorEvent(new Error("The layer '"+r+"' does not exist in the map's style and cannot have zoom extent.")));return}if(i.minzoom===a&&i.maxzoom===n){return}if(a!=null){i.minzoom=a}if(n!=null){i.maxzoom=n}this._updateLayer(i)};r.prototype.setFilter=function t(r,a,n){if(n===void 0)n={};this._checkLoaded();var i=this.getLayer(r);if(!i){this.fire(new e.ErrorEvent(new Error("The layer '"+r+"' does not exist in the map's style and cannot be filtered.")));return}if(e.deepEqual(i.filter,a)){return}if(a===null||a===undefined){i.filter=undefined;this._updateLayer(i);return}if(this._validate(e.validateStyle.filter,"layers."+i.id+".filter",a,null,n)){return}i.filter=e.clone$1(a);this._updateLayer(i)};r.prototype.getFilter=function t(r){return e.clone$1(this.getLayer(r).filter)};r.prototype.setLayoutProperty=function t(r,a,n,i){if(i===void 0)i={};this._checkLoaded();var o=this.getLayer(r);if(!o){this.fire(new e.ErrorEvent(new Error("The layer '"+r+"' does not exist in the map's style and cannot be styled.")));return}if(e.deepEqual(o.getLayoutProperty(a),n)){return}o.setLayoutProperty(a,n,i);this._updateLayer(o)};r.prototype.getLayoutProperty=function t(r,a){var n=this.getLayer(r);if(!n){this.fire(new e.ErrorEvent(new Error("The layer '"+r+"' does not exist in the map's style.")));return}return n.getLayoutProperty(a)};r.prototype.setPaintProperty=function t(r,a,n,i){if(i===void 0)i={};this._checkLoaded();var o=this.getLayer(r);if(!o){this.fire(new e.ErrorEvent(new Error("The layer '"+r+"' does not exist in the map's style and cannot be styled.")));return}if(e.deepEqual(o.getPaintProperty(a),n)){return}var s=o.setPaintProperty(a,n,i);if(s){this._updateLayer(o)}this._changed=true;this._updatedPaintProps[r]=true};r.prototype.getPaintProperty=function e(t,r){return this.getLayer(t).getPaintProperty(r)};r.prototype.setFeatureState=function t(r,a){this._checkLoaded();var n=r.source;var i=r.sourceLayer;var o=this.sourceCaches[n];if(o===undefined){this.fire(new e.ErrorEvent(new Error("The source '"+n+"' does not exist in the map's style.")));return}var s=o.getSource().type;if(s==="geojson"&&i){this.fire(new e.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));return}if(s==="vector"&&!i){this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));return}if(r.id===undefined){this.fire(new e.ErrorEvent(new Error("The feature id parameter must be provided.")))}o.setFeatureState(i,r.id,a)};r.prototype.removeFeatureState=function t(r,a){this._checkLoaded();var n=r.source;var i=this.sourceCaches[n];if(i===undefined){this.fire(new e.ErrorEvent(new Error("The source '"+n+"' does not exist in the map's style.")));return}var o=i.getSource().type;var s=o==="vector"?r.sourceLayer:undefined;if(o==="vector"&&!s){this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));return}if(a&&(typeof r.id!=="string"&&typeof r.id!=="number")){this.fire(new e.ErrorEvent(new Error("A feature id is requred to remove its specific state property.")));return}i.removeFeatureState(s,r.id,a)};r.prototype.getFeatureState=function t(r){this._checkLoaded();var a=r.source;var n=r.sourceLayer;var i=this.sourceCaches[a];if(i===undefined){this.fire(new e.ErrorEvent(new Error("The source '"+a+"' does not exist in the map's style.")));return}var o=i.getSource().type;if(o==="vector"&&!n){this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));return}if(r.id===undefined){this.fire(new e.ErrorEvent(new Error("The feature id parameter must be provided.")))}return i.getFeatureState(n,r.id)};r.prototype.getTransition=function t(){return e.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)};r.prototype.serialize=function t(){return e.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:e.mapObject(this.sourceCaches,(function(e){return e.serialize()})),layers:this._serializeLayers(this._order)},(function(e){return e!==undefined}))};r.prototype._updateLayer=function e(t){this._updatedLayers[t.id]=true;if(t.source&&!this._updatedSources[t.source]&&this.sourceCaches[t.source].getSource().type!=="raster"){this._updatedSources[t.source]="reload";this.sourceCaches[t.source].pause()}this._changed=true};r.prototype._flattenAndSortRenderedFeatures=function e(t){var r=this;var a=function(e){return r._layers[e].type==="fill-extrusion"};var n={};var i=[];for(var o=this._order.length-1;o>=0;o--){var s=this._order[o];if(a(s)){n[s]=o;for(var l=0,u=t;l<u.length;l+=1){var c=u[l];var f=c[s];if(f){for(var h=0,p=f;h<p.length;h+=1){var v=p[h];i.push(v)}}}}}i.sort((function(e,t){return t.intersectionZ-e.intersectionZ}));var d=[];for(var m=this._order.length-1;m>=0;m--){var g=this._order[m];if(a(g)){for(var y=i.length-1;y>=0;y--){var x=i[y].feature;if(n[x.layer.id]<m){break}d.push(x);i.pop()}}else{for(var b=0,_=t;b<_.length;b+=1){var w=_[b];var T=w[g];if(T){for(var k=0,M=T;k<M.length;k+=1){var A=M[k];d.push(A.feature)}}}}}return d};r.prototype.queryRenderedFeatures=function t(r,a,n){if(a&&a.filter){this._validate(e.validateStyle.filter,"queryRenderedFeatures.filter",a.filter,null,a)}var i={};if(a&&a.layers){if(!Array.isArray(a.layers)){this.fire(new e.ErrorEvent(new Error("parameters.layers must be an Array.")));return[]}for(var o=0,s=a.layers;o<s.length;o+=1){var l=s[o];var u=this._layers[l];if(!u){this.fire(new e.ErrorEvent(new Error("The layer '"+l+"' does not exist in the map's style and cannot be queried for features.")));return[]}i[u.source]=true}}var c=[];a.availableImages=this._availableImages;for(var f in this.sourceCaches){if(a.layers&&!i[f]){continue}c.push(Y(this.sourceCaches[f],this._layers,this._serializedLayers,r,a,n))}if(this.placement){c.push(W(this._layers,this._serializedLayers,this.sourceCaches,r,a,this.placement.collisionIndex,this.placement.retainedQueryData))}return this._flattenAndSortRenderedFeatures(c)};r.prototype.querySourceFeatures=function t(r,a){if(a&&a.filter){this._validate(e.validateStyle.filter,"querySourceFeatures.filter",a.filter,null,a)}var n=this.sourceCaches[r];return n?X(n,a):[]};r.prototype.addSourceType=function e(t,a,n){if(r.getSourceType(t)){return n(new Error('A source type called "'+t+'" already exists.'))}r.setSourceType(t,a);if(!a.workerSourceURL){return n(null,null)}this.dispatcher.broadcast("loadWorkerSource",{name:t,url:a.workerSourceURL},n)};r.prototype.getLight=function e(){return this.light.getLight()};r.prototype.setLight=function t(r,a){if(a===void 0)a={};this._checkLoaded();var n=this.light.getLight();var i=false;for(var o in r){if(!e.deepEqual(r[o],n[o])){i=true;break}}if(!i){return}var s={now:e.browser.now(),transition:e.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(r,a);this.light.updateTransitions(s)};r.prototype._validate=function t(r,a,n,i,o){if(o===void 0)o={};if(o&&o.validate===false){return false}return hr(this,r.call(e.validateStyle,e.extend({key:a,style:this.serialize(),value:n,styleSpec:e.styleSpec},i)))};r.prototype._remove=function t(){if(this._request){this._request.cancel();this._request=null}if(this._spriteRequest){this._spriteRequest.cancel();this._spriteRequest=null}e.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(var r in this._layers){var a=this._layers[r];a.setEventedParent(null)}for(var n in this.sourceCaches){this.sourceCaches[n].clearTiles();this.sourceCaches[n].setEventedParent(null)}this.imageManager.setEventedParent(null);this.setEventedParent(null);this.dispatcher.remove()};r.prototype._clearSource=function e(t){this.sourceCaches[t].clearTiles()};r.prototype._reloadSource=function e(t){this.sourceCaches[t].resume();this.sourceCaches[t].reload()};r.prototype._updateSources=function e(t){for(var r in this.sourceCaches){this.sourceCaches[r].update(t)}};r.prototype._generateCollisionBoxes=function e(){for(var t in this.sourceCaches){this._reloadSource(t)}};r.prototype._updatePlacement=function t(r,a,n,i,o){if(o===void 0)o=false;var s=false;var l=false;var u={};for(var c=0,f=this._order;c<f.length;c+=1){var h=f[c];var p=this._layers[h];if(p.type!=="symbol"){continue}if(!u[p.source]){var v=this.sourceCaches[p.source];u[p.source]=v.getRenderableIds(true).map((function(e){return v.getTileByID(e)})).sort((function(e,t){return t.tileID.overscaledZ-e.tileID.overscaledZ||(e.tileID.isLessThan(t.tileID)?-1:1)}))}var d=this.crossTileSymbolIndex.addLayer(p,u[p.source],r.center.lng);s=s||d}this.crossTileSymbolIndex.pruneUnusedLayers(this._order);o=o||this._layerOrderChanged||n===0;if(o||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(e.browser.now(),r.zoom)){this.pauseablePlacement=new or(r,this._order,o,a,n,i,this.placement);this._layerOrderChanged=false}if(this.pauseablePlacement.isDone()){this.placement.setStale()}else{this.pauseablePlacement.continuePlacement(this._order,this._layers,u);if(this.pauseablePlacement.isDone()){this.placement=this.pauseablePlacement.commit(e.browser.now());l=true}if(s){this.pauseablePlacement.placement.setStale()}}if(l||s){for(var m=0,g=this._order;m<g.length;m+=1){var y=g[m];var x=this._layers[y];if(x.type!=="symbol"){continue}this.placement.updateLayerOpacities(x,u[x.source])}}var b=!this.pauseablePlacement.isDone()||this.placement.hasTransitions(e.browser.now());return b};r.prototype._releaseSymbolFadeTiles=function e(){for(var t in this.sourceCaches){this.sourceCaches[t].releaseSymbolFadeTiles()}};r.prototype.getImages=function e(t,r,a){this.imageManager.getImages(r.icons,a);this._updateTilesForChangedImages();var n=this.sourceCaches[r.source];if(n){n.setDependencies(r.tileID.key,r.type,r.icons)}};r.prototype.getGlyphs=function e(t,r,a){this.glyphManager.getGlyphs(r.stacks,a)};r.prototype.getResource=function t(r,a,n){return e.makeRequest(a,n)};return r}(e.Evented);mr.getSourceType=V;mr.setSourceType=H;mr.registerForPluginStateChange=e.registerForPluginStateChange;var gr=e.createLayout([{name:"a_pos",type:"Int16",components:2}]);var yr="#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif";var xr="#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}";var br="uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}";var _r="attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}";var wr="uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}";var Tr="uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}";var kr="varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}";var Mr="uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}";var Ar="void main() {gl_FragColor=vec4(1.0);}";var Sr="attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}";var Er="uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}";var Lr="uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}";var Cr="uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}";var Ir="uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}";var Pr="varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}";var Or="attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}";var zr="varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}";var Dr="attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}";var Rr="uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}";var Fr="attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}";var Br="#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_FragColor=color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}";var Nr="attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);}";var jr="varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}";var Ur="attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}";var Vr="uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}";var Hr="uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}";var qr="uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}";var Gr="uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}";var Yr="varying vec4 v_color;void main() {gl_FragColor=v_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}";var Wr="uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}";var Xr="uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}";var Zr="uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0\n? a_pos\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}";var Jr="#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform float u_maxzoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggeration=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/ pow(2.0,(u_zoom-u_maxzoom)*exaggeration+19.2562-u_zoom);gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}";var Kr="uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}";var Qr="uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;\n#define PI 3.141592653589793\nvoid main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}";var $r="uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}";var ea="uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}";var ta="\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}";var ra="uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp float v_lineprogress;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,vec2(v_lineprogress,0.5));gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}";var aa="\n#define MAX_LINE_DISTANCE 32767.0\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_lineprogress;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_lineprogress=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0/MAX_LINE_DISTANCE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}";var na="uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}";var ia="\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}";var oa="uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}";var sa="\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}";var la="uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}";var ua="uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}";var ca="uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}";var fa="const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}";var ha="#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}";var pa="const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}";var va="#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}";var da="const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}";var ma=Va(yr,xr);var ga=Va(br,_r);var ya=Va(wr,Tr);var xa=Va(kr,Mr);var ba=Va(Ar,Sr);var _a=Va(Er,Lr);var wa=Va(Cr,Ir);var Ta=Va(Pr,Or);var ka=Va(zr,Dr);var Ma=Va(Rr,Fr);var Aa=Va(Br,Nr);var Sa=Va(jr,Ur);var Ea=Va(Vr,Hr);var La=Va(qr,Gr);var Ca=Va(Yr,Wr);var Ia=Va(Xr,Zr);var Pa=Va(Jr,Kr);var Oa=Va(Qr,$r);var za=Va(ea,ta);var Da=Va(ra,aa);var Ra=Va(na,ia);var Fa=Va(oa,sa);var Ba=Va(la,ua);var Na=Va(ca,fa);var ja=Va(ha,pa);var Ua=Va(va,da);function Va(e,t){var r=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g;var a={};e=e.replace(r,(function(e,t,r,n,i){a[i]=true;if(t==="define"){return"\n#ifndef HAS_UNIFORM_u_"+i+"\nvarying "+r+" "+n+" "+i+";\n#else\nuniform "+r+" "+n+" u_"+i+";\n#endif\n"}else{return"\n#ifdef HAS_UNIFORM_u_"+i+"\n    "+r+" "+n+" "+i+" = u_"+i+";\n#endif\n"}}));t=t.replace(r,(function(e,t,r,n,i){var o=n==="float"?"vec2":"vec4";var s=i.match(/color/)?"color":o;if(a[i]){if(t==="define"){return"\n#ifndef HAS_UNIFORM_u_"+i+"\nuniform lowp float u_"+i+"_t;\nattribute "+r+" "+o+" a_"+i+";\nvarying "+r+" "+n+" "+i+";\n#else\nuniform "+r+" "+n+" u_"+i+";\n#endif\n"}else{if(s==="vec4"){return"\n#ifndef HAS_UNIFORM_u_"+i+"\n    "+i+" = a_"+i+";\n#else\n    "+r+" "+n+" "+i+" = u_"+i+";\n#endif\n"}else{return"\n#ifndef HAS_UNIFORM_u_"+i+"\n    "+i+" = unpack_mix_"+s+"(a_"+i+", u_"+i+"_t);\n#else\n    "+r+" "+n+" "+i+" = u_"+i+";\n#endif\n"}}}else{if(t==="define"){return"\n#ifndef HAS_UNIFORM_u_"+i+"\nuniform lowp float u_"+i+"_t;\nattribute "+r+" "+o+" a_"+i+";\n#else\nuniform "+r+" "+n+" u_"+i+";\n#endif\n"}else{if(s==="vec4"){return"\n#ifndef HAS_UNIFORM_u_"+i+"\n    "+r+" "+n+" "+i+" = a_"+i+";\n#else\n    "+r+" "+n+" "+i+" = u_"+i+";\n#endif\n"}else{return"\n#ifndef HAS_UNIFORM_u_"+i+"\n    "+r+" "+n+" "+i+" = unpack_mix_"+s+"(a_"+i+", u_"+i+"_t);\n#else\n    "+r+" "+n+" "+i+" = u_"+i+";\n#endif\n"}}}}));return{fragmentSource:e,vertexSource:t}}var Ha=Object.freeze({__proto__:null,prelude:ma,background:ga,backgroundPattern:ya,circle:xa,clippingMask:ba,heatmap:_a,heatmapTexture:wa,collisionBox:Ta,collisionCircle:ka,debug:Ma,fill:Aa,fillOutline:Sa,fillOutlinePattern:Ea,fillPattern:La,fillExtrusion:Ca,fillExtrusionPattern:Ia,hillshadePrepare:Pa,hillshade:Oa,line:za,lineGradient:Da,linePattern:Ra,lineSDF:Fa,raster:Ba,symbolIcon:Na,symbolSDF:ja,symbolTextAndIcon:Ua});var qa=function e(){this.boundProgram=null;this.boundLayoutVertexBuffer=null;this.boundPaintVertexBuffers=[];this.boundIndexBuffer=null;this.boundVertexOffset=null;this.boundDynamicVertexBuffer=null;this.vao=null};qa.prototype.bind=function e(t,r,a,n,i,o,s,l){this.context=t;var u=this.boundPaintVertexBuffers.length!==n.length;for(var c=0;!u&&c<n.length;c++){if(this.boundPaintVertexBuffers[c]!==n[c]){u=true}}var f=!this.vao||this.boundProgram!==r||this.boundLayoutVertexBuffer!==a||u||this.boundIndexBuffer!==i||this.boundVertexOffset!==o||this.boundDynamicVertexBuffer!==s||this.boundDynamicVertexBuffer2!==l;if(!t.extVertexArrayObject||f){this.freshBind(r,a,n,i,o,s,l)}else{t.bindVertexArrayOES.set(this.vao);if(s){s.bind()}if(i&&i.dynamicDraw){i.bind()}if(l){l.bind()}}};qa.prototype.freshBind=function e(t,r,a,n,i,o,s){var l;var u=t.numAttributes;var c=this.context;var f=c.gl;if(c.extVertexArrayObject){if(this.vao){this.destroy()}this.vao=c.extVertexArrayObject.createVertexArrayOES();c.bindVertexArrayOES.set(this.vao);l=0;this.boundProgram=t;this.boundLayoutVertexBuffer=r;this.boundPaintVertexBuffers=a;this.boundIndexBuffer=n;this.boundVertexOffset=i;this.boundDynamicVertexBuffer=o;this.boundDynamicVertexBuffer2=s}else{l=c.currentNumAttributes||0;for(var h=u;h<l;h++){f.disableVertexAttribArray(h)}}r.enableAttributes(f,t);for(var p=0,v=a;p<v.length;p+=1){var d=v[p];d.enableAttributes(f,t)}if(o){o.enableAttributes(f,t)}if(s){s.enableAttributes(f,t)}r.bind();r.setVertexAttribPointers(f,t,i);for(var m=0,g=a;m<g.length;m+=1){var y=g[m];y.bind();y.setVertexAttribPointers(f,t,i)}if(o){o.bind();o.setVertexAttribPointers(f,t,i)}if(n){n.bind()}if(s){s.bind();s.setVertexAttribPointers(f,t,i)}c.currentNumAttributes=u};qa.prototype.destroy=function e(){if(this.vao){this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao);this.vao=null}};var Ga=function e(t,r,a,n,i){var o=t.gl;this.program=o.createProgram();var s=a?a.defines():[];if(i){s.push("#define OVERDRAW_INSPECTOR;")}var l=s.concat(ma.fragmentSource,r.fragmentSource).join("\n");var u=s.concat(ma.vertexSource,r.vertexSource).join("\n");var c=o.createShader(o.FRAGMENT_SHADER);if(o.isContextLost()){this.failedToCreate=true;return}o.shaderSource(c,l);o.compileShader(c);o.attachShader(this.program,c);var f=o.createShader(o.VERTEX_SHADER);if(o.isContextLost()){this.failedToCreate=true;return}o.shaderSource(f,u);o.compileShader(f);o.attachShader(this.program,f);var h=a?a.layoutAttributes:[];for(var p=0;p<h.length;p++){o.bindAttribLocation(this.program,p,h[p].name)}o.linkProgram(this.program);o.deleteShader(f);o.deleteShader(c);this.numAttributes=o.getProgramParameter(this.program,o.ACTIVE_ATTRIBUTES);this.attributes={};var v={};for(var d=0;d<this.numAttributes;d++){var m=o.getActiveAttrib(this.program,d);if(m){this.attributes[m.name]=o.getAttribLocation(this.program,m.name)}}var g=o.getProgramParameter(this.program,o.ACTIVE_UNIFORMS);for(var y=0;y<g;y++){var x=o.getActiveUniform(this.program,y);if(x){v[x.name]=o.getUniformLocation(this.program,x.name)}}this.fixedUniforms=n(t,v);this.binderUniforms=a?a.getUniforms(t,v):[]};Ga.prototype.draw=function e(t,r,a,n,i,o,s,l,u,c,f,h,p,v,d,m){var g;var y=t.gl;if(this.failedToCreate){return}t.program.set(this.program);t.setDepthMode(a);t.setStencilMode(n);t.setColorMode(i);t.setCullFace(o);for(var x in this.fixedUniforms){this.fixedUniforms[x].set(s[x])}if(v){v.setUniforms(t,this.binderUniforms,h,{zoom:p})}var b=(g={},g[y.LINES]=2,g[y.TRIANGLES]=3,g[y.LINE_STRIP]=1,g)[r];for(var _=0,w=f.get();_<w.length;_+=1){var T=w[_];var k=T.vaos||(T.vaos={});var M=k[l]||(k[l]=new qa);M.bind(t,this,u,v?v.getPaintVertexBuffers():[],c,T.vertexOffset,d,m);y.drawElements(r,T.primitiveLength*b,y.UNSIGNED_SHORT,T.primitiveOffset*b*2)}};function Ya(e,t,r){var a=1/Nt(r,1,t.transform.tileZoom);var n=Math.pow(2,r.tileID.overscaledZ);var i=r.tileSize*Math.pow(2,t.transform.tileZoom)/n;var o=i*(r.tileID.canonical.x+r.tileID.wrap*n);var s=i*r.tileID.canonical.y;return{u_image:0,u_texsize:r.imageAtlasTexture.size,u_scale:[a,e.fromScale,e.toScale],u_fade:e.t,u_pixel_coord_upper:[o>>16,s>>16],u_pixel_coord_lower:[o&65535,s&65535]}}function Wa(e,t,r,a){var n=r.imageManager.getPattern(e.from.toString());var i=r.imageManager.getPattern(e.to.toString());var o=r.imageManager.getPixelSize();var s=o.width;var l=o.height;var u=Math.pow(2,a.tileID.overscaledZ);var c=a.tileSize*Math.pow(2,r.transform.tileZoom)/u;var f=c*(a.tileID.canonical.x+a.tileID.wrap*u);var h=c*a.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:n.tl,u_pattern_br_a:n.br,u_pattern_tl_b:i.tl,u_pattern_br_b:i.br,u_texsize:[s,l],u_mix:t.t,u_pattern_size_a:n.displaySize,u_pattern_size_b:i.displaySize,u_scale_a:t.fromScale,u_scale_b:t.toScale,u_tile_units_to_pixels:1/Nt(a,1,r.transform.tileZoom),u_pixel_coord_upper:[f>>16,h>>16],u_pixel_coord_lower:[f&65535,h&65535]}}var Xa=function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_lightpos:new e.Uniform3f(t,r.u_lightpos),u_lightintensity:new e.Uniform1f(t,r.u_lightintensity),u_lightcolor:new e.Uniform3f(t,r.u_lightcolor),u_vertical_gradient:new e.Uniform1f(t,r.u_vertical_gradient),u_opacity:new e.Uniform1f(t,r.u_opacity)}};var Za=function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_lightpos:new e.Uniform3f(t,r.u_lightpos),u_lightintensity:new e.Uniform1f(t,r.u_lightintensity),u_lightcolor:new e.Uniform3f(t,r.u_lightcolor),u_vertical_gradient:new e.Uniform1f(t,r.u_vertical_gradient),u_height_factor:new e.Uniform1f(t,r.u_height_factor),u_image:new e.Uniform1i(t,r.u_image),u_texsize:new e.Uniform2f(t,r.u_texsize),u_pixel_coord_upper:new e.Uniform2f(t,r.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(t,r.u_pixel_coord_lower),u_scale:new e.Uniform3f(t,r.u_scale),u_fade:new e.Uniform1f(t,r.u_fade),u_opacity:new e.Uniform1f(t,r.u_opacity)}};var Ja=function(t,r,a,n){var i=r.style.light;var o=i.properties.get("position");var s=[o.x,o.y,o.z];var l=e.create$1();if(i.properties.get("anchor")==="viewport"){e.fromRotation(l,-r.transform.angle)}e.transformMat3(s,s,l);var u=i.properties.get("color");return{u_matrix:t,u_lightpos:s,u_lightintensity:i.properties.get("intensity"),u_lightcolor:[u.r,u.g,u.b],u_vertical_gradient:+a,u_opacity:n}};var Ka=function(t,r,a,n,i,o,s){return e.extend(Ja(t,r,a,n),Ya(o,r,s),{u_height_factor:-Math.pow(2,i.overscaledZ)/s.tileSize/8})};var Qa=function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix)}};var $a=function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_image:new e.Uniform1i(t,r.u_image),u_texsize:new e.Uniform2f(t,r.u_texsize),u_pixel_coord_upper:new e.Uniform2f(t,r.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(t,r.u_pixel_coord_lower),u_scale:new e.Uniform3f(t,r.u_scale),u_fade:new e.Uniform1f(t,r.u_fade)}};var en=function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_world:new e.Uniform2f(t,r.u_world)}};var tn=function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_world:new e.Uniform2f(t,r.u_world),u_image:new e.Uniform1i(t,r.u_image),u_texsize:new e.Uniform2f(t,r.u_texsize),u_pixel_coord_upper:new e.Uniform2f(t,r.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(t,r.u_pixel_coord_lower),u_scale:new e.Uniform3f(t,r.u_scale),u_fade:new e.Uniform1f(t,r.u_fade)}};var rn=function(e){return{u_matrix:e}};var an=function(t,r,a,n){return e.extend(rn(t),Ya(a,r,n))};var nn=function(e,t){return{u_matrix:e,u_world:t}};var on=function(t,r,a,n,i){return e.extend(an(t,r,a,n),{u_world:i})};var sn=function(t,r){return{u_camera_to_center_distance:new e.Uniform1f(t,r.u_camera_to_center_distance),u_scale_with_map:new e.Uniform1i(t,r.u_scale_with_map),u_pitch_with_map:new e.Uniform1i(t,r.u_pitch_with_map),u_extrude_scale:new e.Uniform2f(t,r.u_extrude_scale),u_device_pixel_ratio:new e.Uniform1f(t,r.u_device_pixel_ratio),u_matrix:new e.UniformMatrix4f(t,r.u_matrix)}};var ln=function(t,r,a,n){var i=t.transform;var o,s;if(n.paint.get("circle-pitch-alignment")==="map"){var l=Nt(a,1,i.zoom);o=true;s=[l,l]}else{o=false;s=i.pixelsToGLUnits}return{u_camera_to_center_distance:i.cameraToCenterDistance,u_scale_with_map:+(n.paint.get("circle-pitch-scale")==="map"),u_matrix:t.translatePosMatrix(r.posMatrix,a,n.paint.get("circle-translate"),n.paint.get("circle-translate-anchor")),u_pitch_with_map:+o,u_device_pixel_ratio:e.browser.devicePixelRatio,u_extrude_scale:s}};var un=function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_camera_to_center_distance:new e.Uniform1f(t,r.u_camera_to_center_distance),u_pixels_to_tile_units:new e.Uniform1f(t,r.u_pixels_to_tile_units),u_extrude_scale:new e.Uniform2f(t,r.u_extrude_scale),u_overscale_factor:new e.Uniform1f(t,r.u_overscale_factor)}};var cn=function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_inv_matrix:new e.UniformMatrix4f(t,r.u_inv_matrix),u_camera_to_center_distance:new e.Uniform1f(t,r.u_camera_to_center_distance),u_viewport_size:new e.Uniform2f(t,r.u_viewport_size)}};var fn=function(e,t,r){var a=Nt(r,1,t.zoom);var n=Math.pow(2,t.zoom-r.tileID.overscaledZ);var i=r.tileID.overscaleFactor();return{u_matrix:e,u_camera_to_center_distance:t.cameraToCenterDistance,u_pixels_to_tile_units:a,u_extrude_scale:[t.pixelsToGLUnits[0]/(a*n),t.pixelsToGLUnits[1]/(a*n)],u_overscale_factor:i}};var hn=function(e,t,r){return{u_matrix:e,u_inv_matrix:t,u_camera_to_center_distance:r.cameraToCenterDistance,u_viewport_size:[r.width,r.height]}};var pn=function(t,r){return{u_color:new e.UniformColor(t,r.u_color),u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_overlay:new e.Uniform1i(t,r.u_overlay),u_overlay_scale:new e.Uniform1f(t,r.u_overlay_scale)}};var vn=function(e,t,r){if(r===void 0)r=1;return{u_matrix:e,u_color:t,u_overlay:0,u_overlay_scale:r}};var dn=function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix)}};var mn=function(e){return{u_matrix:e}};var gn=function(t,r){return{u_extrude_scale:new e.Uniform1f(t,r.u_extrude_scale),u_intensity:new e.Uniform1f(t,r.u_intensity),u_matrix:new e.UniformMatrix4f(t,r.u_matrix)}};var yn=function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_world:new e.Uniform2f(t,r.u_world),u_image:new e.Uniform1i(t,r.u_image),u_color_ramp:new e.Uniform1i(t,r.u_color_ramp),u_opacity:new e.Uniform1f(t,r.u_opacity)}};var xn=function(e,t,r,a){return{u_matrix:e,u_extrude_scale:Nt(t,1,r),u_intensity:a}};var bn=function(t,r,a,n){var i=e.create();e.ortho(i,0,t.width,t.height,0,0,1);var o=t.context.gl;return{u_matrix:i,u_world:[o.drawingBufferWidth,o.drawingBufferHeight],u_image:a,u_color_ramp:n,u_opacity:r.paint.get("heatmap-opacity")}};var _n=function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_image:new e.Uniform1i(t,r.u_image),u_latrange:new e.Uniform2f(t,r.u_latrange),u_light:new e.Uniform2f(t,r.u_light),u_shadow:new e.UniformColor(t,r.u_shadow),u_highlight:new e.UniformColor(t,r.u_highlight),u_accent:new e.UniformColor(t,r.u_accent)}};var wn=function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_image:new e.Uniform1i(t,r.u_image),u_dimension:new e.Uniform2f(t,r.u_dimension),u_zoom:new e.Uniform1f(t,r.u_zoom),u_maxzoom:new e.Uniform1f(t,r.u_maxzoom),u_unpack:new e.Uniform4f(t,r.u_unpack)}};var Tn=function(e,t,r){var a=r.paint.get("hillshade-shadow-color");var n=r.paint.get("hillshade-highlight-color");var i=r.paint.get("hillshade-accent-color");var o=r.paint.get("hillshade-illumination-direction")*(Math.PI/180);if(r.paint.get("hillshade-illumination-anchor")==="viewport"){o-=e.transform.angle}var s=!e.options.moving;return{u_matrix:e.transform.calculatePosMatrix(t.tileID.toUnwrapped(),s),u_image:0,u_latrange:Mn(e,t.tileID),u_light:[r.paint.get("hillshade-exaggeration"),o],u_shadow:a,u_highlight:n,u_accent:i}};var kn=function(t,r,a){var n=r.stride;var i=e.create();e.ortho(i,0,e.EXTENT,-e.EXTENT,0,0,1);e.translate(i,i,[0,-e.EXTENT,0]);return{u_matrix:i,u_image:1,u_dimension:[n,n],u_zoom:t.overscaledZ,u_maxzoom:a,u_unpack:r.getUnpackVector()}};function Mn(t,r){var a=Math.pow(2,r.canonical.z);var n=r.canonical.y;return[new e.MercatorCoordinate(0,n/a).toLngLat().lat,new e.MercatorCoordinate(0,(n+1)/a).toLngLat().lat]}var An=function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_ratio:new e.Uniform1f(t,r.u_ratio),u_device_pixel_ratio:new e.Uniform1f(t,r.u_device_pixel_ratio),u_units_to_pixels:new e.Uniform2f(t,r.u_units_to_pixels)}};var Sn=function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_ratio:new e.Uniform1f(t,r.u_ratio),u_device_pixel_ratio:new e.Uniform1f(t,r.u_device_pixel_ratio),u_units_to_pixels:new e.Uniform2f(t,r.u_units_to_pixels),u_image:new e.Uniform1i(t,r.u_image)}};var En=function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_texsize:new e.Uniform2f(t,r.u_texsize),u_ratio:new e.Uniform1f(t,r.u_ratio),u_device_pixel_ratio:new e.Uniform1f(t,r.u_device_pixel_ratio),u_image:new e.Uniform1i(t,r.u_image),u_units_to_pixels:new e.Uniform2f(t,r.u_units_to_pixels),u_scale:new e.Uniform3f(t,r.u_scale),u_fade:new e.Uniform1f(t,r.u_fade)}};var Ln=function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_ratio:new e.Uniform1f(t,r.u_ratio),u_device_pixel_ratio:new e.Uniform1f(t,r.u_device_pixel_ratio),u_units_to_pixels:new e.Uniform2f(t,r.u_units_to_pixels),u_patternscale_a:new e.Uniform2f(t,r.u_patternscale_a),u_patternscale_b:new e.Uniform2f(t,r.u_patternscale_b),u_sdfgamma:new e.Uniform1f(t,r.u_sdfgamma),u_image:new e.Uniform1i(t,r.u_image),u_tex_y_a:new e.Uniform1f(t,r.u_tex_y_a),u_tex_y_b:new e.Uniform1f(t,r.u_tex_y_b),u_mix:new e.Uniform1f(t,r.u_mix)}};var Cn=function(t,r,a){var n=t.transform;return{u_matrix:Dn(t,r,a),u_ratio:1/Nt(r,1,n.zoom),u_device_pixel_ratio:e.browser.devicePixelRatio,u_units_to_pixels:[1/n.pixelsToGLUnits[0],1/n.pixelsToGLUnits[1]]}};var In=function(t,r,a){return e.extend(Cn(t,r,a),{u_image:0})};var Pn=function(t,r,a,n){var i=t.transform;var o=zn(r,i);return{u_matrix:Dn(t,r,a),u_texsize:r.imageAtlasTexture.size,u_ratio:1/Nt(r,1,i.zoom),u_device_pixel_ratio:e.browser.devicePixelRatio,u_image:0,u_scale:[o,n.fromScale,n.toScale],u_fade:n.t,u_units_to_pixels:[1/i.pixelsToGLUnits[0],1/i.pixelsToGLUnits[1]]}};var On=function(t,r,a,n,i){var o=t.transform;var s=t.lineAtlas;var l=zn(r,o);var u=a.layout.get("line-cap")==="round";var c=s.getDash(n.from,u);var f=s.getDash(n.to,u);var h=c.width*i.fromScale;var p=f.width*i.toScale;return e.extend(Cn(t,r,a),{u_patternscale_a:[l/h,-c.height/2],u_patternscale_b:[l/p,-f.height/2],u_sdfgamma:s.width/(Math.min(h,p)*256*e.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:c.y,u_tex_y_b:f.y,u_mix:i.t})};function zn(e,t){return 1/Nt(e,1,t.tileZoom)}function Dn(e,t,r){return e.translatePosMatrix(t.tileID.posMatrix,t,r.paint.get("line-translate"),r.paint.get("line-translate-anchor"))}var Rn=function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_tl_parent:new e.Uniform2f(t,r.u_tl_parent),u_scale_parent:new e.Uniform1f(t,r.u_scale_parent),u_buffer_scale:new e.Uniform1f(t,r.u_buffer_scale),u_fade_t:new e.Uniform1f(t,r.u_fade_t),u_opacity:new e.Uniform1f(t,r.u_opacity),u_image0:new e.Uniform1i(t,r.u_image0),u_image1:new e.Uniform1i(t,r.u_image1),u_brightness_low:new e.Uniform1f(t,r.u_brightness_low),u_brightness_high:new e.Uniform1f(t,r.u_brightness_high),u_saturation_factor:new e.Uniform1f(t,r.u_saturation_factor),u_contrast_factor:new e.Uniform1f(t,r.u_contrast_factor),u_spin_weights:new e.Uniform3f(t,r.u_spin_weights)}};var Fn=function(e,t,r,a,n){return{u_matrix:e,u_tl_parent:t,u_scale_parent:r,u_buffer_scale:1,u_fade_t:a.mix,u_opacity:a.opacity*n.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:n.paint.get("raster-brightness-min"),u_brightness_high:n.paint.get("raster-brightness-max"),u_saturation_factor:jn(n.paint.get("raster-saturation")),u_contrast_factor:Nn(n.paint.get("raster-contrast")),u_spin_weights:Bn(n.paint.get("raster-hue-rotate"))}};function Bn(e){e*=Math.PI/180;var t=Math.sin(e);var r=Math.cos(e);return[(2*r+1)/3,(-Math.sqrt(3)*t-r+1)/3,(Math.sqrt(3)*t-r+1)/3]}function Nn(e){return e>0?1/(1-e):1+e}function jn(e){return e>0?1-1/(1.001-e):-e}var Un=function(t,r){return{u_is_size_zoom_constant:new e.Uniform1i(t,r.u_is_size_zoom_constant),u_is_size_feature_constant:new e.Uniform1i(t,r.u_is_size_feature_constant),u_size_t:new e.Uniform1f(t,r.u_size_t),u_size:new e.Uniform1f(t,r.u_size),u_camera_to_center_distance:new e.Uniform1f(t,r.u_camera_to_center_distance),u_pitch:new e.Uniform1f(t,r.u_pitch),u_rotate_symbol:new e.Uniform1i(t,r.u_rotate_symbol),u_aspect_ratio:new e.Uniform1f(t,r.u_aspect_ratio),u_fade_change:new e.Uniform1f(t,r.u_fade_change),u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_label_plane_matrix:new e.UniformMatrix4f(t,r.u_label_plane_matrix),u_coord_matrix:new e.UniformMatrix4f(t,r.u_coord_matrix),u_is_text:new e.Uniform1i(t,r.u_is_text),u_pitch_with_map:new e.Uniform1i(t,r.u_pitch_with_map),u_texsize:new e.Uniform2f(t,r.u_texsize),u_texture:new e.Uniform1i(t,r.u_texture)}};var Vn=function(t,r){return{u_is_size_zoom_constant:new e.Uniform1i(t,r.u_is_size_zoom_constant),u_is_size_feature_constant:new e.Uniform1i(t,r.u_is_size_feature_constant),u_size_t:new e.Uniform1f(t,r.u_size_t),u_size:new e.Uniform1f(t,r.u_size),u_camera_to_center_distance:new e.Uniform1f(t,r.u_camera_to_center_distance),u_pitch:new e.Uniform1f(t,r.u_pitch),u_rotate_symbol:new e.Uniform1i(t,r.u_rotate_symbol),u_aspect_ratio:new e.Uniform1f(t,r.u_aspect_ratio),u_fade_change:new e.Uniform1f(t,r.u_fade_change),u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_label_plane_matrix:new e.UniformMatrix4f(t,r.u_label_plane_matrix),u_coord_matrix:new e.UniformMatrix4f(t,r.u_coord_matrix),u_is_text:new e.Uniform1i(t,r.u_is_text),u_pitch_with_map:new e.Uniform1i(t,r.u_pitch_with_map),u_texsize:new e.Uniform2f(t,r.u_texsize),u_texture:new e.Uniform1i(t,r.u_texture),u_gamma_scale:new e.Uniform1f(t,r.u_gamma_scale),u_device_pixel_ratio:new e.Uniform1f(t,r.u_device_pixel_ratio),u_is_halo:new e.Uniform1i(t,r.u_is_halo)}};var Hn=function(t,r){return{u_is_size_zoom_constant:new e.Uniform1i(t,r.u_is_size_zoom_constant),u_is_size_feature_constant:new e.Uniform1i(t,r.u_is_size_feature_constant),u_size_t:new e.Uniform1f(t,r.u_size_t),u_size:new e.Uniform1f(t,r.u_size),u_camera_to_center_distance:new e.Uniform1f(t,r.u_camera_to_center_distance),u_pitch:new e.Uniform1f(t,r.u_pitch),u_rotate_symbol:new e.Uniform1i(t,r.u_rotate_symbol),u_aspect_ratio:new e.Uniform1f(t,r.u_aspect_ratio),u_fade_change:new e.Uniform1f(t,r.u_fade_change),u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_label_plane_matrix:new e.UniformMatrix4f(t,r.u_label_plane_matrix),u_coord_matrix:new e.UniformMatrix4f(t,r.u_coord_matrix),u_is_text:new e.Uniform1i(t,r.u_is_text),u_pitch_with_map:new e.Uniform1i(t,r.u_pitch_with_map),u_texsize:new e.Uniform2f(t,r.u_texsize),u_texsize_icon:new e.Uniform2f(t,r.u_texsize_icon),u_texture:new e.Uniform1i(t,r.u_texture),u_texture_icon:new e.Uniform1i(t,r.u_texture_icon),u_gamma_scale:new e.Uniform1f(t,r.u_gamma_scale),u_device_pixel_ratio:new e.Uniform1f(t,r.u_device_pixel_ratio),u_is_halo:new e.Uniform1i(t,r.u_is_halo)}};var qn=function(e,t,r,a,n,i,o,s,l,u){var c=n.transform;return{u_is_size_zoom_constant:+(e==="constant"||e==="source"),u_is_size_feature_constant:+(e==="constant"||e==="camera"),u_size_t:t?t.uSizeT:0,u_size:t?t.uSize:0,u_camera_to_center_distance:c.cameraToCenterDistance,u_pitch:c.pitch/360*2*Math.PI,u_rotate_symbol:+r,u_aspect_ratio:c.width/c.height,u_fade_change:n.options.fadeDuration?n.symbolFadeChange:1,u_matrix:i,u_label_plane_matrix:o,u_coord_matrix:s,u_is_text:+l,u_pitch_with_map:+a,u_texsize:u,u_texture:0}};var Gn=function(t,r,a,n,i,o,s,l,u,c,f){var h=i.transform;return e.extend(qn(t,r,a,n,i,o,s,l,u,c),{u_gamma_scale:n?Math.cos(h._pitch)*h.cameraToCenterDistance:1,u_device_pixel_ratio:e.browser.devicePixelRatio,u_is_halo:+f})};var Yn=function(t,r,a,n,i,o,s,l,u,c){return e.extend(Gn(t,r,a,n,i,o,s,l,true,u,true),{u_texsize_icon:c,u_texture_icon:1})};var Wn=function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_opacity:new e.Uniform1f(t,r.u_opacity),u_color:new e.UniformColor(t,r.u_color)}};var Xn=function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_opacity:new e.Uniform1f(t,r.u_opacity),u_image:new e.Uniform1i(t,r.u_image),u_pattern_tl_a:new e.Uniform2f(t,r.u_pattern_tl_a),u_pattern_br_a:new e.Uniform2f(t,r.u_pattern_br_a),u_pattern_tl_b:new e.Uniform2f(t,r.u_pattern_tl_b),u_pattern_br_b:new e.Uniform2f(t,r.u_pattern_br_b),u_texsize:new e.Uniform2f(t,r.u_texsize),u_mix:new e.Uniform1f(t,r.u_mix),u_pattern_size_a:new e.Uniform2f(t,r.u_pattern_size_a),u_pattern_size_b:new e.Uniform2f(t,r.u_pattern_size_b),u_scale_a:new e.Uniform1f(t,r.u_scale_a),u_scale_b:new e.Uniform1f(t,r.u_scale_b),u_pixel_coord_upper:new e.Uniform2f(t,r.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(t,r.u_pixel_coord_lower),u_tile_units_to_pixels:new e.Uniform1f(t,r.u_tile_units_to_pixels)}};var Zn=function(e,t,r){return{u_matrix:e,u_opacity:t,u_color:r}};var Jn=function(t,r,a,n,i,o){return e.extend(Wa(n,o,a,i),{u_matrix:t,u_opacity:r})};var Kn={fillExtrusion:Xa,fillExtrusionPattern:Za,fill:Qa,fillPattern:$a,fillOutline:en,fillOutlinePattern:tn,circle:sn,collisionBox:un,collisionCircle:cn,debug:pn,clippingMask:dn,heatmap:gn,heatmapTexture:yn,hillshade:_n,hillshadePrepare:wn,line:An,lineGradient:Sn,linePattern:En,lineSDF:Ln,raster:Rn,symbolIcon:Un,symbolSDF:Vn,symbolTextAndIcon:Hn,background:Wn,backgroundPattern:Xn};var Qn;function $n(t,r,a,n,i,o,s){var l=t.context;var u=l.gl;var c=t.useProgram("collisionBox");var f=[];var h=0;var p=0;for(var v=0;v<n.length;v++){var d=n[v];var m=r.getTile(d);var g=m.getBucket(a);if(!g){continue}var y=d.posMatrix;if(i[0]!==0||i[1]!==0){y=t.translatePosMatrix(d.posMatrix,m,i,o)}var x=s?g.textCollisionBox:g.iconCollisionBox;var b=g.collisionCircleArray;if(b.length>0){var _=e.create();var w=y;e.mul(_,g.placementInvProjMatrix,t.transform.glCoordMatrix);e.mul(_,_,g.placementViewportMatrix);f.push({circleArray:b,circleOffset:p,transform:w,invTransform:_});h+=b.length/4;p=h}if(!x){continue}c.draw(l,u.LINES,Be.disabled,Ue.disabled,t.colorModeForRenderPass(),Xe.disabled,fn(y,t.transform,m),a.id,x.layoutVertexBuffer,x.indexBuffer,x.segments,null,t.transform.zoom,null,null,x.collisionVertexBuffer)}if(!s||!f.length){return}var T=t.useProgram("collisionCircle");var k=new e.StructArrayLayout2f1f2i16;k.resize(h*4);k._trim();var M=0;for(var A=0,S=f;A<S.length;A+=1){var E=S[A];for(var L=0;L<E.circleArray.length/4;L++){var C=L*4;var I=E.circleArray[C+0];var P=E.circleArray[C+1];var O=E.circleArray[C+2];var z=E.circleArray[C+3];k.emplace(M++,I,P,O,z,0);k.emplace(M++,I,P,O,z,1);k.emplace(M++,I,P,O,z,2);k.emplace(M++,I,P,O,z,3)}}if(!Qn||Qn.length<h*2){Qn=ei(h)}var D=l.createIndexBuffer(Qn,true);var R=l.createVertexBuffer(k,e.collisionCircleLayout.members,true);for(var F=0,B=f;F<B.length;F+=1){var N=B[F];var j=hn(N.transform,N.invTransform,t.transform);T.draw(l,u.TRIANGLES,Be.disabled,Ue.disabled,t.colorModeForRenderPass(),Xe.disabled,j,a.id,R,D,e.SegmentVector.simpleSegment(0,N.circleOffset*2,N.circleArray.length,N.circleArray.length/2),null,t.transform.zoom,null,null,null)}R.destroy();D.destroy()}function ei(t){var r=t*2;var a=new e.StructArrayLayout3ui6;a.resize(r);a._trim();for(var n=0;n<r;n++){var i=n*6;a.uint16[i+0]=n*4+0;a.uint16[i+1]=n*4+1;a.uint16[i+2]=n*4+2;a.uint16[i+3]=n*4+2;a.uint16[i+4]=n*4+3;a.uint16[i+5]=n*4+0}return a}var ti=e.identity(new Float32Array(16));function ri(e,t,r,a,n){if(e.renderPass!=="translucent"){return}var i=Ue.disabled;var o=e.colorModeForRenderPass();var s=r.layout.get("text-variable-anchor");if(s){ni(a,e,r,t,r.layout.get("text-rotation-alignment"),r.layout.get("text-pitch-alignment"),n)}if(r.paint.get("icon-opacity").constantOr(1)!==0){si(e,t,r,a,false,r.paint.get("icon-translate"),r.paint.get("icon-translate-anchor"),r.layout.get("icon-rotation-alignment"),r.layout.get("icon-pitch-alignment"),r.layout.get("icon-keep-upright"),i,o)}if(r.paint.get("text-opacity").constantOr(1)!==0){si(e,t,r,a,true,r.paint.get("text-translate"),r.paint.get("text-translate-anchor"),r.layout.get("text-rotation-alignment"),r.layout.get("text-pitch-alignment"),r.layout.get("text-keep-upright"),i,o)}if(t.map.showCollisionBoxes){$n(e,t,r,a,r.paint.get("text-translate"),r.paint.get("text-translate-anchor"),true);$n(e,t,r,a,r.paint.get("icon-translate"),r.paint.get("icon-translate-anchor"),false)}}function ai(t,r,a,n,i,o){var s=e.getAnchorAlignment(t);var l=s.horizontalAlign;var u=s.verticalAlign;var c=-(l-.5)*r;var f=-(u-.5)*a;var h=e.evaluateVariableOffset(t,n);return new e.Point((c/i+h[0])*o,(f/i+h[1])*o)}function ni(t,r,a,n,i,o,s){var l=r.transform;var u=i==="map";var c=o==="map";for(var f=0,h=t;f<h.length;f+=1){var p=h[f];var v=n.getTile(p);var d=v.getBucket(a);if(!d||!d.text||!d.text.segments.get().length){continue}var m=d.textSizeData;var g=e.evaluateSizeForZoom(m,l.zoom);var y=Nt(v,1,r.transform.zoom);var x=Tt(p.posMatrix,c,u,r.transform,y);var b=a.layout.get("icon-text-fit")!=="none"&&d.hasIconData();if(g){var _=Math.pow(2,l.zoom-v.tileID.overscaledZ);ii(d,u,c,s,e.symbolSize,l,x,p.posMatrix,_,g,b)}}}function ii(t,r,a,n,i,o,s,l,u,c,f){var h=t.text.placedSymbolArray;var p=t.text.dynamicLayoutVertexArray;var v=t.icon.dynamicLayoutVertexArray;var d={};p.clear();for(var m=0;m<h.length;m++){var g=h.get(m);var y=t.allowVerticalPlacement&&!g.placedOrientation;var x=!g.hidden&&g.crossTileID&&!y?n[g.crossTileID]:null;if(!x){Dt(g.numGlyphs,p)}else{var b=new e.Point(g.anchorX,g.anchorY);var _=Mt(b,a?l:s);var w=At(o.cameraToCenterDistance,_.signedDistanceFromCamera);var T=i.evaluateSizeForFeature(t.textSizeData,c,g)*w/e.ONE_EM;if(a){T*=t.tilePixelRatio/u}var k=x.width;var M=x.height;var A=x.anchor;var S=x.textOffset;var E=x.textBoxScale;var L=ai(A,k,M,S,E,T);var C=a?Mt(b.add(L),s).point:_.point.add(r?L.rotate(-o.angle):L);var I=t.allowVerticalPlacement&&g.placedOrientation===e.WritingMode.vertical?Math.PI/2:0;for(var P=0;P<g.numGlyphs;P++){e.addDynamicAttributes(p,C,I)}if(f&&g.associatedIconIndex>=0){d[g.associatedIconIndex]={shiftedAnchor:C,angle:I}}}}if(f){v.clear();var O=t.icon.placedSymbolArray;for(var z=0;z<O.length;z++){var D=O.get(z);if(D.hidden){Dt(D.numGlyphs,v)}else{var R=d[z];if(!R){Dt(D.numGlyphs,v)}else{for(var F=0;F<D.numGlyphs;F++){e.addDynamicAttributes(v,R.shiftedAnchor,R.angle)}}}}t.icon.dynamicLayoutVertexBuffer.updateData(v)}t.text.dynamicLayoutVertexBuffer.updateData(p)}function oi(e,t,r){if(r.iconsInText&&t){return"symbolTextAndIcon"}else if(e){return"symbolSDF"}else{return"symbolIcon"}}function si(t,r,a,n,i,o,s,l,u,c,f,h){var p=t.context;var v=p.gl;var d=t.transform;var m=l==="map";var g=u==="map";var y=m&&a.layout.get("symbol-placement")!=="point";var x=m&&!g&&!y;var b=a.layout.get("symbol-sort-key").constantOr(1)!==undefined;var _=t.depthModeForSublayer(0,Be.ReadOnly);var w=a.layout.get("text-variable-anchor");var T=[];for(var k=0,M=n;k<M.length;k+=1){var A=M[k];var S=r.getTile(A);var E=S.getBucket(a);if(!E){continue}var L=i?E.text:E.icon;if(!L||!L.segments.get().length){continue}var C=L.programConfigurations.get(a.id);var I=i||E.sdfIcons;var P=i?E.textSizeData:E.iconSizeData;var O=g||d.pitch!==0;var z=t.useProgram(oi(I,i,E),C);var D=e.evaluateSizeForZoom(P,d.zoom);var R=void 0;var F=[0,0];var B=void 0;var N=void 0;var j=null;var U=void 0;if(i){B=S.glyphAtlasTexture;N=v.LINEAR;R=S.glyphAtlasTexture.size;if(E.iconsInText){F=S.imageAtlasTexture.size;j=S.imageAtlasTexture;var V=P.kind==="composite"||P.kind==="camera";U=O||t.options.rotating||t.options.zooming||V?v.LINEAR:v.NEAREST}}else{var H=a.layout.get("icon-size").constantOr(0)!==1||E.iconsNeedLinear;B=S.imageAtlasTexture;N=I||t.options.rotating||t.options.zooming||H||O?v.LINEAR:v.NEAREST;R=S.imageAtlasTexture.size}var q=Nt(S,1,t.transform.zoom);var G=Tt(A.posMatrix,g,m,t.transform,q);var Y=kt(A.posMatrix,g,m,t.transform,q);var W=w&&E.hasTextData();var X=a.layout.get("icon-text-fit")!=="none"&&W&&E.hasIconData();if(y){Et(E,A.posMatrix,t,i,G,Y,g,c)}var Z=t.translatePosMatrix(A.posMatrix,S,o,s),J=y||i&&w||X?ti:G,K=t.translatePosMatrix(Y,S,o,s,true);var Q=I&&a.paint.get(i?"text-halo-width":"icon-halo-width").constantOr(1)!==0;var $=void 0;if(I){if(!E.iconsInText){$=Gn(P.kind,D,x,g,t,Z,J,K,i,R,true)}else{$=Yn(P.kind,D,x,g,t,Z,J,K,R,F)}}else{$=qn(P.kind,D,x,g,t,Z,J,K,i,R)}var ee={program:z,buffers:L,uniformValues:$,atlasTexture:B,atlasTextureIcon:j,atlasInterpolation:N,atlasInterpolationIcon:U,isSDF:I,hasHalo:Q};if(b){var te=L.segments.get();for(var re=0,ae=te;re<ae.length;re+=1){var ne=ae[re];T.push({segments:new e.SegmentVector([ne]),sortKey:ne.sortKey,state:ee})}}else{T.push({segments:L.segments,sortKey:0,state:ee})}}if(b){T.sort((function(e,t){return e.sortKey-t.sortKey}))}for(var ie=0,oe=T;ie<oe.length;ie+=1){var se=oe[ie];var le=se.state;p.activeTexture.set(v.TEXTURE0);le.atlasTexture.bind(le.atlasInterpolation,v.CLAMP_TO_EDGE);if(le.atlasTextureIcon){p.activeTexture.set(v.TEXTURE1);if(le.atlasTextureIcon){le.atlasTextureIcon.bind(le.atlasInterpolationIcon,v.CLAMP_TO_EDGE)}}if(le.isSDF){var ue=le.uniformValues;if(le.hasHalo){ue["u_is_halo"]=1;li(le.buffers,se.segments,a,t,le.program,_,f,h,ue)}ue["u_is_halo"]=0}li(le.buffers,se.segments,a,t,le.program,_,f,h,le.uniformValues)}}function li(e,t,r,a,n,i,o,s,l){var u=a.context;var c=u.gl;n.draw(u,c.TRIANGLES,i,o,s,Xe.disabled,l,r.id,e.layoutVertexBuffer,e.indexBuffer,t,r.paint,a.transform.zoom,e.programConfigurations.get(r.id),e.dynamicLayoutVertexBuffer,e.opacityVertexBuffer)}function ui(t,r,a,n){if(t.renderPass!=="translucent"){return}var i=a.paint.get("circle-opacity");var o=a.paint.get("circle-stroke-width");var s=a.paint.get("circle-stroke-opacity");var l=a.layout.get("circle-sort-key").constantOr(1)!==undefined;if(i.constantOr(1)===0&&(o.constantOr(1)===0||s.constantOr(1)===0)){return}var u=t.context;var c=u.gl;var f=t.depthModeForSublayer(0,Be.ReadOnly);var h=Ue.disabled;var p=t.colorModeForRenderPass();var v=[];for(var d=0;d<n.length;d++){var m=n[d];var g=r.getTile(m);var y=g.getBucket(a);if(!y){continue}var x=y.programConfigurations.get(a.id);var b=t.useProgram("circle",x);var _=y.layoutVertexBuffer;var w=y.indexBuffer;var T=ln(t,m,g,a);var k={programConfiguration:x,program:b,layoutVertexBuffer:_,indexBuffer:w,uniformValues:T};if(l){var M=y.segments.get();for(var A=0,S=M;A<S.length;A+=1){var E=S[A];v.push({segments:new e.SegmentVector([E]),sortKey:E.sortKey,state:k})}}else{v.push({segments:y.segments,sortKey:0,state:k})}}if(l){v.sort((function(e,t){return e.sortKey-t.sortKey}))}for(var L=0,C=v;L<C.length;L+=1){var I=C[L];var P=I.state;var O=P.programConfiguration;var z=P.program;var D=P.layoutVertexBuffer;var R=P.indexBuffer;var F=P.uniformValues;var B=I.segments;z.draw(u,c.TRIANGLES,f,h,p,Xe.disabled,F,a.id,D,R,B,a.paint,t.transform.zoom,O)}}function ci(t,r,a,n){if(a.paint.get("heatmap-opacity")===0){return}if(t.renderPass==="offscreen"){var i=t.context;var o=i.gl;var s=Ue.disabled;var l=new Ge([o.ONE,o.ONE],e.Color.transparent,[true,true,true,true]);fi(i,t,a);i.clear({color:e.Color.transparent});for(var u=0;u<n.length;u++){var c=n[u];if(r.hasRenderableParent(c)){continue}var f=r.getTile(c);var h=f.getBucket(a);if(!h){continue}var p=h.programConfigurations.get(a.id);var v=t.useProgram("heatmap",p);var d=t.transform;var m=d.zoom;v.draw(i,o.TRIANGLES,Be.disabled,s,l,Xe.disabled,xn(c.posMatrix,f,m,a.paint.get("heatmap-intensity")),a.id,h.layoutVertexBuffer,h.indexBuffer,h.segments,a.paint,t.transform.zoom,p)}i.viewport.set([0,0,t.width,t.height])}else if(t.renderPass==="translucent"){t.context.setColorMode(t.colorModeForRenderPass());pi(t,a)}}function fi(e,t,r){var a=e.gl;e.activeTexture.set(a.TEXTURE1);e.viewport.set([0,0,t.width/4,t.height/4]);var n=r.heatmapFbo;if(!n){var i=a.createTexture();a.bindTexture(a.TEXTURE_2D,i);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR);n=r.heatmapFbo=e.createFramebuffer(t.width/4,t.height/4,false);hi(e,t,i,n)}else{a.bindTexture(a.TEXTURE_2D,n.colorAttachment.get());e.bindFramebuffer.set(n.framebuffer)}}function hi(e,t,r,a){var n=e.gl;var i=e.extRenderToTextureHalfFloat?e.extTextureHalfFloat.HALF_FLOAT_OES:n.UNSIGNED_BYTE;n.texImage2D(n.TEXTURE_2D,0,n.RGBA,t.width/4,t.height/4,0,n.RGBA,i,null);a.colorAttachment.set(r)}function pi(t,r){var a=t.context;var n=a.gl;var i=r.heatmapFbo;if(!i){return}a.activeTexture.set(n.TEXTURE0);n.bindTexture(n.TEXTURE_2D,i.colorAttachment.get());a.activeTexture.set(n.TEXTURE1);var o=r.colorRampTexture;if(!o){o=r.colorRampTexture=new e.Texture(a,r.colorRamp,n.RGBA)}o.bind(n.LINEAR,n.CLAMP_TO_EDGE);t.useProgram("heatmapTexture").draw(a,n.TRIANGLES,Be.disabled,Ue.disabled,t.colorModeForRenderPass(),Xe.disabled,bn(t,r,0,1),r.id,t.viewportBuffer,t.quadTriangleIndexBuffer,t.viewportSegments,r.paint,t.transform.zoom)}function vi(t,r,a,n){if(t.renderPass!=="translucent"){return}var i=a.paint.get("line-opacity");var o=a.paint.get("line-width");if(i.constantOr(1)===0||o.constantOr(1)===0){return}var s=t.depthModeForSublayer(0,Be.ReadOnly);var l=t.colorModeForRenderPass();var u=a.paint.get("line-dasharray");var c=a.paint.get("line-pattern");var f=c.constantOr(1);var h=a.paint.get("line-gradient");var p=a.getCrossfadeParameters();var v=f?"linePattern":u?"lineSDF":h?"lineGradient":"line";var d=t.context;var m=d.gl;var g=true;if(h){d.activeTexture.set(m.TEXTURE0);var y=a.gradientTexture;if(!a.gradient){return}if(!y){y=a.gradientTexture=new e.Texture(d,a.gradient,m.RGBA)}y.bind(m.LINEAR,m.CLAMP_TO_EDGE)}for(var x=0,b=n;x<b.length;x+=1){var _=b[x];var w=r.getTile(_);if(f&&!w.patternsLoaded()){continue}var T=w.getBucket(a);if(!T){continue}var k=T.programConfigurations.get(a.id);var M=t.context.program.get();var A=t.useProgram(v,k);var S=g||A.program!==M;var E=c.constantOr(null);if(E&&w.imageAtlas){var L=w.imageAtlas;var C=L.patternPositions[E.to.toString()];var I=L.patternPositions[E.from.toString()];if(C&&I){k.setConstantPatternPositions(C,I)}}var P=f?Pn(t,w,a,p):u?On(t,w,a,u,p):h?In(t,w,a):Cn(t,w,a);if(f){d.activeTexture.set(m.TEXTURE0);w.imageAtlasTexture.bind(m.LINEAR,m.CLAMP_TO_EDGE);k.updatePaintBuffers(p)}else if(u&&(S||t.lineAtlas.dirty)){d.activeTexture.set(m.TEXTURE0);t.lineAtlas.bind(d)}A.draw(d,m.TRIANGLES,s,t.stencilModeForClipping(_),l,Xe.disabled,P,a.id,T.layoutVertexBuffer,T.indexBuffer,T.segments,a.paint,t.transform.zoom,k);g=false}}function di(t,r,a,n){var i=a.paint.get("fill-color");var o=a.paint.get("fill-opacity");if(o.constantOr(1)===0){return}var s=t.colorModeForRenderPass();var l=a.paint.get("fill-pattern");var u=t.opaquePassEnabledForLayer()&&(!l.constantOr(1)&&i.constantOr(e.Color.transparent).a===1&&o.constantOr(0)===1)?"opaque":"translucent";if(t.renderPass===u){var c=t.depthModeForSublayer(1,t.renderPass==="opaque"?Be.ReadWrite:Be.ReadOnly);mi(t,r,a,n,c,s,false)}if(t.renderPass==="translucent"&&a.paint.get("fill-antialias")){var f=t.depthModeForSublayer(a.getPaintProperty("fill-outline-color")?2:0,Be.ReadOnly);mi(t,r,a,n,f,s,true)}}function mi(e,t,r,a,n,i,o){var s=e.context.gl;var l=r.paint.get("fill-pattern");var u=l&&l.constantOr(1);var c=r.getCrossfadeParameters();var f,h,p,v,d;if(!o){h=u?"fillPattern":"fill";f=s.TRIANGLES}else{h=u&&!r.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline";f=s.LINES}for(var m=0,g=a;m<g.length;m+=1){var y=g[m];var x=t.getTile(y);if(u&&!x.patternsLoaded()){continue}var b=x.getBucket(r);if(!b){continue}var _=b.programConfigurations.get(r.id);var w=e.useProgram(h,_);if(u){e.context.activeTexture.set(s.TEXTURE0);x.imageAtlasTexture.bind(s.LINEAR,s.CLAMP_TO_EDGE);_.updatePaintBuffers(c)}var T=l.constantOr(null);if(T&&x.imageAtlas){var k=x.imageAtlas;var M=k.patternPositions[T.to.toString()];var A=k.patternPositions[T.from.toString()];if(M&&A){_.setConstantPatternPositions(M,A)}}var S=e.translatePosMatrix(y.posMatrix,x,r.paint.get("fill-translate"),r.paint.get("fill-translate-anchor"));if(!o){v=b.indexBuffer;d=b.segments;p=u?an(S,e,c,x):rn(S)}else{v=b.indexBuffer2;d=b.segments2;var E=[s.drawingBufferWidth,s.drawingBufferHeight];p=h==="fillOutlinePattern"&&u?on(S,e,c,x,E):nn(S,E)}w.draw(e.context,f,n,e.stencilModeForClipping(y),i,Xe.disabled,p,r.id,b.layoutVertexBuffer,v,d,r.paint,e.transform.zoom,_)}}function gi(e,t,r,a){var n=r.paint.get("fill-extrusion-opacity");if(n===0){return}if(e.renderPass==="translucent"){var i=new Be(e.context.gl.LEQUAL,Be.ReadWrite,e.depthRangeFor3D);if(n===1&&!r.paint.get("fill-extrusion-pattern").constantOr(1)){var o=e.colorModeForRenderPass();yi(e,t,r,a,i,Ue.disabled,o)}else{yi(e,t,r,a,i,Ue.disabled,Ge.disabled);yi(e,t,r,a,i,e.stencilModeFor3D(),e.colorModeForRenderPass())}}}function yi(e,t,r,a,n,i,o){var s=e.context;var l=s.gl;var u=r.paint.get("fill-extrusion-pattern");var c=u.constantOr(1);var f=r.getCrossfadeParameters();var h=r.paint.get("fill-extrusion-opacity");for(var p=0,v=a;p<v.length;p+=1){var d=v[p];var m=t.getTile(d);var g=m.getBucket(r);if(!g){continue}var y=g.programConfigurations.get(r.id);var x=e.useProgram(c?"fillExtrusionPattern":"fillExtrusion",y);if(c){e.context.activeTexture.set(l.TEXTURE0);m.imageAtlasTexture.bind(l.LINEAR,l.CLAMP_TO_EDGE);y.updatePaintBuffers(f)}var b=u.constantOr(null);if(b&&m.imageAtlas){var _=m.imageAtlas;var w=_.patternPositions[b.to.toString()];var T=_.patternPositions[b.from.toString()];if(w&&T){y.setConstantPatternPositions(w,T)}}var k=e.translatePosMatrix(d.posMatrix,m,r.paint.get("fill-extrusion-translate"),r.paint.get("fill-extrusion-translate-anchor"));var M=r.paint.get("fill-extrusion-vertical-gradient");var A=c?Ka(k,e,M,h,d,f,m):Ja(k,e,M,h);x.draw(s,s.gl.TRIANGLES,n,i,o,Xe.backCCW,A,r.id,g.layoutVertexBuffer,g.indexBuffer,g.segments,r.paint,e.transform.zoom,y)}}function xi(e,t,r,a){if(e.renderPass!=="offscreen"&&e.renderPass!=="translucent"){return}var n=e.context;var i=t.getSource().maxzoom;var o=e.depthModeForSublayer(0,Be.ReadOnly);var s=e.colorModeForRenderPass();var l=e.renderPass==="translucent"?e.stencilConfigForOverlap(a):[{},a];var u=l[0];var c=l[1];for(var f=0,h=c;f<h.length;f+=1){var p=h[f];var v=t.getTile(p);if(v.needsHillshadePrepare&&e.renderPass==="offscreen"){_i(e,v,r,i,o,Ue.disabled,s)}else if(e.renderPass==="translucent"){bi(e,v,r,o,u[p.overscaledZ],s)}}n.viewport.set([0,0,e.width,e.height])}function bi(e,t,r,a,n,i){var o=e.context;var s=o.gl;var l=t.fbo;if(!l){return}var u=e.useProgram("hillshade");o.activeTexture.set(s.TEXTURE0);s.bindTexture(s.TEXTURE_2D,l.colorAttachment.get());var c=Tn(e,t,r);u.draw(o,s.TRIANGLES,a,n,i,Xe.disabled,c,r.id,e.rasterBoundsBuffer,e.quadTriangleIndexBuffer,e.rasterBoundsSegments)}function _i(t,r,a,n,i,o,s){var l=t.context;var u=l.gl;var c=r.dem;if(c&&c.data){var f=c.dim;var h=c.stride;var p=c.getPixels();l.activeTexture.set(u.TEXTURE1);l.pixelStoreUnpackPremultiplyAlpha.set(false);r.demTexture=r.demTexture||t.getTileTexture(h);if(r.demTexture){var v=r.demTexture;v.update(p,{premultiply:false});v.bind(u.NEAREST,u.CLAMP_TO_EDGE)}else{r.demTexture=new e.Texture(l,p,u.RGBA,{premultiply:false});r.demTexture.bind(u.NEAREST,u.CLAMP_TO_EDGE)}l.activeTexture.set(u.TEXTURE0);var d=r.fbo;if(!d){var m=new e.Texture(l,{width:f,height:f,data:null},u.RGBA);m.bind(u.LINEAR,u.CLAMP_TO_EDGE);d=r.fbo=l.createFramebuffer(f,f,true);d.colorAttachment.set(m.texture)}l.bindFramebuffer.set(d.framebuffer);l.viewport.set([0,0,f,f]);t.useProgram("hillshadePrepare").draw(l,u.TRIANGLES,i,o,s,Xe.disabled,kn(r.tileID,c,n),a.id,t.rasterBoundsBuffer,t.quadTriangleIndexBuffer,t.rasterBoundsSegments);r.needsHillshadePrepare=false}}function wi(e,t,r,a){if(e.renderPass!=="translucent"){return}if(r.paint.get("raster-opacity")===0){return}if(!a.length){return}var n=e.context;var i=n.gl;var o=t.getSource();var s=e.useProgram("raster");var l=e.colorModeForRenderPass();var u=o instanceof R?[{},a]:e.stencilConfigForOverlap(a);var c=u[0];var f=u[1];var h=f[f.length-1].overscaledZ;var p=!e.options.moving;for(var v=0,d=f;v<d.length;v+=1){var m=d[v];var g=e.depthModeForSublayer(m.overscaledZ-h,r.paint.get("raster-opacity")===1?Be.ReadWrite:Be.ReadOnly,i.LESS);var y=t.getTile(m);var x=e.transform.calculatePosMatrix(m.toUnwrapped(),p);y.registerFadeDuration(r.paint.get("raster-fade-duration"));var b=t.findLoadedParent(m,0),_=Ti(y,b,t,r,e.transform);var w=void 0,T=void 0;var k=r.paint.get("raster-resampling")==="nearest"?i.NEAREST:i.LINEAR;n.activeTexture.set(i.TEXTURE0);y.texture.bind(k,i.CLAMP_TO_EDGE,i.LINEAR_MIPMAP_NEAREST);n.activeTexture.set(i.TEXTURE1);if(b){b.texture.bind(k,i.CLAMP_TO_EDGE,i.LINEAR_MIPMAP_NEAREST);w=Math.pow(2,b.tileID.overscaledZ-y.tileID.overscaledZ);T=[y.tileID.canonical.x*w%1,y.tileID.canonical.y*w%1]}else{y.texture.bind(k,i.CLAMP_TO_EDGE,i.LINEAR_MIPMAP_NEAREST)}var M=Fn(x,T||[0,0],w||1,_,r);if(o instanceof R){s.draw(n,i.TRIANGLES,g,Ue.disabled,l,Xe.disabled,M,r.id,o.boundsBuffer,e.quadTriangleIndexBuffer,o.boundsSegments)}else{s.draw(n,i.TRIANGLES,g,c[m.overscaledZ],l,Xe.disabled,M,r.id,e.rasterBoundsBuffer,e.quadTriangleIndexBuffer,e.rasterBoundsSegments)}}}function Ti(t,r,a,n,i){var o=n.paint.get("raster-fade-duration");if(o>0){var s=e.browser.now();var l=(s-t.timeAdded)/o;var u=r?(s-r.timeAdded)/o:-1;var c=a.getSource();var f=i.coveringZoomLevel({tileSize:c.tileSize,roundZoom:c.roundZoom});var h=!r||Math.abs(r.tileID.overscaledZ-f)>Math.abs(t.tileID.overscaledZ-f);var p=h&&t.refreshedUponExpiration?1:e.clamp(h?l:1-u,0,1);if(t.refreshedUponExpiration&&l>=1){t.refreshedUponExpiration=false}if(r){return{opacity:1,mix:1-p}}else{return{opacity:p,mix:0}}}else{return{opacity:1,mix:0}}}function ki(e,t,r){var a=r.paint.get("background-color");var n=r.paint.get("background-opacity");if(n===0){return}var i=e.context;var o=i.gl;var s=e.transform;var l=s.tileSize;var u=r.paint.get("background-pattern");if(e.isPatternMissing(u)){return}var c=!u&&a.a===1&&n===1&&e.opaquePassEnabledForLayer()?"opaque":"translucent";if(e.renderPass!==c){return}var f=Ue.disabled;var h=e.depthModeForSublayer(0,c==="opaque"?Be.ReadWrite:Be.ReadOnly);var p=e.colorModeForRenderPass();var v=e.useProgram(u?"backgroundPattern":"background");var d=s.coveringTiles({tileSize:l});if(u){i.activeTexture.set(o.TEXTURE0);e.imageManager.bind(e.context)}var m=r.getCrossfadeParameters();for(var g=0,y=d;g<y.length;g+=1){var x=y[g];var b=e.transform.calculatePosMatrix(x.toUnwrapped());var _=u?Jn(b,n,e,u,{tileID:x,tileSize:l},m):Zn(b,n,a);v.draw(i,o.TRIANGLES,h,f,p,Xe.disabled,_,r.id,e.tileExtentBuffer,e.quadTriangleIndexBuffer,e.tileExtentSegments)}}var Mi=new e.Color(1,0,0,1);var Ai=new e.Color(0,1,0,1);var Si=new e.Color(0,0,1,1);var Ei=new e.Color(1,0,1,1);var Li=new e.Color(0,1,1,1);function Ci(e){var t=e.transform.padding;var r=3;Pi(e,e.transform.height-(t.top||0),r,Mi);Pi(e,t.bottom||0,r,Ai);Oi(e,t.left||0,r,Si);Oi(e,e.transform.width-(t.right||0),r,Ei);var a=e.transform.centerPoint;Ii(e,a.x,e.transform.height-a.y,Li)}function Ii(e,t,r,a){var n=20;var i=2;zi(e,t-i/2,r-n/2,i,n,a);zi(e,t-n/2,r-i/2,n,i,a)}function Pi(e,t,r,a){zi(e,0,t+r/2,e.transform.width,r,a)}function Oi(e,t,r,a){zi(e,t-r/2,0,r,e.transform.height,a)}function zi(t,r,a,n,i,o){var s=t.context;var l=s.gl;l.enable(l.SCISSOR_TEST);l.scissor(r*e.browser.devicePixelRatio,a*e.browser.devicePixelRatio,n*e.browser.devicePixelRatio,i*e.browser.devicePixelRatio);s.clear({color:o});l.disable(l.SCISSOR_TEST)}function Di(e,t,r){for(var a=0;a<r.length;a++){Ri(e,t,r[a])}}function Ri(t,r,a){var n=t.context;var i=n.gl;var o=a.posMatrix;var s=t.useProgram("debug");var l=Be.disabled;var u=Ue.disabled;var c=t.colorModeForRenderPass();var f="$debug";n.activeTexture.set(i.TEXTURE0);t.emptyTexture.bind(i.LINEAR,i.CLAMP_TO_EDGE);s.draw(n,i.LINE_STRIP,l,u,c,Xe.disabled,vn(o,e.Color.red),f,t.debugBuffer,t.tileBorderIndexBuffer,t.debugSegments);var h=r.getTileByID(a.key).latestRawTileData;var p=h&&h.byteLength||0;var v=Math.floor(p/1024);var d=r.getTile(a).tileSize;var m=512/Math.min(d,512)*(a.overscaledZ/t.transform.zoom)*.5;var g=a.canonical.toString();if(a.overscaledZ!==a.canonical.z){g+=" => "+a.overscaledZ}var y=g+" "+v+"kb";Fi(t,y);s.draw(n,i.TRIANGLES,l,u,Ge.alphaBlended,Xe.disabled,vn(o,e.Color.transparent,m),f,t.debugBuffer,t.quadTriangleIndexBuffer,t.debugSegments)}function Fi(e,t){e.initDebugOverlayCanvas();var r=e.debugOverlayCanvas;var a=e.context.gl;var n=e.debugOverlayCanvas.getContext("2d");n.clearRect(0,0,r.width,r.height);n.shadowColor="white";n.shadowBlur=2;n.lineWidth=1.5;n.strokeStyle="white";n.textBaseline="top";n.font="bold "+36+"px Open Sans, sans-serif";n.fillText(t,5,5);n.strokeText(t,5,5);e.debugOverlayTexture.update(r);e.debugOverlayTexture.bind(a.LINEAR,a.CLAMP_TO_EDGE)}function Bi(e,t,r){var a=e.context;var n=r.implementation;if(e.renderPass==="offscreen"){var i=n.prerender;if(i){e.setCustomLayerDefaults();a.setColorMode(e.colorModeForRenderPass());i.call(n,a.gl,e.transform.customLayerMatrix());a.setDirty();e.setBaseState()}}else if(e.renderPass==="translucent"){e.setCustomLayerDefaults();a.setColorMode(e.colorModeForRenderPass());a.setStencilMode(Ue.disabled);var o=n.renderingMode==="3d"?new Be(e.context.gl.LEQUAL,Be.ReadWrite,e.depthRangeFor3D):e.depthModeForSublayer(0,Be.ReadOnly);a.setDepthMode(o);n.render(a.gl,e.transform.customLayerMatrix());a.setDirty();e.setBaseState();a.bindFramebuffer.set(null)}}var Ni={symbol:ri,circle:ui,heatmap:ci,line:vi,fill:di,"fill-extrusion":gi,hillshade:xi,raster:wi,background:ki,debug:Di,custom:Bi};var ji=function e(t,r){this.context=new Ze(t);this.transform=r;this._tileTextures={};this.setup();this.numSublayers=Je.maxUnderzooming+Je.maxOverzooming+1;this.depthEpsilon=1/Math.pow(2,16);this.crossTileSymbolIndex=new fr;this.gpuTimers={}};ji.prototype.resize=function t(r,a){this.width=r*e.browser.devicePixelRatio;this.height=a*e.browser.devicePixelRatio;this.context.viewport.set([0,0,this.width,this.height]);if(this.style){for(var n=0,i=this.style._order;n<i.length;n+=1){var o=i[n];this.style._layers[o].resize()}}};ji.prototype.setup=function t(){var r=this.context;var a=new e.StructArrayLayout2i4;a.emplaceBack(0,0);a.emplaceBack(e.EXTENT,0);a.emplaceBack(0,e.EXTENT);a.emplaceBack(e.EXTENT,e.EXTENT);this.tileExtentBuffer=r.createVertexBuffer(a,gr.members);this.tileExtentSegments=e.SegmentVector.simpleSegment(0,0,4,2);var n=new e.StructArrayLayout2i4;n.emplaceBack(0,0);n.emplaceBack(e.EXTENT,0);n.emplaceBack(0,e.EXTENT);n.emplaceBack(e.EXTENT,e.EXTENT);this.debugBuffer=r.createVertexBuffer(n,gr.members);this.debugSegments=e.SegmentVector.simpleSegment(0,0,4,5);var i=new e.StructArrayLayout4i8;i.emplaceBack(0,0,0,0);i.emplaceBack(e.EXTENT,0,e.EXTENT,0);i.emplaceBack(0,e.EXTENT,0,e.EXTENT);i.emplaceBack(e.EXTENT,e.EXTENT,e.EXTENT,e.EXTENT);this.rasterBoundsBuffer=r.createVertexBuffer(i,D.members);this.rasterBoundsSegments=e.SegmentVector.simpleSegment(0,0,4,2);var o=new e.StructArrayLayout2i4;o.emplaceBack(0,0);o.emplaceBack(1,0);o.emplaceBack(0,1);o.emplaceBack(1,1);this.viewportBuffer=r.createVertexBuffer(o,gr.members);this.viewportSegments=e.SegmentVector.simpleSegment(0,0,4,2);var s=new e.StructArrayLayout1ui2;s.emplaceBack(0);s.emplaceBack(1);s.emplaceBack(3);s.emplaceBack(2);s.emplaceBack(0);this.tileBorderIndexBuffer=r.createIndexBuffer(s);var l=new e.StructArrayLayout3ui6;l.emplaceBack(0,1,2);l.emplaceBack(2,1,3);this.quadTriangleIndexBuffer=r.createIndexBuffer(l);this.emptyTexture=new e.Texture(r,{width:1,height:1,data:new Uint8Array([0,0,0,0])},r.gl.RGBA);var u=this.context.gl;this.stencilClearMode=new Ue({func:u.ALWAYS,mask:0},0,255,u.ZERO,u.ZERO,u.ZERO)};ji.prototype.clearStencil=function t(){var r=this.context;var a=r.gl;this.nextStencilID=1;this.currentStencilSource=undefined;var n=e.create();e.ortho(n,0,this.width,this.height,0,0,1);e.scale(n,n,[a.drawingBufferWidth,a.drawingBufferHeight,0]);this.useProgram("clippingMask").draw(r,a.TRIANGLES,Be.disabled,this.stencilClearMode,Ge.disabled,Xe.disabled,mn(n),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)};ji.prototype._renderTileClippingMasks=function e(t,r){if(this.currentStencilSource===t.source||!t.isTileClipped()||!r||!r.length){return}this.currentStencilSource=t.source;var a=this.context;var n=a.gl;if(this.nextStencilID+r.length>256){this.clearStencil()}a.setColorMode(Ge.disabled);a.setDepthMode(Be.disabled);var i=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var o=0,s=r;o<s.length;o+=1){var l=s[o];var u=this._tileClippingMaskIDs[l.key]=this.nextStencilID++;i.draw(a,n.TRIANGLES,Be.disabled,new Ue({func:n.ALWAYS,mask:0},u,255,n.KEEP,n.KEEP,n.REPLACE),Ge.disabled,Xe.disabled,mn(l.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}};ji.prototype.stencilModeFor3D=function e(){this.currentStencilSource=undefined;if(this.nextStencilID+1>256){this.clearStencil()}var t=this.nextStencilID++;var r=this.context.gl;return new Ue({func:r.NOTEQUAL,mask:255},t,255,r.KEEP,r.KEEP,r.REPLACE)};ji.prototype.stencilModeForClipping=function e(t){var r=this.context.gl;return new Ue({func:r.EQUAL,mask:255},this._tileClippingMaskIDs[t.key],0,r.KEEP,r.KEEP,r.REPLACE)};ji.prototype.stencilConfigForOverlap=function e(t){var r;var a=this.context.gl;var n=t.sort((function(e,t){return t.overscaledZ-e.overscaledZ}));var i=n[n.length-1].overscaledZ;var o=n[0].overscaledZ-i+1;if(o>1){this.currentStencilSource=undefined;if(this.nextStencilID+o>256){this.clearStencil()}var s={};for(var l=0;l<o;l++){s[l+i]=new Ue({func:a.GEQUAL,mask:255},l+this.nextStencilID,255,a.KEEP,a.KEEP,a.REPLACE)}this.nextStencilID+=o;return[s,n]}return[(r={},r[i]=Ue.disabled,r),n]};ji.prototype.colorModeForRenderPass=function t(){var r=this.context.gl;if(this._showOverdrawInspector){var a=8;var n=1/a;return new Ge([r.CONSTANT_COLOR,r.ONE],new e.Color(n,n,n,0),[true,true,true,true])}else if(this.renderPass==="opaque"){return Ge.unblended}else{return Ge.alphaBlended}};ji.prototype.depthModeForSublayer=function e(t,r,a){if(!this.opaquePassEnabledForLayer()){return Be.disabled}var n=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon;return new Be(a||this.context.gl.LEQUAL,r,[n,n])};ji.prototype.opaquePassEnabledForLayer=function e(){return this.currentLayer<this.opaquePassCutoff};ji.prototype.render=function t(r,a){var n=this;this.style=r;this.options=a;this.lineAtlas=r.lineAtlas;this.imageManager=r.imageManager;this.glyphManager=r.glyphManager;this.symbolFadeChange=r.placement.symbolFadeChange(e.browser.now());this.imageManager.beginFrame();var i=this.style._order;var o=this.style.sourceCaches;for(var s in o){var l=o[s];if(l.used){l.prepare(this.context)}}var u={};var c={};var f={};for(var h in o){var p=o[h];u[h]=p.getVisibleCoordinates();c[h]=u[h].slice().reverse();f[h]=p.getVisibleCoordinates(true).reverse()}this.opaquePassCutoff=Infinity;for(var v=0;v<i.length;v++){var d=i[v];if(this.style._layers[d].is3D()){this.opaquePassCutoff=v;break}}this.renderPass="offscreen";for(var m=0,g=i;m<g.length;m+=1){var y=g[m];var x=this.style._layers[y];if(!x.hasOffscreenPass()||x.isHidden(this.transform.zoom)){continue}var b=c[x.source];if(x.type!=="custom"&&!b.length){continue}this.renderLayer(this,o[x.source],x,b)}this.context.bindFramebuffer.set(null);this.context.clear({color:a.showOverdrawInspector?e.Color.black:e.Color.transparent,depth:1});this.clearStencil();this._showOverdrawInspector=a.showOverdrawInspector;this.depthRangeFor3D=[0,1-(r._order.length+2)*this.numSublayers*this.depthEpsilon];this.renderPass="opaque";for(this.currentLayer=i.length-1;this.currentLayer>=0;this.currentLayer--){var _=this.style._layers[i[this.currentLayer]];var w=o[_.source];var T=u[_.source];this._renderTileClippingMasks(_,T);this.renderLayer(this,w,_,T)}this.renderPass="translucent";for(this.currentLayer=0;this.currentLayer<i.length;this.currentLayer++){var k=this.style._layers[i[this.currentLayer]];var M=o[k.source];var A=(k.type==="symbol"?f:c)[k.source];this._renderTileClippingMasks(k,u[k.source]);this.renderLayer(this,M,k,A)}if(this.options.showTileBoundaries){var S;var E;var L=e.values(this.style._layers);L.forEach((function(e){if(e.source&&!e.isHidden(n.transform.zoom)){if(e.source!==(E&&E.id)){E=n.style.sourceCaches[e.source]}if(!S||S.getSource().maxzoom<E.getSource().maxzoom){S=E}}}));if(S){Ni.debug(this,S,S.getVisibleCoordinates())}}if(this.options.showPadding){Ci(this)}this.context.setDefault()};ji.prototype.renderLayer=function e(t,r,a,n){if(a.isHidden(this.transform.zoom)){return}if(a.type!=="background"&&a.type!=="custom"&&!n.length){return}this.id=a.id;this.gpuTimingStart(a);Ni[a.type](t,r,a,n,this.style.placement.variableOffsets);this.gpuTimingEnd()};ji.prototype.gpuTimingStart=function e(t){if(!this.options.gpuTiming){return}var r=this.context.extTimerQuery;var a=this.gpuTimers[t.id];if(!a){a=this.gpuTimers[t.id]={calls:0,cpuTime:0,query:r.createQueryEXT()}}a.calls++;r.beginQueryEXT(r.TIME_ELAPSED_EXT,a.query)};ji.prototype.gpuTimingEnd=function e(){if(!this.options.gpuTiming){return}var t=this.context.extTimerQuery;t.endQueryEXT(t.TIME_ELAPSED_EXT)};ji.prototype.collectGpuTimers=function e(){var t=this.gpuTimers;this.gpuTimers={};return t};ji.prototype.queryGpuTimers=function e(t){var r={};for(var a in t){var n=t[a];var i=this.context.extTimerQuery;var o=i.getQueryObjectEXT(n.query,i.QUERY_RESULT_EXT)/(1e3*1e3);i.deleteQueryEXT(n.query);r[a]=o}return r};ji.prototype.translatePosMatrix=function t(r,a,n,i,o){if(!n[0]&&!n[1]){return r}var s=o?i==="map"?this.transform.angle:0:i==="viewport"?-this.transform.angle:0;if(s){var l=Math.sin(s);var u=Math.cos(s);n=[n[0]*u-n[1]*l,n[0]*l+n[1]*u]}var c=[o?n[0]:Nt(a,n[0],this.transform.zoom),o?n[1]:Nt(a,n[1],this.transform.zoom),0];var f=new Float32Array(16);e.translate(f,r,c);return f};ji.prototype.saveTileTexture=function e(t){var r=this._tileTextures[t.size[0]];if(!r){this._tileTextures[t.size[0]]=[t]}else{r.push(t)}};ji.prototype.getTileTexture=function e(t){var r=this._tileTextures[t];return r&&r.length>0?r.pop():null};ji.prototype.isPatternMissing=function e(t){if(!t){return false}if(!t.from||!t.to){return true}var r=this.imageManager.getPattern(t.from.toString());var a=this.imageManager.getPattern(t.to.toString());return!r||!a};ji.prototype.useProgram=function e(t,r){this.cache=this.cache||{};var a=""+t+(r?r.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");if(!this.cache[a]){this.cache[a]=new Ga(this.context,Ha[t],r,Kn[t],this._showOverdrawInspector)}return this.cache[a]};ji.prototype.setCustomLayerDefaults=function e(){this.context.unbindVAO();this.context.cullFace.setDefault();this.context.activeTexture.setDefault();this.context.pixelStoreUnpack.setDefault();this.context.pixelStoreUnpackPremultiplyAlpha.setDefault();this.context.pixelStoreUnpackFlipY.setDefault()};ji.prototype.setBaseState=function e(){var t=this.context.gl;this.context.cullFace.set(false);this.context.viewport.set([0,0,this.width,this.height]);this.context.blendEquation.set(t.FUNC_ADD)};ji.prototype.initDebugOverlayCanvas=function t(){if(this.debugOverlayCanvas==null){this.debugOverlayCanvas=e.window.document.createElement("canvas");this.debugOverlayCanvas.width=512;this.debugOverlayCanvas.height=512;var r=this.context.gl;this.debugOverlayTexture=new e.Texture(this.context,this.debugOverlayCanvas,r.RGBA)}};ji.prototype.destroy=function e(){this.emptyTexture.destroy();if(this.debugOverlayTexture){this.debugOverlayTexture.destroy()}};var Ui=function e(t,r){this.points=t;this.planes=r};Ui.fromInvProjectionMatrix=function t(r,a,n){var i=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]];var o=Math.pow(2,n);var s=i.map((function(t){return e.transformMat4([],t,r)})).map((function(t){return e.scale$1([],t,1/t[3]/a*o)}));var l=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]];var u=l.map((function(t){var r=e.sub([],s[t[0]],s[t[1]]);var a=e.sub([],s[t[2]],s[t[1]]);var n=e.normalize([],e.cross([],r,a));var i=-e.dot(n,s[t[1]]);return n.concat(i)}));return new Ui(s,u)};var Vi=function t(r,a){this.min=r;this.max=a;this.center=e.scale$2([],e.add([],this.min,this.max),.5)};Vi.prototype.quadrant=function t(r){var a=[r%2===0,r<2];var n=e.clone$2(this.min);var i=e.clone$2(this.max);for(var o=0;o<a.length;o++){n[o]=a[o]?this.min[o]:this.center[o];i[o]=a[o]?this.center[o]:this.max[o]}i[2]=this.max[2];return new Vi(n,i)};Vi.prototype.distanceX=function e(t){var r=Math.max(Math.min(this.max[0],t[0]),this.min[0]);return r-t[0]};Vi.prototype.distanceY=function e(t){var r=Math.max(Math.min(this.max[1],t[1]),this.min[1]);return r-t[1]};Vi.prototype.intersects=function t(r){var a=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]];var n=true;for(var i=0;i<r.planes.length;i++){var o=r.planes[i];var s=0;for(var l=0;l<a.length;l++){s+=e.dot$1(o,a[l])>=0}if(s===0){return 0}if(s!==a.length){n=false}}if(n){return 2}for(var u=0;u<3;u++){var c=Number.MAX_VALUE;var f=-Number.MAX_VALUE;for(var h=0;h<r.points.length;h++){var p=r.points[h][u]-this.min[u];c=Math.min(c,p);f=Math.max(f,p)}if(f<0||c>this.max[u]-this.min[u]){return 0}}return 1};var Hi=function e(t,r,a,n){if(t===void 0)t=0;if(r===void 0)r=0;if(a===void 0)a=0;if(n===void 0)n=0;if(isNaN(t)||t<0||isNaN(r)||r<0||isNaN(a)||a<0||isNaN(n)||n<0){throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers")}this.top=t;this.bottom=r;this.left=a;this.right=n};Hi.prototype.interpolate=function t(r,a,n){if(a.top!=null&&r.top!=null){this.top=e.number(r.top,a.top,n)}if(a.bottom!=null&&r.bottom!=null){this.bottom=e.number(r.bottom,a.bottom,n)}if(a.left!=null&&r.left!=null){this.left=e.number(r.left,a.left,n)}if(a.right!=null&&r.right!=null){this.right=e.number(r.right,a.right,n)}return this};Hi.prototype.getCenter=function t(r,a){var n=e.clamp((this.left+r-this.right)/2,0,r);var i=e.clamp((this.top+a-this.bottom)/2,0,a);return new e.Point(n,i)};Hi.prototype.equals=function e(t){return this.top===t.top&&this.bottom===t.bottom&&this.left===t.left&&this.right===t.right};Hi.prototype.clone=function e(){return new Hi(this.top,this.bottom,this.left,this.right)};Hi.prototype.toJSON=function e(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var qi=function t(r,a,n,i,o){this.tileSize=512;this.maxValidLatitude=85.051129;this._renderWorldCopies=o===undefined?true:o;this._minZoom=r||0;this._maxZoom=a||22;this._minPitch=n===undefined||n===null?0:n;this._maxPitch=i===undefined||i===null?60:i;this.setMaxBounds();this.width=0;this.height=0;this._center=new e.LngLat(0,0);this.zoom=0;this.angle=0;this._fov=.6435011087932844;this._pitch=0;this._unmodified=true;this._edgeInsets=new Hi;this._posMatrixCache={};this._alignedPosMatrixCache={}};var Gi={minZoom:{configurable:true},maxZoom:{configurable:true},minPitch:{configurable:true},maxPitch:{configurable:true},renderWorldCopies:{configurable:true},worldSize:{configurable:true},centerOffset:{configurable:true},size:{configurable:true},bearing:{configurable:true},pitch:{configurable:true},fov:{configurable:true},zoom:{configurable:true},center:{configurable:true},padding:{configurable:true},centerPoint:{configurable:true},unmodified:{configurable:true},point:{configurable:true}};qi.prototype.clone=function e(){var e=new qi(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);e.tileSize=this.tileSize;e.latRange=this.latRange;e.width=this.width;e.height=this.height;e._center=this._center;e.zoom=this.zoom;e.angle=this.angle;e._fov=this._fov;e._pitch=this._pitch;e._unmodified=this._unmodified;e._edgeInsets=this._edgeInsets.clone();e._calcMatrices();return e};Gi.minZoom.get=function(){return this._minZoom};Gi.minZoom.set=function(e){if(this._minZoom===e){return}this._minZoom=e;this.zoom=Math.max(this.zoom,e)};Gi.maxZoom.get=function(){return this._maxZoom};Gi.maxZoom.set=function(e){if(this._maxZoom===e){return}this._maxZoom=e;this.zoom=Math.min(this.zoom,e)};Gi.minPitch.get=function(){return this._minPitch};Gi.minPitch.set=function(e){if(this._minPitch===e){return}this._minPitch=e;this.pitch=Math.max(this.pitch,e)};Gi.maxPitch.get=function(){return this._maxPitch};Gi.maxPitch.set=function(e){if(this._maxPitch===e){return}this._maxPitch=e;this.pitch=Math.min(this.pitch,e)};Gi.renderWorldCopies.get=function(){return this._renderWorldCopies};Gi.renderWorldCopies.set=function(e){if(e===undefined){e=true}else if(e===null){e=false}this._renderWorldCopies=e};Gi.worldSize.get=function(){return this.tileSize*this.scale};Gi.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))};Gi.size.get=function(){return new e.Point(this.width,this.height)};Gi.bearing.get=function(){return-this.angle/Math.PI*180};Gi.bearing.set=function(t){var r=-e.wrap(t,-180,180)*Math.PI/180;if(this.angle===r){return}this._unmodified=false;this.angle=r;this._calcMatrices();this.rotationMatrix=e.create$2();e.rotate(this.rotationMatrix,this.rotationMatrix,this.angle)};Gi.pitch.get=function(){return this._pitch/Math.PI*180};Gi.pitch.set=function(t){var r=e.clamp(t,this.minPitch,this.maxPitch)/180*Math.PI;if(this._pitch===r){return}this._unmodified=false;this._pitch=r;this._calcMatrices()};Gi.fov.get=function(){return this._fov/Math.PI*180};Gi.fov.set=function(e){e=Math.max(.01,Math.min(60,e));if(this._fov===e){return}this._unmodified=false;this._fov=e/180*Math.PI;this._calcMatrices()};Gi.zoom.get=function(){return this._zoom};Gi.zoom.set=function(e){var t=Math.min(Math.max(e,this.minZoom),this.maxZoom);if(this._zoom===t){return}this._unmodified=false;this._zoom=t;this.scale=this.zoomScale(t);this.tileZoom=Math.floor(t);this.zoomFraction=t-this.tileZoom;this._constrain();this._calcMatrices()};Gi.center.get=function(){return this._center};Gi.center.set=function(e){if(e.lat===this._center.lat&&e.lng===this._center.lng){return}this._unmodified=false;this._center=e;this._constrain();this._calcMatrices()};Gi.padding.get=function(){return this._edgeInsets.toJSON()};Gi.padding.set=function(e){if(this._edgeInsets.equals(e)){return}this._unmodified=false;this._edgeInsets.interpolate(this._edgeInsets,e,1);this._calcMatrices()};Gi.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)};qi.prototype.isPaddingEqual=function e(t){return this._edgeInsets.equals(t)};qi.prototype.interpolatePadding=function e(t,r,a){this._unmodified=false;this._edgeInsets.interpolate(t,r,a);this._constrain();this._calcMatrices()};qi.prototype.coveringZoomLevel=function e(t){var r=(t.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/t.tileSize));return Math.max(0,r)};qi.prototype.getVisibleUnwrappedCoordinates=function t(r){var a=[new e.UnwrappedTileID(0,r)];if(this._renderWorldCopies){var n=this.pointCoordinate(new e.Point(0,0));var i=this.pointCoordinate(new e.Point(this.width,0));var o=this.pointCoordinate(new e.Point(this.width,this.height));var s=this.pointCoordinate(new e.Point(0,this.height));var l=Math.floor(Math.min(n.x,i.x,o.x,s.x));var u=Math.floor(Math.max(n.x,i.x,o.x,s.x));var c=1;for(var f=l-c;f<=u+c;f++){if(f===0){continue}a.push(new e.UnwrappedTileID(f,r))}}return a};qi.prototype.coveringTiles=function t(r){var a=this.coveringZoomLevel(r);var n=a;if(r.minzoom!==undefined&&a<r.minzoom){return[]}if(r.maxzoom!==undefined&&a>r.maxzoom){a=r.maxzoom}var i=e.MercatorCoordinate.fromLngLat(this.center);var o=Math.pow(2,a);var s=[o*i.x,o*i.y,0];var l=Ui.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,a);var u=r.minzoom||0;if(this.pitch<=60&&this._edgeInsets.top<.1){u=a}var c=3;var f=function(e){return{aabb:new Vi([e*o,0,0],[(e+1)*o,o,0]),zoom:0,x:0,y:0,wrap:e,fullyVisible:false}};var h=[];var p=[];var v=a;var d=r.reparseOverscaled?n:a;if(this._renderWorldCopies){for(var m=1;m<=3;m++){h.push(f(-m));h.push(f(m))}}h.push(f(0));while(h.length>0){var g=h.pop();var y=g.x;var x=g.y;var b=g.fullyVisible;if(!b){var _=g.aabb.intersects(l);if(_===0){continue}b=_===2}var w=g.aabb.distanceX(s);var T=g.aabb.distanceY(s);var k=Math.max(Math.abs(w),Math.abs(T));var M=c+(1<<v-g.zoom)-2;if(g.zoom===v||k>M&&g.zoom>=u){p.push({tileID:new e.OverscaledTileID(g.zoom===v?d:g.zoom,g.wrap,g.zoom,y,x),distanceSq:e.sqrLen([s[0]-.5-y,s[1]-.5-x])});continue}for(var A=0;A<4;A++){var S=(y<<1)+A%2;var E=(x<<1)+(A>>1);h.push({aabb:g.aabb.quadrant(A),zoom:g.zoom+1,x:S,y:E,wrap:g.wrap,fullyVisible:b})}}return p.sort((function(e,t){return e.distanceSq-t.distanceSq})).map((function(e){return e.tileID}))};qi.prototype.resize=function e(t,r){this.width=t;this.height=r;this.pixelsToGLUnits=[2/t,-2/r];this._constrain();this._calcMatrices()};Gi.unmodified.get=function(){return this._unmodified};qi.prototype.zoomScale=function e(t){return Math.pow(2,t)};qi.prototype.scaleZoom=function e(t){return Math.log(t)/Math.LN2};qi.prototype.project=function t(r){var a=e.clamp(r.lat,-this.maxValidLatitude,this.maxValidLatitude);return new e.Point(e.mercatorXfromLng(r.lng)*this.worldSize,e.mercatorYfromLat(a)*this.worldSize)};qi.prototype.unproject=function t(r){return new e.MercatorCoordinate(r.x/this.worldSize,r.y/this.worldSize).toLngLat()};Gi.point.get=function(){return this.project(this.center)};qi.prototype.setLocationAtPoint=function t(r,a){var n=this.pointCoordinate(a);var i=this.pointCoordinate(this.centerPoint);var o=this.locationCoordinate(r);var s=new e.MercatorCoordinate(o.x-(n.x-i.x),o.y-(n.y-i.y));this.center=this.coordinateLocation(s);if(this._renderWorldCopies){this.center=this.center.wrap()}};qi.prototype.locationPoint=function e(t){return this.coordinatePoint(this.locationCoordinate(t))};qi.prototype.pointLocation=function e(t){return this.coordinateLocation(this.pointCoordinate(t))};qi.prototype.locationCoordinate=function t(r){return e.MercatorCoordinate.fromLngLat(r)};qi.prototype.coordinateLocation=function e(t){return t.toLngLat()};qi.prototype.pointCoordinate=function t(r){var a=0;var n=[r.x,r.y,0,1];var i=[r.x,r.y,1,1];e.transformMat4(n,n,this.pixelMatrixInverse);e.transformMat4(i,i,this.pixelMatrixInverse);var o=n[3];var s=i[3];var l=n[0]/o;var u=i[0]/s;var c=n[1]/o;var f=i[1]/s;var h=n[2]/o;var p=i[2]/s;var v=h===p?0:(a-h)/(p-h);return new e.MercatorCoordinate(e.number(l,u,v)/this.worldSize,e.number(c,f,v)/this.worldSize)};qi.prototype.coordinatePoint=function t(r){var a=[r.x*this.worldSize,r.y*this.worldSize,0,1];e.transformMat4(a,a,this.pixelMatrix);return new e.Point(a[0]/a[3],a[1]/a[3])};qi.prototype.getBounds=function t(){return(new e.LngLatBounds).extend(this.pointLocation(new e.Point(0,0))).extend(this.pointLocation(new e.Point(this.width,0))).extend(this.pointLocation(new e.Point(this.width,this.height))).extend(this.pointLocation(new e.Point(0,this.height)))};qi.prototype.getMaxBounds=function t(){if(!this.latRange||this.latRange.length!==2||!this.lngRange||this.lngRange.length!==2){return null}return new e.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]])};qi.prototype.setMaxBounds=function e(t){if(t){this.lngRange=[t.getWest(),t.getEast()];this.latRange=[t.getSouth(),t.getNorth()];this._constrain()}else{this.lngRange=null;this.latRange=[-this.maxValidLatitude,this.maxValidLatitude]}};qi.prototype.calculatePosMatrix=function t(r,a){if(a===void 0)a=false;var n=r.key;var i=a?this._alignedPosMatrixCache:this._posMatrixCache;if(i[n]){return i[n]}var o=r.canonical;var s=this.worldSize/this.zoomScale(o.z);var l=o.x+Math.pow(2,o.z)*r.wrap;var u=e.identity(new Float64Array(16));e.translate(u,u,[l*s,o.y*s,0]);e.scale(u,u,[s/e.EXTENT,s/e.EXTENT,1]);e.multiply(u,a?this.alignedProjMatrix:this.projMatrix,u);i[n]=new Float32Array(u);return i[n]};qi.prototype.customLayerMatrix=function e(){return this.mercatorMatrix.slice()};qi.prototype._constrain=function t(){if(!this.center||!this.width||!this.height||this._constraining){return}this._constraining=true;var r=-90;var a=90;var n=-180;var i=180;var o,s,l,u;var c=this.size,f=this._unmodified;if(this.latRange){var h=this.latRange;r=e.mercatorYfromLat(h[1])*this.worldSize;a=e.mercatorYfromLat(h[0])*this.worldSize;o=a-r<c.y?c.y/(a-r):0}if(this.lngRange){var p=this.lngRange;n=e.mercatorXfromLng(p[0])*this.worldSize;i=e.mercatorXfromLng(p[1])*this.worldSize;s=i-n<c.x?c.x/(i-n):0}var v=this.point;var d=Math.max(s||0,o||0);if(d){this.center=this.unproject(new e.Point(s?(i+n)/2:v.x,o?(a+r)/2:v.y));this.zoom+=this.scaleZoom(d);this._unmodified=f;this._constraining=false;return}if(this.latRange){var m=v.y,g=c.y/2;if(m-g<r){u=r+g}if(m+g>a){u=a-g}}if(this.lngRange){var y=v.x,x=c.x/2;if(y-x<n){l=n+x}if(y+x>i){l=i-x}}if(l!==undefined||u!==undefined){this.center=this.unproject(new e.Point(l!==undefined?l:v.x,u!==undefined?u:v.y))}this._unmodified=f;this._constraining=false};qi.prototype._calcMatrices=function t(){if(!this.height){return}var r=this._fov/2;var a=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(r)*this.height;var n=Math.PI/2+this._pitch;var i=this._fov*(.5+a.y/this.height);var o=Math.sin(i)*this.cameraToCenterDistance/Math.sin(e.clamp(Math.PI-n-i,.01,Math.PI-.01));var s=this.point;var l=s.x,u=s.y;var c=Math.cos(Math.PI/2-this._pitch)*o+this.cameraToCenterDistance;var f=c*1.01;var h=this.height/50;var p=new Float64Array(16);e.perspective(p,this._fov,this.width/this.height,h,f);p[8]=-a.x*2/this.width;p[9]=a.y*2/this.height;e.scale(p,p,[1,-1,1]);e.translate(p,p,[0,0,-this.cameraToCenterDistance]);e.rotateX(p,p,this._pitch);e.rotateZ(p,p,this.angle);e.translate(p,p,[-l,-u,0]);this.mercatorMatrix=e.scale([],p,[this.worldSize,this.worldSize,this.worldSize]);e.scale(p,p,[1,1,e.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]);this.projMatrix=p;this.invProjMatrix=e.invert([],this.projMatrix);var v=this.width%2/2,d=this.height%2/2,m=Math.cos(this.angle),g=Math.sin(this.angle),y=l-Math.round(l)+m*v+g*d,x=u-Math.round(u)+m*d+g*v;var b=new Float64Array(p);e.translate(b,b,[y>.5?y-1:y,x>.5?x-1:x,0]);this.alignedProjMatrix=b;p=e.create();e.scale(p,p,[this.width/2,-this.height/2,1]);e.translate(p,p,[1,-1,0]);this.labelPlaneMatrix=p;p=e.create();e.scale(p,p,[1,-1,1]);e.translate(p,p,[-1,-1,0]);e.scale(p,p,[2/this.width,2/this.height,1]);this.glCoordMatrix=p;this.pixelMatrix=e.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix);p=e.invert(new Float64Array(16),this.pixelMatrix);if(!p){throw new Error("failed to invert matrix")}this.pixelMatrixInverse=p;this._posMatrixCache={};this._alignedPosMatrixCache={}};qi.prototype.maxPitchScaleFactor=function t(){if(!this.pixelMatrixInverse){return 1}var r=this.pointCoordinate(new e.Point(0,0));var a=[r.x*this.worldSize,r.y*this.worldSize,0,1];var n=e.transformMat4(a,a,this.pixelMatrix);return n[3]/this.cameraToCenterDistance};qi.prototype.getCameraPoint=function t(){var r=this._pitch;var a=Math.tan(r)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new e.Point(0,a))};qi.prototype.getCameraQueryGeometry=function t(r){var a=this.getCameraPoint();if(r.length===1){return[r[0],a]}else{var n=a.x;var i=a.y;var o=a.x;var s=a.y;for(var l=0,u=r;l<u.length;l+=1){var c=u[l];n=Math.min(n,c.x);i=Math.min(i,c.y);o=Math.max(o,c.x);s=Math.max(s,c.y)}return[new e.Point(n,i),new e.Point(o,i),new e.Point(o,s),new e.Point(n,s),new e.Point(n,i)]}};Object.defineProperties(qi.prototype,Gi);function Yi(e,t){var r=false;var a=null;var n=function(){a=null;if(r){e();a=setTimeout(n,t);r=false}};return function(){r=true;if(!a){n()}return a}}var Wi=function t(r){this._hashName=r&&encodeURIComponent(r);e.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this);this._updateHash=Yi(this._updateHashUnthrottled.bind(this),30*1e3/100)};Wi.prototype.addTo=function t(r){this._map=r;e.window.addEventListener("hashchange",this._onHashChange,false);this._map.on("moveend",this._updateHash);return this};Wi.prototype.remove=function t(){e.window.removeEventListener("hashchange",this._onHashChange,false);this._map.off("moveend",this._updateHash);clearTimeout(this._updateHash());delete this._map;return this};Wi.prototype.getHashString=function t(r){var a=this._map.getCenter(),n=Math.round(this._map.getZoom()*100)/100,i=Math.ceil((n*Math.LN2+Math.log(512/360/.5))/Math.LN10),o=Math.pow(10,i),s=Math.round(a.lng*o)/o,l=Math.round(a.lat*o)/o,u=this._map.getBearing(),c=this._map.getPitch();var f="";if(r){f+="/"+s+"/"+l+"/"+n}else{f+=n+"/"+l+"/"+s}if(u||c){f+="/"+Math.round(u*10)/10}if(c){f+="/"+Math.round(c)}if(this._hashName){var h=this._hashName;var p=false;var v=e.window.location.hash.slice(1).split("&").map((function(e){var t=e.split("=")[0];if(t===h){p=true;return t+"="+f}return e})).filter((function(e){return e}));if(!p){v.push(h+"="+f)}return"#"+v.join("&")}return"#"+f};Wi.prototype._getCurrentHash=function t(){var r=this;var a=e.window.location.hash.replace("#","");if(this._hashName){var n;a.split("&").map((function(e){return e.split("=")})).forEach((function(e){if(e[0]===r._hashName){n=e}}));return(n?n[1]||"":"").split("/")}return a.split("/")};Wi.prototype._onHashChange=function e(){var t=this._getCurrentHash();if(t.length>=3&&!t.some((function(e){return isNaN(e)}))){var r=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(t[3]||0):this._map.getBearing();this._map.jumpTo({center:[+t[2],+t[1]],zoom:+t[0],bearing:r,pitch:+(t[4]||0)});return true}return false};Wi.prototype._updateHashUnthrottled=function t(){var r=this.getHashString();try{e.window.history.replaceState(e.window.history.state,"",r)}catch(a){}};var Xi={linearity:.3,easing:e.bezier(0,0,.3,1)};var Zi=e.extend({deceleration:2500,maxSpeed:1400},Xi);var Ji=e.extend({deceleration:20,maxSpeed:1400},Xi);var Ki=e.extend({deceleration:1e3,maxSpeed:360},Xi);var Qi=e.extend({deceleration:1e3,maxSpeed:90},Xi);var $i=function e(t){this._map=t;this.clear()};$i.prototype.clear=function e(){this._inertiaBuffer=[]};$i.prototype.record=function t(r){this._drainInertiaBuffer();this._inertiaBuffer.push({time:e.browser.now(),settings:r})};$i.prototype._drainInertiaBuffer=function t(){var r=this._inertiaBuffer,a=e.browser.now(),n=160;while(r.length>0&&a-r[0].time>n){r.shift()}};$i.prototype._onMoveEnd=function t(r){this._drainInertiaBuffer();if(this._inertiaBuffer.length<2){return}var a={zoom:0,bearing:0,pitch:0,pan:new e.Point(0,0),pinchAround:undefined,around:undefined};for(var n=0,i=this._inertiaBuffer;n<i.length;n+=1){var o=i[n];var s=o.settings;a.zoom+=s.zoomDelta||0;a.bearing+=s.bearingDelta||0;a.pitch+=s.pitchDelta||0;if(s.panDelta){a.pan._add(s.panDelta)}if(s.around){a.around=s.around}if(s.pinchAround){a.pinchAround=s.pinchAround}}var l=this._inertiaBuffer[this._inertiaBuffer.length-1];var u=l.time-this._inertiaBuffer[0].time;var c={};if(a.pan.mag()){var f=to(a.pan.mag(),u,e.extend({},Zi,r||{}));c.offset=a.pan.mult(f.amount/a.pan.mag());c.center=this._map.transform.center;eo(c,f)}if(a.zoom){var h=to(a.zoom,u,Ji);c.zoom=this._map.transform.zoom+h.amount;eo(c,h)}if(a.bearing){var p=to(a.bearing,u,Ki);c.bearing=this._map.transform.bearing+e.clamp(p.amount,-179,179);eo(c,p)}if(a.pitch){var v=to(a.pitch,u,Qi);c.pitch=this._map.transform.pitch+v.amount;eo(c,v)}if(c.zoom||c.bearing){var d=a.pinchAround===undefined?a.around:a.pinchAround;c.around=d?this._map.unproject(d):this._map.getCenter()}this.clear();return e.extend(c,{noMoveStart:true})};function eo(e,t){if(!e.duration||e.duration<t.duration){e.duration=t.duration;e.easing=t.easing}}function to(t,r,a){var n=a.maxSpeed;var i=a.linearity;var o=a.deceleration;var s=e.clamp(t*i/(r/1e3),-n,n);var l=Math.abs(s)/(o*i);return{easing:a.easing,duration:l*1e3,amount:s*(l/2)}}var ro=function(t){function a(a,n,i,o){if(o===void 0)o={};var s=r.mousePos(n.getCanvasContainer(),i);var l=n.unproject(s);t.call(this,a,e.extend({point:s,lngLat:l,originalEvent:i},o));this._defaultPrevented=false;this.target=n}if(t)a.__proto__=t;a.prototype=Object.create(t&&t.prototype);a.prototype.constructor=a;var n={defaultPrevented:{configurable:true}};a.prototype.preventDefault=function e(){this._defaultPrevented=true};n.defaultPrevented.get=function(){return this._defaultPrevented};Object.defineProperties(a.prototype,n);return a}(e.Event);var ao=function(t){function a(a,n,i){var o=a==="touchend"?i.changedTouches:i.touches;var s=r.touchPos(n.getCanvasContainer(),o);var l=s.map((function(e){return n.unproject(e)}));var u=s.reduce((function(e,t,r,a){return e.add(t.div(a.length))}),new e.Point(0,0));var c=n.unproject(u);t.call(this,a,{points:s,point:u,lngLats:l,lngLat:c,originalEvent:i});this._defaultPrevented=false}if(t)a.__proto__=t;a.prototype=Object.create(t&&t.prototype);a.prototype.constructor=a;var n={defaultPrevented:{configurable:true}};a.prototype.preventDefault=function e(){this._defaultPrevented=true};n.defaultPrevented.get=function(){return this._defaultPrevented};Object.defineProperties(a.prototype,n);return a}(e.Event);var no=function(e){function t(t,r,a){e.call(this,t,{originalEvent:a});this._defaultPrevented=false}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;var r={defaultPrevented:{configurable:true}};t.prototype.preventDefault=function e(){this._defaultPrevented=true};r.defaultPrevented.get=function(){return this._defaultPrevented};Object.defineProperties(t.prototype,r);return t}(e.Event);var io=function e(t,r){this._map=t;this._clickTolerance=r.clickTolerance};io.prototype.reset=function e(){delete this._mousedownPos};io.prototype.wheel=function e(t){return this._firePreventable(new no(t.type,this._map,t))};io.prototype.mousedown=function e(t,r){this._mousedownPos=r;return this._firePreventable(new ro(t.type,this._map,t))};io.prototype.mouseup=function e(t){this._map.fire(new ro(t.type,this._map,t))};io.prototype.click=function e(t,r){if(this._mousedownPos&&this._mousedownPos.dist(r)>=this._clickTolerance){return}this._map.fire(new ro(t.type,this._map,t))};io.prototype.dblclick=function e(t){return this._firePreventable(new ro(t.type,this._map,t))};io.prototype.mouseover=function e(t){this._map.fire(new ro(t.type,this._map,t))};io.prototype.mouseout=function e(t){this._map.fire(new ro(t.type,this._map,t))};io.prototype.touchstart=function e(t){return this._firePreventable(new ao(t.type,this._map,t))};io.prototype.touchmove=function e(t){this._map.fire(new ao(t.type,this._map,t))};io.prototype.touchend=function e(t){this._map.fire(new ao(t.type,this._map,t))};io.prototype.touchcancel=function e(t){this._map.fire(new ao(t.type,this._map,t))};io.prototype._firePreventable=function e(t){this._map.fire(t);if(t.defaultPrevented){return{}}};io.prototype.isEnabled=function e(){return true};io.prototype.isActive=function e(){return false};io.prototype.enable=function e(){};io.prototype.disable=function e(){};var oo=function e(t){this._map=t};oo.prototype.reset=function e(){this._delayContextMenu=false;delete this._contextMenuEvent};oo.prototype.mousemove=function e(t){this._map.fire(new ro(t.type,this._map,t))};oo.prototype.mousedown=function e(){this._delayContextMenu=true};oo.prototype.mouseup=function e(){this._delayContextMenu=false;if(this._contextMenuEvent){this._map.fire(new ro("contextmenu",this._map,this._contextMenuEvent));delete this._contextMenuEvent}};oo.prototype.contextmenu=function e(t){if(this._delayContextMenu){this._contextMenuEvent=t}else{this._map.fire(new ro(t.type,this._map,t))}if(this._map.listens("contextmenu")){t.preventDefault()}};oo.prototype.isEnabled=function e(){return true};oo.prototype.isActive=function e(){return false};oo.prototype.enable=function e(){};oo.prototype.disable=function e(){};var so=function e(t,r){this._map=t;this._el=t.getCanvasContainer();this._container=t.getContainer();this._clickTolerance=r.clickTolerance||1};so.prototype.isEnabled=function e(){return!!this._enabled};so.prototype.isActive=function e(){return!!this._active};so.prototype.enable=function e(){if(this.isEnabled()){return}this._enabled=true};so.prototype.disable=function e(){if(!this.isEnabled()){return}this._enabled=false};so.prototype.mousedown=function e(t,a){if(!this.isEnabled()){return}if(!(t.shiftKey&&t.button===0)){return}r.disableDrag();this._startPos=this._lastPos=a;this._active=true};so.prototype.mousemoveWindow=function e(t,a){if(!this._active){return}var n=a;if(this._lastPos.equals(n)||!this._box&&n.dist(this._startPos)<this._clickTolerance){return}var i=this._startPos;this._lastPos=n;if(!this._box){this._box=r.create("div","mapboxgl-boxzoom",this._container);this._container.classList.add("mapboxgl-crosshair");this._fireEvent("boxzoomstart",t)}var o=Math.min(i.x,n.x),s=Math.max(i.x,n.x),l=Math.min(i.y,n.y),u=Math.max(i.y,n.y);r.setTransform(this._box,"translate("+o+"px,"+l+"px)");this._box.style.width=s-o+"px";this._box.style.height=u-l+"px"};so.prototype.mouseupWindow=function t(a,n){var i=this;if(!this._active){return}if(a.button!==0){return}var o=this._startPos,s=n;this.reset();r.suppressClick();if(o.x===s.x&&o.y===s.y){this._fireEvent("boxzoomcancel",a)}else{this._map.fire(new e.Event("boxzoomend",{originalEvent:a}));return{cameraAnimation:function(e){return e.fitScreenCoordinates(o,s,i._map.getBearing(),{linear:true})}}}};so.prototype.keydown=function e(t){if(!this._active){return}if(t.keyCode===27){this.reset();this._fireEvent("boxzoomcancel",t)}};so.prototype.reset=function e(){this._active=false;this._container.classList.remove("mapboxgl-crosshair");if(this._box){r.remove(this._box);this._box=null}r.enableDrag();delete this._startPos;delete this._lastPos};so.prototype._fireEvent=function t(r,a){return this._map.fire(new e.Event(r,{originalEvent:a}))};function lo(e,t){var r={};for(var a=0;a<e.length;a++){r[e[a].identifier]=t[a]}return r}function uo(t){var r=new e.Point(0,0);for(var a=0,n=t;a<n.length;a+=1){var i=n[a];r._add(i)}return r.div(t.length)}var co=500;var fo=500;var ho=30;var po=function e(t){this.reset();this.numTouches=t.numTouches};po.prototype.reset=function e(){delete this.centroid;delete this.startTime;delete this.touches;this.aborted=false};po.prototype.touchstart=function e(t,r,a){if(this.centroid||a.length>this.numTouches){this.aborted=true}if(this.aborted){return}if(this.startTime===undefined){this.startTime=t.timeStamp}if(a.length===this.numTouches){this.centroid=uo(r);this.touches=lo(a,r)}};po.prototype.touchmove=function e(t,r,a){if(this.aborted||!this.centroid){return}var n=lo(a,r);for(var i in this.touches){var o=this.touches[i];var s=n[i];if(!s||s.dist(o)>ho){this.aborted=true}}};po.prototype.touchend=function e(t,r,a){if(!this.centroid||t.timeStamp-this.startTime>fo){this.aborted=true}if(a.length===0){var n=!this.aborted&&this.centroid;this.reset();if(n){return n}}};var vo=function e(t){this.singleTap=new po(t);this.numTaps=t.numTaps;this.reset()};vo.prototype.reset=function e(){this.lastTime=Infinity;delete this.lastTap;this.count=0;this.singleTap.reset()};vo.prototype.touchstart=function e(t,r,a){this.singleTap.touchstart(t,r,a)};vo.prototype.touchmove=function e(t,r,a){this.singleTap.touchmove(t,r,a)};vo.prototype.touchend=function e(t,r,a){var n=this.singleTap.touchend(t,r,a);if(n){var i=t.timeStamp-this.lastTime<co;var o=!this.lastTap||this.lastTap.dist(n)<ho;if(!i||!o){this.reset()}this.count++;this.lastTime=t.timeStamp;this.lastTap=n;if(this.count===this.numTaps){this.reset();return n}}};var mo=function e(){this._zoomIn=new vo({numTouches:1,numTaps:2});this._zoomOut=new vo({numTouches:2,numTaps:1});this.reset()};mo.prototype.reset=function e(){this._active=false;this._zoomIn.reset();this._zoomOut.reset()};mo.prototype.touchstart=function e(t,r,a){this._zoomIn.touchstart(t,r,a);this._zoomOut.touchstart(t,r,a)};mo.prototype.touchmove=function e(t,r,a){this._zoomIn.touchmove(t,r,a);this._zoomOut.touchmove(t,r,a)};mo.prototype.touchend=function e(t,r,a){var n=this;var i=this._zoomIn.touchend(t,r,a);var o=this._zoomOut.touchend(t,r,a);if(i){this._active=true;t.preventDefault();setTimeout((function(){return n.reset()}),0);return{cameraAnimation:function(e){return e.easeTo({duration:300,zoom:e.getZoom()+1,around:e.unproject(i)},{originalEvent:t})}}}else if(o){this._active=true;t.preventDefault();setTimeout((function(){return n.reset()}),0);return{cameraAnimation:function(e){return e.easeTo({duration:300,zoom:e.getZoom()-1,around:e.unproject(o)},{originalEvent:t})}}}};mo.prototype.touchcancel=function e(){this.reset()};mo.prototype.enable=function e(){this._enabled=true};mo.prototype.disable=function e(){this._enabled=false;this.reset()};mo.prototype.isEnabled=function e(){return this._enabled};mo.prototype.isActive=function e(){return this._active};var go=0;var yo=2;var xo=function e(t){this.reset();this._clickTolerance=t.clickTolerance||1};xo.prototype.reset=function e(){this._active=false;this._moved=false;delete this._lastPoint;delete this._eventButton};xo.prototype._correctButton=function e(t,r){return false};xo.prototype._move=function e(t,r){return{}};xo.prototype.mousedown=function e(t,a){if(this._lastPoint){return}var n=r.mouseButton(t);if(!this._correctButton(t,n)){return}this._lastPoint=a;this._eventButton=n};xo.prototype.mousemoveWindow=function e(t,r){var a=this._lastPoint;if(!a){return}t.preventDefault();if(!this._moved&&r.dist(a)<this._clickTolerance){return}this._moved=true;this._lastPoint=r;return this._move(a,r)};xo.prototype.mouseupWindow=function e(t){var a=r.mouseButton(t);if(a!==this._eventButton){return}if(this._moved){r.suppressClick()}this.reset()};xo.prototype.enable=function e(){this._enabled=true};xo.prototype.disable=function e(){this._enabled=false;this.reset()};xo.prototype.isEnabled=function e(){return this._enabled};xo.prototype.isActive=function e(){return this._active};var bo=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype.mousedown=function t(r,a){e.prototype.mousedown.call(this,r,a);if(this._lastPoint){this._active=true}};t.prototype._correctButton=function e(t,r){return r===go&&!t.ctrlKey};t.prototype._move=function e(t,r){return{around:r,panDelta:r.sub(t)}};return t}(xo);var _o=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype._correctButton=function e(t,r){return r===go&&t.ctrlKey||r===yo};t.prototype._move=function e(t,r){var a=.8;var n=(r.x-t.x)*a;if(n){this._active=true;return{bearingDelta:n}}};t.prototype.contextmenu=function e(t){t.preventDefault()};return t}(xo);var wo=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype._correctButton=function e(t,r){return r===go&&t.ctrlKey||r===yo};t.prototype._move=function e(t,r){var a=-.5;var n=(r.y-t.y)*a;if(n){this._active=true;return{pitchDelta:n}}};t.prototype.contextmenu=function e(t){t.preventDefault()};return t}(xo);var To=function e(t){this._minTouches=1;this._clickTolerance=t.clickTolerance||1;this.reset()};To.prototype.reset=function t(){this._active=false;this._touches={};this._sum=new e.Point(0,0)};To.prototype.touchstart=function e(t,r,a){return this._calculateTransform(t,r,a)};To.prototype.touchmove=function e(t,r,a){if(!this._active){return}t.preventDefault();return this._calculateTransform(t,r,a)};To.prototype.touchend=function e(t,r,a){this._calculateTransform(t,r,a);if(this._active&&a.length<this._minTouches){this.reset()}};To.prototype.touchcancel=function e(){this.reset()};To.prototype._calculateTransform=function t(r,a,n){if(n.length>0){this._active=true}var i=lo(n,a);var o=new e.Point(0,0);var s=new e.Point(0,0);var l=0;for(var u in i){var c=i[u];var f=this._touches[u];if(f){o._add(c);s._add(c.sub(f));l++;i[u]=c}}this._touches=i;if(l<this._minTouches||!s.mag()){return}var h=s.div(l);this._sum._add(h);if(this._sum.mag()<this._clickTolerance){return}var p=o.div(l);return{around:p,panDelta:h}};To.prototype.enable=function e(){this._enabled=true};To.prototype.disable=function e(){this._enabled=false;this.reset()};To.prototype.isEnabled=function e(){return this._enabled};To.prototype.isActive=function e(){return this._active};var ko=function e(){this.reset()};ko.prototype.reset=function e(){this._active=false;delete this._firstTwoTouches};ko.prototype._start=function e(t){};ko.prototype._move=function e(t,r,a){return{}};ko.prototype.touchstart=function e(t,r,a){if(this._firstTwoTouches||a.length<2){return}this._firstTwoTouches=[a[0].identifier,a[1].identifier];this._start([r[0],r[1]])};ko.prototype.touchmove=function e(t,r,a){if(!this._firstTwoTouches){return}t.preventDefault();var n=this._firstTwoTouches;var i=n[0];var o=n[1];var s=Mo(a,r,i);var l=Mo(a,r,o);if(!s||!l){return}var u=this._aroundCenter?null:s.add(l).div(2);return this._move([s,l],u,t)};ko.prototype.touchend=function e(t,a,n){if(!this._firstTwoTouches){return}var i=this._firstTwoTouches;var o=i[0];var s=i[1];var l=Mo(n,a,o);var u=Mo(n,a,s);if(l&&u){return}if(this._active){r.suppressClick()}this.reset()};ko.prototype.touchcancel=function e(){this.reset()};ko.prototype.enable=function e(t){this._enabled=true;this._aroundCenter=!!t&&t.around==="center"};ko.prototype.disable=function e(){this._enabled=false;this.reset()};ko.prototype.isEnabled=function e(){return this._enabled};ko.prototype.isActive=function e(){return this._active};function Mo(e,t,r){for(var a=0;a<e.length;a++){if(e[a].identifier===r){return t[a]}}}var Ao=.1;function So(e,t){return Math.log(e/t)/Math.LN2}var Eo=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype.reset=function t(){e.prototype.reset.call(this);delete this._distance;delete this._startDistance};t.prototype._start=function e(t){this._startDistance=this._distance=t[0].dist(t[1])};t.prototype._move=function e(t,r){var a=this._distance;this._distance=t[0].dist(t[1]);if(!this._active&&Math.abs(So(this._distance,this._startDistance))<Ao){return}this._active=true;return{zoomDelta:So(this._distance,a),pinchAround:r}};return t}(ko);var Lo=25;function Co(e,t){return e.angleWith(t)*180/Math.PI}var Io=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype.reset=function t(){e.prototype.reset.call(this);delete this._minDiameter;delete this._startVector;delete this._vector};t.prototype._start=function e(t){this._startVector=this._vector=t[0].sub(t[1]);this._minDiameter=t[0].dist(t[1])};t.prototype._move=function e(t,r){var a=this._vector;this._vector=t[0].sub(t[1]);if(!this._active&&this._isBelowThreshold(this._vector)){return}this._active=true;return{bearingDelta:Co(this._vector,a),pinchAround:r}};t.prototype._isBelowThreshold=function e(t){this._minDiameter=Math.min(this._minDiameter,t.mag());var r=Math.PI*this._minDiameter;var a=Lo/r*360;var n=Co(t,this._startVector);return Math.abs(n)<a};return t}(ko);function Po(e){return Math.abs(e.y)>Math.abs(e.x)}var Oo=100;var zo=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype.reset=function t(){e.prototype.reset.call(this);this._valid=undefined;delete this._firstMove;delete this._lastPoints};t.prototype._start=function e(t){this._lastPoints=t;if(Po(t[0].sub(t[1]))){this._valid=false}};t.prototype._move=function e(t,r,a){var n=t[0].sub(this._lastPoints[0]);var i=t[1].sub(this._lastPoints[1]);this._valid=this.gestureBeginsVertically(n,i,a.timeStamp);if(!this._valid){return}this._lastPoints=t;this._active=true;var o=(n.y+i.y)/2;var s=-.5;return{pitchDelta:o*s}};t.prototype.gestureBeginsVertically=function e(t,r,a){if(this._valid!==undefined){return this._valid}var n=2;var i=t.mag()>=n;var o=r.mag()>=n;if(!i&&!o){return}if(!i||!o){if(this._firstMove===undefined){this._firstMove=a}if(a-this._firstMove<Oo){return undefined}else{return false}}var s=t.y>0===r.y>0;return Po(t)&&Po(r)&&s};return t}(ko);var Do={panStep:100,bearingStep:15,pitchStep:10};var Ro=function e(){var t=Do;this._panStep=t.panStep;this._bearingStep=t.bearingStep;this._pitchStep=t.pitchStep};Ro.prototype.reset=function e(){this._active=false};Ro.prototype.keydown=function e(t){var r=this;if(t.altKey||t.ctrlKey||t.metaKey){return}var a=0;var n=0;var i=0;var o=0;var s=0;switch(t.keyCode){case 61:case 107:case 171:case 187:a=1;break;case 189:case 109:case 173:a=-1;break;case 37:if(t.shiftKey){n=-1}else{t.preventDefault();o=-1}break;case 39:if(t.shiftKey){n=1}else{t.preventDefault();o=1}break;case 38:if(t.shiftKey){i=1}else{t.preventDefault();s=-1}break;case 40:if(t.shiftKey){i=-1}else{t.preventDefault();s=1}break;default:return}return{cameraAnimation:function(e){var l=e.getZoom();e.easeTo({duration:300,easeId:"keyboardHandler",easing:Fo,zoom:a?Math.round(l)+a*(t.shiftKey?2:1):l,bearing:e.getBearing()+n*r._bearingStep,pitch:e.getPitch()+i*r._pitchStep,offset:[-o*r._panStep,-s*r._panStep],center:e.getCenter()},{originalEvent:t})}}};Ro.prototype.enable=function e(){this._enabled=true};Ro.prototype.disable=function e(){this._enabled=false;this.reset()};Ro.prototype.isEnabled=function e(){return this._enabled};Ro.prototype.isActive=function e(){return this._active};function Fo(e){return e*(2-e)}var Bo=4.000244140625;var No=1/100;var jo=1/450;var Uo=2;var Vo=function t(r,a){this._map=r;this._el=r.getCanvasContainer();this._handler=a;this._delta=0;this._defaultZoomRate=No;this._wheelZoomRate=jo;e.bindAll(["_onWheel","_onTimeout","_onScrollFrame","_onScrollFinished"],this)};Vo.prototype.setZoomRate=function e(t){this._defaultZoomRate=t};Vo.prototype.setWheelZoomRate=function e(t){this._wheelZoomRate=t};Vo.prototype.isEnabled=function e(){return!!this._enabled};Vo.prototype.isActive=function e(){return!!this._active||this._finishTimeout!==undefined};Vo.prototype.isZooming=function e(){return!!this._zooming};Vo.prototype.enable=function e(t){if(this.isEnabled()){return}this._enabled=true;this._aroundCenter=t&&t.around==="center"};Vo.prototype.disable=function e(){if(!this.isEnabled()){return}this._enabled=false};Vo.prototype.wheel=function t(r){if(!this.isEnabled()){return}var a=r.deltaMode===e.window.WheelEvent.DOM_DELTA_LINE?r.deltaY*40:r.deltaY;var n=e.browser.now(),i=n-(this._lastWheelEventTime||0);this._lastWheelEventTime=n;if(a!==0&&a%Bo===0){this._type="wheel"}else if(a!==0&&Math.abs(a)<4){this._type="trackpad"}else if(i>400){this._type=null;this._lastValue=a;this._timeout=setTimeout(this._onTimeout,40,r)}else if(!this._type){this._type=Math.abs(i*a)<200?"trackpad":"wheel";if(this._timeout){clearTimeout(this._timeout);this._timeout=null;a+=this._lastValue}}if(r.shiftKey&&a){a=a/4}if(this._type){this._lastWheelEvent=r;this._delta-=a;if(!this._active){this._start(r)}}r.preventDefault()};Vo.prototype._onTimeout=function e(t){this._type="wheel";this._delta-=this._lastValue;if(!this._active){this._start(t)}};Vo.prototype._start=function t(a){if(!this._delta){return}if(this._frameId){this._frameId=null}this._active=true;if(!this.isZooming()){this._zooming=true}if(this._finishTimeout){clearTimeout(this._finishTimeout);delete this._finishTimeout}var n=r.mousePos(this._el,a);this._around=e.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(n));this._aroundPoint=this._map.transform.locationPoint(this._around);if(!this._frameId){this._frameId=true;this._handler._triggerRenderFrame()}};Vo.prototype.renderFrame=function e(){return this._onScrollFrame()};Vo.prototype._onScrollFrame=function t(){var r=this;if(!this._frameId){return}this._frameId=null;if(!this.isActive()){return}var a=this._map.transform;if(this._delta!==0){var n=this._type==="wheel"&&Math.abs(this._delta)>Bo?this._wheelZoomRate:this._defaultZoomRate;var i=Uo/(1+Math.exp(-Math.abs(this._delta*n)));if(this._delta<0&&i!==0){i=1/i}var o=typeof this._targetZoom==="number"?a.zoomScale(this._targetZoom):a.scale;this._targetZoom=Math.min(a.maxZoom,Math.max(a.minZoom,a.scaleZoom(o*i)));if(this._type==="wheel"){this._startZoom=a.zoom;this._easing=this._smoothOutEasing(200)}this._delta=0}var s=typeof this._targetZoom==="number"?this._targetZoom:a.zoom;var l=this._startZoom;var u=this._easing;var c=false;var f;if(this._type==="wheel"&&l&&u){var h=Math.min((e.browser.now()-this._lastWheelEventTime)/200,1);var p=u(h);f=e.number(l,s,p);if(h<1){if(!this._frameId){this._frameId=true}}else{c=true}}else{f=s;c=true}this._active=true;if(c){this._active=false;this._finishTimeout=setTimeout((function(){r._zooming=false;r._handler._triggerRenderFrame();delete r._targetZoom;delete r._finishTimeout}),200)}return{noInertia:true,needsRenderFrame:!c,zoomDelta:f-a.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}};Vo.prototype._smoothOutEasing=function t(r){var a=e.ease;if(this._prevEase){var n=this._prevEase,i=(e.browser.now()-n.start)/n.duration,o=n.easing(i+.01)-n.easing(i),s=.27/Math.sqrt(o*o+1e-4)*.01,l=Math.sqrt(.27*.27-s*s);a=e.bezier(s,l,.25,1)}this._prevEase={start:e.browser.now(),duration:r,easing:a};return a};Vo.prototype.reset=function e(){this._active=false};var Ho=function e(t,r){this._clickZoom=t;this._tapZoom=r};Ho.prototype.enable=function e(){this._clickZoom.enable();this._tapZoom.enable()};Ho.prototype.disable=function e(){this._clickZoom.disable();this._tapZoom.disable()};Ho.prototype.isEnabled=function e(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()};Ho.prototype.isActive=function e(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var qo=function e(){this.reset()};qo.prototype.reset=function e(){this._active=false};qo.prototype.dblclick=function e(t,r){t.preventDefault();return{cameraAnimation:function(e){e.easeTo({duration:300,zoom:e.getZoom()+(t.shiftKey?-1:1),around:e.unproject(r)},{originalEvent:t})}}};qo.prototype.enable=function e(){this._enabled=true};qo.prototype.disable=function e(){this._enabled=false;this.reset()};qo.prototype.isEnabled=function e(){return this._enabled};qo.prototype.isActive=function e(){return this._active};var Go=function e(){this._tap=new vo({numTouches:1,numTaps:1});this.reset()};Go.prototype.reset=function e(){this._active=false;delete this._swipePoint;delete this._swipeTouch;delete this._tapTime;this._tap.reset()};Go.prototype.touchstart=function e(t,r,a){if(this._swipePoint){return}if(this._tapTime&&t.timeStamp-this._tapTime>co){this.reset()}if(!this._tapTime){this._tap.touchstart(t,r,a)}else if(a.length>0){this._swipePoint=r[0];this._swipeTouch=a[0].identifier}};Go.prototype.touchmove=function e(t,r,a){if(!this._tapTime){this._tap.touchmove(t,r,a)}else if(this._swipePoint){if(a[0].identifier!==this._swipeTouch){return}var n=r[0];var i=n.y-this._swipePoint.y;this._swipePoint=n;t.preventDefault();this._active=true;return{zoomDelta:i/128}}};Go.prototype.touchend=function e(t,r,a){if(!this._tapTime){var n=this._tap.touchend(t,r,a);if(n){this._tapTime=t.timeStamp}}else if(this._swipePoint){if(a.length===0){this.reset()}}};Go.prototype.touchcancel=function e(){this.reset()};Go.prototype.enable=function e(){this._enabled=true};Go.prototype.disable=function e(){this._enabled=false;this.reset()};Go.prototype.isEnabled=function e(){return this._enabled};Go.prototype.isActive=function e(){return this._active};var Yo=function e(t,r,a){this._el=t;this._mousePan=r;this._touchPan=a};Yo.prototype.enable=function e(t){this._inertiaOptions=t||{};this._mousePan.enable();this._touchPan.enable();this._el.classList.add("mapboxgl-touch-drag-pan")};Yo.prototype.disable=function e(){this._mousePan.disable();this._touchPan.disable();this._el.classList.remove("mapboxgl-touch-drag-pan")};Yo.prototype.isEnabled=function e(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()};Yo.prototype.isActive=function e(){return this._mousePan.isActive()||this._touchPan.isActive()};var Wo=function e(t,r,a){this._pitchWithRotate=t.pitchWithRotate;this._mouseRotate=r;this._mousePitch=a};Wo.prototype.enable=function e(){this._mouseRotate.enable();if(this._pitchWithRotate){this._mousePitch.enable()}};Wo.prototype.disable=function e(){this._mouseRotate.disable();this._mousePitch.disable()};Wo.prototype.isEnabled=function e(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())};Wo.prototype.isActive=function e(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var Xo=function e(t,r,a,n){this._el=t;this._touchZoom=r;this._touchRotate=a;this._tapDragZoom=n;this._rotationDisabled=false;this._enabled=true};Xo.prototype.enable=function e(t){this._touchZoom.enable(t);if(!this._rotationDisabled){this._touchRotate.enable(t)}this._tapDragZoom.enable();this._el.classList.add("mapboxgl-touch-zoom-rotate")};Xo.prototype.disable=function e(){this._touchZoom.disable();this._touchRotate.disable();this._tapDragZoom.disable();this._el.classList.remove("mapboxgl-touch-zoom-rotate")};Xo.prototype.isEnabled=function e(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()};Xo.prototype.isActive=function e(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()};Xo.prototype.disableRotation=function e(){this._rotationDisabled=true;this._touchRotate.disable()};Xo.prototype.enableRotation=function e(){this._rotationDisabled=false;if(this._touchZoom.isEnabled()){this._touchRotate.enable()}};var Zo=function(e){return e.zoom||e.drag||e.pitch||e.rotate};var Jo=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;return t}(e.Event);function Ko(e){return e.panDelta&&e.panDelta.mag()||e.zoomDelta||e.bearingDelta||e.pitchDelta}var Qo=function t(a,n){this._map=a;this._el=this._map.getCanvasContainer();this._handlers=[];this._handlersById={};this._changes=[];this._inertia=new $i(a);this._bearingSnap=n.bearingSnap;this._previousActiveHandlers={};this._eventsInProgress={};this._addDefaultHandlers(n);e.bindAll(["handleEvent","handleWindowEvent"],this);var i=this._el;this._listeners=[[i,"touchstart",{passive:false}],[i,"touchmove",{passive:false}],[i,"touchend",undefined],[i,"touchcancel",undefined],[i,"mousedown",undefined],[i,"mousemove",undefined],[i,"mouseup",undefined],[e.window.document,"mousemove",{capture:true}],[e.window.document,"mouseup",undefined],[i,"mouseover",undefined],[i,"mouseout",undefined],[i,"dblclick",undefined],[i,"click",undefined],[i,"keydown",{capture:false}],[i,"keyup",undefined],[i,"wheel",{passive:false}],[i,"contextmenu",undefined],[e.window,"blur",undefined]];for(var o=0,s=this._listeners;o<s.length;o+=1){var l=s[o];var u=l[0];var c=l[1];var f=l[2];r.addEventListener(u,c,u===e.window.document?this.handleWindowEvent:this.handleEvent,f)}};Qo.prototype.destroy=function t(){for(var a=0,n=this._listeners;a<n.length;a+=1){var i=n[a];var o=i[0];var s=i[1];var l=i[2];r.removeEventListener(o,s,o===e.window.document?this.handleWindowEvent:this.handleEvent,l)}};Qo.prototype._addDefaultHandlers=function e(t){var r=this._map;var a=r.getCanvasContainer();this._add("mapEvent",new io(r,t));var n=r.boxZoom=new so(r,t);this._add("boxZoom",n);var i=new mo;var o=new qo;r.doubleClickZoom=new Ho(o,i);this._add("tapZoom",i);this._add("clickZoom",o);var s=new Go;this._add("tapDragZoom",s);var l=r.touchPitch=new zo;this._add("touchPitch",l);var u=new _o(t);var c=new wo(t);r.dragRotate=new Wo(t,u,c);this._add("mouseRotate",u,["mousePitch"]);this._add("mousePitch",c,["mouseRotate"]);var f=new bo(t);var h=new To(t);r.dragPan=new Yo(a,f,h);this._add("mousePan",f);this._add("touchPan",h,["touchZoom","touchRotate"]);var p=new Io;var v=new Eo;r.touchZoomRotate=new Xo(a,v,p,s);this._add("touchRotate",p,["touchPan","touchZoom"]);this._add("touchZoom",v,["touchPan","touchRotate"]);var d=r.scrollZoom=new Vo(r,this);this._add("scrollZoom",d,["mousePan"]);var m=r.keyboard=new Ro;this._add("keyboard",m);this._add("blockableMapEvent",new oo(r));for(var g=0,y=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];g<y.length;g+=1){var x=y[g];if(t.interactive&&t[x]){r[x].enable(t[x])}}};Qo.prototype._add=function e(t,r,a){this._handlers.push({handlerName:t,handler:r,allowed:a});this._handlersById[t]=r};Qo.prototype.stop=function e(){if(this._updatingCamera){return}for(var t=0,r=this._handlers;t<r.length;t+=1){var a=r[t];var n=a.handler;n.reset()}this._inertia.clear();this._fireEvents({},{});this._changes=[]};Qo.prototype.isActive=function e(){for(var t=0,r=this._handlers;t<r.length;t+=1){var a=r[t];var n=a.handler;if(n.isActive()){return true}}return false};Qo.prototype.isZooming=function e(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()};Qo.prototype.isRotating=function e(){return!!this._eventsInProgress.rotate};Qo.prototype.isMoving=function e(){return Boolean(Zo(this._eventsInProgress))||this.isZooming()};Qo.prototype._blockedByActive=function e(t,r,a){for(var n in t){if(n===a){continue}if(!r||r.indexOf(n)<0){return true}}return false};Qo.prototype.handleWindowEvent=function e(t){this.handleEvent(t,t.type+"Window")};Qo.prototype._getMapTouches=function e(t){var r=[];for(var a=0,n=t;a<n.length;a+=1){var i=n[a];var o=i.target;if(this._el.contains(o)){r.push(i)}}return r};Qo.prototype.handleEvent=function e(t,a){if(t.type==="blur"){this.stop();return}this._updatingCamera=true;var n=t.type==="renderFrame"?undefined:t;var i={needsRenderFrame:false};var o={};var s={};var l=t.touches?this._getMapTouches(t.touches):undefined;var u=l?r.touchPos(this._el,l):r.mousePos(this._el,t);for(var c=0,f=this._handlers;c<f.length;c+=1){var h=f[c];var p=h.handlerName;var v=h.handler;var d=h.allowed;if(!v.isEnabled()){continue}var m=void 0;if(this._blockedByActive(s,d,p)){v.reset()}else{if(v[a||t.type]){m=v[a||t.type](t,u,l);this.mergeHandlerResult(i,o,m,p,n);if(m&&m.needsRenderFrame){this._triggerRenderFrame()}}}if(m||v.isActive()){s[p]=v}}var g={};for(var y in this._previousActiveHandlers){if(!s[y]){g[y]=n}}this._previousActiveHandlers=s;if(Object.keys(g).length||Ko(i)){this._changes.push([i,o,g]);this._triggerRenderFrame()}if(Object.keys(s).length||Ko(i)){this._map._stop(true)}this._updatingCamera=false;var x=i.cameraAnimation;if(x){this._inertia.clear();this._fireEvents({},{});this._changes=[];x(this._map)}};Qo.prototype.mergeHandlerResult=function t(r,a,n,i,o){if(!n){return}e.extend(r,n);var s={handlerName:i,originalEvent:n.originalEvent||o};if(n.zoomDelta!==undefined){a.zoom=s}if(n.panDelta!==undefined){a.drag=s}if(n.pitchDelta!==undefined){a.pitch=s}if(n.bearingDelta!==undefined){a.rotate=s}};Qo.prototype._applyChanges=function t(){var r={};var a={};var n={};for(var i=0,o=this._changes;i<o.length;i+=1){var s=o[i];var l=s[0];var u=s[1];var c=s[2];if(l.panDelta){r.panDelta=(r.panDelta||new e.Point(0,0))._add(l.panDelta)}if(l.zoomDelta){r.zoomDelta=(r.zoomDelta||0)+l.zoomDelta}if(l.bearingDelta){r.bearingDelta=(r.bearingDelta||0)+l.bearingDelta}if(l.pitchDelta){r.pitchDelta=(r.pitchDelta||0)+l.pitchDelta}if(l.around!==undefined){r.around=l.around}if(l.pinchAround!==undefined){r.pinchAround=l.pinchAround}if(l.noInertia){r.noInertia=l.noInertia}e.extend(a,u);e.extend(n,c)}this._updateMapTransform(r,a,n);this._changes=[]};Qo.prototype._updateMapTransform=function e(t,r,a){var n=this._map;var i=n.transform;if(!Ko(t)){return this._fireEvents(r,a)}var o=t.panDelta;var s=t.zoomDelta;var l=t.bearingDelta;var u=t.pitchDelta;var c=t.around;var f=t.pinchAround;if(f!==undefined){c=f}n._stop(true);c=c||n.transform.centerPoint;var h=i.pointLocation(o?c.sub(o):c);if(l){i.bearing+=l}if(u){i.pitch+=u}if(s){i.zoom+=s}i.setLocationAtPoint(h,c);this._map._update();if(!t.noInertia){this._inertia.record(t)}this._fireEvents(r,a)};Qo.prototype._fireEvents=function t(r,a){var n=this;var i=Zo(this._eventsInProgress);var o=Zo(r);var s={};for(var l in r){var u=r[l];var c=u.originalEvent;if(!this._eventsInProgress[l]){s[l+"start"]=c}this._eventsInProgress[l]=r[l]}if(!i&&o){this._fireEvent("movestart",o.originalEvent)}for(var f in s){this._fireEvent(f,s[f])}if(r.rotate){this._bearingChanged=true}if(o){this._fireEvent("move",o.originalEvent)}for(var h in r){var p=r[h];var v=p.originalEvent;this._fireEvent(h,v)}var d={};var m;for(var g in this._eventsInProgress){var y=this._eventsInProgress[g];var x=y.handlerName;var b=y.originalEvent;if(!this._handlersById[x].isActive()){delete this._eventsInProgress[g];m=a[x]||b;d[g+"end"]=m}}for(var _ in d){this._fireEvent(_,d[_])}var w=Zo(this._eventsInProgress);if((i||o)&&!w){this._updatingCamera=true;var T=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions);var k=function(e){return e!==0&&-n._bearingSnap<e&&e<n._bearingSnap};if(T){if(k(T.bearing||this._map.getBearing())){T.bearing=0}this._map.easeTo(T,{originalEvent:m})}else{this._map.fire(new e.Event("moveend",{originalEvent:m}));if(k(this._map.getBearing())){this._map.resetNorth()}}this._bearingChanged=false;this._updatingCamera=false}};Qo.prototype._fireEvent=function t(r,a){this._map.fire(new e.Event(r,a?{originalEvent:a}:{}))};Qo.prototype._triggerRenderFrame=function e(){var t=this;if(this._frameId===undefined){this._frameId=this._map._requestRenderFrame((function(e){delete t._frameId;t.handleEvent(new Jo("renderFrame",{timeStamp:e}));t._applyChanges()}))}};var $o=function(t){function r(r,a){t.call(this);this._moving=false;this._zooming=false;this.transform=r;this._bearingSnap=a.bearingSnap;e.bindAll(["_renderFrameCallback"],this)}if(t)r.__proto__=t;r.prototype=Object.create(t&&t.prototype);r.prototype.constructor=r;r.prototype.getCenter=function t(){return new e.LngLat(this.transform.center.lng,this.transform.center.lat)};r.prototype.setCenter=function e(t,r){return this.jumpTo({center:t},r)};r.prototype.panBy=function t(r,a,n){r=e.Point.convert(r).mult(-1);return this.panTo(this.transform.center,e.extend({offset:r},a),n)};r.prototype.panTo=function t(r,a,n){return this.easeTo(e.extend({center:r},a),n)};r.prototype.getZoom=function e(){return this.transform.zoom};r.prototype.setZoom=function e(t,r){this.jumpTo({zoom:t},r);return this};r.prototype.zoomTo=function t(r,a,n){return this.easeTo(e.extend({zoom:r},a),n)};r.prototype.zoomIn=function e(t,r){this.zoomTo(this.getZoom()+1,t,r);return this};r.prototype.zoomOut=function e(t,r){this.zoomTo(this.getZoom()-1,t,r);return this};r.prototype.getBearing=function e(){return this.transform.bearing};r.prototype.setBearing=function e(t,r){this.jumpTo({bearing:t},r);return this};r.prototype.getPadding=function e(){return this.transform.padding};r.prototype.setPadding=function e(t,r){this.jumpTo({padding:t},r);return this};r.prototype.rotateTo=function t(r,a,n){return this.easeTo(e.extend({bearing:r},a),n)};r.prototype.resetNorth=function t(r,a){this.rotateTo(0,e.extend({duration:1e3},r),a);return this};r.prototype.resetNorthPitch=function t(r,a){this.easeTo(e.extend({bearing:0,pitch:0,duration:1e3},r),a);return this};r.prototype.snapToNorth=function e(t,r){if(Math.abs(this.getBearing())<this._bearingSnap){return this.resetNorth(t,r)}return this};r.prototype.getPitch=function e(){return this.transform.pitch};r.prototype.setPitch=function e(t,r){this.jumpTo({pitch:t},r);return this};r.prototype.cameraForBounds=function t(r,a){r=e.LngLatBounds.convert(r);return this._cameraForBoxAndBearing(r.getNorthWest(),r.getSouthEast(),0,a)};r.prototype._cameraForBoxAndBearing=function t(r,a,n,i){var o={top:0,bottom:0,right:0,left:0};i=e.extend({padding:o,offset:[0,0],maxZoom:this.transform.maxZoom},i);if(typeof i.padding==="number"){var s=i.padding;i.padding={top:s,bottom:s,right:s,left:s}}i.padding=e.extend(o,i.padding);var l=this.transform;var u=l.padding;var c=l.project(e.LngLat.convert(r));var f=l.project(e.LngLat.convert(a));var h=c.rotate(-n*Math.PI/180);var p=f.rotate(-n*Math.PI/180);var v=new e.Point(Math.max(h.x,p.x),Math.max(h.y,p.y));var d=new e.Point(Math.min(h.x,p.x),Math.min(h.y,p.y));var m=v.sub(d);var g=(l.width-(u.left+u.right+i.padding.left+i.padding.right))/m.x;var y=(l.height-(u.top+u.bottom+i.padding.top+i.padding.bottom))/m.y;if(y<0||g<0){e.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");return}var x=Math.min(l.scaleZoom(l.scale*Math.min(g,y)),i.maxZoom);var b=e.Point.convert(i.offset);var _=(i.padding.left-i.padding.right)/2;var w=(i.padding.top-i.padding.bottom)/2;var T=new e.Point(b.x+_,b.y+w);var k=T.mult(l.scale/l.zoomScale(x));var M=l.unproject(c.add(f).div(2).sub(k));return{center:M,zoom:x,bearing:n}};r.prototype.fitBounds=function e(t,r,a){return this._fitInternal(this.cameraForBounds(t,r),r,a)};r.prototype.fitScreenCoordinates=function t(r,a,n,i,o){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(e.Point.convert(r)),this.transform.pointLocation(e.Point.convert(a)),n,i),i,o)};r.prototype._fitInternal=function t(r,a,n){if(!r){return this}a=e.extend(r,a);delete a.padding;return a.linear?this.easeTo(a,n):this.flyTo(a,n)};r.prototype.jumpTo=function t(r,a){this.stop();var n=this.transform;var i=false,o=false,s=false;if("zoom"in r&&n.zoom!==+r.zoom){i=true;n.zoom=+r.zoom}if(r.center!==undefined){n.center=e.LngLat.convert(r.center)}if("bearing"in r&&n.bearing!==+r.bearing){o=true;n.bearing=+r.bearing}if("pitch"in r&&n.pitch!==+r.pitch){s=true;n.pitch=+r.pitch}if(r.padding!=null&&!n.isPaddingEqual(r.padding)){n.padding=r.padding}this.fire(new e.Event("movestart",a)).fire(new e.Event("move",a));if(i){this.fire(new e.Event("zoomstart",a)).fire(new e.Event("zoom",a)).fire(new e.Event("zoomend",a))}if(o){this.fire(new e.Event("rotatestart",a)).fire(new e.Event("rotate",a)).fire(new e.Event("rotateend",a))}if(s){this.fire(new e.Event("pitchstart",a)).fire(new e.Event("pitch",a)).fire(new e.Event("pitchend",a))}return this.fire(new e.Event("moveend",a))};r.prototype.easeTo=function t(r,a){var n=this;this._stop(false,r.easeId);r=e.extend({offset:[0,0],duration:500,easing:e.ease},r);if(r.animate===false||!r.essential&&e.browser.prefersReducedMotion){r.duration=0}var i=this.transform,o=this.getZoom(),s=this.getBearing(),l=this.getPitch(),u=this.getPadding(),c="zoom"in r?+r.zoom:o,f="bearing"in r?this._normalizeBearing(r.bearing,s):s,h="pitch"in r?+r.pitch:l,p="padding"in r?r.padding:i.padding;var v=e.Point.convert(r.offset);var d=i.centerPoint.add(v);var m=i.pointLocation(d);var g=e.LngLat.convert(r.center||m);this._normalizeCenter(g);var y=i.project(m);var x=i.project(g).sub(y);var b=i.zoomScale(c-o);var _,w;if(r.around){_=e.LngLat.convert(r.around);w=i.locationPoint(_)}var T={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};this._zooming=this._zooming||c!==o;this._rotating=this._rotating||s!==f;this._pitching=this._pitching||h!==l;this._padding=!i.isPaddingEqual(p);this._easeId=r.easeId;this._prepareEase(a,r.noMoveStart,T);clearTimeout(this._easeEndTimeoutID);this._ease((function(t){if(n._zooming){i.zoom=e.number(o,c,t)}if(n._rotating){i.bearing=e.number(s,f,t)}if(n._pitching){i.pitch=e.number(l,h,t)}if(n._padding){i.interpolatePadding(u,p,t);d=i.centerPoint.add(v)}if(_){i.setLocationAtPoint(_,w)}else{var r=i.zoomScale(i.zoom-o);var m=c>o?Math.min(2,b):Math.max(.5,b);var g=Math.pow(m,1-t);var T=i.unproject(y.add(x.mult(t*g)).mult(r));i.setLocationAtPoint(i.renderWorldCopies?T.wrap():T,d)}n._fireMoveEvents(a)}),(function(e){n._afterEase(a,e)}),r);return this};r.prototype._prepareEase=function t(r,a,n){if(n===void 0)n={};this._moving=true;if(!a&&!n.moving){this.fire(new e.Event("movestart",r))}if(this._zooming&&!n.zooming){this.fire(new e.Event("zoomstart",r))}if(this._rotating&&!n.rotating){this.fire(new e.Event("rotatestart",r))}if(this._pitching&&!n.pitching){this.fire(new e.Event("pitchstart",r))}};r.prototype._fireMoveEvents=function t(r){this.fire(new e.Event("move",r));if(this._zooming){this.fire(new e.Event("zoom",r))}if(this._rotating){this.fire(new e.Event("rotate",r))}if(this._pitching){this.fire(new e.Event("pitch",r))}};r.prototype._afterEase=function t(r,a){if(this._easeId&&a&&this._easeId===a){return}delete this._easeId;var n=this._zooming;var i=this._rotating;var o=this._pitching;this._moving=false;this._zooming=false;this._rotating=false;this._pitching=false;this._padding=false;if(n){this.fire(new e.Event("zoomend",r))}if(i){this.fire(new e.Event("rotateend",r))}if(o){this.fire(new e.Event("pitchend",r))}this.fire(new e.Event("moveend",r))};r.prototype.flyTo=function t(r,a){var n=this;if(!r.essential&&e.browser.prefersReducedMotion){var i=e.pick(r,["center","zoom","bearing","pitch","around"]);return this.jumpTo(i,a)}this.stop();r=e.extend({offset:[0,0],speed:1.2,curve:1.42,easing:e.ease},r);var o=this.transform,s=this.getZoom(),l=this.getBearing(),u=this.getPitch(),c=this.getPadding();var f="zoom"in r?e.clamp(+r.zoom,o.minZoom,o.maxZoom):s;var h="bearing"in r?this._normalizeBearing(r.bearing,l):l;var p="pitch"in r?+r.pitch:u;var v="padding"in r?r.padding:o.padding;var d=o.zoomScale(f-s);var m=e.Point.convert(r.offset);var g=o.centerPoint.add(m);var y=o.pointLocation(g);var x=e.LngLat.convert(r.center||y);this._normalizeCenter(x);var b=o.project(y);var _=o.project(x).sub(b);var w=r.curve;var T=Math.max(o.width,o.height),k=T/d,M=_.mag();if("minZoom"in r){var A=e.clamp(Math.min(r.minZoom,s,f),o.minZoom,o.maxZoom);var S=T/o.zoomScale(A-s);w=Math.sqrt(S/M*2)}var E=w*w;function L(e){var t=(k*k-T*T+(e?-1:1)*E*E*M*M)/(2*(e?k:T)*E*M);return Math.log(Math.sqrt(t*t+1)-t)}function C(e){return(Math.exp(e)-Math.exp(-e))/2}function I(e){return(Math.exp(e)+Math.exp(-e))/2}function P(e){return C(e)/I(e)}var O=L(0);var z=function(e){return I(O)/I(O+w*e)};var D=function(e){return T*((I(O)*P(O+w*e)-C(O))/E)/M};var R=(L(1)-O)/w;if(Math.abs(M)<1e-6||!isFinite(R)){if(Math.abs(T-k)<1e-6){return this.easeTo(r,a)}var F=k<T?-1:1;R=Math.abs(Math.log(k/T))/w;D=function(){return 0};z=function(e){return Math.exp(F*w*e)}}if("duration"in r){r.duration=+r.duration}else{var B="screenSpeed"in r?+r.screenSpeed/w:+r.speed;r.duration=1e3*R/B}if(r.maxDuration&&r.duration>r.maxDuration){r.duration=0}this._zooming=true;this._rotating=l!==h;this._pitching=p!==u;this._padding=!o.isPaddingEqual(v);this._prepareEase(a,false);this._ease((function(t){var r=t*R;var i=1/z(r);o.zoom=t===1?f:s+o.scaleZoom(i);if(n._rotating){o.bearing=e.number(l,h,t)}if(n._pitching){o.pitch=e.number(u,p,t)}if(n._padding){o.interpolatePadding(c,v,t);g=o.centerPoint.add(m)}var d=t===1?x:o.unproject(b.add(_.mult(D(r))).mult(i));o.setLocationAtPoint(o.renderWorldCopies?d.wrap():d,g);n._fireMoveEvents(a)}),(function(){return n._afterEase(a)}),r);return this};r.prototype.isEasing=function e(){return!!this._easeFrameId};r.prototype.stop=function e(){return this._stop()};r.prototype._stop=function e(t,r){if(this._easeFrameId){this._cancelRenderFrame(this._easeFrameId);delete this._easeFrameId;delete this._onEaseFrame}if(this._onEaseEnd){var a=this._onEaseEnd;delete this._onEaseEnd;a.call(this,r)}if(!t){var n=this.handlers;if(n){n.stop()}}return this};r.prototype._ease=function t(r,a,n){if(n.animate===false||n.duration===0){r(1);a()}else{this._easeStart=e.browser.now();this._easeOptions=n;this._onEaseFrame=r;this._onEaseEnd=a;this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback)}};r.prototype._renderFrameCallback=function t(){var r=Math.min((e.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(r));if(r<1){this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback)}else{this.stop()}};r.prototype._normalizeBearing=function t(r,a){r=e.wrap(r,-180,180);var n=Math.abs(r-a);if(Math.abs(r-360-a)<n){r-=360}if(Math.abs(r+360-a)<n){r+=360}return r};r.prototype._normalizeCenter=function e(t){var r=this.transform;if(!r.renderWorldCopies||r.lngRange){return}var a=t.lng-r.center.lng;t.lng+=a>180?-360:a<-180?360:0};return r}(e.Evented);var es=function t(r){if(r===void 0)r={};this.options=r;e.bindAll(["_updateEditLink","_updateData","_updateCompact"],this)};es.prototype.getDefaultPosition=function e(){return"bottom-right"};es.prototype.onAdd=function e(t){var a=this.options&&this.options.compact;this._map=t;this._container=r.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib");this._innerContainer=r.create("div","mapboxgl-ctrl-attrib-inner",this._container);if(a){this._container.classList.add("mapboxgl-compact")}this._updateAttributions();this._updateEditLink();this._map.on("styledata",this._updateData);this._map.on("sourcedata",this._updateData);this._map.on("moveend",this._updateEditLink);if(a===undefined){this._map.on("resize",this._updateCompact);this._updateCompact()}return this._container};es.prototype.onRemove=function e(){r.remove(this._container);this._map.off("styledata",this._updateData);this._map.off("sourcedata",this._updateData);this._map.off("moveend",this._updateEditLink);this._map.off("resize",this._updateCompact);this._map=undefined;this._attribHTML=undefined};es.prototype._updateEditLink=function t(){var r=this._editLink;if(!r){r=this._editLink=this._container.querySelector(".mapbox-improve-map")}var a=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||e.config.ACCESS_TOKEN}];if(r){var n=a.reduce((function(e,t,r){if(t.value){e+=t.key+"="+t.value+(r<a.length-1?"&":"")}return e}),"?");r.href=e.config.FEEDBACK_URL+"/"+n+(this._map._hash?this._map._hash.getHashString(true):"");r.rel="noopener nofollow"}};es.prototype._updateData=function e(t){if(t&&(t.sourceDataType==="metadata"||t.dataType==="style")){this._updateAttributions();this._updateEditLink()}};es.prototype._updateAttributions=function e(){if(!this._map.style){return}var t=[];if(this.options.customAttribution){if(Array.isArray(this.options.customAttribution)){t=t.concat(this.options.customAttribution.map((function(e){if(typeof e!=="string"){return""}return e})))}else if(typeof this.options.customAttribution==="string"){t.push(this.options.customAttribution)}}if(this._map.style.stylesheet){var r=this._map.style.stylesheet;this.styleOwner=r.owner;this.styleId=r.id}var a=this._map.style.sourceCaches;for(var n in a){var i=a[n];if(i.used){var o=i.getSource();if(o.attribution&&t.indexOf(o.attribution)<0){t.push(o.attribution)}}}t.sort((function(e,t){return e.length-t.length}));t=t.filter((function(e,r){for(var a=r+1;a<t.length;a++){if(t[a].indexOf(e)>=0){return false}}return true}));var s=t.join(" | ");if(s===this._attribHTML){return}this._attribHTML=s;if(t.length){this._innerContainer.innerHTML=s;this._container.classList.remove("mapboxgl-attrib-empty")}else{this._container.classList.add("mapboxgl-attrib-empty")}this._editLink=null};es.prototype._updateCompact=function e(){if(this._map.getCanvasContainer().offsetWidth<=640){this._container.classList.add("mapboxgl-compact")}else{this._container.classList.remove("mapboxgl-compact")}};var ts=function t(){e.bindAll(["_updateLogo"],this);e.bindAll(["_updateCompact"],this)};ts.prototype.onAdd=function e(t){this._map=t;this._container=r.create("div","mapboxgl-ctrl");var a=r.create("a","mapboxgl-ctrl-logo");a.target="_blank";a.rel="noopener nofollow";a.href="https://www.mapbox.com/";a.setAttribute("aria-label",this._map._getUIString("LogoControl.Title"));a.setAttribute("rel","noopener nofollow");this._container.appendChild(a);this._container.style.display="none";this._map.on("sourcedata",this._updateLogo);this._updateLogo();this._map.on("resize",this._updateCompact);this._updateCompact();return this._container};ts.prototype.onRemove=function e(){r.remove(this._container);this._map.off("sourcedata",this._updateLogo);this._map.off("resize",this._updateCompact)};ts.prototype.getDefaultPosition=function e(){return"bottom-left"};ts.prototype._updateLogo=function e(t){if(!t||t.sourceDataType==="metadata"){this._container.style.display=this._logoRequired()?"block":"none"}};ts.prototype._logoRequired=function e(){if(!this._map.style){return}var t=this._map.style.sourceCaches;for(var r in t){var a=t[r].getSource();if(a.mapbox_logo){return true}}return false};ts.prototype._updateCompact=function e(){var t=this._container.children;if(t.length){var r=t[0];if(this._map.getCanvasContainer().offsetWidth<250){r.classList.add("mapboxgl-compact")}else{r.classList.remove("mapboxgl-compact")}}};var rs=function e(){this._queue=[];this._id=0;this._cleared=false;this._currentlyRunning=false};rs.prototype.add=function e(t){var r=++this._id;var a=this._queue;a.push({callback:t,id:r,cancelled:false});return r};rs.prototype.remove=function e(t){var r=this._currentlyRunning;var a=r?this._queue.concat(r):this._queue;for(var n=0,i=a;n<i.length;n+=1){var o=i[n];if(o.id===t){o.cancelled=true;return}}};rs.prototype.run=function e(t){if(t===void 0)t=0;var r=this._currentlyRunning=this._queue;this._queue=[];for(var a=0,n=r;a<n.length;a+=1){var i=n[a];if(i.cancelled){continue}i.callback(t);if(this._cleared){break}}this._cleared=false;this._currentlyRunning=false};rs.prototype.clear=function e(){if(this._currentlyRunning){this._cleared=true}this._queue=[]};var as={"FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"};var ns=e.window.HTMLImageElement;var is=e.window.HTMLElement;var os=e.window.ImageBitmap;var ss=-2;var ls=22;var us=0;var cs=60;var fs={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:ss,maxZoom:ls,minPitch:us,maxPitch:cs,interactive:true,scrollZoom:true,boxZoom:true,dragRotate:true,dragPan:true,keyboard:true,doubleClickZoom:true,touchZoomRotate:true,touchPitch:true,bearingSnap:7,clickTolerance:3,pitchWithRotate:true,hash:false,attributionControl:true,failIfMajorPerformanceCaveat:false,preserveDrawingBuffer:false,trackResize:true,renderWorldCopies:true,refreshExpiredTiles:true,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:true};var hs=function(a){function n(t){var r=this;t=e.extend({},fs,t);if(t.minZoom!=null&&t.maxZoom!=null&&t.minZoom>t.maxZoom){throw new Error("maxZoom must be greater than or equal to minZoom")}if(t.minPitch!=null&&t.maxPitch!=null&&t.minPitch>t.maxPitch){throw new Error("maxPitch must be greater than or equal to minPitch")}if(t.minPitch!=null&&t.minPitch<us){throw new Error("minPitch must be greater than or equal to "+us)}if(t.maxPitch!=null&&t.maxPitch>cs){throw new Error("maxPitch must be less than or equal to "+cs)}var n=new qi(t.minZoom,t.maxZoom,t.minPitch,t.maxPitch,t.renderWorldCopies);a.call(this,n,t);this._interactive=t.interactive;this._maxTileCacheSize=t.maxTileCacheSize;this._failIfMajorPerformanceCaveat=t.failIfMajorPerformanceCaveat;this._preserveDrawingBuffer=t.preserveDrawingBuffer;this._antialias=t.antialias;this._trackResize=t.trackResize;this._bearingSnap=t.bearingSnap;this._refreshExpiredTiles=t.refreshExpiredTiles;this._fadeDuration=t.fadeDuration;this._crossSourceCollisions=t.crossSourceCollisions;this._crossFadingFactor=1;this._collectResourceTiming=t.collectResourceTiming;this._renderTaskQueue=new rs;this._controls=[];this._mapId=e.uniqueId();this._locale=e.extend({},as,t.locale);this._requestManager=new e.RequestManager(t.transformRequest,t.accessToken);if(typeof t.container==="string"){this._container=e.window.document.getElementById(t.container);if(!this._container){throw new Error("Container '"+t.container+"' not found.")}}else if(t.container instanceof is){this._container=t.container}else{throw new Error("Invalid type: 'container' must be a String or HTMLElement.")}if(t.maxBounds){this.setMaxBounds(t.maxBounds)}e.bindAll(["_onWindowOnline","_onWindowResize","_contextLost","_contextRestored"],this);this._setupContainer();this._setupPainter();if(this.painter===undefined){throw new Error("Failed to initialize WebGL.")}this.on("move",(function(){return r._update(false)}));this.on("moveend",(function(){return r._update(false)}));this.on("zoom",(function(){return r._update(true)}));if(typeof e.window!=="undefined"){e.window.addEventListener("online",this._onWindowOnline,false);e.window.addEventListener("resize",this._onWindowResize,false)}this.handlers=new Qo(this,t);var i=typeof t.hash==="string"&&t.hash||undefined;this._hash=t.hash&&new Wi(i).addTo(this);if(!this._hash||!this._hash._onHashChange()){this.jumpTo({center:t.center,zoom:t.zoom,bearing:t.bearing,pitch:t.pitch});if(t.bounds){this.resize();this.fitBounds(t.bounds,e.extend({},t.fitBoundsOptions,{duration:0}))}}this.resize();this._localIdeographFontFamily=t.localIdeographFontFamily;if(t.style){this.setStyle(t.style,{localIdeographFontFamily:t.localIdeographFontFamily})}if(t.attributionControl){this.addControl(new es({customAttribution:t.customAttribution}))}this.addControl(new ts,t.logoPosition);this.on("style.load",(function(){if(r.transform.unmodified){r.jumpTo(r.style.stylesheet)}}));this.on("data",(function(t){r._update(t.dataType==="style");r.fire(new e.Event(t.dataType+"data",t))}));this.on("dataloading",(function(t){r.fire(new e.Event(t.dataType+"dataloading",t))}))}if(a)n.__proto__=a;n.prototype=Object.create(a&&a.prototype);n.prototype.constructor=n;var i={showTileBoundaries:{configurable:true},showPadding:{configurable:true},showCollisionBoxes:{configurable:true},showOverdrawInspector:{configurable:true},repaint:{configurable:true},vertices:{configurable:true},version:{configurable:true}};n.prototype._getMapId=function e(){return this._mapId};n.prototype.addControl=function t(r,a){if(a===undefined&&r.getDefaultPosition){a=r.getDefaultPosition()}if(a===undefined){a="top-right"}if(!r||!r.onAdd){return this.fire(new e.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")))}var n=r.onAdd(this);this._controls.push(r);var i=this._controlPositions[a];if(a.indexOf("bottom")!==-1){i.insertBefore(n,i.firstChild)}else{i.appendChild(n)}return this};n.prototype.removeControl=function t(r){if(!r||!r.onRemove){return this.fire(new e.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")))}var a=this._controls.indexOf(r);if(a>-1){this._controls.splice(a,1)}r.onRemove(this);return this};n.prototype.resize=function t(r){var a=this._containerDimensions();var n=a[0];var i=a[1];this._resizeCanvas(n,i);this.transform.resize(n,i);this.painter.resize(n,i);var o=!this._moving;if(o){this.stop();this.fire(new e.Event("movestart",r)).fire(new e.Event("move",r))}this.fire(new e.Event("resize",r));if(o){this.fire(new e.Event("moveend",r))}return this};n.prototype.getBounds=function e(){return this.transform.getBounds()};n.prototype.getMaxBounds=function e(){return this.transform.getMaxBounds()};n.prototype.setMaxBounds=function t(r){this.transform.setMaxBounds(e.LngLatBounds.convert(r));return this._update()};n.prototype.setMinZoom=function e(t){t=t===null||t===undefined?ss:t;if(t>=ss&&t<=this.transform.maxZoom){this.transform.minZoom=t;this._update();if(this.getZoom()<t){this.setZoom(t)}return this}else{throw new Error("minZoom must be between "+ss+" and the current maxZoom, inclusive")}};n.prototype.getMinZoom=function e(){return this.transform.minZoom};n.prototype.setMaxZoom=function e(t){t=t===null||t===undefined?ls:t;if(t>=this.transform.minZoom){this.transform.maxZoom=t;this._update();if(this.getZoom()>t){this.setZoom(t)}return this}else{throw new Error("maxZoom must be greater than the current minZoom")}};n.prototype.getMaxZoom=function e(){return this.transform.maxZoom};n.prototype.setMinPitch=function e(t){t=t===null||t===undefined?us:t;if(t<us){throw new Error("minPitch must be greater than or equal to "+us)}if(t>=us&&t<=this.transform.maxPitch){this.transform.minPitch=t;this._update();if(this.getPitch()<t){this.setPitch(t)}return this}else{throw new Error("minPitch must be between "+us+" and the current maxPitch, inclusive")}};n.prototype.getMinPitch=function e(){return this.transform.minPitch};n.prototype.setMaxPitch=function e(t){t=t===null||t===undefined?cs:t;if(t>cs){throw new Error("maxPitch must be less than or equal to "+cs)}if(t>=this.transform.minPitch){this.transform.maxPitch=t;this._update();if(this.getPitch()>t){this.setPitch(t)}return this}else{throw new Error("maxPitch must be greater than the current minPitch")}};n.prototype.getMaxPitch=function e(){return this.transform.maxPitch};n.prototype.getRenderWorldCopies=function e(){return this.transform.renderWorldCopies};n.prototype.setRenderWorldCopies=function e(t){this.transform.renderWorldCopies=t;return this._update()};n.prototype.project=function t(r){return this.transform.locationPoint(e.LngLat.convert(r))};n.prototype.unproject=function t(r){return this.transform.pointLocation(e.Point.convert(r))};n.prototype.isMoving=function e(){return this._moving||this.handlers.isMoving()};n.prototype.isZooming=function e(){return this._zooming||this.handlers.isZooming()};n.prototype.isRotating=function e(){return this._rotating||this.handlers.isRotating()};n.prototype._createDelegatedListener=function e(t,r,a){var n=this;var i;if(t==="mouseenter"||t==="mouseover"){var o=false;var s=function(e){var i=n.getLayer(r)?n.queryRenderedFeatures(e.point,{layers:[r]}):[];if(!i.length){o=false}else if(!o){o=true;a.call(n,new ro(t,n,e.originalEvent,{features:i}))}};var l=function(){o=false};return{layer:r,listener:a,delegates:{mousemove:s,mouseout:l}}}else if(t==="mouseleave"||t==="mouseout"){var u=false;var c=function(e){var i=n.getLayer(r)?n.queryRenderedFeatures(e.point,{layers:[r]}):[];if(i.length){u=true}else if(u){u=false;a.call(n,new ro(t,n,e.originalEvent))}};var f=function(e){if(u){u=false;a.call(n,new ro(t,n,e.originalEvent))}};return{layer:r,listener:a,delegates:{mousemove:c,mouseout:f}}}else{var h=function(e){var t=n.getLayer(r)?n.queryRenderedFeatures(e.point,{layers:[r]}):[];if(t.length){e.features=t;a.call(n,e);delete e.features}};return{layer:r,listener:a,delegates:(i={},i[t]=h,i)}}};n.prototype.on=function e(t,r,n){if(n===undefined){return a.prototype.on.call(this,t,r)}var i=this._createDelegatedListener(t,r,n);this._delegatedListeners=this._delegatedListeners||{};this._delegatedListeners[t]=this._delegatedListeners[t]||[];this._delegatedListeners[t].push(i);for(var o in i.delegates){this.on(o,i.delegates[o])}return this};n.prototype.once=function e(t,r,n){if(n===undefined){return a.prototype.once.call(this,t,r)}var i=this._createDelegatedListener(t,r,n);for(var o in i.delegates){this.once(o,i.delegates[o])}return this};n.prototype.off=function e(t,r,n){var i=this;if(n===undefined){return a.prototype.off.call(this,t,r)}var o=function(e){var a=e[t];for(var o=0;o<a.length;o++){var s=a[o];if(s.layer===r&&s.listener===n){for(var l in s.delegates){i.off(l,s.delegates[l])}a.splice(o,1);return i}}};if(this._delegatedListeners&&this._delegatedListeners[t]){o(this._delegatedListeners)}return this};n.prototype.queryRenderedFeatures=function t(r,a){if(!this.style){return[]}if(a===undefined&&r!==undefined&&!(r instanceof e.Point)&&!Array.isArray(r)){a=r;r=undefined}a=a||{};r=r||[[0,0],[this.transform.width,this.transform.height]];var n;if(r instanceof e.Point||typeof r[0]==="number"){n=[e.Point.convert(r)]}else{var i=e.Point.convert(r[0]);var o=e.Point.convert(r[1]);n=[i,new e.Point(o.x,i.y),o,new e.Point(i.x,o.y),i]}return this.style.queryRenderedFeatures(n,a,this.transform)};n.prototype.querySourceFeatures=function e(t,r){return this.style.querySourceFeatures(t,r)};n.prototype.setStyle=function t(r,a){a=e.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},a);if(a.diff!==false&&a.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&r){this._diffStyle(r,a);return this}else{this._localIdeographFontFamily=a.localIdeographFontFamily;return this._updateStyle(r,a)}};n.prototype._getUIString=function e(t){var r=this._locale[t];if(r==null){throw new Error("Missing UI string '"+t+"'")}return r};n.prototype._updateStyle=function e(t,r){if(this.style){this.style.setEventedParent(null);this.style._remove()}if(!t){delete this.style;return this}else{this.style=new mr(this,r||{})}this.style.setEventedParent(this,{style:this.style});if(typeof t==="string"){this.style.loadURL(t)}else{this.style.loadJSON(t)}return this};n.prototype._lazyInitEmptyStyle=function e(){if(!this.style){this.style=new mr(this,{});this.style.setEventedParent(this,{style:this.style});this.style.loadEmpty()}};n.prototype._diffStyle=function t(r,a){var n=this;if(typeof r==="string"){var i=this._requestManager.normalizeStyleURL(r);var o=this._requestManager.transformRequest(i,e.ResourceType.Style);e.getJSON(o,(function(t,r){if(t){n.fire(new e.ErrorEvent(t))}else if(r){n._updateDiff(r,a)}}))}else if(typeof r==="object"){this._updateDiff(r,a)}};n.prototype._updateDiff=function t(r,a){try{if(this.style.setState(r)){this._update(true)}}catch(n){e.warnOnce("Unable to perform style diff: "+(n.message||n.error||n)+".  Rebuilding the style from scratch.");this._updateStyle(r,a)}};n.prototype.getStyle=function e(){if(this.style){return this.style.serialize()}};n.prototype.isStyleLoaded=function t(){if(!this.style){return e.warnOnce("There is no style added to the map.")}return this.style.loaded()};n.prototype.addSource=function e(t,r){this._lazyInitEmptyStyle();this.style.addSource(t,r);return this._update(true)};n.prototype.isSourceLoaded=function t(r){var a=this.style&&this.style.sourceCaches[r];if(a===undefined){this.fire(new e.ErrorEvent(new Error("There is no source with ID '"+r+"'")));return}return a.loaded()};n.prototype.areTilesLoaded=function e(){var t=this.style&&this.style.sourceCaches;for(var r in t){var a=t[r];var n=a._tiles;for(var i in n){var o=n[i];if(!(o.state==="loaded"||o.state==="errored")){return false}}}return true};n.prototype.addSourceType=function e(t,r,a){this._lazyInitEmptyStyle();return this.style.addSourceType(t,r,a)};n.prototype.removeSource=function e(t){this.style.removeSource(t);return this._update(true)};n.prototype.getSource=function e(t){return this.style.getSource(t)};n.prototype.addImage=function t(r,a,n){if(n===void 0)n={};var i=n.pixelRatio;if(i===void 0)i=1;var o=n.sdf;if(o===void 0)o=false;var s=n.stretchX;var l=n.stretchY;var u=n.content;this._lazyInitEmptyStyle();var c=0;if(a instanceof ns||os&&a instanceof os){var f=e.browser.getImageData(a);var h=f.width;var p=f.height;var v=f.data;this.style.addImage(r,{data:new e.RGBAImage({width:h,height:p},v),pixelRatio:i,stretchX:s,stretchY:l,content:u,sdf:o,version:c})}else if(a.width===undefined||a.height===undefined){return this.fire(new e.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, "+"or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}else{var d=a.width;var m=a.height;var g=a.data;var y=a;this.style.addImage(r,{data:new e.RGBAImage({width:d,height:m},new Uint8Array(g)),pixelRatio:i,stretchX:s,stretchY:l,content:u,sdf:o,version:c,userImage:y});if(y.onAdd){y.onAdd(this,r)}}};n.prototype.updateImage=function t(r,a){var n=this.style.getImage(r);if(!n){return this.fire(new e.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")))}var i=a instanceof ns||os&&a instanceof os?e.browser.getImageData(a):a;var o=i.width;var s=i.height;var l=i.data;if(o===undefined||s===undefined){return this.fire(new e.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, "+"or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}if(o!==n.data.width||s!==n.data.height){return this.fire(new e.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image")))}var u=!(a instanceof ns||os&&a instanceof os);n.data.replace(l,u);this.style.updateImage(r,n)};n.prototype.hasImage=function t(r){if(!r){this.fire(new e.ErrorEvent(new Error("Missing required image id")));return false}return!!this.style.getImage(r)};n.prototype.removeImage=function e(t){this.style.removeImage(t)};n.prototype.loadImage=function t(r,a){e.getImage(this._requestManager.transformRequest(r,e.ResourceType.Image),a)};n.prototype.listImages=function e(){return this.style.listImages()};n.prototype.addLayer=function e(t,r){this._lazyInitEmptyStyle();this.style.addLayer(t,r);return this._update(true)};n.prototype.moveLayer=function e(t,r){this.style.moveLayer(t,r);return this._update(true)};n.prototype.removeLayer=function e(t){this.style.removeLayer(t);return this._update(true)};n.prototype.getLayer=function e(t){return this.style.getLayer(t)};n.prototype.setLayerZoomRange=function e(t,r,a){this.style.setLayerZoomRange(t,r,a);return this._update(true)};n.prototype.setFilter=function e(t,r,a){if(a===void 0)a={};this.style.setFilter(t,r,a);return this._update(true)};n.prototype.getFilter=function e(t){return this.style.getFilter(t)};n.prototype.setPaintProperty=function e(t,r,a,n){if(n===void 0)n={};this.style.setPaintProperty(t,r,a,n);return this._update(true)};n.prototype.getPaintProperty=function e(t,r){return this.style.getPaintProperty(t,r)};n.prototype.setLayoutProperty=function e(t,r,a,n){if(n===void 0)n={};this.style.setLayoutProperty(t,r,a,n);return this._update(true)};n.prototype.getLayoutProperty=function e(t,r){return this.style.getLayoutProperty(t,r)};n.prototype.setLight=function e(t,r){if(r===void 0)r={};this._lazyInitEmptyStyle();this.style.setLight(t,r);return this._update(true)};n.prototype.getLight=function e(){return this.style.getLight()};n.prototype.setFeatureState=function e(t,r){this.style.setFeatureState(t,r);return this._update()};n.prototype.removeFeatureState=function e(t,r){this.style.removeFeatureState(t,r);return this._update()};n.prototype.getFeatureState=function e(t){return this.style.getFeatureState(t)};n.prototype.getContainer=function e(){return this._container};n.prototype.getCanvasContainer=function e(){return this._canvasContainer};n.prototype.getCanvas=function e(){return this._canvas};n.prototype._containerDimensions=function e(){var t=0;var r=0;if(this._container){t=this._container.clientWidth||400;r=this._container.clientHeight||300}return[t,r]};n.prototype._detectMissingCSS=function t(){var r=e.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color");if(r!=="rgb(250, 128, 114)"){e.warnOnce("This page appears to be missing CSS declarations for "+"Mapbox GL JS, which may cause the map to display incorrectly. "+"Please ensure your page includes mapbox-gl.css, as described "+"in https://www.mapbox.com/mapbox-gl-js/api/.")}};n.prototype._setupContainer=function e(){var t=this._container;t.classList.add("mapboxgl-map");var a=this._missingCSSCanary=r.create("div","mapboxgl-canary",t);a.style.visibility="hidden";this._detectMissingCSS();var n=this._canvasContainer=r.create("div","mapboxgl-canvas-container",t);if(this._interactive){n.classList.add("mapboxgl-interactive")}this._canvas=r.create("canvas","mapboxgl-canvas",n);this._canvas.addEventListener("webglcontextlost",this._contextLost,false);this._canvas.addEventListener("webglcontextrestored",this._contextRestored,false);this._canvas.setAttribute("tabindex","0");this._canvas.setAttribute("aria-label","Map");var i=this._containerDimensions();this._resizeCanvas(i[0],i[1]);var o=this._controlContainer=r.create("div","mapboxgl-control-container",t);var s=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach((function(e){s[e]=r.create("div","mapboxgl-ctrl-"+e,o)}))};n.prototype._resizeCanvas=function t(r,a){var n=e.browser.devicePixelRatio||1;this._canvas.width=n*r;this._canvas.height=n*a;this._canvas.style.width=r+"px";this._canvas.style.height=a+"px"};n.prototype._setupPainter=function r(){var a=e.extend({},t.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||false});var n=this._canvas.getContext("webgl",a)||this._canvas.getContext("experimental-webgl",a);if(!n){this.fire(new e.ErrorEvent(new Error("Failed to initialize WebGL")));return}this.painter=new ji(n,this.transform);e.webpSupported.testSupport(n)};n.prototype._contextLost=function t(r){r.preventDefault();if(this._frame){this._frame.cancel();this._frame=null}this.fire(new e.Event("webglcontextlost",{originalEvent:r}))};n.prototype._contextRestored=function t(r){this._setupPainter();this.resize();this._update();this.fire(new e.Event("webglcontextrestored",{originalEvent:r}))};n.prototype.loaded=function e(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()};n.prototype._update=function e(t){if(!this.style){return this}this._styleDirty=this._styleDirty||t;this._sourcesDirty=true;this.triggerRepaint();return this};n.prototype._requestRenderFrame=function e(t){this._update();return this._renderTaskQueue.add(t)};n.prototype._cancelRenderFrame=function e(t){this._renderTaskQueue.remove(t)};n.prototype._render=function t(r){var a=this;var n,i=0;var o=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")){n=o.createQueryEXT();o.beginQueryEXT(o.TIME_ELAPSED_EXT,n);i=e.browser.now()}this.painter.context.setDirty();this.painter.setBaseState();this._renderTaskQueue.run(r);if(this._removed){return}var s=false;if(this.style&&this._styleDirty){this._styleDirty=false;var l=this.transform.zoom;var u=e.browser.now();this.style.zoomHistory.update(l,u);var c=new e.EvaluationParameters(l,{now:u,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()});var f=c.crossFadingFactor();if(f!==1||f!==this._crossFadingFactor){s=true;this._crossFadingFactor=f}this.style.update(c)}if(this.style&&this._sourcesDirty){this._sourcesDirty=false;this.style._updateSources(this.transform)}this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions);this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")});this.fire(new e.Event("render"));if(this.loaded()&&!this._loaded){this._loaded=true;this.fire(new e.Event("load"))}if(this.style&&(this.style.hasTransitions()||s)){this._styleDirty=true}if(this.style&&!this._placementDirty){this.style._releaseSymbolFadeTiles()}if(this.listens("gpu-timing-frame")){var h=e.browser.now()-i;o.endQueryEXT(o.TIME_ELAPSED_EXT,n);setTimeout((function(){var t=o.getQueryObjectEXT(n,o.QUERY_RESULT_EXT)/(1e3*1e3);o.deleteQueryEXT(n);a.fire(new e.Event("gpu-timing-frame",{cpuTime:h,gpuTime:t}))}),50)}if(this.listens("gpu-timing-layer")){var p=this.painter.collectGpuTimers();setTimeout((function(){var t=a.painter.queryGpuTimers(p);a.fire(new e.Event("gpu-timing-layer",{layerTimes:t}))}),50)}var v=this._sourcesDirty||this._styleDirty||this._placementDirty;if(v||this._repaint){this.triggerRepaint()}else if(!this.isMoving()&&this.loaded()){if(!this._fullyLoaded){this._fullyLoaded=true}this.fire(new e.Event("idle"))}return this};n.prototype.remove=function t(){if(this._hash){this._hash.remove()}for(var r=0,a=this._controls;r<a.length;r+=1){var n=a[r];n.onRemove(this)}this._controls=[];if(this._frame){this._frame.cancel();this._frame=null}this._renderTaskQueue.clear();this.painter.destroy();this.handlers.destroy();delete this.handlers;this.setStyle(null);if(typeof e.window!=="undefined"){e.window.removeEventListener("resize",this._onWindowResize,false);e.window.removeEventListener("online",this._onWindowOnline,false)}var i=this.painter.context.gl.getExtension("WEBGL_lose_context");if(i){i.loseContext()}ps(this._canvasContainer);ps(this._controlContainer);ps(this._missingCSSCanary);this._container.classList.remove("mapboxgl-map");this._removed=true;this.fire(new e.Event("remove"))};n.prototype.triggerRepaint=function t(){var r=this;if(this.style&&!this._frame){this._frame=e.browser.frame((function(e){r._frame=null;r._render(e)}))}};n.prototype._onWindowOnline=function e(){this._update()};n.prototype._onWindowResize=function e(t){if(this._trackResize){this.resize({originalEvent:t})._update()}};i.showTileBoundaries.get=function(){return!!this._showTileBoundaries};i.showTileBoundaries.set=function(e){if(this._showTileBoundaries===e){return}this._showTileBoundaries=e;this._update()};i.showPadding.get=function(){return!!this._showPadding};i.showPadding.set=function(e){if(this._showPadding===e){return}this._showPadding=e;this._update()};i.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes};i.showCollisionBoxes.set=function(e){if(this._showCollisionBoxes===e){return}this._showCollisionBoxes=e;if(e){this.style._generateCollisionBoxes()}else{this._update()}};i.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector};i.showOverdrawInspector.set=function(e){if(this._showOverdrawInspector===e){return}this._showOverdrawInspector=e;this._update()};i.repaint.get=function(){return!!this._repaint};i.repaint.set=function(e){if(this._repaint!==e){this._repaint=e;this.triggerRepaint()}};i.vertices.get=function(){return!!this._vertices};i.vertices.set=function(e){this._vertices=e;this._update()};n.prototype._setCacheLimits=function t(r,a){e.setCacheLimits(r,a)};i.version.get=function(){return e.version};Object.defineProperties(n.prototype,i);return n}($o);function ps(e){if(e.parentNode){e.parentNode.removeChild(e)}}var vs={showCompass:true,showZoom:true,visualizePitch:false};var ds=function t(a){var n=this;this.options=e.extend({},vs,a);this._container=r.create("div","mapboxgl-ctrl mapboxgl-ctrl-group");this._container.addEventListener("contextmenu",(function(e){return e.preventDefault()}));if(this.options.showZoom){e.bindAll(["_setButtonTitle","_updateZoomButtons"],this);this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",(function(e){return n._map.zoomIn({},{originalEvent:e})}));r.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",true);this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",(function(e){return n._map.zoomOut({},{originalEvent:e})}));r.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",true)}if(this.options.showCompass){e.bindAll(["_rotateCompassArrow"],this);this._compass=this._createButton("mapboxgl-ctrl-compass",(function(e){if(n.options.visualizePitch){n._map.resetNorthPitch({},{originalEvent:e})}else{n._map.resetNorth({},{originalEvent:e})}}));this._compassIcon=r.create("span","mapboxgl-ctrl-icon",this._compass);this._compassIcon.setAttribute("aria-hidden",true)}};ds.prototype._updateZoomButtons=function e(){var t=this._map.getZoom();this._zoomInButton.disabled=t===this._map.getMaxZoom();this._zoomOutButton.disabled=t===this._map.getMinZoom()};ds.prototype._rotateCompassArrow=function e(){var t=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=t};ds.prototype.onAdd=function e(t){this._map=t;if(this.options.showZoom){this._setButtonTitle(this._zoomInButton,"ZoomIn");this._setButtonTitle(this._zoomOutButton,"ZoomOut");this._map.on("zoom",this._updateZoomButtons);this._updateZoomButtons()}if(this.options.showCompass){this._setButtonTitle(this._compass,"ResetBearing");if(this.options.visualizePitch){this._map.on("pitch",this._rotateCompassArrow)}this._map.on("rotate",this._rotateCompassArrow);this._rotateCompassArrow();this._handler=new ms(this._map,this._compass,this.options.visualizePitch)}return this._container};ds.prototype.onRemove=function e(){r.remove(this._container);if(this.options.showZoom){this._map.off("zoom",this._updateZoomButtons)}if(this.options.showCompass){if(this.options.visualizePitch){this._map.off("pitch",this._rotateCompassArrow)}this._map.off("rotate",this._rotateCompassArrow);this._handler.off();delete this._handler}delete this._map};ds.prototype._createButton=function e(t,a){var n=r.create("button",t,this._container);n.type="button";n.addEventListener("click",a);return n};ds.prototype._setButtonTitle=function e(t,r){var a=this._map._getUIString("NavigationControl."+r);t.title=a;t.setAttribute("aria-label",a)};var ms=function t(a,n,i){if(i===void 0)i=false;this._clickTolerance=10;this.element=n;this.mouseRotate=new _o({clickTolerance:a.dragRotate._mouseRotate._clickTolerance});this.map=a;if(i){this.mousePitch=new wo({clickTolerance:a.dragRotate._mousePitch._clickTolerance})}e.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this);r.addEventListener(n,"mousedown",this.mousedown);r.addEventListener(n,"touchstart",this.touchstart,{passive:false});r.addEventListener(n,"touchmove",this.touchmove);r.addEventListener(n,"touchend",this.touchend);r.addEventListener(n,"touchcancel",this.reset)};ms.prototype.down=function e(t,a){this.mouseRotate.mousedown(t,a);if(this.mousePitch){this.mousePitch.mousedown(t,a)}r.disableDrag()};ms.prototype.move=function e(t,r){var a=this.map;var n=this.mouseRotate.mousemoveWindow(t,r);if(n&&n.bearingDelta){a.setBearing(a.getBearing()+n.bearingDelta)}if(this.mousePitch){var i=this.mousePitch.mousemoveWindow(t,r);if(i&&i.pitchDelta){a.setPitch(a.getPitch()+i.pitchDelta)}}};ms.prototype.off=function e(){var t=this.element;r.removeEventListener(t,"mousedown",this.mousedown);r.removeEventListener(t,"touchstart",this.touchstart,{passive:false});r.removeEventListener(t,"touchmove",this.touchmove);r.removeEventListener(t,"touchend",this.touchend);r.removeEventListener(t,"touchcancel",this.reset);this.offTemp()};ms.prototype.offTemp=function t(){r.enableDrag();r.removeEventListener(e.window,"mousemove",this.mousemove);r.removeEventListener(e.window,"mouseup",this.mouseup)};ms.prototype.mousedown=function t(a){this.down(e.extend({},a,{ctrlKey:true,preventDefault:function(){return a.preventDefault()}}),r.mousePos(this.element,a));r.addEventListener(e.window,"mousemove",this.mousemove);r.addEventListener(e.window,"mouseup",this.mouseup)};ms.prototype.mousemove=function e(t){this.move(t,r.mousePos(this.element,t))};ms.prototype.mouseup=function e(t){this.mouseRotate.mouseupWindow(t);if(this.mousePitch){this.mousePitch.mouseupWindow(t)}this.offTemp()};ms.prototype.touchstart=function e(t){if(t.targetTouches.length!==1){this.reset()}else{this._startPos=this._lastPos=r.touchPos(this.element,t.targetTouches)[0];this.down({type:"mousedown",button:0,ctrlKey:true,preventDefault:function(){return t.preventDefault()}},this._startPos)}};ms.prototype.touchmove=function e(t){if(t.targetTouches.length!==1){this.reset()}else{this._lastPos=r.touchPos(this.element,t.targetTouches)[0];this.move({preventDefault:function(){return t.preventDefault()}},this._lastPos)}};ms.prototype.touchend=function e(t){if(t.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance){this.element.click()}this.reset()};ms.prototype.reset=function e(){this.mouseRotate.reset();if(this.mousePitch){this.mousePitch.reset()}delete this._startPos;delete this._lastPos;this.offTemp()};function gs(t,r,a){t=new e.LngLat(t.lng,t.lat);if(r){var n=new e.LngLat(t.lng-360,t.lat);var i=new e.LngLat(t.lng+360,t.lat);var o=a.locationPoint(t).distSqr(r);if(a.locationPoint(n).distSqr(r)<o){t=n}else if(a.locationPoint(i).distSqr(r)<o){t=i}}while(Math.abs(t.lng-a.center.lng)>180){var s=a.locationPoint(t);if(s.x>=0&&s.y>=0&&s.x<=a.width&&s.y<=a.height){break}if(t.lng>a.center.lng){t.lng-=360}else{t.lng+=360}}return t}var ys={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function xs(e,t,r){var a=e.classList;for(var n in ys){a.remove("mapboxgl-"+r+"-anchor-"+n)}a.add("mapboxgl-"+r+"-anchor-"+t)}var bs=function(t){function a(a,n){var i=this;t.call(this);if(a instanceof e.window.HTMLElement||n){a=e.extend({element:a},n)}e.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this);this._anchor=a&&a.anchor||"center";this._color=a&&a.color||"#3FB1CE";this._draggable=a&&a.draggable||false;this._state="inactive";this._rotation=a&&a.rotation||0;this._rotationAlignment=a&&a.rotationAlignment||"auto";this._pitchAlignment=a&&a.pitchAlignment&&a.pitchAlignment!=="auto"?a.pitchAlignment:this._rotationAlignment;if(!a||!a.element){this._defaultMarker=true;this._element=r.create("div");this._element.setAttribute("aria-label","Map marker");var o=r.createNS("http://www.w3.org/2000/svg","svg");o.setAttributeNS(null,"display","block");o.setAttributeNS(null,"height","41px");o.setAttributeNS(null,"width","27px");o.setAttributeNS(null,"viewBox","0 0 27 41");var s=r.createNS("http://www.w3.org/2000/svg","g");s.setAttributeNS(null,"stroke","none");s.setAttributeNS(null,"stroke-width","1");s.setAttributeNS(null,"fill","none");s.setAttributeNS(null,"fill-rule","evenodd");var l=r.createNS("http://www.w3.org/2000/svg","g");l.setAttributeNS(null,"fill-rule","nonzero");var u=r.createNS("http://www.w3.org/2000/svg","g");u.setAttributeNS(null,"transform","translate(3.0, 29.0)");u.setAttributeNS(null,"fill","#000000");var c=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(var f=0,h=c;f<h.length;f+=1){var p=h[f];var v=r.createNS("http://www.w3.org/2000/svg","ellipse");v.setAttributeNS(null,"opacity","0.04");v.setAttributeNS(null,"cx","10.5");v.setAttributeNS(null,"cy","5.80029008");v.setAttributeNS(null,"rx",p["rx"]);v.setAttributeNS(null,"ry",p["ry"]);u.appendChild(v)}var d=r.createNS("http://www.w3.org/2000/svg","g");d.setAttributeNS(null,"fill",this._color);var m=r.createNS("http://www.w3.org/2000/svg","path");m.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z");d.appendChild(m);var g=r.createNS("http://www.w3.org/2000/svg","g");g.setAttributeNS(null,"opacity","0.25");g.setAttributeNS(null,"fill","#000000");var y=r.createNS("http://www.w3.org/2000/svg","path");y.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z");g.appendChild(y);var x=r.createNS("http://www.w3.org/2000/svg","g");x.setAttributeNS(null,"transform","translate(6.0, 7.0)");x.setAttributeNS(null,"fill","#FFFFFF");var b=r.createNS("http://www.w3.org/2000/svg","g");b.setAttributeNS(null,"transform","translate(8.0, 8.0)");var _=r.createNS("http://www.w3.org/2000/svg","circle");_.setAttributeNS(null,"fill","#000000");_.setAttributeNS(null,"opacity","0.25");_.setAttributeNS(null,"cx","5.5");_.setAttributeNS(null,"cy","5.5");_.setAttributeNS(null,"r","5.4999962");var w=r.createNS("http://www.w3.org/2000/svg","circle");w.setAttributeNS(null,"fill","#FFFFFF");w.setAttributeNS(null,"cx","5.5");w.setAttributeNS(null,"cy","5.5");w.setAttributeNS(null,"r","5.4999962");b.appendChild(_);b.appendChild(w);l.appendChild(u);l.appendChild(d);l.appendChild(g);l.appendChild(x);l.appendChild(b);o.appendChild(l);this._element.appendChild(o);this._offset=e.Point.convert(a&&a.offset||[0,-14])}else{this._element=a.element;this._offset=e.Point.convert(a&&a.offset||[0,0])}this._element.classList.add("mapboxgl-marker");this._element.addEventListener("dragstart",(function(e){e.preventDefault()}));this._element.addEventListener("mousedown",(function(e){e.preventDefault()}));this._element.addEventListener("focus",(function(){var e=i._map.getContainer();e.scrollTop=0;e.scrollLeft=0}));xs(this._element,this._anchor,"marker");this._popup=null}if(t)a.__proto__=t;a.prototype=Object.create(t&&t.prototype);a.prototype.constructor=a;a.prototype.addTo=function e(t){this.remove();this._map=t;t.getCanvasContainer().appendChild(this._element);t.on("move",this._update);t.on("moveend",this._update);this.setDraggable(this._draggable);this._update();this._map.on("click",this._onMapClick);return this};a.prototype.remove=function e(){if(this._map){this._map.off("click",this._onMapClick);this._map.off("move",this._update);this._map.off("moveend",this._update);this._map.off("mousedown",this._addDragHandler);this._map.off("touchstart",this._addDragHandler);this._map.off("mouseup",this._onUp);this._map.off("touchend",this._onUp);this._map.off("mousemove",this._onMove);this._map.off("touchmove",this._onMove);delete this._map}r.remove(this._element);if(this._popup){this._popup.remove()}return this};a.prototype.getLngLat=function e(){return this._lngLat};a.prototype.setLngLat=function t(r){this._lngLat=e.LngLat.convert(r);this._pos=null;if(this._popup){this._popup.setLngLat(this._lngLat)}this._update();return this};a.prototype.getElement=function e(){return this._element};a.prototype.setPopup=function e(t){if(this._popup){this._popup.remove();this._popup=null;this._element.removeEventListener("keypress",this._onKeyPress);if(!this._originalTabIndex){this._element.removeAttribute("tabindex")}}if(t){if(!("offset"in t.options)){var r=41-5.8/2;var a=13.5;var n=Math.sqrt(Math.pow(a,2)/2);t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-r],"bottom-left":[n,(r-a+n)*-1],"bottom-right":[-n,(r-a+n)*-1],left:[a,(r-a)*-1],right:[-a,(r-a)*-1]}:this._offset}this._popup=t;if(this._lngLat){this._popup.setLngLat(this._lngLat)}this._originalTabIndex=this._element.getAttribute("tabindex");if(!this._originalTabIndex){this._element.setAttribute("tabindex","0")}this._element.addEventListener("keypress",this._onKeyPress)}return this};a.prototype._onKeyPress=function e(t){var r=t.code;var a=t.charCode||t.keyCode;if(r==="Space"||r==="Enter"||a===32||a===13){this.togglePopup()}};a.prototype._onMapClick=function e(t){var r=t.originalEvent.target;var a=this._element;if(this._popup&&(r===a||a.contains(r))){this.togglePopup()}};a.prototype.getPopup=function e(){return this._popup};a.prototype.togglePopup=function e(){var t=this._popup;if(!t){return this}else if(t.isOpen()){t.remove()}else{t.addTo(this._map)}return this};a.prototype._update=function e(t){if(!this._map){return}if(this._map.transform.renderWorldCopies){this._lngLat=gs(this._lngLat,this._pos,this._map.transform)}this._pos=this._map.project(this._lngLat)._add(this._offset);var a="";if(this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"){a="rotateZ("+this._rotation+"deg)"}else if(this._rotationAlignment==="map"){a="rotateZ("+(this._rotation-this._map.getBearing())+"deg)"}var n="";if(this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"){n="rotateX(0deg)"}else if(this._pitchAlignment==="map"){n="rotateX("+this._map.getPitch()+"deg)"}if(!t||t.type==="moveend"){this._pos=this._pos.round()}r.setTransform(this._element,ys[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+n+" "+a)};a.prototype.getOffset=function e(){return this._offset};a.prototype.setOffset=function t(r){this._offset=e.Point.convert(r);this._update();return this};a.prototype._onMove=function t(r){this._pos=r.point.sub(this._positionDelta);this._lngLat=this._map.unproject(this._pos);this.setLngLat(this._lngLat);this._element.style.pointerEvents="none";if(this._state==="pending"){this._state="active";this.fire(new e.Event("dragstart"))}this.fire(new e.Event("drag"))};a.prototype._onUp=function t(){this._element.style.pointerEvents="auto";this._positionDelta=null;this._map.off("mousemove",this._onMove);this._map.off("touchmove",this._onMove);if(this._state==="active"){this.fire(new e.Event("dragend"))}this._state="inactive"};a.prototype._addDragHandler=function e(t){if(this._element.contains(t.originalEvent.target)){t.preventDefault();this._positionDelta=t.point.sub(this._pos).add(this._offset);this._state="pending";this._map.on("mousemove",this._onMove);this._map.on("touchmove",this._onMove);this._map.once("mouseup",this._onUp);this._map.once("touchend",this._onUp)}};a.prototype.setDraggable=function e(t){this._draggable=!!t;if(this._map){if(t){this._map.on("mousedown",this._addDragHandler);this._map.on("touchstart",this._addDragHandler)}else{this._map.off("mousedown",this._addDragHandler);this._map.off("touchstart",this._addDragHandler)}}return this};a.prototype.isDraggable=function e(){return this._draggable};a.prototype.setRotation=function e(t){this._rotation=t||0;this._update();return this};a.prototype.getRotation=function e(){return this._rotation};a.prototype.setRotationAlignment=function e(t){this._rotationAlignment=t||"auto";this._update();return this};a.prototype.getRotationAlignment=function e(){return this._rotationAlignment};a.prototype.setPitchAlignment=function e(t){this._pitchAlignment=t&&t!=="auto"?t:this._rotationAlignment;this._update();return this};a.prototype.getPitchAlignment=function e(){return this._pitchAlignment};return a}(e.Evented);var _s={positionOptions:{enableHighAccuracy:false,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:false,showAccuracyCircle:true,showUserLocation:true};var ws;function Ts(t){if(ws!==undefined){t(ws)}else if(e.window.navigator.permissions!==undefined){e.window.navigator.permissions.query({name:"geolocation"}).then((function(e){ws=e.state!=="denied";t(ws)}))}else{ws=!!e.window.navigator.geolocation;t(ws)}}var ks=0;var Ms=false;var As=function(t){function a(r){t.call(this);this.options=e.extend({},_s,r);e.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}if(t)a.__proto__=t;a.prototype=Object.create(t&&t.prototype);a.prototype.constructor=a;a.prototype.onAdd=function e(t){this._map=t;this._container=r.create("div","mapboxgl-ctrl mapboxgl-ctrl-group");Ts(this._setupUI);return this._container};a.prototype.onRemove=function t(){if(this._geolocationWatchID!==undefined){e.window.navigator.geolocation.clearWatch(this._geolocationWatchID);this._geolocationWatchID=undefined}if(this.options.showUserLocation&&this._userLocationDotMarker){this._userLocationDotMarker.remove()}if(this.options.showAccuracyCircle&&this._accuracyCircleMarker){this._accuracyCircleMarker.remove()}r.remove(this._container);this._map.off("zoom",this._onZoom);this._map=undefined;ks=0;Ms=false};a.prototype._isOutOfMapMaxBounds=function e(t){var r=this._map.getMaxBounds();var a=t.coords;return r&&(a.longitude<r.getWest()||a.longitude>r.getEast()||a.latitude<r.getSouth()||a.latitude>r.getNorth())};a.prototype._setErrorState=function e(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR";this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active");this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR";this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active");this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR";this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background");this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error");this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break}};a.prototype._onSuccess=function t(r){if(!this._map){return}if(this._isOutOfMapMaxBounds(r)){this._setErrorState();this.fire(new e.Event("outofmaxbounds",r));this._updateMarker();this._finish();return}if(this.options.trackUserLocation){this._lastKnownPosition=r;switch(this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK";this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting");this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error");this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND";this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting");this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error");this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break}}if(this.options.showUserLocation&&this._watchState!=="OFF"){this._updateMarker(r)}if(!this.options.trackUserLocation||this._watchState==="ACTIVE_LOCK"){this._updateCamera(r)}if(this.options.showUserLocation){this._dotElement.classList.remove("mapboxgl-user-location-dot-stale")}this.fire(new e.Event("geolocate",r));this._finish()};a.prototype._updateCamera=function t(r){var a=new e.LngLat(r.coords.longitude,r.coords.latitude);var n=r.coords.accuracy;var i=this._map.getBearing();var o=e.extend({bearing:i},this.options.fitBoundsOptions);this._map.fitBounds(a.toBounds(n),o,{geolocateSource:true})};a.prototype._updateMarker=function t(r){if(r){var a=new e.LngLat(r.coords.longitude,r.coords.latitude);this._accuracyCircleMarker.setLngLat(a).addTo(this._map);this._userLocationDotMarker.setLngLat(a).addTo(this._map);this._accuracy=r.coords.accuracy;if(this.options.showUserLocation&&this.options.showAccuracyCircle){this._updateCircleRadius()}}else{this._userLocationDotMarker.remove();this._accuracyCircleMarker.remove()}};a.prototype._updateCircleRadius=function e(){var t=this._map._container.clientHeight/2;var r=this._map.unproject([0,t]);var a=this._map.unproject([1,t]);var n=r.distanceTo(a);var i=Math.ceil(2*this._accuracy/n);this._circleElement.style.width=i+"px";this._circleElement.style.height=i+"px"};a.prototype._onZoom=function e(){if(this.options.showUserLocation&&this.options.showAccuracyCircle){this._updateCircleRadius()}};a.prototype._onError=function t(r){if(!this._map){return}if(this.options.trackUserLocation){if(r.code===1){this._watchState="OFF";this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting");this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active");this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error");this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background");this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error");this._geolocateButton.disabled=true;var a=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=a;this._geolocateButton.setAttribute("aria-label",a);if(this._geolocationWatchID!==undefined){this._clearWatch()}}else if(r.code===3&&Ms){return}else{this._setErrorState()}}if(this._watchState!=="OFF"&&this.options.showUserLocation){this._dotElement.classList.add("mapboxgl-user-location-dot-stale")}this.fire(new e.Event("error",r));this._finish()};a.prototype._finish=function e(){if(this._timeoutId){clearTimeout(this._timeoutId)}this._timeoutId=undefined};a.prototype._setupUI=function t(a){var n=this;this._container.addEventListener("contextmenu",(function(e){return e.preventDefault()}));this._geolocateButton=r.create("button","mapboxgl-ctrl-geolocate",this._container);r.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",true);this._geolocateButton.type="button";if(a===false){e.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var i=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=true;this._geolocateButton.title=i;this._geolocateButton.setAttribute("aria-label",i)}else{var o=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=o;this._geolocateButton.setAttribute("aria-label",o)}if(this.options.trackUserLocation){this._geolocateButton.setAttribute("aria-pressed","false");this._watchState="OFF"}if(this.options.showUserLocation){this._dotElement=r.create("div","mapboxgl-user-location-dot");this._userLocationDotMarker=new bs(this._dotElement);this._circleElement=r.create("div","mapboxgl-user-location-accuracy-circle");this._accuracyCircleMarker=new bs({element:this._circleElement,pitchAlignment:"map"});if(this.options.trackUserLocation){this._watchState="OFF"}this._map.on("zoom",this._onZoom)}this._geolocateButton.addEventListener("click",this.trigger.bind(this));this._setup=true;if(this.options.trackUserLocation){this._map.on("movestart",(function(t){var r=t.originalEvent&&t.originalEvent.type==="resize";if(!t.geolocateSource&&n._watchState==="ACTIVE_LOCK"&&!r){n._watchState="BACKGROUND";n._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");n._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active");n.fire(new e.Event("trackuserlocationend"))}}))}};a.prototype.trigger=function t(){if(!this._setup){e.warnOnce("Geolocate control triggered before added to a map");return false}if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE";this.fire(new e.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":ks--;Ms=false;this._watchState="OFF";this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting");this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active");this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error");this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background");this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error");this.fire(new e.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK";this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background");if(this._lastKnownPosition){this._updateCamera(this._lastKnownPosition)}this.fire(new e.Event("trackuserlocationstart"));break}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error");break}if(this._watchState==="OFF"&&this._geolocationWatchID!==undefined){this._clearWatch()}else if(this._geolocationWatchID===undefined){this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");this._geolocateButton.setAttribute("aria-pressed","true");ks++;var r;if(ks>1){r={maximumAge:6e5,timeout:0};Ms=true}else{r=this.options.positionOptions;Ms=false}this._geolocationWatchID=e.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,r)}}else{e.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions);this._timeoutId=setTimeout(this._finish,1e4)}return true};a.prototype._clearWatch=function t(){e.window.navigator.geolocation.clearWatch(this._geolocationWatchID);this._geolocationWatchID=undefined;this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting");this._geolocateButton.setAttribute("aria-pressed","false");if(this.options.showUserLocation){this._updateMarker(null)}};return a}(e.Evented);var Ss={maxWidth:100,unit:"metric"};var Es=function t(r){this.options=e.extend({},Ss,r);e.bindAll(["_onMove","setUnit"],this)};Es.prototype.getDefaultPosition=function e(){return"bottom-left"};Es.prototype._onMove=function e(){Ls(this._map,this._container,this.options)};Es.prototype.onAdd=function e(t){this._map=t;this._container=r.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",t.getContainer());this._map.on("move",this._onMove);this._onMove();return this._container};Es.prototype.onRemove=function e(){r.remove(this._container);this._map.off("move",this._onMove);this._map=undefined};Es.prototype.setUnit=function e(t){this.options.unit=t;Ls(this._map,this._container,this.options)};function Ls(e,t,r){var a=r&&r.maxWidth||100;var n=e._container.clientHeight/2;var i=e.unproject([0,n]);var o=e.unproject([a,n]);var s=i.distanceTo(o);if(r&&r.unit==="imperial"){var l=3.2808*s;if(l>5280){var u=l/5280;Cs(t,a,u,e._getUIString("ScaleControl.Miles"))}else{Cs(t,a,l,e._getUIString("ScaleControl.Feet"))}}else if(r&&r.unit==="nautical"){var c=s/1852;Cs(t,a,c,e._getUIString("ScaleControl.NauticalMiles"))}else if(s>=1e3){Cs(t,a,s/1e3,e._getUIString("ScaleControl.Kilometers"))}else{Cs(t,a,s,e._getUIString("ScaleControl.Meters"))}}function Cs(e,t,r,a){var n=Ps(r);var i=n/r;e.style.width=t*i+"px";e.innerHTML=n+"&nbsp;"+a}function Is(e){var t=Math.pow(10,Math.ceil(-Math.log(e)/Math.LN10));return Math.round(e*t)/t}function Ps(e){var t=Math.pow(10,(""+Math.floor(e)).length-1);var r=e/t;r=r>=10?10:r>=5?5:r>=3?3:r>=2?2:r>=1?1:Is(r);return t*r}var Os=function t(r){this._fullscreen=false;if(r&&r.container){if(r.container instanceof e.window.HTMLElement){this._container=r.container}else{e.warnOnce("Full screen control 'container' must be a DOM element.")}}e.bindAll(["_onClickFullscreen","_changeIcon"],this);if("onfullscreenchange"in e.window.document){this._fullscreenchange="fullscreenchange"}else if("onmozfullscreenchange"in e.window.document){this._fullscreenchange="mozfullscreenchange"}else if("onwebkitfullscreenchange"in e.window.document){this._fullscreenchange="webkitfullscreenchange"}else if("onmsfullscreenchange"in e.window.document){this._fullscreenchange="MSFullscreenChange"}};Os.prototype.onAdd=function t(a){this._map=a;if(!this._container){this._container=this._map.getContainer()}this._controlContainer=r.create("div","mapboxgl-ctrl mapboxgl-ctrl-group");if(this._checkFullscreenSupport()){this._setupUI()}else{this._controlContainer.style.display="none";e.warnOnce("This device does not support fullscreen mode.")}return this._controlContainer};Os.prototype.onRemove=function t(){r.remove(this._controlContainer);this._map=null;e.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)};Os.prototype._checkFullscreenSupport=function t(){return!!(e.window.document.fullscreenEnabled||e.window.document.mozFullScreenEnabled||e.window.document.msFullscreenEnabled||e.window.document.webkitFullscreenEnabled)};Os.prototype._setupUI=function t(){var a=this._fullscreenButton=r.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);r.create("span","mapboxgl-ctrl-icon",a).setAttribute("aria-hidden",true);a.type="button";this._updateTitle();this._fullscreenButton.addEventListener("click",this._onClickFullscreen);e.window.document.addEventListener(this._fullscreenchange,this._changeIcon)};Os.prototype._updateTitle=function e(){var t=this._getTitle();this._fullscreenButton.setAttribute("aria-label",t);this._fullscreenButton.title=t};Os.prototype._getTitle=function e(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")};Os.prototype._isFullscreen=function e(){return this._fullscreen};Os.prototype._changeIcon=function t(){var r=e.window.document.fullscreenElement||e.window.document.mozFullScreenElement||e.window.document.webkitFullscreenElement||e.window.document.msFullscreenElement;if(r===this._container!==this._fullscreen){this._fullscreen=!this._fullscreen;this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink");this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen");this._updateTitle()}};Os.prototype._onClickFullscreen=function t(){if(this._isFullscreen()){if(e.window.document.exitFullscreen){e.window.document.exitFullscreen()}else if(e.window.document.mozCancelFullScreen){e.window.document.mozCancelFullScreen()}else if(e.window.document.msExitFullscreen){e.window.document.msExitFullscreen()}else if(e.window.document.webkitCancelFullScreen){e.window.document.webkitCancelFullScreen()}}else if(this._container.requestFullscreen){this._container.requestFullscreen()}else if(this._container.mozRequestFullScreen){this._container.mozRequestFullScreen()}else if(this._container.msRequestFullscreen){this._container.msRequestFullscreen()}else if(this._container.webkitRequestFullscreen){this._container.webkitRequestFullscreen()}};var zs={closeButton:true,closeOnClick:true,className:"",maxWidth:"240px"};var Ds=function(t){function a(r){t.call(this);this.options=e.extend(Object.create(zs),r);e.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}if(t)a.__proto__=t;a.prototype=Object.create(t&&t.prototype);a.prototype.constructor=a;a.prototype.addTo=function t(r){if(this._map){this.remove()}this._map=r;if(this.options.closeOnClick){this._map.on("click",this._onClose)}if(this.options.closeOnMove){this._map.on("move",this._onClose)}this._map.on("remove",this.remove);this._update();if(this._trackPointer){this._map.on("mousemove",this._onMouseMove);this._map.on("mouseup",this._onMouseUp);if(this._container){this._container.classList.add("mapboxgl-popup-track-pointer")}this._map._canvasContainer.classList.add("mapboxgl-track-pointer")}else{this._map.on("move",this._update)}this.fire(new e.Event("open"));return this};a.prototype.isOpen=function e(){return!!this._map};a.prototype.remove=function t(){if(this._content){r.remove(this._content)}if(this._container){r.remove(this._container);delete this._container}if(this._map){this._map.off("move",this._update);this._map.off("move",this._onClose);this._map.off("click",this._onClose);this._map.off("remove",this.remove);this._map.off("mousemove",this._onMouseMove);this._map.off("mouseup",this._onMouseUp);this._map.off("drag",this._onDrag);delete this._map}this.fire(new e.Event("close"));return this};a.prototype.getLngLat=function e(){return this._lngLat};a.prototype.setLngLat=function t(r){this._lngLat=e.LngLat.convert(r);this._pos=null;this._trackPointer=false;this._update();if(this._map){this._map.on("move",this._update);this._map.off("mousemove",this._onMouseMove);if(this._container){this._container.classList.remove("mapboxgl-popup-track-pointer")}this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")}return this};a.prototype.trackPointer=function e(){this._trackPointer=true;this._pos=null;this._update();if(this._map){this._map.off("move",this._update);this._map.on("mousemove",this._onMouseMove);this._map.on("drag",this._onDrag);if(this._container){this._container.classList.add("mapboxgl-popup-track-pointer")}this._map._canvasContainer.classList.add("mapboxgl-track-pointer")}return this};a.prototype.getElement=function e(){return this._container};a.prototype.setText=function t(r){return this.setDOMContent(e.window.document.createTextNode(r))};a.prototype.setHTML=function t(r){var a=e.window.document.createDocumentFragment();var n=e.window.document.createElement("body");var i;n.innerHTML=r;while(true){i=n.firstChild;if(!i){break}a.appendChild(i)}return this.setDOMContent(a)};a.prototype.getMaxWidth=function e(){return this._container&&this._container.style.maxWidth};a.prototype.setMaxWidth=function e(t){this.options.maxWidth=t;this._update();return this};a.prototype.setDOMContent=function e(t){this._createContent();this._content.appendChild(t);this._update();return this};a.prototype.addClassName=function e(t){if(this._container){this._container.classList.add(t)}};a.prototype.removeClassName=function e(t){if(this._container){this._container.classList.remove(t)}};a.prototype.toggleClassName=function e(t){if(this._container){return this._container.classList.toggle(t)}};a.prototype._createContent=function e(){if(this._content){r.remove(this._content)}this._content=r.create("div","mapboxgl-popup-content",this._container);if(this.options.closeButton){this._closeButton=r.create("button","mapboxgl-popup-close-button",this._content);this._closeButton.type="button";this._closeButton.setAttribute("aria-label","Close popup");this._closeButton.innerHTML="&#215;";this._closeButton.addEventListener("click",this._onClose)}};a.prototype._onMouseUp=function e(t){this._update(t.point)};a.prototype._onMouseMove=function e(t){this._update(t.point)};a.prototype._onDrag=function e(t){this._update(t.point)};a.prototype._update=function e(t){var a=this;var n=this._lngLat||this._trackPointer;if(!this._map||!n||!this._content){return}if(!this._container){this._container=r.create("div","mapboxgl-popup",this._map.getContainer());this._tip=r.create("div","mapboxgl-popup-tip",this._container);this._container.appendChild(this._content);if(this.options.className){this.options.className.split(" ").forEach((function(e){return a._container.classList.add(e)}))}if(this._trackPointer){this._container.classList.add("mapboxgl-popup-track-pointer")}}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth){this._container.style.maxWidth=this.options.maxWidth}if(this._map.transform.renderWorldCopies&&!this._trackPointer){this._lngLat=gs(this._lngLat,this._pos,this._map.transform)}if(this._trackPointer&&!t){return}var i=this._pos=this._trackPointer&&t?t:this._map.project(this._lngLat);var o=this.options.anchor;var s=Rs(this.options.offset);if(!o){var l=this._container.offsetWidth;var u=this._container.offsetHeight;var c;if(i.y+s.bottom.y<u){c=["top"]}else if(i.y>this._map.transform.height-u){c=["bottom"]}else{c=[]}if(i.x<l/2){c.push("left")}else if(i.x>this._map.transform.width-l/2){c.push("right")}if(c.length===0){o="bottom"}else{o=c.join("-")}}var f=i.add(s[o]).round();r.setTransform(this._container,ys[o]+" translate("+f.x+"px,"+f.y+"px)");xs(this._container,o,"popup")};a.prototype._onClose=function e(){this.remove()};return a}(e.Evented);function Rs(t){if(!t){return Rs(new e.Point(0,0))}else if(typeof t==="number"){var r=Math.round(Math.sqrt(.5*Math.pow(t,2)));return{center:new e.Point(0,0),top:new e.Point(0,t),"top-left":new e.Point(r,r),"top-right":new e.Point(-r,r),bottom:new e.Point(0,-t),"bottom-left":new e.Point(r,-r),"bottom-right":new e.Point(-r,-r),left:new e.Point(t,0),right:new e.Point(-t,0)}}else if(t instanceof e.Point||Array.isArray(t)){var a=e.Point.convert(t);return{center:a,top:a,"top-left":a,"top-right":a,bottom:a,"bottom-left":a,"bottom-right":a,left:a,right:a}}else{return{center:e.Point.convert(t["center"]||[0,0]),top:e.Point.convert(t["top"]||[0,0]),"top-left":e.Point.convert(t["top-left"]||[0,0]),"top-right":e.Point.convert(t["top-right"]||[0,0]),bottom:e.Point.convert(t["bottom"]||[0,0]),"bottom-left":e.Point.convert(t["bottom-left"]||[0,0]),"bottom-right":e.Point.convert(t["bottom-right"]||[0,0]),left:e.Point.convert(t["left"]||[0,0]),right:e.Point.convert(t["right"]||[0,0])}}}var Fs={version:e.version,supported:t,setRTLTextPlugin:e.setRTLTextPlugin,getRTLTextPluginStatus:e.getRTLTextPluginStatus,Map:hs,NavigationControl:ds,GeolocateControl:As,AttributionControl:es,ScaleControl:Es,FullscreenControl:Os,Popup:Ds,Marker:bs,Style:mr,LngLat:e.LngLat,LngLatBounds:e.LngLatBounds,Point:e.Point,MercatorCoordinate:e.MercatorCoordinate,Evented:e.Evented,config:e.config,prewarm:it,clearPrewarmedResources:ot,get accessToken(){return e.config.ACCESS_TOKEN},set accessToken(t){e.config.ACCESS_TOKEN=t},get baseApiUrl(){return e.config.API_URL},set baseApiUrl(t){e.config.API_URL=t},get workerCount(){return tt.workerCount},set workerCount(e){tt.workerCount=e},get maxParallelImageRequests(){return e.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(t){e.config.MAX_PARALLEL_IMAGE_REQUESTS=t},clearStorage:function t(r){e.clearTileCache(r)},workerUrl:""};return Fs}));return r}))},{}],452:[function(e,t,r){var a=e("./normalize");var n=e("gl-mat4/create");var i=e("gl-mat4/clone");var o=e("gl-mat4/determinant");var s=e("gl-mat4/invert");var l=e("gl-mat4/transpose");var u={length:e("gl-vec3/length"),normalize:e("gl-vec3/normalize"),dot:e("gl-vec3/dot"),cross:e("gl-vec3/cross")};var c=n();var f=n();var h=[0,0,0,0];var p=[[0,0,0],[0,0,0],[0,0,0]];var v=[0,0,0];t.exports=function e(t,r,n,y,x,b){if(!r)r=[0,0,0];if(!n)n=[0,0,0];if(!y)y=[0,0,0];if(!x)x=[0,0,0,1];if(!b)b=[0,0,0,1];if(!a(c,t))return false;i(f,c);f[3]=0;f[7]=0;f[11]=0;f[15]=1;if(Math.abs(o(f)<1e-8))return false;var _=c[3],w=c[7],T=c[11],k=c[12],M=c[13],A=c[14],S=c[15];if(_!==0||w!==0||T!==0){h[0]=_;h[1]=w;h[2]=T;h[3]=S;var E=s(f,f);if(!E)return false;l(f,f);d(x,h,f)}else{x[0]=x[1]=x[2]=0;x[3]=1}r[0]=k;r[1]=M;r[2]=A;m(p,c);n[0]=u.length(p[0]);u.normalize(p[0],p[0]);y[0]=u.dot(p[0],p[1]);g(p[1],p[1],p[0],1,-y[0]);n[1]=u.length(p[1]);u.normalize(p[1],p[1]);y[0]/=n[1];y[1]=u.dot(p[0],p[2]);g(p[2],p[2],p[0],1,-y[1]);y[2]=u.dot(p[1],p[2]);g(p[2],p[2],p[1],1,-y[2]);n[2]=u.length(p[2]);u.normalize(p[2],p[2]);y[1]/=n[2];y[2]/=n[2];u.cross(v,p[1],p[2]);if(u.dot(p[0],v)<0){for(var L=0;L<3;L++){n[L]*=-1;p[L][0]*=-1;p[L][1]*=-1;p[L][2]*=-1}}b[0]=.5*Math.sqrt(Math.max(1+p[0][0]-p[1][1]-p[2][2],0));b[1]=.5*Math.sqrt(Math.max(1-p[0][0]+p[1][1]-p[2][2],0));b[2]=.5*Math.sqrt(Math.max(1-p[0][0]-p[1][1]+p[2][2],0));b[3]=.5*Math.sqrt(Math.max(1+p[0][0]+p[1][1]+p[2][2],0));if(p[2][1]>p[1][2])b[0]=-b[0];if(p[0][2]>p[2][0])b[1]=-b[1];if(p[1][0]>p[0][1])b[2]=-b[2];return true};function d(e,t,r){var a=t[0],n=t[1],i=t[2],o=t[3];e[0]=r[0]*a+r[4]*n+r[8]*i+r[12]*o;e[1]=r[1]*a+r[5]*n+r[9]*i+r[13]*o;e[2]=r[2]*a+r[6]*n+r[10]*i+r[14]*o;e[3]=r[3]*a+r[7]*n+r[11]*i+r[15]*o;return e}function m(e,t){e[0][0]=t[0];e[0][1]=t[1];e[0][2]=t[2];e[1][0]=t[4];e[1][1]=t[5];e[1][2]=t[6];e[2][0]=t[8];e[2][1]=t[9];e[2][2]=t[10]}function g(e,t,r,a,n){e[0]=t[0]*a+r[0]*n;e[1]=t[1]*a+r[1]*n;e[2]=t[2]*a+r[2]*n}},{"./normalize":453,"gl-mat4/clone":278,"gl-mat4/create":280,"gl-mat4/determinant":281,"gl-mat4/invert":293,"gl-mat4/transpose":306,"gl-vec3/cross":360,"gl-vec3/dot":365,"gl-vec3/length":375,"gl-vec3/normalize":382}],453:[function(e,t,r){t.exports=function e(t,r){var a=r[15];if(a===0)return false;var n=1/a;for(var i=0;i<16;i++)t[i]=r[i]*n;return true}},{}],454:[function(e,t,r){var a=e("gl-vec3/lerp");var n=e("mat4-recompose");var i=e("mat4-decompose");var o=e("gl-mat4/determinant");var s=e("quat-slerp");var l=h();var u=h();var c=h();t.exports=f;function f(e,t,r,f){if(o(t)===0||o(r)===0)return false;var h=i(t,l.translate,l.scale,l.skew,l.perspective,l.quaternion);var p=i(r,u.translate,u.scale,u.skew,u.perspective,u.quaternion);if(!h||!p)return false;a(c.translate,l.translate,u.translate,f);a(c.skew,l.skew,u.skew,f);a(c.scale,l.scale,u.scale,f);a(c.perspective,l.perspective,u.perspective,f);s(c.quaternion,l.quaternion,u.quaternion,f);n(e,c.translate,c.scale,c.skew,c.perspective,c.quaternion);return true}function h(){return{translate:p(),scale:p(1),skew:p(),perspective:v(),quaternion:v()}}function p(e){return[e||0,e||0,e||0]}function v(){return[0,0,0,1]}},{"gl-mat4/determinant":281,"gl-vec3/lerp":376,"mat4-decompose":452,"mat4-recompose":455,"quat-slerp":515}],455:[function(e,t,r){var a={identity:e("gl-mat4/identity"),translate:e("gl-mat4/translate"),multiply:e("gl-mat4/multiply"),create:e("gl-mat4/create"),scale:e("gl-mat4/scale"),fromRotationTranslation:e("gl-mat4/fromRotationTranslation")};var n=a.create();var i=a.create();t.exports=function e(t,r,n,o,s,l){a.identity(t);a.fromRotationTranslation(t,l,r);t[3]=s[0];t[7]=s[1];t[11]=s[2];t[15]=s[3];a.identity(i);if(o[2]!==0){i[9]=o[2];a.multiply(t,t,i)}if(o[1]!==0){i[9]=0;i[8]=o[1];a.multiply(t,t,i)}if(o[0]!==0){i[8]=0;i[4]=o[0];a.multiply(t,t,i)}a.scale(t,t,n);return t}},{"gl-mat4/create":280,"gl-mat4/fromRotationTranslation":284,"gl-mat4/identity":291,"gl-mat4/multiply":295,"gl-mat4/scale":303,"gl-mat4/translate":305}],456:[function(e,t,r){"use strict";t.exports=Math.log2||function(e){return Math.log(e)*Math.LOG2E}},{}],457:[function(e,t,r){"use strict";var a=e("binary-search-bounds");var n=e("mat4-interpolate");var i=e("gl-mat4/invert");var o=e("gl-mat4/rotateX");var s=e("gl-mat4/rotateY");var l=e("gl-mat4/rotateZ");var u=e("gl-mat4/lookAt");var c=e("gl-mat4/translate");var f=e("gl-mat4/scale");var h=e("gl-vec3/normalize");var p=[0,0,0];t.exports=g;function v(e){this._components=e.slice();this._time=[0];this.prevMatrix=e.slice();this.nextMatrix=e.slice();this.computedMatrix=e.slice();this.computedInverse=e.slice();this.computedEye=[0,0,0];this.computedUp=[0,0,0];this.computedCenter=[0,0,0];this.computedRadius=[0];this._limits=[-Infinity,Infinity]}var d=v.prototype;d.recalcMatrix=function(e){var t=this._time;var r=a.le(t,e);var o=this.computedMatrix;if(r<0){return}var s=this._components;if(r===t.length-1){var l=16*r;for(var u=0;u<16;++u){o[u]=s[l++]}}else{var c=t[r+1]-t[r];var l=16*r;var f=this.prevMatrix;var p=true;for(var u=0;u<16;++u){f[u]=s[l++]}var v=this.nextMatrix;for(var u=0;u<16;++u){v[u]=s[l++];p=p&&f[u]===v[u]}if(c<1e-6||p){for(var u=0;u<16;++u){o[u]=f[u]}}else{n(o,f,v,(e-t[r])/c)}}var d=this.computedUp;d[0]=o[1];d[1]=o[5];d[2]=o[9];h(d,d);var m=this.computedInverse;i(m,o);var g=this.computedEye;var y=m[15];g[0]=m[12]/y;g[1]=m[13]/y;g[2]=m[14]/y;var x=this.computedCenter;var b=Math.exp(this.computedRadius[0]);for(var u=0;u<3;++u){x[u]=g[u]-o[2+4*u]*b}};d.idle=function(e){if(e<this.lastT()){return}var t=this._components;var r=t.length-16;for(var a=0;a<16;++a){t.push(t[r++])}this._time.push(e)};d.flush=function(e){var t=a.gt(this._time,e)-2;if(t<0){return}this._time.splice(0,t);this._components.splice(0,16*t)};d.lastT=function(){return this._time[this._time.length-1]};d.lookAt=function(e,t,r,a){this.recalcMatrix(e);t=t||this.computedEye;r=r||p;a=a||this.computedUp;this.setMatrix(e,u(this.computedMatrix,t,r,a));var n=0;for(var i=0;i<3;++i){n+=Math.pow(r[i]-t[i],2)}n=Math.log(Math.sqrt(n));this.computedRadius[0]=n};d.rotate=function(e,t,r,a){this.recalcMatrix(e);var n=this.computedInverse;if(t)s(n,n,t);if(r)o(n,n,r);if(a)l(n,n,a);this.setMatrix(e,i(this.computedMatrix,n))};var m=[0,0,0];d.pan=function(e,t,r,a){m[0]=-(t||0);m[1]=-(r||0);m[2]=-(a||0);this.recalcMatrix(e);var n=this.computedInverse;c(n,n,m);this.setMatrix(e,i(n,n))};d.translate=function(e,t,r,a){m[0]=t||0;m[1]=r||0;m[2]=a||0;this.recalcMatrix(e);var n=this.computedMatrix;c(n,n,m);this.setMatrix(e,n)};d.setMatrix=function(e,t){if(e<this.lastT()){return}this._time.push(e);for(var r=0;r<16;++r){this._components.push(t[r])}};d.setDistance=function(e,t){this.computedRadius[0]=t};d.setDistanceLimits=function(e,t){var r=this._limits;r[0]=e;r[1]=t};d.getDistanceLimits=function(e){var t=this._limits;if(e){e[0]=t[0];e[1]=t[1];return e}return t};function g(e){e=e||{};var t=e.matrix||[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return new v(t)}},{"binary-search-bounds":103,"gl-mat4/invert":293,"gl-mat4/lookAt":294,"gl-mat4/rotateX":300,"gl-mat4/rotateY":301,"gl-mat4/rotateZ":302,"gl-mat4/scale":303,"gl-mat4/translate":305,"gl-vec3/normalize":382,"mat4-interpolate":454}],458:[function(e,t,r){"use strict";t.exports=n;var a=e("robust-orientation")[3];function n(e){var t=e.length;if(t<3){var r=new Array(t);for(var n=0;n<t;++n){r[n]=n}if(t===2&&e[0][0]===e[1][0]&&e[0][1]===e[1][1]){return[0]}return r}var i=new Array(t);for(var n=0;n<t;++n){i[n]=n}i.sort((function(t,r){var a=e[t][0]-e[r][0];if(a){return a}return e[t][1]-e[r][1]}));var o=[i[0],i[1]];var s=[i[0],i[1]];for(var n=2;n<t;++n){var l=i[n];var u=e[l];var c=o.length;while(c>1&&a(e[o[c-2]],e[o[c-1]],u)<=0){c-=1;o.pop()}o.push(l);c=s.length;while(c>1&&a(e[s[c-2]],e[s[c-1]],u)>=0){c-=1;s.pop()}s.push(l)}var r=new Array(s.length+o.length-2);var f=0;for(var n=0,h=o.length;n<h;++n){r[f++]=o[n]}for(var p=s.length-2;p>0;--p){r[f++]=s[p]}return r}},{"robust-orientation":534}],459:[function(e,t,r){"use strict";t.exports=n;var a=e("mouse-event");function n(e,t){if(!t){t=e;e=window}var r=0;var n=0;var i=0;var o={shift:false,alt:false,control:false,meta:false};var s=false;function l(e){var t=false;if("altKey"in e){t=t||e.altKey!==o.alt;o.alt=!!e.altKey}if("shiftKey"in e){t=t||e.shiftKey!==o.shift;o.shift=!!e.shiftKey}if("ctrlKey"in e){t=t||e.ctrlKey!==o.control;o.control=!!e.ctrlKey}if("metaKey"in e){t=t||e.metaKey!==o.meta;o.meta=!!e.metaKey}return t}function u(e,s){var u=a.x(s);var c=a.y(s);if("buttons"in s){e=s.buttons|0}if(e!==r||u!==n||c!==i||l(s)){r=e|0;n=u||0;i=c||0;t&&t(r,n,i,o)}}function c(e){u(0,e)}function f(){if(r||n||i||o.shift||o.alt||o.meta||o.control){n=i=0;r=0;o.shift=o.alt=o.control=o.meta=false;t&&t(0,0,0,o)}}function h(e){if(l(e)){t&&t(r,n,i,o)}}function p(e){if(a.buttons(e)===0){u(0,e)}else{u(r,e)}}function v(e){u(r|a.buttons(e),e)}function d(e){u(r&~a.buttons(e),e)}function m(){if(s){return}s=true;e.addEventListener("mousemove",p);e.addEventListener("mousedown",v);e.addEventListener("mouseup",d);e.addEventListener("mouseleave",c);e.addEventListener("mouseenter",c);e.addEventListener("mouseout",c);e.addEventListener("mouseover",c);e.addEventListener("blur",f);e.addEventListener("keyup",h);e.addEventListener("keydown",h);e.addEventListener("keypress",h);if(e!==window){window.addEventListener("blur",f);window.addEventListener("keyup",h);window.addEventListener("keydown",h);window.addEventListener("keypress",h)}}function g(){if(!s){return}s=false;e.removeEventListener("mousemove",p);e.removeEventListener("mousedown",v);e.removeEventListener("mouseup",d);e.removeEventListener("mouseleave",c);e.removeEventListener("mouseenter",c);e.removeEventListener("mouseout",c);e.removeEventListener("mouseover",c);e.removeEventListener("blur",f);e.removeEventListener("keyup",h);e.removeEventListener("keydown",h);e.removeEventListener("keypress",h);if(e!==window){window.removeEventListener("blur",f);window.removeEventListener("keyup",h);window.removeEventListener("keydown",h);window.removeEventListener("keypress",h)}}m();var y={element:e};Object.defineProperties(y,{enabled:{get:function(){return s},set:function(e){if(e){m()}else{g()}},enumerable:true},buttons:{get:function(){return r},enumerable:true},x:{get:function(){return n},enumerable:true},y:{get:function(){return i},enumerable:true},mods:{get:function(){return o},enumerable:true}});return y}},{"mouse-event":461}],460:[function(e,t,r){var a={left:0,top:0};t.exports=n;function n(e,t,r){t=t||e.currentTarget||e.srcElement;if(!Array.isArray(r)){r=[0,0]}var a=e.clientX||0;var n=e.clientY||0;var o=i(t);r[0]=a-o.left;r[1]=n-o.top;return r}function i(e){if(e===window||e===document||e===document.body){return a}else{return e.getBoundingClientRect()}}},{}],461:[function(e,t,r){"use strict";function a(e){if(typeof e==="object"){if("buttons"in e){return e.buttons}else if("which"in e){var t=e.which;if(t===2){return 4}else if(t===3){return 2}else if(t>0){return 1<<t-1}}else if("button"in e){var t=e.button;if(t===1){return 4}else if(t===2){return 2}else if(t>=0){return 1<<t}}}return 0}r.buttons=a;function n(e){return e.target||e.srcElement||window}r.element=n;function i(e){if(typeof e==="object"){if("offsetX"in e){return e.offsetX}var t=n(e);var r=t.getBoundingClientRect();return e.clientX-r.left}return 0}r.x=i;function o(e){if(typeof e==="object"){if("offsetY"in e){return e.offsetY}var t=n(e);var r=t.getBoundingClientRect();return e.clientY-r.top}return 0}r.y=o},{}],462:[function(e,t,r){"use strict";var a=e("to-px");t.exports=n;function n(e,t,r){if(typeof e==="function"){r=!!t;t=e;e=window}var n=a("ex",e);var i=function(e){if(r){e.preventDefault()}var a=e.deltaX||0;var i=e.deltaY||0;var o=e.deltaZ||0;var s=e.deltaMode;var l=1;switch(s){case 1:l=n;break;case 2:l=window.innerHeight;break}a*=l;i*=l;o*=l;if(a||i||o){return t(a,i,o,e)}};e.addEventListener("wheel",i);return i}},{"to-px":585}],463:[function(r,a,n){(function(t,r){(function(){(function t(r,n,i){n[r]=n[r]||i();if(typeof a!="undefined"&&a.exports){a.exports=n[r]}else if(typeof e=="function"&&e.amd){e((function e(){return n[r]}))}})("Promise",typeof t!="undefined"?t:this,(function e(){"use strict";var t,a,n,i=Object.prototype.toString,o=typeof r!="undefined"?function e(t){return r(t)}:setTimeout;try{Object.defineProperty({},"x",{});t=function e(t,r,a,n){return Object.defineProperty(t,r,{value:a,writable:true,configurable:n!==false})}}catch(y){t=function e(t,r,a){t[r]=a;return t}}n=function e(){var t,r,n;function i(e,t){this.fn=e;this.self=t;this.next=void 0}return{add:function e(a,o){n=new i(a,o);if(r){r.next=n}else{t=n}r=n;n=void 0},drain:function e(){var n=t;t=r=a=void 0;while(n){n.fn.call(n.self);n=n.next}}}}();function s(e,t){n.add(e,t);if(!a){a=o(n.drain)}}function l(e){var t,r=typeof e;if(e!=null&&(r=="object"||r=="function")){t=e.then}return typeof t=="function"?t:false}function u(){for(var e=0;e<this.chain.length;e++){c(this,this.state===1?this.chain[e].success:this.chain[e].failure,this.chain[e])}this.chain.length=0}function c(e,t,r){var a,n;try{if(t===false){r.reject(e.msg)}else{if(t===true){a=e.msg}else{a=t.call(void 0,e.msg)}if(a===r.promise){r.reject(TypeError("Promise-chain cycle"))}else if(n=l(a)){n.call(a,r.resolve,r.reject)}else{r.resolve(a)}}}catch(y){r.reject(y)}}function f(e){var t,r=this;if(r.triggered){return}r.triggered=true;if(r.def){r=r.def}try{if(t=l(e)){s((function(){var a=new v(r);try{t.call(e,(function e(){f.apply(a,arguments)}),(function e(){h.apply(a,arguments)}))}catch(y){h.call(a,y)}}))}else{r.msg=e;r.state=1;if(r.chain.length>0){s(u,r)}}}catch(y){h.call(new v(r),y)}}function h(e){var t=this;if(t.triggered){return}t.triggered=true;if(t.def){t=t.def}t.msg=e;t.state=2;if(t.chain.length>0){s(u,t)}}function p(e,t,r,a){for(var n=0;n<t.length;n++){(function n(i){e.resolve(t[i]).then((function e(t){r(i,t)}),a)})(n)}}function v(e){this.def=e;this.triggered=false}function d(e){this.promise=e;this.state=0;this.triggered=false;this.chain=[];this.msg=void 0}function m(e){if(typeof e!="function"){throw TypeError("Not a function")}if(this.__NPO__!==0){throw TypeError("Not a promise")}this.__NPO__=1;var t=new d(this);this["then"]=function e(r,a){var n={success:typeof r=="function"?r:true,failure:typeof a=="function"?a:false};n.promise=new this.constructor((function e(t,r){if(typeof t!="function"||typeof r!="function"){throw TypeError("Not a function")}n.resolve=t;n.reject=r}));t.chain.push(n);if(t.state!==0){s(u,t)}return n.promise};this["catch"]=function e(t){return this.then(void 0,t)};try{e.call(void 0,(function e(r){f.call(t,r)}),(function e(r){h.call(t,r)}))}catch(y){h.call(t,y)}}var g=t({},"constructor",m,false);m.prototype=g;t(g,"__NPO__",0,false);t(m,"resolve",(function e(t){var r=this;if(t&&typeof t=="object"&&t.__NPO__===1){return t}return new r((function e(r,a){if(typeof r!="function"||typeof a!="function"){throw TypeError("Not a function")}r(t)}))}));t(m,"reject",(function e(t){return new this((function e(r,a){if(typeof r!="function"||typeof a!="function"){throw TypeError("Not a function")}a(t)}))}));t(m,"all",(function e(t){var r=this;if(i.call(t)!="[object Array]"){return r.reject(TypeError("Not an array"))}if(t.length===0){return r.resolve([])}return new r((function e(a,n){if(typeof a!="function"||typeof n!="function"){throw TypeError("Not a function")}var i=t.length,o=Array(i),s=0;p(r,t,(function e(t,r){o[t]=r;if(++s===i){a(o)}}),n)}))}));t(m,"race",(function e(t){var r=this;if(i.call(t)!="[object Array]"){return r.reject(TypeError("Not an array"))}return new r((function e(a,n){if(typeof a!="function"||typeof n!="function"){throw TypeError("Not a function")}p(r,t,(function e(t,r){a(r)}),n)}))}));return m}))}).call(this)}).call(this,typeof t!=="undefined"?t:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{},r("timers").setImmediate)},{timers:582}],464:[function(e,t,r){"use strict";var a=e("typedarray-pool");t.exports=o;var n={"false,0,1":function e(t,r,a,n,i){return function e(o,s,l,u){var c=o.shape[0]|0,f=o.shape[1]|0,h=o.data,p=o.offset|0,v=o.stride[0]|0,d=o.stride[1]|0,m=p,g,y=-v|0,x=0,b=-d|0,_=0,w=-v-d|0,T=0,k=v|0,M=d-v*c|0,A=0,S=0,E=0,L=2*c|0,C=n(L),I=n(L),P=0,O=0,z=-1|0,D=-1|0,R=0,F=-c|0,B=c|0,N=0,j=-c-1|0,U=c-1|0,V=0,H=0,q=0;for(A=0;A<c;++A){C[P++]=a(h[m],s,l,u);m+=k}m+=M;if(f>0){S=1;C[P++]=a(h[m],s,l,u);m+=k;if(c>0){A=1;g=h[m];O=C[P]=a(g,s,l,u);R=C[P+z];N=C[P+F];V=C[P+j];if(O!==R||O!==N||O!==V){x=h[m+y];_=h[m+b];T=h[m+w];t(A,S,g,x,_,T,O,R,N,V,s,l,u);H=I[P]=E++}P+=1;m+=k;for(A=2;A<c;++A){g=h[m];O=C[P]=a(g,s,l,u);R=C[P+z];N=C[P+F];V=C[P+j];if(O!==R||O!==N||O!==V){x=h[m+y];_=h[m+b];T=h[m+w];t(A,S,g,x,_,T,O,R,N,V,s,l,u);H=I[P]=E++;if(V!==R){r(I[P+z],H,T,x,V,R,s,l,u)}}P+=1;m+=k}}m+=M;P=0;q=z;z=D;D=q;q=F;F=B;B=q;q=j;j=U;U=q;for(S=2;S<f;++S){C[P++]=a(h[m],s,l,u);m+=k;if(c>0){A=1;g=h[m];O=C[P]=a(g,s,l,u);R=C[P+z];N=C[P+F];V=C[P+j];if(O!==R||O!==N||O!==V){x=h[m+y];_=h[m+b];T=h[m+w];t(A,S,g,x,_,T,O,R,N,V,s,l,u);H=I[P]=E++;if(V!==N){r(I[P+F],H,_,T,N,V,s,l,u)}}P+=1;m+=k;for(A=2;A<c;++A){g=h[m];O=C[P]=a(g,s,l,u);R=C[P+z];N=C[P+F];V=C[P+j];if(O!==R||O!==N||O!==V){x=h[m+y];_=h[m+b];T=h[m+w];t(A,S,g,x,_,T,O,R,N,V,s,l,u);H=I[P]=E++;if(V!==N){r(I[P+F],H,_,T,N,V,s,l,u)}if(V!==R){r(I[P+z],H,T,x,V,R,s,l,u)}}P+=1;m+=k}}if(S&1){P=0}q=z;z=D;D=q;q=F;F=B;B=q;q=j;j=U;U=q;m+=M}}i(I);i(C)}},"false,1,0":function e(t,r,a,n,i){return function e(o,s,l,u){var c=o.shape[0]|0,f=o.shape[1]|0,h=o.data,p=o.offset|0,v=o.stride[0]|0,d=o.stride[1]|0,m=p,g,y=-v|0,x=0,b=-d|0,_=0,w=-v-d|0,T=0,k=d|0,M=v-d*f|0,A=0,S=0,E=0,L=2*f|0,C=n(L),I=n(L),P=0,O=0,z=-1|0,D=-1|0,R=0,F=-f|0,B=f|0,N=0,j=-f-1|0,U=f-1|0,V=0,H=0,q=0;for(S=0;S<f;++S){C[P++]=a(h[m],s,l,u);m+=k}m+=M;if(c>0){A=1;C[P++]=a(h[m],s,l,u);m+=k;if(f>0){S=1;g=h[m];O=C[P]=a(g,s,l,u);N=C[P+F];R=C[P+z];V=C[P+j];if(O!==N||O!==R||O!==V){x=h[m+y];_=h[m+b];T=h[m+w];t(A,S,g,x,_,T,O,N,R,V,s,l,u);H=I[P]=E++}P+=1;m+=k;for(S=2;S<f;++S){g=h[m];O=C[P]=a(g,s,l,u);N=C[P+F];R=C[P+z];V=C[P+j];if(O!==N||O!==R||O!==V){x=h[m+y];_=h[m+b];T=h[m+w];t(A,S,g,x,_,T,O,N,R,V,s,l,u);H=I[P]=E++;if(V!==R){r(I[P+z],H,_,T,R,V,s,l,u)}}P+=1;m+=k}}m+=M;P=0;q=F;F=B;B=q;q=z;z=D;D=q;q=j;j=U;U=q;for(A=2;A<c;++A){C[P++]=a(h[m],s,l,u);m+=k;if(f>0){S=1;g=h[m];O=C[P]=a(g,s,l,u);N=C[P+F];R=C[P+z];V=C[P+j];if(O!==N||O!==R||O!==V){x=h[m+y];_=h[m+b];T=h[m+w];t(A,S,g,x,_,T,O,N,R,V,s,l,u);H=I[P]=E++;if(V!==N){r(I[P+F],H,T,x,V,N,s,l,u)}}P+=1;m+=k;for(S=2;S<f;++S){g=h[m];O=C[P]=a(g,s,l,u);N=C[P+F];R=C[P+z];V=C[P+j];if(O!==N||O!==R||O!==V){x=h[m+y];_=h[m+b];T=h[m+w];t(A,S,g,x,_,T,O,N,R,V,s,l,u);H=I[P]=E++;if(V!==R){r(I[P+z],H,_,T,R,V,s,l,u)}if(V!==N){r(I[P+F],H,T,x,V,N,s,l,u)}}P+=1;m+=k}}if(A&1){P=0}q=F;F=B;B=q;q=z;z=D;D=q;q=j;j=U;U=q;m+=M}}i(I);i(C)}}};function i(e,t,r,i,o,s){var l=[s,o].join(",");var u=n[l];return u(e,t,r,a.mallocUint32,a.freeUint32)}function o(e){function t(e){throw new Error("ndarray-extract-contour: "+e)}if(typeof e!=="object"){t("Must specify arguments")}var r=e.order;if(!Array.isArray(r)){t("Must specify order")}var a=e.arrayArguments||1;if(a<1){t("Must have at least one array argument")}var n=e.scalarArguments||0;if(n<0){t("Scalar arg count must be > 0")}if(typeof e.vertex!=="function"){t("Must specify vertex creation function")}if(typeof e.cell!=="function"){t("Must specify cell creation function")}if(typeof e.phase!=="function"){t("Must specify phase function")}var o=e.getters||[];var s=new Array(a);for(var l=0;l<a;++l){if(o.indexOf(l)>=0){s[l]=true}else{s[l]=false}}return i(e.vertex,e.cell,e.phase,n,r,s)}},{"typedarray-pool":601}],465:[function(e,t,r){"use strict";var a=e("dup");var n={zero:function(e,t,r,a){var n=e[0],i=r[0];a|=0;var o=0,s=i;for(o=0;o<n;++o){t[a]=0;a+=s}},fdTemplate1:function(e,t,r,a,n,i,o){var s=e[0],l=r[0],u=i[0],c=-1*l,f=l;a|=0;o|=0;var h=0,p=l,v=u;for(h=0;h<s;++h){n[o]=.5*(t[a+c]-t[a+f]);a+=p;o+=v}},fdTemplate2:function(e,t,r,a,n,i,o,s,l,u){var c=e[0],f=e[1],h=r[0],p=r[1],v=i[0],d=i[1],m=l[0],g=l[1],y=-1*h,x=h,b=-1*p,_=p;a|=0;o|=0;u|=0;var w=0,T=0,k=p,M=h-f*p,A=d,S=v-f*d,E=g,L=m-f*g;for(T=0;T<c;++T){for(w=0;w<f;++w){n[o]=.5*(t[a+y]-t[a+x]);s[u]=.5*(t[a+b]-t[a+_]);a+=k;o+=A;u+=E}a+=M;o+=S;u+=L}}};var i={cdiff:function(e){var t={};return function r(a,n,i){var o=a.dtype,s=a.order,l=n.dtype,u=n.order,c=i.dtype,f=i.order,h=[o,s.join(),l,u.join(),c,f.join()].join(),p=t[h];if(!p){t[h]=p=e([o,s,l,u,c,f])}return p(a.shape.slice(0),a.data,a.stride,a.offset|0,n.data,n.stride,n.offset|0,i.data,i.stride,i.offset|0)}},zero:function(e){var t={};return function r(a){var n=a.dtype,i=a.order,o=[n,i.join()].join(),s=t[o];if(!s){t[o]=s=e([n,i])}return s(a.shape.slice(0),a.data,a.stride,a.offset|0)}},fdTemplate1:function(e){var t={};return function r(a,n){var i=a.dtype,o=a.order,s=n.dtype,l=n.order,u=[i,o.join(),s,l.join()].join(),c=t[u];if(!c){t[u]=c=e([i,o,s,l])}return c(a.shape.slice(0),a.data,a.stride,a.offset|0,n.data,n.stride,n.offset|0)}},fdTemplate2:function(e){var t={};return function r(a,n,i){var o=a.dtype,s=a.order,l=n.dtype,u=n.order,c=i.dtype,f=i.order,h=[o,s.join(),l,u.join(),c,f.join()].join(),p=t[h];if(!p){t[h]=p=e([o,s,l,u,c,f])}return p(a.shape.slice(0),a.data,a.stride,a.offset|0,n.data,n.stride,n.offset|0,i.data,i.stride,i.offset|0)}}};function o(e){var t=i[e.funcName];return t(s.bind(undefined,e))}function s(e){return n[e.funcName]}function l(e){return o({funcName:e.funcName})}var u={};var c={};var f={body:"",args:[],thisVars:[],localVars:[]};var h=l({funcName:"cdiff"});var p=l({funcName:"zero"});function v(e){if(e in u){return u[e]}return u[e]=l({funcName:"fdTemplate"+e})}function d(e,t,r,a){return function(e,n){var i=n.shape.slice();if(true&&i[0]>2&&i[1]>2){a(n.pick(-1,-1).lo(1,1).hi(i[0]-2,i[1]-2),e.pick(-1,-1,0).lo(1,1).hi(i[0]-2,i[1]-2),e.pick(-1,-1,1).lo(1,1).hi(i[0]-2,i[1]-2))}if(true&&i[1]>2){r(n.pick(0,-1).lo(1).hi(i[1]-2),e.pick(0,-1,1).lo(1).hi(i[1]-2));t(e.pick(0,-1,0).lo(1).hi(i[1]-2))}if(true&&i[1]>2){r(n.pick(i[0]-1,-1).lo(1).hi(i[1]-2),e.pick(i[0]-1,-1,1).lo(1).hi(i[1]-2));t(e.pick(i[0]-1,-1,0).lo(1).hi(i[1]-2))}if(true&&i[0]>2){r(n.pick(-1,0).lo(1).hi(i[0]-2),e.pick(-1,0,0).lo(1).hi(i[0]-2));t(e.pick(-1,0,1).lo(1).hi(i[0]-2))}if(true&&i[0]>2){r(n.pick(-1,i[1]-1).lo(1).hi(i[0]-2),e.pick(-1,i[1]-1,0).lo(1).hi(i[0]-2));t(e.pick(-1,i[1]-1,1).lo(1).hi(i[0]-2))}e.set(0,0,0,0);e.set(0,0,1,0);e.set(i[0]-1,0,0,0);e.set(i[0]-1,0,1,0);e.set(0,i[1]-1,0,0);e.set(0,i[1]-1,1,0);e.set(i[0]-1,i[1]-1,0,0);e.set(i[0]-1,i[1]-1,1,0);return e}}function m(e){var t=e.join();var r=c[t];if(r){return r}var a=e.length;var n=[h,p];for(var i=1;i<=a;++i){n.push(v(i))}var o=d;var r=o.apply(void 0,n);c[t]=r;return r}t.exports=function e(t,r,n){if(!Array.isArray(n)){if(typeof n==="string"){n=a(r.dimension,n)}else{n=a(r.dimension,"clamp")}}if(r.size===0){return t}if(r.dimension===0){t.set(0);return t}var i=m(n);return i(t,r)}},{dup:182}],466:[function(e,t,r){"use strict";function a(e,t){var r=Math.floor(t),a=t-r,n=0<=r&&r<e.shape[0],i=0<=r+1&&r+1<e.shape[0],o=n?+e.get(r):0,s=i?+e.get(r+1):0;return(1-a)*o+a*s}function n(e,t,r){var a=Math.floor(t),n=t-a,i=0<=a&&a<e.shape[0],o=0<=a+1&&a+1<e.shape[0],s=Math.floor(r),l=r-s,u=0<=s&&s<e.shape[1],c=0<=s+1&&s+1<e.shape[1],f=i&&u?e.get(a,s):0,h=i&&c?e.get(a,s+1):0,p=o&&u?e.get(a+1,s):0,v=o&&c?e.get(a+1,s+1):0;return(1-l)*((1-n)*f+n*p)+l*((1-n)*h+n*v)}function i(e,t,r,a){var n=Math.floor(t),i=t-n,o=0<=n&&n<e.shape[0],s=0<=n+1&&n+1<e.shape[0],l=Math.floor(r),u=r-l,c=0<=l&&l<e.shape[1],f=0<=l+1&&l+1<e.shape[1],h=Math.floor(a),p=a-h,v=0<=h&&h<e.shape[2],d=0<=h+1&&h+1<e.shape[2],m=o&&c&&v?e.get(n,l,h):0,g=o&&f&&v?e.get(n,l+1,h):0,y=s&&c&&v?e.get(n+1,l,h):0,x=s&&f&&v?e.get(n+1,l+1,h):0,b=o&&c&&d?e.get(n,l,h+1):0,_=o&&f&&d?e.get(n,l+1,h+1):0,w=s&&c&&d?e.get(n+1,l,h+1):0,T=s&&f&&d?e.get(n+1,l+1,h+1):0;return(1-p)*((1-u)*((1-i)*m+i*y)+u*((1-i)*g+i*x))+p*((1-u)*((1-i)*b+i*w)+u*((1-i)*_+i*T))}function o(e){var t=e.shape.length|0,r=new Array(t),a=new Array(t),n=new Array(t),i=new Array(t),o,s;for(o=0;o<t;++o){s=+arguments[o+1];r[o]=Math.floor(s);a[o]=s-r[o];n[o]=0<=r[o]&&r[o]<e.shape[o];i[o]=0<=r[o]+1&&r[o]+1<e.shape[o]}var l=0,u,c,f;e:for(o=0;o<1<<t;++o){c=1;f=e.offset;for(u=0;u<t;++u){if(o&1<<u){if(!i[u]){continue e}c*=a[u];f+=e.stride[u]*(r[u]+1)}else{if(!n[u]){continue e}c*=1-a[u];f+=e.stride[u]*r[u]}}l+=c*e.data[f]}return l}function s(e,t,r,s){switch(e.shape.length){case 0:return 0;case 1:return a(e,t);case 2:return n(e,t,r);case 3:return i(e,t,r,s);default:return o.apply(undefined,arguments)}}t.exports=s;t.exports.d1=a;t.exports.d2=n;t.exports.d3=i},{}],467:[function(e,t,r){"use strict";var a={"float64,2,1,0":function(){return function e(t,r,a,n,i){var o=t[0],s=t[1],l=t[2],u=a[0],c=a[1],f=a[2];n|=0;var h=0,p=0,v=0,d=f,m=c-l*f,g=u-s*c;for(v=0;v<o;++v){for(p=0;p<s;++p){for(h=0;h<l;++h){r[n]/=i;n+=d}n+=m}n+=g}}},"uint8,2,0,1,float64,2,1,0":function(){return function e(t,r,a,n,i,o,s,l){var u=t[0],c=t[1],f=t[2],h=a[0],p=a[1],v=a[2],d=o[0],m=o[1],g=o[2];n|=0;s|=0;var y=n;var x=s;for(var b=t[0]|0;b>0;){if(b<64){u=b;b=0}else{u=64;b-=64}for(var _=t[1]|0;_>0;){if(_<64){c=_;_=0}else{c=64;_-=64}n=y+b*h+_*p;s=x+b*d+_*m;var w=0,T=0,k=0,M=v,A=h-f*v,S=p-u*h,E=g,L=d-f*g,C=m-u*d;for(k=0;k<c;++k){for(T=0;T<u;++T){for(w=0;w<f;++w){r[n]=i[s]*l;n+=M;s+=E}n+=A;s+=L}n+=S;s+=C}}}}},"float32,1,0,float32,1,0":function(){return function e(t,r,a,n,i,o,s){var l=t[0],u=t[1],c=a[0],f=a[1],h=o[0],p=o[1];n|=0;s|=0;var v=0,d=0,m=f,g=c-u*f,y=p,x=h-u*p;for(d=0;d<l;++d){for(v=0;v<u;++v){r[n]=i[s];n+=m;s+=y}n+=g;s+=x}}},"float32,1,0,float32,0,1":function(){return function e(t,r,a,n,i,o,s){var l=t[0],u=t[1],c=a[0],f=a[1],h=o[0],p=o[1];n|=0;s|=0;var v=n;var d=s;for(var m=t[1]|0;m>0;){if(m<64){u=m;m=0}else{u=64;m-=64}for(var g=t[0]|0;g>0;){if(g<64){l=g;g=0}else{l=64;g-=64}n=v+m*f+g*c;s=d+m*p+g*h;var y=0,x=0,b=f,_=c-u*f,w=p,T=h-u*p;for(x=0;x<l;++x){for(y=0;y<u;++y){r[n]=i[s];n+=b;s+=w}n+=_;s+=T}}}}},"uint8,2,0,1,uint8,1,2,0":function(){return function e(t,r,a,n,i,o,s){var l=t[0],u=t[1],c=t[2],f=a[0],h=a[1],p=a[2],v=o[0],d=o[1],m=o[2];n|=0;s|=0;var g=n;var y=s;for(var x=t[2]|0;x>0;){if(x<64){c=x;x=0}else{c=64;x-=64}for(var b=t[0]|0;b>0;){if(b<64){l=b;b=0}else{l=64;b-=64}for(var _=t[1]|0;_>0;){if(_<64){u=_;_=0}else{u=64;_-=64}n=g+x*p+b*f+_*h;s=y+x*m+b*v+_*d;var w=0,T=0,k=0,M=p,A=f-c*p,S=h-l*f,E=m,L=v-c*m,C=d-l*v;for(k=0;k<u;++k){for(T=0;T<l;++T){for(w=0;w<c;++w){r[n]=i[s];n+=M;s+=E}n+=A;s+=L}n+=S;s+=C}}}}}},"uint8,2,0,1,array,2,0,1":function(){return function e(t,r,a,n,i,o,s){var l=t[0],u=t[1],c=t[2],f=a[0],h=a[1],p=a[2],v=o[0],d=o[1],m=o[2];n|=0;s|=0;var g=0,y=0,x=0,b=p,_=f-c*p,w=h-l*f,T=m,k=v-c*m,M=d-l*v;for(x=0;x<u;++x){for(y=0;y<l;++y){for(g=0;g<c;++g){r[n]=i[s];n+=b;s+=T}n+=_;s+=k}n+=w;s+=M}}}};function n(e,t){var r=t.join(",");var n=a[r];return n()}var i=n;var o={mul:function(e){var t={};return function r(a,n,i){var o=a.dtype,s=a.order,l=n.dtype,u=n.order,c=i.dtype,f=i.order,h=[o,s.join(),l,u.join(),c,f.join()].join(),p=t[h];if(!p){t[h]=p=e([o,s,l,u,c,f])}return p(a.shape.slice(0),a.data,a.stride,a.offset|0,n.data,n.stride,n.offset|0,i.data,i.stride,i.offset|0)}},muls:function(e){var t={};return function r(a,n,i){var o=a.dtype,s=a.order,l=n.dtype,u=n.order,c=[o,s.join(),l,u.join()].join(),f=t[c];if(!f){t[c]=f=e([o,s,l,u])}return f(a.shape.slice(0),a.data,a.stride,a.offset|0,n.data,n.stride,n.offset|0,i)}},mulseq:function(e){var t={};return function r(a,n){var i=a.dtype,o=a.order,s=[i,o.join()].join(),l=t[s];if(!l){t[s]=l=e([i,o])}return l(a.shape.slice(0),a.data,a.stride,a.offset|0,n)}},div:function(e){var t={};return function r(a,n,i){var o=a.dtype,s=a.order,l=n.dtype,u=n.order,c=i.dtype,f=i.order,h=[o,s.join(),l,u.join(),c,f.join()].join(),p=t[h];if(!p){t[h]=p=e([o,s,l,u,c,f])}return p(a.shape.slice(0),a.data,a.stride,a.offset|0,n.data,n.stride,n.offset|0,i.data,i.stride,i.offset|0)}},divs:function(e){var t={};return function r(a,n,i){var o=a.dtype,s=a.order,l=n.dtype,u=n.order,c=[o,s.join(),l,u.join()].join(),f=t[c];if(!f){t[c]=f=e([o,s,l,u])}return f(a.shape.slice(0),a.data,a.stride,a.offset|0,n.data,n.stride,n.offset|0,i)}},divseq:function(e){var t={};return function r(a,n){var i=a.dtype,o=a.order,s=[i,o.join()].join(),l=t[s];if(!l){t[s]=l=e([i,o])}return l(a.shape.slice(0),a.data,a.stride,a.offset|0,n)}},assign:function(e){var t={};return function r(a,n){var i=a.dtype,o=a.order,s=n.dtype,l=n.order,u=[i,o.join(),s,l.join()].join(),c=t[u];if(!c){t[u]=c=e([i,o,s,l])}return c(a.shape.slice(0),a.data,a.stride,a.offset|0,n.data,n.stride,n.offset|0)}}};function s(e){var t=o[e.funcName];return t(i.bind(undefined,e))}function l(e){return s({funcName:e.funcName})}var u={mul:"*",div:"/"};(function(){for(var e in u){r[e]=l({funcName:e});r[e+"s"]=l({funcName:e+"s"});r[e+"seq"]=l({funcName:e+"seq"})}})();r.assign=l({funcName:"assign"})},{}],468:[function(e,t,r){"use strict";var a=e("ndarray");var n=e("./doConvert.js");t.exports=function e(t,r){var i=[],o=t,s=1;while(Array.isArray(o)){i.push(o.length);s*=o.length;o=o[0]}if(i.length===0){return a()}if(!r){r=a(new Float64Array(s),i)}n(r,t);return r}},{"./doConvert.js":469,ndarray:472}],469:[function(e,t,r){"use strict";function a(){return function(e,t,r,a,n){var i=e[0],o=e[1],s=e[2],l=r[0],u=r[1],c=r[2],f=[0,0,0];a|=0;var h=0,p=0,v=0,d=c,m=u-s*c,g=l-o*u;for(v=0;v<i;++v){for(p=0;p<o;++p){for(h=0;h<s;++h){{var y=n,x;for(x=0;x<f.length-1;++x){y=y[f[x]]}t[a]=y[f[f.length-1]]}a+=d;++f[2]}a+=m;f[2]-=s;++f[1]}a+=g;f[1]-=o;++f[0]}}}function n(){return a()}var i=n;function o(e){var t={};return function r(a,n){var i=a.dtype,o=a.order,s=[i,o.join()].join(),l=t[s];if(!l){t[s]=l=e([i,o])}return l(a.shape.slice(0),a.data,a.stride,a.offset|0,n)}}function s(e){return o(i.bind(undefined,e))}function l(e){return s({funcName:e.funcName})}t.exports=l({funcName:"convert"})},{}],470:[function(e,t,r){"use strict";var a=e("typedarray-pool");function n(e){switch(e){case"uint32":return[a.mallocUint32,a.freeUint32];default:return null}}var i={"uint32,1,0":function(e,t){return function r(a,n,i,o,s,l,u,c,f,h,p){var v,d,m,g=a*s+o,y,x=e(c),b,_,w,T;for(v=a+1;v<=n;++v){d=v;g+=s;m=g;b=0;_=g;for(y=0;y<c;++y){x[b++]=i[_];_+=f}e:while(d-- >a){b=0;_=m-s;t:for(y=0;y<c;++y){w=i[_];T=x[b];if(w<T){break e}if(w>T){break t}_+=h;b+=p}b=m;_=m-s;for(y=0;y<c;++y){i[b]=i[_];b+=f;_+=f}m-=s}b=m;_=0;for(y=0;y<c;++y){i[b]=x[_++];b+=f}}t(x)}}};function o(e,t){var r=n(t);var a=[t,e].join(",");var o=i[a];if(r){return o(r[0],r[1])}else{return o()}}var s={"uint32,1,0":function(e,t,r){return function a(n,i,o,s,l,u,c,f,h,p,v){var d=(i-n+1)/6|0,m=n+d,g=i-d,y=n+i>>1,x=y-d,b=y+d,_=m,w=x,T=y,k=b,M=g,A=n+1,S=i-1,E=true,L,C,I,P,O,z,D,R,F,B=0,N=0,j=0,U,V,H,q,G,Y,W,X,Z,J,K,Q,$,ee,te,re,ae=f,ne=t(ae),ie=t(ae);V=l*_;H=l*w;re=s;e:for(U=0;U<f;++U){D=V+re;R=H+re;j=o[D]-o[R];if(j>0){C=_;_=w;w=C;break e}if(j<0){break e}re+=p}V=l*k;H=l*M;re=s;e:for(U=0;U<f;++U){D=V+re;R=H+re;j=o[D]-o[R];if(j>0){C=k;k=M;M=C;break e}if(j<0){break e}re+=p}V=l*_;H=l*T;re=s;e:for(U=0;U<f;++U){D=V+re;R=H+re;j=o[D]-o[R];if(j>0){C=_;_=T;T=C;break e}if(j<0){break e}re+=p}V=l*w;H=l*T;re=s;e:for(U=0;U<f;++U){D=V+re;R=H+re;j=o[D]-o[R];if(j>0){C=w;w=T;T=C;break e}if(j<0){break e}re+=p}V=l*_;H=l*k;re=s;e:for(U=0;U<f;++U){D=V+re;R=H+re;j=o[D]-o[R];if(j>0){C=_;_=k;k=C;break e}if(j<0){break e}re+=p}V=l*T;H=l*k;re=s;e:for(U=0;U<f;++U){D=V+re;R=H+re;j=o[D]-o[R];if(j>0){C=T;T=k;k=C;break e}if(j<0){break e}re+=p}V=l*w;H=l*M;re=s;e:for(U=0;U<f;++U){D=V+re;R=H+re;j=o[D]-o[R];if(j>0){C=w;w=M;M=C;break e}if(j<0){break e}re+=p}V=l*w;H=l*T;re=s;e:for(U=0;U<f;++U){D=V+re;R=H+re;j=o[D]-o[R];if(j>0){C=w;w=T;T=C;break e}if(j<0){break e}re+=p}V=l*k;H=l*M;re=s;e:for(U=0;U<f;++U){D=V+re;R=H+re;j=o[D]-o[R];if(j>0){C=k;k=M;M=C;break e}if(j<0){break e}re+=p}V=l*_;H=l*w;q=l*T;G=l*k;Y=l*M;W=l*m;X=l*y;Z=l*g;te=0;re=s;for(U=0;U<f;++U){D=V+re;R=H+re;F=q+re;J=G+re;K=Y+re;Q=W+re;$=X+re;ee=Z+re;ne[te]=o[R];ie[te]=o[J];E=E&&ne[te]===ie[te];I=o[D];P=o[F];O=o[K];o[Q]=I;o[$]=P;o[ee]=O;++te;re+=h}V=l*x;H=l*n;re=s;for(U=0;U<f;++U){D=V+re;R=H+re;o[D]=o[R];re+=h}V=l*b;H=l*i;re=s;for(U=0;U<f;++U){D=V+re;R=H+re;o[D]=o[R];re+=h}if(E){for(z=A;z<=S;++z){D=s+z*l;te=0;e:for(U=0;U<f;++U){j=o[D]-ne[te];if(j!==0){break e}te+=v;D+=p}if(j===0){continue}if(j<0){if(z!==A){V=l*z;H=l*A;re=s;for(U=0;U<f;++U){D=V+re;R=H+re;L=o[D];o[D]=o[R];o[R]=L;re+=h}}++A}else{while(true){D=s+S*l;te=0;e:for(U=0;U<f;++U){j=o[D]-ne[te];if(j!==0){break e}te+=v;D+=p}if(j>0){S--}else if(j<0){V=l*z;H=l*A;q=l*S;re=s;for(U=0;U<f;++U){D=V+re;R=H+re;F=q+re;L=o[D];o[D]=o[R];o[R]=o[F];o[F]=L;re+=h}++A;--S;break}else{V=l*z;H=l*S;re=s;for(U=0;U<f;++U){D=V+re;R=H+re;L=o[D];o[D]=o[R];o[R]=L;re+=h}--S;break}}}}}else{for(z=A;z<=S;++z){D=s+z*l;te=0;e:for(U=0;U<f;++U){B=o[D]-ne[te];if(B!==0){break e}te+=v;D+=p}if(B<0){if(z!==A){V=l*z;H=l*A;re=s;for(U=0;U<f;++U){D=V+re;R=H+re;L=o[D];o[D]=o[R];o[R]=L;re+=h}}++A}else{D=s+z*l;te=0;e:for(U=0;U<f;++U){N=o[D]-ie[te];if(N!==0){break e}te+=v;D+=p}if(N>0){while(true){D=s+S*l;te=0;e:for(U=0;U<f;++U){j=o[D]-ie[te];if(j!==0){break e}te+=v;D+=p}if(j>0){if(--S<z){break}continue}else{D=s+S*l;te=0;e:for(U=0;U<f;++U){j=o[D]-ne[te];if(j!==0){break e}te+=v;D+=p}if(j<0){V=l*z;H=l*A;q=l*S;re=s;for(U=0;U<f;++U){D=V+re;R=H+re;F=q+re;L=o[D];o[D]=o[R];o[R]=o[F];o[F]=L;re+=h}++A;--S}else{V=l*z;H=l*S;re=s;for(U=0;U<f;++U){D=V+re;R=H+re;L=o[D];o[D]=o[R];o[R]=L;re+=h}--S}break}}}}}}V=l*n;H=l*(A-1);te=0;re=s;for(U=0;U<f;++U){D=V+re;R=H+re;o[D]=o[R];o[R]=ne[te];++te;re+=h}V=l*i;H=l*(S+1);te=0;re=s;for(U=0;U<f;++U){D=V+re;R=H+re;o[D]=o[R];o[R]=ie[te];++te;re+=h}if(A-2-n<=32){e(n,A-2,o,s,l,u,c,f,h,p,v)}else{a(n,A-2,o,s,l,u,c,f,h,p,v)}if(i-(S+2)<=32){e(S+2,i,o,s,l,u,c,f,h,p,v)}else{a(S+2,i,o,s,l,u,c,f,h,p,v)}if(E){r(ne);r(ie);return}if(A<m&&S>g){e:while(true){D=s+A*l;te=0;re=s;for(U=0;U<f;++U){if(o[D]!==ne[te]){break e}++te;D+=h}++A}e:while(true){D=s+S*l;te=0;re=s;for(U=0;U<f;++U){if(o[D]!==ie[te]){break e}++te;D+=h}--S}for(z=A;z<=S;++z){D=s+z*l;te=0;e:for(U=0;U<f;++U){B=o[D]-ne[te];if(B!==0){break e}te+=v;D+=p}if(B===0){if(z!==A){V=l*z;H=l*A;re=s;for(U=0;U<f;++U){D=V+re;R=H+re;L=o[D];o[D]=o[R];o[R]=L;re+=h}}++A}else{D=s+z*l;te=0;e:for(U=0;U<f;++U){N=o[D]-ie[te];if(N!==0){break e}te+=v;D+=p}if(N===0){while(true){D=s+S*l;te=0;e:for(U=0;U<f;++U){j=o[D]-ie[te];if(j!==0){break e}te+=v;D+=p}if(j===0){if(--S<z){break}continue}else{D=s+S*l;te=0;e:for(U=0;U<f;++U){j=o[D]-ne[te];if(j!==0){break e}te+=v;D+=p}if(j<0){V=l*z;H=l*A;q=l*S;re=s;for(U=0;U<f;++U){D=V+re;R=H+re;F=q+re;L=o[D];o[D]=o[R];o[R]=o[F];o[F]=L;re+=h}++A;--S}else{V=l*z;H=l*S;re=s;for(U=0;U<f;++U){D=V+re;R=H+re;L=o[D];o[D]=o[R];o[R]=L;re+=h}--S}break}}}}}}r(ne);r(ie);if(S-A<=32){e(A,S,o,s,l,u,c,f,h,p,v)}else{a(A,S,o,s,l,u,c,f,h,p,v)}}}};function l(e,t,r){var a=n(t);var i=[t,e].join(",");var o=s[i];if(e.length>1&&a){return o(r,a[0],a[1])}else{return o(r)}}var u={"uint32,1,0":function(e,t){return function(r){var a=r.data,n=r.offset|0,i=r.shape,o=r.stride,s=o[0]|0,l=i[0]|0,u=o[1]|0,c=i[1]|0,f=u,h=u,p=1;if(l<=32){e(0,l-1,a,n,s,u,l,c,f,h,p)}else{t(0,l-1,a,n,s,u,l,c,f,h,p)}}}};function c(e,t){var r=[t,e].join(",");var a=u[r];var n=o(e,t);var i=l(e,t,n);return a(n,i)}t.exports=c},{"typedarray-pool":601}],471:[function(e,t,r){"use strict";var a=e("./lib/compile_sort.js");var n={};function i(e){var t=e.order;var r=e.dtype;var i=[t,r];var o=i.join(":");var s=n[o];if(!s){n[o]=s=a(t,r)}s(e);return e}t.exports=i},{"./lib/compile_sort.js":470}],472:[function(e,t,r){var a=e("is-buffer");var n=typeof Float64Array!=="undefined";function i(e,t){return e[0]-t[0]}function o(){var e=this.stride;var t=new Array(e.length);var r;for(r=0;r<t.length;++r){t[r]=[Math.abs(e[r]),r]}t.sort(i);var a=new Array(t.length);for(r=0;r<a.length;++r){a[r]=t[r][1]}return a}var s={T:function(e){function t(e){this.data=e}var r=t.prototype;r.dtype=e;r.index=function(){return-1};r.size=0;r.dimension=-1;r.shape=r.stride=r.order=[];r.lo=r.hi=r.transpose=r.step=function(){return new t(this.data)};r.get=r.set=function(){};r.pick=function(){return null};return function e(r){return new t(r)}},0:function(e,t){function r(e,t){this.data=e;this.offset=t}var a=r.prototype;a.dtype=e;a.index=function(){return this.offset};a.dimension=0;a.size=1;a.shape=a.stride=a.order=[];a.lo=a.hi=a.transpose=a.step=function e(){return new r(this.data,this.offset)};a.pick=function e(){return t(this.data)};a.valueOf=a.get=function t(){return e==="generic"?this.data.get(this.offset):this.data[this.offset]};a.set=function t(r){return e==="generic"?this.data.set(this.offset,r):this.data[this.offset]=r};return function e(t,a,n,i){return new r(t,i)}},1:function(e,t,r){function a(e,t,r,a){this.data=e;this.shape=[t];this.stride=[r];this.offset=a|0}var n=a.prototype;n.dtype=e;n.dimension=1;Object.defineProperty(n,"size",{get:function e(){return this.shape[0]}});n.order=[0];n.set=function t(r,a){return e==="generic"?this.data.set(this.offset+this.stride[0]*r,a):this.data[this.offset+this.stride[0]*r]=a};n.get=function t(r){return e==="generic"?this.data.get(this.offset+this.stride[0]*r):this.data[this.offset+this.stride[0]*r]};n.index=function e(t){return this.offset+this.stride[0]*t};n.hi=function e(t){return new a(this.data,typeof t!=="number"||t<0?this.shape[0]:t|0,this.stride[0],this.offset)};n.lo=function e(t){var r=this.offset,n=0,i=this.shape[0],o=this.stride[0];if(typeof t==="number"&&t>=0){n=t|0;r+=o*n;i-=n}return new a(this.data,i,o,r)};n.step=function e(t){var r=this.shape[0],n=this.stride[0],i=this.offset,o=0,s=Math.ceil;if(typeof t==="number"){o=t|0;if(o<0){i+=n*(r-1);r=s(-r/o)}else{r=s(r/o)}n*=o}return new a(this.data,r,n,i)};n.transpose=function e(t){t=t===undefined?0:t|0;var r=this.shape,n=this.stride;return new a(this.data,r[t],n[t],this.offset)};n.pick=function e(r){var a=[],n=[],i=this.offset;if(typeof r==="number"&&r>=0){i=i+this.stride[0]*r|0}else{a.push(this.shape[0]);n.push(this.stride[0])}var o=t[a.length+1];return o(this.data,a,n,i)};return function e(t,r,n,i){return new a(t,r[0],n[0],i)}},2:function(e,t,r){function a(e,t,r,a,n,i){this.data=e;this.shape=[t,r];this.stride=[a,n];this.offset=i|0}var n=a.prototype;n.dtype=e;n.dimension=2;Object.defineProperty(n,"size",{get:function e(){return this.shape[0]*this.shape[1]}});Object.defineProperty(n,"order",{get:function e(){return Math.abs(this.stride[0])>Math.abs(this.stride[1])?[1,0]:[0,1]}});n.set=function t(r,a,n){return e==="generic"?this.data.set(this.offset+this.stride[0]*r+this.stride[1]*a,n):this.data[this.offset+this.stride[0]*r+this.stride[1]*a]=n};n.get=function t(r,a){return e==="generic"?this.data.get(this.offset+this.stride[0]*r+this.stride[1]*a):this.data[this.offset+this.stride[0]*r+this.stride[1]*a]};n.index=function e(t,r){return this.offset+this.stride[0]*t+this.stride[1]*r};n.hi=function e(t,r){return new a(this.data,typeof t!=="number"||t<0?this.shape[0]:t|0,typeof r!=="number"||r<0?this.shape[1]:r|0,this.stride[0],this.stride[1],this.offset)};n.lo=function e(t,r){var n=this.offset,i=0,o=this.shape[0],s=this.shape[1],l=this.stride[0],u=this.stride[1];if(typeof t==="number"&&t>=0){i=t|0;n+=l*i;o-=i}if(typeof r==="number"&&r>=0){i=r|0;n+=u*i;s-=i}return new a(this.data,o,s,l,u,n)};n.step=function e(t,r){var n=this.shape[0],i=this.shape[1],o=this.stride[0],s=this.stride[1],l=this.offset,u=0,c=Math.ceil;if(typeof t==="number"){u=t|0;if(u<0){l+=o*(n-1);n=c(-n/u)}else{n=c(n/u)}o*=u}if(typeof r==="number"){u=r|0;if(u<0){l+=s*(i-1);i=c(-i/u)}else{i=c(i/u)}s*=u}return new a(this.data,n,i,o,s,l)};n.transpose=function e(t,r){t=t===undefined?0:t|0;r=r===undefined?1:r|0;var n=this.shape,i=this.stride;return new a(this.data,n[t],n[r],i[t],i[r],this.offset)};n.pick=function e(r,a){var n=[],i=[],o=this.offset;if(typeof r==="number"&&r>=0){o=o+this.stride[0]*r|0}else{n.push(this.shape[0]);i.push(this.stride[0])}if(typeof a==="number"&&a>=0){o=o+this.stride[1]*a|0}else{n.push(this.shape[1]);i.push(this.stride[1])}var s=t[n.length+1];return s(this.data,n,i,o)};return function e(t,r,n,i){return new a(t,r[0],r[1],n[0],n[1],i)}},3:function(e,t,r){function a(e,t,r,a,n,i,o,s){this.data=e;this.shape=[t,r,a];this.stride=[n,i,o];this.offset=s|0}var n=a.prototype;n.dtype=e;n.dimension=3;Object.defineProperty(n,"size",{get:function e(){return this.shape[0]*this.shape[1]*this.shape[2]}});Object.defineProperty(n,"order",{get:function e(){var t=Math.abs(this.stride[0]),r=Math.abs(this.stride[1]),a=Math.abs(this.stride[2]);if(t>r){if(r>a){return[2,1,0]}else if(t>a){return[1,2,0]}else{return[1,0,2]}}else if(t>a){return[2,0,1]}else if(a>r){return[0,1,2]}else{return[0,2,1]}}});n.set=function t(r,a,n,i){return e==="generic"?this.data.set(this.offset+this.stride[0]*r+this.stride[1]*a+this.stride[2]*n,i):this.data[this.offset+this.stride[0]*r+this.stride[1]*a+this.stride[2]*n]=i};n.get=function t(r,a,n){return e==="generic"?this.data.get(this.offset+this.stride[0]*r+this.stride[1]*a+this.stride[2]*n):this.data[this.offset+this.stride[0]*r+this.stride[1]*a+this.stride[2]*n]};n.index=function e(t,r,a){return this.offset+this.stride[0]*t+this.stride[1]*r+this.stride[2]*a};n.hi=function e(t,r,n){return new a(this.data,typeof t!=="number"||t<0?this.shape[0]:t|0,typeof r!=="number"||r<0?this.shape[1]:r|0,typeof n!=="number"||n<0?this.shape[2]:n|0,this.stride[0],this.stride[1],this.stride[2],this.offset)};n.lo=function e(t,r,n){var i=this.offset,o=0,s=this.shape[0],l=this.shape[1],u=this.shape[2],c=this.stride[0],f=this.stride[1],h=this.stride[2];if(typeof t==="number"&&t>=0){o=t|0;i+=c*o;s-=o}if(typeof r==="number"&&r>=0){o=r|0;i+=f*o;l-=o}if(typeof n==="number"&&n>=0){o=n|0;i+=h*o;u-=o}return new a(this.data,s,l,u,c,f,h,i)};n.step=function e(t,r,n){var i=this.shape[0],o=this.shape[1],s=this.shape[2],l=this.stride[0],u=this.stride[1],c=this.stride[2],f=this.offset,h=0,p=Math.ceil;if(typeof t==="number"){h=t|0;if(h<0){f+=l*(i-1);i=p(-i/h)}else{i=p(i/h)}l*=h}if(typeof r==="number"){h=r|0;if(h<0){f+=u*(o-1);o=p(-o/h)}else{o=p(o/h)}u*=h}if(typeof n==="number"){h=n|0;if(h<0){f+=c*(s-1);s=p(-s/h)}else{s=p(s/h)}c*=h}return new a(this.data,i,o,s,l,u,c,f)};n.transpose=function e(t,r,n){t=t===undefined?0:t|0;r=r===undefined?1:r|0;n=n===undefined?2:n|0;var i=this.shape,o=this.stride;return new a(this.data,i[t],i[r],i[n],o[t],o[r],o[n],this.offset)};n.pick=function e(r,a,n){var i=[],o=[],s=this.offset;if(typeof r==="number"&&r>=0){s=s+this.stride[0]*r|0}else{i.push(this.shape[0]);o.push(this.stride[0])}if(typeof a==="number"&&a>=0){s=s+this.stride[1]*a|0}else{i.push(this.shape[1]);o.push(this.stride[1])}if(typeof n==="number"&&n>=0){s=s+this.stride[2]*n|0}else{i.push(this.shape[2]);o.push(this.stride[2])}var l=t[i.length+1];return l(this.data,i,o,s)};return function e(t,r,n,i){return new a(t,r[0],r[1],r[2],n[0],n[1],n[2],i)}},4:function(e,t,r){function a(e,t,r,a,n,i,o,s,l,u){this.data=e;this.shape=[t,r,a,n];this.stride=[i,o,s,l];this.offset=u|0}var n=a.prototype;n.dtype=e;n.dimension=4;Object.defineProperty(n,"size",{get:function e(){return this.shape[0]*this.shape[1]*this.shape[2]*this.shape[3]}});Object.defineProperty(n,"order",{get:r});n.set=function t(r,a,n,i,o){return e==="generic"?this.data.set(this.offset+this.stride[0]*r+this.stride[1]*a+this.stride[2]*n+this.stride[3]*i,o):this.data[this.offset+this.stride[0]*r+this.stride[1]*a+this.stride[2]*n+this.stride[3]*i]=o};n.get=function t(r,a,n,i){return e==="generic"?this.data.get(this.offset+this.stride[0]*r+this.stride[1]*a+this.stride[2]*n+this.stride[3]*i):this.data[this.offset+this.stride[0]*r+this.stride[1]*a+this.stride[2]*n+this.stride[3]*i]};n.index=function e(t,r,a,n){return this.offset+this.stride[0]*t+this.stride[1]*r+this.stride[2]*a+this.stride[3]*n};n.hi=function e(t,r,n,i){return new a(this.data,typeof t!=="number"||t<0?this.shape[0]:t|0,typeof r!=="number"||r<0?this.shape[1]:r|0,typeof n!=="number"||n<0?this.shape[2]:n|0,typeof i!=="number"||i<0?this.shape[3]:i|0,this.stride[0],this.stride[1],this.stride[2],this.stride[3],this.offset)};n.lo=function e(t,r,n,i){var o=this.offset,s=0,l=this.shape[0],u=this.shape[1],c=this.shape[2],f=this.shape[3],h=this.stride[0],p=this.stride[1],v=this.stride[2],d=this.stride[3];if(typeof t==="number"&&t>=0){s=t|0;o+=h*s;l-=s}if(typeof r==="number"&&r>=0){s=r|0;o+=p*s;u-=s}if(typeof n==="number"&&n>=0){s=n|0;o+=v*s;c-=s}if(typeof i==="number"&&i>=0){s=i|0;o+=d*s;f-=s}return new a(this.data,l,u,c,f,h,p,v,d,o)};n.step=function e(t,r,n,i){var o=this.shape[0],s=this.shape[1],l=this.shape[2],u=this.shape[3],c=this.stride[0],f=this.stride[1],h=this.stride[2],p=this.stride[3],v=this.offset,d=0,m=Math.ceil;if(typeof t==="number"){d=t|0;if(d<0){v+=c*(o-1);o=m(-o/d)}else{o=m(o/d)}c*=d}if(typeof r==="number"){d=r|0;if(d<0){v+=f*(s-1);s=m(-s/d)}else{s=m(s/d)}f*=d}if(typeof n==="number"){d=n|0;if(d<0){v+=h*(l-1);l=m(-l/d)}else{l=m(l/d)}h*=d}if(typeof i==="number"){d=i|0;if(d<0){v+=p*(u-1);u=m(-u/d)}else{u=m(u/d)}p*=d}return new a(this.data,o,s,l,u,c,f,h,p,v)};n.transpose=function e(t,r,n,i){t=t===undefined?0:t|0;r=r===undefined?1:r|0;n=n===undefined?2:n|0;i=i===undefined?3:i|0;var o=this.shape,s=this.stride;return new a(this.data,o[t],o[r],o[n],o[i],s[t],s[r],s[n],s[i],this.offset)};n.pick=function e(r,a,n,i){var o=[],s=[],l=this.offset;if(typeof r==="number"&&r>=0){l=l+this.stride[0]*r|0}else{o.push(this.shape[0]);s.push(this.stride[0])}if(typeof a==="number"&&a>=0){l=l+this.stride[1]*a|0}else{o.push(this.shape[1]);s.push(this.stride[1])}if(typeof n==="number"&&n>=0){l=l+this.stride[2]*n|0}else{o.push(this.shape[2]);s.push(this.stride[2])}if(typeof i==="number"&&i>=0){l=l+this.stride[3]*i|0}else{o.push(this.shape[3]);s.push(this.stride[3])}var u=t[o.length+1];return u(this.data,o,s,l)};return function e(t,r,n,i){return new a(t,r[0],r[1],r[2],r[3],n[0],n[1],n[2],n[3],i)}},5:function e(t,r,a){function n(e,t,r,a,n,i,o,s,l,u,c,f){this.data=e;this.shape=[t,r,a,n,i];this.stride=[o,s,l,u,c];this.offset=f|0}var i=n.prototype;i.dtype=t;i.dimension=5;Object.defineProperty(i,"size",{get:function e(){return this.shape[0]*this.shape[1]*this.shape[2]*this.shape[3]*this.shape[4]}});Object.defineProperty(i,"order",{get:a});i.set=function e(r,a,n,i,o,s){return t==="generic"?this.data.set(this.offset+this.stride[0]*r+this.stride[1]*a+this.stride[2]*n+this.stride[3]*i+this.stride[4]*o,s):this.data[this.offset+this.stride[0]*r+this.stride[1]*a+this.stride[2]*n+this.stride[3]*i+this.stride[4]*o]=s};i.get=function e(r,a,n,i,o){return t==="generic"?this.data.get(this.offset+this.stride[0]*r+this.stride[1]*a+this.stride[2]*n+this.stride[3]*i+this.stride[4]*o):this.data[this.offset+this.stride[0]*r+this.stride[1]*a+this.stride[2]*n+this.stride[3]*i+this.stride[4]*o]};i.index=function e(t,r,a,n,i){return this.offset+this.stride[0]*t+this.stride[1]*r+this.stride[2]*a+this.stride[3]*n+this.stride[4]*i};i.hi=function e(t,r,a,i,o){return new n(this.data,typeof t!=="number"||t<0?this.shape[0]:t|0,typeof r!=="number"||r<0?this.shape[1]:r|0,typeof a!=="number"||a<0?this.shape[2]:a|0,typeof i!=="number"||i<0?this.shape[3]:i|0,typeof o!=="number"||o<0?this.shape[4]:o|0,this.stride[0],this.stride[1],this.stride[2],this.stride[3],this.stride[4],this.offset)};i.lo=function e(t,r,a,i,o){var s=this.offset,l=0,u=this.shape[0],c=this.shape[1],f=this.shape[2],h=this.shape[3],p=this.shape[4],v=this.stride[0],d=this.stride[1],m=this.stride[2],g=this.stride[3],y=this.stride[4];if(typeof t==="number"&&t>=0){l=t|0;s+=v*l;u-=l}if(typeof r==="number"&&r>=0){l=r|0;s+=d*l;c-=l}if(typeof a==="number"&&a>=0){l=a|0;s+=m*l;f-=l}if(typeof i==="number"&&i>=0){l=i|0;s+=g*l;h-=l}if(typeof o==="number"&&o>=0){l=o|0;s+=y*l;p-=l}return new n(this.data,u,c,f,h,p,v,d,m,g,y,s)};i.step=function e(t,r,a,i,o){var s=this.shape[0],l=this.shape[1],u=this.shape[2],c=this.shape[3],f=this.shape[4],h=this.stride[0],p=this.stride[1],v=this.stride[2],d=this.stride[3],m=this.stride[4],g=this.offset,y=0,x=Math.ceil;if(typeof t==="number"){y=t|0;if(y<0){g+=h*(s-1);s=x(-s/y)}else{s=x(s/y)}h*=y}if(typeof r==="number"){y=r|0;if(y<0){g+=p*(l-1);l=x(-l/y)}else{l=x(l/y)}p*=y}if(typeof a==="number"){y=a|0;if(y<0){g+=v*(u-1);u=x(-u/y)}else{u=x(u/y)}v*=y}if(typeof i==="number"){y=i|0;if(y<0){g+=d*(c-1);c=x(-c/y)}else{c=x(c/y)}d*=y}if(typeof o==="number"){y=o|0;if(y<0){g+=m*(f-1);f=x(-f/y)}else{f=x(f/y)}m*=y}return new n(this.data,s,l,u,c,f,h,p,v,d,m,g)};i.transpose=function e(t,r,a,i,o){t=t===undefined?0:t|0;r=r===undefined?1:r|0;a=a===undefined?2:a|0;i=i===undefined?3:i|0;o=o===undefined?4:o|0;var s=this.shape,l=this.stride;return new n(this.data,s[t],s[r],s[a],s[i],s[o],l[t],l[r],l[a],l[i],l[o],this.offset)};i.pick=function e(t,a,n,i,o){var s=[],l=[],u=this.offset;if(typeof t==="number"&&t>=0){u=u+this.stride[0]*t|0}else{s.push(this.shape[0]);l.push(this.stride[0])}if(typeof a==="number"&&a>=0){u=u+this.stride[1]*a|0}else{s.push(this.shape[1]);l.push(this.stride[1])}if(typeof n==="number"&&n>=0){u=u+this.stride[2]*n|0}else{s.push(this.shape[2]);l.push(this.stride[2])}if(typeof i==="number"&&i>=0){u=u+this.stride[3]*i|0}else{s.push(this.shape[3]);l.push(this.stride[3])}if(typeof o==="number"&&o>=0){u=u+this.stride[4]*o|0}else{s.push(this.shape[4]);l.push(this.stride[4])}var c=r[s.length+1];return c(this.data,s,l,u)};return function e(t,r,a,i){return new n(t,r[0],r[1],r[2],r[3],r[4],a[0],a[1],a[2],a[3],a[4],i)}}};function l(e,t){var r=t===-1?"T":String(t);var a=s[r];if(t===-1){return a(e)}else if(t===0){return a(e,c[e][0])}return a(e,c[e],o)}function u(e){if(a(e)){return"buffer"}if(n){switch(Object.prototype.toString.call(e)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8ClampedArray]":return"uint8_clamped";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object BigInt64Array]":return"bigint64";case"[object BigUint64Array]":return"biguint64"}}if(Array.isArray(e)){return"array"}return"generic"}var c={generic:[],buffer:[],array:[],float32:[],float64:[],int8:[],int16:[],int32:[],uint8_clamped:[],uint8:[],uint16:[],uint32:[],bigint64:[],biguint64:[]};(function(){for(var e in c){c[e].push(l(e,-1))}});function f(e,t,r,a){if(e===undefined){var n=c.array[0];return n([])}else if(typeof e==="number"){e=[e]}if(t===undefined){t=[e.length]}var i=t.length;if(r===undefined){r=new Array(i);for(var o=i-1,s=1;o>=0;--o){r[o]=s;s*=t[o]}}if(a===undefined){a=0;for(var o=0;o<i;++o){if(r[o]<0){a-=(t[o]-1)*r[o]}}}var f=u(e);var h=c[f];while(h.length<=i+1){h.push(l(f,h.length-1))}var n=h[i+1];return n(e,t,r,a)}t.exports=f},{"is-buffer":443}],473:[function(e,t,r){"use strict";var a=e("double-bits");var n=Math.pow(2,-1074);var i=-1>>>0;t.exports=o;function o(e,t){if(isNaN(e)||isNaN(t)){return NaN}if(e===t){return e}if(e===0){if(t<0){return-n}else{return n}}var r=a.hi(e);var o=a.lo(e);if(t>e===e>0){if(o===i){r+=1;o=0}else{o+=1}}else{if(o===0){o=i;r-=1}else{o-=1}}return a.pack(o,r)}},{"double-bits":179}],474:[function(e,t,r){var a=Math.PI;var n=c(120);t.exports=i;function i(e){var t;var r=[];var a=0;var n=0;var i=0;var u=0;var f=null;var h=null;var p=0;var v=0;for(var d=0,m=e.length;d<m;d++){var g=e[d];var y=g[0];switch(y){case"M":i=g[1];u=g[2];break;case"A":g=l(p,v,g[1],g[2],c(g[3]),g[4],g[5],g[6],g[7]);g.unshift("C");if(g.length>7){r.push(g.splice(0,7));g.unshift("C")}break;case"S":var x=p;var b=v;if(t=="C"||t=="S"){x+=x-a;b+=b-n}g=["C",x,b,g[1],g[2],g[3],g[4]];break;case"T":if(t=="Q"||t=="T"){f=p*2-f;h=v*2-h}else{f=p;h=v}g=s(p,v,f,h,g[1],g[2]);break;case"Q":f=g[1];h=g[2];g=s(p,v,g[1],g[2],g[3],g[4]);break;case"L":g=o(p,v,g[1],g[2]);break;case"H":g=o(p,v,g[1],v);break;case"V":g=o(p,v,p,g[1]);break;case"Z":g=o(p,v,i,u);break}t=y;p=g[g.length-2];v=g[g.length-1];if(g.length>4){a=g[g.length-4];n=g[g.length-3]}else{a=p;n=v}r.push(g)}return r}function o(e,t,r,a){return["C",e,t,r,a,r,a]}function s(e,t,r,a,n,i){return["C",e/3+2/3*r,t/3+2/3*a,n/3+2/3*r,i/3+2/3*a,n,i]}function l(e,t,r,i,o,s,c,f,h,p){if(!p){var v=u(e,t,-o);e=v.x;t=v.y;v=u(f,h,-o);f=v.x;h=v.y;var d=(e-f)/2;var m=(t-h)/2;var g=d*d/(r*r)+m*m/(i*i);if(g>1){g=Math.sqrt(g);r=g*r;i=g*i}var y=r*r;var x=i*i;var b=(s==c?-1:1)*Math.sqrt(Math.abs((y*x-y*m*m-x*d*d)/(y*m*m+x*d*d)));if(b==Infinity)b=1;var _=b*r*m/i+(e+f)/2;var w=b*-i*d/r+(t+h)/2;var T=Math.asin(((t-w)/i).toFixed(9));var k=Math.asin(((h-w)/i).toFixed(9));T=e<_?a-T:T;k=f<_?a-k:k;if(T<0)T=a*2+T;if(k<0)k=a*2+k;if(c&&T>k)T=T-a*2;if(!c&&k>T)k=k-a*2}else{T=p[0];k=p[1];_=p[2];w=p[3]}if(Math.abs(k-T)>n){var M=k;var A=f;var S=h;k=T+n*(c&&k>T?1:-1);f=_+r*Math.cos(k);h=w+i*Math.sin(k);var E=l(f,h,r,i,o,0,c,A,S,[k,M,_,w])}var L=Math.tan((k-T)/4);var C=4/3*r*L;var I=4/3*i*L;var P=[2*e-(e+C*Math.sin(T)),2*t-(t-I*Math.cos(T)),f+C*Math.sin(k),h-I*Math.cos(k),f,h];if(p)return P;if(E)P=P.concat(E);for(var O=0;O<P.length;){var z=u(P[O],P[O+1],o);P[O++]=z.x;P[O++]=z.y}return P}function u(e,t,r){return{x:e*Math.cos(r)-t*Math.sin(r),y:e*Math.sin(r)+t*Math.cos(r)}}function c(e){return e*(a/180)}},{}],475:[function(e,t,r){var a=1e-6;var n=1e-6;r.vertexNormals=function(e,t,r){var n=t.length;var i=new Array(n);var o=r===void 0?a:r;for(var s=0;s<n;++s){i[s]=[0,0,0]}for(var s=0;s<e.length;++s){var l=e[s];var u=0;var c=l[l.length-1];var f=l[0];for(var h=0;h<l.length;++h){u=c;c=f;f=l[(h+1)%l.length];var p=t[u];var v=t[c];var d=t[f];var m=new Array(3);var g=0;var y=new Array(3);var x=0;for(var b=0;b<3;++b){m[b]=p[b]-v[b];g+=m[b]*m[b];y[b]=d[b]-v[b];x+=y[b]*y[b]}if(g*x>o){var _=i[c];var w=1/Math.sqrt(g*x);for(var b=0;b<3;++b){var T=(b+1)%3;var k=(b+2)%3;_[b]+=w*(y[T]*m[k]-y[k]*m[T])}}}}for(var s=0;s<n;++s){var _=i[s];var M=0;for(var b=0;b<3;++b){M+=_[b]*_[b]}if(M>o){var w=1/Math.sqrt(M);for(var b=0;b<3;++b){_[b]*=w}}else{for(var b=0;b<3;++b){_[b]=0}}}return i};r.faceNormals=function(e,t,r){var a=e.length;var i=new Array(a);var o=r===void 0?n:r;for(var s=0;s<a;++s){var l=e[s];var u=new Array(3);for(var c=0;c<3;++c){u[c]=t[l[c]]}var f=new Array(3);var h=new Array(3);for(var c=0;c<3;++c){f[c]=u[1][c]-u[0][c];h[c]=u[2][c]-u[0][c]}var p=new Array(3);var v=0;for(var c=0;c<3;++c){var d=(c+1)%3;var m=(c+2)%3;p[c]=f[d]*h[m]-f[m]*h[d];v+=p[c]*p[c]}if(v>o){v=1/Math.sqrt(v)}else{v=0}for(var c=0;c<3;++c){p[c]*=v}i[s]=p}return i}},{}],476:[function(e,t,r){"use strict";var a=Object.getOwnPropertySymbols;var n=Object.prototype.hasOwnProperty;var i=Object.prototype.propertyIsEnumerable;function o(e){if(e===null||e===undefined){throw new TypeError("Object.assign cannot be called with null or undefined")}return Object(e)}function s(){try{if(!Object.assign){return false}var e=new String("abc");e[5]="de";if(Object.getOwnPropertyNames(e)[0]==="5"){return false}var t={};for(var r=0;r<10;r++){t["_"+String.fromCharCode(r)]=r}var a=Object.getOwnPropertyNames(t).map((function(e){return t[e]}));if(a.join("")!=="0123456789"){return false}var n={};"abcdefghijklmnopqrst".split("").forEach((function(e){n[e]=e}));if(Object.keys(Object.assign({},n)).join("")!=="abcdefghijklmnopqrst"){return false}return true}catch(i){return false}}t.exports=s()?Object.assign:function(e,t){var r;var s=o(e);var l;for(var u=1;u<arguments.length;u++){r=Object(arguments[u]);for(var c in r){if(n.call(r,c)){s[c]=r[c]}}if(a){l=a(r);for(var f=0;f<l.length;f++){if(i.call(r,l[f])){s[l[f]]=r[l[f]]}}}}return s}},{}],477:[function(e,t,r){"use strict";t.exports=a;function a(e,t,r,a,n,i,o,s,l,u){var c=t+i+u;if(f>0){var f=Math.sqrt(c+1);e[0]=.5*(o-l)/f;e[1]=.5*(s-a)/f;e[2]=.5*(r-i)/f;e[3]=.5*f}else{var h=Math.max(t,i,u);var f=Math.sqrt(2*h-c+1);if(t>=h){e[0]=.5*f;e[1]=.5*(n+r)/f;e[2]=.5*(s+a)/f;e[3]=.5*(o-l)/f}else if(i>=h){e[0]=.5*(r+n)/f;e[1]=.5*f;e[2]=.5*(l+o)/f;e[3]=.5*(s-a)/f}else{e[0]=.5*(a+s)/f;e[1]=.5*(o+l)/f;e[2]=.5*f;e[3]=.5*(r-n)/f}}return e}},{}],478:[function(e,t,r){"use strict";t.exports=p;var a=e("filtered-vector");var n=e("gl-mat4/lookAt");var i=e("gl-mat4/fromQuat");var o=e("gl-mat4/invert");var s=e("./lib/quatFromFrame");function l(e,t,r){return Math.sqrt(Math.pow(e,2)+Math.pow(t,2)+Math.pow(r,2))}function u(e,t,r,a){return Math.sqrt(Math.pow(e,2)+Math.pow(t,2)+Math.pow(r,2)+Math.pow(a,2))}function c(e,t){var r=t[0];var a=t[1];var n=t[2];var i=t[3];var o=u(r,a,n,i);if(o>1e-6){e[0]=r/o;e[1]=a/o;e[2]=n/o;e[3]=i/o}else{e[0]=e[1]=e[2]=0;e[3]=1}}function f(e,t,r){this.radius=a([r]);this.center=a(t);this.rotation=a(e);this.computedRadius=this.radius.curve(0);this.computedCenter=this.center.curve(0);this.computedRotation=this.rotation.curve(0);this.computedUp=[.1,0,0];this.computedEye=[.1,0,0];this.computedMatrix=[.1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.recalcMatrix(0)}var h=f.prototype;h.lastT=function(){return Math.max(this.radius.lastT(),this.center.lastT(),this.rotation.lastT())};h.recalcMatrix=function(e){this.radius.curve(e);this.center.curve(e);this.rotation.curve(e);var t=this.computedRotation;c(t,t);var r=this.computedMatrix;i(r,t);var a=this.computedCenter;var n=this.computedEye;var o=this.computedUp;var s=Math.exp(this.computedRadius[0]);n[0]=a[0]+s*r[2];n[1]=a[1]+s*r[6];n[2]=a[2]+s*r[10];o[0]=r[1];o[1]=r[5];o[2]=r[9];for(var l=0;l<3;++l){var u=0;for(var f=0;f<3;++f){u+=r[l+4*f]*n[f]}r[12+l]=-u}};h.getMatrix=function(e,t){this.recalcMatrix(e);var r=this.computedMatrix;if(t){for(var a=0;a<16;++a){t[a]=r[a]}return t}return r};h.idle=function(e){this.center.idle(e);this.radius.idle(e);this.rotation.idle(e)};h.flush=function(e){this.center.flush(e);this.radius.flush(e);this.rotation.flush(e)};h.pan=function(e,t,r,a){t=t||0;r=r||0;a=a||0;this.recalcMatrix(e);var n=this.computedMatrix;var i=n[1];var o=n[5];var s=n[9];var u=l(i,o,s);i/=u;o/=u;s/=u;var c=n[0];var f=n[4];var h=n[8];var p=c*i+f*o+h*s;c-=i*p;f-=o*p;h-=s*p;var v=l(c,f,h);c/=v;f/=v;h/=v;var d=n[2];var m=n[6];var g=n[10];var y=d*i+m*o+g*s;var x=d*c+m*f+g*h;d-=y*i+x*c;m-=y*o+x*f;g-=y*s+x*h;var b=l(d,m,g);d/=b;m/=b;g/=b;var _=c*t+i*r;var w=f*t+o*r;var T=h*t+s*r;this.center.move(e,_,w,T);var k=Math.exp(this.computedRadius[0]);k=Math.max(1e-4,k+a);this.radius.set(e,Math.log(k))};h.rotate=function(e,t,r,a){this.recalcMatrix(e);t=t||0;r=r||0;var n=this.computedMatrix;var i=n[0];var o=n[4];var s=n[8];var c=n[1];var f=n[5];var h=n[9];var p=n[2];var v=n[6];var d=n[10];var m=t*i+r*c;var g=t*o+r*f;var y=t*s+r*h;var x=-(v*y-d*g);var b=-(d*m-p*y);var _=-(p*g-v*m);var w=Math.sqrt(Math.max(0,1-Math.pow(x,2)-Math.pow(b,2)-Math.pow(_,2)));var T=u(x,b,_,w);if(T>1e-6){x/=T;b/=T;_/=T;w/=T}else{x=b=_=0;w=1}var k=this.computedRotation;var M=k[0];var A=k[1];var S=k[2];var E=k[3];var L=M*w+E*x+A*_-S*b;var C=A*w+E*b+S*x-M*_;var I=S*w+E*_+M*b-A*x;var P=E*w-M*x-A*b-S*_;if(a){x=p;b=v;_=d;var O=Math.sin(a)/l(x,b,_);x*=O;b*=O;_*=O;w=Math.cos(t);L=L*w+P*x+C*_-I*b;C=C*w+P*b+I*x-L*_;I=I*w+P*_+L*b-C*x;P=P*w-L*x-C*b-I*_}var z=u(L,C,I,P);if(z>1e-6){L/=z;C/=z;I/=z;P/=z}else{L=C=I=0;P=1}this.rotation.set(e,L,C,I,P)};h.lookAt=function(e,t,r,a){this.recalcMatrix(e);r=r||this.computedCenter;t=t||this.computedEye;a=a||this.computedUp;var i=this.computedMatrix;n(i,t,r,a);var o=this.computedRotation;s(o,i[0],i[1],i[2],i[4],i[5],i[6],i[8],i[9],i[10]);c(o,o);this.rotation.set(e,o[0],o[1],o[2],o[3]);var l=0;for(var u=0;u<3;++u){l+=Math.pow(r[u]-t[u],2)}this.radius.set(e,.5*Math.log(Math.max(l,1e-6)));this.center.set(e,r[0],r[1],r[2])};h.translate=function(e,t,r,a){this.center.move(e,t||0,r||0,a||0)};h.setMatrix=function(e,t){var r=this.computedRotation;s(r,t[0],t[1],t[2],t[4],t[5],t[6],t[8],t[9],t[10]);c(r,r);this.rotation.set(e,r[0],r[1],r[2],r[3]);var a=this.computedMatrix;o(a,t);var n=a[15];if(Math.abs(n)>1e-6){var i=a[12]/n;var l=a[13]/n;var u=a[14]/n;this.recalcMatrix(e);var f=Math.exp(this.computedRadius[0]);this.center.set(e,i-a[2]*f,l-a[6]*f,u-a[10]*f);this.radius.idle(e)}else{this.center.idle(e);this.radius.idle(e)}};h.setDistance=function(e,t){if(t>0){this.radius.set(e,Math.log(t))}};h.setDistanceLimits=function(e,t){if(e>0){e=Math.log(e)}else{e=-Infinity}if(t>0){t=Math.log(t)}else{t=Infinity}t=Math.max(t,e);this.radius.bounds[0][0]=e;this.radius.bounds[1][0]=t};h.getDistanceLimits=function(e){var t=this.radius.bounds;if(e){e[0]=Math.exp(t[0][0]);e[1]=Math.exp(t[1][0]);return e}return[Math.exp(t[0][0]),Math.exp(t[1][0])]};h.toJSON=function(){this.recalcMatrix(this.lastT());return{center:this.computedCenter.slice(),rotation:this.computedRotation.slice(),distance:Math.log(this.computedRadius[0]),zoomMin:this.radius.bounds[0][0],zoomMax:this.radius.bounds[1][0]}};h.fromJSON=function(e){var t=this.lastT();var r=e.center;if(r){this.center.set(t,r[0],r[1],r[2])}var a=e.rotation;if(a){this.rotation.set(t,a[0],a[1],a[2],a[3])}var n=e.distance;if(n&&n>0){this.radius.set(t,Math.log(n))}this.setDistanceLimits(e.zoomMin,e.zoomMax)};function p(e){e=e||{};var t=e.center||[0,0,0];var r=e.rotation||[0,0,0,1];var a=e.radius||1;t=[].slice.call(t,0,3);r=[].slice.call(r,0,4);c(r,r);var n=new f(r,t,Math.log(a));n.setDistanceLimits(e.zoomMin,e.zoomMax);if("eye"in e||"up"in e){n.lookAt(0,e.eye,e.center,e.up)}return n}},{"./lib/quatFromFrame":477,"filtered-vector":247,"gl-mat4/fromQuat":282,"gl-mat4/invert":293,"gl-mat4/lookAt":294}],479:[function(e,t,r){"use strict";var a=e("repeat-string");t.exports=function e(t,r,n){n=typeof n!=="undefined"?n+"":" ";return a(n,r)+t}},{"repeat-string":527}],480:[function(e,t,r){"use strict";function a(e,t){if(typeof e!=="string")return[e];var r=[e];if(typeof t==="string"||Array.isArray(t)){t={brackets:t}}else if(!t)t={};var a=t.brackets?Array.isArray(t.brackets)?t.brackets:[t.brackets]:["{}","[]","()"];var n=t.escape||"___";var i=!!t.flat;a.forEach((function(e){var t=new RegExp(["\\",e[0],"[^\\",e[0],"\\",e[1],"]*\\",e[1]].join(""));var a=[];function i(t,i,o){var s=r.push(t.slice(e[0].length,-e[1].length))-1;a.push(s);return n+s+n}r.forEach((function(e,a){var n;var o=0;while(e!=n){n=e;e=e.replace(t,i);if(o++>1e4)throw Error("References have circular dependency. Please, check them.")}r[a]=e}));a=a.reverse();r=r.map((function(t){a.forEach((function(r){t=t.replace(new RegExp("(\\"+n+r+"\\"+n+")","g"),e[0]+"$1"+e[1])}));return t}))}));var o=new RegExp("\\"+n+"([0-9]+)"+"\\"+n);function s(e,t,r){var a=[],n;var i=0;while(n=o.exec(e)){if(i++>1e4)throw Error("Circular references in parenthesis");a.push(e.slice(0,n.index));a.push(s(t[n[1]],t));e=e.slice(n.index+n[0].length)}a.push(e);return a}return i?r:s(r[0],r)}function n(e,t){if(t&&t.flat){var r=t&&t.escape||"___";var a=e[0],n;if(!a)return"";var i=new RegExp("\\"+r+"([0-9]+)"+"\\"+r);var o=0;while(a!=n){if(o++>1e4)throw Error("Circular references in "+e);n=a;a=a.replace(i,s)}return a}return e.reduce((function e(t,r){if(Array.isArray(r)){r=r.reduce(e,"")}return t+r}),"");function s(t,r){if(e[r]==null)throw Error("Reference "+r+"is undefined");return e[r]}}function i(e,t){if(Array.isArray(e)){return n(e,t)}else{return a(e,t)}}i.parse=a;i.stringify=n;t.exports=i},{}],481:[function(e,t,r){"use strict";var a=e("pick-by-alias");t.exports=n;function n(e){var t;if(arguments.length>1){e=arguments}if(typeof e==="string"){e=e.split(/\s/).map(parseFloat)}else if(typeof e==="number"){e=[e]}if(e.length&&typeof e[0]==="number"){if(e.length===1){t={width:e[0],height:e[0],x:0,y:0}}else if(e.length===2){t={width:e[0],height:e[1],x:0,y:0}}else{t={x:e[0],y:e[1],width:e[2]-e[0]||0,height:e[3]-e[1]||0}}}else if(e){e=a(e,{left:"x l left Left",top:"y t top Top",width:"w width W Width",height:"h height W Width",bottom:"b bottom Bottom",right:"r right Right"});t={x:e.left||0,y:e.top||0};if(e.width==null){if(e.right)t.width=e.right-t.x;else t.width=0}else{t.width=e.width}if(e.height==null){if(e.bottom)t.height=e.bottom-t.y;else t.height=0}else{t.height=e.height}}return t}},{"pick-by-alias":485}],482:[function(e,t,r){t.exports=i;var a={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0};var n=/([astvzqmhlc])([^astvzqmhlc]*)/gi;function i(e){var t=[];e.replace(n,(function(e,r,n){var i=r.toLowerCase();n=s(n);if(i=="m"&&n.length>2){t.push([r].concat(n.splice(0,2)));i="l";r=r=="m"?"l":"L"}while(true){if(n.length==a[i]){n.unshift(r);return t.push(n)}if(n.length<a[i])throw new Error("malformed path data");t.push([r].concat(n.splice(0,a[i])))}}));return t}var o=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/gi;function s(e){var t=e.match(o);return t?t.map(Number):[]}},{}],483:[function(e,t,r){t.exports=function e(t,r){if(!r)r=[0,""];t=String(t);var a=parseFloat(t,10);r[0]=a;r[1]=t.match(/[\d.\-\+]*\s*(.*)/)[1]||"";return r}},{}],484:[function(e,t,r){(function(e){(function(){(function(){var r,a,n,i,o,s;if(typeof performance!=="undefined"&&performance!==null&&performance.now){t.exports=function(){return performance.now()}}else if(typeof e!=="undefined"&&e!==null&&e.hrtime){t.exports=function(){return(r()-o)/1e6};a=e.hrtime;r=function(){var e;e=a();return e[0]*1e9+e[1]};i=r();s=e.uptime()*1e9;o=i-s}else if(Date.now){t.exports=function(){return Date.now()-n};n=Date.now()}else{t.exports=function(){return(new Date).getTime()-n};n=(new Date).getTime()}}).call(this)}).call(this)}).call(this,e("_process"))},{_process:514}],485:[function(e,t,r){"use strict";t.exports=function e(t,r,a){var i={},o,s;if(typeof r==="string")r=n(r);if(Array.isArray(r)){var l={};for(s=0;s<r.length;s++){l[r[s]]=true}r=l}for(o in r){r[o]=n(r[o])}var u={};for(o in r){var c=r[o];if(Array.isArray(c)){for(s=0;s<c.length;s++){var f=c[s];if(a){u[f]=true}if(f in t){i[o]=t[f];if(a){for(var h=s;h<c.length;h++){u[c[h]]=true}}break}}}else if(o in t){if(r[o]){i[o]=t[o]}if(a){u[o]=true}}}if(a){for(o in t){if(u[o])continue;i[o]=t[o]}}return i};var a={};function n(e){if(a[e])return a[e];if(typeof e==="string"){e=a[e]=e.split(/\s*,\s*|\s+/)}return e}},{}],486:[function(e,t,r){"use strict";t.exports=n;var a=e("compare-angle");function n(e,t){var r=t.length|0;var n=e.length;var i=[new Array(r),new Array(r)];for(var o=0;o<r;++o){i[0][o]=[];i[1][o]=[]}for(var o=0;o<n;++o){var s=e[o];i[0][s[0]].push(s);i[1][s[1]].push(s)}var l=[];for(var o=0;o<r;++o){if(i[0][o].length+i[1][o].length===0){l.push([o])}}function u(e,t){var r=i[t][e[t]];r.splice(r.indexOf(e),1)}function c(e,r,n){var o,s,l;for(var c=0;c<2;++c){if(i[c][r].length>0){o=i[c][r][0];l=c;break}}s=o[l^1];for(var f=0;f<2;++f){var h=i[f][r];for(var p=0;p<h.length;++p){var v=h[p];var d=v[f^1];var m=a(t[e],t[r],t[s],t[d]);if(m>0){o=v;s=d;l=f}}}if(n){return s}if(o){u(o,l)}return s}function f(e,r){var n=i[r][e][0];var o=[e];u(n,r);var s=n[r^1];var l=r;while(true){while(s!==e){o.push(s);s=c(o[o.length-2],s,false)}if(i[0][e].length+i[1][e].length===0){break}var f=o[o.length-1];var h=e;var p=o[1];var v=c(f,h,true);if(a(t[f],t[h],t[p],t[v])<0){break}o.push(e);s=c(f,h)}return o}function h(e,t){return t[1]===t[t.length-1]}for(var o=0;o<r;++o){for(var p=0;p<2;++p){var v=[];while(i[p][o].length>0){var d=i[0][o].length;var m=f(o,p);if(h(v,m)){v.push.apply(v,m)}else{if(v.length>0){l.push(v)}v=m}}if(v.length>0){l.push(v)}}}return l}},{"compare-angle":138}],487:[function(e,t,r){"use strict";t.exports=n;var a=e("edges-to-adjacency-list");function n(e,t){var r=a(e,t.length);var n=new Array(t.length);var i=new Array(t.length);var o=[];for(var s=0;s<t.length;++s){var l=r[s].length;i[s]=l;n[s]=true;if(l<=1){o.push(s)}}while(o.length>0){var u=o.pop();n[u]=false;var c=r[u];for(var s=0;s<c.length;++s){var f=c[s];if(--i[f]===0){o.push(f)}}}var h=new Array(t.length);var p=[];for(var s=0;s<t.length;++s){if(n[s]){var u=p.length;h[s]=u;p.push(t[s])}else{h[s]=-1}}var v=[];for(var s=0;s<e.length;++s){var d=e[s];if(n[d[0]]&&n[d[1]]){v.push([h[d[0]],h[d[1]]])}}return[v,p]}},{"edges-to-adjacency-list":184}],488:[function(e,t,r){"use strict";t.exports=h;var a=e("edges-to-adjacency-list");var n=e("planar-dual");var i=e("point-in-big-polygon");var o=e("two-product");var s=e("robust-sum");var l=e("uniq");var u=e("./lib/trim-leaves");function c(e,t){var r=new Array(e);for(var a=0;a<e;++a){r[a]=t}return r}function f(e){var t=new Array(e);for(var r=0;r<e;++r){t[r]=[]}return t}function h(e,t){var r=u(e,t);e=r[0];t=r[1];var h=t.length;var p=e.length;var v=a(e,t.length);for(var d=0;d<h;++d){if(v[d].length%2===1){throw new Error("planar-graph-to-polyline: graph must be manifold")}}var m=n(e,t);function g(e){var r=e.length;var a=[0];for(var n=0;n<r;++n){var i=t[e[n]];var l=t[e[(n+1)%r]];var u=o(-i[0],i[1]);var c=o(-i[0],l[1]);var f=o(l[0],i[1]);var h=o(l[0],l[1]);a=s(a,s(s(u,c),s(f,h)))}return a[a.length-1]>0}m=m.filter(g);var y=m.length;var x=new Array(y);var b=new Array(y);for(var d=0;d<y;++d){x[d]=d;var _=new Array(y);var w=m[d].map((function(e){return t[e]}));var T=i([w]);var k=0;e:for(var M=0;M<y;++M){_[M]=0;if(d===M){continue}var A=m[M];var S=A.length;for(var E=0;E<S;++E){var L=T(t[A[E]]);if(L!==0){if(L<0){_[M]=1;k+=1}continue e}}_[M]=1;k+=1}b[d]=[k,d,_]}b.sort((function(e,t){return t[0]-e[0]}));for(var d=0;d<y;++d){var _=b[d];var C=_[1];var I=_[2];for(var M=0;M<y;++M){if(I[M]){x[M]=C}}}var P=f(y);for(var d=0;d<y;++d){P[d].push(x[d]);P[x[d]].push(d)}var O={};var z=c(h,false);for(var d=0;d<y;++d){var A=m[d];var S=A.length;for(var M=0;M<S;++M){var D=A[M];var R=A[(M+1)%S];var F=Math.min(D,R)+":"+Math.max(D,R);if(F in O){var B=O[F];P[B].push(d);P[d].push(B);z[D]=z[R]=true}else{O[F]=d}}}function N(e){var t=e.length;for(var r=0;r<t;++r){if(!z[e[r]]){return false}}return true}var j=[];var U=c(y,-1);for(var d=0;d<y;++d){if(x[d]===d&&!N(m[d])){j.push(d);U[d]=0}else{U[d]=-1}}var r=[];while(j.length>0){var V=j.pop();var H=P[V];l(H,(function(e,t){return e-t}));var q=H.length;var G=U[V];var Y;if(G===0){var A=m[V];Y=[A]}for(var d=0;d<q;++d){var W=H[d];if(U[W]>=0){continue}U[W]=G^1;j.push(W);if(G===0){var A=m[W];if(!N(A)){A.reverse();Y.push(A)}}}if(G===0){r.push(Y)}}return r}},{"./lib/trim-leaves":487,"edges-to-adjacency-list":184,"planar-dual":486,"point-in-big-polygon":489,"robust-sum":539,"two-product":588,uniq:603}],489:[function(e,t,r){t.exports=v;var a=e("robust-orientation")[3];var n=e("slab-decomposition");var i=e("interval-tree-1d");var o=e("binary-search-bounds");function s(){return true}function l(e){return function(t,r){var a=e[t];if(a){return!!a.queryPoint(r,s)}return false}}function u(e){var t={};for(var r=0;r<e.length;++r){var a=e[r];var n=a[0][0];var o=a[0][1];var s=a[1][1];var u=[Math.min(o,s),Math.max(o,s)];if(n in t){t[n].push(u)}else{t[n]=[u]}}var c={};var f=Object.keys(t);for(var r=0;r<f.length;++r){var h=t[f[r]];c[f[r]]=i(h)}return l(c)}function c(e,t){return function(r){var n=o.le(t,r[0]);if(n<0){return 1}var i=e[n];if(!i){if(n>0&&t[n]===r[0]){i=e[n-1]}else{return 1}}var s=1;while(i){var l=i.key;var u=a(r,l[0],l[1]);if(l[0][0]<l[1][0]){if(u<0){i=i.left}else if(u>0){s=-1;i=i.right}else{return 0}}else{if(u>0){i=i.left}else if(u<0){s=1;i=i.right}else{return 0}}}return s}}function f(e){return 1}function h(e){return function t(r){if(e(r[0],r[1])){return 0}return 1}}function p(e,t){return function r(a){if(e(a[0],a[1])){return 0}return t(a)}}function v(e){var t=e.length;var r=[];var a=[];var i=0;for(var o=0;o<t;++o){var s=e[o];var l=s.length;for(var v=l-1,d=0;d<l;v=d++){var m=s[v];var g=s[d];if(m[0]===g[0]){a.push([m,g])}else{r.push([m,g])}}}if(r.length===0){if(a.length===0){return f}else{return h(u(a))}}var y=n(r);var x=c(y.slabs,y.coordinates);if(a.length===0){return x}else{return p(u(a),x)}}},{"binary-search-bounds":103,"interval-tree-1d":440,"robust-orientation":534,"slab-decomposition":551}],490:[function(e,t,r){var a=e("./lib/build-log");var n=e("./lib/epsilon");var i=e("./lib/intersecter");var o=e("./lib/segment-chainer");var s=e("./lib/segment-selector");var l=e("./lib/geojson");var u=false;var c=n();var f;f={buildLog:function(e){if(e===true)u=a();else if(e===false)u=false;return u===false?false:u.list},epsilon:function(e){return c.epsilon(e)},segments:function(e){var t=i(true,c,u);e.regions.forEach(t.addRegion);return{segments:t.calculate(e.inverted),inverted:e.inverted}},combine:function(e,t){var r=i(false,c,u);return{combined:r.calculate(e.segments,e.inverted,t.segments,t.inverted),inverted1:e.inverted,inverted2:t.inverted}},selectUnion:function(e){return{segments:s.union(e.combined,u),inverted:e.inverted1||e.inverted2}},selectIntersect:function(e){return{segments:s.intersect(e.combined,u),inverted:e.inverted1&&e.inverted2}},selectDifference:function(e){return{segments:s.difference(e.combined,u),inverted:e.inverted1&&!e.inverted2}},selectDifferenceRev:function(e){return{segments:s.differenceRev(e.combined,u),inverted:!e.inverted1&&e.inverted2}},selectXor:function(e){return{segments:s.xor(e.combined,u),inverted:e.inverted1!==e.inverted2}},polygon:function(e){return{regions:o(e.segments,c,u),inverted:e.inverted}},polygonFromGeoJSON:function(e){return l.toPolygon(f,e)},polygonToGeoJSON:function(e){return l.fromPolygon(f,c,e)},union:function(e,t){return h(e,t,f.selectUnion)},intersect:function(e,t){return h(e,t,f.selectIntersect)},difference:function(e,t){return h(e,t,f.selectDifference)},differenceRev:function(e,t){return h(e,t,f.selectDifferenceRev)},xor:function(e,t){return h(e,t,f.selectXor)}};function h(e,t,r){var a=f.segments(e);var n=f.segments(t);var i=f.combine(a,n);var o=r(i);return f.polygon(o)}if(typeof window==="object")window.PolyBool=f;t.exports=f},{"./lib/build-log":491,"./lib/epsilon":492,"./lib/geojson":493,"./lib/intersecter":494,"./lib/segment-chainer":496,"./lib/segment-selector":497}],491:[function(e,t,r){function a(){var e;var t=0;var r=false;function a(t,r){e.list.push({type:t,data:r?JSON.parse(JSON.stringify(r)):void 0});return e}e={list:[],segmentId:function(){return t++},checkIntersection:function(e,t){return a("check",{seg1:e,seg2:t})},segmentChop:function(e,t){a("div_seg",{seg:e,pt:t});return a("chop",{seg:e,pt:t})},statusRemove:function(e){return a("pop_seg",{seg:e})},segmentUpdate:function(e){return a("seg_update",{seg:e})},segmentNew:function(e,t){return a("new_seg",{seg:e,primary:t})},segmentRemove:function(e){return a("rem_seg",{seg:e})},tempStatus:function(e,t,r){return a("temp_status",{seg:e,above:t,below:r})},rewind:function(e){return a("rewind",{seg:e})},status:function(e,t,r){return a("status",{seg:e,above:t,below:r})},vert:function(t){if(t===r)return e;r=t;return a("vert",{x:t})},log:function(e){if(typeof e!=="string")e=JSON.stringify(e,false,"  ");return a("log",{txt:e})},reset:function(){return a("reset")},selected:function(e){return a("selected",{segs:e})},chainStart:function(e){return a("chain_start",{seg:e})},chainRemoveHead:function(e,t){return a("chain_rem_head",{index:e,pt:t})},chainRemoveTail:function(e,t){return a("chain_rem_tail",{index:e,pt:t})},chainNew:function(e,t){return a("chain_new",{pt1:e,pt2:t})},chainMatch:function(e){return a("chain_match",{index:e})},chainClose:function(e){return a("chain_close",{index:e})},chainAddHead:function(e,t){return a("chain_add_head",{index:e,pt:t})},chainAddTail:function(e,t){return a("chain_add_tail",{index:e,pt:t})},chainConnect:function(e,t){return a("chain_con",{index1:e,index2:t})},chainReverse:function(e){return a("chain_rev",{index:e})},chainJoin:function(e,t){return a("chain_join",{index1:e,index2:t})},done:function(){return a("done")}};return e}t.exports=a},{}],492:[function(e,t,r){function a(e){if(typeof e!=="number")e=1e-10;var t={epsilon:function(t){if(typeof t==="number")e=t;return e},pointAboveOrOnLine:function(t,r,a){var n=r[0];var i=r[1];var o=a[0];var s=a[1];var l=t[0];var u=t[1];return(o-n)*(u-i)-(s-i)*(l-n)>=-e},pointBetween:function(t,r,a){var n=t[1]-r[1];var i=a[0]-r[0];var o=t[0]-r[0];var s=a[1]-r[1];var l=o*i+n*s;if(l<e)return false;var u=i*i+s*s;if(l-u>-e)return false;return true},pointsSameX:function(t,r){return Math.abs(t[0]-r[0])<e},pointsSameY:function(t,r){return Math.abs(t[1]-r[1])<e},pointsSame:function(e,r){return t.pointsSameX(e,r)&&t.pointsSameY(e,r)},pointsCompare:function(e,r){if(t.pointsSameX(e,r))return t.pointsSameY(e,r)?0:e[1]<r[1]?-1:1;return e[0]<r[0]?-1:1},pointsCollinear:function(t,r,a){var n=t[0]-r[0];var i=t[1]-r[1];var o=r[0]-a[0];var s=r[1]-a[1];return Math.abs(n*s-o*i)<e},linesIntersect:function(t,r,a,n){var i=r[0]-t[0];var o=r[1]-t[1];var s=n[0]-a[0];var l=n[1]-a[1];var u=i*l-o*s;if(Math.abs(u)<e)return false;var c=t[0]-a[0];var f=t[1]-a[1];var h=(s*f-l*c)/u;var p=(i*f-o*c)/u;var v={alongA:0,alongB:0,pt:[t[0]+h*i,t[1]+h*o]};if(h<=-e)v.alongA=-2;else if(h<e)v.alongA=-1;else if(h-1<=-e)v.alongA=0;else if(h-1<e)v.alongA=1;else v.alongA=2;if(p<=-e)v.alongB=-2;else if(p<e)v.alongB=-1;else if(p-1<=-e)v.alongB=0;else if(p-1<e)v.alongB=1;else v.alongB=2;return v},pointInsideRegion:function(t,r){var a=t[0];var n=t[1];var i=r[r.length-1][0];var o=r[r.length-1][1];var s=false;for(var l=0;l<r.length;l++){var u=r[l][0];var c=r[l][1];if(c-n>e!=o-n>e&&(i-u)*(n-c)/(o-c)+u-a>e)s=!s;i=u;o=c}return s}};return t}t.exports=a},{}],493:[function(e,t,r){var a={toPolygon:function(e,t){function r(t){if(t.length<=0)return e.segments({inverted:false,regions:[]});function r(t){var r=t.slice(0,t.length-1);return e.segments({inverted:false,regions:[r]})}var a=r(t[0]);for(var n=1;n<t.length;n++)a=e.selectDifference(e.combine(a,r(t[n])));return a}if(t.type==="Polygon"){return e.polygon(r(t.coordinates))}else if(t.type==="MultiPolygon"){var a=e.segments({inverted:false,regions:[]});for(var n=0;n<t.coordinates.length;n++)a=e.selectUnion(e.combine(a,r(t.coordinates[n])));return e.polygon(a)}throw new Error("PolyBool: Cannot convert GeoJSON object to PolyBool polygon")},fromPolygon:function(e,t,r){r=e.polygon(e.segments(r));function a(e,r){return t.pointInsideRegion([(e[0][0]+e[1][0])*.5,(e[0][1]+e[1][1])*.5],r)}function n(e){return{region:e,children:[]}}var i=n(null);function o(e,t){for(var r=0;r<e.children.length;r++){var i=e.children[r];if(a(t,i.region)){o(i,t);return}}var s=n(t);for(var r=0;r<e.children.length;r++){var i=e.children[r];if(a(i.region,t)){s.children.push(i);e.children.splice(r,1);r--}}e.children.push(s)}for(var s=0;s<r.regions.length;s++){var l=r.regions[s];if(l.length<3)continue;o(i,l)}function u(e,t){var r=0;var a=e[e.length-1][0];var n=e[e.length-1][1];var i=[];for(var o=0;o<e.length;o++){var s=e[o][0];var l=e[o][1];i.push([s,l]);r+=l*a-s*n;a=s;n=l}var u=r<0;if(u!==t)i.reverse();i.push([i[0][0],i[0][1]]);return i}var c=[];function f(e){var t=[u(e.region,false)];c.push(t);for(var r=0;r<e.children.length;r++)t.push(h(e.children[r]))}function h(e){for(var t=0;t<e.children.length;t++)f(e.children[t]);return u(e.region,true)}for(var s=0;s<i.children.length;s++)f(i.children[s]);if(c.length<=0)return{type:"Polygon",coordinates:[]};if(c.length==1)return{type:"Polygon",coordinates:c[0]};return{type:"MultiPolygon",coordinates:c}}};t.exports=a},{}],494:[function(e,t,r){var a=e("./linked-list");function n(e,t,r){function n(e,t){return{id:r?r.segmentId():-1,start:e,end:t,myFill:{above:null,below:null},otherFill:null}}function i(e,t,a){return{id:r?r.segmentId():-1,start:e,end:t,myFill:{above:a.myFill.above,below:a.myFill.below},otherFill:null}}var o=a.create();function s(e,r,a,n,i,o){var s=t.pointsCompare(r,i);if(s!==0)return s;if(t.pointsSame(a,o))return 0;if(e!==n)return e?1:-1;return t.pointAboveOrOnLine(a,n?i:o,n?o:i)?1:-1}function l(e,t){o.insertBefore(e,(function(r){var a=s(e.isStart,e.pt,t,r.isStart,r.pt,r.other.pt);return a<0}))}function u(e,t){var r=a.node({isStart:true,pt:e.start,seg:e,primary:t,other:null,status:null});l(r,e.end);return r}function c(e,t,r){var n=a.node({isStart:false,pt:t.end,seg:t,primary:r,other:e,status:null});e.other=n;l(n,e.pt)}function f(e,t){var r=u(e,t);c(r,e,t);return r}function h(e,t){if(r)r.segmentChop(e.seg,t);e.other.remove();e.seg.end=t;e.other.pt=t;l(e.other,e.pt)}function p(e,t){var r=i(t,e.seg.end,e.seg);h(e,t);return f(r,e.primary)}function v(n,i){var s=a.create();function l(e,r){var a=e.seg.start;var n=e.seg.end;var i=r.seg.start;var o=r.seg.end;if(t.pointsCollinear(a,i,o)){if(t.pointsCollinear(n,i,o))return 1;return t.pointAboveOrOnLine(n,i,o)?1:-1}return t.pointAboveOrOnLine(a,i,o)?1:-1}function u(e){return s.findTransition((function(t){var r=l(e,t.ev);return r>0}))}function c(e,a){var n=e.seg;var i=a.seg;var o=n.start;var s=n.end;var l=i.start;var u=i.end;if(r)r.checkIntersection(n,i);var c=t.linesIntersect(o,s,l,u);if(c===false){if(!t.pointsCollinear(o,s,l))return false;if(t.pointsSame(o,u)||t.pointsSame(s,l))return false;var f=t.pointsSame(o,l);var h=t.pointsSame(s,u);if(f&&h)return a;var v=!f&&t.pointBetween(o,l,u);var d=!h&&t.pointBetween(s,l,u);if(f){if(d){p(a,s)}else{p(e,u)}return a}else if(v){if(!h){if(d){p(a,s)}else{p(e,u)}}p(a,o)}}else{if(c.alongA===0){if(c.alongB===-1)p(e,l);else if(c.alongB===0)p(e,c.pt);else if(c.alongB===1)p(e,u)}if(c.alongB===0){if(c.alongA===-1)p(a,o);else if(c.alongA===0)p(a,c.pt);else if(c.alongA===1)p(a,s)}}return false}var f=[];while(!o.isEmpty()){var h=o.getHead();if(r)r.vert(h.pt[0]);if(h.isStart){if(r)r.segmentNew(h.seg,h.primary);var v=u(h);var d=v.before?v.before.ev:null;var m=v.after?v.after.ev:null;if(r){r.tempStatus(h.seg,d?d.seg:false,m?m.seg:false)}function g(){if(d){var e=c(h,d);if(e)return e}if(m)return c(h,m);return false}var y=g();if(y){if(e){var x;if(h.seg.myFill.below===null)x=true;else x=h.seg.myFill.above!==h.seg.myFill.below;if(x)y.seg.myFill.above=!y.seg.myFill.above}else{y.seg.otherFill=h.seg.myFill}if(r)r.segmentUpdate(y.seg);h.other.remove();h.remove()}if(o.getHead()!==h){if(r)r.rewind(h.seg);continue}if(e){var x;if(h.seg.myFill.below===null)x=true;else x=h.seg.myFill.above!==h.seg.myFill.below;if(!m){h.seg.myFill.below=n}else{h.seg.myFill.below=m.seg.myFill.above}if(x)h.seg.myFill.above=!h.seg.myFill.below;else h.seg.myFill.above=h.seg.myFill.below}else{if(h.seg.otherFill===null){var b;if(!m){b=h.primary?i:n}else{if(h.primary===m.primary)b=m.seg.otherFill.above;else b=m.seg.myFill.above}h.seg.otherFill={above:b,below:b}}}if(r){r.status(h.seg,d?d.seg:false,m?m.seg:false)}h.other.status=v.insert(a.node({ev:h}))}else{var _=h.status;if(_===null){throw new Error("PolyBool: Zero-length segment detected; your epsilon is "+"probably too small or too large")}if(s.exists(_.prev)&&s.exists(_.next))c(_.prev.ev,_.next.ev);if(r)r.statusRemove(_.ev.seg);_.remove();if(!h.primary){var w=h.seg.myFill;h.seg.myFill=h.seg.otherFill;h.seg.otherFill=w}f.push(h.seg)}o.getHead().remove()}if(r)r.done();return f}if(!e){return{calculate:function(e,t,r,a){e.forEach((function(e){f(i(e.start,e.end,e),true)}));r.forEach((function(e){f(i(e.start,e.end,e),false)}));return v(t,a)}}}return{addRegion:function(e){var r;var a=e[e.length-1];for(var i=0;i<e.length;i++){r=a;a=e[i];var o=t.pointsCompare(r,a);if(o===0)continue;f(n(o<0?r:a,o<0?a:r),true)}},calculate:function(e){return v(e,false)}}}t.exports=n},{"./linked-list":495}],495:[function(e,t,r){var a={create:function(){var e={root:{root:true,next:null},exists:function(t){if(t===null||t===e.root)return false;return true},isEmpty:function(){return e.root.next===null},getHead:function(){return e.root.next},insertBefore:function(t,r){var a=e.root;var n=e.root.next;while(n!==null){if(r(n)){t.prev=n.prev;t.next=n;n.prev.next=t;n.prev=t;return}a=n;n=n.next}a.next=t;t.prev=a;t.next=null},findTransition:function(t){var r=e.root;var a=e.root.next;while(a!==null){if(t(a))break;r=a;a=a.next}return{before:r===e.root?null:r,after:a,insert:function(e){e.prev=r;e.next=a;r.next=e;if(a!==null)a.prev=e;return e}}}};return e},node:function(e){e.prev=null;e.next=null;e.remove=function(){e.prev.next=e.next;if(e.next)e.next.prev=e.prev;e.prev=null;e.next=null};return e}};t.exports=a},{}],496:[function(e,t,r){function a(e,t,r){var a=[];var n=[];e.forEach((function(e){var i=e.start;var o=e.end;if(t.pointsSame(i,o)){console.warn("PolyBool: Warning: Zero-length segment detected; your epsilon is "+"probably too small or too large");return}if(r)r.chainStart(e);var s={index:0,matches_head:false,matches_pt1:false};var l={index:0,matches_head:false,matches_pt1:false};var u=s;function c(e,t,r){u.index=e;u.matches_head=t;u.matches_pt1=r;if(u===s){u=l;return false}u=null;return true}for(var f=0;f<a.length;f++){var h=a[f];var p=h[0];var v=h[1];var d=h[h.length-1];var m=h[h.length-2];if(t.pointsSame(p,i)){if(c(f,true,true))break}else if(t.pointsSame(p,o)){if(c(f,true,false))break}else if(t.pointsSame(d,i)){if(c(f,false,true))break}else if(t.pointsSame(d,o)){if(c(f,false,false))break}}if(u===s){a.push([i,o]);if(r)r.chainNew(i,o);return}if(u===l){if(r)r.chainMatch(s.index);var g=s.index;var y=s.matches_pt1?o:i;var x=s.matches_head;var h=a[g];var b=x?h[0]:h[h.length-1];var _=x?h[1]:h[h.length-2];var w=x?h[h.length-1]:h[0];var T=x?h[h.length-2]:h[1];if(t.pointsCollinear(_,b,y)){if(x){if(r)r.chainRemoveHead(s.index,y);h.shift()}else{if(r)r.chainRemoveTail(s.index,y);h.pop()}b=_}if(t.pointsSame(w,y)){a.splice(g,1);if(t.pointsCollinear(T,w,b)){if(x){if(r)r.chainRemoveTail(s.index,b);h.pop()}else{if(r)r.chainRemoveHead(s.index,b);h.shift()}}if(r)r.chainClose(s.index);n.push(h);return}if(x){if(r)r.chainAddHead(s.index,y);h.unshift(y)}else{if(r)r.chainAddTail(s.index,y);h.push(y)}return}function k(e){if(r)r.chainReverse(e);a[e].reverse()}function M(e,n){var i=a[e];var o=a[n];var s=i[i.length-1];var l=i[i.length-2];var u=o[0];var c=o[1];if(t.pointsCollinear(l,s,u)){if(r)r.chainRemoveTail(e,s);i.pop();s=l}if(t.pointsCollinear(s,u,c)){if(r)r.chainRemoveHead(n,u);o.shift()}if(r)r.chainJoin(e,n);a[e]=i.concat(o);a.splice(n,1)}var A=s.index;var S=l.index;if(r)r.chainConnect(A,S);var E=a[A].length<a[S].length;if(s.matches_head){if(l.matches_head){if(E){k(A);M(A,S)}else{k(S);M(S,A)}}else{M(S,A)}}else{if(l.matches_head){M(A,S)}else{if(E){k(A);M(S,A)}else{k(S);M(A,S)}}}}));return n}t.exports=a},{}],497:[function(e,t,r){function a(e,t,r){var a=[];e.forEach((function(e){var n=(e.myFill.above?8:0)+(e.myFill.below?4:0)+(e.otherFill&&e.otherFill.above?2:0)+(e.otherFill&&e.otherFill.below?1:0);if(t[n]!==0){a.push({id:r?r.segmentId():-1,start:e.start,end:e.end,myFill:{above:t[n]===1,below:t[n]===2},otherFill:null})}}));if(r)r.selected(a);return a}var n={union:function(e,t){return a(e,[0,2,1,0,2,2,0,0,1,0,1,0,0,0,0,0],t)},intersect:function(e,t){return a(e,[0,0,0,0,0,2,0,2,0,0,1,1,0,2,1,0],t)},difference:function(e,t){return a(e,[0,0,0,0,2,0,2,0,1,1,0,0,0,1,2,0],t)},differenceRev:function(e,t){return a(e,[0,2,1,0,0,0,1,1,0,2,0,2,0,0,0,0],t)},xor:function(e,t){return a(e,[0,2,1,0,2,0,0,1,1,0,0,2,0,1,2,0],t)}};t.exports=n},{}],498:[function(e,t,r){"use strict";var a=new Float64Array(4);var n=new Float64Array(4);var i=new Float64Array(4);function o(e,t,r,o,s){if(a.length<o.length){a=new Float64Array(o.length);n=new Float64Array(o.length);i=new Float64Array(o.length)}for(var l=0;l<o.length;++l){a[l]=e[l]-o[l];n[l]=t[l]-e[l];i[l]=r[l]-e[l]}var u=0,c=0,f=0,h=0,p=0,v=0;for(var l=0;l<o.length;++l){var d=n[l],m=i[l],g=a[l];u+=d*d;c+=d*m;f+=m*m;h+=g*d;p+=g*m;v+=g*g}var y=Math.abs(u*f-c*c);var x=c*p-f*h;var b=c*h-u*p;var _;if(x+b<=y){if(x<0){if(b<0){if(h<0){b=0;if(-h>=u){x=1;_=u+2*h+v}else{x=-h/u;_=h*x+v}}else{x=0;if(p>=0){b=0;_=v}else if(-p>=f){b=1;_=f+2*p+v}else{b=-p/f;_=p*b+v}}}else{x=0;if(p>=0){b=0;_=v}else if(-p>=f){b=1;_=f+2*p+v}else{b=-p/f;_=p*b+v}}}else if(b<0){b=0;if(h>=0){x=0;_=v}else if(-h>=u){x=1;_=u+2*h+v}else{x=-h/u;_=h*x+v}}else{var w=1/y;x*=w;b*=w;_=x*(u*x+c*b+2*h)+b*(c*x+f*b+2*p)+v}}else{var T,k,M,A;if(x<0){T=c+h;k=f+p;if(k>T){M=k-T;A=u-2*c+f;if(M>=A){x=1;b=0;_=u+2*h+v}else{x=M/A;b=1-x;_=x*(u*x+c*b+2*h)+b*(c*x+f*b+2*p)+v}}else{x=0;if(k<=0){b=1;_=f+2*p+v}else if(p>=0){b=0;_=v}else{b=-p/f;_=p*b+v}}}else if(b<0){T=c+p;k=u+h;if(k>T){M=k-T;A=u-2*c+f;if(M>=A){b=1;x=0;_=f+2*p+v}else{b=M/A;x=1-b;_=x*(u*x+c*b+2*h)+b*(c*x+f*b+2*p)+v}}else{b=0;if(k<=0){x=1;_=u+2*h+v}else if(h>=0){x=0;_=v}else{x=-h/u;_=h*x+v}}}else{M=f+p-c-h;if(M<=0){x=0;b=1;_=f+2*p+v}else{A=u-2*c+f;if(M>=A){x=1;b=0;_=u+2*h+v}else{x=M/A;b=1-x;_=x*(u*x+c*b+2*h)+b*(c*x+f*b+2*p)+v}}}}var S=1-x-b;for(var l=0;l<o.length;++l){s[l]=S*e[l]+x*t[l]+b*r[l]}if(_<0){return 0}return _}t.exports=o},{}],499:[function(e,t,r){"use strict";var a=e("stream").Transform;var n=e("stream-parser");function i(){a.call(this,{readableObjectMode:true})}i.prototype=Object.create(a.prototype);i.prototype.constructor=i;n(i.prototype);r.ParserStream=i;r.sliceEq=function(e,t,r){for(var a=t,n=0;n<r.length;){if(e[a++]!==r[n++])return false}return true};r.str2arr=function(e,t){var r=[],a=0;if(t&&t==="hex"){while(a<e.length){r.push(parseInt(e.slice(a,a+2),16));a+=2}}else{for(;a<e.length;a++){r.push(e.charCodeAt(a)&255)}}return r};r.readUInt16LE=function(e,t){return e[t]|e[t+1]<<8};r.readUInt16BE=function(e,t){return e[t+1]|e[t]<<8};r.readUInt32LE=function(e,t){return e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]*16777216};r.readUInt32BE=function(e,t){return e[t+3]|e[t+2]<<8|e[t+1]<<16|e[t]*16777216};function o(e,t,r){Error.call(this);Error.captureStackTrace(this,this.constructor);this.name=this.constructor.name;this.message=e;if(t)this.code=t;if(r)this.statusCode=r}o.prototype=Object.create(Error.prototype);o.prototype.constructor=o;r.ProbeError=o},{stream:554,"stream-parser":570}],500:[function(e,t,r){"use strict";function a(e,t){var r=new Error(e);r.code=t;return r}function n(e){try{return decodeURIComponent(escape(e))}catch(t){return e}}function i(e,t,r){this.input=e.subarray(t,r);this.start=t;var n=String.fromCharCode.apply(null,this.input.subarray(0,4));if(n!=="II*\0"&&n!=="MM\0*"){throw a("invalid TIFF signature","EBADDATA")}this.big_endian=n[0]==="M"}i.prototype.each=function(e){this.aborted=false;var t=this.read_uint32(4);this.ifds_to_read=[{id:0,offset:t}];while(this.ifds_to_read.length>0&&!this.aborted){var r=this.ifds_to_read.shift();if(!r.offset)continue;this.scan_ifd(r.id,r.offset,e)}};i.prototype.read_uint16=function(e){var t=this.input;if(e+2>t.length)throw a("unexpected EOF","EBADDATA");return this.big_endian?t[e]*256+t[e+1]:t[e]+t[e+1]*256};i.prototype.read_uint32=function(e){var t=this.input;if(e+4>t.length)throw a("unexpected EOF","EBADDATA");return this.big_endian?t[e]*16777216+t[e+1]*65536+t[e+2]*256+t[e+3]:t[e]+t[e+1]*256+t[e+2]*65536+t[e+3]*16777216};i.prototype.is_subifd_link=function(e,t){return e===0&&t===34665||e===0&&t===34853||e===34665&&t===40965};i.prototype.exif_format_length=function(e){switch(e){case 1:case 2:case 6:case 7:return 1;case 3:case 8:return 2;case 4:case 9:case 11:return 4;case 5:case 10:case 12:return 8;default:return 0}};i.prototype.exif_format_read=function(e,t){var r;switch(e){case 1:case 2:r=this.input[t];return r;case 6:r=this.input[t];return r|(r&128)*33554430;case 3:r=this.read_uint16(t);return r;case 8:r=this.read_uint16(t);return r|(r&32768)*131070;case 4:r=this.read_uint32(t);return r;case 9:r=this.read_uint32(t);return r|0;case 5:case 10:case 11:case 12:return null;case 7:return null;default:return null}};i.prototype.scan_ifd=function(e,t,r){var i=this.read_uint16(t);t+=2;for(var o=0;o<i;o++){var s=this.read_uint16(t);var l=this.read_uint16(t+2);var u=this.read_uint32(t+4);var c=this.exif_format_length(l);var f=u*c;var h=f<=4?t+8:this.read_uint32(t+8);var p=false;if(h+f>this.input.length){throw a("unexpected EOF","EBADDATA")}var v=[];var d=h;for(var m=0;m<u;m++,d+=c){var g=this.exif_format_read(l,d);if(g===null){v=null;break}v.push(g)}if(Array.isArray(v)&&l===2){v=n(String.fromCharCode.apply(null,v));if(v&&v[v.length-1]==="\0")v=v.slice(0,-1)}if(this.is_subifd_link(e,s)){if(Array.isArray(v)&&Number.isInteger(v[0])&&v[0]>0){this.ifds_to_read.push({id:s,offset:v[0]});p=true}}var y={is_big_endian:this.big_endian,ifd:e,tag:s,format:l,count:u,entry_offset:t+this.start,data_length:f,data_offset:h+this.start,value:v,is_subifd_link:p};if(r(y)===false){this.aborted=true;return}t+=12}if(e===0){this.ifds_to_read.push({id:1,offset:this.read_uint32(t)})}};t.exports.ExifParser=i;t.exports.get_orientation=function(e){var t=0;try{new i(e,0,e.length).each((function(e){if(e.ifd===0&&e.tag===274&&Array.isArray(e.value)){t=e.value[0];return false}}));return t}catch(r){return-1}}},{}],501:[function(e,t,r){"use strict";var a=e("./common").readUInt16BE;var n=e("./common").readUInt32BE;function i(e,t){if(e.length<4+t)return null;var r=n(e,t);if(e.length<r+t||r<8)return null;return{boxtype:String.fromCharCode.apply(null,e.slice(t+4,t+8)),data:e.slice(t+8,t+r),end:t+r}}t.exports.unbox=i;function o(e,t){var r=0;for(;;){var a=i(e,r);if(!a)break;switch(a.boxtype){case"ispe":t.sizes.push({width:n(a.data,4),height:n(a.data,8)});break;case"irot":t.transforms.push({type:"irot",value:a.data[0]&3});break;case"imir":t.transforms.push({type:"imir",value:a.data[0]&1});break}r=a.end}}function s(e,t,r){var a=0;for(var n=0;n<r;n++){a=a*256+(e[t+n]||0)}return a}function l(e,t){var r=e[4]>>4&15;var n=e[4]&15;var i=e[5]>>4&15;var o=a(e,6);var l=8;for(var u=0;u<o;u++){var c=a(e,l);l+=2;var f=a(e,l);l+=2;var h=s(e,l,i);l+=i;var p=a(e,l);l+=2;if(f===0&&p===1){var v=s(e,l,r);var d=s(e,l+r,n);t.item_loc[c]={length:d,offset:v+h}}l+=p*(r+n)}}function u(e,t){var r=a(e,4);var n=6;for(var o=0;o<r;o++){var s=i(e,n);if(!s)break;if(s.boxtype==="infe"){var l=a(s.data,4);var u="";for(var c=8;c<s.data.length&&s.data[c];c++){u+=String.fromCharCode(s.data[c])}t.item_inf[u]=l}n=s.end}}function c(e,t){var r=0;for(;;){var a=i(e,r);if(!a)break;if(a.boxtype==="ipco")o(a.data,t);r=a.end}}function f(e,t){var r=4;for(;;){var a=i(e,r);if(!a)break;if(a.boxtype==="iprp")c(a.data,t);if(a.boxtype==="iloc")l(a.data,t);if(a.boxtype==="iinf")u(a.data,t);r=a.end}}function h(e){var t=e.reduce((function(e,t){return e.width>t.width||e.width===t.width&&e.height>t.height?e:t}));var r=e.reduce((function(e,t){return e.height>t.height||e.height===t.height&&e.width>t.width?e:t}));var a;if(t.width>r.height||t.width===r.height&&t.height>r.width){a=t}else{a=r}return a}t.exports.readSizeFromMeta=function(e){var t={sizes:[],transforms:[],item_inf:{},item_loc:{}};f(e,t);if(!t.sizes.length)return;var r=h(t.sizes);var a=1;t.transforms.forEach((function(e){var t={1:6,2:5,3:8,4:7,5:4,6:3,7:2,8:1};var r={1:4,2:3,3:2,4:1,5:6,6:5,7:8,8:7};if(e.type==="imir"){if(e.value===0){a=r[a]}else{a=r[a];a=t[a];a=t[a]}}if(e.type==="irot"){for(var n=0;n<e.value;n++){a=t[a]}}}));var n=null;if(t.item_inf.Exif){n=t.item_loc[t.item_inf.Exif]}return{width:r.width,height:r.height,orientation:t.transforms.length?a:null,variants:t.sizes,exif_location:n}};t.exports.getMimeType=function(e){var t=String.fromCharCode.apply(null,e.slice(0,4));var r={};r[t]=true;for(var a=8;a<e.length;a+=4){r[String.fromCharCode.apply(null,e.slice(a,a+4))]=true}if(!r.mif1&&!r.msf1&&!r.miaf)return;if(t==="avif"||t==="avis"||t==="avio"){return{type:"avif",mime:"image/avif"}}if(t==="heic"||t==="heix"){return{type:"heic",mime:"image/heic"}}if(t==="hevc"||t==="hevx"){return{type:"heic",mime:"image/heic-sequence"}}if(r.avif||r.avis){return{type:"avif",mime:"image/avif"}}if(r.heic||r.heix||r.hevc||r.hevx||r.heis){if(r.msf1){return{type:"heif",mime:"image/heif-sequence"}}return{type:"heif",mime:"image/heif"}}return{type:"avif",mime:"image/avif"}}},{"./common":499}],502:[function(e,t,r){"use strict";var a=e("../common").str2arr;var n=e("../common").sliceEq;var i=e("../common").readUInt32BE;var o=e("../miaf_utils");var s=e("../exif_utils");var l=a("ftyp");t.exports=function(e){if(!n(e,4,l))return;var t=o.unbox(e,0);if(!t)return;var r=o.getMimeType(t.data);if(!r)return;var a,u=t.end;for(;;){var c=o.unbox(e,u);if(!c)break;u=c.end;if(c.boxtype==="mdat")return;if(c.boxtype==="meta"){a=c.data;break}}if(!a)return;var f=o.readSizeFromMeta(a);if(!f)return;var h={width:f.width,height:f.height,type:r.type,mime:r.mime,wUnits:"px",hUnits:"px"};if(f.variants.length>1){h.variants=f.variants}if(f.orientation){h.orientation=f.orientation}if(f.exif_location&&f.exif_location.offset+f.exif_location.length<=e.length){var p=i(e,f.exif_location.offset);var v=e.slice(f.exif_location.offset+p+4,f.exif_location.offset+f.exif_location.length);var d=s.get_orientation(v);if(d>0)h.orientation=d}return h}},{"../common":499,"../exif_utils":500,"../miaf_utils":501}],503:[function(e,t,r){"use strict";var a=e("../common").str2arr;var n=e("../common").sliceEq;var i=e("../common").readUInt16LE;var o=a("BM");t.exports=function(e){if(e.length<26)return;if(!n(e,0,o))return;return{width:i(e,18),height:i(e,22),type:"bmp",mime:"image/bmp",wUnits:"px",hUnits:"px"}}},{"../common":499}],504:[function(e,t,r){"use strict";var a=e("../common").str2arr;var n=e("../common").sliceEq;var i=e("../common").readUInt16LE;var o=a("GIF87a");var s=a("GIF89a");t.exports=function(e){if(e.length<10)return;if(!n(e,0,o)&&!n(e,0,s))return;return{width:i(e,6),height:i(e,8),type:"gif",mime:"image/gif",wUnits:"px",hUnits:"px"}}},{"../common":499}],505:[function(e,t,r){"use strict";var a=e("../common").readUInt16LE;var n=0;var i=1;var o=16;t.exports=function(e){var t=a(e,0);var r=a(e,2);var s=a(e,4);if(t!==n||r!==i||!s){return}var l=[];var u={width:0,height:0};for(var c=0;c<s;c++){var f=e[6+o*c]||256;var h=e[6+o*c+1]||256;var p={width:f,height:h};l.push(p);if(f>u.width||h>u.height){u=p}}return{width:u.width,height:u.height,variants:l,type:"ico",mime:"image/x-icon",wUnits:"px",hUnits:"px"}}},{"../common":499}],506:[function(e,t,r){"use strict";var a=e("../common").readUInt16BE;var n=e("../common").str2arr;var i=e("../common").sliceEq;var o=e("../exif_utils");var s=n("Exif\0\0");t.exports=function(e){if(e.length<2)return;if(e[0]!==255||e[1]!==216)return;var t=2;for(;;){if(e.length-t<2)return;if(e[t++]!==255)return;var r=e[t++];var n;while(r===255)r=e[t++];if(208<=r&&r<=217||r===1){n=0}else if(192<=r&&r<=254){if(e.length-t<2)return;n=a(e,t)-2;t+=2}else{return}if(r===217||r===218){return}var l;if(r===225&&n>=10&&i(e,t,s)){l=o.get_orientation(e.slice(t+6,t+n))}if(n>=5&&(192<=r&&r<=207)&&r!==196&&r!==200&&r!==204){if(e.length-t<n)return;var u={width:a(e,t+3),height:a(e,t+1),type:"jpg",mime:"image/jpeg",wUnits:"px",hUnits:"px"};if(l>0){u.orientation=l}return u}t+=n}}},{"../common":499,"../exif_utils":500}],507:[function(e,t,r){"use strict";var a=e("../common").str2arr;var n=e("../common").sliceEq;var i=e("../common").readUInt32BE;var o=a("PNG\r\n\n");var s=a("IHDR");t.exports=function(e){if(e.length<24)return;if(!n(e,0,o))return;if(!n(e,12,s))return;return{width:i(e,16),height:i(e,20),type:"png",mime:"image/png",wUnits:"px",hUnits:"px"}}},{"../common":499}],508:[function(e,t,r){"use strict";var a=e("../common").str2arr;var n=e("../common").sliceEq;var i=e("../common").readUInt32BE;var o=a("8BPS\0");t.exports=function(e){if(e.length<6+16)return;if(!n(e,0,o))return;return{width:i(e,6+12),height:i(e,6+8),type:"psd",mime:"image/vnd.adobe.photoshop",wUnits:"px",hUnits:"px"}}},{"../common":499}],509:[function(e,t,r){"use strict";function a(e){return e===32||e===9||e===13||e===10}function n(e){return typeof e==="number"&&isFinite(e)&&e>0}function i(e){var t=0,r=e.length;if(e[0]===239&&e[1]===187&&e[2]===191)t=3;while(t<r&&a(e[t]))t++;if(t===r)return false;return e[t]===60}var o=/<[-_.:a-zA-Z0-9][^>]*>/;var s=/^<([-_.:a-zA-Z0-9]+:)?svg\s/;var l=/[^-]\bwidth="([^%]+?)"|[^-]\bwidth='([^%]+?)'/;var u=/\bheight="([^%]+?)"|\bheight='([^%]+?)'/;var c=/\bview[bB]ox="(.+?)"|\bview[bB]ox='(.+?)'/;var f=/in$|mm$|cm$|pt$|pc$|px$|em$|ex$/;function h(e){var t=e.match(l);var r=e.match(u);var a=e.match(c);return{width:t&&(t[1]||t[2]),height:r&&(r[1]||r[2]),viewbox:a&&(a[1]||a[2])}}function p(e){if(!f.test(e))return"px";return e.match(f)[0]}t.exports=function(e){if(!i(e))return;var t="";for(var r=0;r<e.length;r++){t+=String.fromCharCode(e[r])}var a=(t.match(o)||[""])[0];if(!s.test(a))return;var l=h(a);var u=parseFloat(l.width);var c=parseFloat(l.height);if(l.width&&l.height){if(!n(u)||!n(c))return;return{width:u,height:c,type:"svg",mime:"image/svg+xml",wUnits:p(l.width),hUnits:p(l.height)}}var f=(l.viewbox||"").split(" ");var v={width:f[2],height:f[3]};var d=parseFloat(v.width);var m=parseFloat(v.height);if(!n(d)||!n(m))return;if(p(v.width)!==p(v.height))return;var g=d/m;if(l.width){if(!n(u))return;return{width:u,height:u/g,type:"svg",mime:"image/svg+xml",wUnits:p(l.width),hUnits:p(l.width)}}if(l.height){if(!n(c))return;return{width:c*g,height:c,type:"svg",mime:"image/svg+xml",wUnits:p(l.height),hUnits:p(l.height)}}return{width:d,height:m,type:"svg",mime:"image/svg+xml",wUnits:p(v.width),hUnits:p(v.height)}}},{}],510:[function(e,t,r){"use strict";var a=e("../common").str2arr;var n=e("../common").sliceEq;var i=e("../common").readUInt16LE;var o=e("../common").readUInt16BE;var s=e("../common").readUInt32LE;var l=e("../common").readUInt32BE;var u=a("II*\0");var c=a("MM\0*");function f(e,t,r){return r?o(e,t):i(e,t)}function h(e,t,r){return r?l(e,t):s(e,t)}function p(e,t,r){var a=f(e,t+2,r);var n=h(e,t+4,r);if(n!==1||a!==3&&a!==4)return null;if(a===3){return f(e,t+8,r)}return h(e,t+8,r)}t.exports=function(e){if(e.length<8)return;if(!n(e,0,u)&&!n(e,0,c))return;var t=e[0]===77;var r=h(e,4,t)-8;if(r<0)return;var a=r+8;if(e.length-a<2)return;var i=f(e,a+0,t)*12;if(i<=0)return;a+=2;if(e.length-a<i)return;var o,s,l,v;for(o=0;o<i;o+=12){v=f(e,a+o,t);if(v===256){s=p(e,a+o,t)}else if(v===257){l=p(e,a+o,t)}}if(s&&l){return{width:s,height:l,type:"tiff",mime:"image/tiff",wUnits:"px",hUnits:"px"}}}},{"../common":499}],511:[function(e,t,r){"use strict";var a=e("../common").str2arr;var n=e("../common").sliceEq;var i=e("../common").readUInt16LE;var o=e("../common").readUInt32LE;var s=e("../exif_utils");var l=a("RIFF");var u=a("WEBP");function c(e,t){if(e[t+3]!==157||e[t+4]!==1||e[t+5]!==42){return}return{width:i(e,t+6)&16383,height:i(e,t+8)&16383,type:"webp",mime:"image/webp",wUnits:"px",hUnits:"px"}}function f(e,t){if(e[t]!==47)return;var r=o(e,t+1);return{width:(r&16383)+1,height:(r>>14&16383)+1,type:"webp",mime:"image/webp",wUnits:"px",hUnits:"px"}}function h(e,t){return{width:(e[t+6]<<16|e[t+5]<<8|e[t+4])+1,height:(e[t+9]<<t|e[t+8]<<8|e[t+7])+1,type:"webp",mime:"image/webp",wUnits:"px",hUnits:"px"}}t.exports=function(e){if(e.length<16)return;if(!n(e,0,l)&&!n(e,8,u))return;var t=12;var r=null;var a=0;var i=o(e,4)+8;if(i>e.length)return;while(t+8<i){if(e[t]===0){t++;continue}var p=String.fromCharCode.apply(null,e.slice(t,t+4));var v=o(e,t+4);if(p==="VP8 "&&v>=10){r=r||c(e,t+8)}else if(p==="VP8L"&&v>=9){r=r||f(e,t+8)}else if(p==="VP8X"&&v>=10){r=r||h(e,t+8)}else if(p==="EXIF"){a=s.get_orientation(e.slice(t+8,t+8+v));t=Infinity}t+=8+v}if(!r)return;if(a>0){r.orientation=a}return r}},{"../common":499,"../exif_utils":500}],512:[function(e,t,r){"use strict";t.exports={avif:e("./parse_sync/avif"),bmp:e("./parse_sync/bmp"),gif:e("./parse_sync/gif"),ico:e("./parse_sync/ico"),jpeg:e("./parse_sync/jpeg"),png:e("./parse_sync/png"),psd:e("./parse_sync/psd"),svg:e("./parse_sync/svg"),tiff:e("./parse_sync/tiff"),webp:e("./parse_sync/webp")}},{"./parse_sync/avif":502,"./parse_sync/bmp":503,"./parse_sync/gif":504,"./parse_sync/ico":505,"./parse_sync/jpeg":506,"./parse_sync/png":507,"./parse_sync/psd":508,"./parse_sync/svg":509,"./parse_sync/tiff":510,"./parse_sync/webp":511}],513:[function(e,t,r){"use strict";var a=e("./lib/parsers_sync");function n(e){var t=Object.keys(a);for(var r=0;r<t.length;r++){var n=a[t[r]](e);if(n)return n}return null}t.exports=function e(t){return n(t)};t.exports.parsers=a},{"./lib/parsers_sync":512}],514:[function(e,t,r){var a=t.exports={};var n;var i;function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}(function(){try{if(typeof setTimeout==="function"){n=setTimeout}else{n=o}}catch(e){n=o}try{if(typeof clearTimeout==="function"){i=clearTimeout}else{i=s}}catch(e){i=s}})();function l(e){if(n===setTimeout){return setTimeout(e,0)}if((n===o||!n)&&setTimeout){n=setTimeout;return setTimeout(e,0)}try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}function u(e){if(i===clearTimeout){return clearTimeout(e)}if((i===s||!i)&&clearTimeout){i=clearTimeout;return clearTimeout(e)}try{return i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}var c=[];var f=false;var h;var p=-1;function v(){if(!f||!h){return}f=false;if(h.length){c=h.concat(c)}else{p=-1}if(c.length){d()}}function d(){if(f){return}var e=l(v);f=true;var t=c.length;while(t){h=c;c=[];while(++p<t){if(h){h[p].run()}}p=-1;t=c.length}h=null;f=false;u(e)}a.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1){for(var r=1;r<arguments.length;r++){t[r-1]=arguments[r]}}c.push(new m(e,t));if(c.length===1&&!f){l(d)}};function m(e,t){this.fun=e;this.array=t}m.prototype.run=function(){this.fun.apply(null,this.array)};a.title="browser";a.browser=true;a.env={};a.argv=[];a.version="";a.versions={};function g(){}a.on=g;a.addListener=g;a.once=g;a.off=g;a.removeListener=g;a.removeAllListeners=g;a.emit=g;a.prependListener=g;a.prependOnceListener=g;a.listeners=function(e){return[]};a.binding=function(e){throw new Error("process.binding is not supported")};a.cwd=function(){return"/"};a.chdir=function(e){throw new Error("process.chdir is not supported")};a.umask=function(){return 0}},{}],515:[function(e,t,r){t.exports=e("gl-quat/slerp")},{"gl-quat/slerp":322}],516:[function(e,r,a){(function(t){(function(){var a=e("performance-now"),n=typeof window==="undefined"?t:window,i=["moz","webkit"],o="AnimationFrame",s=n["request"+o],l=n["cancel"+o]||n["cancelRequest"+o];for(var u=0;!s&&u<i.length;u++){s=n[i[u]+"Request"+o];l=n[i[u]+"Cancel"+o]||n[i[u]+"CancelRequest"+o]}if(!s||!l){var c=0,f=0,h=[],p=1e3/60;s=function(e){if(h.length===0){var t=a(),r=Math.max(0,p-(t-c));c=r+t;setTimeout((function(){var e=h.slice(0);h.length=0;for(var t=0;t<e.length;t++){if(!e[t].cancelled){try{e[t].callback(c)}catch(r){setTimeout((function(){throw r}),0)}}}}),Math.round(r))}h.push({handle:++f,callback:e,cancelled:false});return f};l=function(e){for(var t=0;t<h.length;t++){if(h[t].handle===e){h[t].cancelled=true}}}}r.exports=function(e){return s.call(n,e)};r.exports.cancel=function(){l.apply(n,arguments)};r.exports.polyfill=function(e){if(!e){e=n}e.requestAnimationFrame=s;e.cancelAnimationFrame=l}}).call(this)}).call(this,typeof t!=="undefined"?t:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"performance-now":484}],517:[function(e,t,r){"use strict";var a=e("big-rat/add");t.exports=n;function n(e,t){var r=e.length;var n=new Array(r);for(var i=0;i<r;++i){n[i]=a(e[i],t[i])}return n}},{"big-rat/add":87}],518:[function(e,t,r){"use strict";t.exports=n;var a=e("big-rat");function n(e){var t=new Array(e.length);for(var r=0;r<e.length;++r){t[r]=a(e[r])}return t}},{"big-rat":90}],519:[function(e,t,r){"use strict";var a=e("big-rat");var n=e("big-rat/mul");t.exports=i;function i(e,t){var r=a(t);var i=e.length;var o=new Array(i);for(var s=0;s<i;++s){o[s]=n(e[s],r)}return o}},{"big-rat":90,"big-rat/mul":99}],520:[function(e,t,r){"use strict";var a=e("big-rat/sub");t.exports=n;function n(e,t){var r=e.length;var n=new Array(r);for(var i=0;i<r;++i){n[i]=a(e[i],t[i])}return n}},{"big-rat/sub":101}],521:[function(e,t,r){"use strict";var a=e("compare-cell");var n=e("compare-oriented-cell");var i=e("cell-orientation");t.exports=o;function o(e){e.sort(n);var t=e.length;var r=0;for(var o=0;o<t;++o){var s=e[o];var l=i(s);if(l===0){continue}if(r>0){var u=e[r-1];if(a(s,u)===0&&i(u)!==l){r-=1;continue}}e[r++]=s}e.length=r;return e}},{"cell-orientation":123,"compare-cell":139,"compare-oriented-cell":140}],522:[function(e,t,r){"use strict";var a=e("array-bounds");var n=e("color-normalize");var i=e("update-diff");var o=e("pick-by-alias");var s=e("object-assign");var l=e("flatten-vertex-data");var u=e("to-float32");var c=u.float32;var f=u.fract32;t.exports=p;var h=[[1,0,0,1,0,0],[1,0,0,-1,0,0],[-1,0,0,-1,0,0],[-1,0,0,-1,0,0],[-1,0,0,1,0,0],[1,0,0,1,0,0],[1,0,-1,0,0,1],[1,0,-1,0,0,-1],[1,0,1,0,0,-1],[1,0,1,0,0,-1],[1,0,1,0,0,1],[1,0,-1,0,0,1],[-1,0,-1,0,0,1],[-1,0,-1,0,0,-1],[-1,0,1,0,0,-1],[-1,0,1,0,0,-1],[-1,0,1,0,0,1],[-1,0,-1,0,0,1],[0,1,1,0,0,0],[0,1,-1,0,0,0],[0,-1,-1,0,0,0],[0,-1,-1,0,0,0],[0,1,1,0,0,0],[0,-1,1,0,0,0],[0,1,0,-1,1,0],[0,1,0,-1,-1,0],[0,1,0,1,-1,0],[0,1,0,1,1,0],[0,1,0,-1,1,0],[0,1,0,1,-1,0],[0,-1,0,-1,1,0],[0,-1,0,-1,-1,0],[0,-1,0,1,-1,0],[0,-1,0,1,1,0],[0,-1,0,-1,1,0],[0,-1,0,1,-1,0]];function p(e,t){if(typeof e==="function"){if(!t){t={}}t.regl=e}else{t=e}if(t.length){t.positions=t}e=t.regl;if(!e.hasExtension("ANGLE_instanced_arrays")){throw Error("regl-error2d: `ANGLE_instanced_arrays` extension should be enabled")}var r=e._gl,u,p,v,d,m,g,y={color:"black",capSize:5,lineWidth:1,opacity:1,viewport:null,range:null,offset:0,count:0,bounds:null,positions:[],errors:[]},x=[];d=e.buffer({usage:"dynamic",type:"uint8",data:new Uint8Array(0)});p=e.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)});v=e.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)});m=e.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)});g=e.buffer({usage:"static",type:"float",data:h});T(t);u=e({vert:"\n\t\tprecision highp float;\n\n\t\tattribute vec2 position, positionFract;\n\t\tattribute vec4 error;\n\t\tattribute vec4 color;\n\n\t\tattribute vec2 direction, lineOffset, capOffset;\n\n\t\tuniform vec4 viewport;\n\t\tuniform float lineWidth, capSize;\n\t\tuniform vec2 scale, scaleFract, translate, translateFract;\n\n\t\tvarying vec4 fragColor;\n\n\t\tvoid main() {\n\t\t\tfragColor = color / 255.;\n\n\t\t\tvec2 pixelOffset = lineWidth * lineOffset + (capSize + lineWidth) * capOffset;\n\n\t\t\tvec2 dxy = -step(.5, direction.xy) * error.xz + step(direction.xy, vec2(-.5)) * error.yw;\n\n\t\t\tvec2 position = position + dxy;\n\n\t\t\tvec2 pos = (position + translate) * scale\n\t\t\t\t+ (positionFract + translateFract) * scale\n\t\t\t\t+ (position + translate) * scaleFract\n\t\t\t\t+ (positionFract + translateFract) * scaleFract;\n\n\t\t\tpos += pixelOffset / viewport.zw;\n\n\t\t\tgl_Position = vec4(pos * 2. - 1., 0, 1);\n\t\t}\n\t\t",frag:"\n\t\tprecision highp float;\n\n\t\tvarying vec4 fragColor;\n\n\t\tuniform float opacity;\n\n\t\tvoid main() {\n\t\t\tgl_FragColor = fragColor;\n\t\t\tgl_FragColor.a *= opacity;\n\t\t}\n\t\t",uniforms:{range:e.prop("range"),lineWidth:e.prop("lineWidth"),capSize:e.prop("capSize"),opacity:e.prop("opacity"),scale:e.prop("scale"),translate:e.prop("translate"),scaleFract:e.prop("scaleFract"),translateFract:e.prop("translateFract"),viewport:function(e,t){return[t.viewport.x,t.viewport.y,e.viewportWidth,e.viewportHeight]}},attributes:{color:{buffer:d,offset:function(e,t){return t.offset*4},divisor:1},position:{buffer:p,offset:function(e,t){return t.offset*8},divisor:1},positionFract:{buffer:v,offset:function(e,t){return t.offset*8},divisor:1},error:{buffer:m,offset:function(e,t){return t.offset*16},divisor:1},direction:{buffer:g,stride:24,offset:0},lineOffset:{buffer:g,stride:24,offset:8},capOffset:{buffer:g,stride:24,offset:16}},primitive:"triangles",blend:{enable:true,color:[0,0,0,0],equation:{rgb:"add",alpha:"add"},func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},depth:{enable:false},scissor:{enable:true,box:e.prop("viewport")},viewport:e.prop("viewport"),stencil:false,instances:e.prop("count"),count:h.length});s(b,{update:T,draw:_,destroy:k,regl:e,gl:r,canvas:r.canvas,groups:x});return b;function b(e){if(e){T(e)}else if(e===null){k()}_()}function _(t){if(typeof t==="number"){return w(t)}if(t&&!Array.isArray(t)){t=[t]}e._refresh();x.forEach((function(e,r){if(!e){return}if(t){if(!t[r]){e.draw=false}else{e.draw=true}}if(!e.draw){e.draw=true;return}w(r)}))}function w(e){if(typeof e==="number"){e=x[e]}if(e==null){return}if(!(e&&e.count&&e.color&&e.opacity&&e.positions&&e.positions.length>1)){return}e.scaleRatio=[e.scale[0]*e.viewport.width,e.scale[1]*e.viewport.height];u(e);if(e.after){e.after(e)}}function T(e){if(!e){return}if(e.length!=null){if(typeof e[0]==="number"){e=[{positions:e}]}}else if(!Array.isArray(e)){e=[e]}var t=0,u=0;b.groups=x=e.map((function(e,c){var h=x[c];if(!e){return h}else if(typeof e==="function"){e={after:e}}else if(typeof e[0]==="number"){e={positions:e}}e=o(e,{color:"color colors fill",capSize:"capSize cap capsize cap-size",lineWidth:"lineWidth line-width width line thickness",opacity:"opacity alpha",range:"range dataBox",viewport:"viewport viewBox",errors:"errors error",positions:"positions position data points"});if(!h){x[c]=h={id:c,scale:null,translate:null,scaleFract:null,translateFract:null,draw:true};e=s({},y,e)}i(h,e,[{lineWidth:function(e){return+e*.5},capSize:function(e){return+e*.5},opacity:parseFloat,errors:function(e){e=l(e);u+=e.length;return e},positions:function(e,r){e=l(e,"float64");r.count=Math.floor(e.length/2);r.bounds=a(e,2);r.offset=t;t+=r.count;return e}},{color:function(e,t){var r=t.count;if(!e){e="transparent"}if(!Array.isArray(e)||typeof e[0]==="number"){var a=e;e=Array(r);for(var i=0;i<r;i++){e[i]=a}}if(e.length<r){throw Error("Not enough colors")}var o=new Uint8Array(r*4);for(var s=0;s<r;s++){var l=n(e[s],"uint8");o.set(l,s*4)}return o},range:function(e,t,r){var a=t.bounds;if(!e){e=a}t.scale=[1/(e[2]-e[0]),1/(e[3]-e[1])];t.translate=[-e[0],-e[1]];t.scaleFract=f(t.scale);t.translateFract=f(t.translate);return e},viewport:function(e){var t;if(Array.isArray(e)){t={x:e[0],y:e[1],width:e[2]-e[0],height:e[3]-e[1]}}else if(e){t={x:e.x||e.left||0,y:e.y||e.top||0};if(e.right){t.width=e.right-t.x}else{t.width=e.w||e.width||0}if(e.bottom){t.height=e.bottom-t.y}else{t.height=e.h||e.height||0}}else{t={x:0,y:0,width:r.drawingBufferWidth,height:r.drawingBufferHeight}}return t}}]);return h}));if(t||u){var h=x.reduce((function(e,t,r){return e+(t?t.count:0)}),0);var g=new Float64Array(h*2);var _=new Uint8Array(h*4);var w=new Float32Array(h*4);x.forEach((function(e,t){if(!e){return}var r=e.positions;var a=e.count;var n=e.offset;var i=e.color;var o=e.errors;if(!a){return}_.set(i,n*4);w.set(o,n*4);g.set(r,n*2)}));var T=c(g);p(T);var k=f(g,T);v(k);d(_);m(w)}}function k(){p.destroy();v.destroy();d.destroy();m.destroy();g.destroy()}}},{"array-bounds":76,"color-normalize":131,"flatten-vertex-data":248,"object-assign":476,"pick-by-alias":485,"to-float32":584,"update-diff":605}],523:[function(e,t,r){"use strict";var a=e("color-normalize");var n=e("array-bounds");var i=e("object-assign");var o=e("glslify");var s=e("pick-by-alias");var l=e("flatten-vertex-data");var u=e("earcut");var c=e("array-normalize");var f=e("to-float32");var h=f.float32;var p=f.fract32;var v=e("es6-weak-map");var d=e("parse-rect");var m=e("array-find-index");t.exports=g;function g(e,t){if(!(this instanceof g)){return new g(e,t)}if(typeof e==="function"){if(!t){t={}}t.regl=e}else{t=e}if(t.length){t.positions=t}e=t.regl;if(!e.hasExtension("ANGLE_instanced_arrays")){throw Error("regl-error2d: `ANGLE_instanced_arrays` extension should be enabled")}this.gl=e._gl;this.regl=e;this.passes=[];this.shaders=g.shaders.has(e)?g.shaders.get(e):g.shaders.set(e,g.createShaders(e)).get(e);this.update(t)}g.dashMult=2;g.maxPatternLength=256;g.precisionThreshold=3e6;g.maxPoints=1e4;g.maxLines=2048;g.shaders=new v;g.createShaders=function(e){var t=e.buffer({usage:"static",type:"float",data:[0,1,0,0,1,1,1,0]});var r={primitive:"triangle strip",instances:e.prop("count"),count:4,offset:0,uniforms:{miterMode:function(e,t){return t.join==="round"?2:1},miterLimit:e.prop("miterLimit"),scale:e.prop("scale"),scaleFract:e.prop("scaleFract"),translateFract:e.prop("translateFract"),translate:e.prop("translate"),thickness:e.prop("thickness"),dashTexture:e.prop("dashTexture"),opacity:e.prop("opacity"),pixelRatio:e.context("pixelRatio"),id:e.prop("id"),dashLength:e.prop("dashLength"),viewport:function(e,t){return[t.viewport.x,t.viewport.y,e.viewportWidth,e.viewportHeight]},depth:e.prop("depth")},blend:{enable:true,color:[0,0,0,0],equation:{rgb:"add",alpha:"add"},func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},depth:{enable:function(e,t){return!t.overlay}},stencil:{enable:false},scissor:{enable:true,box:e.prop("viewport")},viewport:e.prop("viewport")};var a=e(i({vert:o(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec2 aCoord, bCoord, aCoordFract, bCoordFract;\nattribute vec4 color;\nattribute float lineEnd, lineTop;\n\nuniform vec2 scale, scaleFract, translate, translateFract;\nuniform float thickness, pixelRatio, id, depth;\nuniform vec4 viewport;\n\nvarying vec4 fragColor;\nvarying vec2 tangent;\n\nvec2 project(vec2 position, vec2 positionFract, vec2 scale, vec2 scaleFract, vec2 translate, vec2 translateFract) {\n\t// the order is important\n\treturn position * scale + translate\n       + positionFract * scale + translateFract\n       + position * scaleFract\n       + positionFract * scaleFract;\n}\n\nvoid main() {\n\tfloat lineStart = 1. - lineEnd;\n\tfloat lineOffset = lineTop * 2. - 1.;\n\n\tvec2 diff = (bCoord + bCoordFract - aCoord - aCoordFract);\n\ttangent = normalize(diff * scale * viewport.zw);\n\tvec2 normal = vec2(-tangent.y, tangent.x);\n\n\tvec2 position = project(aCoord, aCoordFract, scale, scaleFract, translate, translateFract) * lineStart\n\t\t+ project(bCoord, bCoordFract, scale, scaleFract, translate, translateFract) * lineEnd\n\n\t\t+ thickness * normal * .5 * lineOffset / viewport.zw;\n\n\tgl_Position = vec4(position * 2.0 - 1.0, depth, 1);\n\n\tfragColor = color / 255.;\n}\n"]),frag:o(["precision highp float;\n#define GLSLIFY 1\n\nuniform float dashLength, pixelRatio, thickness, opacity, id;\nuniform sampler2D dashTexture;\n\nvarying vec4 fragColor;\nvarying vec2 tangent;\n\nvoid main() {\n\tfloat alpha = 1.;\n\n\tfloat t = fract(dot(tangent, gl_FragCoord.xy) / dashLength) * .5 + .25;\n\tfloat dash = texture2D(dashTexture, vec2(t, .5)).r;\n\n\tgl_FragColor = fragColor;\n\tgl_FragColor.a *= alpha * opacity * dash;\n}\n"]),attributes:{lineEnd:{buffer:t,divisor:0,stride:8,offset:0},lineTop:{buffer:t,divisor:0,stride:8,offset:4},aCoord:{buffer:e.prop("positionBuffer"),stride:8,offset:8,divisor:1},bCoord:{buffer:e.prop("positionBuffer"),stride:8,offset:16,divisor:1},aCoordFract:{buffer:e.prop("positionFractBuffer"),stride:8,offset:8,divisor:1},bCoordFract:{buffer:e.prop("positionFractBuffer"),stride:8,offset:16,divisor:1},color:{buffer:e.prop("colorBuffer"),stride:4,offset:0,divisor:1}}},r));var n;try{n=e(i({cull:{enable:true,face:"back"},vert:o(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec2 aCoord, bCoord, nextCoord, prevCoord;\nattribute vec4 aColor, bColor;\nattribute float lineEnd, lineTop;\n\nuniform vec2 scale, translate;\nuniform float thickness, pixelRatio, id, depth;\nuniform vec4 viewport;\nuniform float miterLimit, miterMode;\n\nvarying vec4 fragColor;\nvarying vec4 startCutoff, endCutoff;\nvarying vec2 tangent;\nvarying vec2 startCoord, endCoord;\nvarying float enableStartMiter, enableEndMiter;\n\nconst float REVERSE_THRESHOLD = -.875;\nconst float MIN_DIFF = 1e-6;\n\n// TODO: possible optimizations: avoid overcalculating all for vertices and calc just one instead\n// TODO: precalculate dot products, normalize things beforehead etc.\n// TODO: refactor to rectangular algorithm\n\nfloat distToLine(vec2 p, vec2 a, vec2 b) {\n\tvec2 diff = b - a;\n\tvec2 perp = normalize(vec2(-diff.y, diff.x));\n\treturn dot(p - a, perp);\n}\n\nbool isNaN( float val ){\n  return ( val < 0.0 || 0.0 < val || val == 0.0 ) ? false : true;\n}\n\nvoid main() {\n\tvec2 aCoord = aCoord, bCoord = bCoord, prevCoord = prevCoord, nextCoord = nextCoord;\n\n  vec2 adjustedScale;\n  adjustedScale.x = (abs(scale.x) < MIN_DIFF) ? MIN_DIFF : scale.x;\n  adjustedScale.y = (abs(scale.y) < MIN_DIFF) ? MIN_DIFF : scale.y;\n\n  vec2 scaleRatio = adjustedScale * viewport.zw;\n\tvec2 normalWidth = thickness / scaleRatio;\n\n\tfloat lineStart = 1. - lineEnd;\n\tfloat lineBot = 1. - lineTop;\n\n\tfragColor = (lineStart * aColor + lineEnd * bColor) / 255.;\n\n\tif (isNaN(aCoord.x) || isNaN(aCoord.y) || isNaN(bCoord.x) || isNaN(bCoord.y)) return;\n\n\tif (aCoord == prevCoord) prevCoord = aCoord + normalize(bCoord - aCoord);\n\tif (bCoord == nextCoord) nextCoord = bCoord - normalize(bCoord - aCoord);\n\n\tvec2 prevDiff = aCoord - prevCoord;\n\tvec2 currDiff = bCoord - aCoord;\n\tvec2 nextDiff = nextCoord - bCoord;\n\n\tvec2 prevTangent = normalize(prevDiff * scaleRatio);\n\tvec2 currTangent = normalize(currDiff * scaleRatio);\n\tvec2 nextTangent = normalize(nextDiff * scaleRatio);\n\n\tvec2 prevNormal = vec2(-prevTangent.y, prevTangent.x);\n\tvec2 currNormal = vec2(-currTangent.y, currTangent.x);\n\tvec2 nextNormal = vec2(-nextTangent.y, nextTangent.x);\n\n\tvec2 startJoinDirection = normalize(prevTangent - currTangent);\n\tvec2 endJoinDirection = normalize(currTangent - nextTangent);\n\n\t// collapsed/unidirectional segment cases\n\t// FIXME: there should be more elegant solution\n\tvec2 prevTanDiff = abs(prevTangent - currTangent);\n\tvec2 nextTanDiff = abs(nextTangent - currTangent);\n\tif (max(prevTanDiff.x, prevTanDiff.y) < MIN_DIFF) {\n\t\tstartJoinDirection = currNormal;\n\t}\n\tif (max(nextTanDiff.x, nextTanDiff.y) < MIN_DIFF) {\n\t\tendJoinDirection = currNormal;\n\t}\n\tif (aCoord == bCoord) {\n\t\tendJoinDirection = startJoinDirection;\n\t\tcurrNormal = prevNormal;\n\t\tcurrTangent = prevTangent;\n\t}\n\n\ttangent = currTangent;\n\n\t//calculate join shifts relative to normals\n\tfloat startJoinShift = dot(currNormal, startJoinDirection);\n\tfloat endJoinShift = dot(currNormal, endJoinDirection);\n\n\tfloat startMiterRatio = abs(1. / startJoinShift);\n\tfloat endMiterRatio = abs(1. / endJoinShift);\n\n\tvec2 startJoin = startJoinDirection * startMiterRatio;\n\tvec2 endJoin = endJoinDirection * endMiterRatio;\n\n\tvec2 startTopJoin, startBotJoin, endTopJoin, endBotJoin;\n\tstartTopJoin = sign(startJoinShift) * startJoin * .5;\n\tstartBotJoin = -startTopJoin;\n\n\tendTopJoin = sign(endJoinShift) * endJoin * .5;\n\tendBotJoin = -endTopJoin;\n\n\tvec2 aTopCoord = aCoord + normalWidth * startTopJoin;\n\tvec2 bTopCoord = bCoord + normalWidth * endTopJoin;\n\tvec2 aBotCoord = aCoord + normalWidth * startBotJoin;\n\tvec2 bBotCoord = bCoord + normalWidth * endBotJoin;\n\n\t//miter anti-clipping\n\tfloat baClipping = distToLine(bCoord, aCoord, aBotCoord) / dot(normalize(normalWidth * endBotJoin), normalize(normalWidth.yx * vec2(-startBotJoin.y, startBotJoin.x)));\n\tfloat abClipping = distToLine(aCoord, bCoord, bTopCoord) / dot(normalize(normalWidth * startBotJoin), normalize(normalWidth.yx * vec2(-endBotJoin.y, endBotJoin.x)));\n\n\t//prevent close to reverse direction switch\n\tbool prevReverse = dot(currTangent, prevTangent) <= REVERSE_THRESHOLD && abs(dot(currTangent, prevNormal)) * min(length(prevDiff), length(currDiff)) <  length(normalWidth * currNormal);\n\tbool nextReverse = dot(currTangent, nextTangent) <= REVERSE_THRESHOLD && abs(dot(currTangent, nextNormal)) * min(length(nextDiff), length(currDiff)) <  length(normalWidth * currNormal);\n\n\tif (prevReverse) {\n\t\t//make join rectangular\n\t\tvec2 miterShift = normalWidth * startJoinDirection * miterLimit * .5;\n\t\tfloat normalAdjust = 1. - min(miterLimit / startMiterRatio, 1.);\n\t\taBotCoord = aCoord + miterShift - normalAdjust * normalWidth * currNormal * .5;\n\t\taTopCoord = aCoord + miterShift + normalAdjust * normalWidth * currNormal * .5;\n\t}\n\telse if (!nextReverse && baClipping > 0. && baClipping < length(normalWidth * endBotJoin)) {\n\t\t//handle miter clipping\n\t\tbTopCoord -= normalWidth * endTopJoin;\n\t\tbTopCoord += normalize(endTopJoin * normalWidth) * baClipping;\n\t}\n\n\tif (nextReverse) {\n\t\t//make join rectangular\n\t\tvec2 miterShift = normalWidth * endJoinDirection * miterLimit * .5;\n\t\tfloat normalAdjust = 1. - min(miterLimit / endMiterRatio, 1.);\n\t\tbBotCoord = bCoord + miterShift - normalAdjust * normalWidth * currNormal * .5;\n\t\tbTopCoord = bCoord + miterShift + normalAdjust * normalWidth * currNormal * .5;\n\t}\n\telse if (!prevReverse && abClipping > 0. && abClipping < length(normalWidth * startBotJoin)) {\n\t\t//handle miter clipping\n\t\taBotCoord -= normalWidth * startBotJoin;\n\t\taBotCoord += normalize(startBotJoin * normalWidth) * abClipping;\n\t}\n\n\tvec2 aTopPosition = (aTopCoord) * adjustedScale + translate;\n\tvec2 aBotPosition = (aBotCoord) * adjustedScale + translate;\n\n\tvec2 bTopPosition = (bTopCoord) * adjustedScale + translate;\n\tvec2 bBotPosition = (bBotCoord) * adjustedScale + translate;\n\n\t//position is normalized 0..1 coord on the screen\n\tvec2 position = (aTopPosition * lineTop + aBotPosition * lineBot) * lineStart + (bTopPosition * lineTop + bBotPosition * lineBot) * lineEnd;\n\n\tstartCoord = aCoord * scaleRatio + translate * viewport.zw + viewport.xy;\n\tendCoord = bCoord * scaleRatio + translate * viewport.zw + viewport.xy;\n\n\tgl_Position = vec4(position  * 2.0 - 1.0, depth, 1);\n\n\tenableStartMiter = step(dot(currTangent, prevTangent), .5);\n\tenableEndMiter = step(dot(currTangent, nextTangent), .5);\n\n\t//bevel miter cutoffs\n\tif (miterMode == 1.) {\n\t\tif (enableStartMiter == 1.) {\n\t\t\tvec2 startMiterWidth = vec2(startJoinDirection) * thickness * miterLimit * .5;\n\t\t\tstartCutoff = vec4(aCoord, aCoord);\n\t\t\tstartCutoff.zw += vec2(-startJoinDirection.y, startJoinDirection.x) / scaleRatio;\n\t\t\tstartCutoff = startCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;\n\t\t\tstartCutoff += viewport.xyxy;\n\t\t\tstartCutoff += startMiterWidth.xyxy;\n\t\t}\n\n\t\tif (enableEndMiter == 1.) {\n\t\t\tvec2 endMiterWidth = vec2(endJoinDirection) * thickness * miterLimit * .5;\n\t\t\tendCutoff = vec4(bCoord, bCoord);\n\t\t\tendCutoff.zw += vec2(-endJoinDirection.y, endJoinDirection.x)  / scaleRatio;\n\t\t\tendCutoff = endCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;\n\t\t\tendCutoff += viewport.xyxy;\n\t\t\tendCutoff += endMiterWidth.xyxy;\n\t\t}\n\t}\n\n\t//round miter cutoffs\n\telse if (miterMode == 2.) {\n\t\tif (enableStartMiter == 1.) {\n\t\t\tvec2 startMiterWidth = vec2(startJoinDirection) * thickness * abs(dot(startJoinDirection, currNormal)) * .5;\n\t\t\tstartCutoff = vec4(aCoord, aCoord);\n\t\t\tstartCutoff.zw += vec2(-startJoinDirection.y, startJoinDirection.x) / scaleRatio;\n\t\t\tstartCutoff = startCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;\n\t\t\tstartCutoff += viewport.xyxy;\n\t\t\tstartCutoff += startMiterWidth.xyxy;\n\t\t}\n\n\t\tif (enableEndMiter == 1.) {\n\t\t\tvec2 endMiterWidth = vec2(endJoinDirection) * thickness * abs(dot(endJoinDirection, currNormal)) * .5;\n\t\t\tendCutoff = vec4(bCoord, bCoord);\n\t\t\tendCutoff.zw += vec2(-endJoinDirection.y, endJoinDirection.x)  / scaleRatio;\n\t\t\tendCutoff = endCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;\n\t\t\tendCutoff += viewport.xyxy;\n\t\t\tendCutoff += endMiterWidth.xyxy;\n\t\t}\n\t}\n}\n"]),frag:o(["precision highp float;\n#define GLSLIFY 1\n\nuniform float dashLength, pixelRatio, thickness, opacity, id, miterMode;\nuniform sampler2D dashTexture;\n\nvarying vec4 fragColor;\nvarying vec2 tangent;\nvarying vec4 startCutoff, endCutoff;\nvarying vec2 startCoord, endCoord;\nvarying float enableStartMiter, enableEndMiter;\n\nfloat distToLine(vec2 p, vec2 a, vec2 b) {\n\tvec2 diff = b - a;\n\tvec2 perp = normalize(vec2(-diff.y, diff.x));\n\treturn dot(p - a, perp);\n}\n\nvoid main() {\n\tfloat alpha = 1., distToStart, distToEnd;\n\tfloat cutoff = thickness * .5;\n\n\t//bevel miter\n\tif (miterMode == 1.) {\n\t\tif (enableStartMiter == 1.) {\n\t\t\tdistToStart = distToLine(gl_FragCoord.xy, startCutoff.xy, startCutoff.zw);\n\t\t\tif (distToStart < -1.) {\n\t\t\t\tdiscard;\n\t\t\t\treturn;\n\t\t\t}\n\t\t\talpha *= min(max(distToStart + 1., 0.), 1.);\n\t\t}\n\n\t\tif (enableEndMiter == 1.) {\n\t\t\tdistToEnd = distToLine(gl_FragCoord.xy, endCutoff.xy, endCutoff.zw);\n\t\t\tif (distToEnd < -1.) {\n\t\t\t\tdiscard;\n\t\t\t\treturn;\n\t\t\t}\n\t\t\talpha *= min(max(distToEnd + 1., 0.), 1.);\n\t\t}\n\t}\n\n\t// round miter\n\telse if (miterMode == 2.) {\n\t\tif (enableStartMiter == 1.) {\n\t\t\tdistToStart = distToLine(gl_FragCoord.xy, startCutoff.xy, startCutoff.zw);\n\t\t\tif (distToStart < 0.) {\n\t\t\t\tfloat radius = length(gl_FragCoord.xy - startCoord);\n\n\t\t\t\tif(radius > cutoff + .5) {\n\t\t\t\t\tdiscard;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\talpha -= smoothstep(cutoff - .5, cutoff + .5, radius);\n\t\t\t}\n\t\t}\n\n\t\tif (enableEndMiter == 1.) {\n\t\t\tdistToEnd = distToLine(gl_FragCoord.xy, endCutoff.xy, endCutoff.zw);\n\t\t\tif (distToEnd < 0.) {\n\t\t\t\tfloat radius = length(gl_FragCoord.xy - endCoord);\n\n\t\t\t\tif(radius > cutoff + .5) {\n\t\t\t\t\tdiscard;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\talpha -= smoothstep(cutoff - .5, cutoff + .5, radius);\n\t\t\t}\n\t\t}\n\t}\n\n\tfloat t = fract(dot(tangent, gl_FragCoord.xy) / dashLength) * .5 + .25;\n\tfloat dash = texture2D(dashTexture, vec2(t, .5)).r;\n\n\tgl_FragColor = fragColor;\n\tgl_FragColor.a *= alpha * opacity * dash;\n}\n"]),attributes:{lineEnd:{buffer:t,divisor:0,stride:8,offset:0},lineTop:{buffer:t,divisor:0,stride:8,offset:4},aColor:{buffer:e.prop("colorBuffer"),stride:4,offset:0,divisor:1},bColor:{buffer:e.prop("colorBuffer"),stride:4,offset:4,divisor:1},prevCoord:{buffer:e.prop("positionBuffer"),stride:8,offset:0,divisor:1},aCoord:{buffer:e.prop("positionBuffer"),stride:8,offset:8,divisor:1},bCoord:{buffer:e.prop("positionBuffer"),stride:8,offset:16,divisor:1},nextCoord:{buffer:e.prop("positionBuffer"),stride:8,offset:24,divisor:1}}},r))}catch(l){n=a}var s=e({primitive:"triangle",elements:function(e,t){return t.triangles},offset:0,vert:o(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec2 position, positionFract;\n\nuniform vec4 color;\nuniform vec2 scale, scaleFract, translate, translateFract;\nuniform float pixelRatio, id;\nuniform vec4 viewport;\nuniform float opacity;\n\nvarying vec4 fragColor;\n\nconst float MAX_LINES = 256.;\n\nvoid main() {\n\tfloat depth = (MAX_LINES - 4. - id) / (MAX_LINES);\n\n\tvec2 position = position * scale + translate\n       + positionFract * scale + translateFract\n       + position * scaleFract\n       + positionFract * scaleFract;\n\n\tgl_Position = vec4(position * 2.0 - 1.0, depth, 1);\n\n\tfragColor = color / 255.;\n\tfragColor.a *= opacity;\n}\n"]),frag:o(["precision highp float;\n#define GLSLIFY 1\n\nvarying vec4 fragColor;\n\nvoid main() {\n\tgl_FragColor = fragColor;\n}\n"]),uniforms:{scale:e.prop("scale"),color:e.prop("fill"),scaleFract:e.prop("scaleFract"),translateFract:e.prop("translateFract"),translate:e.prop("translate"),opacity:e.prop("opacity"),pixelRatio:e.context("pixelRatio"),id:e.prop("id"),viewport:function(e,t){return[t.viewport.x,t.viewport.y,e.viewportWidth,e.viewportHeight]}},attributes:{position:{buffer:e.prop("positionBuffer"),stride:8,offset:8},positionFract:{buffer:e.prop("positionFractBuffer"),stride:8,offset:8}},blend:r.blend,depth:{enable:false},scissor:r.scissor,stencil:r.stencil,viewport:r.viewport});return{fill:s,rect:a,miter:n}};g.defaults={dashes:null,join:"miter",miterLimit:1,thickness:10,cap:"square",color:"black",opacity:1,overlay:false,viewport:null,range:null,close:false,fill:null};g.prototype.render=function(){var e;var t=[],r=arguments.length;while(r--)t[r]=arguments[r];if(t.length){(e=this).update.apply(e,t)}this.draw()};g.prototype.draw=function(){var e=this;var t=[],r=arguments.length;while(r--)t[r]=arguments[r];(t.length?t:this.passes).forEach((function(t,r){var a;if(t&&Array.isArray(t)){return(a=e).draw.apply(a,t)}if(typeof t==="number"){t=e.passes[t]}if(!(t&&t.count>1&&t.opacity)){return}e.regl._refresh();if(t.fill&&t.triangles&&t.triangles.length>2){e.shaders.fill(t)}if(!t.thickness){return}if(t.scale[0]*t.viewport.width>g.precisionThreshold||t.scale[1]*t.viewport.height>g.precisionThreshold){e.shaders.rect(t)}else if(t.join==="rect"||!t.join&&(t.thickness<=2||t.count>=g.maxPoints)){e.shaders.rect(t)}else{e.shaders.miter(t)}}));return this};g.prototype.update=function(e){var t=this;if(!e){return}if(e.length!=null){if(typeof e[0]==="number"){e=[{positions:e}]}}else if(!Array.isArray(e)){e=[e]}var r=this;var o=r.regl;var f=r.gl;e.forEach((function(e,r){var v=t.passes[r];if(e===undefined){return}if(e===null){t.passes[r]=null;return}if(typeof e[0]==="number"){e={positions:e}}e=s(e,{positions:"positions points data coords",thickness:"thickness lineWidth lineWidths line-width linewidth width stroke-width strokewidth strokeWidth",join:"lineJoin linejoin join type mode",miterLimit:"miterlimit miterLimit",dashes:"dash dashes dasharray dash-array dashArray",color:"color colour stroke colors colours stroke-color strokeColor",fill:"fill fill-color fillColor",opacity:"alpha opacity",overlay:"overlay crease overlap intersect",close:"closed close closed-path closePath",range:"range dataBox",viewport:"viewport viewBox",hole:"holes hole hollow",splitNull:"splitNull"});if(!v){t.passes[r]=v={id:r,scale:null,scaleFract:null,translate:null,translateFract:null,count:0,hole:[],depth:0,dashLength:1,dashTexture:o.texture({channels:1,data:new Uint8Array([255]),width:1,height:1,mag:"linear",min:"linear"}),colorBuffer:o.buffer({usage:"dynamic",type:"uint8",data:new Uint8Array}),positionBuffer:o.buffer({usage:"dynamic",type:"float",data:new Uint8Array}),positionFractBuffer:o.buffer({usage:"dynamic",type:"float",data:new Uint8Array})};e=i({},g.defaults,e)}if(e.thickness!=null){v.thickness=parseFloat(e.thickness)}if(e.opacity!=null){v.opacity=parseFloat(e.opacity)}if(e.miterLimit!=null){v.miterLimit=parseFloat(e.miterLimit)}if(e.overlay!=null){v.overlay=!!e.overlay;if(r<g.maxLines){v.depth=2*(g.maxLines-1-r%g.maxLines)/g.maxLines-1}}if(e.join!=null){v.join=e.join}if(e.hole!=null){v.hole=e.hole}if(e.fill!=null){v.fill=!e.fill?null:a(e.fill,"uint8")}if(e.viewport!=null){v.viewport=d(e.viewport)}if(!v.viewport){v.viewport=d([f.drawingBufferWidth,f.drawingBufferHeight])}if(e.close!=null){v.close=e.close}if(e.positions===null){e.positions=[]}if(e.positions){var y,x;if(e.positions.x&&e.positions.y){var b=e.positions.x;var _=e.positions.y;x=v.count=Math.max(b.length,_.length);y=new Float64Array(x*2);for(var w=0;w<x;w++){y[w*2]=b[w];y[w*2+1]=_[w]}}else{y=l(e.positions,"float64");x=v.count=Math.floor(y.length/2)}var T=v.bounds=n(y,2);if(v.fill){var k=[];var M={};var A=0;for(var S=0,E=0,L=v.count;S<L;S++){var C=y[S*2];var I=y[S*2+1];if(isNaN(C)||isNaN(I)||C==null||I==null){C=y[A*2];I=y[A*2+1];M[S]=A}else{A=S}k[E++]=C;k[E++]=I}if(e.splitNull){if(!(v.count-1 in M)){M[v.count]=v.count-1}var P=Object.keys(M).map(Number).sort((function(e,t){return e-t}));var O=[];var z=0;var D=v.hole!=null?v.hole[0]:null;if(D!=null){var R=m(P,(function(e){return e>=D}));P=P.slice(0,R);P.push(D)}var F=function(e){var t=k.slice(z*2,P[e]*2).concat(D?k.slice(D*2):[]);var r=(v.hole||[]).map((function(t){return t-D+(P[e]-z)}));var a=u(t,r);a=a.map((function(t){return t+z+(t+z<P[e]?0:D-P[e])}));O.push.apply(O,a);z=P[e]+1};for(var B=0;B<P.length;B++)F(B);for(var N=0,j=O.length;N<j;N++){if(M[O[N]]!=null){O[N]=M[O[N]]}}v.triangles=O}else{var U=u(k,v.hole||[]);for(var V=0,H=U.length;V<H;V++){if(M[U[V]]!=null){U[V]=M[U[V]]}}v.triangles=U}}var q=new Float64Array(y);c(q,2,T);var G=new Float64Array(x*2+6);if(v.close){if(y[0]===y[x*2-2]&&y[1]===y[x*2-1]){G[0]=q[x*2-4];G[1]=q[x*2-3]}else{G[0]=q[x*2-2];G[1]=q[x*2-1]}}else{G[0]=q[0];G[1]=q[1]}G.set(q,2);if(v.close){if(y[0]===y[x*2-2]&&y[1]===y[x*2-1]){G[x*2+2]=q[2];G[x*2+3]=q[3];v.count-=1}else{G[x*2+2]=q[0];G[x*2+3]=q[1];G[x*2+4]=q[2];G[x*2+5]=q[3]}}else{G[x*2+2]=q[x*2-2];G[x*2+3]=q[x*2-1];G[x*2+4]=q[x*2-2];G[x*2+5]=q[x*2-1]}var Y=h(G);v.positionBuffer(Y);var W=p(G,Y);v.positionFractBuffer(W)}if(e.range){v.range=e.range}else if(!v.range){v.range=v.bounds}if((e.range||e.positions)&&v.count){var X=v.bounds;var Z=X[2]-X[0],J=X[3]-X[1];var K=v.range[2]-v.range[0],Q=v.range[3]-v.range[1];v.scale=[Z/K,J/Q];v.translate=[-v.range[0]/K+X[0]/K||0,-v.range[1]/Q+X[1]/Q||0];v.scaleFract=p(v.scale);v.translateFract=p(v.translate)}if(e.dashes){var $=0,ee;if(!e.dashes||e.dashes.length<2){$=1;ee=new Uint8Array([255,255,255,255,255,255,255,255])}else{$=0;for(var te=0;te<e.dashes.length;++te){$+=e.dashes[te]}ee=new Uint8Array($*g.dashMult);var re=0;var ae=255;for(var ne=0;ne<2;ne++){for(var ie=0;ie<e.dashes.length;++ie){for(var oe=0,se=e.dashes[ie]*g.dashMult*.5;oe<se;++oe){ee[re++]=ae}ae^=255}}}v.dashLength=$;v.dashTexture({channels:1,data:ee,width:ee.length,height:1,mag:"linear",min:"linear"},0,0)}if(e.color){var le=v.count;var ue=e.color;if(!ue){ue="transparent"}var ce=new Uint8Array(le*4+4);if(!Array.isArray(ue)||typeof ue[0]==="number"){var fe=a(ue,"uint8");for(var he=0;he<le+1;he++){ce.set(fe,he*4)}}else{for(var pe=0;pe<le;pe++){var ve=a(ue[pe],"uint8");ce.set(ve,pe*4)}ce.set(a(ue[0],"uint8"),le*4)}v.colorBuffer({usage:"dynamic",type:"uint8",data:ce})}}));if(e.length<this.passes.length){for(var v=e.length;v<this.passes.length;v++){var y=this.passes[v];if(!y){continue}y.colorBuffer.destroy();y.positionBuffer.destroy();y.dashTexture.destroy()}this.passes.length=e.length}var x=[];for(var b=0;b<this.passes.length;b++){if(this.passes[b]!==null){x.push(this.passes[b])}}this.passes=x;return this};g.prototype.destroy=function(){this.passes.forEach((function(e){e.colorBuffer.destroy();e.positionBuffer.destroy();e.dashTexture.destroy()}));this.passes.length=0;return this}},{"array-bounds":76,"array-find-index":77,"array-normalize":78,"color-normalize":131,earcut:183,"es6-weak-map":238,"flatten-vertex-data":248,glslify:434,"object-assign":476,"parse-rect":481,"pick-by-alias":485,"to-float32":584}],524:[function(e,t,r){"use strict";function a(e,t){return o(e)||l(e,t)||u(e,t)||h()}function n(e){return i(e)||s(e)||u(e)||f()}function i(e){if(Array.isArray(e))return c(e)}function o(e){if(Array.isArray(e))return e}function s(e){if(typeof Symbol!=="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function l(e,t){var r=e==null?null:typeof Symbol!=="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r==null)return;var a=[];var n=true;var i=false;var o,s;try{for(r=r.call(e);!(n=(o=r.next()).done);n=true){a.push(o.value);if(t&&a.length===t)break}}catch(l){i=true;s=l}finally{try{if(!n&&r["return"]!=null)r["return"]()}finally{if(i)throw s}}return a}function u(e,t){if(!e)return;if(typeof e==="string")return c(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor)r=e.constructor.name;if(r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return c(e,t)}function c(e,t){if(t==null||t>e.length)t=e.length;for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function f(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function h(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var p=e("color-normalize");var v=e("array-bounds");var d=e("color-id");var m=e("@plotly/point-cluster");var g=e("object-assign");var y=e("glslify");var x=e("pick-by-alias");var b=e("update-diff");var _=e("flatten-vertex-data");var w=e("is-iexplorer");var T=e("to-float32");var k=e("parse-rect");var M=A;function A(e,t){var r=this;if(!(this instanceof A))return new A(e,t);if(typeof e==="function"){if(!t)t={};t.regl=e}else{t=e;e=null}if(t&&t.length)t.positions=t;e=t.regl;var a=e._gl,n,i=[],o={},s=[],l=[null],u=[null];var c=255,f=100;this.tooManyColors=w;n=e.texture({data:new Uint8Array(c*4),width:c,height:1,type:"uint8",format:"rgba",wrapS:"clamp",wrapT:"clamp",mag:"nearest",min:"nearest"});g(this,{regl:e,gl:a,groups:s,markerCache:u,markerTextures:l,palette:i,paletteIds:o,paletteTexture:n,maxColors:c,maxSize:f,canvas:a.canvas});this.update(t);var h={uniforms:{constPointSize:!!t.constPointSize,opacity:e.prop("opacity"),paletteSize:function e(t,a){return[r.tooManyColors?0:c,n.height]},pixelRatio:e.context("pixelRatio"),scale:e.prop("scale"),scaleFract:e.prop("scaleFract"),translate:e.prop("translate"),translateFract:e.prop("translateFract"),markerTexture:e.prop("markerTexture"),paletteTexture:n},attributes:{x:function e(t,r){return r.xAttr||{buffer:r.positionBuffer,stride:8,offset:0}},y:function e(t,r){return r.yAttr||{buffer:r.positionBuffer,stride:8,offset:4}},xFract:function e(t,r){return r.xAttr?{constant:[0,0]}:{buffer:r.positionFractBuffer,stride:8,offset:0}},yFract:function e(t,r){return r.yAttr?{constant:[0,0]}:{buffer:r.positionFractBuffer,stride:8,offset:4}},size:function e(t,a){return a.size.length?{buffer:a.sizeBuffer,stride:2,offset:0}:{constant:[Math.round(a.size*255/r.maxSize)]}},borderSize:function e(t,a){return a.borderSize.length?{buffer:a.sizeBuffer,stride:2,offset:1}:{constant:[Math.round(a.borderSize*255/r.maxSize)]}},colorId:function e(t,a){return a.color.length?{buffer:a.colorBuffer,stride:r.tooManyColors?8:4,offset:0}:{constant:r.tooManyColors?i.slice(a.color*4,a.color*4+4):[a.color]}},borderColorId:function e(t,a){return a.borderColor.length?{buffer:a.colorBuffer,stride:r.tooManyColors?8:4,offset:r.tooManyColors?4:2}:{constant:r.tooManyColors?i.slice(a.borderColor*4,a.borderColor*4+4):[a.borderColor]}},isActive:function e(t,r){return r.activation===true?{constant:[1]}:r.activation?r.activation:{constant:[0]}}},blend:{enable:true,color:[0,0,0,1],func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},scissor:{enable:true,box:e.prop("viewport")},viewport:e.prop("viewport"),stencil:{enable:false},depth:{enable:false},elements:e.prop("elements"),count:e.prop("count"),offset:e.prop("offset"),primitive:"points"};var p=g({},h);p.frag=y(["precision highp float;\n#define GLSLIFY 1\n\nuniform float opacity;\nuniform sampler2D markerTexture;\n\nvarying vec4 fragColor, fragBorderColor;\nvarying float fragWidth, fragBorderColorLevel, fragColorLevel;\n\nfloat smoothStep(float x, float y) {\n  return 1.0 / (1.0 + exp(50.0*(x - y)));\n}\n\nvoid main() {\n  float dist = texture2D(markerTexture, gl_PointCoord).r, delta = fragWidth;\n\n  // max-distance alpha\n  if (dist < 0.003) discard;\n\n  // null-border case\n  if (fragBorderColorLevel == fragColorLevel || fragBorderColor.a == 0.) {\n    float colorAmt = smoothstep(.5 - delta, .5 + delta, dist);\n    gl_FragColor = vec4(fragColor.rgb, colorAmt * fragColor.a * opacity);\n  }\n  else {\n    float borderColorAmt = smoothstep(fragBorderColorLevel - delta, fragBorderColorLevel + delta, dist);\n    float colorAmt = smoothstep(fragColorLevel - delta, fragColorLevel + delta, dist);\n\n    vec4 color = fragBorderColor;\n    color.a *= borderColorAmt;\n    color = mix(color, fragColor, colorAmt);\n    color.a *= opacity;\n\n    gl_FragColor = color;\n  }\n\n}\n"]);p.vert=y(["precision highp float;\n#define GLSLIFY 1\n\nattribute float x, y, xFract, yFract;\nattribute float size, borderSize;\nattribute vec4 colorId, borderColorId;\nattribute float isActive;\n\nuniform bool constPointSize;\nuniform float pixelRatio;\nuniform vec2 scale, scaleFract, translate, translateFract, paletteSize;\nuniform sampler2D paletteTexture;\n\nconst float maxSize = 100.;\nconst float borderLevel = .5;\n\nvarying vec4 fragColor, fragBorderColor;\nvarying float fragPointSize, fragBorderRadius, fragWidth, fragBorderColorLevel, fragColorLevel;\n\nfloat pointSizeScale = (constPointSize) ? 2. : pixelRatio;\n\nbool isDirect = (paletteSize.x < 1.);\n\nvec4 getColor(vec4 id) {\n  return isDirect ? id / 255. : texture2D(paletteTexture,\n    vec2(\n      (id.x + .5) / paletteSize.x,\n      (id.y + .5) / paletteSize.y\n    )\n  );\n}\n\nvoid main() {\n  // ignore inactive points\n  if (isActive == 0.) return;\n\n  vec2 position = vec2(x, y);\n  vec2 positionFract = vec2(xFract, yFract);\n\n  vec4 color = getColor(colorId);\n  vec4 borderColor = getColor(borderColorId);\n\n  float size = size * maxSize / 255.;\n  float borderSize = borderSize * maxSize / 255.;\n\n  gl_PointSize = 2. * size * pointSizeScale;\n  fragPointSize = size * pixelRatio;\n\n  vec2 pos = (position + translate) * scale\n      + (positionFract + translateFract) * scale\n      + (position + translate) * scaleFract\n      + (positionFract + translateFract) * scaleFract;\n\n  gl_Position = vec4(pos * 2. - 1., 0., 1.);\n\n  fragColor = color;\n  fragBorderColor = borderColor;\n  fragWidth = 1. / gl_PointSize;\n\n  fragBorderColorLevel = clamp(borderLevel - borderLevel * borderSize / size, 0., 1.);\n  fragColorLevel = clamp(borderLevel + (1. - borderLevel) * borderSize / size, 0., 1.);\n}"]);this.drawMarker=e(p);var v=g({},h);v.frag=y(["precision highp float;\n#define GLSLIFY 1\n\nvarying vec4 fragColor, fragBorderColor;\nvarying float fragBorderRadius, fragWidth;\n\nuniform float opacity;\n\nfloat smoothStep(float edge0, float edge1, float x) {\n\tfloat t;\n\tt = clamp((x - edge0) / (edge1 - edge0), 0.0, 1.0);\n\treturn t * t * (3.0 - 2.0 * t);\n}\n\nvoid main() {\n\tfloat radius, alpha = 1.0, delta = fragWidth;\n\n\tradius = length(2.0 * gl_PointCoord.xy - 1.0);\n\n\tif (radius > 1.0 + delta) {\n\t\tdiscard;\n\t}\n\n\talpha -= smoothstep(1.0 - delta, 1.0 + delta, radius);\n\n\tfloat borderRadius = fragBorderRadius;\n\tfloat ratio = smoothstep(borderRadius - delta, borderRadius + delta, radius);\n\tvec4 color = mix(fragColor, fragBorderColor, ratio);\n\tcolor.a *= alpha * opacity;\n\tgl_FragColor = color;\n}\n"]);v.vert=y(["precision highp float;\n#define GLSLIFY 1\n\nattribute float x, y, xFract, yFract;\nattribute float size, borderSize;\nattribute vec4 colorId, borderColorId;\nattribute float isActive;\n\nuniform bool constPointSize;\nuniform float pixelRatio;\nuniform vec2 paletteSize, scale, scaleFract, translate, translateFract;\nuniform sampler2D paletteTexture;\n\nconst float maxSize = 100.;\n\nvarying vec4 fragColor, fragBorderColor;\nvarying float fragBorderRadius, fragWidth;\n\nfloat pointSizeScale = (constPointSize) ? 2. : pixelRatio;\n\nbool isDirect = (paletteSize.x < 1.);\n\nvec4 getColor(vec4 id) {\n  return isDirect ? id / 255. : texture2D(paletteTexture,\n    vec2(\n      (id.x + .5) / paletteSize.x,\n      (id.y + .5) / paletteSize.y\n    )\n  );\n}\n\nvoid main() {\n  // ignore inactive points\n  if (isActive == 0.) return;\n\n  vec2 position = vec2(x, y);\n  vec2 positionFract = vec2(xFract, yFract);\n\n  vec4 color = getColor(colorId);\n  vec4 borderColor = getColor(borderColorId);\n\n  float size = size * maxSize / 255.;\n  float borderSize = borderSize * maxSize / 255.;\n\n  gl_PointSize = (size + borderSize) * pointSizeScale;\n\n  vec2 pos = (position + translate) * scale\n      + (positionFract + translateFract) * scale\n      + (position + translate) * scaleFract\n      + (positionFract + translateFract) * scaleFract;\n\n  gl_Position = vec4(pos * 2. - 1., 0., 1.);\n\n  fragBorderRadius = 1. - 2. * borderSize / (size + borderSize);\n  fragColor = color;\n  fragBorderColor = borderColor.a == 0. || borderSize == 0. ? vec4(color.rgb, 0.) : borderColor;\n  fragWidth = 1. / gl_PointSize;\n}\n"]);if(w){v.frag=v.frag.replace("smoothstep","smoothStep");p.frag=p.frag.replace("smoothstep","smoothStep")}this.drawCircle=e(v)}A.defaults={color:"black",borderColor:"transparent",borderSize:0,size:12,opacity:1,marker:undefined,viewport:null,range:null,pixelSize:null,count:0,offset:0,bounds:null,positions:[],snap:1e4};A.prototype.render=function(){if(arguments.length){this.update.apply(this,arguments)}this.draw();return this};A.prototype.draw=function(){var e=this;for(var t=arguments.length,r=new Array(t),a=0;a<t;a++){r[a]=arguments[a]}var n=this.groups;if(r.length===1&&Array.isArray(r[0])&&(r[0][0]===null||Array.isArray(r[0][0]))){r=r[0]}this.regl._refresh();if(r.length){for(var i=0;i<r.length;i++){this.drawItem(i,r[i])}}else{n.forEach((function(t,r){e.drawItem(r)}))}return this};A.prototype.drawItem=function(e,t){var r=this.groups;var a=r[e];if(typeof t==="number"){e=t;a=r[t];t=null}if(!(a&&a.count&&a.opacity))return;if(a.activation[0]){this.drawCircle(this.getMarkerDrawOptions(0,a,t))}var i=[];for(var o=1;o<a.activation.length;o++){if(!a.activation[o]||a.activation[o]!==true&&!a.activation[o].data.length)continue;i.push.apply(i,n(this.getMarkerDrawOptions(o,a,t)))}if(i.length){this.drawMarker(i)}};A.prototype.getMarkerDrawOptions=function(e,t,r){var n=t.range,i=t.tree,o=t.viewport,s=t.activation,l=t.selectionBuffer,u=t.count;var c=this.regl;if(!i){if(r){return[g({},t,{markerTexture:this.markerTextures[e],activation:s[e],count:r.length,elements:r,offset:0})]}return[g({},t,{markerTexture:this.markerTextures[e],activation:s[e],offset:0})]}var f=[];var h=i.range(n,{lod:true,px:[(n[2]-n[0])/o.width,(n[3]-n[1])/o.height]});if(r){var p=s[e];var v=p.data;var d=new Uint8Array(u);for(var m=0;m<r.length;m++){var y=r[m];d[y]=v?v[y]:1}l.subdata(d)}for(var x=h.length;x--;){var b=a(h[x],2),_=b[0],w=b[1];f.push(g({},t,{markerTexture:this.markerTextures[e],activation:r?l:s[e],offset:_,count:w-_}))}return f};A.prototype.update=function(){var e=this;for(var t=arguments.length,r=new Array(t),a=0;a<t;a++){r[a]=arguments[a]}if(!r.length)return;if(r.length===1&&Array.isArray(r[0]))r=r[0];var n=this.groups,i=this.gl,o=this.regl,s=this.maxSize,l=this.maxColors,u=this.palette;this.groups=n=r.map((function(t,r){var a=n[r];if(t===undefined)return a;if(t===null)t={positions:null};else if(typeof t==="function")t={ondraw:t};else if(typeof t[0]==="number")t={positions:t};t=x(t,{positions:"positions data points",snap:"snap cluster lod tree",size:"sizes size radius",borderSize:"borderSizes borderSize border-size bordersize borderWidth borderWidths border-width borderwidth stroke-width strokeWidth strokewidth outline",color:"colors color fill fill-color fillColor",borderColor:"borderColors borderColor stroke stroke-color strokeColor",marker:"markers marker shape",range:"range dataBox databox",viewport:"viewport viewPort viewBox viewbox",opacity:"opacity alpha transparency",bounds:"bound bounds boundaries limits",tooManyColors:"tooManyColors palette paletteMode optimizePalette enablePalette"});if(t.positions===null)t.positions=[];if(t.tooManyColors!=null)e.tooManyColors=t.tooManyColors;if(!a){n[r]=a={id:r,scale:null,translate:null,scaleFract:null,translateFract:null,activation:[],selectionBuffer:o.buffer({data:new Uint8Array(0),usage:"stream",type:"uint8"}),sizeBuffer:o.buffer({data:new Uint8Array(0),usage:"dynamic",type:"uint8"}),colorBuffer:o.buffer({data:new Uint8Array(0),usage:"dynamic",type:"uint8"}),positionBuffer:o.buffer({data:new Uint8Array(0),usage:"dynamic",type:"float"}),positionFractBuffer:o.buffer({data:new Uint8Array(0),usage:"dynamic",type:"float"})};t=g({},A.defaults,t)}if(t.positions&&!("marker"in t)){t.marker=a.marker;delete a.marker}if(t.marker&&!("positions"in t)){t.positions=a.positions;delete a.positions}var c=0,f=0;b(a,t,[{snap:true,size:function e(t,r){if(t==null)t=A.defaults.size;c+=t&&t.length?1:0;return t},borderSize:function e(t,r){if(t==null)t=A.defaults.borderSize;c+=t&&t.length?1:0;return t},opacity:parseFloat,color:function t(r,a){if(r==null)r=A.defaults.color;r=e.updateColor(r);f++;return r},borderColor:function t(r,a){if(r==null)r=A.defaults.borderColor;r=e.updateColor(r);f++;return r},bounds:function e(t,r,a){if(!("range"in a))a.range=null;return t},positions:function e(t,r,a){var n=r.snap;var i=r.positionBuffer,s=r.positionFractBuffer,l=r.selectionBuffer;if(t.x||t.y){if(t.x.length){r.xAttr={buffer:o.buffer(t.x),offset:0,stride:4,count:t.x.length}}else{r.xAttr={buffer:t.x.buffer,offset:t.x.offset*4||0,stride:(t.x.stride||1)*4,count:t.x.count}}if(t.y.length){r.yAttr={buffer:o.buffer(t.y),offset:0,stride:4,count:t.y.length}}else{r.yAttr={buffer:t.y.buffer,offset:t.y.offset*4||0,stride:(t.y.stride||1)*4,count:t.y.count}}r.count=Math.max(r.xAttr.count,r.yAttr.count);return t}t=_(t,"float64");var u=r.count=Math.floor(t.length/2);var c=r.bounds=u?v(t,2):null;if(!a.range&&!r.range){delete r.range;a.range=c}if(!a.marker&&!r.marker){delete r.marker;a.marker=null}if(n&&(n===true||u>n)){r.tree=m(t,{bounds:c})}else if(n&&n.length){r.tree=n}if(r.tree){var f={primitive:"points",usage:"static",data:r.tree,type:"uint32"};if(r.elements)r.elements(f);else r.elements=o.elements(f)}var h=T.float32(t);i({data:h,usage:"dynamic"});var p=T.fract32(t,h);s({data:p,usage:"dynamic"});l({data:new Uint8Array(u),type:"uint8",usage:"stream"});return t}},{marker:function t(r,a,n){var i=a.activation;i.forEach((function(e){return e&&e.destroy&&e.destroy()}));i.length=0;if(!r||typeof r[0]==="number"){var s=e.addMarker(r);i[s]=true}else{var l=[];for(var u=0,c=Math.min(r.length,a.count);u<c;u++){var f=e.addMarker(r[u]);if(!l[f])l[f]=new Uint8Array(a.count);l[f][u]=1}for(var h=0;h<l.length;h++){if(!l[h])continue;var p={data:l[h],type:"uint8",usage:"static"};if(!i[h]){i[h]=o.buffer(p)}else{i[h](p)}i[h].data=l[h]}}return r},range:function e(t,r,a){var n=r.bounds;if(!n)return;if(!t)t=n;r.scale=[1/(t[2]-t[0]),1/(t[3]-t[1])];r.translate=[-t[0],-t[1]];r.scaleFract=T.fract(r.scale);r.translateFract=T.fract(r.translate);return t},viewport:function e(t){var r=k(t||[i.drawingBufferWidth,i.drawingBufferHeight]);return r}}]);if(c){var h=a,p=h.count,d=h.size,y=h.borderSize,w=h.sizeBuffer;var M=new Uint8Array(p*2);if(d.length||y.length){for(var S=0;S<p;S++){M[S*2]=Math.round((d[S]==null?d:d[S])*255/s);M[S*2+1]=Math.round((y[S]==null?y:y[S])*255/s)}}w({data:M,usage:"dynamic"})}if(f){var E=a,L=E.count,C=E.color,I=E.borderColor,P=E.colorBuffer;var O;if(e.tooManyColors){if(C.length||I.length){O=new Uint8Array(L*8);for(var z=0;z<L;z++){var D=C[z];O[z*8]=u[D*4];O[z*8+1]=u[D*4+1];O[z*8+2]=u[D*4+2];O[z*8+3]=u[D*4+3];var R=I[z];O[z*8+4]=u[R*4];O[z*8+5]=u[R*4+1];O[z*8+6]=u[R*4+2];O[z*8+7]=u[R*4+3]}}}else{if(C.length||I.length){O=new Uint8Array(L*4+2);for(var F=0;F<L;F++){if(C[F]!=null){O[F*4]=C[F]%l;O[F*4+1]=Math.floor(C[F]/l)}if(I[F]!=null){O[F*4+2]=I[F]%l;O[F*4+3]=Math.floor(I[F]/l)}}}}P({data:O||new Uint8Array(0),type:"uint8",usage:"dynamic"})}return a}))};A.prototype.addMarker=function(e){var t=this.markerTextures,r=this.regl,a=this.markerCache;var n=e==null?0:a.indexOf(e);if(n>=0)return n;var i;if(e instanceof Uint8Array||e instanceof Uint8ClampedArray){i=e}else{i=new Uint8Array(e.length);for(var o=0,s=e.length;o<s;o++){i[o]=e[o]*255}}var l=Math.floor(Math.sqrt(i.length));n=t.length;a.push(e);t.push(r.texture({channels:1,data:i,radius:l,mag:"linear",min:"linear"}));return n};A.prototype.updateColor=function(e){var t=this.paletteIds,r=this.palette,a=this.maxColors;if(!Array.isArray(e)){e=[e]}var n=[];if(typeof e[0]==="number"){var i=[];if(Array.isArray(e)){for(var o=0;o<e.length;o+=4){i.push(e.slice(o,o+4))}}else{for(var s=0;s<e.length;s+=4){i.push(e.subarray(s,s+4))}}e=i}for(var l=0;l<e.length;l++){var u=e[l];u=p(u,"uint8");var c=d(u,false);if(t[c]==null){var f=r.length;t[c]=Math.floor(f/4);r[f]=u[0];r[f+1]=u[1];r[f+2]=u[2];r[f+3]=u[3]}n[l]=t[c]}if(!this.tooManyColors&&r.length>a*4)this.tooManyColors=true;this.updatePalette(r);return n.length===1?n[0]:n};A.prototype.updatePalette=function(e){if(this.tooManyColors)return;var t=this.maxColors,r=this.paletteTexture;var a=Math.ceil(e.length*.25/t);if(a>1){e=e.slice();for(var n=e.length*.25%t;n<a*t;n++){e.push(0,0,0,0)}}if(r.height<a){r.resize(t,a)}r.subimage({width:Math.min(e.length*.25,t),height:a,data:e},0,0)};A.prototype.destroy=function(){this.groups.forEach((function(e){e.sizeBuffer.destroy();e.positionBuffer.destroy();e.positionFractBuffer.destroy();e.colorBuffer.destroy();e.activation.forEach((function(e){return e&&e.destroy&&e.destroy()}));e.selectionBuffer.destroy();if(e.elements)e.elements.destroy()}));this.groups.length=0;this.paletteTexture.destroy();this.markerTextures.forEach((function(e){return e&&e.destroy&&e.destroy()}));return this};var S=e("object-assign");var E=function e(t,r){var a=new M(t,r);var n=a.render.bind(a);S(n,{render:n,update:a.update.bind(a),draw:a.draw.bind(a),destroy:a.destroy.bind(a),regl:a.regl,gl:a.gl,canvas:a.gl.canvas,groups:a.groups,markers:a.markerCache,palette:a.palette});return n};t.exports=E},{"@plotly/point-cluster":59,"array-bounds":76,"color-id":129,"color-normalize":131,"flatten-vertex-data":248,glslify:434,"is-iexplorer":444,"object-assign":476,"parse-rect":481,"pick-by-alias":485,"to-float32":584,"update-diff":605}],525:[function(e,t,r){"use strict";var a=e("regl-scatter2d");var n=e("pick-by-alias");var i=e("array-bounds");var o=e("raf");var s=e("array-range");var l=e("parse-rect");var u=e("flatten-vertex-data");t.exports=c;function c(e,t){if(!(this instanceof c)){return new c(e,t)}this.traces=[];this.passes={};this.regl=e;this.scatter=a(e);this.canvas=this.scatter.canvas}c.prototype.render=function(){var e=this;var t;var r=[],a=arguments.length;while(a--)r[a]=arguments[a];if(r.length){(t=this).update.apply(t,r)}if(this.regl.attributes.preserveDrawingBuffer){return this.draw()}if(this.dirty){if(this.planned==null){this.planned=o((function(){e.draw();e.dirty=true;e.planned=null}))}}else{this.draw();this.dirty=true;o((function(){e.dirty=false}))}return this};c.prototype.update=function(){var e;var t=[],r=arguments.length;while(r--)t[r]=arguments[r];if(!t.length){return}for(var a=0;a<t.length;a++){this.updateItem(a,t[a])}this.traces=this.traces.filter(Boolean);var n=[];var i=0;for(var o=0;o<this.traces.length;o++){var s=this.traces[o];var l=this.traces[o].passes;for(var u=0;u<l.length;u++){n.push(this.passes[l[u]])}s.passOffset=i;i+=s.passes.length}(e=this.scatter).update.apply(e,n);return this};c.prototype.updateItem=function(e,t){var r=this;var a=r.regl;if(t===null){this.traces[e]=null;return this}if(!t){return this}var o=n(t,{data:"data items columns rows values dimensions samples x",snap:"snap cluster",size:"sizes size radius",color:"colors color fill fill-color fillColor",opacity:"opacity alpha transparency opaque",borderSize:"borderSizes borderSize border-size bordersize borderWidth borderWidths border-width borderwidth stroke-width strokeWidth strokewidth outline",borderColor:"borderColors borderColor bordercolor stroke stroke-color strokeColor",marker:"markers marker shape",range:"range ranges databox dataBox",viewport:"viewport viewBox viewbox",domain:"domain domains area areas",padding:"pad padding paddings pads margin margins",transpose:"transpose transposed",diagonal:"diagonal diag showDiagonal",upper:"upper up top upperhalf upperHalf showupperhalf showUpper showUpperHalf",lower:"lower low bottom lowerhalf lowerHalf showlowerhalf showLowerHalf showLower"});var s=this.traces[e]||(this.traces[e]={id:e,buffer:a.buffer({usage:"dynamic",type:"float",data:new Uint8Array}),color:"black",marker:null,size:12,borderColor:"transparent",borderSize:1,viewport:l([a._gl.drawingBufferWidth,a._gl.drawingBufferHeight]),padding:[0,0,0,0],opacity:1,diagonal:true,upper:true,lower:true});if(o.color!=null){s.color=o.color}if(o.size!=null){s.size=o.size}if(o.marker!=null){s.marker=o.marker}if(o.borderColor!=null){s.borderColor=o.borderColor}if(o.borderSize!=null){s.borderSize=o.borderSize}if(o.opacity!=null){s.opacity=o.opacity}if(o.viewport){s.viewport=l(o.viewport)}if(o.diagonal!=null){s.diagonal=o.diagonal}if(o.upper!=null){s.upper=o.upper}if(o.lower!=null){s.lower=o.lower}if(o.data){s.buffer(u(o.data));s.columns=o.data.length;s.count=o.data[0].length;s.bounds=[];for(var c=0;c<s.columns;c++){s.bounds[c]=i(o.data[c],1)}}var v;if(o.range){s.range=o.range;v=s.range&&typeof s.range[0]!=="number"}if(o.domain){s.domain=o.domain}var d=false;if(o.padding!=null){if(Array.isArray(o.padding)&&o.padding.length===s.columns&&typeof o.padding[o.padding.length-1]==="number"){s.padding=o.padding.map(p);d=true}else{s.padding=p(o.padding)}}var m=s.columns;var g=s.count;var y=s.viewport.width;var x=s.viewport.height;var b=s.viewport.x;var _=s.viewport.y;var w=y/m;var T=x/m;s.passes=[];for(var k=0;k<m;k++){for(var M=0;M<m;M++){if(!s.diagonal&&M===k){continue}if(!s.upper&&k>M){continue}if(!s.lower&&k<M){continue}var A=f(s.id,k,M);var S=this.passes[A]||(this.passes[A]={});if(o.data){if(o.transpose){S.positions={x:{buffer:s.buffer,offset:M,count:g,stride:m},y:{buffer:s.buffer,offset:k,count:g,stride:m}}}else{S.positions={x:{buffer:s.buffer,offset:M*g,count:g},y:{buffer:s.buffer,offset:k*g,count:g}}}S.bounds=h(s.bounds,k,M)}if(o.domain||o.viewport||o.data){var E=d?h(s.padding,k,M):s.padding;if(s.domain){var L=h(s.domain,k,M);var C=L[0];var I=L[1];var P=L[2];var O=L[3];S.viewport=[b+C*y+E[0],_+I*x+E[1],b+P*y-E[2],_+O*x-E[3]]}else{S.viewport=[b+M*w+w*E[0],_+k*T+T*E[1],b+(M+1)*w-w*E[2],_+(k+1)*T-T*E[3]]}}if(o.color){S.color=s.color}if(o.size){S.size=s.size}if(o.marker){S.marker=s.marker}if(o.borderSize){S.borderSize=s.borderSize}if(o.borderColor){S.borderColor=s.borderColor}if(o.opacity){S.opacity=s.opacity}if(o.range){S.range=v?h(s.range,k,M):s.range||S.bounds}s.passes.push(A)}}return this};c.prototype.draw=function(){var e;var t=[],r=arguments.length;while(r--)t[r]=arguments[r];if(!t.length){this.scatter.draw()}else{var a=[];for(var n=0;n<t.length;n++){if(typeof t[n]==="number"){var i=this.traces[t[n]];var o=i.passes;var l=i.passOffset;a.push.apply(a,s(l,l+o.length))}else if(t[n].length){var u=t[n];var c=this.traces[n];var f=c.passes;var h=c.passOffset;f=f.map((function(e,t){a[h+t]=u}))}}(e=this.scatter).draw.apply(e,a)}return this};c.prototype.destroy=function(){this.traces.forEach((function(e){if(e.buffer&&e.buffer.destroy){e.buffer.destroy()}}));this.traces=null;this.passes=null;this.scatter.destroy();return this};function f(e,t,r){var a=e.id!=null?e.id:e;var n=t;var i=r;var o=a<<16|(n&255)<<8|i&255;return o}function h(e,t,r){var a,n,i,o,s,l,u,c;var f=e[t],h=e[r];if(f.length>2){a=f[0];i=f[2];n=f[1];o=f[3]}else if(f.length){a=n=f[0];i=o=f[1]}else{a=f.x;n=f.y;i=f.x+f.width;o=f.y+f.height}if(h.length>2){s=h[0];u=h[2];l=h[1];c=h[3]}else if(h.length){s=l=h[0];u=c=h[1]}else{s=h.x;l=h.y;u=h.x+h.width;c=h.y+h.height}return[s,n,u,o]}function p(e){if(typeof e==="number"){return[e,e,e,e]}else if(e.length===2){return[e[0],e[1],e[0],e[1]]}else{var t=l(e);return[t.x,t.y,t.x+t.width,t.y+t.height]}}},{"array-bounds":76,"array-range":79,"flatten-vertex-data":248,"parse-rect":481,"pick-by-alias":485,raf:516,"regl-scatter2d":524}],526:[function(t,r,a){(function(t,n){"object"===typeof a&&"undefined"!==typeof r?r.exports=n():"function"===typeof e&&e.amd?e(n):t.createREGL=n()})(this,(function(){function e(e,t){this.id=Z++;this.type=e;this.data=t}function t(e){if(0===e.length)return[];var r=e.charAt(0),a=e.charAt(e.length-1);if(1<e.length&&r===a&&('"'===r||"'"===r))return['"'+e.substr(1,e.length-2).replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];if(r=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(e))return t(e.substr(0,r.index)).concat(t(r[1])).concat(t(e.substr(r.index+r[0].length)));r=e.split(".");if(1===r.length)return['"'+e.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];e=[];for(a=0;a<r.length;++a)e=e.concat(t(r[a]));return e}function r(e){return"["+t(e).join("][")+"]"}function a(t,r){if("function"===typeof t)return new e(0,t);if("number"===typeof t||"boolean"===typeof t)return new e(5,t);if(Array.isArray(t))return new e(6,t.map((function(e,t){return a(e,r+"["+t+"]")})));if(t instanceof e)return t}function n(){var e={"":0},t=[""];return{id:function(r){var a=e[r];if(a)return a;a=e[r]=t.length;t.push(r);return a},str:function(e){return t[e]}}}function i(e,t,r){function a(){var t=window.innerWidth,a=window.innerHeight;e!==document.body&&(a=n.getBoundingClientRect(),t=a.right-a.left,a=a.bottom-a.top);n.width=r*t;n.height=r*a}var n=document.createElement("canvas");X(n.style,{border:0,margin:0,padding:0,top:0,left:0,width:"100%",height:"100%"});e.appendChild(n);e===document.body&&(n.style.position="absolute",X(e.style,{margin:0,padding:0}));var i;e!==document.body&&"function"===typeof ResizeObserver?(i=new ResizeObserver((function(){setTimeout(a)})),i.observe(e)):window.addEventListener("resize",a,!1);a();return{canvas:n,onDestroy:function(){i?i.disconnect():window.removeEventListener("resize",a);e.removeChild(n)}}}function o(e,t){function r(r){try{return e.getContext(r,t)}catch(a){return null}}return r("webgl")||r("experimental-webgl")||r("webgl-experimental")}function s(e){return"string"===typeof e?e.split():e}function l(e){return"string"===typeof e?document.querySelector(e):e}function u(e){var t=e||{},r,a,n,u;e={};var c=[],f=[],h="undefined"===typeof window?1:window.devicePixelRatio,p=!1,v=function(e){},d=function(){};"string"===typeof t?r=document.querySelector(t):"object"===typeof t&&("string"===typeof t.nodeName&&"function"===typeof t.appendChild&&"function"===typeof t.getBoundingClientRect?r=t:"function"===typeof t.drawArrays||"function"===typeof t.drawElements?(u=t,n=u.canvas):("gl"in t?u=t.gl:"canvas"in t?n=l(t.canvas):"container"in t&&(a=l(t.container)),"attributes"in t&&(e=t.attributes),"extensions"in t&&(c=s(t.extensions)),"optionalExtensions"in t&&(f=s(t.optionalExtensions)),"onDone"in t&&(v=t.onDone),"profile"in t&&(p=!!t.profile),"pixelRatio"in t&&(h=+t.pixelRatio)));r&&("canvas"===r.nodeName.toLowerCase()?n=r:a=r);if(!u){if(!n){r=i(a||document.body,v,h);if(!r)return null;n=r.canvas;d=r.onDestroy}void 0===e.premultipliedAlpha&&(e.premultipliedAlpha=!0);u=o(n,e)}return u?{gl:u,canvas:n,container:a,extensions:c,optionalExtensions:f,pixelRatio:h,profile:p,onDone:v,onDestroy:d}:(d(),v("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function c(e,t){function r(t){t=t.toLowerCase();var r;try{r=a[t]=e.getExtension(t)}catch(n){}return!!r}for(var a={},n=0;n<t.extensions.length;++n){var i=t.extensions[n];if(!r(i))return t.onDestroy(),t.onDone('"'+i+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}t.optionalExtensions.forEach(r);return{extensions:a,restore:function(){Object.keys(a).forEach((function(e){if(a[e]&&!r(e))throw Error("(regl): error restoring extension "+e)}))}}}function f(e,t){for(var r=Array(e),a=0;a<e;++a)r[a]=t(a);return r}function h(e){var t,r;t=(65535<e)<<4;e>>>=t;r=(255<e)<<3;e>>>=r;t|=r;r=(15<e)<<2;e>>>=r;t|=r;r=(3<e)<<1;return t|r|e>>>r>>1}function p(){function e(e){e:{for(var t=16;268435456>=t;t*=16)if(e<=t){e=t;break e}e=0}t=r[h(e)>>2];return 0<t.length?t.pop():new ArrayBuffer(e)}function t(e){r[h(e.byteLength)>>2].push(e)}var r=f(8,(function(){return[]}));return{alloc:e,free:t,allocType:function(t,r){var a=null;switch(t){case 5120:a=new Int8Array(e(r),0,r);break;case 5121:a=new Uint8Array(e(r),0,r);break;case 5122:a=new Int16Array(e(2*r),0,r);break;case 5123:a=new Uint16Array(e(2*r),0,r);break;case 5124:a=new Int32Array(e(4*r),0,r);break;case 5125:a=new Uint32Array(e(4*r),0,r);break;case 5126:a=new Float32Array(e(4*r),0,r);break;default:return null}return a.length!==r?a.subarray(0,r):a},freeType:function(e){t(e.buffer)}}}function v(e){return!!e&&"object"===typeof e&&Array.isArray(e.shape)&&Array.isArray(e.stride)&&"number"===typeof e.offset&&e.shape.length===e.stride.length&&(Array.isArray(e.data)||te(e.data))}function d(e,t,r,a,n,i){for(var o=0;o<t;++o)for(var s=e[o],l=0;l<r;++l)for(var u=s[l],c=0;c<a;++c)n[i++]=u[c]}function m(e,t,r,a,n){for(var i=1,o=r+1;o<t.length;++o)i*=t[o];var s=t[r];if(4===t.length-r){var l=t[r+1],u=t[r+2];t=t[r+3];for(o=0;o<s;++o)d(e[o],l,u,t,a,n),n+=i}else for(o=0;o<s;++o)m(e[o],t,r+1,a,n),n+=i}function g(e){return ne[Object.prototype.toString.call(e)]|0}function y(e,t){for(var r=0;r<t.length;++r)e[r]=t[r]}function x(e,t,r,a,n,i,o){for(var s=0,l=0;l<r;++l)for(var u=0;u<a;++u)e[s++]=t[n*l+i*u+o]}function b(e,t,r,a){function n(t){this.id=l++;this.buffer=e.createBuffer();this.type=t;this.usage=35044;this.byteLength=0;this.dimension=1;this.dtype=5121;this.persistentData=null;r.profile&&(this.stats={size:0})}function i(t,r,a){t.byteLength=r.byteLength;e.bufferData(t.type,r,a)}function o(e,t,r,a,n,o){e.usage=r;if(Array.isArray(t)){if(e.dtype=a||5126,0<t.length)if(Array.isArray(t[0])){n=le(t);for(var s=a=1;s<n.length;++s)a*=n[s];e.dimension=a;t=se(t,n,e.dtype);i(e,t,r);o?e.persistentData=t:$.freeType(t)}else"number"===typeof t[0]?(e.dimension=n,n=$.allocType(e.dtype,t.length),y(n,t),i(e,n,r),o?e.persistentData=n:$.freeType(n)):te(t[0])&&(e.dimension=t[0].length,e.dtype=a||g(t[0])||5126,t=se(t,[t.length,t[0].length],e.dtype),i(e,t,r),o?e.persistentData=t:$.freeType(t))}else if(te(t))e.dtype=a||g(t),e.dimension=n,i(e,t,r),o&&(e.persistentData=new Uint8Array(new Uint8Array(t.buffer)));else if(v(t)){n=t.shape;var l=t.stride,s=t.offset,u=0,c=0,f=0,h=0;1===n.length?(u=n[0],c=1,f=l[0],h=0):2===n.length&&(u=n[0],c=n[1],f=l[0],h=l[1]);e.dtype=a||g(t.data)||5126;e.dimension=c;n=$.allocType(e.dtype,u*c);x(n,t.data,u,c,f,h,s);i(e,n,r);o?e.persistentData=n:$.freeType(n)}else t instanceof ArrayBuffer&&(e.dtype=5121,e.dimension=n,i(e,t,r),o&&(e.persistentData=new Uint8Array(new Uint8Array(t))))}function s(r){t.bufferCount--;a(r);e.deleteBuffer(r.buffer);r.buffer=null;delete u[r.id]}var l=0,u={};n.prototype.bind=function(){e.bindBuffer(this.type,this.buffer)};n.prototype.destroy=function(){s(this)};var c=[];r.profile&&(t.getTotalBufferSize=function(){var e=0;Object.keys(u).forEach((function(t){e+=u[t].stats.size}));return e});return{create:function(a,i,l,c){function f(t){var a=35044,n=null,i=0,s=0,l=1;Array.isArray(t)||te(t)||v(t)||t instanceof ArrayBuffer?n=t:"number"===typeof t?i=t|0:t&&("data"in t&&(n=t.data),"usage"in t&&(a=oe[t.usage]),"type"in t&&(s=ie[t.type]),"dimension"in t&&(l=t.dimension|0),"length"in t&&(i=t.length|0));h.bind();n?o(h,n,a,s,l,c):(i&&e.bufferData(h.type,i,a),h.dtype=s||5121,h.usage=a,h.dimension=l,h.byteLength=i);r.profile&&(h.stats.size=h.byteLength*ue[h.dtype]);return f}t.bufferCount++;var h=new n(i);u[h.id]=h;l||f(a);f._reglType="buffer";f._buffer=h;f.subdata=function(t,r){var a=(r||0)|0,n;h.bind();if(te(t)||t instanceof ArrayBuffer)e.bufferSubData(h.type,a,t);else if(Array.isArray(t)){if(0<t.length)if("number"===typeof t[0]){var i=$.allocType(h.dtype,t.length);y(i,t);e.bufferSubData(h.type,a,i);$.freeType(i)}else if(Array.isArray(t[0])||te(t[0]))n=le(t),i=se(t,n,h.dtype),e.bufferSubData(h.type,a,i),$.freeType(i)}else if(v(t)){n=t.shape;var o=t.stride,s=i=0,l=0,u=0;1===n.length?(i=n[0],s=1,l=o[0],u=0):2===n.length&&(i=n[0],s=n[1],l=o[0],u=o[1]);n=Array.isArray(t.data)?h.dtype:g(t.data);n=$.allocType(n,i*s);x(n,t.data,i,s,l,u,t.offset);e.bufferSubData(h.type,a,n);$.freeType(n)}return f};r.profile&&(f.stats=h.stats);f.destroy=function(){s(h)};return f},createStream:function(e,t){var r=c.pop();r||(r=new n(e));r.bind();o(r,t,35040,0,1,!1);return r},destroyStream:function(e){c.push(e)},clear:function(){re(u).forEach(s);c.forEach(s)},getBuffer:function(e){return e&&e._buffer instanceof n?e._buffer:null},restore:function(){re(u).forEach((function(t){t.buffer=e.createBuffer();e.bindBuffer(t.type,t.buffer);e.bufferData(t.type,t.persistentData||t.byteLength,t.usage)}))},_initBuffer:o}}function _(e,t,r,a){function n(e){this.id=l++;s[this.id]=this;this.buffer=e;this.primType=4;this.type=this.vertCount=0}function i(a,n,i,o,s,l,u){a.buffer.bind();var c;n?((c=u)||te(n)&&(!v(n)||te(n.data))||(c=t.oes_element_index_uint?5125:5123),r._initBuffer(a.buffer,n,i,c,3)):(e.bufferData(34963,l,i),a.buffer.dtype=c||5121,a.buffer.usage=i,a.buffer.dimension=3,a.buffer.byteLength=l);c=u;if(!u){switch(a.buffer.dtype){case 5121:case 5120:c=5121;break;case 5123:case 5122:c=5123;break;case 5125:case 5124:c=5125}a.buffer.dtype=c}a.type=c;n=s;0>n&&(n=a.buffer.byteLength,5123===c?n>>=1:5125===c&&(n>>=2));a.vertCount=n;n=o;0>o&&(n=4,o=a.buffer.dimension,1===o&&(n=0),2===o&&(n=1),3===o&&(n=4));a.primType=n}function o(e){a.elementsCount--;delete s[e.id];e.buffer.destroy();e.buffer=null}var s={},l=0,u={uint8:5121,uint16:5123};t.oes_element_index_uint&&(u.uint32=5125);n.prototype.bind=function(){this.buffer.bind()};var c=[];return{create:function(e,t){function s(e){if(e)if("number"===typeof e)l(e),c.primType=4,c.vertCount=e|0,c.type=5121;else{var t=null,r=35044,a=-1,n=-1,o=0,f=0;if(Array.isArray(e)||te(e)||v(e))t=e;else if("data"in e&&(t=e.data),"usage"in e&&(r=oe[e.usage]),"primitive"in e&&(a=ce[e.primitive]),"count"in e&&(n=e.count|0),"type"in e&&(f=u[e.type]),"length"in e)o=e.length|0;else if(o=n,5123===f||5122===f)o*=2;else if(5125===f||5124===f)o*=4;i(c,t,r,a,n,o,f)}else l(),c.primType=4,c.vertCount=0,c.type=5121;return s}var l=r.create(null,34963,!0),c=new n(l._buffer);a.elementsCount++;s(e);s._reglType="elements";s._elements=c;s.subdata=function(e,t){l.subdata(e,t);return s};s.destroy=function(){o(c)};return s},createStream:function(e){var t=c.pop();t||(t=new n(r.create(null,34963,!0,!1)._buffer));i(t,e,35040,-1,-1,0,0);return t},destroyStream:function(e){c.push(e)},getElements:function(e){return"function"===typeof e&&e._elements instanceof n?e._elements:null},clear:function(){re(s).forEach(o)}}}function w(e){for(var t=$.allocType(5123,e.length),r=0;r<e.length;++r)if(isNaN(e[r]))t[r]=65535;else if(Infinity===e[r])t[r]=31744;else if(-Infinity===e[r])t[r]=64512;else{fe[0]=e[r];var a=he[0],n=a>>>31<<15,i=(a<<1>>>24)-127,a=a>>13&1023;t[r]=-24>i?n:-14>i?n+(a+1024>>-14-i):15<i?n+31744:n+(i+15<<10)+a}return t}function T(e){return Array.isArray(e)||te(e)}function k(e){return"[object "+e+"]"}function M(e){return Array.isArray(e)&&(0===e.length||"number"===typeof e[0])}function A(e){return Array.isArray(e)&&0!==e.length&&T(e[0])?!0:!1}function S(e){return Object.prototype.toString.call(e)}function E(e){if(!e)return!1;var t=S(e);return 0<=we.indexOf(t)?!0:M(e)||A(e)||v(e)}function L(e,t){36193===e.type?(e.data=w(t),$.freeType(t)):e.data=t}function C(e,t,r,a,n,i){e="undefined"!==typeof ke[e]?ke[e]:de[e]*Te[t];i&&(e*=6);if(n){for(a=0;1<=r;)a+=e*r*r,r/=2;return a}return e*r*a}function I(e,t,r,a,n,i,o){function s(){this.format=this.internalformat=6408;this.type=5121;this.flipY=this.premultiplyAlpha=this.compressed=!1;this.unpackAlignment=1;this.colorSpace=37444;this.channels=this.height=this.width=0}function l(e,t){e.internalformat=t.internalformat;e.format=t.format;e.type=t.type;e.compressed=t.compressed;e.premultiplyAlpha=t.premultiplyAlpha;e.flipY=t.flipY;e.unpackAlignment=t.unpackAlignment;e.colorSpace=t.colorSpace;e.width=t.width;e.height=t.height;e.channels=t.channels}function u(e,t){if("object"===typeof t&&t){"premultiplyAlpha"in t&&(e.premultiplyAlpha=t.premultiplyAlpha);"flipY"in t&&(e.flipY=t.flipY);"alignment"in t&&(e.unpackAlignment=t.alignment);"colorSpace"in t&&(e.colorSpace=V[t.colorSpace]);"type"in t&&(e.type=H[t.type]);var r=e.width,a=e.height,n=e.channels,i=!1;"shape"in t?(r=t.shape[0],a=t.shape[1],3===t.shape.length&&(n=t.shape[2],i=!0)):("radius"in t&&(r=a=t.radius),"width"in t&&(r=t.width),"height"in t&&(a=t.height),"channels"in t&&(n=t.channels,i=!0));e.width=r|0;e.height=a|0;e.channels=n|0;r=!1;"format"in t&&(r=t.format,a=e.internalformat=q[r],e.format=ie[a],r in H&&!("type"in t)&&(e.type=H[r]),r in G&&(e.compressed=!0),r=!0);!i&&r?e.channels=de[e.format]:i&&!r&&e.channels!==ve[e.format]&&(e.format=e.internalformat=ve[e.channels])}}function c(t){e.pixelStorei(37440,t.flipY);e.pixelStorei(37441,t.premultiplyAlpha);e.pixelStorei(37443,t.colorSpace);e.pixelStorei(3317,t.unpackAlignment)}function f(){s.call(this);this.yOffset=this.xOffset=0;this.data=null;this.needsFree=!1;this.element=null;this.needsCopy=!1}function h(e,t){var r=null;E(t)?r=t:t&&(u(e,t),"x"in t&&(e.xOffset=t.x|0),"y"in t&&(e.yOffset=t.y|0),E(t.data)&&(r=t.data));if(t.copy){var a=n.viewportWidth,i=n.viewportHeight;e.width=e.width||a-e.xOffset;e.height=e.height||i-e.yOffset;e.needsCopy=!0}else if(!r)e.width=e.width||1,e.height=e.height||1,e.channels=e.channels||4;else if(te(r))e.channels=e.channels||4,e.data=r,"type"in t||5121!==e.type||(e.type=ne[Object.prototype.toString.call(r)]|0);else if(M(r)){e.channels=e.channels||4;a=r;i=a.length;switch(e.type){case 5121:case 5123:case 5125:case 5126:i=$.allocType(e.type,i);i.set(a);e.data=i;break;case 36193:e.data=w(a)}e.alignment=1;e.needsFree=!0}else if(v(r)){a=r.data;Array.isArray(a)||5121!==e.type||(e.type=ne[Object.prototype.toString.call(a)]|0);var i=r.shape,o=r.stride,s,l,c,f;3===i.length?(c=i[2],f=o[2]):f=c=1;s=i[0];l=i[1];i=o[0];o=o[1];e.alignment=1;e.width=s;e.height=l;e.channels=c;e.format=e.internalformat=ve[c];e.needsFree=!0;s=f;r=r.offset;c=e.width;f=e.height;l=e.channels;for(var h=$.allocType(36193===e.type?5126:e.type,c*f*l),p=0,d=0;d<f;++d)for(var m=0;m<c;++m)for(var g=0;g<l;++g)h[p++]=a[i*m+o*d+s*g+r];L(e,h)}else if(S(r)===me||S(r)===ge||S(r)===ye)S(r)===me||S(r)===ge?e.element=r:e.element=r.canvas,e.width=e.element.width,e.height=e.element.height,e.channels=4;else if(S(r)===xe)e.element=r,e.width=r.width,e.height=r.height,e.channels=4;else if(S(r)===be)e.element=r,e.width=r.naturalWidth,e.height=r.naturalHeight,e.channels=4;else if(S(r)===_e)e.element=r,e.width=r.videoWidth,e.height=r.videoHeight,e.channels=4;else if(A(r)){a=e.width||r[0].length;i=e.height||r.length;o=e.channels;o=T(r[0][0])?o||r[0][0].length:o||1;s=ae.shape(r);c=1;for(f=0;f<s.length;++f)c*=s[f];c=$.allocType(36193===e.type?5126:e.type,c);ae.flatten(r,s,"",c);L(e,c);e.alignment=1;e.width=a;e.height=i;e.channels=o;e.format=e.internalformat=ve[o];e.needsFree=!0}}function p(t,r,n,i,o){var s=t.element,l=t.data,u=t.internalformat,f=t.format,h=t.type,p=t.width,v=t.height;c(t);s?e.texSubImage2D(r,o,n,i,f,h,s):t.compressed?e.compressedTexSubImage2D(r,o,n,i,u,p,v,l):t.needsCopy?(a(),e.copyTexSubImage2D(r,o,n,i,t.xOffset,t.yOffset,p,v)):e.texSubImage2D(r,o,n,i,p,v,f,h,l)}function d(){return oe.pop()||new f}function m(e){e.needsFree&&$.freeType(e.data);f.call(e);oe.push(e)}function g(){s.call(this);this.genMipmaps=!1;this.mipmapHint=4352;this.mipmask=0;this.images=Array(16)}function y(e,t,r){var a=e.images[0]=d();e.mipmask=1;a.width=e.width=t;a.height=e.height=r;a.channels=e.channels=4}function x(e,t){var r=null;if(E(t))r=e.images[0]=d(),l(r,e),h(r,t),e.mipmask=1;else if(u(e,t),Array.isArray(t.mipmap))for(var a=t.mipmap,n=0;n<a.length;++n)r=e.images[n]=d(),l(r,e),r.width>>=n,r.height>>=n,h(r,a[n]),e.mipmask|=1<<n;else r=e.images[0]=d(),l(r,e),h(r,t),e.mipmask=1;l(e,e.images[0])}function b(t,r){for(var n=t.images,i=0;i<n.length&&n[i];++i){var o=n[i],s=r,l=i,u=o.element,f=o.data,h=o.internalformat,p=o.format,v=o.type,d=o.width,m=o.height;c(o);u?e.texImage2D(s,l,p,p,v,u):o.compressed?e.compressedTexImage2D(s,l,h,d,m,0,f):o.needsCopy?(a(),e.copyTexImage2D(s,l,p,o.xOffset,o.yOffset,d,m,0)):e.texImage2D(s,l,p,d,m,0,p,v,f||null)}}function _(){var e=se.pop()||new g;s.call(e);for(var t=e.mipmask=0;16>t;++t)e.images[t]=null;return e}function k(e){for(var t=e.images,r=0;r<t.length;++r)t[r]&&m(t[r]),t[r]=null;se.push(e)}function I(){this.magFilter=this.minFilter=9728;this.wrapT=this.wrapS=33071;this.anisotropic=1;this.genMipmaps=!1;this.mipmapHint=4352}function P(e,t){"min"in t&&(e.minFilter=U[t.min],0<=pe.indexOf(e.minFilter)&&!("faces"in t)&&(e.genMipmaps=!0));"mag"in t&&(e.magFilter=j[t.mag]);var r=e.wrapS,a=e.wrapT;if("wrap"in t){var n=t.wrap;"string"===typeof n?r=a=N[n]:Array.isArray(n)&&(r=N[n[0]],a=N[n[1]])}else"wrapS"in t&&(r=N[t.wrapS]),"wrapT"in t&&(a=N[t.wrapT]);e.wrapS=r;e.wrapT=a;"anisotropic"in t&&(e.anisotropic=t.anisotropic);if("mipmap"in t){r=!1;switch(typeof t.mipmap){case"string":e.mipmapHint=B[t.mipmap];r=e.genMipmaps=!0;break;case"boolean":r=e.genMipmaps=t.mipmap;break;case"object":e.genMipmaps=!1,r=!0}!r||"min"in t||(e.minFilter=9984)}}function O(r,a){e.texParameteri(a,10241,r.minFilter);e.texParameteri(a,10240,r.magFilter);e.texParameteri(a,10242,r.wrapS);e.texParameteri(a,10243,r.wrapT);t.ext_texture_filter_anisotropic&&e.texParameteri(a,34046,r.anisotropic);r.genMipmaps&&(e.hint(33170,r.mipmapHint),e.generateMipmap(a))}function z(t){s.call(this);this.mipmask=0;this.internalformat=6408;this.id=le++;this.refCount=1;this.target=t;this.texture=e.createTexture();this.unit=-1;this.bindCount=0;this.texInfo=new I;o.profile&&(this.stats={size:0})}function D(t){e.activeTexture(33984);e.bindTexture(t.target,t.texture)}function R(){var t=fe[0];t?e.bindTexture(t.target,t.texture):e.bindTexture(3553,null)}function F(t){var r=t.texture,a=t.unit,n=t.target;0<=a&&(e.activeTexture(33984+a),e.bindTexture(n,null),fe[a]=null);e.deleteTexture(r);t.texture=null;t.params=null;t.pixels=null;t.refCount=0;delete ue[t.id];i.textureCount--}var B={"don't care":4352,"dont care":4352,nice:4354,fast:4353},N={repeat:10497,clamp:33071,mirror:33648},j={nearest:9728,linear:9729},U=X({mipmap:9987,"nearest mipmap nearest":9984,"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":9987},j),V={none:0,browser:37444},H={uint8:5121,rgba4:32819,rgb565:33635,"rgb5 a1":32820},q={alpha:6406,luminance:6409,"luminance alpha":6410,rgb:6407,rgba:6408,rgba4:32854,"rgb5 a1":32855,rgb565:36194},G={};t.ext_srgb&&(q.srgb=35904,q.srgba=35906);t.oes_texture_float&&(H.float32=H["float"]=5126);t.oes_texture_half_float&&(H.float16=H["half float"]=36193);t.webgl_depth_texture&&(X(q,{depth:6402,"depth stencil":34041}),X(H,{uint16:5123,uint32:5125,"depth stencil":34042}));t.webgl_compressed_texture_s3tc&&X(G,{"rgb s3tc dxt1":33776,"rgba s3tc dxt1":33777,"rgba s3tc dxt3":33778,"rgba s3tc dxt5":33779});t.webgl_compressed_texture_atc&&X(G,{"rgb atc":35986,"rgba atc explicit alpha":35987,"rgba atc interpolated alpha":34798});t.webgl_compressed_texture_pvrtc&&X(G,{"rgb pvrtc 4bppv1":35840,"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,"rgba pvrtc 2bppv1":35843});t.webgl_compressed_texture_etc1&&(G["rgb etc1"]=36196);var Y=Array.prototype.slice.call(e.getParameter(34467));Object.keys(G).forEach((function(e){var t=G[e];0<=Y.indexOf(t)&&(q[e]=t)}));var W=Object.keys(q);r.textureFormats=W;var Z=[];Object.keys(q).forEach((function(e){Z[q[e]]=e}));var J=[];Object.keys(H).forEach((function(e){J[H[e]]=e}));var K=[];Object.keys(j).forEach((function(e){K[j[e]]=e}));var Q=[];Object.keys(U).forEach((function(e){Q[U[e]]=e}));var ee=[];Object.keys(N).forEach((function(e){ee[N[e]]=e}));var ie=W.reduce((function(e,r){var a=q[r];6409===a||6406===a||6409===a||6410===a||6402===a||34041===a||t.ext_srgb&&(35904===a||35906===a)?e[a]=a:32855===a||0<=r.indexOf("rgba")?e[a]=6408:e[a]=6407;return e}),{}),oe=[],se=[],le=0,ue={},ce=r.maxTextureUnits,fe=Array(ce).map((function(){return null}));X(z.prototype,{bind:function(){this.bindCount+=1;var t=this.unit;if(0>t){for(var r=0;r<ce;++r){var a=fe[r];if(a){if(0<a.bindCount)continue;a.unit=-1}fe[r]=this;t=r;break}o.profile&&i.maxTextureUnits<t+1&&(i.maxTextureUnits=t+1);this.unit=t;e.activeTexture(33984+t);e.bindTexture(this.target,this.texture)}return t},unbind:function(){--this.bindCount},decRef:function(){0>=--this.refCount&&F(this)}});o.profile&&(i.getTotalTextureSize=function(){var e=0;Object.keys(ue).forEach((function(t){e+=ue[t].stats.size}));return e});return{create2D:function(t,r){function a(e,t){var r=n.texInfo;I.call(r);var i=_();"number"===typeof e?"number"===typeof t?y(i,e|0,t|0):y(i,e|0,e|0):e?(P(r,e),x(i,e)):y(i,1,1);r.genMipmaps&&(i.mipmask=(i.width<<1)-1);n.mipmask=i.mipmask;l(n,i);n.internalformat=i.internalformat;a.width=i.width;a.height=i.height;D(n);b(i,3553);O(r,3553);R();k(i);o.profile&&(n.stats.size=C(n.internalformat,n.type,i.width,i.height,r.genMipmaps,!1));a.format=Z[n.internalformat];a.type=J[n.type];a.mag=K[r.magFilter];a.min=Q[r.minFilter];a.wrapS=ee[r.wrapS];a.wrapT=ee[r.wrapT];return a}var n=new z(3553);ue[n.id]=n;i.textureCount++;a(t,r);a.subimage=function(e,t,r,i){t|=0;r|=0;i|=0;var o=d();l(o,n);o.width=0;o.height=0;h(o,e);o.width=o.width||(n.width>>i)-t;o.height=o.height||(n.height>>i)-r;D(n);p(o,3553,t,r,i);R();m(o);return a};a.resize=function(t,r){var i=t|0,s=r|0||i;if(i===n.width&&s===n.height)return a;a.width=n.width=i;a.height=n.height=s;D(n);for(var l=0;n.mipmask>>l;++l){var u=i>>l,c=s>>l;if(!u||!c)break;e.texImage2D(3553,l,n.format,u,c,0,n.format,n.type,null)}R();o.profile&&(n.stats.size=C(n.internalformat,n.type,i,s,!1,!1));return a};a._reglType="texture2d";a._texture=n;o.profile&&(a.stats=n.stats);a.destroy=function(){n.decRef()};return a},createCube:function(t,r,a,n,s,c){function f(e,t,r,a,n,i){var s,c=v.texInfo;I.call(c);for(s=0;6>s;++s)g[s]=_();if("number"===typeof e||!e)for(e=e|0||1,s=0;6>s;++s)y(g[s],e,e);else if("object"===typeof e)if(t)x(g[0],e),x(g[1],t),x(g[2],r),x(g[3],a),x(g[4],n),x(g[5],i);else if(P(c,e),u(v,e),"faces"in e)for(e=e.faces,s=0;6>s;++s)l(g[s],v),x(g[s],e[s]);else for(s=0;6>s;++s)x(g[s],e);l(v,g[0]);v.mipmask=c.genMipmaps?(g[0].width<<1)-1:g[0].mipmask;v.internalformat=g[0].internalformat;f.width=g[0].width;f.height=g[0].height;D(v);for(s=0;6>s;++s)b(g[s],34069+s);O(c,34067);R();o.profile&&(v.stats.size=C(v.internalformat,v.type,f.width,f.height,c.genMipmaps,!0));f.format=Z[v.internalformat];f.type=J[v.type];f.mag=K[c.magFilter];f.min=Q[c.minFilter];f.wrapS=ee[c.wrapS];f.wrapT=ee[c.wrapT];for(s=0;6>s;++s)k(g[s]);return f}var v=new z(34067);ue[v.id]=v;i.cubeCount++;var g=Array(6);f(t,r,a,n,s,c);f.subimage=function(e,t,r,a,n){r|=0;a|=0;n|=0;var i=d();l(i,v);i.width=0;i.height=0;h(i,t);i.width=i.width||(v.width>>n)-r;i.height=i.height||(v.height>>n)-a;D(v);p(i,34069+e,r,a,n);R();m(i);return f};f.resize=function(t){t|=0;if(t!==v.width){f.width=v.width=t;f.height=v.height=t;D(v);for(var r=0;6>r;++r)for(var a=0;v.mipmask>>a;++a)e.texImage2D(34069+r,a,v.format,t>>a,t>>a,0,v.format,v.type,null);R();o.profile&&(v.stats.size=C(v.internalformat,v.type,f.width,f.height,!1,!0));return f}};f._reglType="textureCube";f._texture=v;o.profile&&(f.stats=v.stats);f.destroy=function(){v.decRef()};return f},clear:function(){for(var t=0;t<ce;++t)e.activeTexture(33984+t),e.bindTexture(3553,null),fe[t]=null;re(ue).forEach(F);i.cubeCount=0;i.textureCount=0},getTexture:function(e){return null},restore:function(){for(var t=0;t<ce;++t){var r=fe[t];r&&(r.bindCount=0,r.unit=-1,fe[t]=null)}re(ue).forEach((function(t){t.texture=e.createTexture();e.bindTexture(t.target,t.texture);for(var r=0;32>r;++r)if(0!==(t.mipmask&1<<r))if(3553===t.target)e.texImage2D(3553,r,t.internalformat,t.width>>r,t.height>>r,0,t.internalformat,t.type,null);else for(var a=0;6>a;++a)e.texImage2D(34069+a,r,t.internalformat,t.width>>r,t.height>>r,0,t.internalformat,t.type,null);O(t.texInfo,t.target)}))},refresh:function(){for(var t=0;t<ce;++t){var r=fe[t];r&&(r.bindCount=0,r.unit=-1,fe[t]=null);e.activeTexture(33984+t);e.bindTexture(3553,null);e.bindTexture(34067,null)}}}}function P(e,t,r,a,n,i){function o(e,t,r){this.target=e;this.texture=t;this.renderbuffer=r;var a=e=0;t?(e=t.width,a=t.height):r&&(e=r.width,a=r.height);this.width=e;this.height=a}function s(e){e&&(e.texture&&e.texture._texture.decRef(),e.renderbuffer&&e.renderbuffer._renderbuffer.decRef())}function l(e,t,r){e&&(e.texture?e.texture._texture.refCount+=1:e.renderbuffer._renderbuffer.refCount+=1)}function u(t,r){r&&(r.texture?e.framebufferTexture2D(36160,t,r.target,r.texture._texture.texture,0):e.framebufferRenderbuffer(36160,t,36161,r.renderbuffer._renderbuffer.renderbuffer))}function c(e){var t=3553,r=null,a=null,n=e;"object"===typeof e&&(n=e.data,"target"in e&&(t=e.target|0));e=n._reglType;"texture2d"===e?r=n:"textureCube"===e?r=n:"renderbuffer"===e&&(a=n,t=36161);return new o(t,r,a)}function f(e,t,r,i,s){if(r)return e=a.create2D({width:e,height:t,format:i,type:s}),e._texture.refCount=0,new o(3553,e,null);e=n.create({width:e,height:t,format:i});e._renderbuffer.refCount=0;return new o(36161,null,e)}function h(e){return e&&(e.texture||e.renderbuffer)}function p(e,t,r){e&&(e.texture?e.texture.resize(t,r):e.renderbuffer&&e.renderbuffer.resize(t,r),e.width=t,e.height=r)}function v(){this.id=T++;k[this.id]=this;this.framebuffer=e.createFramebuffer();this.height=this.width=0;this.colorAttachments=[];this.depthStencilAttachment=this.stencilAttachment=this.depthAttachment=null}function d(e){e.colorAttachments.forEach(s);s(e.depthAttachment);s(e.stencilAttachment);s(e.depthStencilAttachment)}function m(t){e.deleteFramebuffer(t.framebuffer);t.framebuffer=null;i.framebufferCount--;delete k[t.id]}function g(t){var a;e.bindFramebuffer(36160,t.framebuffer);var n=t.colorAttachments;for(a=0;a<n.length;++a)u(36064+a,n[a]);for(a=n.length;a<r.maxColorAttachments;++a)e.framebufferTexture2D(36160,36064+a,3553,null,0);e.framebufferTexture2D(36160,33306,3553,null,0);e.framebufferTexture2D(36160,36096,3553,null,0);e.framebufferTexture2D(36160,36128,3553,null,0);u(36096,t.depthAttachment);u(36128,t.stencilAttachment);u(33306,t.depthStencilAttachment);e.checkFramebufferStatus(36160);e.isContextLost();e.bindFramebuffer(36160,x.next?x.next.framebuffer:null);x.cur=x.next;e.getError()}function y(e,t){function r(e,t){var n,i=0,o=0,s=!0,u=!0;n=null;var p=!0,v="rgba",m="uint8",y=1,x=null,w=null,T=null,k=!1;if("number"===typeof e)i=e|0,o=t|0||i;else if(e){"shape"in e?(o=e.shape,i=o[0],o=o[1]):("radius"in e&&(i=o=e.radius),"width"in e&&(i=e.width),"height"in e&&(o=e.height));if("color"in e||"colors"in e)n=e.color||e.colors,Array.isArray(n);if(!n){"colorCount"in e&&(y=e.colorCount|0);"colorTexture"in e&&(p=!!e.colorTexture,v="rgba4");if("colorType"in e&&(m=e.colorType,!p))if("half float"===m||"float16"===m)v="rgba16f";else if("float"===m||"float32"===m)v="rgba32f";"colorFormat"in e&&(v=e.colorFormat,0<=b.indexOf(v)?p=!0:0<=_.indexOf(v)&&(p=!1))}if("depthTexture"in e||"depthStencilTexture"in e)k=!(!e.depthTexture&&!e.depthStencilTexture);"depth"in e&&("boolean"===typeof e.depth?s=e.depth:(x=e.depth,u=!1));"stencil"in e&&("boolean"===typeof e.stencil?u=e.stencil:(w=e.stencil,s=!1));"depthStencil"in e&&("boolean"===typeof e.depthStencil?s=u=e.depthStencil:(T=e.depthStencil,u=s=!1))}else i=o=1;var M=null,A=null,S=null,E=null;if(Array.isArray(n))M=n.map(c);else if(n)M=[c(n)];else for(M=Array(y),n=0;n<y;++n)M[n]=f(i,o,p,v,m);i=i||M[0].width;o=o||M[0].height;x?A=c(x):s&&!u&&(A=f(i,o,k,"depth","uint32"));w?S=c(w):u&&!s&&(S=f(i,o,!1,"stencil","uint8"));T?E=c(T):!x&&!w&&u&&s&&(E=f(i,o,k,"depth stencil","depth stencil"));s=null;for(n=0;n<M.length;++n)l(M[n],i,o),M[n]&&M[n].texture&&(u=Se[M[n].texture._texture.format]*Ee[M[n].texture._texture.type],null===s&&(s=u));l(A,i,o);l(S,i,o);l(E,i,o);d(a);a.width=i;a.height=o;a.colorAttachments=M;a.depthAttachment=A;a.stencilAttachment=S;a.depthStencilAttachment=E;r.color=M.map(h);r.depth=h(A);r.stencil=h(S);r.depthStencil=h(E);r.width=a.width;r.height=a.height;g(a);return r}var a=new v;i.framebufferCount++;r(e,t);return X(r,{resize:function(e,t){var n=Math.max(e|0,1),i=Math.max(t|0||n,1);if(n===a.width&&i===a.height)return r;for(var o=a.colorAttachments,s=0;s<o.length;++s)p(o[s],n,i);p(a.depthAttachment,n,i);p(a.stencilAttachment,n,i);p(a.depthStencilAttachment,n,i);a.width=r.width=n;a.height=r.height=i;g(a);return r},_reglType:"framebuffer",_framebuffer:a,destroy:function(){m(a);d(a)},use:function(e){x.setFBO({framebuffer:r},e)}})}var x={cur:null,next:null,dirty:!1,setFBO:null},b=["rgba"],_=["rgba4","rgb565","rgb5 a1"];t.ext_srgb&&_.push("srgba");t.ext_color_buffer_half_float&&_.push("rgba16f","rgb16f");t.webgl_color_buffer_float&&_.push("rgba32f");var w=["uint8"];t.oes_texture_half_float&&w.push("half float","float16");t.oes_texture_float&&w.push("float","float32");var T=0,k={};return X(x,{getFramebuffer:function(e){return"function"===typeof e&&"framebuffer"===e._reglType&&(e=e._framebuffer,e instanceof v)?e:null},create:y,createCube:function(e){function t(e){var n,i={color:null},o=0,s=null;n="rgba";var l="uint8",u=1;if("number"===typeof e)o=e|0;else if(e){"shape"in e?o=e.shape[0]:("radius"in e&&(o=e.radius|0),"width"in e?o=e.width|0:"height"in e&&(o=e.height|0));if("color"in e||"colors"in e)s=e.color||e.colors,Array.isArray(s);s||("colorCount"in e&&(u=e.colorCount|0),"colorType"in e&&(l=e.colorType),"colorFormat"in e&&(n=e.colorFormat));"depth"in e&&(i.depth=e.depth);"stencil"in e&&(i.stencil=e.stencil);"depthStencil"in e&&(i.depthStencil=e.depthStencil)}else o=1;if(s)if(Array.isArray(s))for(e=[],n=0;n<s.length;++n)e[n]=s[n];else e=[s];else for(e=Array(u),s={radius:o,format:n,type:l},n=0;n<u;++n)e[n]=a.createCube(s);i.color=Array(e.length);for(n=0;n<e.length;++n)u=e[n],o=o||u.width,i.color[n]={target:34069,data:e[n]};for(n=0;6>n;++n){for(u=0;u<e.length;++u)i.color[u].target=34069+n;0<n&&(i.depth=r[0].depth,i.stencil=r[0].stencil,i.depthStencil=r[0].depthStencil);if(r[n])r[n](i);else r[n]=y(i)}return X(t,{width:o,height:o,color:e})}var r=Array(6);t(e);return X(t,{faces:r,resize:function(e){var a=e|0;if(a===t.width)return t;var n=t.color;for(e=0;e<n.length;++e)n[e].resize(a);for(e=0;6>e;++e)r[e].resize(a);t.width=t.height=a;return t},_reglType:"framebufferCube",destroy:function(){r.forEach((function(e){e.destroy()}))}})},clear:function(){re(k).forEach(m)},restore:function(){x.cur=null;x.next=null;x.dirty=!0;re(k).forEach((function(t){t.framebuffer=e.createFramebuffer();g(t)}))}})}function O(){this.w=this.z=this.y=this.x=this.state=0;this.buffer=null;this.size=0;this.normalized=!1;this.type=5126;this.divisor=this.stride=this.offset=0}function z(e,t,r,a,n,i,o){function s(e){if(e!==g.currentVAO){var r=t.oes_vertex_array_object;e?r.bindVertexArrayOES(e.vao):r.bindVertexArrayOES(null);g.currentVAO=e}}function l(r){if(r!==g.currentVAO){if(r)r.bindAttrs();else{for(var a=t.angle_instanced_arrays,n=0;n<p.length;++n){var i=p[n];i.buffer?(e.enableVertexAttribArray(n),i.buffer.bind(),e.vertexAttribPointer(n,i.size,i.type,i.normalized,i.stride,i.offfset),a&&i.divisor&&a.vertexAttribDivisorANGLE(n,i.divisor)):(e.disableVertexAttribArray(n),e.vertexAttrib4f(n,i.x,i.y,i.z,i.w))}o.elements?e.bindBuffer(34963,o.elements.buffer.buffer):e.bindBuffer(34963,null)}g.currentVAO=r}}function u(){re(m).forEach((function(e){e.destroy()}))}function c(){this.id=++d;this.attributes=[];this.elements=null;this.ownsElements=!1;this.offset=this.count=0;this.instances=-1;this.primitive=4;var e=t.oes_vertex_array_object;this.vao=e?e.createVertexArrayOES():null;m[this.id]=this;this.buffers=[]}function f(){t.oes_vertex_array_object&&re(m).forEach((function(e){e.refresh()}))}var h=r.maxAttributes,p=Array(h);for(r=0;r<h;++r)p[r]=new O;var d=0,m={},g={Record:O,scope:{},state:p,currentVAO:null,targetVAO:null,restore:t.oes_vertex_array_object?f:function(){},createVAO:function(e){function t(e){var a;Array.isArray(e)?(a=e,r.elements&&r.ownsElements&&r.elements.destroy(),r.elements=null,r.ownsElements=!1,r.offset=0,r.count=0,r.instances=-1,r.primitive=4):(e.elements?(a=e.elements,r.ownsElements?("function"===typeof a&&"elements"===a._reglType?r.elements.destroy():r.elements(a),r.ownsElements=!1):i.getElements(e.elements)?(r.elements=e.elements,r.ownsElements=!1):(r.elements=i.create(e.elements),r.ownsElements=!0)):(r.elements=null,r.ownsElements=!1),a=e.attributes,r.offset=0,r.count=-1,r.instances=-1,r.primitive=4,r.elements&&(r.count=r.elements._elements.vertCount,r.primitive=r.elements._elements.primType),"offset"in e&&(r.offset=e.offset|0),"count"in e&&(r.count=e.count|0),"instances"in e&&(r.instances=e.instances|0),"primitive"in e&&(r.primitive=ce[e.primitive]));e={};var o=r.attributes;o.length=a.length;for(var s=0;s<a.length;++s){var l=a[s],u=o[s]=new O,c=l.data||l;if(Array.isArray(c)||te(c)||v(c)){var f;r.buffers[s]&&(f=r.buffers[s],te(c)&&f._buffer.byteLength>=c.byteLength?f.subdata(c):(f.destroy(),r.buffers[s]=null));r.buffers[s]||(f=r.buffers[s]=n.create(l,34962,!1,!0));u.buffer=n.getBuffer(f);u.size=u.buffer.dimension|0;u.normalized=!1;u.type=u.buffer.dtype;u.offset=0;u.stride=0;u.divisor=0;u.state=1;e[s]=1}else n.getBuffer(l)?(u.buffer=n.getBuffer(l),u.size=u.buffer.dimension|0,u.normalized=!1,u.type=u.buffer.dtype,u.offset=0,u.stride=0,u.divisor=0,u.state=1):n.getBuffer(l.buffer)?(u.buffer=n.getBuffer(l.buffer),u.size=(+l.size||u.buffer.dimension)|0,u.normalized=!!l.normalized||!1,u.type="type"in l?ie[l.type]:u.buffer.dtype,u.offset=(l.offset||0)|0,u.stride=(l.stride||0)|0,u.divisor=(l.divisor||0)|0,u.state=1):"x"in l&&(u.x=+l.x||0,u.y=+l.y||0,u.z=+l.z||0,u.w=+l.w||0,u.state=2)}for(f=0;f<r.buffers.length;++f)!e[f]&&r.buffers[f]&&(r.buffers[f].destroy(),r.buffers[f]=null);r.refresh();return t}var r=new c;a.vaoCount+=1;t.destroy=function(){for(var e=0;e<r.buffers.length;++e)r.buffers[e]&&r.buffers[e].destroy();r.buffers.length=0;r.ownsElements&&(r.elements.destroy(),r.elements=null,r.ownsElements=!1);r.destroy()};t._vao=r;t._reglType="vao";return t(e)},getVAO:function(e){return"function"===typeof e&&e._vao?e._vao:null},destroyBuffer:function(t){for(var r=0;r<p.length;++r){var a=p[r];a.buffer===t&&(e.disableVertexAttribArray(r),a.buffer=null)}},setVAO:t.oes_vertex_array_object?s:l,clear:t.oes_vertex_array_object?u:function(){}};c.prototype.bindAttrs=function(){for(var r=t.angle_instanced_arrays,a=this.attributes,n=0;n<a.length;++n){var o=a[n];o.buffer?(e.enableVertexAttribArray(n),e.bindBuffer(34962,o.buffer.buffer),e.vertexAttribPointer(n,o.size,o.type,o.normalized,o.stride,o.offset),r&&o.divisor&&r.vertexAttribDivisorANGLE(n,o.divisor)):(e.disableVertexAttribArray(n),e.vertexAttrib4f(n,o.x,o.y,o.z,o.w))}for(r=a.length;r<h;++r)e.disableVertexAttribArray(r);(r=i.getElements(this.elements))?e.bindBuffer(34963,r.buffer.buffer):e.bindBuffer(34963,null)};c.prototype.refresh=function(){var e=t.oes_vertex_array_object;e&&(e.bindVertexArrayOES(this.vao),this.bindAttrs(),g.currentVAO=null,e.bindVertexArrayOES(null))};c.prototype.destroy=function(){if(this.vao){var e=t.oes_vertex_array_object;this===g.currentVAO&&(g.currentVAO=null,e.bindVertexArrayOES(null));e.deleteVertexArrayOES(this.vao);this.vao=null}this.ownsElements&&(this.elements.destroy(),this.elements=null,this.ownsElements=!1);m[this.id]&&(delete m[this.id],--a.vaoCount)};return g}function D(e,t,r,a){function n(e,t,r,a){this.name=e;this.id=t;this.location=r;this.info=a}function i(e,t){for(var r=0;r<e.length;++r)if(e[r].id===t.id){e[r].location=t.location;return}e.push(t)}function o(r,a,n){n=35632===r?u:c;var i=n[a];if(!i){var o=t.str(a),i=e.createShader(r);e.shaderSource(i,o);e.compileShader(i);n[a]=i}return i}function s(e,t){this.id=p++;this.fragId=e;this.vertId=t;this.program=null;this.uniforms=[];this.attributes=[];this.refCount=1;a.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function l(r,s,l){var u;u=o(35632,r.fragId);var c=o(35633,r.vertId);s=r.program=e.createProgram();e.attachShader(s,u);e.attachShader(s,c);if(l)for(u=0;u<l.length;++u)c=l[u],e.bindAttribLocation(s,c[0],c[1]);e.linkProgram(s);c=e.getProgramParameter(s,35718);a.profile&&(r.stats.uniformsCount=c);var f=r.uniforms;for(u=0;u<c;++u)if(l=e.getActiveUniform(s,u)){if(1<l.size)for(var h=0;h<l.size;++h){var p=l.name.replace("[0]","["+h+"]");i(f,new n(p,t.id(p),e.getUniformLocation(s,p),l))}h=l.name;1<l.size&&(h=h.replace("[0]",""));i(f,new n(h,t.id(h),e.getUniformLocation(s,h),l))}c=e.getProgramParameter(s,35721);a.profile&&(r.stats.attributesCount=c);r=r.attributes;for(u=0;u<c;++u)(l=e.getActiveAttrib(s,u))&&i(r,new n(l.name,t.id(l.name),e.getAttribLocation(s,l.name),l))}var u={},c={},f={},h=[],p=0;a.profile&&(r.getMaxUniformsCount=function(){var e=0;h.forEach((function(t){t.stats.uniformsCount>e&&(e=t.stats.uniformsCount)}));return e},r.getMaxAttributesCount=function(){var e=0;h.forEach((function(t){t.stats.attributesCount>e&&(e=t.stats.attributesCount)}));return e});return{clear:function(){var t=e.deleteShader.bind(e);re(u).forEach(t);u={};re(c).forEach(t);c={};h.forEach((function(t){e.deleteProgram(t.program)}));h.length=0;f={};r.shaderCount=0},program:function(t,a,n,i){var o=f[a];o||(o=f[a]={});var p=o[t];if(p&&(p.refCount++,!i))return p;var v=new s(a,t);r.shaderCount++;l(v,n,i);p||(o[t]=v);h.push(v);return X(v,{destroy:function(){v.refCount--;if(0>=v.refCount){e.deleteProgram(v.program);var t=h.indexOf(v);h.splice(t,1);r.shaderCount--}0>=o[v.vertId].refCount&&(e.deleteShader(c[v.vertId]),delete c[v.vertId],delete f[v.fragId][v.vertId]);Object.keys(f[v.fragId]).length||(e.deleteShader(u[v.fragId]),delete u[v.fragId],delete f[v.fragId])}})},restore:function(){u={};c={};for(var e=0;e<h.length;++e)l(h[e],null,h[e].attributes.map((function(e){return[e.location,e.name]})))},shader:o,frag:-1,vert:-1}}function R(e,t,r,a,n,i,o){function s(n){var i;i=null===t.next?5121:t.next.colorAttachments[0].texture._texture.type;var o=0,s=0,l=a.framebufferWidth,u=a.framebufferHeight,c=null;te(n)?c=n:n&&(o=n.x|0,s=n.y|0,l=(n.width||a.framebufferWidth-o)|0,u=(n.height||a.framebufferHeight-s)|0,c=n.data||null);r();n=l*u*4;c||(5121===i?c=new Uint8Array(n):5126===i&&(c=c||new Float32Array(n)));e.pixelStorei(3333,4);e.readPixels(o,s,l,u,6408,i,c);return c}function l(e){var r;t.setFBO({framebuffer:e.framebuffer},(function(){r=s(e)}));return r}return function(e){return e&&"framebuffer"in e?l(e):s(e)}}function F(e){return Array.prototype.slice.call(e)}function B(e){return F(e).join("")}function N(){function e(){var e=[],t=[];return X((function(){e.push.apply(e,F(arguments))}),{def:function(){var a="v"+r++;t.push(a);0<arguments.length&&(e.push(a,"="),e.push.apply(e,F(arguments)),e.push(";"));return a},toString:function(){return B([0<t.length?"var "+t.join(",")+";":"",B(e)])}})}function t(){function t(e,t){a(e,t,"=",r.def(e,t),";")}var r=e(),a=e(),n=r.toString,i=a.toString;return X((function(){r.apply(r,F(arguments))}),{def:r.def,entry:r,exit:a,save:t,set:function(e,a,n){t(e,a);r(e,a,"=",n,";")},toString:function(){return n()+i()}})}var r=0,a=[],n=[],i=e(),o={};return{global:i,link:function(e){for(var t=0;t<n.length;++t)if(n[t]===e)return a[t];t="g"+r++;a.push(t);n.push(e);return t},block:e,proc:function(e,r){function a(){var e="a"+n.length;n.push(e);return e}var n=[];r=r||0;for(var i=0;i<r;++i)a();var i=t(),s=i.toString;return o[e]=X(i,{arg:a,toString:function(){return B(["function(",n.join(),"){",s(),"}"])}})},scope:t,cond:function(){var e=B(arguments),r=t(),a=t(),n=r.toString,i=a.toString;return X(r,{then:function(){r.apply(r,F(arguments));return this},else:function(){a.apply(a,F(arguments));return this},toString:function(){var t=i();t&&(t="else{"+t+"}");return B(["if(",e,"){",n(),"}",t])}})},compile:function(){var e=['"use strict";',i,"return {"];Object.keys(o).forEach((function(t){e.push('"',t,'":',o[t].toString(),",")}));e.push("}");var t=B(e).replace(/;/g,";\n").replace(/}/g,"}\n").replace(/{/g,"{\n");return Function.apply(null,a.concat(t)).apply(null,n)}}}function j(e){return Array.isArray(e)||te(e)||v(e)}function U(e){return e.sort((function(e,t){return"viewport"===e?-1:"viewport"===t?1:e<t?-1:1}))}function V(e,t,r,a){this.thisDep=e;this.contextDep=t;this.propDep=r;this.append=a}function H(e){return e&&!(e.thisDep||e.contextDep||e.propDep)}function q(e){return new V(!1,!1,!1,e)}function G(e,t){var r=e.type;if(0===r)return r=e.data.length,new V(!0,1<=r,2<=r,t);if(4===r)return r=e.data,new V(r.thisDep,r.contextDep,r.propDep,t);if(5===r)return new V(!1,!1,!1,t);if(6===r){for(var a=r=!1,n=!1,i=0;i<e.data.length;++i){var o=e.data[i];1===o.type?n=!0:2===o.type?a=!0:3===o.type?r=!0:0===o.type?(r=!0,o=o.data,1<=o&&(a=!0),2<=o&&(n=!0)):4===o.type&&(r=r||o.data.thisDep,a=a||o.data.contextDep,n=n||o.data.propDep)}return new V(r,a,n,t)}return new V(3===r,2===r,1===r,t)}function Y(e,t,r,a,n,i,o,s,l,u,c,h,p,v,d){function m(e){return e.replace(".","_")}function g(e,t,r){var a=m(e);ve.push(e);pe[a]=he[a]=!!r;de[a]=t}function y(e,t,r){var a=m(e);ve.push(e);Array.isArray(r)?(he[a]=r.slice(),pe[a]=r.slice()):he[a]=pe[a]=r;me[a]=t}function x(){var e=N(),r=e.link,a=e.global;e.id=xe++;e.batchId="0";var n=r(ge),i=e.shared={props:"a0"};Object.keys(ge).forEach((function(e){i[e]=a.def(n,".",e)}));var o=e.next={},s=e.current={};Object.keys(me).forEach((function(e){Array.isArray(he[e])&&(o[e]=a.def(i.next,".",e),s[e]=a.def(i.current,".",e))}));var l=e.constants={};Object.keys(ye).forEach((function(e){l[e]=a.def(JSON.stringify(ye[e]))}));e.invoke=function(t,a){switch(a.type){case 0:var n=["this",i.context,i.props,e.batchId];return t.def(r(a.data),".call(",n.slice(0,Math.max(a.data.length+1,4)),")");case 1:return t.def(i.props,a.data);case 2:return t.def(i.context,a.data);case 3:return t.def("this",a.data);case 4:return a.data.append(e,t),a.data.ref;case 5:return a.data.toString();case 6:return a.data.map((function(r){return e.invoke(t,r)}))}};e.attribCache={};var c={};e.scopeAttrib=function(e){e=t.id(e);if(e in c)return c[e];var a=u.scope[e];a||(a=u.scope[e]=new oe);return c[e]=r(a)};return e}function b(e){var t=e["static"];e=e.dynamic;var r;if("profile"in t){var a=!!t.profile;r=q((function(e,t){return a}));r.enable=a}else if("profile"in e){var n=e.profile;r=G(n,(function(e,t){return e.invoke(t,n)}))}return r}function _(e,t){var r=e["static"],a=e.dynamic;if("framebuffer"in r){var n=r.framebuffer;return n?(n=s.getFramebuffer(n),q((function(e,t){var r=e.link(n),a=e.shared;t.set(a.framebuffer,".next",r);a=a.context;t.set(a,".framebufferWidth",r+".width");t.set(a,".framebufferHeight",r+".height");return r}))):q((function(e,t){var r=e.shared;t.set(r.framebuffer,".next","null");r=r.context;t.set(r,".framebufferWidth",r+".drawingBufferWidth");t.set(r,".framebufferHeight",r+".drawingBufferHeight");return"null"}))}if("framebuffer"in a){var i=a.framebuffer;return G(i,(function(e,t){var r=e.invoke(t,i),a=e.shared,n=a.framebuffer,r=t.def(n,".getFramebuffer(",r,")");t.set(n,".next",r);a=a.context;t.set(a,".framebufferWidth",r+"?"+r+".width:"+a+".drawingBufferWidth");t.set(a,".framebufferHeight",r+"?"+r+".height:"+a+".drawingBufferHeight");return r}))}return null}function w(e,t,r){function a(e){if(e in n){var r=n[e];e=!0;var a=r.x|0,o=r.y|0,s,l;"width"in r?s=r.width|0:e=!1;"height"in r?l=r.height|0:e=!1;return new V(!e&&t&&t.thisDep,!e&&t&&t.contextDep,!e&&t&&t.propDep,(function(e,t){var n=e.shared.context,i=s;"width"in r||(i=t.def(n,".","framebufferWidth","-",a));var u=l;"height"in r||(u=t.def(n,".","framebufferHeight","-",o));return[a,o,i,u]}))}if(e in i){var u=i[e];e=G(u,(function(e,t){var r=e.invoke(t,u),a=e.shared.context,n=t.def(r,".x|0"),i=t.def(r,".y|0"),o=t.def('"width" in ',r,"?",r,".width|0:","(",a,".","framebufferWidth","-",n,")"),r=t.def('"height" in ',r,"?",r,".height|0:","(",a,".","framebufferHeight","-",i,")");return[n,i,o,r]}));t&&(e.thisDep=e.thisDep||t.thisDep,e.contextDep=e.contextDep||t.contextDep,e.propDep=e.propDep||t.propDep);return e}return t?new V(t.thisDep,t.contextDep,t.propDep,(function(e,t){var r=e.shared.context;return[0,0,t.def(r,".","framebufferWidth"),t.def(r,".","framebufferHeight")]})):null}var n=e["static"],i=e.dynamic;if(e=a("viewport")){var o=e;e=new V(e.thisDep,e.contextDep,e.propDep,(function(e,t){var r=o.append(e,t),a=e.shared.context;t.set(a,".viewportWidth",r[2]);t.set(a,".viewportHeight",r[3]);return r}))}return{viewport:e,scissor_box:a("scissor.box")}}function k(e,t){var r=e["static"];if("string"===typeof r.frag&&"string"===typeof r.vert){if(0<Object.keys(t.dynamic).length)return null;var r=t["static"],a=Object.keys(r);if(0<a.length&&"number"===typeof r[a[0]]){for(var n=[],i=0;i<a.length;++i)n.push([r[a[i]]|0,a[i]]);return n}}return null}function M(e,r,a){function n(e){if(e in i){var r=t.id(i[e]);e=q((function(){return r}));e.id=r;return e}if(e in o){var a=o[e];return G(a,(function(e,t){var r=e.invoke(t,a);return t.def(e.shared.strings,".id(",r,")")}))}return null}var i=e["static"],o=e.dynamic,s=n("frag"),l=n("vert"),u=null;H(s)&&H(l)?(u=c.program(l.id,s.id,null,a),e=q((function(e,t){return e.link(u)}))):e=new V(s&&s.thisDep||l&&l.thisDep,s&&s.contextDep||l&&l.contextDep,s&&s.propDep||l&&l.propDep,(function(e,t){var r=e.shared.shader,a;a=s?s.append(e,t):t.def(r,".","frag");var n;n=l?l.append(e,t):t.def(r,".","vert");return t.def(r+".program("+n+","+a+")")}));return{frag:s,vert:l,progVar:e,program:u}}function A(e,t){function r(e,t){if(e in a){var r=a[e]|0;t?o.offset=r:o.instances=r;return q((function(e,a){t&&(e.OFFSET=r);return r}))}if(e in n){var i=n[e];return G(i,(function(e,r){var a=e.invoke(r,i);t&&(e.OFFSET=a);return a}))}if(t){if(c)return q((function(e,t){return e.OFFSET=0}));if(s)return new V(l.thisDep,l.contextDep,l.propDep,(function(e,t){return t.def(e.shared.vao+".currentVAO?"+e.shared.vao+".currentVAO.offset:0")}))}else if(s)return new V(l.thisDep,l.contextDep,l.propDep,(function(e,t){return t.def(e.shared.vao+".currentVAO?"+e.shared.vao+".currentVAO.instances:-1")}));return null}var a=e["static"],n=e.dynamic,o={},s=!1,l=function(){if("vao"in a){var e=a.vao;null!==e&&null===u.getVAO(e)&&(e=u.createVAO(e));s=!0;o.vao=e;return q((function(t){var r=u.getVAO(e);return r?t.link(r):"null"}))}if("vao"in n){s=!0;var t=n.vao;return G(t,(function(e,r){var a=e.invoke(r,t);return r.def(e.shared.vao+".getVAO("+a+")")}))}return null}(),c=!1,f=function(){if("elements"in a){var e=a.elements;o.elements=e;if(j(e)){var t=o.elements=i.create(e,!0),e=i.getElements(t);c=!0}else e&&(e=i.getElements(e),c=!0);t=q((function(t,r){if(e){var a=t.link(e);return t.ELEMENTS=a}return t.ELEMENTS=null}));t.value=e;return t}if("elements"in n){c=!0;var r=n.elements;return G(r,(function(e,t){var a=e.shared,n=a.isBufferArgs,a=a.elements,i=e.invoke(t,r),o=t.def("null"),n=t.def(n,"(",i,")"),i=e.cond(n).then(o,"=",a,".createStream(",i,");")["else"](o,"=",a,".getElements(",i,");");t.entry(i);t.exit(e.cond(n).then(a,".destroyStream(",o,");"));return e.ELEMENTS=o}))}return s?new V(l.thisDep,l.contextDep,l.propDep,(function(e,t){return t.def(e.shared.vao+".currentVAO?"+e.shared.elements+".getElements("+e.shared.vao+".currentVAO.elements):null")})):null}(),h=r("offset",!0),p=function(){if("primitive"in a){var e=a.primitive;o.primitive=e;return q((function(t,r){return ce[e]}))}if("primitive"in n){var t=n.primitive;return G(t,(function(e,r){var a=e.constants.primTypes,n=e.invoke(r,t);return r.def(a,"[",n,"]")}))}return c?H(f)?f.value?q((function(e,t){return t.def(e.ELEMENTS,".primType")})):q((function(){return 4})):new V(f.thisDep,f.contextDep,f.propDep,(function(e,t){var r=e.ELEMENTS;return t.def(r,"?",r,".primType:",4)})):s?new V(l.thisDep,l.contextDep,l.propDep,(function(e,t){return t.def(e.shared.vao+".currentVAO?"+e.shared.vao+".currentVAO.primitive:4")})):null}(),v=function(){if("count"in a){var e=a.count|0;o.count=e;return q((function(){return e}))}if("count"in n){var t=n.count;return G(t,(function(e,r){return e.invoke(r,t)}))}return c?H(f)?f?h?new V(h.thisDep,h.contextDep,h.propDep,(function(e,t){return t.def(e.ELEMENTS,".vertCount-",e.OFFSET)})):q((function(e,t){return t.def(e.ELEMENTS,".vertCount")})):q((function(){return-1})):new V(f.thisDep||h.thisDep,f.contextDep||h.contextDep,f.propDep||h.propDep,(function(e,t){var r=e.ELEMENTS;return e.OFFSET?t.def(r,"?",r,".vertCount-",e.OFFSET,":-1"):t.def(r,"?",r,".vertCount:-1")})):s?new V(l.thisDep,l.contextDep,l.propDep,(function(e,t){return t.def(e.shared.vao,".currentVAO?",e.shared.vao,".currentVAO.count:-1")})):null}(),d=r("instances",!1);return{elements:f,primitive:p,count:v,instances:d,offset:h,vao:l,vaoActive:s,elementsActive:c,static:o}}function S(e,t){var r=e["static"],a=e.dynamic,n={};ve.forEach((function(e){function t(t,o){if(e in r){var s=t(r[e]);n[i]=q((function(){return s}))}else if(e in a){var l=a[e];n[i]=G(l,(function(e,t){return o(e,t,e.invoke(t,l))}))}}var i=m(e);switch(e){case"cull.enable":case"blend.enable":case"dither":case"stencil.enable":case"depth.enable":case"scissor.enable":case"polygonOffset.enable":case"sample.alpha":case"sample.enable":case"depth.mask":return t((function(e){return e}),(function(e,t,r){return r}));case"depth.func":return t((function(e){return Pe[e]}),(function(e,t,r){return t.def(e.constants.compareFuncs,"[",r,"]")}));case"depth.range":return t((function(e){return e}),(function(e,t,r){e=t.def("+",r,"[0]");t=t.def("+",r,"[1]");return[e,t]}));case"blend.func":return t((function(e){return[Ie["srcRGB"in e?e.srcRGB:e.src],Ie["dstRGB"in e?e.dstRGB:e.dst],Ie["srcAlpha"in e?e.srcAlpha:e.src],Ie["dstAlpha"in e?e.dstAlpha:e.dst]]}),(function(e,t,r){function a(e,a){return t.def('"',e,a,'" in ',r,"?",r,".",e,a,":",r,".",e)}e=e.constants.blendFuncs;var n=a("src","RGB"),i=a("dst","RGB"),n=t.def(e,"[",n,"]"),o=t.def(e,"[",a("src","Alpha"),"]"),i=t.def(e,"[",i,"]");e=t.def(e,"[",a("dst","Alpha"),"]");return[n,i,o,e]}));case"blend.equation":return t((function(e){if("string"===typeof e)return[se[e],se[e]];if("object"===typeof e)return[se[e.rgb],se[e.alpha]]}),(function(e,t,r){var a=e.constants.blendEquations,n=t.def(),i=t.def();e=e.cond("typeof ",r,'==="string"');e.then(n,"=",i,"=",a,"[",r,"];");e["else"](n,"=",a,"[",r,".rgb];",i,"=",a,"[",r,".alpha];");t(e);return[n,i]}));case"blend.color":return t((function(e){return f(4,(function(t){return+e[t]}))}),(function(e,t,r){return f(4,(function(e){return t.def("+",r,"[",e,"]")}))}));case"stencil.mask":return t((function(e){return e|0}),(function(e,t,r){return t.def(r,"|0")}));case"stencil.func":return t((function(e){return[Pe[e.cmp||"keep"],e.ref||0,"mask"in e?e.mask:-1]}),(function(e,t,r){e=t.def('"cmp" in ',r,"?",e.constants.compareFuncs,"[",r,".cmp]",":",7680);var a=t.def(r,".ref|0");t=t.def('"mask" in ',r,"?",r,".mask|0:-1");return[e,a,t]}));case"stencil.opFront":case"stencil.opBack":return t((function(t){return["stencil.opBack"===e?1029:1028,Oe[t.fail||"keep"],Oe[t.zfail||"keep"],Oe[t.zpass||"keep"]]}),(function(t,r,a){function n(e){return r.def('"',e,'" in ',a,"?",i,"[",a,".",e,"]:",7680)}var i=t.constants.stencilOps;return["stencil.opBack"===e?1029:1028,n("fail"),n("zfail"),n("zpass")]}));case"polygonOffset.offset":return t((function(e){return[e.factor|0,e.units|0]}),(function(e,t,r){e=t.def(r,".factor|0");t=t.def(r,".units|0");return[e,t]}));case"cull.face":return t((function(e){var t=0;"front"===e?t=1028:"back"===e&&(t=1029);return t}),(function(e,t,r){return t.def(r,'==="front"?',1028,":",1029)}));case"lineWidth":return t((function(e){return e}),(function(e,t,r){return r}));case"frontFace":return t((function(e){return ze[e]}),(function(e,t,r){return t.def(r+'==="cw"?2304:2305')}));case"colorMask":return t((function(e){return e.map((function(e){return!!e}))}),(function(e,t,r){return f(4,(function(e){return"!!"+r+"["+e+"]"}))}));case"sample.coverage":return t((function(e){return["value"in e?e.value:1,!!e.invert]}),(function(e,t,r){e=t.def('"value" in ',r,"?+",r,".value:1");t=t.def("!!",r,".invert");return[e,t]}))}}));return n}function E(e,t){var r=e["static"],a=e.dynamic,n={};Object.keys(r).forEach((function(e){var t=r[e],a;if("number"===typeof t||"boolean"===typeof t)a=q((function(){return t}));else if("function"===typeof t){var i=t._reglType;if("texture2d"===i||"textureCube"===i)a=q((function(e){return e.link(t)}));else if("framebuffer"===i||"framebufferCube"===i)a=q((function(e){return e.link(t.color[0])}))}else T(t)&&(a=q((function(e){return e.global.def("[",f(t.length,(function(e){return t[e]})),"]")})));a.value=t;n[e]=a}));Object.keys(a).forEach((function(e){var t=a[e];n[e]=G(t,(function(e,r){return e.invoke(r,t)}))}));return n}function L(e,r){var a=e["static"],i=e.dynamic,o={};Object.keys(a).forEach((function(e){var r=a[e],i=t.id(e),s=new oe;if(j(r))s.state=1,s.buffer=n.getBuffer(n.create(r,34962,!1,!0)),s.type=0;else{var l=n.getBuffer(r);if(l)s.state=1,s.buffer=l,s.type=0;else if("constant"in r){var u=r.constant;s.buffer="null";s.state=2;"number"===typeof u?s.x=u:Le.forEach((function(e,t){t<u.length&&(s[e]=u[t])}))}else{var l=j(r.buffer)?n.getBuffer(n.create(r.buffer,34962,!1,!0)):n.getBuffer(r.buffer),c=r.offset|0,f=r.stride|0,h=r.size|0,p=!!r.normalized,v=0;"type"in r&&(v=ie[r.type]);r=r.divisor|0;s.buffer=l;s.state=1;s.size=h;s.normalized=p;s.type=v||l.dtype;s.offset=c;s.stride=f;s.divisor=r}}o[e]=q((function(e,t){var r=e.attribCache;if(i in r)return r[i];var a={isStream:!1};Object.keys(s).forEach((function(e){a[e]=s[e]}));s.buffer&&(a.buffer=e.link(s.buffer),a.type=a.type||a.buffer+".dtype");return r[i]=a}))}));Object.keys(i).forEach((function(e){var t=i[e];o[e]=G(t,(function(e,r){function a(e){r(l[e],"=",n,".",e,"|0;")}var n=e.invoke(r,t),i=e.shared,o=e.constants,s=i.isBufferArgs,i=i.buffer,l={isStream:r.def(!1)},u=new oe;u.state=1;Object.keys(u).forEach((function(e){l[e]=r.def(""+u[e])}));var c=l.buffer,f=l.type;r("if(",s,"(",n,")){",l.isStream,"=true;",c,"=",i,".createStream(",34962,",",n,");",f,"=",c,".dtype;","}else{",c,"=",i,".getBuffer(",n,");","if(",c,"){",f,"=",c,".dtype;",'}else if("constant" in ',n,"){",l.state,"=",2,";","if(typeof "+n+'.constant === "number"){',l[Le[0]],"=",n,".constant;",Le.slice(1).map((function(e){return l[e]})).join("="),"=0;","}else{",Le.map((function(e,t){return l[e]+"="+n+".constant.length>"+t+"?"+n+".constant["+t+"]:0;"})).join(""),"}}else{","if(",s,"(",n,".buffer)){",c,"=",i,".createStream(",34962,",",n,".buffer);","}else{",c,"=",i,".getBuffer(",n,".buffer);","}",f,'="type" in ',n,"?",o.glTypes,"[",n,".type]:",c,".dtype;",l.normalized,"=!!",n,".normalized;");a("size");a("offset");a("stride");a("divisor");r("}}");r.exit("if(",l.isStream,"){",i,".destroyStream(",c,");","}");return l}))}));return o}function C(e){var t=e["static"],r=e.dynamic,a={};Object.keys(t).forEach((function(e){var r=t[e];a[e]=q((function(e,t){return"number"===typeof r||"boolean"===typeof r?""+r:e.link(r)}))}));Object.keys(r).forEach((function(e){var t=r[e];a[e]=G(t,(function(e,r){return e.invoke(r,t)}))}));return a}function I(e,t,a,n,i){function o(e){var t=c[e];t&&(h[e]=t)}var s=k(e,t),l=_(e,i),c=w(e,l,i),f=A(e,i),h=S(e,i),p=M(e,i,s);o("viewport");o(m("scissor.box"));var v=0<Object.keys(h).length,l={framebuffer:l,draw:f,shader:p,state:h,dirty:v,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};l.profile=b(e,i);l.uniforms=E(a,i);l.drawVAO=l.scopeVAO=f.vao;if(!l.drawVAO&&p.program&&!s&&r.angle_instanced_arrays&&f["static"].elements){var d=!0;e=p.program.attributes.map((function(e){e=t["static"][e];d=d&&!!e;return e}));if(d&&0<e.length){var g=u.getVAO(u.createVAO({attributes:e,elements:f["static"].elements}));l.drawVAO=new V(null,null,null,(function(e,t){return e.link(g)}));l.useVAO=!0}}s?l.useVAO=!0:l.attributes=L(t,i);l.context=C(n,i);return l}function P(e,t,r){var a=e.shared.context,n=e.scope();Object.keys(r).forEach((function(i){t.save(a,"."+i);var o=r[i].append(e,t);Array.isArray(o)?n(a,".",i,"=[",o.join(),"];"):n(a,".",i,"=",o,";")}));t(n)}function O(e,t,r,a){var n=e.shared,i=n.gl,o=n.framebuffer,s;ue&&(s=t.def(n.extensions,".webgl_draw_buffers"));var l=e.constants,n=l.drawBuffer,l=l.backBuffer;e=r?r.append(e,t):t.def(o,".next");a||t("if(",e,"!==",o,".cur){");t("if(",e,"){",i,".bindFramebuffer(",36160,",",e,".framebuffer);");ue&&t(s,".drawBuffersWEBGL(",n,"[",e,".colorAttachments.length]);");t("}else{",i,".bindFramebuffer(",36160,",null);");ue&&t(s,".drawBuffersWEBGL(",l,");");t("}",o,".cur=",e,";");a||t("}")}function z(e,t,r){var a=e.shared,n=a.gl,i=e.current,o=e.next,s=a.current,l=a.next,u=e.cond(s,".dirty");ve.forEach((function(t){t=m(t);if(!(t in r.state)){var a,c;if(t in o){a=o[t];c=i[t];var h=f(he[t].length,(function(e){return u.def(a,"[",e,"]")}));u(e.cond(h.map((function(e,t){return e+"!=="+c+"["+t+"]"})).join("||")).then(n,".",me[t],"(",h,");",h.map((function(e,t){return c+"["+t+"]="+e})).join(";"),";"))}else a=u.def(l,".",t),h=e.cond(a,"!==",s,".",t),u(h),t in de?h(e.cond(a).then(n,".enable(",de[t],");")["else"](n,".disable(",de[t],");"),s,".",t,"=",a,";"):h(n,".",me[t],"(",a,");",s,".",t,"=",a,";")}}));0===Object.keys(r.state).length&&u(s,".dirty=false;");t(u)}function D(e,t,r,a){var n=e.shared,i=e.current,o=n.current,s=n.gl;U(Object.keys(r)).forEach((function(n){var l=r[n];if(!a||a(l)){var u=l.append(e,t);if(de[n]){var c=de[n];H(l)?u?t(s,".enable(",c,");"):t(s,".disable(",c,");"):t(e.cond(u).then(s,".enable(",c,");")["else"](s,".disable(",c,");"));t(o,".",n,"=",u,";")}else if(T(u)){var f=i[n];t(s,".",me[n],"(",u,");",u.map((function(e,t){return f+"["+t+"]="+e})).join(";"),";")}else t(s,".",me[n],"(",u,");",o,".",n,"=",u,";")}}))}function R(e,t){le&&(e.instancing=t.def(e.shared.extensions,".angle_instanced_arrays"))}function F(e,t,r,a,n){function i(){return"undefined"===typeof performance?"Date.now()":"performance.now()"}function o(e){p=t.def();e(p,"=",i(),";");"string"===typeof n?e(c,".count+=",n,";"):e(c,".count++;");v&&(a?(d=t.def(),e(d,"=",h,".getNumPendingQueries();")):e(h,".beginQuery(",c,");"))}function s(e){e(c,".cpuTime+=",i(),"-",p,";");v&&(a?e(h,".pushScopeStats(",d,",",h,".getNumPendingQueries(),",c,");"):e(h,".endQuery();"))}function l(e){var r=t.def(f,".profile");t(f,".profile=",e,";");t.exit(f,".profile=",r,";")}var u=e.shared,c=e.stats,f=u.current,h=u.timer;r=r.profile;var p,d;if(r){if(H(r)){r.enable?(o(t),s(t.exit),l("true")):l("false");return}r=r.append(e,t);l(r)}else r=t.def(f,".profile");u=e.block();o(u);t("if(",r,"){",u,"}");e=e.block();s(e);t.exit("if(",r,"){",e,"}")}function B(e,t,r,a,n){function i(e){switch(e){case 35664:case 35667:case 35671:return 2;case 35665:case 35668:case 35672:return 3;case 35666:case 35669:case 35673:return 4;default:return 1}}function o(r,a,n){function i(){t("if(!",c,".buffer){",l,".enableVertexAttribArray(",u,");}");var r=n.type,i;i=n.size?t.def(n.size,"||",a):a;t("if(",c,".type!==",r,"||",c,".size!==",i,"||",p.map((function(e){return c+"."+e+"!=="+n[e]})).join("||"),"){",l,".bindBuffer(",34962,",",f,".buffer);",l,".vertexAttribPointer(",[u,i,r,n.normalized,n.stride,n.offset],");",c,".type=",r,";",c,".size=",i,";",p.map((function(e){return c+"."+e+"="+n[e]+";"})).join(""),"}");le&&(r=n.divisor,t("if(",c,".divisor!==",r,"){",e.instancing,".vertexAttribDivisorANGLE(",[u,r],");",c,".divisor=",r,";}"))}function o(){t("if(",c,".buffer){",l,".disableVertexAttribArray(",u,");",c,".buffer=null;","}if(",Le.map((function(e,t){return c+"."+e+"!=="+h[t]})).join("||"),"){",l,".vertexAttrib4f(",u,",",h,");",Le.map((function(e,t){return c+"."+e+"="+h[t]+";"})).join(""),"}")}var l=s.gl,u=t.def(r,".location"),c=t.def(s.attributes,"[",u,"]");r=n.state;var f=n.buffer,h=[n.x,n.y,n.z,n.w],p=["buffer","normalized","offset","stride"];1===r?i():2===r?o():(t("if(",r,"===",1,"){"),i(),t("}else{"),o(),t("}"))}var s=e.shared;a.forEach((function(a){var s=a.name,l=r.attributes[s],u;if(l){if(!n(l))return;u=l.append(e,t)}else{if(!n(De))return;var c=e.scopeAttrib(s);u={};Object.keys(new oe).forEach((function(e){u[e]=t.def(c,".",e)}))}o(e.link(a),i(a.info.type),u)}))}function Y(e,r,a,n,i,o){for(var s=e.shared,l=s.gl,u={},c,h=0;h<n.length;++h){var p=n[h],v=p.name,d=p.info.type,m=p.info.size,g=a.uniforms[v];if(1<m){if(!g)continue;var y=v.replace("[0]","");if(u[y])continue;u[y]=1}var p=e.link(p)+".location",x;if(g){if(!i(g))continue;if(H(g)){v=g.value;if(35678===d||35680===d)d=e.link(v._texture||v.color[0]._texture),r(l,".uniform1i(",p,",",d+".bind());"),r.exit(d,".unbind();");else if(35674===d||35675===d||35676===d)m=e.global.def("new Float32Array(["+Array.prototype.slice.call(v)+"])"),v=2,35675===d?v=3:35676===d&&(v=4),r(l,".uniformMatrix",v,"fv(",p,",false,",m,");");else{switch(d){case 5126:c="1f";break;case 35664:c="2f";break;case 35665:c="3f";break;case 35666:c="4f";break;case 35670:c="1i";break;case 5124:c="1i";break;case 35671:c="2i";break;case 35667:c="2i";break;case 35672:c="3i";break;case 35668:c="3i";break;case 35673:c="4i";break;case 35669:c="4i"}1<m?(c+="v",v=e.global.def("["+Array.prototype.slice.call(v)+"]")):v=T(v)?Array.prototype.slice.call(v):v;r(l,".uniform",c,"(",p,",",v,");")}continue}else x=g.append(e,r)}else{if(!i(De))continue;x=r.def(s.uniforms,"[",t.id(v),"]")}35678===d?r("if(",x,"&&",x,'._reglType==="framebuffer"){',x,"=",x,".color[0];","}"):35680===d&&r("if(",x,"&&",x,'._reglType==="framebufferCube"){',x,"=",x,".color[0];","}");v=1;switch(d){case 35678:case 35680:d=r.def(x,"._texture");r(l,".uniform1i(",p,",",d,".bind());");r.exit(d,".unbind();");continue;case 5124:case 35670:c="1i";break;case 35667:case 35671:c="2i";v=2;break;case 35668:case 35672:c="3i";v=3;break;case 35669:case 35673:c="4i";v=4;break;case 5126:c="1f";break;case 35664:c="2f";v=2;break;case 35665:c="3f";v=3;break;case 35666:c="4f";v=4;break;case 35674:c="Matrix2fv";break;case 35675:c="Matrix3fv";break;case 35676:c="Matrix4fv"}-1===c.indexOf("Matrix")&&1<m&&(c+="v",v=1);if("M"===c.charAt(0)){r(l,".uniform",c,"(",p,",");var p=Math.pow(d-35674+2,2),b=e.global.def("new Float32Array(",p,")");Array.isArray(x)?r("false,(",f(p,(function(e){return b+"["+e+"]="+x[e]})),",",b,")"):r("false,(Array.isArray(",x,")||",x," instanceof Float32Array)?",x,":(",f(p,(function(e){return b+"["+e+"]="+x+"["+e+"]"})),",",b,")");r(");")}else{if(1<v){for(var d=[],_=[],m=0;m<v;++m)Array.isArray(x)?_.push(x[m]):_.push(r.def(x+"["+m+"]")),o&&d.push(r.def());o&&r("if(!",e.batchId,"||",d.map((function(e,t){return e+"!=="+_[t]})).join("||"),"){",d.map((function(e,t){return e+"="+_[t]+";"})).join(""));r(l,".uniform",c,"(",p,",",_.join(","),");")}else o&&(d=r.def(),r("if(!",e.batchId,"||",d,"!==",x,"){",d,"=",x,";")),r(l,".uniform",c,"(",p,",",x,");");o&&r("}")}}}function W(e,t,r,a){function n(n){var i=c[n];return i?i.contextDep&&a.contextDynamic||i.propDep?i.append(e,r):i.append(e,t):t.def(u,".",n)}function i(){function e(){r(m,".drawElementsInstancedANGLE(",[h,v,g,p+"<<(("+g+"-5121)>>1)",d],");")}function t(){r(m,".drawArraysInstancedANGLE(",[h,p,v,d],");")}f&&"null"!==f?y?e():(r("if(",f,"){"),e(),r("}else{"),t(),r("}")):t()}function o(){function e(){r(l+".drawElements("+[h,v,g,p+"<<(("+g+"-5121)>>1)"]+");")}function t(){r(l+".drawArrays("+[h,p,v]+");")}f&&"null"!==f?y?e():(r("if(",f,"){"),e(),r("}else{"),t(),r("}")):t()}var s=e.shared,l=s.gl,u=s.draw,c=a.draw,f=function(){var n=c.elements,i=t;if(n){if(n.contextDep&&a.contextDynamic||n.propDep)i=r;n=n.append(e,i);c.elementsActive&&i("if("+n+")"+l+".bindBuffer(34963,"+n+".buffer.buffer);")}else n=i.def(),i(n,"=",u,".","elements",";","if(",n,"){",l,".bindBuffer(",34963,",",n,".buffer.buffer);}","else if(",s.vao,".currentVAO){",n,"=",e.shared.elements+".getElements("+s.vao,".currentVAO.elements);",fe?"":"if("+n+")"+l+".bindBuffer(34963,"+n+".buffer.buffer);","}");return n}(),h=n("primitive"),p=n("offset"),v=function(){var n=c.count,i=t;if(n){if(n.contextDep&&a.contextDynamic||n.propDep)i=r;n=n.append(e,i)}else n=i.def(u,".","count");return n}();if("number"===typeof v){if(0===v)return}else r("if(",v,"){"),r.exit("}");var d,m;le&&(d=n("instances"),m=e.instancing);var g=f+".type",y=c.elements&&H(c.elements)&&!c.vaoActive;le&&("number"!==typeof d||0<=d)?"string"===typeof d?(r("if(",d,">0){"),i(),r("}else if(",d,"<0){"),o(),r("}")):i():o()}function Z(e,t,r,a,n){t=x();n=t.proc("body",n);le&&(t.instancing=n.def(t.shared.extensions,".angle_instanced_arrays"));e(t,n,r,a);return t.compile().body}function K(e,t,r,a){R(e,t);r.useVAO?r.drawVAO?t(e.shared.vao,".setVAO(",r.drawVAO.append(e,t),");"):t(e.shared.vao,".setVAO(",e.shared.vao,".targetVAO);"):(t(e.shared.vao,".setVAO(null);"),B(e,t,r,a.attributes,(function(){return!0})));Y(e,t,r,a.uniforms,(function(){return!0}),!1);W(e,t,t,r)}function Q(e,t){var r=e.proc("draw",1);R(e,r);P(e,r,t.context);O(e,r,t.framebuffer);z(e,r,t);D(e,r,t.state);F(e,r,t,!1,!0);var a=t.shader.progVar.append(e,r);r(e.shared.gl,".useProgram(",a,".program);");if(t.shader.program)K(e,r,t,t.shader.program);else{r(e.shared.vao,".setVAO(null);");var n=e.global.def("{}"),i=r.def(a,".id"),o=r.def(n,"[",i,"]");r(e.cond(o).then(o,".call(this,a0);")["else"](o,"=",n,"[",i,"]=",e.link((function(r){return Z(K,e,t,r,1)})),"(",a,");",o,".call(this,a0);"))}0<Object.keys(t.state).length&&r(e.shared.current,".dirty=true;");e.shared.vao&&r(e.shared.vao,".setVAO(null);")}function $(e,t,r,a){function n(){return!0}e.batchId="a1";R(e,t);B(e,t,r,a.attributes,n);Y(e,t,r,a.uniforms,n,!1);W(e,t,t,r)}function ee(e,t,r,a){function n(e){return e.contextDep&&o||e.propDep}function i(e){return!n(e)}R(e,t);var o=r.contextDep,s=t.def(),l=t.def();e.shared.props=l;e.batchId=s;var u=e.scope(),c=e.scope();t(u.entry,"for(",s,"=0;",s,"<","a1",";++",s,"){",l,"=","a0","[",s,"];",c,"}",u.exit);r.needsContext&&P(e,c,r.context);r.needsFramebuffer&&O(e,c,r.framebuffer);D(e,c,r.state,n);r.profile&&n(r.profile)&&F(e,c,r,!1,!0);a?(r.useVAO?r.drawVAO?n(r.drawVAO)?c(e.shared.vao,".setVAO(",r.drawVAO.append(e,c),");"):u(e.shared.vao,".setVAO(",r.drawVAO.append(e,u),");"):u(e.shared.vao,".setVAO(",e.shared.vao,".targetVAO);"):(u(e.shared.vao,".setVAO(null);"),B(e,u,r,a.attributes,i),B(e,c,r,a.attributes,n)),Y(e,u,r,a.uniforms,i,!1),Y(e,c,r,a.uniforms,n,!0),W(e,u,c,r)):(t=e.global.def("{}"),a=r.shader.progVar.append(e,c),l=c.def(a,".id"),u=c.def(t,"[",l,"]"),c(e.shared.gl,".useProgram(",a,".program);","if(!",u,"){",u,"=",t,"[",l,"]=",e.link((function(t){return Z($,e,r,t,2)})),"(",a,");}",u,".call(this,a0[",s,"],",s,");"))}function te(e,t){function r(e){return e.contextDep&&n||e.propDep}var a=e.proc("batch",2);e.batchId="0";R(e,a);var n=!1,i=!0;Object.keys(t.context).forEach((function(e){n=n||t.context[e].propDep}));n||(P(e,a,t.context),i=!1);var o=t.framebuffer,s=!1;o?(o.propDep?n=s=!0:o.contextDep&&n&&(s=!0),s||O(e,a,o)):O(e,a,null);t.state.viewport&&t.state.viewport.propDep&&(n=!0);z(e,a,t);D(e,a,t.state,(function(e){return!r(e)}));t.profile&&r(t.profile)||F(e,a,t,!1,"a1");t.contextDep=n;t.needsContext=i;t.needsFramebuffer=s;i=t.shader.progVar;if(i.contextDep&&n||i.propDep)ee(e,a,t,null);else if(i=i.append(e,a),a(e.shared.gl,".useProgram(",i,".program);"),t.shader.program)ee(e,a,t,t.shader.program);else{a(e.shared.vao,".setVAO(null);");var o=e.global.def("{}"),s=a.def(i,".id"),l=a.def(o,"[",s,"]");a(e.cond(l).then(l,".call(this,a0,a1);")["else"](l,"=",o,"[",s,"]=",e.link((function(r){return Z(ee,e,t,r,2)})),"(",i,");",l,".call(this,a0,a1);"))}0<Object.keys(t.state).length&&a(e.shared.current,".dirty=true;");e.shared.vao&&a(e.shared.vao,".setVAO(null);")}function re(e,r){function a(t){var a=r.shader[t];a&&n.set(i.shader,"."+t,a.append(e,n))}var n=e.proc("scope",3);e.batchId="a2";var i=e.shared,o=i.current;P(e,n,r.context);r.framebuffer&&r.framebuffer.append(e,n);U(Object.keys(r.state)).forEach((function(t){var a=r.state[t].append(e,n);T(a)?a.forEach((function(r,a){n.set(e.next[t],"["+a+"]",r)})):n.set(i.next,"."+t,a)}));F(e,n,r,!0,!0);["elements","offset","count","instances","primitive"].forEach((function(t){var a=r.draw[t];a&&n.set(i.draw,"."+t,""+a.append(e,n))}));Object.keys(r.uniforms).forEach((function(a){var o=r.uniforms[a].append(e,n);Array.isArray(o)&&(o="["+o.join()+"]");n.set(i.uniforms,"["+t.id(a)+"]",o)}));Object.keys(r.attributes).forEach((function(t){var a=r.attributes[t].append(e,n),i=e.scopeAttrib(t);Object.keys(new oe).forEach((function(e){n.set(i,"."+e,a[e])}))}));r.scopeVAO&&n.set(i.vao,".targetVAO",r.scopeVAO.append(e,n));a("vert");a("frag");0<Object.keys(r.state).length&&(n(o,".dirty=true;"),n.exit(o,".dirty=true;"));n("a1(",e.shared.context,",a0,",e.batchId,");")}function ae(e){if("object"===typeof e&&!T(e)){for(var t=Object.keys(e),r=0;r<t.length;++r)if(J.isDynamic(e[t[r]]))return!0;return!1}}function ne(e,t,r){function a(e,t){o.forEach((function(r){var a=n[r];J.isDynamic(a)&&(a=e.invoke(t,a),t(c,".",r,"=",a,";"))}))}var n=t["static"][r];if(n&&ae(n)){var i=e.global,o=Object.keys(n),s=!1,l=!1,u=!1,c=e.global.def("{}");o.forEach((function(t){var r=n[t];if(J.isDynamic(r))"function"===typeof r&&(r=n[t]=J.unbox(r)),t=G(r,null),s=s||t.thisDep,u=u||t.propDep,l=l||t.contextDep;else{i(c,".",t,"=");switch(typeof r){case"number":i(r);break;case"string":i('"',r,'"');break;case"object":Array.isArray(r)&&i("[",r.join(),"]");break;default:i(e.link(r))}i(";")}}));t.dynamic[r]=new J.DynamicVariable(4,{thisDep:s,contextDep:l,propDep:u,ref:c,append:a});delete t["static"][r]}}var oe=u.Record,se={add:32774,subtract:32778,"reverse subtract":32779};r.ext_blend_minmax&&(se.min=32775,se.max=32776);var le=r.angle_instanced_arrays,ue=r.webgl_draw_buffers,fe=r.oes_vertex_array_object,he={dirty:!0,profile:d.profile},pe={},ve=[],de={},me={};g("dither",3024);g("blend.enable",3042);y("blend.color","blendColor",[0,0,0,0]);y("blend.equation","blendEquationSeparate",[32774,32774]);y("blend.func","blendFuncSeparate",[1,0,1,0]);g("depth.enable",2929,!0);y("depth.func","depthFunc",513);y("depth.range","depthRange",[0,1]);y("depth.mask","depthMask",!0);y("colorMask","colorMask",[!0,!0,!0,!0]);g("cull.enable",2884);y("cull.face","cullFace",1029);y("frontFace","frontFace",2305);y("lineWidth","lineWidth",1);g("polygonOffset.enable",32823);y("polygonOffset.offset","polygonOffset",[0,0]);g("sample.alpha",32926);g("sample.enable",32928);y("sample.coverage","sampleCoverage",[1,!1]);g("stencil.enable",2960);y("stencil.mask","stencilMask",-1);y("stencil.func","stencilFunc",[519,0,-1]);y("stencil.opFront","stencilOpSeparate",[1028,7680,7680,7680]);y("stencil.opBack","stencilOpSeparate",[1029,7680,7680,7680]);g("scissor.enable",3089);y("scissor.box","scissor",[0,0,e.drawingBufferWidth,e.drawingBufferHeight]);y("viewport","viewport",[0,0,e.drawingBufferWidth,e.drawingBufferHeight]);var ge={gl:e,context:p,strings:t,next:pe,current:he,draw:h,elements:i,buffer:n,shader:c,attributes:u.state,vao:u,uniforms:l,framebuffer:s,extensions:r,timer:v,isBufferArgs:j},ye={primTypes:ce,compareFuncs:Pe,blendFuncs:Ie,blendEquations:se,stencilOps:Oe,glTypes:ie,orientationType:ze};ue&&(ye.backBuffer=[1029],ye.drawBuffer=f(a.maxDrawbuffers,(function(e){return 0===e?[0]:f(e,(function(e){return 36064+e}))})));var xe=0;return{next:pe,current:he,procs:function(){var e=x(),t=e.proc("poll"),n=e.proc("refresh"),i=e.block();t(i);n(i);var o=e.shared,s=o.gl,l=o.next,u=o.current;i(u,".dirty=false;");O(e,t);O(e,n,null,!0);var c;le&&(c=e.link(le));r.oes_vertex_array_object&&n(e.link(r.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var h=0;h<a.maxAttributes;++h){var p=n.def(o.attributes,"[",h,"]"),v=e.cond(p,".buffer");v.then(s,".enableVertexAttribArray(",h,");",s,".bindBuffer(",34962,",",p,".buffer.buffer);",s,".vertexAttribPointer(",h,",",p,".size,",p,".type,",p,".normalized,",p,".stride,",p,".offset);")["else"](s,".disableVertexAttribArray(",h,");",s,".vertexAttrib4f(",h,",",p,".x,",p,".y,",p,".z,",p,".w);",p,".buffer=null;");n(v);le&&n(c,".vertexAttribDivisorANGLE(",h,",",p,".divisor);")}n(e.shared.vao,".currentVAO=null;",e.shared.vao,".setVAO(",e.shared.vao,".targetVAO);");Object.keys(de).forEach((function(r){var a=de[r],o=i.def(l,".",r),c=e.block();c("if(",o,"){",s,".enable(",a,")}else{",s,".disable(",a,")}",u,".",r,"=",o,";");n(c);t("if(",o,"!==",u,".",r,"){",c,"}")}));Object.keys(me).forEach((function(r){var a=me[r],o=he[r],c,h,p=e.block();p(s,".",a,"(");T(o)?(a=o.length,c=e.global.def(l,".",r),h=e.global.def(u,".",r),p(f(a,(function(e){return c+"["+e+"]"})),");",f(a,(function(e){return h+"["+e+"]="+c+"["+e+"];"})).join("")),t("if(",f(a,(function(e){return c+"["+e+"]!=="+h+"["+e+"]"})).join("||"),"){",p,"}")):(c=i.def(l,".",r),h=i.def(u,".",r),p(c,");",u,".",r,"=",c,";"),t("if(",c,"!==",h,"){",p,"}"));n(p)}));return e.compile()}(),compile:function(e,t,r,a,n){var i=x();i.stats=i.link(n);Object.keys(t["static"]).forEach((function(e){ne(i,t,e)}));Ce.forEach((function(t){ne(i,e,t)}));var o=I(e,t,r,a,i);Q(i,o);re(i,o);te(i,o);return X(i.compile(),{destroy:function(){o.shader.program.destroy()}})}}}function W(e,t){for(var r=0;r<e.length;++r)if(e[r]===t)return r;return-1}var X=function(e,t){for(var r=Object.keys(t),a=0;a<r.length;++a)e[r[a]]=t[r[a]];return e},Z=0,J={DynamicVariable:e,define:function(t,a){return new e(t,r(a+""))},isDynamic:function(t){return"function"===typeof t&&!t._reglType||t instanceof e},unbox:a,accessor:r},K={next:"function"===typeof requestAnimationFrame?function(e){return requestAnimationFrame(e)}:function(e){return setTimeout(e,16)},cancel:"function"===typeof cancelAnimationFrame?function(e){return cancelAnimationFrame(e)}:clearTimeout},Q="undefined"!==typeof performance&&performance.now?function(){return performance.now()}:function(){return+new Date},$=p();$.zero=p();var ee=function(e,t){var r=1;t.ext_texture_filter_anisotropic&&(r=e.getParameter(34047));var a=1,n=1;t.webgl_draw_buffers&&(a=e.getParameter(34852),n=e.getParameter(36063));var i=!!t.oes_texture_float;if(i){i=e.createTexture();e.bindTexture(3553,i);e.texImage2D(3553,0,6408,1,1,0,6408,5126,null);var o=e.createFramebuffer();e.bindFramebuffer(36160,o);e.framebufferTexture2D(36160,36064,3553,i,0);e.bindTexture(3553,null);if(36053!==e.checkFramebufferStatus(36160))i=!1;else{e.viewport(0,0,1,1);e.clearColor(1,0,0,1);e.clear(16384);var s=$.allocType(5126,4);e.readPixels(0,0,1,1,6408,5126,s);e.getError()?i=!1:(e.deleteFramebuffer(o),e.deleteTexture(i),i=1===s[0]);$.freeType(s)}}s=!0;"undefined"!==typeof navigator&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent))||(s=e.createTexture(),o=$.allocType(5121,36),e.activeTexture(33984),e.bindTexture(34067,s),e.texImage2D(34069,0,6408,3,3,0,6408,5121,o),$.freeType(o),e.bindTexture(34067,null),e.deleteTexture(s),s=!e.getError());return{colorBits:[e.getParameter(3410),e.getParameter(3411),e.getParameter(3412),e.getParameter(3413)],depthBits:e.getParameter(3414),stencilBits:e.getParameter(3415),subpixelBits:e.getParameter(3408),extensions:Object.keys(t).filter((function(e){return!!t[e]})),maxAnisotropic:r,maxDrawbuffers:a,maxColorAttachments:n,pointSizeDims:e.getParameter(33901),lineWidthDims:e.getParameter(33902),maxViewportDims:e.getParameter(3386),maxCombinedTextureUnits:e.getParameter(35661),maxCubeMapSize:e.getParameter(34076),maxRenderbufferSize:e.getParameter(34024),maxTextureUnits:e.getParameter(34930),maxTextureSize:e.getParameter(3379),maxAttributes:e.getParameter(34921),maxVertexUniforms:e.getParameter(36347),maxVertexTextureUnits:e.getParameter(35660),maxVaryingVectors:e.getParameter(36348),maxFragmentUniforms:e.getParameter(36349),glsl:e.getParameter(35724),renderer:e.getParameter(7937),vendor:e.getParameter(7936),version:e.getParameter(7938),readFloat:i,npotTextureCube:s}},te=function(e){return e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Uint32Array||e instanceof Int8Array||e instanceof Int16Array||e instanceof Int32Array||e instanceof Float32Array||e instanceof Float64Array||e instanceof Uint8ClampedArray},re=function(e){return Object.keys(e).map((function(t){return e[t]}))},ae={shape:function(e){for(var t=[];e.length;e=e[0])t.push(e.length);return t},flatten:function(e,t,r,a){var n=1;if(t.length)for(var i=0;i<t.length;++i)n*=t[i];else n=0;r=a||$.allocType(r,n);switch(t.length){case 0:break;case 1:a=t[0];for(t=0;t<a;++t)r[t]=e[t];break;case 2:a=t[0];t=t[1];for(i=n=0;i<a;++i)for(var o=e[i],s=0;s<t;++s)r[n++]=o[s];break;case 3:d(e,t[0],t[1],t[2],r,0);break;default:m(e,t,0,r,0)}return r}},ne={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},ie={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,float:5126,float32:5126},oe={dynamic:35048,stream:35040,static:35044},se=ae.flatten,le=ae.shape,ue=[];ue[5120]=1;ue[5122]=2;ue[5124]=4;ue[5121]=1;ue[5123]=2;ue[5125]=4;ue[5126]=4;var ce={points:0,point:0,lines:1,line:1,triangles:4,triangle:4,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},fe=new Float32Array(1),he=new Uint32Array(fe.buffer),pe=[9984,9986,9985,9987],ve=[0,6409,6410,6407,6408],de={};de[6409]=de[6406]=de[6402]=1;de[34041]=de[6410]=2;de[6407]=de[35904]=3;de[6408]=de[35906]=4;var me=k("HTMLCanvasElement"),ge=k("OffscreenCanvas"),ye=k("CanvasRenderingContext2D"),xe=k("ImageBitmap"),be=k("HTMLImageElement"),_e=k("HTMLVideoElement"),we=Object.keys(ne).concat([me,ge,ye,xe,be,_e]),Te=[];Te[5121]=1;Te[5126]=4;Te[36193]=2;Te[5123]=2;Te[5125]=4;var ke=[];ke[32854]=2;ke[32855]=2;ke[36194]=2;ke[34041]=4;ke[33776]=.5;ke[33777]=.5;ke[33778]=1;ke[33779]=1;ke[35986]=.5;ke[35987]=1;ke[34798]=1;ke[35840]=.5;ke[35841]=.25;ke[35842]=.5;ke[35843]=.25;ke[36196]=.5;var Me=[];Me[32854]=2;Me[32855]=2;Me[36194]=2;Me[33189]=2;Me[36168]=1;Me[34041]=4;Me[35907]=4;Me[34836]=16;Me[34842]=8;Me[34843]=6;var Ae=function(e,t,r,a,n){function i(e){this.id=u++;this.refCount=1;this.renderbuffer=e;this.format=32854;this.height=this.width=0;n.profile&&(this.stats={size:0})}function o(t){var r=t.renderbuffer;e.bindRenderbuffer(36161,null);e.deleteRenderbuffer(r);t.renderbuffer=null;t.refCount=0;delete c[t.id];a.renderbufferCount--}var s={rgba4:32854,rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};t.ext_srgb&&(s.srgba=35907);t.ext_color_buffer_half_float&&(s.rgba16f=34842,s.rgb16f=34843);t.webgl_color_buffer_float&&(s.rgba32f=34836);var l=[];Object.keys(s).forEach((function(e){l[s[e]]=e}));var u=0,c={};i.prototype.decRef=function(){0>=--this.refCount&&o(this)};n.profile&&(a.getTotalRenderbufferSize=function(){var e=0;Object.keys(c).forEach((function(t){e+=c[t].stats.size}));return e});return{create:function(t,r){function o(t,r){var a=0,i=0,c=32854;"object"===typeof t&&t?("shape"in t?(i=t.shape,a=i[0]|0,i=i[1]|0):("radius"in t&&(a=i=t.radius|0),"width"in t&&(a=t.width|0),"height"in t&&(i=t.height|0)),"format"in t&&(c=s[t.format])):"number"===typeof t?(a=t|0,i="number"===typeof r?r|0:a):t||(a=i=1);if(a!==u.width||i!==u.height||c!==u.format)return o.width=u.width=a,o.height=u.height=i,u.format=c,e.bindRenderbuffer(36161,u.renderbuffer),e.renderbufferStorage(36161,c,a,i),n.profile&&(u.stats.size=Me[u.format]*u.width*u.height),o.format=l[u.format],o}var u=new i(e.createRenderbuffer());c[u.id]=u;a.renderbufferCount++;o(t,r);o.resize=function(t,r){var a=t|0,i=r|0||a;if(a===u.width&&i===u.height)return o;o.width=u.width=a;o.height=u.height=i;e.bindRenderbuffer(36161,u.renderbuffer);e.renderbufferStorage(36161,u.format,a,i);n.profile&&(u.stats.size=Me[u.format]*u.width*u.height);return o};o._reglType="renderbuffer";o._renderbuffer=u;n.profile&&(o.stats=u.stats);o.destroy=function(){u.decRef()};return o},clear:function(){re(c).forEach(o)},restore:function(){re(c).forEach((function(t){t.renderbuffer=e.createRenderbuffer();e.bindRenderbuffer(36161,t.renderbuffer);e.renderbufferStorage(36161,t.format,t.width,t.height)}));e.bindRenderbuffer(36161,null)}}},Se=[];Se[6408]=4;Se[6407]=3;var Ee=[];Ee[5121]=1;Ee[5126]=4;Ee[36193]=2;var Le=["x","y","z","w"],Ce="blend.func blend.equation stencil.func stencil.opFront stencil.opBack sample.coverage viewport scissor.box polygonOffset.offset".split(" "),Ie={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},Pe={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},Oe={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},ze={cw:2304,ccw:2305},De=new V(!1,!1,!1,(function(){})),Re=function(e,t){function r(){this.endQueryIndex=this.startQueryIndex=-1;this.sum=0;this.stats=null}function a(e,t,a){var n=o.pop()||new r;n.startQueryIndex=e;n.endQueryIndex=t;n.sum=0;n.stats=a;s.push(n)}if(!t.ext_disjoint_timer_query)return null;var n=[],i=[],o=[],s=[],l=[],u=[];return{beginQuery:function(e){var r=n.pop()||t.ext_disjoint_timer_query.createQueryEXT();t.ext_disjoint_timer_query.beginQueryEXT(35007,r);i.push(r);a(i.length-1,i.length,e)},endQuery:function(){t.ext_disjoint_timer_query.endQueryEXT(35007)},pushScopeStats:a,update:function(){var e,r;e=i.length;if(0!==e){u.length=Math.max(u.length,e+1);l.length=Math.max(l.length,e+1);l[0]=0;var a=u[0]=0;for(r=e=0;r<i.length;++r){var c=i[r];t.ext_disjoint_timer_query.getQueryObjectEXT(c,34919)?(a+=t.ext_disjoint_timer_query.getQueryObjectEXT(c,34918),n.push(c)):i[e++]=c;l[r+1]=a;u[r+1]=e}i.length=e;for(r=e=0;r<s.length;++r){var a=s[r],f=a.startQueryIndex,c=a.endQueryIndex;a.sum+=l[c]-l[f];f=u[f];c=u[c];c===f?(a.stats.gpuTime+=a.sum/1e6,o.push(a)):(a.startQueryIndex=f,a.endQueryIndex=c,s[e++]=a)}s.length=e}},getNumPendingQueries:function(){return i.length},clear:function(){n.push.apply(n,i);for(var e=0;e<n.length;e++)t.ext_disjoint_timer_query.deleteQueryEXT(n[e]);i.length=0;n.length=0},restore:function(){i.length=0;n.length=0}}};return function(e){function t(){if(0===G.length)k&&k.update(),re=null;else{re=K.next(t);p();for(var e=G.length-1;0<=e;--e){var r=G[e];r&&r(E,null,0)}m.flush();k&&k.update()}}function r(){!re&&0<G.length&&(re=K.next(t))}function a(){re&&(K.cancel(t),re=null)}function i(e){e.preventDefault();a();Z.forEach((function(e){e()}))}function o(e){m.getError();y.restore();B.restore();C.restore();N.restore();j.restore();U.restore();F.restore();k&&k.restore();V.procs.refresh();r();$.forEach((function(e){e()}))}function s(e){function t(e,t){var r={},a={};Object.keys(e).forEach((function(n){var i=e[n];if(J.isDynamic(i))a[n]=J.unbox(i,n);else{if(t&&Array.isArray(i))for(var o=0;o<i.length;++o)if(J.isDynamic(i[o])){a[n]=J.unbox(i,n);return}r[n]=i}}));return{dynamic:a,static:r}}function r(e){for(;f.length<e;)f.push(null);return f}var a=t(e.context||{},!0),n=t(e.uniforms||{},!0),i=t(e.attributes||{},!1);e=t(function(e){function t(e){if(e in r){var t=r[e];delete r[e];Object.keys(t).forEach((function(a){r[e+"."+a]=t[a]}))}}var r=X({},e);delete r.uniforms;delete r.attributes;delete r.context;delete r.vao;"stencil"in r&&r.stencil.op&&(r.stencil.opBack=r.stencil.opFront=r.stencil.op,delete r.stencil.op);t("blend");t("depth");t("cull");t("stencil");t("polygonOffset");t("scissor");t("sample");"vao"in e&&(r.vao=e.vao);return r}(e),!1);var o={gpuTime:0,cpuTime:0,count:0},s=V.compile(e,i,n,a,o),l=s.draw,u=s.batch,c=s.scope,f=[];return X((function(e,t){var a;if("function"===typeof e)return c.call(this,null,e,0);if("function"===typeof t)if("number"===typeof e)for(a=0;a<e;++a)c.call(this,null,t,a);else if(Array.isArray(e))for(a=0;a<e.length;++a)c.call(this,e[a],t,a);else return c.call(this,e,t,0);else if("number"===typeof e){if(0<e)return u.call(this,r(e|0),e|0)}else if(Array.isArray(e)){if(e.length)return u.call(this,e,e.length)}else return l.call(this,e)}),{stats:o,destroy:function(){s.destroy()}})}function l(e,t){var r=0;V.procs.poll();var a=t.color;a&&(m.clearColor(+a[0]||0,+a[1]||0,+a[2]||0,+a[3]||0),r|=16384);"depth"in t&&(m.clearDepth(+t.depth),r|=256);"stencil"in t&&(m.clearStencil(t.stencil|0),r|=1024);m.clear(r)}function f(e){G.push(e);r();return{cancel:function(){function t(){var e=W(G,t);G[e]=G[G.length-1];--G.length;0>=G.length&&a()}var r=W(G,e);G[r]=t}}}function h(){var e=H.viewport,t=H.scissor_box;e[0]=e[1]=t[0]=t[1]=0;E.viewportWidth=E.framebufferWidth=E.drawingBufferWidth=e[2]=t[2]=m.drawingBufferWidth;E.viewportHeight=E.framebufferHeight=E.drawingBufferHeight=e[3]=t[3]=m.drawingBufferHeight}function p(){E.tick+=1;E.time=d();h();V.procs.poll()}function v(){N.refresh();h();V.procs.refresh();k&&k.update()}function d(){return(Q()-M)/1e3}e=u(e);if(!e)return null;var m=e.gl,g=m.getContextAttributes();m.isContextLost();var y=c(m,e);if(!y)return null;var x=n(),w={vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0},T=y.extensions,k=Re(m,T),M=Q(),A=m.drawingBufferWidth,S=m.drawingBufferHeight,E={tick:0,time:0,viewportWidth:A,viewportHeight:S,framebufferWidth:A,framebufferHeight:S,drawingBufferWidth:A,drawingBufferHeight:S,pixelRatio:e.pixelRatio},A={elements:null,primitive:4,count:-1,offset:0,instances:-1},L=ee(m,T),C=b(m,w,e,(function(e){return F.destroyBuffer(e)})),O=_(m,T,C,w),F=z(m,T,L,w,C,O,A),B=D(m,x,w,e),N=I(m,T,L,(function(){V.procs.poll()}),E,w,e),j=Ae(m,T,L,w,e),U=P(m,T,L,N,j,w),V=Y(m,x,T,L,C,O,N,U,{},F,B,A,E,k,e),x=R(m,U,V.procs.poll,E,g,T,L),H=V.next,q=m.canvas,G=[],Z=[],$=[],te=[e.onDestroy],re=null;q&&(q.addEventListener("webglcontextlost",i,!1),q.addEventListener("webglcontextrestored",o,!1));var ae=U.setFBO=s({framebuffer:J.define.call(null,1,"framebuffer")});v();g=X(s,{clear:function(e){if("framebuffer"in e)if(e.framebuffer&&"framebufferCube"===e.framebuffer_reglType)for(var t=0;6>t;++t)ae(X({framebuffer:e.framebuffer.faces[t]},e),l);else ae(e,l);else l(null,e)},prop:J.define.bind(null,1),context:J.define.bind(null,2),this:J.define.bind(null,3),draw:s({}),buffer:function(e){return C.create(e,34962,!1,!1)},elements:function(e){return O.create(e,!1)},texture:N.create2D,cube:N.createCube,renderbuffer:j.create,framebuffer:U.create,framebufferCube:U.createCube,vao:F.createVAO,attributes:g,frame:f,on:function(e,t){var r;switch(e){case"frame":return f(t);case"lost":r=Z;break;case"restore":r=$;break;case"destroy":r=te}r.push(t);return{cancel:function(){for(var e=0;e<r.length;++e)if(r[e]===t){r[e]=r[r.length-1];r.pop();break}}}},limits:L,hasExtension:function(e){return 0<=L.extensions.indexOf(e.toLowerCase())},read:x,destroy:function(){G.length=0;a();q&&(q.removeEventListener("webglcontextlost",i),q.removeEventListener("webglcontextrestored",o));B.clear();U.clear();j.clear();F.clear();N.clear();O.clear();C.clear();k&&k.clear();te.forEach((function(e){e()}))},_gl:m,_refresh:v,poll:function(){p();k&&k.update()},now:d,stats:w});e.onDone(null,g);return g}}))},{}],527:[function(e,t,r){"use strict";var a="";var n;t.exports=i;function i(e,t){if(typeof e!=="string"){throw new TypeError("expected a string")}if(t===1)return e;if(t===2)return e+e;var r=e.length*t;if(n!==e||typeof n==="undefined"){n=e;a=""}else if(a.length>=r){return a.substr(0,r)}while(r>a.length&&t>1){if(t&1){a+=e}t>>=1;e+=e}a+=e;a=a.substr(0,r);return a}},{}],528:[function(e,r,a){(function(e){(function(){r.exports=e.performance&&e.performance.now?function e(){return performance.now()}:Date.now||function e(){return+new Date}}).call(this)}).call(this,typeof t!=="undefined"?t:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],529:[function(e,t,r){"use strict";t.exports=a;function a(e){var t=e.length;var r=e[e.length-1];var a=t;for(var n=t-2;n>=0;--n){var i=r;var o=e[n];r=i+o;var s=r-i;var l=o-s;if(l){e[--a]=r;r=l}}var u=0;for(var n=a;n<t;++n){var i=e[n];var o=r;r=i+o;var s=r-i;var l=o-s;if(l){e[u++]=l}}e[u++]=r;e.length=u;return e}},{}],530:[function(e,t,r){"use strict";var a=e("two-product");var n=e("robust-sum");var i=e("robust-scale");var o=e("robust-compress");var s=4;function l(e,t,r,a){return function t(n){return a(e(r(n[0][0],n[1][1]),r(-n[0][1],n[1][0])))}}function u(e,t,r,a){return function n(i){return a(e(t(e(r(i[1][1],i[2][2]),r(-i[1][2],i[2][1])),i[0][0]),e(t(e(r(i[1][0],i[2][2]),r(-i[1][2],i[2][0])),-i[0][1]),t(e(r(i[1][0],i[2][1]),r(-i[1][1],i[2][0])),i[0][2]))))}}function c(e){var t=e===2?l:e===3?u:undefined;return t(n,i,a,o)}var f=[function e(){return[0]},function e(t){return[t[0][0]]}];function h(e,t,r,a,n,i){return function o(s){switch(s.length){case 0:return e(s);case 1:return t(s);case 2:return r(s);case 3:return a(s)}var l=n[s.length];if(!l)l=n[s.length]=i(s.length);return l(s)}}function p(){while(f.length<s){f.push(c(f.length))}t.exports=h.apply(undefined,f.concat([f,c]));for(var e=0;e<f.length;++e){t.exports[e]=f[e]}}p()},{"robust-compress":529,"robust-scale":536,"robust-sum":539,"two-product":588}],531:[function(e,t,r){"use strict";var a=e("two-product");var n=e("robust-sum");t.exports=i;function i(e,t){var r=a(e[0],t[0]);for(var i=1;i<e.length;++i){r=n(r,a(e[i],t[i]))}return r}},{"robust-sum":539,"two-product":588}],532:[function(e,t,r){"use strict";var a=e("two-product");var n=e("robust-sum");var i=e("robust-subtract");var o=e("robust-scale");var s=6;function l(e){var t=e===3?h:e===4?p:e===5?v:d;return t(n,i,a,o)}function u(){return 0}function c(){return 0}function f(){return 0}function h(e,t,r,a){function n(n,i,o){var s=r(n[0],n[0]);var l=a(s,i[0]);var u=a(s,o[0]);var c=r(i[0],i[0]);var f=a(c,n[0]);var h=a(c,o[0]);var p=r(o[0],o[0]);var v=a(p,n[0]);var d=a(p,i[0]);var m=e(t(d,h),t(f,l));var g=t(v,u);var y=t(m,g);return y[y.length-1]}return n}function p(e,t,r,a){function n(n,i,o,s){var l=e(r(n[0],n[0]),r(n[1],n[1]));var u=a(l,i[0]);var c=a(l,o[0]);var f=a(l,s[0]);var h=e(r(i[0],i[0]),r(i[1],i[1]));var p=a(h,n[0]);var v=a(h,o[0]);var d=a(h,s[0]);var m=e(r(o[0],o[0]),r(o[1],o[1]));var g=a(m,n[0]);var y=a(m,i[0]);var x=a(m,s[0]);var b=e(r(s[0],s[0]),r(s[1],s[1]));var _=a(b,n[0]);var w=a(b,i[0]);var T=a(b,o[0]);var k=e(e(a(t(T,x),i[1]),e(a(t(w,d),-o[1]),a(t(y,v),s[1]))),e(a(t(w,d),n[1]),e(a(t(_,f),-i[1]),a(t(p,u),s[1]))));var M=e(e(a(t(T,x),n[1]),e(a(t(_,f),-o[1]),a(t(g,c),s[1]))),e(a(t(y,v),n[1]),e(a(t(g,c),-i[1]),a(t(p,u),o[1]))));var A=t(k,M);return A[A.length-1]}return n}function v(e,t,r,a){function n(n,i,o,s,l){var u=e(r(n[0],n[0]),e(r(n[1],n[1]),r(n[2],n[2])));var c=a(u,i[0]);var f=a(u,o[0]);var h=a(u,s[0]);var p=a(u,l[0]);var v=e(r(i[0],i[0]),e(r(i[1],i[1]),r(i[2],i[2])));var d=a(v,n[0]);var m=a(v,o[0]);var g=a(v,s[0]);var y=a(v,l[0]);var x=e(r(o[0],o[0]),e(r(o[1],o[1]),r(o[2],o[2])));var b=a(x,n[0]);var _=a(x,i[0]);var w=a(x,s[0]);var T=a(x,l[0]);var k=e(r(s[0],s[0]),e(r(s[1],s[1]),r(s[2],s[2])));var M=a(k,n[0]);var A=a(k,i[0]);var S=a(k,o[0]);var E=a(k,l[0]);var L=e(r(l[0],l[0]),e(r(l[1],l[1]),r(l[2],l[2])));var C=a(L,n[0]);var I=a(L,i[0]);var P=a(L,o[0]);var O=a(L,s[0]);var z=e(e(e(a(e(a(t(O,E),o[1]),e(a(t(P,T),-s[1]),a(t(S,w),l[1]))),i[2]),e(a(e(a(t(O,E),i[1]),e(a(t(I,y),-s[1]),a(t(A,g),l[1]))),-o[2]),a(e(a(t(P,T),i[1]),e(a(t(I,y),-o[1]),a(t(_,m),l[1]))),s[2]))),e(a(e(a(t(S,w),i[1]),e(a(t(A,g),-o[1]),a(t(_,m),s[1]))),-l[2]),e(a(e(a(t(O,E),i[1]),e(a(t(I,y),-s[1]),a(t(A,g),l[1]))),n[2]),a(e(a(t(O,E),n[1]),e(a(t(C,p),-s[1]),a(t(M,h),l[1]))),-i[2])))),e(e(a(e(a(t(I,y),n[1]),e(a(t(C,p),-i[1]),a(t(d,c),l[1]))),s[2]),e(a(e(a(t(A,g),n[1]),e(a(t(M,h),-i[1]),a(t(d,c),s[1]))),-l[2]),a(e(a(t(S,w),i[1]),e(a(t(A,g),-o[1]),a(t(_,m),s[1]))),n[2]))),e(a(e(a(t(S,w),n[1]),e(a(t(M,h),-o[1]),a(t(b,f),s[1]))),-i[2]),e(a(e(a(t(A,g),n[1]),e(a(t(M,h),-i[1]),a(t(d,c),s[1]))),o[2]),a(e(a(t(_,m),n[1]),e(a(t(b,f),-i[1]),a(t(d,c),o[1]))),-s[2])))));var D=e(e(e(a(e(a(t(O,E),o[1]),e(a(t(P,T),-s[1]),a(t(S,w),l[1]))),n[2]),a(e(a(t(O,E),n[1]),e(a(t(C,p),-s[1]),a(t(M,h),l[1]))),-o[2])),e(a(e(a(t(P,T),n[1]),e(a(t(C,p),-o[1]),a(t(b,f),l[1]))),s[2]),a(e(a(t(S,w),n[1]),e(a(t(M,h),-o[1]),a(t(b,f),s[1]))),-l[2]))),e(e(a(e(a(t(P,T),i[1]),e(a(t(I,y),-o[1]),a(t(_,m),l[1]))),n[2]),a(e(a(t(P,T),n[1]),e(a(t(C,p),-o[1]),a(t(b,f),l[1]))),-i[2])),e(a(e(a(t(I,y),n[1]),e(a(t(C,p),-i[1]),a(t(d,c),l[1]))),o[2]),a(e(a(t(_,m),n[1]),e(a(t(b,f),-i[1]),a(t(d,c),o[1]))),-l[2]))));var R=t(z,D);return R[R.length-1]}return n}function d(e,t,r,a){function n(n,i,o,s,l,u){var c=e(e(r(n[0],n[0]),r(n[1],n[1])),e(r(n[2],n[2]),r(n[3],n[3])));var f=a(c,i[0]);var h=a(c,o[0]);var p=a(c,s[0]);var v=a(c,l[0]);var d=a(c,u[0]);var m=e(e(r(i[0],i[0]),r(i[1],i[1])),e(r(i[2],i[2]),r(i[3],i[3])));var g=a(m,n[0]);var y=a(m,o[0]);var x=a(m,s[0]);var b=a(m,l[0]);var _=a(m,u[0]);var w=e(e(r(o[0],o[0]),r(o[1],o[1])),e(r(o[2],o[2]),r(o[3],o[3])));var T=a(w,n[0]);var k=a(w,i[0]);var M=a(w,s[0]);var A=a(w,l[0]);var S=a(w,u[0]);var E=e(e(r(s[0],s[0]),r(s[1],s[1])),e(r(s[2],s[2]),r(s[3],s[3])));var L=a(E,n[0]);var C=a(E,i[0]);var I=a(E,o[0]);var P=a(E,l[0]);var O=a(E,u[0]);var z=e(e(r(l[0],l[0]),r(l[1],l[1])),e(r(l[2],l[2]),r(l[3],l[3])));var D=a(z,n[0]);var R=a(z,i[0]);var F=a(z,o[0]);var B=a(z,s[0]);var N=a(z,u[0]);var j=e(e(r(u[0],u[0]),r(u[1],u[1])),e(r(u[2],u[2]),r(u[3],u[3])));var U=a(j,n[0]);var V=a(j,i[0]);var H=a(j,o[0]);var q=a(j,s[0]);var G=a(j,l[0]);var Y=e(e(e(a(e(e(a(e(a(t(G,N),s[1]),e(a(t(q,O),-l[1]),a(t(B,P),u[1]))),o[2]),a(e(a(t(G,N),o[1]),e(a(t(H,S),-l[1]),a(t(F,A),u[1]))),-s[2])),e(a(e(a(t(q,O),o[1]),e(a(t(H,S),-s[1]),a(t(I,M),u[1]))),l[2]),a(e(a(t(B,P),o[1]),e(a(t(F,A),-s[1]),a(t(I,M),l[1]))),-u[2]))),i[3]),e(a(e(e(a(e(a(t(G,N),s[1]),e(a(t(q,O),-l[1]),a(t(B,P),u[1]))),i[2]),a(e(a(t(G,N),i[1]),e(a(t(V,_),-l[1]),a(t(R,b),u[1]))),-s[2])),e(a(e(a(t(q,O),i[1]),e(a(t(V,_),-s[1]),a(t(C,x),u[1]))),l[2]),a(e(a(t(B,P),i[1]),e(a(t(R,b),-s[1]),a(t(C,x),l[1]))),-u[2]))),-o[3]),a(e(e(a(e(a(t(G,N),o[1]),e(a(t(H,S),-l[1]),a(t(F,A),u[1]))),i[2]),a(e(a(t(G,N),i[1]),e(a(t(V,_),-l[1]),a(t(R,b),u[1]))),-o[2])),e(a(e(a(t(H,S),i[1]),e(a(t(V,_),-o[1]),a(t(k,y),u[1]))),l[2]),a(e(a(t(F,A),i[1]),e(a(t(R,b),-o[1]),a(t(k,y),l[1]))),-u[2]))),s[3]))),e(e(a(e(e(a(e(a(t(q,O),o[1]),e(a(t(H,S),-s[1]),a(t(I,M),u[1]))),i[2]),a(e(a(t(q,O),i[1]),e(a(t(V,_),-s[1]),a(t(C,x),u[1]))),-o[2])),e(a(e(a(t(H,S),i[1]),e(a(t(V,_),-o[1]),a(t(k,y),u[1]))),s[2]),a(e(a(t(I,M),i[1]),e(a(t(C,x),-o[1]),a(t(k,y),s[1]))),-u[2]))),-l[3]),a(e(e(a(e(a(t(B,P),o[1]),e(a(t(F,A),-s[1]),a(t(I,M),l[1]))),i[2]),a(e(a(t(B,P),i[1]),e(a(t(R,b),-s[1]),a(t(C,x),l[1]))),-o[2])),e(a(e(a(t(F,A),i[1]),e(a(t(R,b),-o[1]),a(t(k,y),l[1]))),s[2]),a(e(a(t(I,M),i[1]),e(a(t(C,x),-o[1]),a(t(k,y),s[1]))),-l[2]))),u[3])),e(a(e(e(a(e(a(t(G,N),s[1]),e(a(t(q,O),-l[1]),a(t(B,P),u[1]))),i[2]),a(e(a(t(G,N),i[1]),e(a(t(V,_),-l[1]),a(t(R,b),u[1]))),-s[2])),e(a(e(a(t(q,O),i[1]),e(a(t(V,_),-s[1]),a(t(C,x),u[1]))),l[2]),a(e(a(t(B,P),i[1]),e(a(t(R,b),-s[1]),a(t(C,x),l[1]))),-u[2]))),n[3]),a(e(e(a(e(a(t(G,N),s[1]),e(a(t(q,O),-l[1]),a(t(B,P),u[1]))),n[2]),a(e(a(t(G,N),n[1]),e(a(t(U,d),-l[1]),a(t(D,v),u[1]))),-s[2])),e(a(e(a(t(q,O),n[1]),e(a(t(U,d),-s[1]),a(t(L,p),u[1]))),l[2]),a(e(a(t(B,P),n[1]),e(a(t(D,v),-s[1]),a(t(L,p),l[1]))),-u[2]))),-i[3])))),e(e(e(a(e(e(a(e(a(t(G,N),i[1]),e(a(t(V,_),-l[1]),a(t(R,b),u[1]))),n[2]),a(e(a(t(G,N),n[1]),e(a(t(U,d),-l[1]),a(t(D,v),u[1]))),-i[2])),e(a(e(a(t(V,_),n[1]),e(a(t(U,d),-i[1]),a(t(g,f),u[1]))),l[2]),a(e(a(t(R,b),n[1]),e(a(t(D,v),-i[1]),a(t(g,f),l[1]))),-u[2]))),s[3]),a(e(e(a(e(a(t(q,O),i[1]),e(a(t(V,_),-s[1]),a(t(C,x),u[1]))),n[2]),a(e(a(t(q,O),n[1]),e(a(t(U,d),-s[1]),a(t(L,p),u[1]))),-i[2])),e(a(e(a(t(V,_),n[1]),e(a(t(U,d),-i[1]),a(t(g,f),u[1]))),s[2]),a(e(a(t(C,x),n[1]),e(a(t(L,p),-i[1]),a(t(g,f),s[1]))),-u[2]))),-l[3])),e(a(e(e(a(e(a(t(B,P),i[1]),e(a(t(R,b),-s[1]),a(t(C,x),l[1]))),n[2]),a(e(a(t(B,P),n[1]),e(a(t(D,v),-s[1]),a(t(L,p),l[1]))),-i[2])),e(a(e(a(t(R,b),n[1]),e(a(t(D,v),-i[1]),a(t(g,f),l[1]))),s[2]),a(e(a(t(C,x),n[1]),e(a(t(L,p),-i[1]),a(t(g,f),s[1]))),-l[2]))),u[3]),a(e(e(a(e(a(t(q,O),o[1]),e(a(t(H,S),-s[1]),a(t(I,M),u[1]))),i[2]),a(e(a(t(q,O),i[1]),e(a(t(V,_),-s[1]),a(t(C,x),u[1]))),-o[2])),e(a(e(a(t(H,S),i[1]),e(a(t(V,_),-o[1]),a(t(k,y),u[1]))),s[2]),a(e(a(t(I,M),i[1]),e(a(t(C,x),-o[1]),a(t(k,y),s[1]))),-u[2]))),n[3]))),e(e(a(e(e(a(e(a(t(q,O),o[1]),e(a(t(H,S),-s[1]),a(t(I,M),u[1]))),n[2]),a(e(a(t(q,O),n[1]),e(a(t(U,d),-s[1]),a(t(L,p),u[1]))),-o[2])),e(a(e(a(t(H,S),n[1]),e(a(t(U,d),-o[1]),a(t(T,h),u[1]))),s[2]),a(e(a(t(I,M),n[1]),e(a(t(L,p),-o[1]),a(t(T,h),s[1]))),-u[2]))),-i[3]),a(e(e(a(e(a(t(q,O),i[1]),e(a(t(V,_),-s[1]),a(t(C,x),u[1]))),n[2]),a(e(a(t(q,O),n[1]),e(a(t(U,d),-s[1]),a(t(L,p),u[1]))),-i[2])),e(a(e(a(t(V,_),n[1]),e(a(t(U,d),-i[1]),a(t(g,f),u[1]))),s[2]),a(e(a(t(C,x),n[1]),e(a(t(L,p),-i[1]),a(t(g,f),s[1]))),-u[2]))),o[3])),e(a(e(e(a(e(a(t(H,S),i[1]),e(a(t(V,_),-o[1]),a(t(k,y),u[1]))),n[2]),a(e(a(t(H,S),n[1]),e(a(t(U,d),-o[1]),a(t(T,h),u[1]))),-i[2])),e(a(e(a(t(V,_),n[1]),e(a(t(U,d),-i[1]),a(t(g,f),u[1]))),o[2]),a(e(a(t(k,y),n[1]),e(a(t(T,h),-i[1]),a(t(g,f),o[1]))),-u[2]))),-s[3]),a(e(e(a(e(a(t(I,M),i[1]),e(a(t(C,x),-o[1]),a(t(k,y),s[1]))),n[2]),a(e(a(t(I,M),n[1]),e(a(t(L,p),-o[1]),a(t(T,h),s[1]))),-i[2])),e(a(e(a(t(C,x),n[1]),e(a(t(L,p),-i[1]),a(t(g,f),s[1]))),o[2]),a(e(a(t(k,y),n[1]),e(a(t(T,h),-i[1]),a(t(g,f),o[1]))),-s[2]))),u[3])))));var W=e(e(e(a(e(e(a(e(a(t(G,N),s[1]),e(a(t(q,O),-l[1]),a(t(B,P),u[1]))),o[2]),a(e(a(t(G,N),o[1]),e(a(t(H,S),-l[1]),a(t(F,A),u[1]))),-s[2])),e(a(e(a(t(q,O),o[1]),e(a(t(H,S),-s[1]),a(t(I,M),u[1]))),l[2]),a(e(a(t(B,P),o[1]),e(a(t(F,A),-s[1]),a(t(I,M),l[1]))),-u[2]))),n[3]),e(a(e(e(a(e(a(t(G,N),s[1]),e(a(t(q,O),-l[1]),a(t(B,P),u[1]))),n[2]),a(e(a(t(G,N),n[1]),e(a(t(U,d),-l[1]),a(t(D,v),u[1]))),-s[2])),e(a(e(a(t(q,O),n[1]),e(a(t(U,d),-s[1]),a(t(L,p),u[1]))),l[2]),a(e(a(t(B,P),n[1]),e(a(t(D,v),-s[1]),a(t(L,p),l[1]))),-u[2]))),-o[3]),a(e(e(a(e(a(t(G,N),o[1]),e(a(t(H,S),-l[1]),a(t(F,A),u[1]))),n[2]),a(e(a(t(G,N),n[1]),e(a(t(U,d),-l[1]),a(t(D,v),u[1]))),-o[2])),e(a(e(a(t(H,S),n[1]),e(a(t(U,d),-o[1]),a(t(T,h),u[1]))),l[2]),a(e(a(t(F,A),n[1]),e(a(t(D,v),-o[1]),a(t(T,h),l[1]))),-u[2]))),s[3]))),e(e(a(e(e(a(e(a(t(q,O),o[1]),e(a(t(H,S),-s[1]),a(t(I,M),u[1]))),n[2]),a(e(a(t(q,O),n[1]),e(a(t(U,d),-s[1]),a(t(L,p),u[1]))),-o[2])),e(a(e(a(t(H,S),n[1]),e(a(t(U,d),-o[1]),a(t(T,h),u[1]))),s[2]),a(e(a(t(I,M),n[1]),e(a(t(L,p),-o[1]),a(t(T,h),s[1]))),-u[2]))),-l[3]),a(e(e(a(e(a(t(B,P),o[1]),e(a(t(F,A),-s[1]),a(t(I,M),l[1]))),n[2]),a(e(a(t(B,P),n[1]),e(a(t(D,v),-s[1]),a(t(L,p),l[1]))),-o[2])),e(a(e(a(t(F,A),n[1]),e(a(t(D,v),-o[1]),a(t(T,h),l[1]))),s[2]),a(e(a(t(I,M),n[1]),e(a(t(L,p),-o[1]),a(t(T,h),s[1]))),-l[2]))),u[3])),e(a(e(e(a(e(a(t(G,N),o[1]),e(a(t(H,S),-l[1]),a(t(F,A),u[1]))),i[2]),a(e(a(t(G,N),i[1]),e(a(t(V,_),-l[1]),a(t(R,b),u[1]))),-o[2])),e(a(e(a(t(H,S),i[1]),e(a(t(V,_),-o[1]),a(t(k,y),u[1]))),l[2]),a(e(a(t(F,A),i[1]),e(a(t(R,b),-o[1]),a(t(k,y),l[1]))),-u[2]))),n[3]),a(e(e(a(e(a(t(G,N),o[1]),e(a(t(H,S),-l[1]),a(t(F,A),u[1]))),n[2]),a(e(a(t(G,N),n[1]),e(a(t(U,d),-l[1]),a(t(D,v),u[1]))),-o[2])),e(a(e(a(t(H,S),n[1]),e(a(t(U,d),-o[1]),a(t(T,h),u[1]))),l[2]),a(e(a(t(F,A),n[1]),e(a(t(D,v),-o[1]),a(t(T,h),l[1]))),-u[2]))),-i[3])))),e(e(e(a(e(e(a(e(a(t(G,N),i[1]),e(a(t(V,_),-l[1]),a(t(R,b),u[1]))),n[2]),a(e(a(t(G,N),n[1]),e(a(t(U,d),-l[1]),a(t(D,v),u[1]))),-i[2])),e(a(e(a(t(V,_),n[1]),e(a(t(U,d),-i[1]),a(t(g,f),u[1]))),l[2]),a(e(a(t(R,b),n[1]),e(a(t(D,v),-i[1]),a(t(g,f),l[1]))),-u[2]))),o[3]),a(e(e(a(e(a(t(H,S),i[1]),e(a(t(V,_),-o[1]),a(t(k,y),u[1]))),n[2]),a(e(a(t(H,S),n[1]),e(a(t(U,d),-o[1]),a(t(T,h),u[1]))),-i[2])),e(a(e(a(t(V,_),n[1]),e(a(t(U,d),-i[1]),a(t(g,f),u[1]))),o[2]),a(e(a(t(k,y),n[1]),e(a(t(T,h),-i[1]),a(t(g,f),o[1]))),-u[2]))),-l[3])),e(a(e(e(a(e(a(t(F,A),i[1]),e(a(t(R,b),-o[1]),a(t(k,y),l[1]))),n[2]),a(e(a(t(F,A),n[1]),e(a(t(D,v),-o[1]),a(t(T,h),l[1]))),-i[2])),e(a(e(a(t(R,b),n[1]),e(a(t(D,v),-i[1]),a(t(g,f),l[1]))),o[2]),a(e(a(t(k,y),n[1]),e(a(t(T,h),-i[1]),a(t(g,f),o[1]))),-l[2]))),u[3]),a(e(e(a(e(a(t(B,P),o[1]),e(a(t(F,A),-s[1]),a(t(I,M),l[1]))),i[2]),a(e(a(t(B,P),i[1]),e(a(t(R,b),-s[1]),a(t(C,x),l[1]))),-o[2])),e(a(e(a(t(F,A),i[1]),e(a(t(R,b),-o[1]),a(t(k,y),l[1]))),s[2]),a(e(a(t(I,M),i[1]),e(a(t(C,x),-o[1]),a(t(k,y),s[1]))),-l[2]))),n[3]))),e(e(a(e(e(a(e(a(t(B,P),o[1]),e(a(t(F,A),-s[1]),a(t(I,M),l[1]))),n[2]),a(e(a(t(B,P),n[1]),e(a(t(D,v),-s[1]),a(t(L,p),l[1]))),-o[2])),e(a(e(a(t(F,A),n[1]),e(a(t(D,v),-o[1]),a(t(T,h),l[1]))),s[2]),a(e(a(t(I,M),n[1]),e(a(t(L,p),-o[1]),a(t(T,h),s[1]))),-l[2]))),-i[3]),a(e(e(a(e(a(t(B,P),i[1]),e(a(t(R,b),-s[1]),a(t(C,x),l[1]))),n[2]),a(e(a(t(B,P),n[1]),e(a(t(D,v),-s[1]),a(t(L,p),l[1]))),-i[2])),e(a(e(a(t(R,b),n[1]),e(a(t(D,v),-i[1]),a(t(g,f),l[1]))),s[2]),a(e(a(t(C,x),n[1]),e(a(t(L,p),-i[1]),a(t(g,f),s[1]))),-l[2]))),o[3])),e(a(e(e(a(e(a(t(F,A),i[1]),e(a(t(R,b),-o[1]),a(t(k,y),l[1]))),n[2]),a(e(a(t(F,A),n[1]),e(a(t(D,v),-o[1]),a(t(T,h),l[1]))),-i[2])),e(a(e(a(t(R,b),n[1]),e(a(t(D,v),-i[1]),a(t(g,f),l[1]))),o[2]),a(e(a(t(k,y),n[1]),e(a(t(T,h),-i[1]),a(t(g,f),o[1]))),-l[2]))),-s[3]),a(e(e(a(e(a(t(I,M),i[1]),e(a(t(C,x),-o[1]),a(t(k,y),s[1]))),n[2]),a(e(a(t(I,M),n[1]),e(a(t(L,p),-o[1]),a(t(T,h),s[1]))),-i[2])),e(a(e(a(t(C,x),n[1]),e(a(t(L,p),-i[1]),a(t(g,f),s[1]))),o[2]),a(e(a(t(k,y),n[1]),e(a(t(T,h),-i[1]),a(t(g,f),o[1]))),-s[2]))),l[3])))));var X=t(Y,W);return X[X.length-1]}return n}var m=[u,c,f];function g(e){var t=m[e.length];if(!t){t=m[e.length]=l(e.length)}return t.apply(undefined,e)}function y(e,t,r,a,n,i,o,s){function l(t,r,l,u,c,f){switch(arguments.length){case 0:case 1:return 0;case 2:return a(t,r);case 3:return n(t,r,l);case 4:return i(t,r,l,u);case 5:return o(t,r,l,u,c);case 6:return s(t,r,l,u,c,f)}var h=new Array(arguments.length);for(var p=0;p<arguments.length;++p){h[p]=arguments[p]}return e(h)}return l}function x(){while(m.length<=s){m.push(l(m.length))}t.exports=y.apply(undefined,[g].concat(m));for(var e=0;e<=s;++e){t.exports[e]=m[e]}}x()},{"robust-scale":536,"robust-subtract":538,"robust-sum":539,"two-product":588}],533:[function(e,t,r){"use strict";var a=e("robust-determinant");var n=3;function i(e){var t=e===2?l:u;if(e<n){return t(a[e])}return t(a)}function o(){return[[0]]}function s(e,t){return[[t[0]],[e[0][0]]]}function l(e){return function t(r,a){return[e([[+a[0],+r[0][1]],[+a[1],+r[1][1]]]),e([[+r[0][0],+a[0]],[+r[1][0],+a[1]]]),e(r)]}}function u(e){return function t(r,a){return[e([[+a[0],+r[0][1],+r[0][2]],[+a[1],+r[1][1],+r[1][2]],[+a[2],+r[2][1],+r[2][2]]]),e([[+r[0][0],+a[0],+r[0][2]],[+r[1][0],+a[1],+r[1][2]],[+r[2][0],+a[2],+r[2][2]]]),e([[+r[0][0],+r[0][1],+a[0]],[+r[1][0],+r[1][1],+a[1]],[+r[2][0],+r[2][1],+a[2]]]),e(r)]}}var c=[o,s];function f(e,t,r,a,n,i){return function o(s,l){switch(s.length){case 0:return e(s,l);case 1:return t(s,l);case 2:return r(s,l);case 3:return a(s,l)}var u=n[s.length];if(!u)u=n[s.length]=i(s.length);return u(s,l)}}function h(){while(c.length<=n){c.push(i(c.length))}t.exports=f.apply(undefined,c.concat([c,i]));for(var e=0;e<n;++e){t.exports[e]=c[e]}}h()},{"robust-determinant":530}],534:[function(e,t,r){"use strict";var a=e("two-product");var n=e("robust-sum");var i=e("robust-scale");var o=e("robust-subtract");var s=5;var l=11102230246251565e-32;var u=(3+16*l)*l;var c=(7+56*l)*l;function f(e,t,r,a){return function r(n,i,o){var s=e(e(t(i[1],o[0]),t(-o[1],i[0])),e(t(n[1],i[0]),t(-i[1],n[0])));var l=e(t(n[1],o[0]),t(-o[1],n[0]));var u=a(s,l);return u[u.length-1]}}function h(e,t,r,a){return function n(i,o,s,l){var u=e(e(r(e(t(s[1],l[0]),t(-l[1],s[0])),o[2]),e(r(e(t(o[1],l[0]),t(-l[1],o[0])),-s[2]),r(e(t(o[1],s[0]),t(-s[1],o[0])),l[2]))),e(r(e(t(o[1],l[0]),t(-l[1],o[0])),i[2]),e(r(e(t(i[1],l[0]),t(-l[1],i[0])),-o[2]),r(e(t(i[1],o[0]),t(-o[1],i[0])),l[2]))));var c=e(e(r(e(t(s[1],l[0]),t(-l[1],s[0])),i[2]),e(r(e(t(i[1],l[0]),t(-l[1],i[0])),-s[2]),r(e(t(i[1],s[0]),t(-s[1],i[0])),l[2]))),e(r(e(t(o[1],s[0]),t(-s[1],o[0])),i[2]),e(r(e(t(i[1],s[0]),t(-s[1],i[0])),-o[2]),r(e(t(i[1],o[0]),t(-o[1],i[0])),s[2]))));var f=a(u,c);return f[f.length-1]}}function p(e,t,r,a){return function n(i,o,s,l,u){var c=e(e(e(r(e(r(e(t(l[1],u[0]),t(-u[1],l[0])),s[2]),e(r(e(t(s[1],u[0]),t(-u[1],s[0])),-l[2]),r(e(t(s[1],l[0]),t(-l[1],s[0])),u[2]))),o[3]),e(r(e(r(e(t(l[1],u[0]),t(-u[1],l[0])),o[2]),e(r(e(t(o[1],u[0]),t(-u[1],o[0])),-l[2]),r(e(t(o[1],l[0]),t(-l[1],o[0])),u[2]))),-s[3]),r(e(r(e(t(s[1],u[0]),t(-u[1],s[0])),o[2]),e(r(e(t(o[1],u[0]),t(-u[1],o[0])),-s[2]),r(e(t(o[1],s[0]),t(-s[1],o[0])),u[2]))),l[3]))),e(r(e(r(e(t(s[1],l[0]),t(-l[1],s[0])),o[2]),e(r(e(t(o[1],l[0]),t(-l[1],o[0])),-s[2]),r(e(t(o[1],s[0]),t(-s[1],o[0])),l[2]))),-u[3]),e(r(e(r(e(t(l[1],u[0]),t(-u[1],l[0])),o[2]),e(r(e(t(o[1],u[0]),t(-u[1],o[0])),-l[2]),r(e(t(o[1],l[0]),t(-l[1],o[0])),u[2]))),i[3]),r(e(r(e(t(l[1],u[0]),t(-u[1],l[0])),i[2]),e(r(e(t(i[1],u[0]),t(-u[1],i[0])),-l[2]),r(e(t(i[1],l[0]),t(-l[1],i[0])),u[2]))),-o[3])))),e(e(r(e(r(e(t(o[1],u[0]),t(-u[1],o[0])),i[2]),e(r(e(t(i[1],u[0]),t(-u[1],i[0])),-o[2]),r(e(t(i[1],o[0]),t(-o[1],i[0])),u[2]))),l[3]),e(r(e(r(e(t(o[1],l[0]),t(-l[1],o[0])),i[2]),e(r(e(t(i[1],l[0]),t(-l[1],i[0])),-o[2]),r(e(t(i[1],o[0]),t(-o[1],i[0])),l[2]))),-u[3]),r(e(r(e(t(s[1],l[0]),t(-l[1],s[0])),o[2]),e(r(e(t(o[1],l[0]),t(-l[1],o[0])),-s[2]),r(e(t(o[1],s[0]),t(-s[1],o[0])),l[2]))),i[3]))),e(r(e(r(e(t(s[1],l[0]),t(-l[1],s[0])),i[2]),e(r(e(t(i[1],l[0]),t(-l[1],i[0])),-s[2]),r(e(t(i[1],s[0]),t(-s[1],i[0])),l[2]))),-o[3]),e(r(e(r(e(t(o[1],l[0]),t(-l[1],o[0])),i[2]),e(r(e(t(i[1],l[0]),t(-l[1],i[0])),-o[2]),r(e(t(i[1],o[0]),t(-o[1],i[0])),l[2]))),s[3]),r(e(r(e(t(o[1],s[0]),t(-s[1],o[0])),i[2]),e(r(e(t(i[1],s[0]),t(-s[1],i[0])),-o[2]),r(e(t(i[1],o[0]),t(-o[1],i[0])),s[2]))),-l[3])))));var f=e(e(e(r(e(r(e(t(l[1],u[0]),t(-u[1],l[0])),s[2]),e(r(e(t(s[1],u[0]),t(-u[1],s[0])),-l[2]),r(e(t(s[1],l[0]),t(-l[1],s[0])),u[2]))),i[3]),r(e(r(e(t(l[1],u[0]),t(-u[1],l[0])),i[2]),e(r(e(t(i[1],u[0]),t(-u[1],i[0])),-l[2]),r(e(t(i[1],l[0]),t(-l[1],i[0])),u[2]))),-s[3])),e(r(e(r(e(t(s[1],u[0]),t(-u[1],s[0])),i[2]),e(r(e(t(i[1],u[0]),t(-u[1],i[0])),-s[2]),r(e(t(i[1],s[0]),t(-s[1],i[0])),u[2]))),l[3]),r(e(r(e(t(s[1],l[0]),t(-l[1],s[0])),i[2]),e(r(e(t(i[1],l[0]),t(-l[1],i[0])),-s[2]),r(e(t(i[1],s[0]),t(-s[1],i[0])),l[2]))),-u[3]))),e(e(r(e(r(e(t(s[1],u[0]),t(-u[1],s[0])),o[2]),e(r(e(t(o[1],u[0]),t(-u[1],o[0])),-s[2]),r(e(t(o[1],s[0]),t(-s[1],o[0])),u[2]))),i[3]),r(e(r(e(t(s[1],u[0]),t(-u[1],s[0])),i[2]),e(r(e(t(i[1],u[0]),t(-u[1],i[0])),-s[2]),r(e(t(i[1],s[0]),t(-s[1],i[0])),u[2]))),-o[3])),e(r(e(r(e(t(o[1],u[0]),t(-u[1],o[0])),i[2]),e(r(e(t(i[1],u[0]),t(-u[1],i[0])),-o[2]),r(e(t(i[1],o[0]),t(-o[1],i[0])),u[2]))),s[3]),r(e(r(e(t(o[1],s[0]),t(-s[1],o[0])),i[2]),e(r(e(t(i[1],s[0]),t(-s[1],i[0])),-o[2]),r(e(t(i[1],o[0]),t(-o[1],i[0])),s[2]))),-u[3]))));var h=a(c,f);return h[h.length-1]}}function v(e){var t=e===3?f:e===4?h:p;return t(n,a,i,o)}var d=v(3);var m=v(4);var g=[function e(){return 0},function e(){return 0},function e(t,r){return r[0]-t[0]},function e(t,r,a){var n=(t[1]-a[1])*(r[0]-a[0]);var i=(t[0]-a[0])*(r[1]-a[1]);var o=n-i;var s;if(n>0){if(i<=0){return o}else{s=n+i}}else if(n<0){if(i>=0){return o}else{s=-(n+i)}}else{return o}var l=u*s;if(o>=l||o<=-l){return o}return d(t,r,a)},function e(t,r,a,n){var i=t[0]-n[0];var o=r[0]-n[0];var s=a[0]-n[0];var l=t[1]-n[1];var u=r[1]-n[1];var f=a[1]-n[1];var h=t[2]-n[2];var p=r[2]-n[2];var v=a[2]-n[2];var d=o*f;var g=s*u;var y=s*l;var x=i*f;var b=i*u;var _=o*l;var w=h*(d-g)+p*(y-x)+v*(b-_);var T=(Math.abs(d)+Math.abs(g))*Math.abs(h)+(Math.abs(y)+Math.abs(x))*Math.abs(p)+(Math.abs(b)+Math.abs(_))*Math.abs(v);var k=c*T;if(w>k||-w>k){return w}return m(t,r,a,n)}];function y(e){var t=g[e.length];if(!t){t=g[e.length]=v(e.length)}return t.apply(undefined,e)}function x(e,t,r,a,n,i,o){return function t(r,s,l,u,c){switch(arguments.length){case 0:case 1:return 0;case 2:return a(r,s);case 3:return n(r,s,l);case 4:return i(r,s,l,u);case 5:return o(r,s,l,u,c)}var f=new Array(arguments.length);for(var h=0;h<arguments.length;++h){f[h]=arguments[h]}return e(f)}}function b(){while(g.length<=s){g.push(v(g.length))}t.exports=x.apply(undefined,[y].concat(g));for(var e=0;e<=s;++e){t.exports[e]=g[e]}}b()},{"robust-scale":536,"robust-subtract":538,"robust-sum":539,"two-product":588}],535:[function(e,t,r){"use strict";var a=e("robust-sum");var n=e("robust-scale");t.exports=i;function i(e,t){if(e.length===1){return n(t,e[0])}if(t.length===1){return n(e,t[0])}if(e.length===0||t.length===0){return[0]}var r=[0];if(e.length<t.length){for(var i=0;i<e.length;++i){r=a(r,n(t,e[i]))}}else{for(var i=0;i<t.length;++i){r=a(r,n(e,t[i]))}}return r}},{"robust-scale":536,"robust-sum":539}],536:[function(e,t,r){"use strict";var a=e("two-product");var n=e("two-sum");t.exports=i;function i(e,t){var r=e.length;if(r===1){var i=a(e[0],t);if(i[0]){return i}return[i[1]]}var o=new Array(2*r);var s=[.1,.1];var l=[.1,.1];var u=0;a(e[0],t,s);if(s[0]){o[u++]=s[0]}for(var c=1;c<r;++c){a(e[c],t,l);var f=s[1];n(f,l[0],s);if(s[0]){o[u++]=s[0]}var h=l[1];var p=s[1];var v=h+p;var d=v-h;var m=p-d;s[1]=v;if(m){o[u++]=m}}if(s[1]){o[u++]=s[1]}if(u===0){o[u++]=0}o.length=u;return o}},{"two-product":588,"two-sum":589}],537:[function(e,t,r){"use strict";t.exports=i;var a=e("robust-orientation")[3];function n(e,t,r,a){for(var n=0;n<2;++n){var i=e[n];var o=t[n];var s=Math.min(i,o);var l=Math.max(i,o);var u=r[n];var c=a[n];var f=Math.min(u,c);var h=Math.max(u,c);if(h<s||l<f){return false}}return true}function i(e,t,r,i){var o=a(e,r,i);var s=a(t,r,i);if(o>0&&s>0||o<0&&s<0){return false}var l=a(r,e,t);var u=a(i,e,t);if(l>0&&u>0||l<0&&u<0){return false}if(o===0&&s===0&&l===0&&u===0){return n(e,t,r,i)}return true}},{"robust-orientation":534}],538:[function(e,t,r){"use strict";t.exports=n;function a(e,t){var r=e+t;var a=r-e;var n=r-a;var i=t-a;var o=e-n;var s=o+i;if(s){return[s,r]}return[r]}function n(e,t){var r=e.length|0;var n=t.length|0;if(r===1&&n===1){return a(e[0],-t[0])}var i=r+n;var o=new Array(i);var s=0;var l=0;var u=0;var c=Math.abs;var f=e[l];var h=c(f);var p=-t[u];var v=c(p);var d,m;if(h<v){m=f;l+=1;if(l<r){f=e[l];h=c(f)}}else{m=p;u+=1;if(u<n){p=-t[u];v=c(p)}}if(l<r&&h<v||u>=n){d=f;l+=1;if(l<r){f=e[l];h=c(f)}}else{d=p;u+=1;if(u<n){p=-t[u];v=c(p)}}var g=d+m;var y=g-d;var x=m-y;var b=x;var _=g;var w,T,k,M,A;while(l<r&&u<n){if(h<v){d=f;l+=1;if(l<r){f=e[l];h=c(f)}}else{d=p;u+=1;if(u<n){p=-t[u];v=c(p)}}m=b;g=d+m;y=g-d;x=m-y;if(x){o[s++]=x}w=_+g;T=w-_;k=w-T;M=g-T;A=_-k;b=A+M;_=w}while(l<r){d=f;m=b;g=d+m;y=g-d;x=m-y;if(x){o[s++]=x}w=_+g;T=w-_;k=w-T;M=g-T;A=_-k;b=A+M;_=w;l+=1;if(l<r){f=e[l]}}while(u<n){d=p;m=b;g=d+m;y=g-d;x=m-y;if(x){o[s++]=x}w=_+g;T=w-_;k=w-T;M=g-T;A=_-k;b=A+M;_=w;u+=1;if(u<n){p=-t[u]}}if(b){o[s++]=b}if(_){o[s++]=_}if(!s){o[s++]=0}o.length=s;return o}},{}],539:[function(e,t,r){"use strict";t.exports=n;function a(e,t){var r=e+t;var a=r-e;var n=r-a;var i=t-a;var o=e-n;var s=o+i;if(s){return[s,r]}return[r]}function n(e,t){var r=e.length|0;var n=t.length|0;if(r===1&&n===1){return a(e[0],t[0])}var i=r+n;var o=new Array(i);var s=0;var l=0;var u=0;var c=Math.abs;var f=e[l];var h=c(f);var p=t[u];var v=c(p);var d,m;if(h<v){m=f;l+=1;if(l<r){f=e[l];h=c(f)}}else{m=p;u+=1;if(u<n){p=t[u];v=c(p)}}if(l<r&&h<v||u>=n){d=f;l+=1;if(l<r){f=e[l];h=c(f)}}else{d=p;u+=1;if(u<n){p=t[u];v=c(p)}}var g=d+m;var y=g-d;var x=m-y;var b=x;var _=g;var w,T,k,M,A;while(l<r&&u<n){if(h<v){d=f;l+=1;if(l<r){f=e[l];h=c(f)}}else{d=p;u+=1;if(u<n){p=t[u];v=c(p)}}m=b;g=d+m;y=g-d;x=m-y;if(x){o[s++]=x}w=_+g;T=w-_;k=w-T;M=g-T;A=_-k;b=A+M;_=w}while(l<r){d=f;m=b;g=d+m;y=g-d;x=m-y;if(x){o[s++]=x}w=_+g;T=w-_;k=w-T;M=g-T;A=_-k;b=A+M;_=w;l+=1;if(l<r){f=e[l]}}while(u<n){d=p;m=b;g=d+m;y=g-d;x=m-y;if(x){o[s++]=x}w=_+g;T=w-_;k=w-T;M=g-T;A=_-k;b=A+M;_=w;u+=1;if(u<n){p=t[u]}}if(b){o[s++]=b}if(_){o[s++]=_}if(!s){o[s++]=0}o.length=s;return o}},{}],540:[function(e,t,r){var a=e("buffer");var n=a.Buffer;function i(e,t){for(var r in e){t[r]=e[r]}}if(n.from&&n.alloc&&n.allocUnsafe&&n.allocUnsafeSlow){t.exports=a}else{i(a,r);r.Buffer=o}function o(e,t,r){return n(e,t,r)}o.prototype=Object.create(n.prototype);i(n,o);o.from=function(e,t,r){if(typeof e==="number"){throw new TypeError("Argument must not be a number")}return n(e,t,r)};o.alloc=function(e,t,r){if(typeof e!=="number"){throw new TypeError("Argument must be a number")}var a=n(e);if(t!==undefined){if(typeof r==="string"){a.fill(t,r)}else{a.fill(t)}}else{a.fill(0)}return a};o.allocUnsafe=function(e){if(typeof e!=="number"){throw new TypeError("Argument must be a number")}return n(e)};o.allocUnsafeSlow=function(e){if(typeof e!=="number"){throw new TypeError("Argument must be a number")}return a.SlowBuffer(e)}},{buffer:117}],541:[function(e,t,r){"use strict";t.exports=function e(t){if(t<0){return-1}if(t>0){return 1}return 0}},{}],542:[function(e,t,r){"use strict";t.exports=i;var a=e("boundary-cells");var n=e("reduce-simplicial-complex");function i(e){return n(a(e))}},{"boundary-cells":107,"reduce-simplicial-complex":521}],543:[function(e,t,r){"use strict";t.exports=p;var a=e("ndarray");var n=e("typedarray-pool");var i=e("ndarray-sort");var o=e("./lib/codegen");function s(e){var t=e.length;var r=0;for(var a=0;a<t;++a){r=Math.max(r,e[a].length)|0}return r-1}function l(e,t){var r=e.length;var a=n.mallocUint8(r);for(var i=0;i<r;++i){a[i]=e[i]<t|0}return a}function u(e,t){var r=e.length;var o=t*(t+1)/2*r|0;var s=n.mallocUint32(o*2);var l=0;for(var u=0;u<r;++u){var c=e[u];var t=c.length;for(var f=0;f<t;++f){for(var h=0;h<f;++h){var p=c[h];var v=c[f];s[l++]=Math.min(p,v)|0;s[l++]=Math.max(p,v)|0}}}var d=l/2|0;i(a(s,[d,2]));var m=2;for(var u=2;u<l;u+=2){if(s[u-2]===s[u]&&s[u-1]===s[u+1]){continue}s[m++]=s[u];s[m++]=s[u+1]}return a(s,[m/2|0,2])}function c(e,t,r,i){var o=e.data;var s=e.shape[0];var l=n.mallocDouble(s);var u=0;for(var c=0;c<s;++c){var f=o[2*c];var h=o[2*c+1];if(r[f]===r[h]){continue}var p=t[f];var v=t[h];o[2*u]=f;o[2*u+1]=h;l[u++]=(v-i)/(v-p)}e.shape[0]=u;return a(l,[u])}function f(e,t){var r=n.mallocInt32(t*2);var a=e.shape[0];var i=e.data;r[0]=0;var o=0;for(var s=0;s<a;++s){var l=i[2*s];if(l!==o){r[2*o+1]=s;while(++o<l){r[2*o]=s;r[2*o+1]=s}r[2*o]=s}}r[2*o+1]=a;while(++o<t){r[2*o]=r[2*o+1]=a}return r}function h(e){var t=e.shape[0]|0;var r=e.data;var a=new Array(t);for(var n=0;n<t;++n){a[n]=[r[2*n],r[2*n+1]]}return a}function p(e,t,r,a){r=r||0;if(typeof a==="undefined"){a=s(e)}var i=e.length;if(i===0||a<1){return{cells:[],vertexIds:[],vertexWeights:[]}}var p=l(t,+r);var v=u(e,a);var d=c(v,t,p,+r);var m=f(v,t.length|0);var g=o(a)(e,v.data,m,p);var y=h(v);var x=[].slice.call(d.data,0,d.shape[0]);n.free(p);n.free(v.data);n.free(d.data);n.free(m);return{cells:g,vertexIds:y,vertexWeights:x}}},{"./lib/codegen":544,ndarray:472,"ndarray-sort":471,"typedarray-pool":601}],544:[function(e,t,r){"use strict";t.exports=n;var a=[function e(){function t(e,t,r,a){var n=Math.min(r,a)|0,i=Math.max(r,a)|0,o=e[2*n],s=e[2*n+1];while(o<s){var l=o+s>>1,u=t[2*l+1];if(u===i){return l}if(i<u){s=l}else{o=l+1}}return o}function r(e,t,r,a){var n=e.length,i=[];for(var o=0;o<n;++o){var s=e[o],l=s.length}return i}return r},function e(){function t(e,t,r,a){var n=Math.min(r,a)|0,i=Math.max(r,a)|0,o=e[2*n],s=e[2*n+1];while(o<s){var l=o+s>>1,u=t[2*l+1];if(u===i){return l}if(i<u){s=l}else{o=l+1}}return o}function r(e,r,a,n){var i=e.length,o=[];for(var s=0;s<i;++s){var l=e[s],u=l.length;if(u===2){var c=(n[l[0]]<<0)+(n[l[1]]<<1);if(c===0||c===3){continue}switch(c){case 0:break;case 1:o.push([t(a,r,l[0],l[1])]);break;case 2:o.push([t(a,r,l[1],l[0])]);break;case 3:break}}}return o}return r},function e(){function t(e,t,r,a){var n=Math.min(r,a)|0,i=Math.max(r,a)|0,o=e[2*n],s=e[2*n+1];while(o<s){var l=o+s>>1,u=t[2*l+1];if(u===i){return l}if(i<u){s=l}else{o=l+1}}return o}function r(e,r,a,n){var i=e.length,o=[];for(var s=0;s<i;++s){var l=e[s],u=l.length;if(u===3){var c=(n[l[0]]<<0)+(n[l[1]]<<1)+(n[l[2]]<<2);if(c===0||c===7){continue}switch(c){case 0:break;case 1:o.push([t(a,r,l[0],l[2]),t(a,r,l[0],l[1])]);break;case 2:o.push([t(a,r,l[1],l[0]),t(a,r,l[1],l[2])]);break;case 3:o.push([t(a,r,l[0],l[2]),t(a,r,l[1],l[2])]);break;case 4:o.push([t(a,r,l[2],l[1]),t(a,r,l[2],l[0])]);break;case 5:o.push([t(a,r,l[2],l[1]),t(a,r,l[0],l[1])]);break;case 6:o.push([t(a,r,l[1],l[0]),t(a,r,l[2],l[0])]);break;case 7:break}}else if(u===2){var c=(n[l[0]]<<0)+(n[l[1]]<<1);if(c===0||c===3){continue}switch(c){case 0:break;case 1:o.push([t(a,r,l[0],l[1])]);break;case 2:o.push([t(a,r,l[1],l[0])]);break;case 3:break}}}return o}return r},function e(){function t(e,t,r,a){var n=Math.min(r,a)|0,i=Math.max(r,a)|0,o=e[2*n],s=e[2*n+1];while(o<s){var l=o+s>>1,u=t[2*l+1];if(u===i){return l}if(i<u){s=l}else{o=l+1}}return o}function r(e,r,a,n){var i=e.length,o=[];for(var s=0;s<i;++s){var l=e[s],u=l.length;if(u===4){var c=(n[l[0]]<<0)+(n[l[1]]<<1)+(n[l[2]]<<2)+(n[l[3]]<<3);if(c===0||c===15){continue}switch(c){case 0:break;case 1:o.push([t(a,r,l[0],l[1]),t(a,r,l[0],l[2]),t(a,r,l[0],l[3])]);break;case 2:o.push([t(a,r,l[1],l[2]),t(a,r,l[1],l[0]),t(a,r,l[1],l[3])]);break;case 3:o.push([t(a,r,l[1],l[2]),t(a,r,l[0],l[2]),t(a,r,l[0],l[3])],[t(a,r,l[1],l[3]),t(a,r,l[1],l[2]),t(a,r,l[0],l[3])]);break;case 4:o.push([t(a,r,l[2],l[0]),t(a,r,l[2],l[1]),t(a,r,l[2],l[3])]);break;case 5:o.push([t(a,r,l[0],l[1]),t(a,r,l[2],l[1]),t(a,r,l[0],l[3])],[t(a,r,l[2],l[1]),t(a,r,l[2],l[3]),t(a,r,l[0],l[3])]);break;case 6:o.push([t(a,r,l[2],l[0]),t(a,r,l[1],l[0]),t(a,r,l[1],l[3])],[t(a,r,l[2],l[3]),t(a,r,l[2],l[0]),t(a,r,l[1],l[3])]);break;case 7:o.push([t(a,r,l[0],l[3]),t(a,r,l[1],l[3]),t(a,r,l[2],l[3])]);break;case 8:o.push([t(a,r,l[3],l[1]),t(a,r,l[3],l[0]),t(a,r,l[3],l[2])]);break;case 9:o.push([t(a,r,l[3],l[1]),t(a,r,l[0],l[1]),t(a,r,l[0],l[2])],[t(a,r,l[3],l[2]),t(a,r,l[3],l[1]),t(a,r,l[0],l[2])]);break;case 10:o.push([t(a,r,l[1],l[0]),t(a,r,l[3],l[0]),t(a,r,l[1],l[2])],[t(a,r,l[3],l[0]),t(a,r,l[3],l[2]),t(a,r,l[1],l[2])]);break;case 11:o.push([t(a,r,l[1],l[2]),t(a,r,l[0],l[2]),t(a,r,l[3],l[2])]);break;case 12:o.push([t(a,r,l[3],l[0]),t(a,r,l[2],l[0]),t(a,r,l[2],l[1])],[t(a,r,l[3],l[1]),t(a,r,l[3],l[0]),t(a,r,l[2],l[1])]);break;case 13:o.push([t(a,r,l[0],l[1]),t(a,r,l[2],l[1]),t(a,r,l[3],l[1])]);break;case 14:o.push([t(a,r,l[2],l[0]),t(a,r,l[1],l[0]),t(a,r,l[3],l[0])]);break;case 15:break}}else if(u===3){var c=(n[l[0]]<<0)+(n[l[1]]<<1)+(n[l[2]]<<2);if(c===0||c===7){continue}switch(c){case 0:break;case 1:o.push([t(a,r,l[0],l[2]),t(a,r,l[0],l[1])]);break;case 2:o.push([t(a,r,l[1],l[0]),t(a,r,l[1],l[2])]);break;case 3:o.push([t(a,r,l[0],l[2]),t(a,r,l[1],l[2])]);break;case 4:o.push([t(a,r,l[2],l[1]),t(a,r,l[2],l[0])]);break;case 5:o.push([t(a,r,l[2],l[1]),t(a,r,l[0],l[1])]);break;case 6:o.push([t(a,r,l[1],l[0]),t(a,r,l[2],l[0])]);break;case 7:break}}else if(u===2){var c=(n[l[0]]<<0)+(n[l[1]]<<1);if(c===0||c===3){continue}switch(c){case 0:break;case 1:o.push([t(a,r,l[0],l[1])]);break;case 2:o.push([t(a,r,l[1],l[0])]);break;case 3:break}}}return o}return r}];function n(e){return a[e]()}},{}],545:[function(e,t,r){"use strict";"use restrict";var a=e("bit-twiddle"),n=e("union-find");function i(e){var t=0,r=Math.max;for(var a=0,n=e.length;a<n;++a){t=r(t,e[a].length)}return t-1}r.dimension=i;function o(e){var t=-1,r=Math.max;for(var a=0,n=e.length;a<n;++a){var i=e[a];for(var o=0,s=i.length;o<s;++o){t=r(t,i[o])}}return t+1}r.countVertices=o;function s(e){var t=new Array(e.length);for(var r=0,a=e.length;r<a;++r){t[r]=e[r].slice(0)}return t}r.cloneCells=s;function l(e,t){var r=e.length,a=e.length-t.length,n=Math.min;if(a){return a}switch(r){case 0:return 0;case 1:return e[0]-t[0];case 2:var i=e[0]+e[1]-t[0]-t[1];if(i){return i}return n(e[0],e[1])-n(t[0],t[1]);case 3:var o=e[0]+e[1],s=t[0]+t[1];i=o+e[2]-(s+t[2]);if(i){return i}var l=n(e[0],e[1]),u=n(t[0],t[1]),i=n(l,e[2])-n(u,t[2]);if(i){return i}return n(l+e[2],o)-n(u+t[2],s);default:var c=e.slice(0);c.sort();var f=t.slice(0);f.sort();for(var h=0;h<r;++h){a=c[h]-f[h];if(a){return a}}return 0}}r.compareCells=l;function u(e,t){return l(e[0],t[0])}function c(e,t){if(t){var r=e.length;var a=new Array(r);for(var n=0;n<r;++n){a[n]=[e[n],t[n]]}a.sort(u);for(var n=0;n<r;++n){e[n]=a[n][0];t[n]=a[n][1]}return e}else{e.sort(l);return e}}r.normalize=c;function f(e){if(e.length===0){return[]}var t=1,r=e.length;for(var a=1;a<r;++a){var n=e[a];if(l(n,e[a-1])){if(a===t){t++;continue}e[t++]=n}}e.length=t;return e}r.unique=f;function h(e,t){var r=0,a=e.length-1,n=-1;while(r<=a){var i=r+a>>1,o=l(e[i],t);if(o<=0){if(o===0){n=i}r=i+1}else if(o>0){a=i-1}}return n}r.findCell=h;function p(e,t){var r=new Array(e.length);for(var n=0,i=r.length;n<i;++n){r[n]=[]}var o=[];for(var n=0,s=t.length;n<s;++n){var u=t[n];var c=u.length;for(var f=1,p=1<<c;f<p;++f){o.length=a.popCount(f);var v=0;for(var d=0;d<c;++d){if(f&1<<d){o[v++]=u[d]}}var m=h(e,o);if(m<0){continue}while(true){r[m++].push(n);if(m>=e.length||l(e[m],o)!==0){break}}}}return r}r.incidence=p;function v(e,t){if(!t){return p(f(m(e,0)),e,0)}var r=new Array(t);for(var a=0;a<t;++a){r[a]=[]}for(var a=0,n=e.length;a<n;++a){var i=e[a];for(var o=0,s=i.length;o<s;++o){r[i[o]].push(a)}}return r}r.dual=v;function d(e){var t=[];for(var r=0,a=e.length;r<a;++r){var n=e[r],i=n.length|0;for(var o=1,s=1<<i;o<s;++o){var l=[];for(var u=0;u<i;++u){if(o>>>u&1){l.push(n[u])}}t.push(l)}}return c(t)}r.explode=d;function m(e,t){if(t<0){return[]}var r=[],n=(1<<t+1)-1;for(var i=0;i<e.length;++i){var o=e[i];for(var s=n;s<1<<o.length;s=a.nextCombination(s)){var l=new Array(t+1),u=0;for(var f=0;f<o.length;++f){if(s&1<<f){l[u++]=o[f]}}r.push(l)}}return c(r)}r.skeleton=m;function g(e){var t=[];for(var r=0,a=e.length;r<a;++r){var n=e[r];for(var i=0,o=n.length;i<o;++i){var s=new Array(n.length-1);for(var l=0,u=0;l<o;++l){if(l!==i){s[u++]=n[l]}}t.push(s)}}return c(t)}r.boundary=g;function y(e,t){var r=new n(t);for(var a=0;a<e.length;++a){var i=e[a];for(var o=0;o<i.length;++o){for(var s=o+1;s<i.length;++s){r.link(i[o],i[s])}}}var l=[],u=r.ranks;for(var a=0;a<u.length;++a){u[a]=-1}for(var a=0;a<e.length;++a){var c=r.find(e[a][0]);if(u[c]<0){u[c]=l.length;l.push([e[a].slice(0)])}else{l[u[c]].push(e[a].slice(0))}}return l}function x(e){var t=f(c(m(e,0))),r=new n(t.length);for(var a=0;a<e.length;++a){var i=e[a];for(var o=0;o<i.length;++o){var s=h(t,[i[o]]);for(var l=o+1;l<i.length;++l){r.link(s,h(t,[i[l]]))}}}var u=[],p=r.ranks;for(var a=0;a<p.length;++a){p[a]=-1}for(var a=0;a<e.length;++a){var v=r.find(h(t,[e[a][0]]));if(p[v]<0){p[v]=u.length;u.push([e[a].slice(0)])}else{u[p[v]].push(e[a].slice(0))}}return u}function b(e,t){if(t){return y(e,t)}return x(e)}r.connectedComponents=b},{"bit-twiddle":104,"union-find":602}],546:[function(e,t,r){arguments[4][104][0].apply(r,arguments)},{dup:104}],547:[function(e,t,r){arguments[4][545][0].apply(r,arguments)},{"bit-twiddle":546,dup:545,"union-find":548}],548:[function(e,t,r){"use strict";"use restrict";t.exports=a;function a(e){this.roots=new Array(e);this.ranks=new Array(e);for(var t=0;t<e;++t){this.roots[t]=t;this.ranks[t]=0}}a.prototype.length=function(){return this.roots.length};a.prototype.makeSet=function(){var e=this.roots.length;this.roots.push(e);this.ranks.push(0);return e};a.prototype.find=function(e){var t=this.roots;while(t[e]!==e){var r=t[e];t[e]=t[r];e=r}return e};a.prototype.link=function(e,t){var r=this.find(e),a=this.find(t);if(r===a){return}var n=this.ranks,i=this.roots,o=n[r],s=n[a];if(o<s){i[r]=a}else if(s<o){i[a]=r}else{i[a]=r;++n[r]}}},{}],549:[function(e,t,r){"use strict";t.exports=o;var a=e("robust-orientation");var n=e("simplicial-complex");function i(e,t,r){var n=Math.abs(a(e,t,r));var i=Math.sqrt(Math.pow(t[0]-r[0],2)+Math.pow(t[1]-r[1],2));return n/i}function o(e,t,r){var a=t.length;var o=e.length;var s=new Array(a);var l=new Array(a);var u=new Array(a);var c=new Array(a);for(var f=0;f<a;++f){s[f]=l[f]=-1;u[f]=Infinity;c[f]=false}for(var f=0;f<o;++f){var h=e[f];if(h.length!==2){throw new Error("Input must be a graph")}var p=h[1];var v=h[0];if(l[v]!==-1){l[v]=-2}else{l[v]=p}if(s[p]!==-1){s[p]=-2}else{s[p]=v}}function d(e){if(c[e]){return Infinity}var r=s[e];var a=l[e];if(r<0||a<0){return Infinity}else{return i(t[e],t[r],t[a])}}function m(e,t){var r=k[e];var a=k[t];k[e]=a;k[t]=r;M[r]=t;M[a]=e}function g(e){return u[k[e]]}function y(e){if(e&1){return e-1>>1}return(e>>1)-1}function x(e){var t=g(e);while(true){var r=t;var a=2*e+1;var n=2*(e+1);var i=e;if(a<S){var o=g(a);if(o<r){i=a;r=o}}if(n<S){var s=g(n);if(s<r){i=n}}if(i===e){return e}m(e,i);e=i}}function b(e){var t=g(e);while(e>0){var r=y(e);if(r>=0){var a=g(r);if(t<a){m(e,r);e=r;continue}}return e}}function _(){if(S>0){var e=k[0];m(0,S-1);S-=1;x(0);return e}return-1}function w(e,t){var r=k[e];if(u[r]===t){return e}u[r]=-Infinity;b(e);_();u[r]=t;S+=1;return b(S-1)}function T(e){if(c[e]){return}c[e]=true;var t=s[e];var r=l[e];if(s[r]>=0){s[r]=t}if(l[t]>=0){l[t]=r}if(M[t]>=0){w(M[t],d(t))}if(M[r]>=0){w(M[r],d(r))}}var k=[];var M=new Array(a);for(var f=0;f<a;++f){var A=u[f]=d(f);if(A<Infinity){M[f]=k.length;k.push(f)}else{M[f]=-1}}var S=k.length;for(var f=S>>1;f>=0;--f){x(f)}while(true){var E=_();if(E<0||u[E]>r){break}T(E)}var L=[];for(var f=0;f<a;++f){if(!c[f]){M[f]=L.length;L.push(t[f].slice())}}var C=L.length;function I(e,t){if(e[t]<0){return t}var r=t;var a=t;do{var n=e[a];if(!c[a]||n<0||n===a){break}a=n;n=e[a];if(!c[a]||n<0||n===a){break}a=n;r=e[r]}while(r!==a);for(var i=t;i!==a;i=e[i]){e[i]=a}return a}var P=[];e.forEach((function(e){var t=I(s,e[0]);var r=I(l,e[1]);if(t>=0&&r>=0&&t!==r){var a=M[t];var n=M[r];if(a!==n){P.push([a,n])}}}));n.unique(n.normalize(P));return{positions:L,edges:P}}},{"robust-orientation":534,"simplicial-complex":547}],550:[function(e,t,r){"use strict";t.exports=i;var a=e("robust-orientation");function n(e,t){var r,n;if(t[0][0]<t[1][0]){r=t[0];n=t[1]}else if(t[0][0]>t[1][0]){r=t[1];n=t[0]}else{var i=Math.min(e[0][1],e[1][1]);var o=Math.max(e[0][1],e[1][1]);var s=Math.min(t[0][1],t[1][1]);var l=Math.max(t[0][1],t[1][1]);if(o<s){return o-s}if(i>l){return i-l}return o-l}var u,c;if(e[0][1]<e[1][1]){u=e[0];c=e[1]}else{u=e[1];c=e[0]}var f=a(n,r,u);if(f){return f}f=a(n,r,c);if(f){return f}return c-n}function i(e,t){var r,i;if(t[0][0]<t[1][0]){r=t[0];i=t[1]}else if(t[0][0]>t[1][0]){r=t[1];i=t[0]}else{return n(t,e)}var o,s;if(e[0][0]<e[1][0]){o=e[0];s=e[1]}else if(e[0][0]>e[1][0]){o=e[1];s=e[0]}else{return-n(e,t)}var l=a(r,i,s);var u=a(r,i,o);if(l<0){if(u<=0){return l}}else if(l>0){if(u>=0){return l}}else if(u){return u}l=a(s,o,i);u=a(s,o,r);if(l<0){if(u<=0){return l}}else if(l>0){if(u>=0){return l}}else if(u){return u}return i[0]-s[0]}},{"robust-orientation":534}],551:[function(e,t,r){"use strict";t.exports=p;var a=e("binary-search-bounds");var n=e("functional-red-black-tree");var i=e("robust-orientation");var o=e("./lib/order-segments");function s(e,t,r){this.slabs=e;this.coordinates=t;this.horizontal=r}var l=s.prototype;function u(e,t){return e.y-t}function c(e,t){var r=null;while(e){var a=e.key;var n,o;if(a[0][0]<a[1][0]){n=a[0];o=a[1]}else{n=a[1];o=a[0]}var s=i(n,o,t);if(s<0){e=e.left}else if(s>0){if(t[0]!==a[1][0]){r=e;e=e.right}else{var l=c(e.right,t);if(l){return l}e=e.left}}else{if(t[0]!==a[1][0]){return e}else{var l=c(e.right,t);if(l){return l}e=e.left}}}return r}l.castUp=function(e){var t=a.le(this.coordinates,e[0]);if(t<0){return-1}var r=this.slabs[t];var n=c(this.slabs[t],e);var s=-1;if(n){s=n.value}if(this.coordinates[t]===e[0]){var l=null;if(n){l=n.key}if(t>0){var f=c(this.slabs[t-1],e);if(f){if(l){if(o(f.key,l)>0){l=f.key;s=f.value}}else{s=f.value;l=f.key}}}var h=this.horizontal[t];if(h.length>0){var p=a.ge(h,e[1],u);if(p<h.length){var v=h[p];if(e[1]===v.y){if(v.closed){return v.index}else{while(p<h.length-1&&h[p+1].y===e[1]){p=p+1;v=h[p];if(v.closed){return v.index}}if(v.y===e[1]&&!v.start){p=p+1;if(p>=h.length){return s}v=h[p]}}}if(v.start){if(l){var d=i(l[0],l[1],[e[0],v.y]);if(l[0][0]>l[1][0]){d=-d}if(d>0){s=v.index}}else{s=v.index}}else if(v.y!==e[1]){s=v.index}}}}return s};function f(e,t,r,a){this.y=e;this.index=t;this.start=r;this.closed=a}function h(e,t,r,a){this.x=e;this.segment=t;this.create=r;this.index=a}function p(e){var t=e.length;var r=2*t;var a=new Array(r);for(var i=0;i<t;++i){var l=e[i];var u=l[0][0]<l[1][0];a[2*i]=new h(l[0][0],l,u,i);a[2*i+1]=new h(l[1][0],l,!u,i)}a.sort((function(e,t){var r=e.x-t.x;if(r){return r}r=e.create-t.create;if(r){return r}return Math.min(e.segment[0][1],e.segment[1][1])-Math.min(t.segment[0][1],t.segment[1][1])}));var c=n(o);var p=[];var v=[];var d=[];var m=-Infinity;for(var i=0;i<r;){var g=a[i].x;var y=[];while(i<r){var x=a[i];if(x.x!==g){break}i+=1;if(x.segment[0][0]===x.x&&x.segment[1][0]===x.x){if(x.create){if(x.segment[0][1]<x.segment[1][1]){y.push(new f(x.segment[0][1],x.index,true,true));y.push(new f(x.segment[1][1],x.index,false,false))}else{y.push(new f(x.segment[1][1],x.index,true,false));y.push(new f(x.segment[0][1],x.index,false,true))}}}else{if(x.create){c=c.insert(x.segment,x.index)}else{c=c.remove(x.segment)}}}p.push(c.root);v.push(g);d.push(y)}return new s(p,v,d)}},{"./lib/order-segments":550,"binary-search-bounds":103,"functional-red-black-tree":251,"robust-orientation":534}],552:[function(e,t,r){"use strict";var a=e("robust-dot-product");var n=e("robust-sum");t.exports=s;t.exports.positive=l;t.exports.negative=u;function i(e,t){var r=n(a(e,t),[t[t.length-1]]);return r[r.length-1]}function o(e,t,r,a){var n=a-t;var i=-t/n;if(i<0){i=0}else if(i>1){i=1}var o=1-i;var s=e.length;var l=new Array(s);for(var u=0;u<s;++u){l[u]=i*e[u]+o*r[u]}return l}function s(e,t){var r=[];var a=[];var n=i(e[e.length-1],t);for(var s=e[e.length-1],l=e[0],u=0;u<e.length;++u,s=l){l=e[u];var c=i(l,t);if(n<0&&c>0||n>0&&c<0){var f=o(s,c,l,n);r.push(f);a.push(f.slice())}if(c<0){a.push(l.slice())}else if(c>0){r.push(l.slice())}else{r.push(l.slice());a.push(l.slice())}n=c}return{positive:r,negative:a}}function l(e,t){var r=[];var a=i(e[e.length-1],t);for(var n=e[e.length-1],s=e[0],l=0;l<e.length;++l,n=s){s=e[l];var u=i(s,t);if(a<0&&u>0||a>0&&u<0){r.push(o(n,u,s,a))}if(u>=0){r.push(s.slice())}a=u}return r}function u(e,t){var r=[];var a=i(e[e.length-1],t);for(var n=e[e.length-1],s=e[0],l=0;l<e.length;++l,n=s){s=e[l];var u=i(s,t);if(a<0&&u>0||a>0&&u<0){r.push(o(n,u,s,a))}if(u<=0){r.push(s.slice())}a=u}return r}},{"robust-dot-product":531,"robust-sum":539}],553:[function(t,r,a){!function(){"use strict";var t={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[+-]/};function r(e){return i(s(e),arguments)}function n(e,t){return r.apply(null,[e].concat(t||[]))}function i(e,a){var n=1,i=e.length,o,s="",l,u,c,f,h,p,v,d;for(l=0;l<i;l++){if(typeof e[l]==="string"){s+=e[l]}else if(typeof e[l]==="object"){c=e[l];if(c.keys){o=a[n];for(u=0;u<c.keys.length;u++){if(o==undefined){throw new Error(r('[sprintf] Cannot access property "%s" of undefined value "%s"',c.keys[u],c.keys[u-1]))}o=o[c.keys[u]]}}else if(c.param_no){o=a[c.param_no]}else{o=a[n++]}if(t.not_type.test(c.type)&&t.not_primitive.test(c.type)&&o instanceof Function){o=o()}if(t.numeric_arg.test(c.type)&&(typeof o!=="number"&&isNaN(o))){throw new TypeError(r("[sprintf] expecting number but found %T",o))}if(t.number.test(c.type)){v=o>=0}switch(c.type){case"b":o=parseInt(o,10).toString(2);break;case"c":o=String.fromCharCode(parseInt(o,10));break;case"d":case"i":o=parseInt(o,10);break;case"j":o=JSON.stringify(o,null,c.width?parseInt(c.width):0);break;case"e":o=c.precision?parseFloat(o).toExponential(c.precision):parseFloat(o).toExponential();break;case"f":o=c.precision?parseFloat(o).toFixed(c.precision):parseFloat(o);break;case"g":o=c.precision?String(Number(o.toPrecision(c.precision))):parseFloat(o);break;case"o":o=(parseInt(o,10)>>>0).toString(8);break;case"s":o=String(o);o=c.precision?o.substring(0,c.precision):o;break;case"t":o=String(!!o);o=c.precision?o.substring(0,c.precision):o;break;case"T":o=Object.prototype.toString.call(o).slice(8,-1).toLowerCase();o=c.precision?o.substring(0,c.precision):o;break;case"u":o=parseInt(o,10)>>>0;break;case"v":o=o.valueOf();o=c.precision?o.substring(0,c.precision):o;break;case"x":o=(parseInt(o,10)>>>0).toString(16);break;case"X":o=(parseInt(o,10)>>>0).toString(16).toUpperCase();break}if(t.json.test(c.type)){s+=o}else{if(t.number.test(c.type)&&(!v||c.sign)){d=v?"+":"-";o=o.toString().replace(t.sign,"")}else{d=""}h=c.pad_char?c.pad_char==="0"?"0":c.pad_char.charAt(1):" ";p=c.width-(d+o).length;f=c.width?p>0?h.repeat(p):"":"";s+=c.align?d+o+f:h==="0"?d+f+o:f+d+o}}}return s}var o=Object.create(null);function s(e){if(o[e]){return o[e]}var r=e,a,n=[],i=0;while(r){if((a=t.text.exec(r))!==null){n.push(a[0])}else if((a=t.modulo.exec(r))!==null){n.push("%")}else if((a=t.placeholder.exec(r))!==null){if(a[2]){i|=1;var s=[],l=a[2],u=[];if((u=t.key.exec(l))!==null){s.push(u[1]);while((l=l.substring(u[0].length))!==""){if((u=t.key_access.exec(l))!==null){s.push(u[1])}else if((u=t.index_access.exec(l))!==null){s.push(u[1])}else{throw new SyntaxError("[sprintf] failed to parse named argument key")}}}else{throw new SyntaxError("[sprintf] failed to parse named argument key")}a[2]=s}else{i|=2}if(i===3){throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported")}n.push({placeholder:a[0],param_no:a[1],keys:a[2],sign:a[3],pad_char:a[4],align:a[5],width:a[6],precision:a[7],type:a[8]})}else{throw new SyntaxError("[sprintf] unexpected placeholder")}r=r.substring(a[0].length)}return o[e]=n}if(typeof a!=="undefined"){a["sprintf"]=r;a["vsprintf"]=n}if(typeof window!=="undefined"){window["sprintf"]=r;window["vsprintf"]=n;if(typeof e==="function"&&e["amd"]){e((function(){return{sprintf:r,vsprintf:n}}))}}}()},{}],554:[function(e,t,r){t.exports=i;var a=e("events").EventEmitter;var n=e("inherits");n(i,a);i.Readable=e("readable-stream/lib/_stream_readable.js");i.Writable=e("readable-stream/lib/_stream_writable.js");i.Duplex=e("readable-stream/lib/_stream_duplex.js");i.Transform=e("readable-stream/lib/_stream_transform.js");i.PassThrough=e("readable-stream/lib/_stream_passthrough.js");i.finished=e("readable-stream/lib/internal/streams/end-of-stream.js");i.pipeline=e("readable-stream/lib/internal/streams/pipeline.js");i.Stream=i;function i(){a.call(this)}i.prototype.pipe=function(e,t){var r=this;function n(t){if(e.writable){if(false===e.write(t)&&r.pause){r.pause()}}}r.on("data",n);function i(){if(r.readable&&r.resume){r.resume()}}e.on("drain",i);if(!e._isStdio&&(!t||t.end!==false)){r.on("end",s);r.on("close",l)}var o=false;function s(){if(o)return;o=true;e.end()}function l(){if(o)return;o=true;if(typeof e.destroy==="function")e.destroy()}function u(e){c();if(a.listenerCount(this,"error")===0){throw e}}r.on("error",u);e.on("error",u);function c(){r.removeListener("data",n);e.removeListener("drain",i);r.removeListener("end",s);r.removeListener("close",l);r.removeListener("error",u);e.removeListener("error",u);r.removeListener("end",c);r.removeListener("close",c);e.removeListener("close",c)}r.on("end",c);r.on("close",c);e.on("close",c);e.emit("pipe",r);return e}},{events:116,inherits:439,"readable-stream/lib/_stream_duplex.js":556,"readable-stream/lib/_stream_passthrough.js":557,"readable-stream/lib/_stream_readable.js":558,"readable-stream/lib/_stream_transform.js":559,"readable-stream/lib/_stream_writable.js":560,"readable-stream/lib/internal/streams/end-of-stream.js":564,"readable-stream/lib/internal/streams/pipeline.js":566}],555:[function(e,t,r){"use strict";function a(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;e.__proto__=t}var n={};function i(e,t,r){if(!r){r=Error}function i(e,r,a){if(typeof t==="string"){return t}else{return t(e,r,a)}}var o=function(e){a(t,e);function t(t,r,a){return e.call(this,i(t,r,a))||this}return t}(r);o.prototype.name=r.name;o.prototype.code=e;n[e]=o}function o(e,t){if(Array.isArray(e)){var r=e.length;e=e.map((function(e){return String(e)}));if(r>2){return"one of ".concat(t," ").concat(e.slice(0,r-1).join(", "),", or ")+e[r-1]}else if(r===2){return"one of ".concat(t," ").concat(e[0]," or ").concat(e[1])}else{return"of ".concat(t," ").concat(e[0])}}else{return"of ".concat(t," ").concat(String(e))}}function s(e,t,r){return e.substr(!r||r<0?0:+r,t.length)===t}function l(e,t,r){if(r===undefined||r>e.length){r=e.length}return e.substring(r-t.length,r)===t}function u(e,t,r){if(typeof r!=="number"){r=0}if(r+t.length>e.length){return false}else{return e.indexOf(t,r)!==-1}}i("ERR_INVALID_OPT_VALUE",(function(e,t){return'The value "'+t+'" is invalid for option "'+e+'"'}),TypeError);i("ERR_INVALID_ARG_TYPE",(function(e,t,r){var a;if(typeof t==="string"&&s(t,"not ")){a="must not be";t=t.replace(/^not /,"")}else{a="must be"}var n;if(l(e," argument")){n="The ".concat(e," ").concat(a," ").concat(o(t,"type"))}else{var i=u(e,".")?"property":"argument";n='The "'.concat(e,'" ').concat(i," ").concat(a," ").concat(o(t,"type"))}n+=". Received type ".concat(typeof r);return n}),TypeError);i("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF");i("ERR_METHOD_NOT_IMPLEMENTED",(function(e){return"The "+e+" method is not implemented"}));i("ERR_STREAM_PREMATURE_CLOSE","Premature close");i("ERR_STREAM_DESTROYED",(function(e){return"Cannot call "+e+" after a stream was destroyed"}));i("ERR_MULTIPLE_CALLBACK","Callback called multiple times");i("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable");i("ERR_STREAM_WRITE_AFTER_END","write after end");i("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError);i("ERR_UNKNOWN_ENCODING",(function(e){return"Unknown encoding: "+e}),TypeError);i("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event");t.exports.codes=n},{}],556:[function(e,t,r){(function(r){(function(){"use strict";var a=Object.keys||function(e){var t=[];for(var r in e){t.push(r)}return t};t.exports=u;var n=e("./_stream_readable");var i=e("./_stream_writable");e("inherits")(u,n);{var o=a(i.prototype);for(var s=0;s<o.length;s++){var l=o[s];if(!u.prototype[l])u.prototype[l]=i.prototype[l]}}function u(e){if(!(this instanceof u))return new u(e);n.call(this,e);i.call(this,e);this.allowHalfOpen=true;if(e){if(e.readable===false)this.readable=false;if(e.writable===false)this.writable=false;if(e.allowHalfOpen===false){this.allowHalfOpen=false;this.once("end",c)}}}Object.defineProperty(u.prototype,"writableHighWaterMark",{enumerable:false,get:function e(){return this._writableState.highWaterMark}});Object.defineProperty(u.prototype,"writableBuffer",{enumerable:false,get:function e(){return this._writableState&&this._writableState.getBuffer()}});Object.defineProperty(u.prototype,"writableLength",{enumerable:false,get:function e(){return this._writableState.length}});function c(){if(this._writableState.ended)return;r.nextTick(f,this)}function f(e){e.end()}Object.defineProperty(u.prototype,"destroyed",{enumerable:false,get:function e(){if(this._readableState===undefined||this._writableState===undefined){return false}return this._readableState.destroyed&&this._writableState.destroyed},set:function e(t){if(this._readableState===undefined||this._writableState===undefined){return}this._readableState.destroyed=t;this._writableState.destroyed=t}})}).call(this)}).call(this,e("_process"))},{"./_stream_readable":558,"./_stream_writable":560,_process:514,inherits:439}],557:[function(e,t,r){"use strict";t.exports=n;var a=e("./_stream_transform");e("inherits")(n,a);function n(e){if(!(this instanceof n))return new n(e);a.call(this,e)}n.prototype._transform=function(e,t,r){r(null,e)}},{"./_stream_transform":559,inherits:439}],558:[function(e,r,a){(function(t,a){(function(){"use strict";r.exports=C;var n;C.ReadableState=L;var i=e("events").EventEmitter;var o=function e(t,r){return t.listeners(r).length};var s=e("./internal/streams/stream");var l=e("buffer").Buffer;var u=a.Uint8Array||function(){};function c(e){return l.from(e)}function f(e){return l.isBuffer(e)||e instanceof u}var h=e("util");var p;if(h&&h.debuglog){p=h.debuglog("stream")}else{p=function e(){}}var v=e("./internal/streams/buffer_list");var d=e("./internal/streams/destroy");var m=e("./internal/streams/state"),g=m.getHighWaterMark;var y=e("../errors").codes,x=y.ERR_INVALID_ARG_TYPE,b=y.ERR_STREAM_PUSH_AFTER_EOF,_=y.ERR_METHOD_NOT_IMPLEMENTED,w=y.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;var T;var k;var M;e("inherits")(C,s);var A=d.errorOrDestroy;var S=["error","close","destroy","pause","resume"];function E(e,t,r){if(typeof e.prependListener==="function")return e.prependListener(t,r);if(!e._events||!e._events[t])e.on(t,r);else if(Array.isArray(e._events[t]))e._events[t].unshift(r);else e._events[t]=[r,e._events[t]]}function L(t,r,a){n=n||e("./_stream_duplex");t=t||{};if(typeof a!=="boolean")a=r instanceof n;this.objectMode=!!t.objectMode;if(a)this.objectMode=this.objectMode||!!t.readableObjectMode;this.highWaterMark=g(this,t,"readableHighWaterMark",a);this.buffer=new v;this.length=0;this.pipes=null;this.pipesCount=0;this.flowing=null;this.ended=false;this.endEmitted=false;this.reading=false;this.sync=true;this.needReadable=false;this.emittedReadable=false;this.readableListening=false;this.resumeScheduled=false;this.paused=true;this.emitClose=t.emitClose!==false;this.autoDestroy=!!t.autoDestroy;this.destroyed=false;this.defaultEncoding=t.defaultEncoding||"utf8";this.awaitDrain=0;this.readingMore=false;this.decoder=null;this.encoding=null;if(t.encoding){if(!T)T=e("string_decoder/").StringDecoder;this.decoder=new T(t.encoding);this.encoding=t.encoding}}function C(t){n=n||e("./_stream_duplex");if(!(this instanceof C))return new C(t);var r=this instanceof n;this._readableState=new L(t,this,r);this.readable=true;if(t){if(typeof t.read==="function")this._read=t.read;if(typeof t.destroy==="function")this._destroy=t.destroy}s.call(this)}Object.defineProperty(C.prototype,"destroyed",{enumerable:false,get:function e(){if(this._readableState===undefined){return false}return this._readableState.destroyed},set:function e(t){if(!this._readableState){return}this._readableState.destroyed=t}});C.prototype.destroy=d.destroy;C.prototype._undestroy=d.undestroy;C.prototype._destroy=function(e,t){t(e)};C.prototype.push=function(e,t){var r=this._readableState;var a;if(!r.objectMode){if(typeof e==="string"){t=t||r.defaultEncoding;if(t!==r.encoding){e=l.from(e,t);t=""}a=true}}else{a=true}return I(this,e,t,false,a)};C.prototype.unshift=function(e){return I(this,e,null,true,false)};function I(e,t,r,a,n){p("readableAddChunk",t);var i=e._readableState;if(t===null){i.reading=false;F(e,i)}else{var o;if(!n)o=O(i,t);if(o){A(e,o)}else if(i.objectMode||t&&t.length>0){if(typeof t!=="string"&&!i.objectMode&&Object.getPrototypeOf(t)!==l.prototype){t=c(t)}if(a){if(i.endEmitted)A(e,new w);else P(e,i,t,true)}else if(i.ended){A(e,new b)}else if(i.destroyed){return false}else{i.reading=false;if(i.decoder&&!r){t=i.decoder.write(t);if(i.objectMode||t.length!==0)P(e,i,t,false);else j(e,i)}else{P(e,i,t,false)}}}else if(!a){i.reading=false;j(e,i)}}return!i.ended&&(i.length<i.highWaterMark||i.length===0)}function P(e,t,r,a){if(t.flowing&&t.length===0&&!t.sync){t.awaitDrain=0;e.emit("data",r)}else{t.length+=t.objectMode?1:r.length;if(a)t.buffer.unshift(r);else t.buffer.push(r);if(t.needReadable)B(e)}j(e,t)}function O(e,t){var r;if(!f(t)&&typeof t!=="string"&&t!==undefined&&!e.objectMode){r=new x("chunk",["string","Buffer","Uint8Array"],t)}return r}C.prototype.isPaused=function(){return this._readableState.flowing===false};C.prototype.setEncoding=function(t){if(!T)T=e("string_decoder/").StringDecoder;var r=new T(t);this._readableState.decoder=r;this._readableState.encoding=this._readableState.decoder.encoding;var a=this._readableState.buffer.head;var n="";while(a!==null){n+=r.write(a.data);a=a.next}this._readableState.buffer.clear();if(n!=="")this._readableState.buffer.push(n);this._readableState.length=n.length;return this};var z=1073741824;function D(e){if(e>=z){e=z}else{e--;e|=e>>>1;e|=e>>>2;e|=e>>>4;e|=e>>>8;e|=e>>>16;e++}return e}function R(e,t){if(e<=0||t.length===0&&t.ended)return 0;if(t.objectMode)return 1;if(e!==e){if(t.flowing&&t.length)return t.buffer.head.data.length;else return t.length}if(e>t.highWaterMark)t.highWaterMark=D(e);if(e<=t.length)return e;if(!t.ended){t.needReadable=true;return 0}return t.length}C.prototype.read=function(e){p("read",e);e=parseInt(e,10);var t=this._readableState;var r=e;if(e!==0)t.emittedReadable=false;if(e===0&&t.needReadable&&((t.highWaterMark!==0?t.length>=t.highWaterMark:t.length>0)||t.ended)){p("read: emitReadable",t.length,t.ended);if(t.length===0&&t.ended)Z(this);else B(this);return null}e=R(e,t);if(e===0&&t.ended){if(t.length===0)Z(this);return null}var a=t.needReadable;p("need readable",a);if(t.length===0||t.length-e<t.highWaterMark){a=true;p("length less than watermark",a)}if(t.ended||t.reading){a=false;p("reading or ended",a)}else if(a){p("do read");t.reading=true;t.sync=true;if(t.length===0)t.needReadable=true;this._read(t.highWaterMark);t.sync=false;if(!t.reading)e=R(r,t)}var n;if(e>0)n=X(e,t);else n=null;if(n===null){t.needReadable=t.length<=t.highWaterMark;e=0}else{t.length-=e;t.awaitDrain=0}if(t.length===0){if(!t.ended)t.needReadable=true;if(r!==e&&t.ended)Z(this)}if(n!==null)this.emit("data",n);return n};function F(e,t){p("onEofChunk");if(t.ended)return;if(t.decoder){var r=t.decoder.end();if(r&&r.length){t.buffer.push(r);t.length+=t.objectMode?1:r.length}}t.ended=true;if(t.sync){B(e)}else{t.needReadable=false;if(!t.emittedReadable){t.emittedReadable=true;N(e)}}}function B(e){var r=e._readableState;p("emitReadable",r.needReadable,r.emittedReadable);r.needReadable=false;if(!r.emittedReadable){p("emitReadable",r.flowing);r.emittedReadable=true;t.nextTick(N,e)}}function N(e){var t=e._readableState;p("emitReadable_",t.destroyed,t.length,t.ended);if(!t.destroyed&&(t.length||t.ended)){e.emit("readable");t.emittedReadable=false}t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark;W(e)}function j(e,r){if(!r.readingMore){r.readingMore=true;t.nextTick(U,e,r)}}function U(e,t){while(!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&t.length===0)){var r=t.length;p("maybeReadMore read 0");e.read(0);if(r===t.length)break}t.readingMore=false}C.prototype._read=function(e){A(this,new _("_read()"))};C.prototype.pipe=function(e,r){var a=this;var n=this._readableState;switch(n.pipesCount){case 0:n.pipes=e;break;case 1:n.pipes=[n.pipes,e];break;default:n.pipes.push(e);break}n.pipesCount+=1;p("pipe count=%d opts=%j",n.pipesCount,r);var i=(!r||r.end!==false)&&e!==t.stdout&&e!==t.stderr;var s=i?u:y;if(n.endEmitted)t.nextTick(s);else a.once("end",s);e.on("unpipe",l);function l(e,t){p("onunpipe");if(e===a){if(t&&t.hasUnpiped===false){t.hasUnpiped=true;h()}}}function u(){p("onend");e.end()}var c=V(a);e.on("drain",c);var f=false;function h(){p("cleanup");e.removeListener("close",m);e.removeListener("finish",g);e.removeListener("drain",c);e.removeListener("error",d);e.removeListener("unpipe",l);a.removeListener("end",u);a.removeListener("end",y);a.removeListener("data",v);f=true;if(n.awaitDrain&&(!e._writableState||e._writableState.needDrain))c()}a.on("data",v);function v(t){p("ondata");var r=e.write(t);p("dest.write",r);if(r===false){if((n.pipesCount===1&&n.pipes===e||n.pipesCount>1&&K(n.pipes,e)!==-1)&&!f){p("false write response, pause",n.awaitDrain);n.awaitDrain++}a.pause()}}function d(t){p("onerror",t);y();e.removeListener("error",d);if(o(e,"error")===0)A(e,t)}E(e,"error",d);function m(){e.removeListener("finish",g);y()}e.once("close",m);function g(){p("onfinish");e.removeListener("close",m);y()}e.once("finish",g);function y(){p("unpipe");a.unpipe(e)}e.emit("pipe",a);if(!n.flowing){p("pipe resume");a.resume()}return e};function V(e){return function t(){var r=e._readableState;p("pipeOnDrain",r.awaitDrain);if(r.awaitDrain)r.awaitDrain--;if(r.awaitDrain===0&&o(e,"data")){r.flowing=true;W(e)}}}C.prototype.unpipe=function(e){var t=this._readableState;var r={hasUnpiped:false};if(t.pipesCount===0)return this;if(t.pipesCount===1){if(e&&e!==t.pipes)return this;if(!e)e=t.pipes;t.pipes=null;t.pipesCount=0;t.flowing=false;if(e)e.emit("unpipe",this,r);return this}if(!e){var a=t.pipes;var n=t.pipesCount;t.pipes=null;t.pipesCount=0;t.flowing=false;for(var i=0;i<n;i++){a[i].emit("unpipe",this,{hasUnpiped:false})}return this}var o=K(t.pipes,e);if(o===-1)return this;t.pipes.splice(o,1);t.pipesCount-=1;if(t.pipesCount===1)t.pipes=t.pipes[0];e.emit("unpipe",this,r);return this};C.prototype.on=function(e,r){var a=s.prototype.on.call(this,e,r);var n=this._readableState;if(e==="data"){n.readableListening=this.listenerCount("readable")>0;if(n.flowing!==false)this.resume()}else if(e==="readable"){if(!n.endEmitted&&!n.readableListening){n.readableListening=n.needReadable=true;n.flowing=false;n.emittedReadable=false;p("on readable",n.length,n.reading);if(n.length){B(this)}else if(!n.reading){t.nextTick(q,this)}}}return a};C.prototype.addListener=C.prototype.on;C.prototype.removeListener=function(e,r){var a=s.prototype.removeListener.call(this,e,r);if(e==="readable"){t.nextTick(H,this)}return a};C.prototype.removeAllListeners=function(e){var r=s.prototype.removeAllListeners.apply(this,arguments);if(e==="readable"||e===undefined){t.nextTick(H,this)}return r};function H(e){var t=e._readableState;t.readableListening=e.listenerCount("readable")>0;if(t.resumeScheduled&&!t.paused){t.flowing=true}else if(e.listenerCount("data")>0){e.resume()}}function q(e){p("readable nexttick read 0");e.read(0)}C.prototype.resume=function(){var e=this._readableState;if(!e.flowing){p("resume");e.flowing=!e.readableListening;G(this,e)}e.paused=false;return this};function G(e,r){if(!r.resumeScheduled){r.resumeScheduled=true;t.nextTick(Y,e,r)}}function Y(e,t){p("resume",t.reading);if(!t.reading){e.read(0)}t.resumeScheduled=false;e.emit("resume");W(e);if(t.flowing&&!t.reading)e.read(0)}C.prototype.pause=function(){p("call pause flowing=%j",this._readableState.flowing);if(this._readableState.flowing!==false){p("pause");this._readableState.flowing=false;this.emit("pause")}this._readableState.paused=true;return this};function W(e){var t=e._readableState;p("flow",t.flowing);while(t.flowing&&e.read()!==null){}}C.prototype.wrap=function(e){var t=this;var r=this._readableState;var a=false;e.on("end",(function(){p("wrapped end");if(r.decoder&&!r.ended){var e=r.decoder.end();if(e&&e.length)t.push(e)}t.push(null)}));e.on("data",(function(n){p("wrapped data");if(r.decoder)n=r.decoder.write(n);if(r.objectMode&&(n===null||n===undefined))return;else if(!r.objectMode&&(!n||!n.length))return;var i=t.push(n);if(!i){a=true;e.pause()}}));for(var n in e){if(this[n]===undefined&&typeof e[n]==="function"){this[n]=function t(r){return function t(){return e[r].apply(e,arguments)}}(n)}}for(var i=0;i<S.length;i++){e.on(S[i],this.emit.bind(this,S[i]))}this._read=function(t){p("wrapped _read",t);if(a){a=false;e.resume()}};return this};if(typeof Symbol==="function"){C.prototype[Symbol.asyncIterator]=function(){if(k===undefined){k=e("./internal/streams/async_iterator")}return k(this)}}Object.defineProperty(C.prototype,"readableHighWaterMark",{enumerable:false,get:function e(){return this._readableState.highWaterMark}});Object.defineProperty(C.prototype,"readableBuffer",{enumerable:false,get:function e(){return this._readableState&&this._readableState.buffer}});Object.defineProperty(C.prototype,"readableFlowing",{enumerable:false,get:function e(){return this._readableState.flowing},set:function e(t){if(this._readableState){this._readableState.flowing=t}}});C._fromList=X;Object.defineProperty(C.prototype,"readableLength",{enumerable:false,get:function e(){return this._readableState.length}});function X(e,t){if(t.length===0)return null;var r;if(t.objectMode)r=t.buffer.shift();else if(!e||e>=t.length){if(t.decoder)r=t.buffer.join("");else if(t.buffer.length===1)r=t.buffer.first();else r=t.buffer.concat(t.length);t.buffer.clear()}else{r=t.buffer.consume(e,t.decoder)}return r}function Z(e){var r=e._readableState;p("endReadable",r.endEmitted);if(!r.endEmitted){r.ended=true;t.nextTick(J,r,e)}}function J(e,t){p("endReadableNT",e.endEmitted,e.length);if(!e.endEmitted&&e.length===0){e.endEmitted=true;t.readable=false;t.emit("end");if(e.autoDestroy){var r=t._writableState;if(!r||r.autoDestroy&&r.finished){t.destroy()}}}}if(typeof Symbol==="function"){C.from=function(t,r){if(M===undefined){M=e("./internal/streams/from")}return M(C,t,r)}}function K(e,t){for(var r=0,a=e.length;r<a;r++){if(e[r]===t)return r}return-1}}).call(this)}).call(this,e("_process"),typeof t!=="undefined"?t:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"../errors":555,"./_stream_duplex":556,"./internal/streams/async_iterator":561,"./internal/streams/buffer_list":562,"./internal/streams/destroy":563,"./internal/streams/from":565,"./internal/streams/state":567,"./internal/streams/stream":568,_process:514,buffer:117,events:116,inherits:439,"string_decoder/":569,util:115}],559:[function(e,t,r){"use strict";t.exports=c;var a=e("../errors").codes,n=a.ERR_METHOD_NOT_IMPLEMENTED,i=a.ERR_MULTIPLE_CALLBACK,o=a.ERR_TRANSFORM_ALREADY_TRANSFORMING,s=a.ERR_TRANSFORM_WITH_LENGTH_0;var l=e("./_stream_duplex");e("inherits")(c,l);function u(e,t){var r=this._transformState;r.transforming=false;var a=r.writecb;if(a===null){return this.emit("error",new i)}r.writechunk=null;r.writecb=null;if(t!=null)this.push(t);a(e);var n=this._readableState;n.reading=false;if(n.needReadable||n.length<n.highWaterMark){this._read(n.highWaterMark)}}function c(e){if(!(this instanceof c))return new c(e);l.call(this,e);this._transformState={afterTransform:u.bind(this),needTransform:false,transforming:false,writecb:null,writechunk:null,writeencoding:null};this._readableState.needReadable=true;this._readableState.sync=false;if(e){if(typeof e.transform==="function")this._transform=e.transform;if(typeof e.flush==="function")this._flush=e.flush}this.on("prefinish",f)}function f(){var e=this;if(typeof this._flush==="function"&&!this._readableState.destroyed){this._flush((function(t,r){h(e,t,r)}))}else{h(this,null,null)}}c.prototype.push=function(e,t){this._transformState.needTransform=false;return l.prototype.push.call(this,e,t)};c.prototype._transform=function(e,t,r){r(new n("_transform()"))};c.prototype._write=function(e,t,r){var a=this._transformState;a.writecb=r;a.writechunk=e;a.writeencoding=t;if(!a.transforming){var n=this._readableState;if(a.needTransform||n.needReadable||n.length<n.highWaterMark)this._read(n.highWaterMark)}};c.prototype._read=function(e){var t=this._transformState;if(t.writechunk!==null&&!t.transforming){t.transforming=true;this._transform(t.writechunk,t.writeencoding,t.afterTransform)}else{t.needTransform=true}};c.prototype._destroy=function(e,t){l.prototype._destroy.call(this,e,(function(e){t(e)}))};function h(e,t,r){if(t)return e.emit("error",t);if(r!=null)e.push(r);if(e._writableState.length)throw new s;if(e._transformState.transforming)throw new o;return e.push(null)}},{"../errors":555,"./_stream_duplex":556,inherits:439}],560:[function(e,r,a){(function(t,a){(function(){"use strict";r.exports=L;function n(e,t,r){this.chunk=e;this.encoding=t;this.callback=r;this.next=null}function i(e){var t=this;this.next=null;this.entry=null;this.finish=function(){Y(t,e)}}var o;L.WritableState=S;var s={deprecate:e("util-deprecate")};var l=e("./internal/streams/stream");var u=e("buffer").Buffer;var c=a.Uint8Array||function(){};function f(e){return u.from(e)}function h(e){return u.isBuffer(e)||e instanceof c}var p=e("./internal/streams/destroy");var v=e("./internal/streams/state"),d=v.getHighWaterMark;var m=e("../errors").codes,g=m.ERR_INVALID_ARG_TYPE,y=m.ERR_METHOD_NOT_IMPLEMENTED,x=m.ERR_MULTIPLE_CALLBACK,b=m.ERR_STREAM_CANNOT_PIPE,_=m.ERR_STREAM_DESTROYED,w=m.ERR_STREAM_NULL_VALUES,T=m.ERR_STREAM_WRITE_AFTER_END,k=m.ERR_UNKNOWN_ENCODING;var M=p.errorOrDestroy;e("inherits")(L,l);function A(){}function S(t,r,a){o=o||e("./_stream_duplex");t=t||{};if(typeof a!=="boolean")a=r instanceof o;this.objectMode=!!t.objectMode;if(a)this.objectMode=this.objectMode||!!t.writableObjectMode;this.highWaterMark=d(this,t,"writableHighWaterMark",a);this.finalCalled=false;this.needDrain=false;this.ending=false;this.ended=false;this.finished=false;this.destroyed=false;var n=t.decodeStrings===false;this.decodeStrings=!n;this.defaultEncoding=t.defaultEncoding||"utf8";this.length=0;this.writing=false;this.corked=0;this.sync=true;this.bufferProcessing=false;this.onwrite=function(e){F(r,e)};this.writecb=null;this.writelen=0;this.bufferedRequest=null;this.lastBufferedRequest=null;this.pendingcb=0;this.prefinished=false;this.errorEmitted=false;this.emitClose=t.emitClose!==false;this.autoDestroy=!!t.autoDestroy;this.bufferedRequestCount=0;this.corkedRequestsFree=new i(this)}S.prototype.getBuffer=function e(){var t=this.bufferedRequest;var r=[];while(t){r.push(t);t=t.next}return r};(function(){try{Object.defineProperty(S.prototype,"buffer",{get:s.deprecate((function e(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer "+"instead.","DEP0003")})}catch(e){}})();var E;if(typeof Symbol==="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]==="function"){E=Function.prototype[Symbol.hasInstance];Object.defineProperty(L,Symbol.hasInstance,{value:function e(t){if(E.call(this,t))return true;if(this!==L)return false;return t&&t._writableState instanceof S}})}else{E=function e(t){return t instanceof this}}function L(t){o=o||e("./_stream_duplex");var r=this instanceof o;if(!r&&!E.call(L,this))return new L(t);this._writableState=new S(t,this,r);this.writable=true;if(t){if(typeof t.write==="function")this._write=t.write;if(typeof t.writev==="function")this._writev=t.writev;if(typeof t.destroy==="function")this._destroy=t.destroy;if(typeof t.final==="function")this._final=t.final}l.call(this)}L.prototype.pipe=function(){M(this,new b)};function C(e,r){var a=new T;M(e,a);t.nextTick(r,a)}function I(e,r,a,n){var i;if(a===null){i=new w}else if(typeof a!=="string"&&!r.objectMode){i=new g("chunk",["string","Buffer"],a)}if(i){M(e,i);t.nextTick(n,i);return false}return true}L.prototype.write=function(e,t,r){var a=this._writableState;var n=false;var i=!a.objectMode&&h(e);if(i&&!u.isBuffer(e)){e=f(e)}if(typeof t==="function"){r=t;t=null}if(i)t="buffer";else if(!t)t=a.defaultEncoding;if(typeof r!=="function")r=A;if(a.ending)C(this,r);else if(i||I(this,a,e,r)){a.pendingcb++;n=O(this,a,i,e,t,r)}return n};L.prototype.cork=function(){this._writableState.corked++};L.prototype.uncork=function(){var e=this._writableState;if(e.corked){e.corked--;if(!e.writing&&!e.corked&&!e.bufferProcessing&&e.bufferedRequest)j(this,e)}};L.prototype.setDefaultEncoding=function e(t){if(typeof t==="string")t=t.toLowerCase();if(!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((t+"").toLowerCase())>-1))throw new k(t);this._writableState.defaultEncoding=t;return this};Object.defineProperty(L.prototype,"writableBuffer",{enumerable:false,get:function e(){return this._writableState&&this._writableState.getBuffer()}});function P(e,t,r){if(!e.objectMode&&e.decodeStrings!==false&&typeof t==="string"){t=u.from(t,r)}return t}Object.defineProperty(L.prototype,"writableHighWaterMark",{enumerable:false,get:function e(){return this._writableState.highWaterMark}});function O(e,t,r,a,n,i){if(!r){var o=P(t,a,n);if(a!==o){r=true;n="buffer";a=o}}var s=t.objectMode?1:a.length;t.length+=s;var l=t.length<t.highWaterMark;if(!l)t.needDrain=true;if(t.writing||t.corked){var u=t.lastBufferedRequest;t.lastBufferedRequest={chunk:a,encoding:n,isBuf:r,callback:i,next:null};if(u){u.next=t.lastBufferedRequest}else{t.bufferedRequest=t.lastBufferedRequest}t.bufferedRequestCount+=1}else{z(e,t,false,s,a,n,i)}return l}function z(e,t,r,a,n,i,o){t.writelen=a;t.writecb=o;t.writing=true;t.sync=true;if(t.destroyed)t.onwrite(new _("write"));else if(r)e._writev(n,t.onwrite);else e._write(n,i,t.onwrite);t.sync=false}function D(e,r,a,n,i){--r.pendingcb;if(a){t.nextTick(i,n);t.nextTick(q,e,r);e._writableState.errorEmitted=true;M(e,n)}else{i(n);e._writableState.errorEmitted=true;M(e,n);q(e,r)}}function R(e){e.writing=false;e.writecb=null;e.length-=e.writelen;e.writelen=0}function F(e,r){var a=e._writableState;var n=a.sync;var i=a.writecb;if(typeof i!=="function")throw new x;R(a);if(r)D(e,a,n,r,i);else{var o=U(a)||e.destroyed;if(!o&&!a.corked&&!a.bufferProcessing&&a.bufferedRequest){j(e,a)}if(n){t.nextTick(B,e,a,o,i)}else{B(e,a,o,i)}}}function B(e,t,r,a){if(!r)N(e,t);t.pendingcb--;a();q(e,t)}function N(e,t){if(t.length===0&&t.needDrain){t.needDrain=false;e.emit("drain")}}function j(e,t){t.bufferProcessing=true;var r=t.bufferedRequest;if(e._writev&&r&&r.next){var a=t.bufferedRequestCount;var n=new Array(a);var o=t.corkedRequestsFree;o.entry=r;var s=0;var l=true;while(r){n[s]=r;if(!r.isBuf)l=false;r=r.next;s+=1}n.allBuffers=l;z(e,t,true,t.length,n,"",o.finish);t.pendingcb++;t.lastBufferedRequest=null;if(o.next){t.corkedRequestsFree=o.next;o.next=null}else{t.corkedRequestsFree=new i(t)}t.bufferedRequestCount=0}else{while(r){var u=r.chunk;var c=r.encoding;var f=r.callback;var h=t.objectMode?1:u.length;z(e,t,false,h,u,c,f);r=r.next;t.bufferedRequestCount--;if(t.writing){break}}if(r===null)t.lastBufferedRequest=null}t.bufferedRequest=r;t.bufferProcessing=false}L.prototype._write=function(e,t,r){r(new y("_write()"))};L.prototype._writev=null;L.prototype.end=function(e,t,r){var a=this._writableState;if(typeof e==="function"){r=e;e=null;t=null}else if(typeof t==="function"){r=t;t=null}if(e!==null&&e!==undefined)this.write(e,t);if(a.corked){a.corked=1;this.uncork()}if(!a.ending)G(this,a,r);return this};Object.defineProperty(L.prototype,"writableLength",{enumerable:false,get:function e(){return this._writableState.length}});function U(e){return e.ending&&e.length===0&&e.bufferedRequest===null&&!e.finished&&!e.writing}function V(e,t){e._final((function(r){t.pendingcb--;if(r){M(e,r)}t.prefinished=true;e.emit("prefinish");q(e,t)}))}function H(e,r){if(!r.prefinished&&!r.finalCalled){if(typeof e._final==="function"&&!r.destroyed){r.pendingcb++;r.finalCalled=true;t.nextTick(V,e,r)}else{r.prefinished=true;e.emit("prefinish")}}}function q(e,t){var r=U(t);if(r){H(e,t);if(t.pendingcb===0){t.finished=true;e.emit("finish");if(t.autoDestroy){var a=e._readableState;if(!a||a.autoDestroy&&a.endEmitted){e.destroy()}}}}return r}function G(e,r,a){r.ending=true;q(e,r);if(a){if(r.finished)t.nextTick(a);else e.once("finish",a)}r.ended=true;e.writable=false}function Y(e,t,r){var a=e.entry;e.entry=null;while(a){var n=a.callback;t.pendingcb--;n(r);a=a.next}t.corkedRequestsFree.next=e}Object.defineProperty(L.prototype,"destroyed",{enumerable:false,get:function e(){if(this._writableState===undefined){return false}return this._writableState.destroyed},set:function e(t){if(!this._writableState){return}this._writableState.destroyed=t}});L.prototype.destroy=p.destroy;L.prototype._undestroy=p.undestroy;L.prototype._destroy=function(e,t){t(e)}}).call(this)}).call(this,e("_process"),typeof t!=="undefined"?t:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"../errors":555,"./_stream_duplex":556,"./internal/streams/destroy":563,"./internal/streams/state":567,"./internal/streams/stream":568,_process:514,buffer:117,inherits:439,"util-deprecate":606}],561:[function(e,t,r){(function(r){(function(){"use strict";var a;function n(e,t,r){if(t in e){Object.defineProperty(e,t,{value:r,enumerable:true,configurable:true,writable:true})}else{e[t]=r}return e}var i=e("./end-of-stream");var o=Symbol("lastResolve");var s=Symbol("lastReject");var l=Symbol("error");var u=Symbol("ended");var c=Symbol("lastPromise");var f=Symbol("handlePromise");var h=Symbol("stream");function p(e,t){return{value:e,done:t}}function v(e){var t=e[o];if(t!==null){var r=e[h].read();if(r!==null){e[c]=null;e[o]=null;e[s]=null;t(p(r,false))}}}function d(e){r.nextTick(v,e)}function m(e,t){return function(r,a){e.then((function(){if(t[u]){r(p(undefined,true));return}t[f](r,a)}),a)}}var g=Object.getPrototypeOf((function(){}));var y=Object.setPrototypeOf((a={get stream(){return this[h]},next:function e(){var t=this;var a=this[l];if(a!==null){return Promise.reject(a)}if(this[u]){return Promise.resolve(p(undefined,true))}if(this[h].destroyed){return new Promise((function(e,a){r.nextTick((function(){if(t[l]){a(t[l])}else{e(p(undefined,true))}}))}))}var n=this[c];var i;if(n){i=new Promise(m(n,this))}else{var o=this[h].read();if(o!==null){return Promise.resolve(p(o,false))}i=new Promise(this[f])}this[c]=i;return i}},n(a,Symbol.asyncIterator,(function(){return this})),n(a,"return",(function e(){var t=this;return new Promise((function(e,r){t[h].destroy(null,(function(t){if(t){r(t);return}e(p(undefined,true))}))}))})),a),g);var x=function e(t){var r;var a=Object.create(y,(r={},n(r,h,{value:t,writable:true}),n(r,o,{value:null,writable:true}),n(r,s,{value:null,writable:true}),n(r,l,{value:null,writable:true}),n(r,u,{value:t._readableState.endEmitted,writable:true}),n(r,f,{value:function e(t,r){var n=a[h].read();if(n){a[c]=null;a[o]=null;a[s]=null;t(p(n,false))}else{a[o]=t;a[s]=r}},writable:true}),r));a[c]=null;i(t,(function(e){if(e&&e.code!=="ERR_STREAM_PREMATURE_CLOSE"){var t=a[s];if(t!==null){a[c]=null;a[o]=null;a[s]=null;t(e)}a[l]=e;return}var r=a[o];if(r!==null){a[c]=null;a[o]=null;a[s]=null;r(p(undefined,true))}a[u]=true}));t.on("readable",d.bind(null,a));return a};t.exports=x}).call(this)}).call(this,e("_process"))},{"./end-of-stream":564,_process:514}],562:[function(e,t,r){"use strict";function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);if(t)a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}));r.push.apply(r,a)}return r}function n(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};if(t%2){a(Object(r),true).forEach((function(t){i(e,t,r[t])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(e,Object.getOwnPropertyDescriptors(r))}else{a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}}return e}function i(e,t,r){if(t in e){Object.defineProperty(e,t,{value:r,enumerable:true,configurable:true,writable:true})}else{e[t]=r}return e}function o(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function s(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||false;a.configurable=true;if("value"in a)a.writable=true;Object.defineProperty(e,a.key,a)}}function l(e,t,r){if(t)s(e.prototype,t);if(r)s(e,r);return e}var u=e("buffer"),c=u.Buffer;var f=e("util"),h=f.inspect;var p=h&&h.custom||"inspect";function v(e,t,r){c.prototype.copy.call(e,t,r)}t.exports=function(){function e(){o(this,e);this.head=null;this.tail=null;this.length=0}l(e,[{key:"push",value:function e(t){var r={data:t,next:null};if(this.length>0)this.tail.next=r;else this.head=r;this.tail=r;++this.length}},{key:"unshift",value:function e(t){var r={data:t,next:this.head};if(this.length===0)this.tail=r;this.head=r;++this.length}},{key:"shift",value:function e(){if(this.length===0)return;var t=this.head.data;if(this.length===1)this.head=this.tail=null;else this.head=this.head.next;--this.length;return t}},{key:"clear",value:function e(){this.head=this.tail=null;this.length=0}},{key:"join",value:function e(t){if(this.length===0)return"";var r=this.head;var a=""+r.data;while(r=r.next){a+=t+r.data}return a}},{key:"concat",value:function e(t){if(this.length===0)return c.alloc(0);var r=c.allocUnsafe(t>>>0);var a=this.head;var n=0;while(a){v(a.data,r,n);n+=a.data.length;a=a.next}return r}},{key:"consume",value:function e(t,r){var a;if(t<this.head.data.length){a=this.head.data.slice(0,t);this.head.data=this.head.data.slice(t)}else if(t===this.head.data.length){a=this.shift()}else{a=r?this._getString(t):this._getBuffer(t)}return a}},{key:"first",value:function e(){return this.head.data}},{key:"_getString",value:function e(t){var r=this.head;var a=1;var n=r.data;t-=n.length;while(r=r.next){var i=r.data;var o=t>i.length?i.length:t;if(o===i.length)n+=i;else n+=i.slice(0,t);t-=o;if(t===0){if(o===i.length){++a;if(r.next)this.head=r.next;else this.head=this.tail=null}else{this.head=r;r.data=i.slice(o)}break}++a}this.length-=a;return n}},{key:"_getBuffer",value:function e(t){var r=c.allocUnsafe(t);var a=this.head;var n=1;a.data.copy(r);t-=a.data.length;while(a=a.next){var i=a.data;var o=t>i.length?i.length:t;i.copy(r,r.length-t,0,o);t-=o;if(t===0){if(o===i.length){++n;if(a.next)this.head=a.next;else this.head=this.tail=null}else{this.head=a;a.data=i.slice(o)}break}++n}this.length-=n;return r}},{key:p,value:function e(t,r){return h(this,n({},r,{depth:0,customInspect:false}))}}]);return e}()},{buffer:117,util:115}],563:[function(e,t,r){(function(e){(function(){"use strict";function r(t,r){var i=this;var s=this._readableState&&this._readableState.destroyed;var l=this._writableState&&this._writableState.destroyed;if(s||l){if(r){r(t)}else if(t){if(!this._writableState){e.nextTick(o,this,t)}else if(!this._writableState.errorEmitted){this._writableState.errorEmitted=true;e.nextTick(o,this,t)}}return this}if(this._readableState){this._readableState.destroyed=true}if(this._writableState){this._writableState.destroyed=true}this._destroy(t||null,(function(t){if(!r&&t){if(!i._writableState){e.nextTick(a,i,t)}else if(!i._writableState.errorEmitted){i._writableState.errorEmitted=true;e.nextTick(a,i,t)}else{e.nextTick(n,i)}}else if(r){e.nextTick(n,i);r(t)}else{e.nextTick(n,i)}}));return this}function a(e,t){o(e,t);n(e)}function n(e){if(e._writableState&&!e._writableState.emitClose)return;if(e._readableState&&!e._readableState.emitClose)return;e.emit("close")}function i(){if(this._readableState){this._readableState.destroyed=false;this._readableState.reading=false;this._readableState.ended=false;this._readableState.endEmitted=false}if(this._writableState){this._writableState.destroyed=false;this._writableState.ended=false;this._writableState.ending=false;this._writableState.finalCalled=false;this._writableState.prefinished=false;this._writableState.finished=false;this._writableState.errorEmitted=false}}function o(e,t){e.emit("error",t)}function s(e,t){var r=e._readableState;var a=e._writableState;if(r&&r.autoDestroy||a&&a.autoDestroy)e.destroy(t);else e.emit("error",t)}t.exports={destroy:r,undestroy:i,errorOrDestroy:s}}).call(this)}).call(this,e("_process"))},{_process:514}],564:[function(e,t,r){"use strict";var a=e("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function n(e){var t=false;return function(){if(t)return;t=true;for(var r=arguments.length,a=new Array(r),n=0;n<r;n++){a[n]=arguments[n]}e.apply(this,a)}}function i(){}function o(e){return e.setHeader&&typeof e.abort==="function"}function s(e,t,r){if(typeof t==="function")return s(e,null,t);if(!t)t={};r=n(r||i);var l=t.readable||t.readable!==false&&e.readable;var u=t.writable||t.writable!==false&&e.writable;var c=function t(){if(!e.writable)h()};var f=e._writableState&&e._writableState.finished;var h=function t(){u=false;f=true;if(!l)r.call(e)};var p=e._readableState&&e._readableState.endEmitted;var v=function t(){l=false;p=true;if(!u)r.call(e)};var d=function t(a){r.call(e,a)};var m=function t(){var n;if(l&&!p){if(!e._readableState||!e._readableState.ended)n=new a;return r.call(e,n)}if(u&&!f){if(!e._writableState||!e._writableState.ended)n=new a;return r.call(e,n)}};var g=function t(){e.req.on("finish",h)};if(o(e)){e.on("complete",h);e.on("abort",m);if(e.req)g();else e.on("request",g)}else if(u&&!e._writableState){e.on("end",c);e.on("close",c)}e.on("end",v);e.on("finish",h);if(t.error!==false)e.on("error",d);e.on("close",m);return function(){e.removeListener("complete",h);e.removeListener("abort",m);e.removeListener("request",g);if(e.req)e.req.removeListener("finish",h);e.removeListener("end",c);e.removeListener("close",c);e.removeListener("finish",h);e.removeListener("end",v);e.removeListener("error",d);e.removeListener("close",m)}}t.exports=s},{"../../../errors":555}],565:[function(e,t,r){t.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],566:[function(e,t,r){"use strict";var a;function n(e){var t=false;return function(){if(t)return;t=true;e.apply(void 0,arguments)}}var i=e("../../../errors").codes,o=i.ERR_MISSING_ARGS,s=i.ERR_STREAM_DESTROYED;function l(e){if(e)throw e}function u(e){return e.setHeader&&typeof e.abort==="function"}function c(t,r,i,o){o=n(o);var l=false;t.on("close",(function(){l=true}));if(a===undefined)a=e("./end-of-stream");a(t,{readable:r,writable:i},(function(e){if(e)return o(e);l=true;o()}));var c=false;return function(e){if(l)return;if(c)return;c=true;if(u(t))return t.abort();if(typeof t.destroy==="function")return t.destroy();o(e||new s("pipe"))}}function f(e){e()}function h(e,t){return e.pipe(t)}function p(e){if(!e.length)return l;if(typeof e[e.length-1]!=="function")return l;return e.pop()}function v(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++){t[r]=arguments[r]}var a=p(t);if(Array.isArray(t[0]))t=t[0];if(t.length<2){throw new o("streams")}var n;var i=t.map((function(e,r){var o=r<t.length-1;var s=r>0;return c(e,o,s,(function(e){if(!n)n=e;if(e)i.forEach(f);if(o)return;i.forEach(f);a(n)}))}));return t.reduce(h)}t.exports=v},{"../../../errors":555,"./end-of-stream":564}],567:[function(e,t,r){"use strict";var a=e("../../../errors").codes.ERR_INVALID_OPT_VALUE;function n(e,t,r){return e.highWaterMark!=null?e.highWaterMark:t?e[r]:null}function i(e,t,r,i){var o=n(t,i,r);if(o!=null){if(!(isFinite(o)&&Math.floor(o)===o)||o<0){var s=i?r:"highWaterMark";throw new a(s,o)}return Math.floor(o)}return e.objectMode?16:16*1024}t.exports={getHighWaterMark:i}},{"../../../errors":555}],568:[function(e,t,r){t.exports=e("events").EventEmitter},{events:116}],569:[function(e,t,r){"use strict";var a=e("safe-buffer").Buffer;var n=a.isEncoding||function(e){e=""+e;switch(e&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return true;default:return false}};function i(e){if(!e)return"utf8";var t;while(true){switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase();t=true}}}function o(e){var t=i(e);if(typeof t!=="string"&&(a.isEncoding===n||!n(e)))throw new Error("Unknown encoding: "+e);return t||e}r.StringDecoder=s;function s(e){this.encoding=o(e);var t;switch(this.encoding){case"utf16le":this.text=v;this.end=d;t=4;break;case"utf8":this.fillLast=f;t=4;break;case"base64":this.text=m;this.end=g;t=3;break;default:this.write=y;this.end=x;return}this.lastNeed=0;this.lastTotal=0;this.lastChar=a.allocUnsafe(t)}s.prototype.write=function(e){if(e.length===0)return"";var t;var r;if(this.lastNeed){t=this.fillLast(e);if(t===undefined)return"";r=this.lastNeed;this.lastNeed=0}else{r=0}if(r<e.length)return t?t+this.text(e,r):this.text(e,r);return t||""};s.prototype.end=p;s.prototype.text=h;s.prototype.fillLast=function(e){if(this.lastNeed<=e.length){e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed);return this.lastChar.toString(this.encoding,0,this.lastTotal)}e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length);this.lastNeed-=e.length};function l(e){if(e<=127)return 0;else if(e>>5===6)return 2;else if(e>>4===14)return 3;else if(e>>3===30)return 4;return e>>6===2?-1:-2}function u(e,t,r){var a=t.length-1;if(a<r)return 0;var n=l(t[a]);if(n>=0){if(n>0)e.lastNeed=n-1;return n}if(--a<r||n===-2)return 0;n=l(t[a]);if(n>=0){if(n>0)e.lastNeed=n-2;return n}if(--a<r||n===-2)return 0;n=l(t[a]);if(n>=0){if(n>0){if(n===2)n=0;else e.lastNeed=n-3}return n}return 0}function c(e,t,r){if((t[0]&192)!==128){e.lastNeed=0;return"�"}if(e.lastNeed>1&&t.length>1){if((t[1]&192)!==128){e.lastNeed=1;return"�"}if(e.lastNeed>2&&t.length>2){if((t[2]&192)!==128){e.lastNeed=2;return"�"}}}}function f(e){var t=this.lastTotal-this.lastNeed;var r=c(this,e,t);if(r!==undefined)return r;if(this.lastNeed<=e.length){e.copy(this.lastChar,t,0,this.lastNeed);return this.lastChar.toString(this.encoding,0,this.lastTotal)}e.copy(this.lastChar,t,0,e.length);this.lastNeed-=e.length}function h(e,t){var r=u(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=r;var a=e.length-(r-this.lastNeed);e.copy(this.lastChar,0,a);return e.toString("utf8",t,a)}function p(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed)return t+"�";return t}function v(e,t){if((e.length-t)%2===0){var r=e.toString("utf16le",t);if(r){var a=r.charCodeAt(r.length-1);if(a>=55296&&a<=56319){this.lastNeed=2;this.lastTotal=4;this.lastChar[0]=e[e.length-2];this.lastChar[1]=e[e.length-1];return r.slice(0,-1)}}return r}this.lastNeed=1;this.lastTotal=2;this.lastChar[0]=e[e.length-1];return e.toString("utf16le",t,e.length-1)}function d(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var r=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,r)}return t}function m(e,t){var r=(e.length-t)%3;if(r===0)return e.toString("base64",t);this.lastNeed=3-r;this.lastTotal=3;if(r===1){this.lastChar[0]=e[e.length-1]}else{this.lastChar[0]=e[e.length-2];this.lastChar[1]=e[e.length-1]}return e.toString("base64",t,e.length-r)}function g(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed)return t+this.lastChar.toString("base64",0,3-this.lastNeed);return t}function y(e){return e.toString(this.encoding)}function x(e){return e&&e.length?this.write(e):""}},{"safe-buffer":540}],570:[function(e,t,r){(function(r,a){(function(){var r=e("assert");var n=e("debug")("stream-parser");t.exports=u;var i=-1;var o=0;var s=1;var l=2;function u(e){var t=e&&"function"==typeof e._transform;var r=e&&"function"==typeof e._write;if(!t&&!r)throw new Error("must pass a Writable or Transform stream in");n("extending Parser into stream");e._bytes=f;e._skipBytes=h;if(t)e._passthrough=p;if(t){e._transform=d}else{e._write=v}}function c(e){n("initializing parser stream");e._parserBytesLeft=0;e._parserBuffers=[];e._parserBuffered=0;e._parserState=i;e._parserCallback=null;if("function"==typeof e.push){e._parserOutput=e.push.bind(e)}e._parserInit=true}function f(e,t){r(!this._parserCallback,'there is already a "callback" set!');r(isFinite(e)&&e>0,'can only buffer a finite number of bytes > 0, got "'+e+'"');if(!this._parserInit)c(this);n("buffering %o bytes",e);this._parserBytesLeft=e;this._parserCallback=t;this._parserState=o}function h(e,t){r(!this._parserCallback,'there is already a "callback" set!');r(e>0,'can only skip > 0 bytes, got "'+e+'"');if(!this._parserInit)c(this);n("skipping %o bytes",e);this._parserBytesLeft=e;this._parserCallback=t;this._parserState=s}function p(e,t){r(!this._parserCallback,'There is already a "callback" set!');r(e>0,'can only pass through > 0 bytes, got "'+e+'"');if(!this._parserInit)c(this);n("passing through %o bytes",e);this._parserBytesLeft=e;this._parserCallback=t;this._parserState=l}function v(e,t,r){if(!this._parserInit)c(this);n("write(%o bytes)",e.length);if("function"==typeof t)r=t;y(this,e,null,r)}function d(e,t,r){if(!this._parserInit)c(this);n("transform(%o bytes)",e.length);if("function"!=typeof t){t=this._parserOutput}y(this,e,t,r)}function m(e,t,r,a){if(e._parserBytesLeft<=0){return a(new Error("got data but not currently parsing anything"))}if(t.length<=e._parserBytesLeft){return function(){return g(e,t,r,a)}}else{return function(){var n=t.slice(0,e._parserBytesLeft);return g(e,n,r,(function(i){if(i)return a(i);if(t.length>n.length){return function(){return m(e,t.slice(n.length),r,a)}}}))}}}function g(e,t,r,s){e._parserBytesLeft-=t.length;n("%o bytes left for stream piece",e._parserBytesLeft);if(e._parserState===o){e._parserBuffers.push(t);e._parserBuffered+=t.length}else if(e._parserState===l){r(t)}if(0===e._parserBytesLeft){var u=e._parserCallback;if(u&&e._parserState===o&&e._parserBuffers.length>1){t=a.concat(e._parserBuffers,e._parserBuffered)}if(e._parserState!==o){t=null}e._parserCallback=null;e._parserBuffered=0;e._parserState=i;e._parserBuffers.splice(0);if(u){var c=[];if(t){c.push(t)}else{}if(r){c.push(r)}var f=u.length>c.length;if(f){c.push(x(s))}var h=u.apply(e,c);if(!f||s===h)return s}}else{return s}}var y=x(m);function x(e){return function(){var t=e.apply(this,arguments);while("function"==typeof t){t=t()}return t}}}).call(this)}).call(this,e("_process"),e("buffer").Buffer)},{_process:514,assert:80,buffer:117,debug:571}],571:[function(e,t,r){(function(a){(function(){r=t.exports=e("./debug");r.log=o;r.formatArgs=i;r.save=s;r.load=l;r.useColors=n;r.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:u();r.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"];function n(){if(typeof window!=="undefined"&&window.process&&window.process.type==="renderer"){return true}return typeof document!=="undefined"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window!=="undefined"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator!=="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator!=="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}r.formatters.j=function(e){try{return JSON.stringify(e)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}};function i(e){var t=this.useColors;e[0]=(t?"%c":"")+this.namespace+(t?" %c":" ")+e[0]+(t?"%c ":" ")+"+"+r.humanize(this.diff);if(!t)return;var a="color: "+this.color;e.splice(1,0,a,"color: inherit");var n=0;var i=0;e[0].replace(/%[a-zA-Z%]/g,(function(e){if("%%"===e)return;n++;if("%c"===e){i=n}}));e.splice(i,0,a)}function o(){return"object"===typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function s(e){try{if(null==e){r.storage.removeItem("debug")}else{r.storage.debug=e}}catch(t){}}function l(){var e;try{e=r.storage.debug}catch(t){}if(!e&&typeof a!=="undefined"&&"env"in a){e=a.env.DEBUG}return e}r.enable(l());function u(){try{return window.localStorage}catch(e){}}}).call(this)}).call(this,e("_process"))},{"./debug":572,_process:514}],572:[function(e,t,r){r=t.exports=i.debug=i["default"]=i;r.coerce=u;r.disable=s;r.enable=o;r.enabled=l;r.humanize=e("ms");r.names=[];r.skips=[];r.formatters={};var a;function n(e){var t=0,a;for(a in e){t=(t<<5)-t+e.charCodeAt(a);t|=0}return r.colors[Math.abs(t)%r.colors.length]}function i(e){function t(){if(!t.enabled)return;var e=t;var n=+new Date;var i=n-(a||n);e.diff=i;e.prev=a;e.curr=n;a=n;var o=new Array(arguments.length);for(var s=0;s<o.length;s++){o[s]=arguments[s]}o[0]=r.coerce(o[0]);if("string"!==typeof o[0]){o.unshift("%O")}var l=0;o[0]=o[0].replace(/%([a-zA-Z%])/g,(function(t,a){if(t==="%%")return t;l++;var n=r.formatters[a];if("function"===typeof n){var i=o[l];t=n.call(e,i);o.splice(l,1);l--}return t}));r.formatArgs.call(e,o);var u=t.log||r.log||console.log.bind(console);u.apply(e,o)}t.namespace=e;t.enabled=r.enabled(e);t.useColors=r.useColors();t.color=n(e);if("function"===typeof r.init){r.init(t)}return t}function o(e){r.save(e);r.names=[];r.skips=[];var t=(typeof e==="string"?e:"").split(/[\s,]+/);var a=t.length;for(var n=0;n<a;n++){if(!t[n])continue;e=t[n].replace(/\*/g,".*?");if(e[0]==="-"){r.skips.push(new RegExp("^"+e.substr(1)+"$"))}else{r.names.push(new RegExp("^"+e+"$"))}}}function s(){r.enable("")}function l(e){var t,a;for(t=0,a=r.skips.length;t<a;t++){if(r.skips[t].test(e)){return false}}for(t=0,a=r.names.length;t<a;t++){if(r.names[t].test(e)){return true}}return false}function u(e){if(e instanceof Error)return e.stack||e.message;return e}},{ms:573}],573:[function(e,t,r){var a=1e3;var n=a*60;var i=n*60;var o=i*24;var s=o*365.25;t.exports=function(e,t){t=t||{};var r=typeof e;if(r==="string"&&e.length>0){return l(e)}else if(r==="number"&&isNaN(e)===false){return t.long?c(e):u(e)}throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))};function l(e){e=String(e);if(e.length>100){return}var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(!t){return}var r=parseFloat(t[1]);var l=(t[2]||"ms").toLowerCase();switch(l){case"years":case"year":case"yrs":case"yr":case"y":return r*s;case"days":case"day":case"d":return r*o;case"hours":case"hour":case"hrs":case"hr":case"h":return r*i;case"minutes":case"minute":case"mins":case"min":case"m":return r*n;case"seconds":case"second":case"secs":case"sec":case"s":return r*a;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return undefined}}function u(e){if(e>=o){return Math.round(e/o)+"d"}if(e>=i){return Math.round(e/i)+"h"}if(e>=n){return Math.round(e/n)+"m"}if(e>=a){return Math.round(e/a)+"s"}return e+"ms"}function c(e){return f(e,o,"day")||f(e,i,"hour")||f(e,n,"minute")||f(e,a,"second")||e+" ms"}function f(e,t,r){if(e<t){return}if(e<t*1.5){return Math.floor(e/t)+" "+r}return Math.ceil(e/t)+" "+r+"s"}},{}],574:[function(e,t,r){"use strict";var a=e("parenthesis");t.exports=function e(t,r,n){if(t==null)throw Error("First argument should be a string");if(r==null)throw Error("Separator should be a string or a RegExp");if(!n)n={};else if(typeof n==="string"||Array.isArray(n)){n={ignore:n}}if(n.escape==null)n.escape=true;if(n.ignore==null)n.ignore=["[]","()","{}","<>",'""',"''","``","“”","«»"];else{if(typeof n.ignore==="string"){n.ignore=[n.ignore]}n.ignore=n.ignore.map((function(e){if(e.length===1)e=e+e;return e}))}var i=a.parse(t,{flat:true,brackets:n.ignore});var o=i[0];var s=o.split(r);if(n.escape){var l=[];for(var u=0;u<s.length;u++){var c=s[u];var f=s[u+1];if(c[c.length-1]==="\\"&&c[c.length-2]!=="\\"){l.push(c+r+f);u++}else{l.push(c)}}s=l}for(var u=0;u<s.length;u++){i[0]=s[u];s[u]=a.stringify(i,{flat:true})}return s}},{parenthesis:480}],575:[function(e,t,r){"use strict";t.exports=a;function a(e){var t=e.length;var r=new Array(t);var a=new Array(t);var n=new Array(t);var i=new Array(t);var o=new Array(t);var s=new Array(t);for(var l=0;l<t;++l){r[l]=-1;a[l]=0;n[l]=false;i[l]=0;o[l]=-1;s[l]=[]}var u=0;var c=[];var f=[];function h(t){var l=[t],h=[t];r[t]=a[t]=u;n[t]=true;u+=1;while(h.length>0){t=h[h.length-1];var p=e[t];if(i[t]<p.length){for(var v=i[t];v<p.length;++v){var d=p[v];if(r[d]<0){r[d]=a[d]=u;n[d]=true;u+=1;l.push(d);h.push(d);break}else if(n[d]){a[t]=Math.min(a[t],a[d])|0}if(o[d]>=0){s[t].push(o[d])}}i[t]=v}else{if(a[t]===r[t]){var m=[];var g=[],y=0;for(var v=l.length-1;v>=0;--v){var x=l[v];n[x]=false;m.push(x);g.push(s[x]);y+=s[x].length;o[x]=c.length;if(x===t){l.length=v;break}}c.push(m);var b=new Array(y);for(var v=0;v<g.length;v++){for(var _=0;_<g[v].length;_++){b[--y]=g[v][_]}}f.push(b)}h.pop()}}}for(var l=0;l<t;++l){if(r[l]<0){h(l)}}var p;for(var l=0;l<f.length;l++){var v=f[l];if(v.length===0)continue;v.sort((function(e,t){return e-t}));p=[v[0]];for(var d=1;d<v.length;d++){if(v[d]!==v[d-1]){p.push(v[d])}}f[l]=p}return{components:c,adjacencyList:f}}},{}],576:[function(e,t,r){"use strict";t.exports=u;var a=e("ndarray-extract-contour");var n=e("zero-crossings");var i={"2d":function(e,t,r){var a=e({order:t,scalarArguments:3,getters:r==="generic"?[0]:undefined,phase:function e(t,r,a,n){return t>n|0},vertex:function e(t,r,a,n,i,o,s,l,u,c,f,h,p){var v=(s<<0)+(l<<1)+(u<<2)+(c<<3)|0;if(v===0||v===15){return}switch(v){case 0:f.push([t-.5,r-.5]);break;case 1:f.push([t-.25-.25*(n+a-2*p)/(a-n),r-.25-.25*(i+a-2*p)/(a-i)]);break;case 2:f.push([t-.75-.25*(-n-a+2*p)/(n-a),r-.25-.25*(o+n-2*p)/(n-o)]);break;case 3:f.push([t-.5,r-.5-.5*(i+a+o+n-4*p)/(a-i+n-o)]);break;case 4:f.push([t-.25-.25*(o+i-2*p)/(i-o),r-.75-.25*(-i-a+2*p)/(i-a)]);break;case 5:f.push([t-.5-.5*(n+a+o+i-4*p)/(a-n+i-o),r-.5]);break;case 6:f.push([t-.5-.25*(-n-a+o+i)/(n-a+i-o),r-.5-.25*(-i-a+o+n)/(i-a+n-o)]);break;case 7:f.push([t-.75-.25*(o+i-2*p)/(i-o),r-.75-.25*(o+n-2*p)/(n-o)]);break;case 8:f.push([t-.75-.25*(-o-i+2*p)/(o-i),r-.75-.25*(-o-n+2*p)/(o-n)]);break;case 9:f.push([t-.5-.25*(n+a+-o-i)/(a-n+o-i),r-.5-.25*(i+a+-o-n)/(a-i+o-n)]);break;case 10:f.push([t-.5-.5*(-n-a+-o-i+4*p)/(n-a+o-i),r-.5]);break;case 11:f.push([t-.25-.25*(-o-i+2*p)/(o-i),r-.75-.25*(i+a-2*p)/(a-i)]);break;case 12:f.push([t-.5,r-.5-.5*(-i-a+-o-n+4*p)/(i-a+o-n)]);break;case 13:f.push([t-.75-.25*(n+a-2*p)/(a-n),r-.25-.25*(-o-n+2*p)/(o-n)]);break;case 14:f.push([t-.25-.25*(-n-a+2*p)/(n-a),r-.25-.25*(-i-a+2*p)/(i-a)]);break;case 15:f.push([t-.5,r-.5]);break}},cell:function e(t,r,a,n,i,o,s,l,u){if(i){l.push([t,r])}else{l.push([r,t])}}});return function(e,t){var r=[],n=[];a(e,r,n,t);return{positions:r,cells:n}}}};function o(e,t){var r=e.length+"d";var n=i[r];if(n)return n(a,e,t)}function s(e,t){var r=n(e,t);var a=r.length;var i=new Array(a);var o=new Array(a);for(var s=0;s<a;++s){i[s]=[r[s]];o[s]=[s]}return{positions:i,cells:o}}var l={};function u(e,t){if(e.dimension<=0){return{positions:[],cells:[]}}else if(e.dimension===1){return s(e,t)}var r=e.order.join()+"-"+e.dtype;var a=l[r];var t=+t||0;if(!a){a=l[r]=o(e.order,e.dtype)}return a(e,t)}},{"ndarray-extract-contour":464,"zero-crossings":631}],577:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});var a=function(){function e(e,t){var r=[];var a=true;var n=false;var i=undefined;try{for(var o=e[Symbol.iterator](),s;!(a=(s=o.next()).done);a=true){r.push(s.value);if(t&&r.length===t)break}}catch(l){n=true;i=l}finally{try{if(!a&&o["return"])o["return"]()}finally{if(n)throw i}}return r}return function(t,r){if(Array.isArray(t)){return t}else if(Symbol.iterator in Object(t)){return e(t,r)}else{throw new TypeError("Invalid attempt to destructure non-iterable instance")}}}();var n=Math.PI*2;var i=function e(t,r,a,n,i,o,s){var l=t.x,u=t.y;l*=r;u*=a;var c=n*l-i*u;var f=i*l+n*u;return{x:c+o,y:f+s}};var o=function e(t,r){var a=r===1.5707963267948966?.551915024494:r===-1.5707963267948966?-.551915024494:4/3*Math.tan(r/4);var n=Math.cos(t);var i=Math.sin(t);var o=Math.cos(t+r);var s=Math.sin(t+r);return[{x:n-i*a,y:i+n*a},{x:o+s*a,y:s-o*a},{x:o,y:s}]};var s=function e(t,r,a,n){var i=t*n-r*a<0?-1:1;var o=t*a+r*n;if(o>1){o=1}if(o<-1){o=-1}return i*Math.acos(o)};var l=function e(t,r,a,i,o,l,u,c,f,h,p,v){var d=Math.pow(o,2);var m=Math.pow(l,2);var g=Math.pow(p,2);var y=Math.pow(v,2);var x=d*m-d*y-m*g;if(x<0){x=0}x/=d*y+m*g;x=Math.sqrt(x)*(u===c?-1:1);var b=x*o/l*v;var _=x*-l/o*p;var w=h*b-f*_+(t+a)/2;var T=f*b+h*_+(r+i)/2;var k=(p-b)/o;var M=(v-_)/l;var A=(-p-b)/o;var S=(-v-_)/l;var E=s(1,0,k,M);var L=s(k,M,A,S);if(c===0&&L>0){L-=n}if(c===1&&L<0){L+=n}return[w,T,E,L]};var u=function e(t){var r=t.px,s=t.py,u=t.cx,c=t.cy,f=t.rx,h=t.ry,p=t.xAxisRotation,v=p===undefined?0:p,d=t.largeArcFlag,m=d===undefined?0:d,g=t.sweepFlag,y=g===undefined?0:g;var x=[];if(f===0||h===0){return[]}var b=Math.sin(v*n/360);var _=Math.cos(v*n/360);var w=_*(r-u)/2+b*(s-c)/2;var T=-b*(r-u)/2+_*(s-c)/2;if(w===0&&T===0){return[]}f=Math.abs(f);h=Math.abs(h);var k=Math.pow(w,2)/Math.pow(f,2)+Math.pow(T,2)/Math.pow(h,2);if(k>1){f*=Math.sqrt(k);h*=Math.sqrt(k)}var M=l(r,s,u,c,f,h,m,y,b,_,w,T),A=a(M,4),S=A[0],E=A[1],L=A[2],C=A[3];var I=Math.abs(C)/(n/4);if(Math.abs(1-I)<1e-7){I=1}var P=Math.max(Math.ceil(I),1);C/=P;for(var O=0;O<P;O++){x.push(o(L,C));L+=C}return x.map((function(e){var t=i(e[0],f,h,_,b,S,E),r=t.x,a=t.y;var n=i(e[1],f,h,_,b,S,E),o=n.x,s=n.y;var l=i(e[2],f,h,_,b,S,E),u=l.x,c=l.y;return{x1:r,y1:a,x2:o,y2:s,x:u,y:c}}))};r.default=u;t.exports=r.default},{}],578:[function(e,t,r){"use strict";var a=e("parse-svg-path");var n=e("abs-svg-path");var i=e("normalize-svg-path");var o=e("is-svg-path");var s=e("assert");t.exports=l;function l(e){if(Array.isArray(e)&&e.length===1&&typeof e[0]==="string")e=e[0];if(typeof e==="string"){s(o(e),"String is not an SVG path.");e=a(e)}s(Array.isArray(e),"Argument should be a string or an array of path segments.");e=n(e);e=i(e);if(!e.length)return[0,0,0,0];var t=[Infinity,Infinity,-Infinity,-Infinity];for(var r=0,l=e.length;r<l;r++){var u=e[r].slice(1);for(var c=0;c<u.length;c+=2){if(u[c+0]<t[0])t[0]=u[c+0];if(u[c+1]<t[1])t[1]=u[c+1];if(u[c+0]>t[2])t[2]=u[c+0];if(u[c+1]>t[3])t[3]=u[c+1]}}return t}},{"abs-svg-path":71,assert:80,"is-svg-path":449,"normalize-svg-path":579,"parse-svg-path":482}],579:[function(e,t,r){"use strict";t.exports=n;var a=e("svg-arc-to-cubic-bezier");function n(e){var t;var r=[];var n=0;var s=0;var l=0;var u=0;var c=null;var f=null;var h=0;var p=0;for(var v=0,d=e.length;v<d;v++){var m=e[v];var g=m[0];switch(g){case"M":l=m[1];u=m[2];break;case"A":var y=a({px:h,py:p,cx:m[6],cy:m[7],rx:m[1],ry:m[2],xAxisRotation:m[3],largeArcFlag:m[4],sweepFlag:m[5]});if(!y.length)continue;for(var x=0,b;x<y.length;x++){b=y[x];m=["C",b.x1,b.y1,b.x2,b.y2,b.x,b.y];if(x<y.length-1)r.push(m)}break;case"S":var _=h;var w=p;if(t=="C"||t=="S"){_+=_-n;w+=w-s}m=["C",_,w,m[1],m[2],m[3],m[4]];break;case"T":if(t=="Q"||t=="T"){c=h*2-c;f=p*2-f}else{c=h;f=p}m=o(h,p,c,f,m[1],m[2]);break;case"Q":c=m[1];f=m[2];m=o(h,p,m[1],m[2],m[3],m[4]);break;case"L":m=i(h,p,m[1],m[2]);break;case"H":m=i(h,p,m[1],p);break;case"V":m=i(h,p,h,m[1]);break;case"Z":m=i(h,p,l,u);break}t=g;h=m[m.length-2];p=m[m.length-1];if(m.length>4){n=m[m.length-4];s=m[m.length-3]}else{n=h;s=p}r.push(m)}return r}function i(e,t,r,a){return["C",e,t,r,a,r,a]}function o(e,t,r,a,n,i){return["C",e/3+2/3*r,t/3+2/3*a,n/3+2/3*r,i/3+2/3*a,n,i]}},{"svg-arc-to-cubic-bezier":577}],580:[function(e,t,r){"use strict";var a=e("svg-path-bounds");var n=e("parse-svg-path");var i=e("draw-svg-path");var o=e("is-svg-path");var s=e("bitmap-sdf");var l=document.createElement("canvas");var u=l.getContext("2d");t.exports=c;function c(e,t){if(!o(e))throw Error("Argument should be valid svg path string");if(!t)t={};var r,c;if(t.shape){r=t.shape[0];c=t.shape[1]}else{r=l.width=t.w||t.width||200;c=l.height=t.h||t.height||200}var f=Math.min(r,c);var p=t.stroke||0;var v=t.viewbox||t.viewBox||a(e);var d=[r/(v[2]-v[0]),c/(v[3]-v[1])];var m=Math.min(d[0]||0,d[1]||0)/2;u.fillStyle="black";u.fillRect(0,0,r,c);u.fillStyle="white";if(p){if(typeof p!="number")p=1;if(p>0){u.strokeStyle="white"}else{u.strokeStyle="black"}u.lineWidth=Math.abs(p)}u.translate(r*.5,c*.5);u.scale(m,m);if(h()){var g=new Path2D(e);u.fill(g);p&&u.stroke(g)}else{var y=n(e);i(u,y);u.fill();p&&u.stroke()}u.setTransform(1,0,0,1,0,0);var x=s(u,{cutoff:t.cutoff!=null?t.cutoff:.5,radius:t.radius!=null?t.radius:f*.5});return x}var f;function h(){if(f!=null)return f;var e=document.createElement("canvas").getContext("2d");e.canvas.width=e.canvas.height=1;if(!window.Path2D)return f=false;var t=new Path2D("M0,0h1v1h-1v-1Z");e.fillStyle="black";e.fill(t);var r=e.getImageData(0,0,1,1);return f=r&&r.data&&r.data[3]===255}},{"bitmap-sdf":105,"draw-svg-path":180,"is-svg-path":449,"parse-svg-path":482,"svg-path-bounds":578}],581:[function(e,t,r){(function(r){(function(){"use strict";t.exports=s;var a=e("vectorize-text");var n=window||r.global||{};var i=n.__TEXT_CACHE||{};n.__TEXT_CACHE={};function o(e){var t=e.cells;var r=e.positions;var a=new Float32Array(t.length*6);var n=0;var i=0;for(var o=0;o<t.length;++o){var s=t[o];for(var l=0;l<3;++l){var u=r[s[l]];a[n++]=u[0];a[n++]=u[1]+1.4;i=Math.max(u[0],i)}}return{data:a,shape:i}}function s(e,t,r){var r=r||{};var n=i[e];if(!n){n=i[e]={" ":{data:new Float32Array(0),shape:.2}}}var l=n[t];if(!l){if(t.length<=1||!/\d/.test(t)){l=n[t]=o(a(t,{triangles:true,font:e,textAlign:r.textAlign||"left",textBaseline:"alphabetic",styletags:{breaklines:true,bolds:true,italics:true,subscripts:true,superscripts:true}}))}else{var u=t.split(/(\d|\s)/);var c=new Array(u.length);var f=0;var h=0;for(var p=0;p<u.length;++p){c[p]=s(e,u[p]);f+=c[p].data.length;h+=c[p].shape;if(p>0){h+=.02}}var v=new Float32Array(f);var d=0;var m=-.5*h;for(var p=0;p<c.length;++p){var g=c[p].data;for(var y=0;y<g.length;y+=2){v[d++]=g[y]+m;v[d++]=g[y+1]}m+=c[p].shape+.02}l=n[t]={data:v,shape:h}}}return l}}).call(this)}).call(this,e("_process"))},{_process:514,"vectorize-text":607}],582:[function(e,t,r){(function(t,a){(function(){var n=e("process/browser.js").nextTick;var i=Function.prototype.apply;var o=Array.prototype.slice;var s={};var l=0;r.setTimeout=function(){return new u(i.call(setTimeout,window,arguments),clearTimeout)};r.setInterval=function(){return new u(i.call(setInterval,window,arguments),clearInterval)};r.clearTimeout=r.clearInterval=function(e){e.close()};function u(e,t){this._id=e;this._clearFn=t}u.prototype.unref=u.prototype.ref=function(){};u.prototype.close=function(){this._clearFn.call(window,this._id)};r.enroll=function(e,t){clearTimeout(e._idleTimeoutId);e._idleTimeout=t};r.unenroll=function(e){clearTimeout(e._idleTimeoutId);e._idleTimeout=-1};r._unrefActive=r.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;if(t>=0){e._idleTimeoutId=setTimeout((function t(){if(e._onTimeout)e._onTimeout()}),t)}};r.setImmediate=typeof t==="function"?t:function(e){var t=l++;var a=arguments.length<2?false:o.call(arguments,1);s[t]=true;n((function n(){if(s[t]){if(a){e.apply(null,a)}else{e.call(null)}r.clearImmediate(t)}}));return t};r.clearImmediate=typeof a==="function"?a:function(e){delete s[e]}}).call(this)}).call(this,e("timers").setImmediate,e("timers").clearImmediate)},{"process/browser.js":514,timers:582}],583:[function(t,r,a){(function(t){var a=/^\s+/,n=/\s+$/,i=0,o=t.round,s=t.min,l=t.max,u=t.random;function c(e,t){e=e?e:"";t=t||{};if(e instanceof c){return e}if(!(this instanceof c)){return new c(e,t)}var r=f(e);this._originalInput=e,this._r=r.r,this._g=r.g,this._b=r.b,this._a=r.a,this._roundA=o(100*this._a)/100,this._format=t.format||r.format;this._gradientType=t.gradientType;if(this._r<1){this._r=o(this._r)}if(this._g<1){this._g=o(this._g)}if(this._b<1){this._b=o(this._b)}this._ok=r.ok;this._tc_id=i++}c.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var e=this.toRgb();return(e.r*299+e.g*587+e.b*114)/1e3},getLuminance:function(){var e=this.toRgb();var r,a,n,i,o,s;r=e.r/255;a=e.g/255;n=e.b/255;if(r<=.03928){i=r/12.92}else{i=t.pow((r+.055)/1.055,2.4)}if(a<=.03928){o=a/12.92}else{o=t.pow((a+.055)/1.055,2.4)}if(n<=.03928){s=n/12.92}else{s=t.pow((n+.055)/1.055,2.4)}return.2126*i+.7152*o+.0722*s},setAlpha:function(e){this._a=R(e);this._roundA=o(100*this._a)/100;return this},toHsv:function(){var e=d(this._r,this._g,this._b);return{h:e.h*360,s:e.s,v:e.v,a:this._a}},toHsvString:function(){var e=d(this._r,this._g,this._b);var t=o(e.h*360),r=o(e.s*100),a=o(e.v*100);return this._a==1?"hsv("+t+", "+r+"%, "+a+"%)":"hsva("+t+", "+r+"%, "+a+"%, "+this._roundA+")"},toHsl:function(){var e=p(this._r,this._g,this._b);return{h:e.h*360,s:e.s,l:e.l,a:this._a}},toHslString:function(){var e=p(this._r,this._g,this._b);var t=o(e.h*360),r=o(e.s*100),a=o(e.l*100);return this._a==1?"hsl("+t+", "+r+"%, "+a+"%)":"hsla("+t+", "+r+"%, "+a+"%, "+this._roundA+")"},toHex:function(e){return g(this._r,this._g,this._b,e)},toHexString:function(e){return"#"+this.toHex(e)},toHex8:function(e){return y(this._r,this._g,this._b,this._a,e)},toHex8String:function(e){return"#"+this.toHex8(e)},toRgb:function(){return{r:o(this._r),g:o(this._g),b:o(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+o(this._r)+", "+o(this._g)+", "+o(this._b)+")":"rgba("+o(this._r)+", "+o(this._g)+", "+o(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:o(F(this._r,255)*100)+"%",g:o(F(this._g,255)*100)+"%",b:o(F(this._b,255)*100)+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+o(F(this._r,255)*100)+"%, "+o(F(this._g,255)*100)+"%, "+o(F(this._b,255)*100)+"%)":"rgba("+o(F(this._r,255)*100)+"%, "+o(F(this._g,255)*100)+"%, "+o(F(this._b,255)*100)+"%, "+this._roundA+")"},toName:function(){if(this._a===0){return"transparent"}if(this._a<1){return false}return z[g(this._r,this._g,this._b,true)]||false},toFilter:function(e){var t="#"+x(this._r,this._g,this._b,this._a);var r=t;var a=this._gradientType?"GradientType = 1, ":"";if(e){var n=c(e);r="#"+x(n._r,n._g,n._b,n._a)}return"progid:DXImageTransform.Microsoft.gradient("+a+"startColorstr="+t+",endColorstr="+r+")"},toString:function(e){var t=!!e;e=e||this._format;var r=false;var a=this._a<1&&this._a>=0;var n=!t&&a&&(e==="hex"||e==="hex6"||e==="hex3"||e==="hex4"||e==="hex8"||e==="name");if(n){if(e==="name"&&this._a===0){return this.toName()}return this.toRgbString()}if(e==="rgb"){r=this.toRgbString()}if(e==="prgb"){r=this.toPercentageRgbString()}if(e==="hex"||e==="hex6"){r=this.toHexString()}if(e==="hex3"){r=this.toHexString(true)}if(e==="hex4"){r=this.toHex8String(true)}if(e==="hex8"){r=this.toHex8String()}if(e==="name"){r=this.toName()}if(e==="hsl"){r=this.toHslString()}if(e==="hsv"){r=this.toHsvString()}return r||this.toHexString()},clone:function(){return c(this.toString())},_applyModification:function(e,t){var r=e.apply(null,[this].concat([].slice.call(t)));this._r=r._r;this._g=r._g;this._b=r._b;this.setAlpha(r._a);return this},lighten:function(){return this._applyModification(T,arguments)},brighten:function(){return this._applyModification(k,arguments)},darken:function(){return this._applyModification(M,arguments)},desaturate:function(){return this._applyModification(b,arguments)},saturate:function(){return this._applyModification(_,arguments)},greyscale:function(){return this._applyModification(w,arguments)},spin:function(){return this._applyModification(A,arguments)},_applyCombination:function(e,t){return e.apply(null,[this].concat([].slice.call(t)))},analogous:function(){return this._applyCombination(I,arguments)},complement:function(){return this._applyCombination(S,arguments)},monochromatic:function(){return this._applyCombination(P,arguments)},splitcomplement:function(){return this._applyCombination(C,arguments)},triad:function(){return this._applyCombination(E,arguments)},tetrad:function(){return this._applyCombination(L,arguments)}};c.fromRatio=function(e,t){if(typeof e=="object"){var r={};for(var a in e){if(e.hasOwnProperty(a)){if(a==="a"){r[a]=e[a]}else{r[a]=H(e[a])}}}e=r}return c(e,t)};function f(e){var t={r:0,g:0,b:0};var r=1;var a=null;var n=null;var i=null;var o=false;var u=false;if(typeof e=="string"){e=X(e)}if(typeof e=="object"){if(W(e.r)&&W(e.g)&&W(e.b)){t=h(e.r,e.g,e.b);o=true;u=String(e.r).substr(-1)==="%"?"prgb":"rgb"}else if(W(e.h)&&W(e.s)&&W(e.v)){a=H(e.s);n=H(e.v);t=m(e.h,a,n);o=true;u="hsv"}else if(W(e.h)&&W(e.s)&&W(e.l)){a=H(e.s);i=H(e.l);t=v(e.h,a,i);o=true;u="hsl"}if(e.hasOwnProperty("a")){r=e.a}}r=R(r);return{ok:o,format:e.format||u,r:s(255,l(t.r,0)),g:s(255,l(t.g,0)),b:s(255,l(t.b,0)),a:r}}function h(e,t,r){return{r:F(e,255)*255,g:F(t,255)*255,b:F(r,255)*255}}function p(e,t,r){e=F(e,255);t=F(t,255);r=F(r,255);var a=l(e,t,r),n=s(e,t,r);var i,o,u=(a+n)/2;if(a==n){i=o=0}else{var c=a-n;o=u>.5?c/(2-a-n):c/(a+n);switch(a){case e:i=(t-r)/c+(t<r?6:0);break;case t:i=(r-e)/c+2;break;case r:i=(e-t)/c+4;break}i/=6}return{h:i,s:o,l:u}}function v(e,t,r){var a,n,i;e=F(e,360);t=F(t,100);r=F(r,100);function o(e,t,r){if(r<0)r+=1;if(r>1)r-=1;if(r<1/6)return e+(t-e)*6*r;if(r<1/2)return t;if(r<2/3)return e+(t-e)*(2/3-r)*6;return e}if(t===0){a=n=i=r}else{var s=r<.5?r*(1+t):r+t-r*t;var l=2*r-s;a=o(l,s,e+1/3);n=o(l,s,e);i=o(l,s,e-1/3)}return{r:a*255,g:n*255,b:i*255}}function d(e,t,r){e=F(e,255);t=F(t,255);r=F(r,255);var a=l(e,t,r),n=s(e,t,r);var i,o,u=a;var c=a-n;o=a===0?0:c/a;if(a==n){i=0}else{switch(a){case e:i=(t-r)/c+(t<r?6:0);break;case t:i=(r-e)/c+2;break;case r:i=(e-t)/c+4;break}i/=6}return{h:i,s:o,v:u}}function m(e,r,a){e=F(e,360)*6;r=F(r,100);a=F(a,100);var n=t.floor(e),i=e-n,o=a*(1-r),s=a*(1-i*r),l=a*(1-(1-i)*r),u=n%6,c=[a,s,o,o,l,a][u],f=[l,a,a,s,o,o][u],h=[o,o,l,a,a,s][u];return{r:c*255,g:f*255,b:h*255}}function g(e,t,r,a){var n=[V(o(e).toString(16)),V(o(t).toString(16)),V(o(r).toString(16))];if(a&&n[0].charAt(0)==n[0].charAt(1)&&n[1].charAt(0)==n[1].charAt(1)&&n[2].charAt(0)==n[2].charAt(1)){return n[0].charAt(0)+n[1].charAt(0)+n[2].charAt(0)}return n.join("")}function y(e,t,r,a,n){var i=[V(o(e).toString(16)),V(o(t).toString(16)),V(o(r).toString(16)),V(q(a))];if(n&&i[0].charAt(0)==i[0].charAt(1)&&i[1].charAt(0)==i[1].charAt(1)&&i[2].charAt(0)==i[2].charAt(1)&&i[3].charAt(0)==i[3].charAt(1)){return i[0].charAt(0)+i[1].charAt(0)+i[2].charAt(0)+i[3].charAt(0)}return i.join("")}function x(e,t,r,a){var n=[V(q(a)),V(o(e).toString(16)),V(o(t).toString(16)),V(o(r).toString(16))];return n.join("")}c.equals=function(e,t){if(!e||!t){return false}return c(e).toRgbString()==c(t).toRgbString()};c.random=function(){return c.fromRatio({r:u(),g:u(),b:u()})};function b(e,t){t=t===0?0:t||10;var r=c(e).toHsl();r.s-=t/100;r.s=B(r.s);return c(r)}function _(e,t){t=t===0?0:t||10;var r=c(e).toHsl();r.s+=t/100;r.s=B(r.s);return c(r)}function w(e){return c(e).desaturate(100)}function T(e,t){t=t===0?0:t||10;var r=c(e).toHsl();r.l+=t/100;r.l=B(r.l);return c(r)}function k(e,t){t=t===0?0:t||10;var r=c(e).toRgb();r.r=l(0,s(255,r.r-o(255*-(t/100))));r.g=l(0,s(255,r.g-o(255*-(t/100))));r.b=l(0,s(255,r.b-o(255*-(t/100))));return c(r)}function M(e,t){t=t===0?0:t||10;var r=c(e).toHsl();r.l-=t/100;r.l=B(r.l);return c(r)}function A(e,t){var r=c(e).toHsl();var a=(r.h+t)%360;r.h=a<0?360+a:a;return c(r)}function S(e){var t=c(e).toHsl();t.h=(t.h+180)%360;return c(t)}function E(e){var t=c(e).toHsl();var r=t.h;return[c(e),c({h:(r+120)%360,s:t.s,l:t.l}),c({h:(r+240)%360,s:t.s,l:t.l})]}function L(e){var t=c(e).toHsl();var r=t.h;return[c(e),c({h:(r+90)%360,s:t.s,l:t.l}),c({h:(r+180)%360,s:t.s,l:t.l}),c({h:(r+270)%360,s:t.s,l:t.l})]}function C(e){var t=c(e).toHsl();var r=t.h;return[c(e),c({h:(r+72)%360,s:t.s,l:t.l}),c({h:(r+216)%360,s:t.s,l:t.l})]}function I(e,t,r){t=t||6;r=r||30;var a=c(e).toHsl();var n=360/r;var i=[c(e)];for(a.h=(a.h-(n*t>>1)+720)%360;--t;){a.h=(a.h+n)%360;i.push(c(a))}return i}function P(e,t){t=t||6;var r=c(e).toHsv();var a=r.h,n=r.s,i=r.v;var o=[];var s=1/t;while(t--){o.push(c({h:a,s:n,v:i}));i=(i+s)%1}return o}c.mix=function(e,t,r){r=r===0?0:r||50;var a=c(e).toRgb();var n=c(t).toRgb();var i=r/100;var o={r:(n.r-a.r)*i+a.r,g:(n.g-a.g)*i+a.g,b:(n.b-a.b)*i+a.b,a:(n.a-a.a)*i+a.a};return c(o)};c.readability=function(e,r){var a=c(e);var n=c(r);return(t.max(a.getLuminance(),n.getLuminance())+.05)/(t.min(a.getLuminance(),n.getLuminance())+.05)};c.isReadable=function(e,t,r){var a=c.readability(e,t);var n,i;i=false;n=Z(r);switch(n.level+n.size){case"AAsmall":case"AAAlarge":i=a>=4.5;break;case"AAlarge":i=a>=3;break;case"AAAsmall":i=a>=7;break}return i};c.mostReadable=function(e,t,r){var a=null;var n=0;var i;var o,s,l;r=r||{};o=r.includeFallbackColors;s=r.level;l=r.size;for(var u=0;u<t.length;u++){i=c.readability(e,t[u]);if(i>n){n=i;a=c(t[u])}}if(c.isReadable(e,a,{level:s,size:l})||!o){return a}else{r.includeFallbackColors=false;return c.mostReadable(e,["#fff","#000"],r)}};var O=c.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"};var z=c.hexNames=D(O);function D(e){var t={};for(var r in e){if(e.hasOwnProperty(r)){t[e[r]]=r}}return t}function R(e){e=parseFloat(e);if(isNaN(e)||e<0||e>1){e=1}return e}function F(e,r){if(j(e)){e="100%"}var a=U(e);e=s(r,l(0,parseFloat(e)));if(a){e=parseInt(e*r,10)/100}if(t.abs(e-r)<1e-6){return 1}return e%r/parseFloat(r)}function B(e){return s(1,l(0,e))}function N(e){return parseInt(e,16)}function j(e){return typeof e=="string"&&e.indexOf(".")!=-1&&parseFloat(e)===1}function U(e){return typeof e==="string"&&e.indexOf("%")!=-1}function V(e){return e.length==1?"0"+e:""+e}function H(e){if(e<=1){e=e*100+"%"}return e}function q(e){return t.round(parseFloat(e)*255).toString(16)}function G(e){return N(e)/255}var Y=function(){var e="[-\\+]?\\d+%?";var t="[-\\+]?\\d*\\.\\d+%?";var r="(?:"+t+")|(?:"+e+")";var a="[\\s|\\(]+("+r+")[,|\\s]+("+r+")[,|\\s]+("+r+")\\s*\\)?";var n="[\\s|\\(]+("+r+")[,|\\s]+("+r+")[,|\\s]+("+r+")[,|\\s]+("+r+")\\s*\\)?";return{CSS_UNIT:new RegExp(r),rgb:new RegExp("rgb"+a),rgba:new RegExp("rgba"+n),hsl:new RegExp("hsl"+a),hsla:new RegExp("hsla"+n),hsv:new RegExp("hsv"+a),hsva:new RegExp("hsva"+n),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();function W(e){return!!Y.CSS_UNIT.exec(e)}function X(e){e=e.replace(a,"").replace(n,"").toLowerCase();var t=false;if(O[e]){e=O[e];t=true}else if(e=="transparent"){return{r:0,g:0,b:0,a:0,format:"name"}}var r;if(r=Y.rgb.exec(e)){return{r:r[1],g:r[2],b:r[3]}}if(r=Y.rgba.exec(e)){return{r:r[1],g:r[2],b:r[3],a:r[4]}}if(r=Y.hsl.exec(e)){return{h:r[1],s:r[2],l:r[3]}}if(r=Y.hsla.exec(e)){return{h:r[1],s:r[2],l:r[3],a:r[4]}}if(r=Y.hsv.exec(e)){return{h:r[1],s:r[2],v:r[3]}}if(r=Y.hsva.exec(e)){return{h:r[1],s:r[2],v:r[3],a:r[4]}}if(r=Y.hex8.exec(e)){return{r:N(r[1]),g:N(r[2]),b:N(r[3]),a:G(r[4]),format:t?"name":"hex8"}}if(r=Y.hex6.exec(e)){return{r:N(r[1]),g:N(r[2]),b:N(r[3]),format:t?"name":"hex"}}if(r=Y.hex4.exec(e)){return{r:N(r[1]+""+r[1]),g:N(r[2]+""+r[2]),b:N(r[3]+""+r[3]),a:G(r[4]+""+r[4]),format:t?"name":"hex8"}}if(r=Y.hex3.exec(e)){return{r:N(r[1]+""+r[1]),g:N(r[2]+""+r[2]),b:N(r[3]+""+r[3]),format:t?"name":"hex"}}return false}function Z(e){var t,r;e=e||{level:"AA",size:"small"};t=(e.level||"AA").toUpperCase();r=(e.size||"small").toLowerCase();if(t!=="AA"&&t!=="AAA"){t="AA"}if(r!=="small"&&r!=="large"){r="small"}return{level:t,size:r}}if(typeof r!=="undefined"&&r.exports){r.exports=c}else if(typeof e==="function"&&e.amd){e((function(){return c}))}else{window.tinycolor=c}})(Math)},{}],584:[function(e,t,r){"use strict";t.exports=i;t.exports.float32=t.exports.float=i;t.exports.fract32=t.exports.fract=n;var a=new Float32Array(1);function n(e,t){if(e.length){if(e instanceof Float32Array)return new Float32Array(e.length);if(!(t instanceof Float32Array))t=i(e);for(var r=0,a=t.length;r<a;r++){t[r]=e[r]-t[r]}return t}return i(e-i(e))}function i(e){if(e.length){if(e instanceof Float32Array)return e;return new Float32Array(e)}a[0]=e;return a[0]}},{}],585:[function(e,t,r){"use strict";var a=e("parse-unit");t.exports=s;var n=96;function i(e,t){var r=a(getComputedStyle(e).getPropertyValue(t));return r[0]*s(r[1],e)}function o(e,t){var r=document.createElement("div");r.style["font-size"]="128"+e;t.appendChild(r);var a=i(r,"font-size")/128;t.removeChild(r);return a}function s(e,t){t=t||document.body;e=(e||"px").trim().toLowerCase();if(t===window||t===document){t=document.body}switch(e){case"%":return t.clientHeight/100;case"ch":case"ex":return o(e,t);case"em":return i(t,"font-size");case"rem":return i(document.body,"font-size");case"vw":return window.innerWidth/100;case"vh":return window.innerHeight/100;case"vmin":return Math.min(window.innerWidth,window.innerHeight)/100;case"vmax":return Math.max(window.innerWidth,window.innerHeight)/100;case"in":return n;case"cm":return n/2.54;case"mm":return n/25.4;case"pt":return n/72;case"pc":return n/6}return 1}},{"parse-unit":483}],586:[function(t,r,a){(function(t,n){typeof a==="object"&&typeof r!=="undefined"?n(a):typeof e==="function"&&e.amd?e(["exports"],n):(t=t||self,n(t.topojson=t.topojson||{}))})(this,(function(e){"use strict";function t(e){return e}function r(e){if(e==null)return t;var r,a,n=e.scale[0],i=e.scale[1],o=e.translate[0],s=e.translate[1];return function(e,t){if(!t)r=a=0;var l=2,u=e.length,c=new Array(u);c[0]=(r+=e[0])*n+o;c[1]=(a+=e[1])*i+s;while(l<u)c[l]=e[l],++l;return c}}function a(e){var t=r(e.transform),a,n=Infinity,i=n,o=-n,s=-n;function l(e){e=t(e);if(e[0]<n)n=e[0];if(e[0]>o)o=e[0];if(e[1]<i)i=e[1];if(e[1]>s)s=e[1]}function u(e){switch(e.type){case"GeometryCollection":e.geometries.forEach(u);break;case"Point":l(e.coordinates);break;case"MultiPoint":e.coordinates.forEach(l);break}}e.arcs.forEach((function(e){var r=-1,a=e.length,l;while(++r<a){l=t(e[r],r);if(l[0]<n)n=l[0];if(l[0]>o)o=l[0];if(l[1]<i)i=l[1];if(l[1]>s)s=l[1]}}));for(a in e.objects){u(e.objects[a])}return[n,i,o,s]}function n(e,t){var r,a=e.length,n=a-t;while(n<--a)r=e[n],e[n++]=e[a],e[a]=r}function i(e,t){if(typeof t==="string")t=e.objects[t];return t.type==="GeometryCollection"?{type:"FeatureCollection",features:t.geometries.map((function(t){return o(e,t)}))}:o(e,t)}function o(e,t){var r=t.id,a=t.bbox,n=t.properties==null?{}:t.properties,i=s(e,t);return r==null&&a==null?{type:"Feature",properties:n,geometry:i}:a==null?{type:"Feature",id:r,properties:n,geometry:i}:{type:"Feature",id:r,bbox:a,properties:n,geometry:i}}function s(e,t){var a=r(e.transform),i=e.arcs;function o(e,t){if(t.length)t.pop();for(var r=i[e<0?~e:e],o=0,s=r.length;o<s;++o){t.push(a(r[o],o))}if(e<0)n(t,s)}function s(e){return a(e)}function l(e){var t=[];for(var r=0,a=e.length;r<a;++r)o(e[r],t);if(t.length<2)t.push(t[0]);return t}function u(e){var t=l(e);while(t.length<4)t.push(t[0]);return t}function c(e){return e.map(u)}function f(e){var t=e.type,r;switch(t){case"GeometryCollection":return{type:t,geometries:e.geometries.map(f)};case"Point":r=s(e.coordinates);break;case"MultiPoint":r=e.coordinates.map(s);break;case"LineString":r=l(e.arcs);break;case"MultiLineString":r=e.arcs.map(l);break;case"Polygon":r=c(e.arcs);break;case"MultiPolygon":r=e.arcs.map(c);break;default:return null}return{type:t,coordinates:r}}return f(t)}function l(e,t){var r={},a={},n={},i=[],o=-1;t.forEach((function(r,a){var n=e.arcs[r<0?~r:r],i;if(n.length<3&&!n[1][0]&&!n[1][1]){i=t[++o],t[o]=r,t[a]=i}}));t.forEach((function(e){var t=s(e),r=t[0],i=t[1],o,l;if(o=n[r]){delete n[o.end];o.push(e);o.end=i;if(l=a[i]){delete a[l.start];var u=l===o?o:o.concat(l);a[u.start=o.start]=n[u.end=l.end]=u}else{a[o.start]=n[o.end]=o}}else if(o=a[i]){delete a[o.start];o.unshift(e);o.start=r;if(l=n[r]){delete n[l.end];var c=l===o?o:l.concat(o);a[c.start=l.start]=n[c.end=o.end]=c}else{a[o.start]=n[o.end]=o}}else{o=[e];a[o.start=r]=n[o.end=i]=o}}));function s(t){var r=e.arcs[t<0?~t:t],a=r[0],n;if(e.transform)n=[0,0],r.forEach((function(e){n[0]+=e[0],n[1]+=e[1]}));else n=r[r.length-1];return t<0?[n,a]:[a,n]}function l(e,t){for(var a in e){var n=e[a];delete t[n.start];delete n.start;delete n.end;n.forEach((function(e){r[e<0?~e:e]=1}));i.push(n)}}l(n,a);l(a,n);t.forEach((function(e){if(!r[e<0?~e:e])i.push([e])}));return i}function u(e){return s(e,c.apply(this,arguments))}function c(e,t,r){var a,n,i;if(arguments.length>1)a=f(e,t,r);else for(n=0,a=new Array(i=e.arcs.length);n<i;++n)a[n]=n;return{type:"MultiLineString",arcs:l(e,a)}}function f(e,t,r){var a=[],n=[],i;function o(e){var t=e<0?~e:e;(n[t]||(n[t]=[])).push({i:e,g:i})}function s(e){e.forEach(o)}function l(e){e.forEach(s)}function u(e){e.forEach(l)}function c(e){switch(i=e,e.type){case"GeometryCollection":e.geometries.forEach(c);break;case"LineString":s(e.arcs);break;case"MultiLineString":case"Polygon":l(e.arcs);break;case"MultiPolygon":u(e.arcs);break}}c(t);n.forEach(r==null?function(e){a.push(e[0].i)}:function(e){if(r(e[0].g,e[e.length-1].g))a.push(e[0].i)});return a}function h(e){var t=-1,r=e.length,a,n=e[r-1],i=0;while(++t<r)a=n,n=e[t],i+=a[0]*n[1]-a[1]*n[0];return Math.abs(i)}function p(e){return s(e,v.apply(this,arguments))}function v(e,t){var r={},a=[],n=[];t.forEach(i);function i(e){switch(e.type){case"GeometryCollection":e.geometries.forEach(i);break;case"Polygon":o(e.arcs);break;case"MultiPolygon":e.arcs.forEach(o);break}}function o(e){e.forEach((function(t){t.forEach((function(t){(r[t=t<0?~t:t]||(r[t]=[])).push(e)}))}));a.push(e)}function u(t){return h(s(e,{type:"Polygon",arcs:[t]}).coordinates[0])}a.forEach((function(e){if(!e._){var t=[],a=[e];e._=1;n.push(t);while(e=a.pop()){t.push(e);e.forEach((function(e){e.forEach((function(e){r[e<0?~e:e].forEach((function(e){if(!e._){e._=1;a.push(e)}}))}))}))}}}));a.forEach((function(e){delete e._}));return{type:"MultiPolygon",arcs:n.map((function(t){var a=[],n;t.forEach((function(e){e.forEach((function(e){e.forEach((function(e){if(r[e<0?~e:e].length<2){a.push(e)}}))}))}));a=l(e,a);if((n=a.length)>1){for(var i=1,o=u(a[0]),s,c;i<n;++i){if((s=u(a[i]))>o){c=a[0],a[0]=a[i],a[i]=c,o=s}}}return a})).filter((function(e){return e.length>0}))}}function d(e,t){var r=0,a=e.length;while(r<a){var n=r+a>>>1;if(e[n]<t)r=n+1;else a=n}return r}function m(e){var t={},r=e.map((function(){return[]}));function a(e,r){e.forEach((function(e){if(e<0)e=~e;var a=t[e];if(a)a.push(r);else t[e]=[r]}))}function n(e,t){e.forEach((function(e){a(e,t)}))}function i(e,t){if(e.type==="GeometryCollection")e.geometries.forEach((function(e){i(e,t)}));else if(e.type in o)o[e.type](e.arcs,t)}var o={LineString:a,MultiLineString:n,Polygon:n,MultiPolygon:function(e,t){e.forEach((function(e){n(e,t)}))}};e.forEach(i);for(var s in t){for(var l=t[s],u=l.length,c=0;c<u;++c){for(var f=c+1;f<u;++f){var h=l[c],p=l[f],v;if((v=r[h])[s=d(v,p)]!==p)v.splice(s,0,p);if((v=r[p])[s=d(v,h)]!==h)v.splice(s,0,h)}}}return r}function g(e){if(e==null)return t;var r,a,n=e.scale[0],i=e.scale[1],o=e.translate[0],s=e.translate[1];return function(e,t){if(!t)r=a=0;var l=2,u=e.length,c=new Array(u),f=Math.round((e[0]-o)/n),h=Math.round((e[1]-s)/i);c[0]=f-r,r=f;c[1]=h-a,a=h;while(l<u)c[l]=e[l],++l;return c}}function y(e,t){if(e.transform)throw new Error("already quantized");if(!t||!t.scale){if(!((s=Math.floor(t))>=2))throw new Error("n must be ≥2");u=e.bbox||a(e);var r=u[0],n=u[1],i=u[2],o=u[3],s;t={scale:[i-r?(i-r)/(s-1):1,o-n?(o-n)/(s-1):1],translate:[r,n]}}else{u=e.bbox}var l=g(t),u,c,f=e.objects,h={};function p(e){return l(e)}function v(e){var t;switch(e.type){case"GeometryCollection":t={type:"GeometryCollection",geometries:e.geometries.map(v)};break;case"Point":t={type:"Point",coordinates:p(e.coordinates)};break;case"MultiPoint":t={type:"MultiPoint",coordinates:e.coordinates.map(p)};break;default:return e}if(e.id!=null)t.id=e.id;if(e.bbox!=null)t.bbox=e.bbox;if(e.properties!=null)t.properties=e.properties;return t}function d(e){var t=0,r=1,a=e.length,n,i=new Array(a);i[0]=l(e[0],0);while(++t<a)if((n=l(e[t],t))[0]||n[1])i[r++]=n;if(r===1)i[r++]=[0,0];i.length=r;return i}for(c in f)h[c]=v(f[c]);return{type:"Topology",bbox:u,transform:t,objects:h,arcs:e.arcs.map(d)}}e.bbox=a;e.feature=i;e.merge=p;e.mergeArcs=v;e.mesh=u;e.meshArcs=c;e.neighbors=m;e.quantize=y;e.transform=r;e.untransform=g;Object.defineProperty(e,"__esModule",{value:true})}))},{}],587:[function(e,t,r){"use strict";t.exports=d;var a=e("filtered-vector");var n=e("gl-mat4/invert");var i=e("gl-mat4/rotate");var o=e("gl-vec3/cross");var s=e("gl-vec3/normalize");var l=e("gl-vec3/dot");function u(e,t,r){return Math.sqrt(Math.pow(e,2)+Math.pow(t,2)+Math.pow(r,2))}function c(e){return Math.min(1,Math.max(-1,e))}function f(e){var t=Math.abs(e[0]);var r=Math.abs(e[1]);var a=Math.abs(e[2]);var n=[0,0,0];if(t>Math.max(r,a)){n[2]=1}else if(r>Math.max(t,a)){n[0]=1}else{n[1]=1}var i=0;var o=0;for(var l=0;l<3;++l){i+=e[l]*e[l];o+=n[l]*e[l]}for(var l=0;l<3;++l){n[l]-=o/i*e[l]}s(n,n);return n}function h(e,t,r,n,i,o,s,l){this.center=a(r);this.up=a(n);this.right=a(i);this.radius=a([o]);this.angle=a([s,l]);this.angle.bounds=[[-Infinity,-Math.PI/2],[Infinity,Math.PI/2]];this.setDistanceLimits(e,t);this.computedCenter=this.center.curve(0);this.computedUp=this.up.curve(0);this.computedRight=this.right.curve(0);this.computedRadius=this.radius.curve(0);this.computedAngle=this.angle.curve(0);this.computedToward=[0,0,0];this.computedEye=[0,0,0];this.computedMatrix=new Array(16);for(var u=0;u<16;++u){this.computedMatrix[u]=.5}this.recalcMatrix(0)}var p=h.prototype;p.setDistanceLimits=function(e,t){if(e>0){e=Math.log(e)}else{e=-Infinity}if(t>0){t=Math.log(t)}else{t=Infinity}t=Math.max(t,e);this.radius.bounds[0][0]=e;this.radius.bounds[1][0]=t};p.getDistanceLimits=function(e){var t=this.radius.bounds[0];if(e){e[0]=Math.exp(t[0][0]);e[1]=Math.exp(t[1][0]);return e}return[Math.exp(t[0][0]),Math.exp(t[1][0])]};p.recalcMatrix=function(e){this.center.curve(e);this.up.curve(e);this.right.curve(e);this.radius.curve(e);this.angle.curve(e);var t=this.computedUp;var r=this.computedRight;var a=0;var n=0;for(var i=0;i<3;++i){n+=t[i]*r[i];a+=t[i]*t[i]}var l=Math.sqrt(a);var c=0;for(var i=0;i<3;++i){r[i]-=t[i]*n/a;c+=r[i]*r[i];t[i]/=l}var f=Math.sqrt(c);for(var i=0;i<3;++i){r[i]/=f}var h=this.computedToward;o(h,t,r);s(h,h);var p=Math.exp(this.computedRadius[0]);var v=this.computedAngle[0];var d=this.computedAngle[1];var m=Math.cos(v);var g=Math.sin(v);var y=Math.cos(d);var x=Math.sin(d);var b=this.computedCenter;var _=m*y;var w=g*y;var T=x;var k=-m*x;var M=-g*x;var A=y;var S=this.computedEye;var E=this.computedMatrix;for(var i=0;i<3;++i){var L=_*r[i]+w*h[i]+T*t[i];E[4*i+1]=k*r[i]+M*h[i]+A*t[i];E[4*i+2]=L;E[4*i+3]=0}var C=E[1];var I=E[5];var P=E[9];var O=E[2];var z=E[6];var D=E[10];var R=I*D-P*z;var F=P*O-C*D;var B=C*z-I*O;var N=u(R,F,B);R/=N;F/=N;B/=N;E[0]=R;E[4]=F;E[8]=B;for(var i=0;i<3;++i){S[i]=b[i]+E[2+4*i]*p}for(var i=0;i<3;++i){var c=0;for(var j=0;j<3;++j){c+=E[i+4*j]*S[j]}E[12+i]=-c}E[15]=1};p.getMatrix=function(e,t){this.recalcMatrix(e);var r=this.computedMatrix;if(t){for(var a=0;a<16;++a){t[a]=r[a]}return t}return r};var v=[0,0,0];p.rotate=function(e,t,r,a){this.angle.move(e,t,r);if(a){this.recalcMatrix(e);var n=this.computedMatrix;v[0]=n[2];v[1]=n[6];v[2]=n[10];var o=this.computedUp;var s=this.computedRight;var l=this.computedToward;for(var u=0;u<3;++u){n[4*u]=o[u];n[4*u+1]=s[u];n[4*u+2]=l[u]}i(n,n,a,v);for(var u=0;u<3;++u){o[u]=n[4*u];s[u]=n[4*u+1]}this.up.set(e,o[0],o[1],o[2]);this.right.set(e,s[0],s[1],s[2])}};p.pan=function(e,t,r,a){t=t||0;r=r||0;a=a||0;this.recalcMatrix(e);var n=this.computedMatrix;var i=Math.exp(this.computedRadius[0]);var o=n[1];var s=n[5];var l=n[9];var c=u(o,s,l);o/=c;s/=c;l/=c;var f=n[0];var h=n[4];var p=n[8];var v=f*o+h*s+p*l;f-=o*v;h-=s*v;p-=l*v;var d=u(f,h,p);f/=d;h/=d;p/=d;var m=f*t+o*r;var g=h*t+s*r;var y=p*t+l*r;this.center.move(e,m,g,y);var x=Math.exp(this.computedRadius[0]);x=Math.max(1e-4,x+a);this.radius.set(e,Math.log(x))};p.translate=function(e,t,r,a){this.center.move(e,t||0,r||0,a||0)};p.setMatrix=function(e,t,r,a){var i=1;if(typeof r==="number"){i=r|0}if(i<0||i>3){i=1}var o=(i+2)%3;var s=(i+1)%3;if(!t){this.recalcMatrix(e);t=this.computedMatrix}var l=t[i];var f=t[i+4];var h=t[i+8];if(!a){var p=u(l,f,h);l/=p;f/=p;h/=p}else{var v=Math.abs(l);var d=Math.abs(f);var m=Math.abs(h);var g=Math.max(v,d,m);if(v===g){l=l<0?-1:1;f=h=0}else if(m===g){h=h<0?-1:1;l=f=0}else{f=f<0?-1:1;l=h=0}}var y=t[o];var x=t[o+4];var b=t[o+8];var _=y*l+x*f+b*h;y-=l*_;x-=f*_;b-=h*_;var w=u(y,x,b);y/=w;x/=w;b/=w;var T=f*b-h*x;var k=h*y-l*b;var M=l*x-f*y;var A=u(T,k,M);T/=A;k/=A;M/=A;this.center.jump(e,G,Y,W);this.radius.idle(e);this.up.jump(e,l,f,h);this.right.jump(e,y,x,b);var S,E;if(i===2){var L=t[1];var C=t[5];var I=t[9];var P=L*y+C*x+I*b;var O=L*T+C*k+I*M;if(F<0){S=-Math.PI/2}else{S=Math.PI/2}E=Math.atan2(O,P)}else{var z=t[2];var D=t[6];var R=t[10];var F=z*l+D*f+R*h;var B=z*y+D*x+R*b;var N=z*T+D*k+R*M;S=Math.asin(c(F));E=Math.atan2(N,B)}this.angle.jump(e,E,S);this.recalcMatrix(e);var j=t[2];var U=t[6];var V=t[10];var H=this.computedMatrix;n(H,t);var q=H[15];var G=H[12]/q;var Y=H[13]/q;var W=H[14]/q;var X=Math.exp(this.computedRadius[0]);this.center.jump(e,G-j*X,Y-U*X,W-V*X)};p.lastT=function(){return Math.max(this.center.lastT(),this.up.lastT(),this.right.lastT(),this.radius.lastT(),this.angle.lastT())};p.idle=function(e){this.center.idle(e);this.up.idle(e);this.right.idle(e);this.radius.idle(e);this.angle.idle(e)};p.flush=function(e){this.center.flush(e);this.up.flush(e);this.right.flush(e);this.radius.flush(e);this.angle.flush(e)};p.setDistance=function(e,t){if(t>0){this.radius.set(e,Math.log(t))}};p.lookAt=function(e,t,r,a){this.recalcMatrix(e);t=t||this.computedEye;r=r||this.computedCenter;a=a||this.computedUp;var n=a[0];var i=a[1];var o=a[2];var s=u(n,i,o);if(s<1e-6){return}n/=s;i/=s;o/=s;var l=t[0]-r[0];var f=t[1]-r[1];var h=t[2]-r[2];var p=u(l,f,h);if(p<1e-6){return}l/=p;f/=p;h/=p;var v=this.computedRight;var d=v[0];var m=v[1];var g=v[2];var y=n*d+i*m+o*g;d-=y*n;m-=y*i;g-=y*o;var x=u(d,m,g);if(x<.01){d=i*h-o*f;m=o*l-n*h;g=n*f-i*l;x=u(d,m,g);if(x<1e-6){return}}d/=x;m/=x;g/=x;this.up.set(e,n,i,o);this.right.set(e,d,m,g);this.center.set(e,r[0],r[1],r[2]);this.radius.set(e,Math.log(p));var b=i*g-o*m;var _=o*d-n*g;var w=n*m-i*d;var T=u(b,_,w);b/=T;_/=T;w/=T;var k=n*l+i*f+o*h;var M=d*l+m*f+g*h;var A=b*l+_*f+w*h;var S=Math.asin(c(k));var E=Math.atan2(A,M);var L=this.angle._state;var C=L[L.length-1];var I=L[L.length-2];C=C%(2*Math.PI);var P=Math.abs(C+2*Math.PI-E);var O=Math.abs(C-E);var z=Math.abs(C-2*Math.PI-E);if(P<O){C+=2*Math.PI}if(z<O){C-=2*Math.PI}this.angle.jump(this.angle.lastT(),C,I);this.angle.set(e,E,S)};function d(e){e=e||{};var t=e.center||[0,0,0];var r=e.up||[0,1,0];var a=e.right||f(r);var n=e.radius||1;var i=e.theta||0;var c=e.phi||0;t=[].slice.call(t,0,3);r=[].slice.call(r,0,3);s(r,r);a=[].slice.call(a,0,3);s(a,a);if("eye"in e){var p=e.eye;var v=[p[0]-t[0],p[1]-t[1],p[2]-t[2]];o(a,v,r);if(u(a[0],a[1],a[2])<1e-6){a=f(r)}else{s(a,a)}n=u(v[0],v[1],v[2]);var d=l(r,v)/n;var m=l(a,v)/n;c=Math.acos(d);i=Math.acos(m)}n=Math.log(n);return new h(e.zoomMin,e.zoomMax,t,r,a,n,i,c)}},{"filtered-vector":247,"gl-mat4/invert":293,"gl-mat4/rotate":299,"gl-vec3/cross":360,"gl-vec3/dot":365,"gl-vec3/normalize":382}],588:[function(e,t,r){"use strict";t.exports=n;var a=+(Math.pow(2,27)+1);function n(e,t,r){var n=e*t;var i=a*e;var o=i-e;var s=i-o;var l=e-s;var u=a*t;var c=u-t;var f=u-c;var h=t-f;var p=n-s*f;var v=p-l*f;var d=v-s*h;var m=l*h-d;if(r){r[0]=m;r[1]=n;return r}return[m,n]}},{}],589:[function(e,t,r){"use strict";t.exports=a;function a(e,t,r){var a=e+t;var n=a-e;var i=a-n;var o=t-n;var s=e-i;if(r){r[0]=s+o;r[1]=a;return r}return[s+o,a]}},{}],590:[function(e,t,r){"use strict";var a=e("../prototype/is");t.exports=function(e){if(typeof e!=="function")return false;if(!hasOwnProperty.call(e,"length"))return false;try{if(typeof e.length!=="number")return false;if(typeof e.call!=="function")return false;if(typeof e.apply!=="function")return false}catch(t){return false}return!a(e)}},{"../prototype/is":597}],591:[function(e,t,r){"use strict";var a=e("../value/is"),n=e("../object/is"),i=e("../string/coerce"),o=e("./to-short-string");var s=function(e,t){return e.replace("%v",o(t))};t.exports=function(e,t,r){if(!n(r))throw new TypeError(s(t,e));if(!a(e)){if("default"in r)return r["default"];if(r.isOptional)return null}var o=i(r.errorMessage);if(!a(o))o=t;throw new TypeError(s(o,e))}},{"../object/is":594,"../string/coerce":598,"../value/is":600,"./to-short-string":593}],592:[function(e,t,r){"use strict";t.exports=function(e){try{return e.toString()}catch(t){try{return String(e)}catch(r){return null}}}},{}],593:[function(e,t,r){"use strict";var a=e("./safe-to-string");var n=/[\n\r\u2028\u2029]/g;t.exports=function(e){var t=a(e);if(t===null)return"<Non-coercible to string value>";if(t.length>100)t=t.slice(0,99)+"…";t=t.replace(n,(function(e){switch(e){case"\n":return"\\n";case"\r":return"\\r";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw new Error("Unexpected character")}}));return t}},{"./safe-to-string":592}],594:[function(e,t,r){"use strict";var a=e("../value/is");var n={object:true,function:true,undefined:true};t.exports=function(e){if(!a(e))return false;return hasOwnProperty.call(n,typeof e)}},{"../value/is":600}],595:[function(e,t,r){"use strict";var a=e("../lib/resolve-exception"),n=e("./is");t.exports=function(e){if(n(e))return e;return a(e,"%v is not a plain function",arguments[1])}},{"../lib/resolve-exception":591,"./is":596}],596:[function(e,t,r){"use strict";var a=e("../function/is");var n=/^\s*class[\s{/}]/,i=Function.prototype.toString;t.exports=function(e){if(!a(e))return false;if(n.test(i.call(e)))return false;return true}},{"../function/is":590}],597:[function(e,t,r){"use strict";var a=e("../object/is");t.exports=function(e){if(!a(e))return false;try{if(!e.constructor)return false;return e.constructor.prototype===e}catch(t){return false}}},{"../object/is":594}],598:[function(e,t,r){"use strict";var a=e("../value/is"),n=e("../object/is");var i=Object.prototype.toString;t.exports=function(e){if(!a(e))return null;if(n(e)){var t=e.toString;if(typeof t!=="function")return null;if(t===i)return null}try{return""+e}catch(r){return null}}},{"../object/is":594,"../value/is":600}],599:[function(e,t,r){"use strict";var a=e("../lib/resolve-exception"),n=e("./is");t.exports=function(e){if(n(e))return e;return a(e,"Cannot use %v",arguments[1])}},{"../lib/resolve-exception":591,"./is":600}],600:[function(e,t,r){"use strict";var a=void 0;t.exports=function(e){return e!==a&&e!==null}},{}],601:[function(e,r,a){(function(t){(function(){"use strict";var r=e("bit-twiddle");var n=e("dup");var i=e("buffer").Buffer;if(!t.__TYPEDARRAY_POOL){t.__TYPEDARRAY_POOL={UINT8:n([32,0]),UINT16:n([32,0]),UINT32:n([32,0]),BIGUINT64:n([32,0]),INT8:n([32,0]),INT16:n([32,0]),INT32:n([32,0]),BIGINT64:n([32,0]),FLOAT:n([32,0]),DOUBLE:n([32,0]),DATA:n([32,0]),UINT8C:n([32,0]),BUFFER:n([32,0])}}var o=typeof Uint8ClampedArray!=="undefined";var s=typeof BigUint64Array!=="undefined";var l=typeof BigInt64Array!=="undefined";var u=t.__TYPEDARRAY_POOL;if(!u.UINT8C){u.UINT8C=n([32,0])}if(!u.BIGUINT64){u.BIGUINT64=n([32,0])}if(!u.BIGINT64){u.BIGINT64=n([32,0])}if(!u.BUFFER){u.BUFFER=n([32,0])}var c=u.DATA,f=u.BUFFER;a.free=function e(t){if(i.isBuffer(t)){f[r.log2(t.length)].push(t)}else{if(Object.prototype.toString.call(t)!=="[object ArrayBuffer]"){t=t.buffer}if(!t){return}var a=t.length||t.byteLength;var n=r.log2(a)|0;c[n].push(t)}};function h(e){if(!e){return}var t=e.length||e.byteLength;var a=r.log2(t);c[a].push(e)}function p(e){h(e.buffer)}a.freeUint8=a.freeUint16=a.freeUint32=a.freeBigUint64=a.freeInt8=a.freeInt16=a.freeInt32=a.freeBigInt64=a.freeFloat32=a.freeFloat=a.freeFloat64=a.freeDouble=a.freeUint8Clamped=a.freeDataView=p;a.freeArrayBuffer=h;a.freeBuffer=function e(t){f[r.log2(t.length)].push(t)};a.malloc=function e(t,r){if(r===undefined||r==="arraybuffer"){return v(t)}else{switch(r){case"uint8":return d(t);case"uint16":return m(t);case"uint32":return g(t);case"int8":return y(t);case"int16":return x(t);case"int32":return b(t);case"float":case"float32":return _(t);case"double":case"float64":return w(t);case"uint8_clamped":return T(t);case"bigint64":return M(t);case"biguint64":return k(t);case"buffer":return S(t);case"data":case"dataview":return A(t);default:return null}}return null};function v(e){var e=r.nextPow2(e);var t=r.log2(e);var a=c[t];if(a.length>0){return a.pop()}return new ArrayBuffer(e)}a.mallocArrayBuffer=v;function d(e){return new Uint8Array(v(e),0,e)}a.mallocUint8=d;function m(e){return new Uint16Array(v(2*e),0,e)}a.mallocUint16=m;function g(e){return new Uint32Array(v(4*e),0,e)}a.mallocUint32=g;function y(e){return new Int8Array(v(e),0,e)}a.mallocInt8=y;function x(e){return new Int16Array(v(2*e),0,e)}a.mallocInt16=x;function b(e){return new Int32Array(v(4*e),0,e)}a.mallocInt32=b;function _(e){return new Float32Array(v(4*e),0,e)}a.mallocFloat32=a.mallocFloat=_;function w(e){return new Float64Array(v(8*e),0,e)}a.mallocFloat64=a.mallocDouble=w;function T(e){if(o){return new Uint8ClampedArray(v(e),0,e)}else{return d(e)}}a.mallocUint8Clamped=T;function k(e){if(s){return new BigUint64Array(v(8*e),0,e)}else{return null}}a.mallocBigUint64=k;function M(e){if(l){return new BigInt64Array(v(8*e),0,e)}else{return null}}a.mallocBigInt64=M;function A(e){return new DataView(v(e),0,e)}a.mallocDataView=A;function S(e){e=r.nextPow2(e);var t=r.log2(e);var a=f[t];if(a.length>0){return a.pop()}return new i(e)}a.mallocBuffer=S;a.clearCache=function e(){for(var t=0;t<32;++t){u.UINT8[t].length=0;u.UINT16[t].length=0;u.UINT32[t].length=0;u.INT8[t].length=0;u.INT16[t].length=0;u.INT32[t].length=0;u.FLOAT[t].length=0;u.DOUBLE[t].length=0;u.BIGUINT64[t].length=0;u.BIGINT64[t].length=0;u.UINT8C[t].length=0;c[t].length=0;f[t].length=0}}}).call(this)}).call(this,typeof t!=="undefined"?t:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"bit-twiddle":104,buffer:117,dup:182}],602:[function(e,t,r){"use strict";"use restrict";t.exports=a;function a(e){this.roots=new Array(e);this.ranks=new Array(e);for(var t=0;t<e;++t){this.roots[t]=t;this.ranks[t]=0}}var n=a.prototype;Object.defineProperty(n,"length",{get:function(){return this.roots.length}});n.makeSet=function(){var e=this.roots.length;this.roots.push(e);this.ranks.push(0);return e};n.find=function(e){var t=e;var r=this.roots;while(r[e]!==e){e=r[e]}while(r[t]!==e){var a=r[t];r[t]=e;t=a}return e};n.link=function(e,t){var r=this.find(e),a=this.find(t);if(r===a){return}var n=this.ranks,i=this.roots,o=n[r],s=n[a];if(o<s){i[r]=a}else if(s<o){i[a]=r}else{i[a]=r;++n[r]}}},{}],603:[function(e,t,r){"use strict";function a(e,t){var r=1,a=e.length,n=e[0],i=e[0];for(var o=1;o<a;++o){i=n;n=e[o];if(t(n,i)){if(o===r){r++;continue}e[r++]=n}}e.length=r;return e}function n(e){var t=1,r=e.length,a=e[0],n=e[0];for(var i=1;i<r;++i,n=a){n=a;a=e[i];if(a!==n){if(i===t){t++;continue}e[t++]=a}}e.length=t;return e}function i(e,t,r){if(e.length===0){return e}if(t){if(!r){e.sort(t)}return a(e,t)}if(!r){e.sort()}return n(e)}t.exports=i},{}],604:[function(e,t,r){var a=/[\'\"]/;t.exports=function e(t){if(!t){return""}if(a.test(t.charAt(0))){t=t.substr(1)}if(a.test(t.charAt(t.length-1))){t=t.substr(0,t.length-1)}return t}},{}],605:[function(e,t,r){"use strict";t.exports=function e(t,r,a){if(!Array.isArray(a))a=[].slice.call(arguments,2);for(var n=0,i=a.length;n<i;n++){var o=a[n];for(var s in o){if(r[s]!==undefined&&!Array.isArray(r[s])&&t[s]===r[s])continue;if(s in r){var l;if(o[s]===true)l=r[s];else if(o[s]===false)continue;else if(typeof o[s]==="function"){l=o[s](r[s],t,r);if(l===undefined)continue}t[s]=l}}}return t}},{}],606:[function(e,r,a){(function(e){(function(){r.exports=t;function t(e,t){if(a("noDeprecation")){return e}var r=false;function n(){if(!r){if(a("throwDeprecation")){throw new Error(t)}else if(a("traceDeprecation")){console.trace(t)}else{console.warn(t)}r=true}return e.apply(this,arguments)}return n}function a(t){try{if(!e.localStorage)return false}catch(a){return false}var r=e.localStorage[t];if(null==r)return false;return String(r).toLowerCase()==="true"}}).call(this)}).call(this,typeof t!=="undefined"?t:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],607:[function(e,t,r){"use strict";t.exports=o;var a=e("./lib/vtext");var n=null;var i=null;if(typeof document!=="undefined"){n=document.createElement("canvas");n.width=8192;n.height=1024;i=n.getContext("2d")}function o(e,t){if(typeof t!=="object"||t===null){t={}}return a(e,t.canvas||n,t.context||i,t)}},{"./lib/vtext":608}],608:[function(e,t,r){t.exports=M;t.exports.processPixels=k;var a=e("surface-nets");var n=e("ndarray");var i=e("simplify-planar-graph");var o=e("clean-pslg");var s=e("cdt2d");var l=e("planar-graph-to-polyline");var u="b";var c="b|";var f="i";var h="i|";var p="sup";var v="+";var d="+1";var m="sub";var g="-";var y="-1";function x(e,t,r,a){var n="<"+e+">";var i="</"+e+">";var o=n.length;var s=i.length;var l=t[0]===v||t[0]===g;var u=0;var c=-s;while(u>-1){u=r.indexOf(n,u);if(u===-1)break;c=r.indexOf(i,u+o);if(c===-1)break;if(c<=u)break;for(var f=u;f<c+s;++f){if(f<u+o||f>=c){a[f]=null;r=r.substr(0,f)+" "+r.substr(f+1)}else{if(a[f]!==null){var h=a[f].indexOf(t[0]);if(h===-1){a[f]+=t}else{if(l){a[f]=a[f].substr(0,h+1)+(1+parseInt(a[f][h+1]))+a[f].substr(h+2)}}}}}var p=u+o;var d=r.substr(p,c-p);var m=d.indexOf(n);if(m!==-1)u=m;else u=c+s}return a}function b(e,t,r){var a=t.textAlign||"start";var n=t.textBaseline||"alphabetic";var i=[1<<30,1<<30];var o=[0,0];var s=e.length;for(var l=0;l<s;++l){var u=e[l];for(var c=0;c<2;++c){i[c]=Math.min(i[c],u[c])|0;o[c]=Math.max(o[c],u[c])|0}}var f=0;switch(a){case"center":f=-.5*(i[0]+o[0]);break;case"right":case"end":f=-o[0];break;case"left":case"start":f=-i[0];break;default:throw new Error("vectorize-text: Unrecognized textAlign: '"+a+"'")}var h=0;switch(n){case"hanging":case"top":h=-i[1];break;case"middle":h=-.5*(i[1]+o[1]);break;case"alphabetic":case"ideographic":h=-3*r;break;case"bottom":h=-o[1];break;default:throw new Error("vectorize-text: Unrecoginized textBaseline: '"+n+"'")}var p=1/r;if("lineHeight"in t){p*=+t.lineHeight}else if("width"in t){p=t.width/(o[0]-i[0])}else if("height"in t){p=t.height/(o[1]-i[1])}return e.map((function(e){return[p*(e[0]+f),p*(e[1]+h)]}))}function _(e,t,r,a,i,o){r=r.replace(/\n/g,"");if(o.breaklines===true){r=r.replace(/\<br\>/g,"\n")}else{r=r.replace(/\<br\>/g," ")}var s="";var l=[];for(C=0;C<r.length;++C){l[C]=s}if(o.bolds===true)l=x(u,c,r,l);if(o.italics===true)l=x(f,h,r,l);if(o.superscripts===true)l=x(p,d,r,l);if(o.subscripts===true)l=x(m,y,r,l);var b=[];var _="";for(C=0;C<r.length;++C){if(l[C]!==null){_+=r[C];b.push(l[C])}}var w=_.split("\n");var T=w.length;var k=Math.round(i*a);var M=a;var A=a*2;var S=0;var E=T*k+A;if(e.height<E){e.height=E}t.fillStyle="#000";t.fillRect(0,0,e.width,e.height);t.fillStyle="#fff";var L,C,I,P,O;var z=0;var D="";function R(){if(D!==""){var e=t.measureText(D).width;t.fillText(D,M+I,A+P);I+=e}}function F(){return""+Math.round(O)+"px "}function B(e,r){var a=""+t.font;if(o.subscripts===true){var n=e.indexOf(g);var i=r.indexOf(g);var s=n>-1?parseInt(e[1+n]):0;var l=i>-1?parseInt(r[1+i]):0;if(s!==l){a=a.replace(F(),"?px ");O*=Math.pow(.75,l-s);a=a.replace("?px ",F())}P+=.25*k*(l-s)}if(o.superscripts===true){var u=e.indexOf(v);var f=r.indexOf(v);var p=u>-1?parseInt(e[1+u]):0;var d=f>-1?parseInt(r[1+f]):0;if(p!==d){a=a.replace(F(),"?px ");O*=Math.pow(.75,d-p);a=a.replace("?px ",F())}P-=.25*k*(d-p)}if(o.bolds===true){var m=e.indexOf(c)>-1;var y=r.indexOf(c)>-1;if(!m&&y){if(x){a=a.replace("italic ","italic bold ")}else{a="bold "+a}}if(m&&!y){a=a.replace("bold ","")}}if(o.italics===true){var x=e.indexOf(h)>-1;var b=r.indexOf(h)>-1;if(!x&&b){a="italic "+a}if(x&&!b){a=a.replace("italic ","")}}t.font=a}for(L=0;L<T;++L){var N=w[L]+"\n";I=0;P=L*k;O=a;D="";for(C=0;C<N.length;++C){var j=C+z<b.length?b[C+z]:b[b.length-1];if(s===j){D+=N[C]}else{R();D=N[C];if(j!==undefined){B(s,j);s=j}}}R();z+=N.length;var U=Math.round(I+2*M)|0;if(S<U)S=U}var V=S;var H=A+k*T;var q=n(t.getImageData(0,0,V,H).data,[H,V,4]);return q.pick(-1,-1,0).transpose(1,0)}function w(e,t){var r=a(e,128);if(t){return i(r.cells,r.positions,.25)}return{edges:r.cells,positions:r.positions}}function T(e,t,r,a){var n=w(e,a);var i=b(n.positions,t,r);var u=n.edges;var c="ccw"===t.orientation;o(i,u);if(t.polygons||t.polygon||t.polyline){var f=l(u,i);var h=new Array(f.length);for(var p=0;p<f.length;++p){var v=f[p];var d=new Array(v.length);for(var m=0;m<v.length;++m){var g=v[m];var y=new Array(g.length);for(var x=0;x<g.length;++x){y[x]=i[g[x]].slice()}if(c){y.reverse()}d[m]=y}h[p]=d}return h}else if(t.triangles||t.triangulate||t.triangle){return{cells:s(i,u,{delaunay:false,exterior:false,interior:true}),positions:i}}else{return{edges:u,positions:i}}}function k(e,t,r){try{return T(e,t,r,true)}catch(a){}try{return T(e,t,r,false)}catch(a){}if(t.polygons||t.polyline||t.polygon){return[]}if(t.triangles||t.triangulate||t.triangle){return{cells:[],positions:[]}}return{edges:[],positions:[]}}function M(e,t,r,a){var n=64;var i=1.25;var o={breaklines:false,bolds:false,italics:false,subscripts:false,superscripts:false};if(a){if(a.size&&a.size>0)n=a.size;if(a.lineSpacing&&a.lineSpacing>0)i=a.lineSpacing;if(a.styletags&&a.styletags.breaklines)o.breaklines=a.styletags.breaklines?true:false;if(a.styletags&&a.styletags.bolds)o.bolds=a.styletags.bolds?true:false;if(a.styletags&&a.styletags.italics)o.italics=a.styletags.italics?true:false;if(a.styletags&&a.styletags.subscripts)o.subscripts=a.styletags.subscripts?true:false;if(a.styletags&&a.styletags.superscripts)o.superscripts=a.styletags.superscripts?true:false}r.font=[a.fontStyle,a.fontVariant,a.fontWeight,n+"px",a.font].filter((function(e){return e})).join(" ");r.textAlign="start";r.textBaseline="alphabetic";r.direction="ltr";var s=_(t,r,e,n,i,o);return k(s,a,n)}},{cdt2d:118,"clean-pslg":127,ndarray:472,"planar-graph-to-polyline":488,"simplify-planar-graph":549,"surface-nets":576}],609:[function(e,t,r){(function e(){"use strict";if(typeof ses!=="undefined"&&ses.ok&&!ses.ok()){return}function r(e){if(e.permitHostObjects___){e.permitHostObjects___(r)}}if(typeof ses!=="undefined"){ses.weakMapPermitHostObjects=r}var a=false;if(typeof WeakMap==="function"){var n=WeakMap;if(typeof navigator!=="undefined"&&/Firefox/.test(navigator.userAgent)){}else{var i=new n;var o=Object.freeze({});i.set(o,1);if(i.get(o)!==1){a=true}else{t.exports=WeakMap;return}}}var s=Object.prototype.hasOwnProperty;var l=Object.getOwnPropertyNames;var u=Object.defineProperty;var c=Object.isExtensible;var f="weakmap:";var h=f+"ident:"+Math.random()+"___";if(typeof crypto!=="undefined"&&typeof crypto.getRandomValues==="function"&&typeof ArrayBuffer==="function"&&typeof Uint8Array==="function"){var p=new ArrayBuffer(25);var v=new Uint8Array(p);crypto.getRandomValues(v);h=f+"rand:"+Array.prototype.map.call(v,(function(e){return(e%36).toString(36)})).join("")+"___"}function d(e){return!(e.substr(0,f.length)==f&&e.substr(e.length-3)==="___")}u(Object,"getOwnPropertyNames",{value:function e(t){return l(t).filter(d)}});if("getPropertyNames"in Object){var m=Object.getPropertyNames;u(Object,"getPropertyNames",{value:function e(t){return m(t).filter(d)}})}function g(e){if(e!==Object(e)){throw new TypeError("Not an object: "+e)}var t=e[h];if(t&&t.key===e){return t}if(!c(e)){return void 0}t={key:e};try{u(e,h,{value:t,writable:false,enumerable:false,configurable:false});return t}catch(r){return void 0}}(function(){var e=Object.freeze;u(Object,"freeze",{value:function t(r){g(r);return e(r)}});var t=Object.seal;u(Object,"seal",{value:function e(r){g(r);return t(r)}});var r=Object.preventExtensions;u(Object,"preventExtensions",{value:function e(t){g(t);return r(t)}})})();function y(e){e.prototype=null;return Object.freeze(e)}var x=false;function b(){if(!x&&typeof console!=="undefined"){x=true;console.warn("WeakMap should be invoked as new WeakMap(), not "+"WeakMap(). This will be an error in the future.")}}var _=0;var w=function(){if(!(this instanceof w)){b()}var e=[];var t=[];var r=_++;function a(a,n){var i;var o=g(a);if(o){return r in o?o[r]:n}else{i=e.indexOf(a);return i>=0?t[i]:n}}function n(t){var a=g(t);if(a){return r in a}else{return e.indexOf(t)>=0}}function i(a,n){var i;var o=g(a);if(o){o[r]=n}else{i=e.indexOf(a);if(i>=0){t[i]=n}else{i=e.length;t[i]=n;e[i]=a}}return this}function o(a){var n=g(a);var i,o;if(n){return r in n&&delete n[r]}else{i=e.indexOf(a);if(i<0){return false}o=e.length-1;e[i]=void 0;t[i]=t[o];e[i]=e[o];e.length=o;t.length=o;return true}}return Object.create(w.prototype,{get___:{value:y(a)},has___:{value:y(n)},set___:{value:y(i)},delete___:{value:y(o)}})};w.prototype=Object.create(Object.prototype,{get:{value:function e(t,r){return this.get___(t,r)},writable:true,configurable:true},has:{value:function e(t){return this.has___(t)},writable:true,configurable:true},set:{value:function e(t,r){return this.set___(t,r)},writable:true,configurable:true},delete:{value:function e(t){return this.delete___(t)},writable:true,configurable:true}});if(typeof n==="function"){(function(){if(a&&typeof Proxy!=="undefined"){Proxy=undefined}function e(){if(!(this instanceof w)){b()}var e=new n;var t=undefined;var i=false;function o(r,a){if(t){return e.has(r)?e.get(r):t.get___(r,a)}else{return e.get(r,a)}}function s(r){return e.has(r)||(t?t.has___(r):false)}var l;if(a){l=function(r,a){e.set(r,a);if(!e.has(r)){if(!t){t=new w}t.set(r,a)}return this}}else{l=function(r,a){if(i){try{e.set(r,a)}catch(n){if(!t){t=new w}t.set___(r,a)}}else{e.set(r,a)}return this}}function u(r){var a=!!e["delete"](r);if(t){return t.delete___(r)||a}return a}return Object.create(w.prototype,{get___:{value:y(o)},has___:{value:y(s)},set___:{value:y(l)},delete___:{value:y(u)},permitHostObjects___:{value:y((function(e){if(e===r){i=true}else{throw new Error("bogus call to permitHostObjects___")}}))}})}e.prototype=w.prototype;t.exports=e;Object.defineProperty(WeakMap.prototype,"constructor",{value:WeakMap,enumerable:false,configurable:true,writable:true})})()}else{if(typeof Proxy!=="undefined"){Proxy=undefined}t.exports=w}})()},{}],610:[function(e,t,r){var a=e("./hidden-store.js");t.exports=n;function n(){var e={};return function(t){if((typeof t!=="object"||t===null)&&typeof t!=="function"){throw new Error("Weakmap-shim: Key must be object")}var r=t.valueOf(e);return r&&r.identity===e?r:a(t,e)}}},{"./hidden-store.js":611}],611:[function(e,t,r){t.exports=a;function a(e,t){var r={identity:t};var a=e.valueOf;Object.defineProperty(e,"valueOf",{value:function(e){return e!==t?a.apply(this,arguments):r},writable:true});return r}},{}],612:[function(e,t,r){var a=e("./create-store.js");t.exports=n;function n(){var e=a();return{get:function(t,r){var a=e(t);return a.hasOwnProperty("value")?a.value:r},set:function(t,r){e(t).value=r;return this},has:function(t){return"value"in e(t)},delete:function(t){return delete e(t).value}}}},{"./create-store.js":610}],613:[function(e,t,r){var a=e("get-canvas-context");t.exports=function e(t){return a("webgl",t)}},{"get-canvas-context":252}],614:[function(e,t,r){var a=e("../main");var n=e("object-assign");var i=a.instance();function o(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}o.prototype=new a.baseCalendar;n(o.prototype,{name:"Chinese",jdEpoch:1721425.5,hasYearZero:false,minMonth:0,firstMonth:0,minDay:1,regionalOptions:{"":{name:"Chinese",epochs:["BEC","EC"],monthNumbers:function(e,t){if(typeof e==="string"){var r=e.match(l);return r?r[0]:""}var a=this._validateYear(e);var n=e.month();var i=""+this.toChineseMonth(a,n);if(t&&i.length<2){i="0"+i}if(this.isIntercalaryMonth(a,n)){i+="i"}return i},monthNames:function(e){if(typeof e==="string"){var t=e.match(u);return t?t[0]:""}var r=this._validateYear(e);var a=e.month();var n=this.toChineseMonth(r,a);var i=["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"][n-1];if(this.isIntercalaryMonth(r,a)){i="闰"+i}return i},monthNamesShort:function(e){if(typeof e==="string"){var t=e.match(c);return t?t[0]:""}var r=this._validateYear(e);var a=e.month();var n=this.toChineseMonth(r,a);var i=["一","二","三","四","五","六","七","八","九","十","十一","十二"][n-1];if(this.isIntercalaryMonth(r,a)){i="闰"+i}return i},parseMonth:function(e,t){e=this._validateYear(e);var r=parseInt(t);var a;if(!isNaN(r)){var n=t[t.length-1];a=n==="i"||n==="I"}else{if(t[0]==="闰"){a=true;t=t.substring(1)}if(t[t.length-1]==="月"){t=t.substring(0,t.length-1)}r=1+["一","二","三","四","五","六","七","八","九","十","十一","十二"].indexOf(t)}var i=this.toMonthIndex(e,r,a);return i},dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:1,isRTL:false}},_validateYear:function(e,t){if(e.year){e=e.year()}if(typeof e!=="number"||e<1888||e>2111){throw t.replace(/\{0\}/,this.local.name)}return e},toMonthIndex:function(e,t,r){var n=this.intercalaryMonth(e);var i=r&&t!==n;if(i||t<1||t>12){throw a.local.invalidMonth.replace(/\{0\}/,this.local.name)}var o;if(!n){o=t-1}else if(!r&&t<=n){o=t-1}else{o=t}return o},toChineseMonth:function(e,t){if(e.year){e=e.year();t=e.month()}var r=this.intercalaryMonth(e);var n=r?12:11;if(t<0||t>n){throw a.local.invalidMonth.replace(/\{0\}/,this.local.name)}var i;if(!r){i=t+1}else if(t<r){i=t+1}else{i=t}return i},intercalaryMonth:function(e){e=this._validateYear(e);var t=f[e-f[0]];var r=t>>13;return r},isIntercalaryMonth:function(e,t){if(e.year){e=e.year();t=e.month()}var r=this.intercalaryMonth(e);return!!r&&r===t},leapYear:function(e){return this.intercalaryMonth(e)!==0},weekOfYear:function(e,t,r){var n=this._validateYear(e,a.local.invalidyear);var o=h[n-h[0]];var s=o>>9&4095;var l=o>>5&15;var u=o&31;var c;c=i.newDate(s,l,u);c.add(4-(c.dayOfWeek()||7),"d");var f=this.toJD(e,t,r)-c.toJD();return 1+Math.floor(f/7)},monthsInYear:function(e){return this.leapYear(e)?13:12},daysInMonth:function(e,t){if(e.year){t=e.month();e=e.year()}e=this._validateYear(e);var r=f[e-f[0]];var n=r>>13;var i=n?12:11;if(t>i){throw a.local.invalidMonth.replace(/\{0\}/,this.local.name)}var o=r&1<<12-t?30:29;return o},weekDay:function(e,t,r){return(this.dayOfWeek(e,t,r)||7)<6},toJD:function(e,t,r){var n=this._validate(e,s,r,a.local.invalidDate);e=this._validateYear(n.year());t=n.month();r=n.day();var o=this.isIntercalaryMonth(e,t);var s=this.toChineseMonth(e,t);var l=v(e,s,r,o);return i.toJD(l.year,l.month,l.day)},fromJD:function(e){var t=i.fromJD(e);var r=p(t.year(),t.month(),t.day());var a=this.toMonthIndex(r.year,r.month,r.isIntercalary);return this.newDate(r.year,a,r.day)},fromString:function(e){var t=e.match(s);var r=this._validateYear(+t[1]);var a=+t[2];var n=!!t[3];var i=this.toMonthIndex(r,a,n);var o=+t[4];return this.newDate(r,i,o)},add:function(e,t,r){var a=e.year();var n=e.month();var i=this.isIntercalaryMonth(a,n);var s=this.toChineseMonth(a,n);var l=Object.getPrototypeOf(o.prototype).add.call(this,e,t,r);if(r==="y"){var u=l.year();var c=l.month();var f=this.isIntercalaryMonth(u,s);var h=i&&f?this.toMonthIndex(u,s,true):this.toMonthIndex(u,s,false);if(h!==c){l.month(h)}}return l}});var s=/^\s*(-?\d\d\d\d|\d\d)[-/](\d?\d)([iI]?)[-/](\d?\d)/m;var l=/^\d?\d[iI]?/m;var u=/^闰?十?[一二三四五六七八九]?月/m;var c=/^闰?十?[一二三四五六七八九]?/m;a.calendars.chinese=o;var f=[1887,5780,5802,19157,2742,50359,1198,2646,46378,7466,3412,30122,5482,67949,2396,5294,43597,6732,6954,36181,2772,4954,18781,2396,54427,5274,6730,47781,5800,6868,21210,4790,59703,2350,5270,46667,3402,3496,38325,1388,4782,18735,2350,52374,6804,7498,44457,2906,1388,29294,4700,63789,6442,6804,56138,5802,2772,38235,1210,4698,22827,5418,63125,3476,5802,43701,2484,5302,27223,2646,70954,7466,3412,54698,5482,2412,38062,5294,2636,32038,6954,60245,2772,4826,43357,2394,5274,39501,6730,72357,5800,5844,53978,4790,2358,38039,5270,87627,3402,3496,54708,5484,4782,43311,2350,3222,27978,7498,68965,2904,5484,45677,4700,6444,39573,6804,6986,19285,2772,62811,1210,4698,47403,5418,5780,38570,5546,76469,2420,5302,51799,2646,5414,36501,3412,5546,18869,2412,54446,5276,6732,48422,6822,2900,28010,4826,92509,2394,5274,55883,6730,6820,47956,5812,2778,18779,2358,62615,5270,5450,46757,3492,5556,27318,4718,67887,2350,3222,52554,7498,3428,38252,5468,4700,31022,6444,64149,6804,6986,43861,2772,5338,35421,2650,70955,5418,5780,54954,5546,2740,38074,5302,2646,29991,3366,61011,3412,5546,43445,2412,5294,35406,6732,72998,6820,6996,52586,2778,2396,38045,5274,6698,23333,6820,64338,5812,2746,43355,2358,5270,39499,5450,79525,3492,5548];var h=[1887,966732,967231,967733,968265,968766,969297,969798,970298,970829,971330,971830,972362,972863,973395,973896,974397,974928,975428,975929,976461,976962,977462,977994,978494,979026,979526,980026,980558,981059,981559,982091,982593,983124,983624,984124,984656,985157,985656,986189,986690,987191,987722,988222,988753,989254,989754,990286,990788,991288,991819,992319,992851,993352,993851,994383,994885,995385,995917,996418,996918,997450,997949,998481,998982,999483,1000014,1000515,1001016,1001548,1002047,1002578,1003080,1003580,1004111,1004613,1005113,1005645,1006146,1006645,1007177,1007678,1008209,1008710,1009211,1009743,1010243,1010743,1011275,1011775,1012306,1012807,1013308,1013840,1014341,1014841,1015373,1015874,1016404,1016905,1017405,1017937,1018438,1018939,1019471,1019972,1020471,1021002,1021503,1022035,1022535,1023036,1023568,1024069,1024568,1025100,1025601,1026102,1026633,1027133,1027666,1028167,1028666,1029198,1029699,1030199,1030730,1031231,1031763,1032264,1032764,1033296,1033797,1034297,1034828,1035329,1035830,1036362,1036861,1037393,1037894,1038394,1038925,1039427,1039927,1040459,1040959,1041491,1041992,1042492,1043023,1043524,1044024,1044556,1045057,1045558,1046090,1046590,1047121,1047622,1048122,1048654,1049154,1049655,1050187,1050689,1051219,1051720,1052220,1052751,1053252,1053752,1054284,1054786,1055285,1055817,1056317,1056849,1057349,1057850,1058382,1058883,1059383,1059915,1060415,1060947,1061447,1061947,1062479,1062981,1063480,1064012,1064514,1065014,1065545,1066045,1066577,1067078,1067578,1068110,1068611,1069112,1069642,1070142,1070674,1071175,1071675,1072207,1072709,1073209,1073740,1074241,1074741,1075273,1075773,1076305,1076807,1077308,1077839,1078340,1078840,1079372,1079871,1080403,1080904];function p(e,t,r,a){var n;var i;if(typeof e==="object"){n=e;i=t||{}}else{var o=typeof e==="number"&&e>=1888&&e<=2111;if(!o)throw new Error("Solar year outside range 1888-2111");var s=typeof t==="number"&&t>=1&&t<=12;if(!s)throw new Error("Solar month outside range 1 - 12");var l=typeof r==="number"&&r>=1&&r<=31;if(!l)throw new Error("Solar day outside range 1 - 31");n={year:e,month:t,day:r};i=a||{}}var u=h[n.year-h[0]];var c=n.year<<9|n.month<<5|n.day;i.year=c>=u?n.year:n.year-1;u=h[i.year-h[0]];var p=u>>9&4095;var v=u>>5&15;var d=u&31;var m;var g=new Date(p,v-1,d);var y=new Date(n.year,n.month-1,n.day);m=Math.round((y-g)/(24*3600*1e3));var x=f[i.year-f[0]];var b;for(b=0;b<13;b++){var _=x&1<<12-b?30:29;if(m<_){break}m-=_}var w=x>>13;if(!w||b<w){i.isIntercalary=false;i.month=1+b}else if(b===w){i.isIntercalary=true;i.month=b}else{i.isIntercalary=false;i.month=b}i.day=1+m;return i}function v(e,t,r,a,n){var i;var o;if(typeof e==="object"){o=e;i=t||{}}else{var s=typeof e==="number"&&e>=1888&&e<=2111;if(!s)throw new Error("Lunar year outside range 1888-2111");var l=typeof t==="number"&&t>=1&&t<=12;if(!l)throw new Error("Lunar month outside range 1 - 12");var u=typeof r==="number"&&r>=1&&r<=30;if(!u)throw new Error("Lunar day outside range 1 - 30");var c;if(typeof a==="object"){c=false;i=a}else{c=!!a;i=n||{}}o={year:e,month:t,day:r,isIntercalary:c}}var p;p=o.day-1;var v=f[o.year-f[0]];var d=v>>13;var m;if(!d){m=o.month-1}else if(o.month>d){m=o.month}else if(o.isIntercalary){m=o.month}else{m=o.month-1}for(var g=0;g<m;g++){var y=v&1<<12-g?30:29;p+=y}var x=h[o.year-h[0]];var b=x>>9&4095;var _=x>>5&15;var w=x&31;var T=new Date(b,_-1,w+p);i.year=T.getFullYear();i.month=1+T.getMonth();i.day=T.getDate();return i}},{"../main":628,"object-assign":476}],615:[function(e,t,r){var a=e("../main");var n=e("object-assign");function i(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}i.prototype=new a.baseCalendar;n(i.prototype,{name:"Coptic",jdEpoch:1825029.5,daysPerMonth:[30,30,30,30,30,30,30,30,30,30,30,30,5],hasYearZero:false,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Coptic",epochs:["BAM","AM"],monthNames:["Thout","Paopi","Hathor","Koiak","Tobi","Meshir","Paremhat","Paremoude","Pashons","Paoni","Epip","Mesori","Pi Kogi Enavot"],monthNamesShort:["Tho","Pao","Hath","Koi","Tob","Mesh","Pat","Pad","Pash","Pao","Epi","Meso","PiK"],dayNames:["Tkyriaka","Pesnau","Pshoment","Peftoou","Ptiou","Psoou","Psabbaton"],dayNamesShort:["Tky","Pes","Psh","Pef","Pti","Pso","Psa"],dayNamesMin:["Tk","Pes","Psh","Pef","Pt","Pso","Psa"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:false}},leapYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,a.local.invalidYear);var e=t.year()+(t.year()<0?1:0);return e%4===3||e%4===-1},monthsInYear:function(e){this._validate(e,this.minMonth,this.minDay,a.local.invalidYear||a.regionalOptions[""].invalidYear);return 13},weekOfYear:function(e,t,r){var a=this.newDate(e,t,r);a.add(-a.dayOfWeek(),"d");return Math.floor((a.dayOfYear()-1)/7)+1},daysInMonth:function(e,t){var r=this._validate(e,t,this.minDay,a.local.invalidMonth);return this.daysPerMonth[r.month()-1]+(r.month()===13&&this.leapYear(r.year())?1:0)},weekDay:function(e,t,r){return(this.dayOfWeek(e,t,r)||7)<6},toJD:function(e,t,r){var n=this._validate(e,t,r,a.local.invalidDate);e=n.year();if(e<0){e++}return n.day()+(n.month()-1)*30+(e-1)*365+Math.floor(e/4)+this.jdEpoch-1},fromJD:function(e){var t=Math.floor(e)+.5-this.jdEpoch;var r=Math.floor((t-Math.floor((t+366)/1461))/365)+1;if(r<=0){r--}t=Math.floor(e)+.5-this.newDate(r,1,1).toJD();var a=Math.floor(t/30)+1;var n=t-(a-1)*30+1;return this.newDate(r,a,n)}});a.calendars.coptic=i},{"../main":628,"object-assign":476}],616:[function(e,t,r){var a=e("../main");var n=e("object-assign");function i(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}i.prototype=new a.baseCalendar;n(i.prototype,{name:"Discworld",jdEpoch:1721425.5,daysPerMonth:[16,32,32,32,32,32,32,32,32,32,32,32,32],hasYearZero:false,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Discworld",epochs:["BUC","UC"],monthNames:["Ick","Offle","February","March","April","May","June","Grune","August","Spune","Sektober","Ember","December"],monthNamesShort:["Ick","Off","Feb","Mar","Apr","May","Jun","Gru","Aug","Spu","Sek","Emb","Dec"],dayNames:["Sunday","Octeday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Oct","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Oc","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:2,isRTL:false}},leapYear:function(e){this._validate(e,this.minMonth,this.minDay,a.local.invalidYear);return false},monthsInYear:function(e){this._validate(e,this.minMonth,this.minDay,a.local.invalidYear);return 13},daysInYear:function(e){this._validate(e,this.minMonth,this.minDay,a.local.invalidYear);return 400},weekOfYear:function(e,t,r){var a=this.newDate(e,t,r);a.add(-a.dayOfWeek(),"d");return Math.floor((a.dayOfYear()-1)/8)+1},daysInMonth:function(e,t){var r=this._validate(e,t,this.minDay,a.local.invalidMonth);return this.daysPerMonth[r.month()-1]},daysInWeek:function(){return 8},dayOfWeek:function(e,t,r){var n=this._validate(e,t,r,a.local.invalidDate);return(n.day()+1)%8},weekDay:function(e,t,r){var a=this.dayOfWeek(e,t,r);return a>=2&&a<=6},extraInfo:function(e,t,r){var n=this._validate(e,t,r,a.local.invalidDate);return{century:o[Math.floor((n.year()-1)/100)+1]||""}},toJD:function(e,t,r){var n=this._validate(e,t,r,a.local.invalidDate);e=n.year()+(n.year()<0?1:0);t=n.month();r=n.day();return r+(t>1?16:0)+(t>2?(t-2)*32:0)+(e-1)*400+this.jdEpoch-1},fromJD:function(e){e=Math.floor(e+.5)-Math.floor(this.jdEpoch)-1;var t=Math.floor(e/400)+1;e-=(t-1)*400;e+=e>15?16:0;var r=Math.floor(e/32)+1;var a=e-(r-1)*32+1;return this.newDate(t<=0?t-1:t,r,a)}});var o={20:"Fruitbat",21:"Anchovy"};a.calendars.discworld=i},{"../main":628,"object-assign":476}],617:[function(e,t,r){var a=e("../main");var n=e("object-assign");function i(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}i.prototype=new a.baseCalendar;n(i.prototype,{name:"Ethiopian",jdEpoch:1724220.5,daysPerMonth:[30,30,30,30,30,30,30,30,30,30,30,30,5],hasYearZero:false,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Ethiopian",epochs:["BEE","EE"],monthNames:["Meskerem","Tikemet","Hidar","Tahesas","Tir","Yekatit","Megabit","Miazia","Genbot","Sene","Hamle","Nehase","Pagume"],monthNamesShort:["Mes","Tik","Hid","Tah","Tir","Yek","Meg","Mia","Gen","Sen","Ham","Neh","Pag"],dayNames:["Ehud","Segno","Maksegno","Irob","Hamus","Arb","Kidame"],dayNamesShort:["Ehu","Seg","Mak","Iro","Ham","Arb","Kid"],dayNamesMin:["Eh","Se","Ma","Ir","Ha","Ar","Ki"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:false}},leapYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,a.local.invalidYear);var e=t.year()+(t.year()<0?1:0);return e%4===3||e%4===-1},monthsInYear:function(e){this._validate(e,this.minMonth,this.minDay,a.local.invalidYear||a.regionalOptions[""].invalidYear);return 13},weekOfYear:function(e,t,r){var a=this.newDate(e,t,r);a.add(-a.dayOfWeek(),"d");return Math.floor((a.dayOfYear()-1)/7)+1},daysInMonth:function(e,t){var r=this._validate(e,t,this.minDay,a.local.invalidMonth);return this.daysPerMonth[r.month()-1]+(r.month()===13&&this.leapYear(r.year())?1:0)},weekDay:function(e,t,r){return(this.dayOfWeek(e,t,r)||7)<6},toJD:function(e,t,r){var n=this._validate(e,t,r,a.local.invalidDate);e=n.year();if(e<0){e++}return n.day()+(n.month()-1)*30+(e-1)*365+Math.floor(e/4)+this.jdEpoch-1},fromJD:function(e){var t=Math.floor(e)+.5-this.jdEpoch;var r=Math.floor((t-Math.floor((t+366)/1461))/365)+1;if(r<=0){r--}t=Math.floor(e)+.5-this.newDate(r,1,1).toJD();var a=Math.floor(t/30)+1;var n=t-(a-1)*30+1;return this.newDate(r,a,n)}});a.calendars.ethiopian=i},{"../main":628,"object-assign":476}],618:[function(e,t,r){var a=e("../main");var n=e("object-assign");function i(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}i.prototype=new a.baseCalendar;n(i.prototype,{name:"Hebrew",jdEpoch:347995.5,daysPerMonth:[30,29,30,29,30,29,30,29,30,29,30,29,29],hasYearZero:false,minMonth:1,firstMonth:7,minDay:1,regionalOptions:{"":{name:"Hebrew",epochs:["BAM","AM"],monthNames:["Nisan","Iyar","Sivan","Tammuz","Av","Elul","Tishrei","Cheshvan","Kislev","Tevet","Shevat","Adar","Adar II"],monthNamesShort:["Nis","Iya","Siv","Tam","Av","Elu","Tis","Che","Kis","Tev","She","Ada","Ad2"],dayNames:["Yom Rishon","Yom Sheni","Yom Shlishi","Yom Revi'i","Yom Chamishi","Yom Shishi","Yom Shabbat"],dayNamesShort:["Ris","She","Shl","Rev","Cha","Shi","Sha"],dayNamesMin:["Ri","She","Shl","Re","Ch","Shi","Sha"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:false}},leapYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,a.local.invalidYear);return this._leapYear(t.year())},_leapYear:function(e){e=e<0?e+1:e;return o(e*7+1,19)<7},monthsInYear:function(e){this._validate(e,this.minMonth,this.minDay,a.local.invalidYear);return this._leapYear(e.year?e.year():e)?13:12},weekOfYear:function(e,t,r){var a=this.newDate(e,t,r);a.add(-a.dayOfWeek(),"d");return Math.floor((a.dayOfYear()-1)/7)+1},daysInYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,a.local.invalidYear);e=t.year();return this.toJD(e===-1?+1:e+1,7,1)-this.toJD(e,7,1)},daysInMonth:function(e,t){if(e.year){t=e.month();e=e.year()}this._validate(e,t,this.minDay,a.local.invalidMonth);return t===12&&this.leapYear(e)?30:t===8&&o(this.daysInYear(e),10)===5?30:t===9&&o(this.daysInYear(e),10)===3?29:this.daysPerMonth[t-1]},weekDay:function(e,t,r){return this.dayOfWeek(e,t,r)!==6},extraInfo:function(e,t,r){var n=this._validate(e,t,r,a.local.invalidDate);return{yearType:(this.leapYear(n)?"embolismic":"common")+" "+["deficient","regular","complete"][this.daysInYear(n)%10-3]}},toJD:function(e,t,r){var n=this._validate(e,t,r,a.local.invalidDate);e=n.year();t=n.month();r=n.day();var i=e<=0?e+1:e;var o=this.jdEpoch+this._delay1(i)+this._delay2(i)+r+1;if(t<7){for(var s=7;s<=this.monthsInYear(e);s++){o+=this.daysInMonth(e,s)}for(var s=1;s<t;s++){o+=this.daysInMonth(e,s)}}else{for(var s=7;s<t;s++){o+=this.daysInMonth(e,s)}}return o},_delay1:function(e){var t=Math.floor((235*e-234)/19);var r=12084+13753*t;var a=t*29+Math.floor(r/25920);if(o(3*(a+1),7)<3){a++}return a},_delay2:function(e){var t=this._delay1(e-1);var r=this._delay1(e);var a=this._delay1(e+1);return a-r===356?2:r-t===382?1:0},fromJD:function(e){e=Math.floor(e)+.5;var t=Math.floor((e-this.jdEpoch)*98496/35975351)-1;while(e>=this.toJD(t===-1?+1:t+1,7,1)){t++}var r=e<this.toJD(t,1,1)?7:1;while(e>this.toJD(t,r,this.daysInMonth(t,r))){r++}var a=e-this.toJD(t,r,1)+1;return this.newDate(t,r,a)}});function o(e,t){return e-t*Math.floor(e/t)}a.calendars.hebrew=i},{"../main":628,"object-assign":476}],619:[function(e,t,r){var a=e("../main");var n=e("object-assign");function i(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}i.prototype=new a.baseCalendar;n(i.prototype,{name:"Islamic",jdEpoch:1948439.5,daysPerMonth:[30,29,30,29,30,29,30,29,30,29,30,29],hasYearZero:false,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Islamic",epochs:["BH","AH"],monthNames:["Muharram","Safar","Rabi' al-awwal","Rabi' al-thani","Jumada al-awwal","Jumada al-thani","Rajab","Sha'aban","Ramadan","Shawwal","Dhu al-Qi'dah","Dhu al-Hijjah"],monthNamesShort:["Muh","Saf","Rab1","Rab2","Jum1","Jum2","Raj","Sha'","Ram","Shaw","DhuQ","DhuH"],dayNames:["Yawm al-ahad","Yawm al-ithnayn","Yawm ath-thulaathaa'","Yawm al-arbi'aa'","Yawm al-khamīs","Yawm al-jum'a","Yawm as-sabt"],dayNamesShort:["Aha","Ith","Thu","Arb","Kha","Jum","Sab"],dayNamesMin:["Ah","It","Th","Ar","Kh","Ju","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:false}},leapYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,a.local.invalidYear);return(t.year()*11+14)%30<11},weekOfYear:function(e,t,r){var a=this.newDate(e,t,r);a.add(-a.dayOfWeek(),"d");return Math.floor((a.dayOfYear()-1)/7)+1},daysInYear:function(e){return this.leapYear(e)?355:354},daysInMonth:function(e,t){var r=this._validate(e,t,this.minDay,a.local.invalidMonth);return this.daysPerMonth[r.month()-1]+(r.month()===12&&this.leapYear(r.year())?1:0)},weekDay:function(e,t,r){return this.dayOfWeek(e,t,r)!==5},toJD:function(e,t,r){var n=this._validate(e,t,r,a.local.invalidDate);e=n.year();t=n.month();r=n.day();e=e<=0?e+1:e;return r+Math.ceil(29.5*(t-1))+(e-1)*354+Math.floor((3+11*e)/30)+this.jdEpoch-1},fromJD:function(e){e=Math.floor(e)+.5;var t=Math.floor((30*(e-this.jdEpoch)+10646)/10631);t=t<=0?t-1:t;var r=Math.min(12,Math.ceil((e-29-this.toJD(t,1,1))/29.5)+1);var a=e-this.toJD(t,r,1)+1;return this.newDate(t,r,a)}});a.calendars.islamic=i},{"../main":628,"object-assign":476}],620:[function(e,t,r){var a=e("../main");var n=e("object-assign");function i(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}i.prototype=new a.baseCalendar;n(i.prototype,{name:"Julian",jdEpoch:1721423.5,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:false,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Julian",epochs:["BC","AD"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"mm/dd/yyyy",firstDay:0,isRTL:false}},leapYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,a.local.invalidYear);var e=t.year()<0?t.year()+1:t.year();return e%4===0},weekOfYear:function(e,t,r){var a=this.newDate(e,t,r);a.add(4-(a.dayOfWeek()||7),"d");return Math.floor((a.dayOfYear()-1)/7)+1},daysInMonth:function(e,t){var r=this._validate(e,t,this.minDay,a.local.invalidMonth);return this.daysPerMonth[r.month()-1]+(r.month()===2&&this.leapYear(r.year())?1:0)},weekDay:function(e,t,r){return(this.dayOfWeek(e,t,r)||7)<6},toJD:function(e,t,r){var n=this._validate(e,t,r,a.local.invalidDate);e=n.year();t=n.month();r=n.day();if(e<0){e++}if(t<=2){e--;t+=12}return Math.floor(365.25*(e+4716))+Math.floor(30.6001*(t+1))+r-1524.5},fromJD:function(e){var t=Math.floor(e+.5);var r=t+1524;var a=Math.floor((r-122.1)/365.25);var n=Math.floor(365.25*a);var i=Math.floor((r-n)/30.6001);var o=i-Math.floor(i<14?1:13);var s=a-Math.floor(o>2?4716:4715);var l=r-n-Math.floor(30.6001*i);if(s<=0){s--}return this.newDate(s,o,l)}});a.calendars.julian=i},{"../main":628,"object-assign":476}],621:[function(e,t,r){var a=e("../main");var n=e("object-assign");function i(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}i.prototype=new a.baseCalendar;n(i.prototype,{name:"Mayan",jdEpoch:584282.5,hasYearZero:true,minMonth:0,firstMonth:0,minDay:0,regionalOptions:{"":{name:"Mayan",epochs:["",""],monthNames:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17"],monthNamesShort:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17"],dayNames:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],dayNamesShort:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],dayNamesMin:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],digits:null,dateFormat:"YYYY.m.d",firstDay:0,isRTL:false,haabMonths:["Pop","Uo","Zip","Zotz","Tzec","Xul","Yaxkin","Mol","Chen","Yax","Zac","Ceh","Mac","Kankin","Muan","Pax","Kayab","Cumku","Uayeb"],tzolkinMonths:["Imix","Ik","Akbal","Kan","Chicchan","Cimi","Manik","Lamat","Muluc","Oc","Chuen","Eb","Ben","Ix","Men","Cib","Caban","Etznab","Cauac","Ahau"]}},leapYear:function(e){this._validate(e,this.minMonth,this.minDay,a.local.invalidYear);return false},formatYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,a.local.invalidYear);e=t.year();var r=Math.floor(e/400);e=e%400;e+=e<0?400:0;var n=Math.floor(e/20);return r+"."+n+"."+e%20},forYear:function(e){e=e.split(".");if(e.length<3){throw"Invalid Mayan year"}var t=0;for(var r=0;r<e.length;r++){var a=parseInt(e[r],10);if(Math.abs(a)>19||r>0&&a<0){throw"Invalid Mayan year"}t=t*20+a}return t},monthsInYear:function(e){this._validate(e,this.minMonth,this.minDay,a.local.invalidYear);return 18},weekOfYear:function(e,t,r){this._validate(e,t,r,a.local.invalidDate);return 0},daysInYear:function(e){this._validate(e,this.minMonth,this.minDay,a.local.invalidYear);return 360},daysInMonth:function(e,t){this._validate(e,t,this.minDay,a.local.invalidMonth);return 20},daysInWeek:function(){return 5},dayOfWeek:function(e,t,r){var n=this._validate(e,t,r,a.local.invalidDate);return n.day()},weekDay:function(e,t,r){this._validate(e,t,r,a.local.invalidDate);return true},extraInfo:function(e,t,r){var n=this._validate(e,t,r,a.local.invalidDate);var i=n.toJD();var o=this._toHaab(i);var s=this._toTzolkin(i);return{haabMonthName:this.local.haabMonths[o[0]-1],haabMonth:o[0],haabDay:o[1],tzolkinDayName:this.local.tzolkinMonths[s[0]-1],tzolkinDay:s[0],tzolkinTrecena:s[1]}},_toHaab:function(e){e-=this.jdEpoch;var t=o(e+8+(18-1)*20,365);return[Math.floor(t/20)+1,o(t,20)]},_toTzolkin:function(e){e-=this.jdEpoch;return[s(e+20,20),s(e+4,13)]},toJD:function(e,t,r){var n=this._validate(e,t,r,a.local.invalidDate);return n.day()+n.month()*20+n.year()*360+this.jdEpoch},fromJD:function(e){e=Math.floor(e)+.5-this.jdEpoch;var t=Math.floor(e/360);e=e%360;e+=e<0?360:0;var r=Math.floor(e/20);var a=e%20;return this.newDate(t,r,a)}});function o(e,t){return e-t*Math.floor(e/t)}function s(e,t){return o(e-1,t)+1}a.calendars.mayan=i},{"../main":628,"object-assign":476}],622:[function(e,t,r){var a=e("../main");var n=e("object-assign");function i(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}i.prototype=new a.baseCalendar;var o=a.instance("gregorian");n(i.prototype,{name:"Nanakshahi",jdEpoch:2257673.5,daysPerMonth:[31,31,31,31,31,30,30,30,30,30,30,30],hasYearZero:false,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Nanakshahi",epochs:["BN","AN"],monthNames:["Chet","Vaisakh","Jeth","Harh","Sawan","Bhadon","Assu","Katak","Maghar","Poh","Magh","Phagun"],monthNamesShort:["Che","Vai","Jet","Har","Saw","Bha","Ass","Kat","Mgr","Poh","Mgh","Pha"],dayNames:["Somvaar","Mangalvar","Budhvaar","Veervaar","Shukarvaar","Sanicharvaar","Etvaar"],dayNamesShort:["Som","Mangal","Budh","Veer","Shukar","Sanichar","Et"],dayNamesMin:["So","Ma","Bu","Ve","Sh","Sa","Et"],digits:null,dateFormat:"dd-mm-yyyy",firstDay:0,isRTL:false}},leapYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,a.local.invalidYear||a.regionalOptions[""].invalidYear);return o.leapYear(t.year()+(t.year()<1?1:0)+1469)},weekOfYear:function(e,t,r){var a=this.newDate(e,t,r);a.add(1-(a.dayOfWeek()||7),"d");return Math.floor((a.dayOfYear()-1)/7)+1},daysInMonth:function(e,t){var r=this._validate(e,t,this.minDay,a.local.invalidMonth);return this.daysPerMonth[r.month()-1]+(r.month()===12&&this.leapYear(r.year())?1:0)},weekDay:function(e,t,r){return(this.dayOfWeek(e,t,r)||7)<6},toJD:function(e,t,r){var n=this._validate(e,t,r,a.local.invalidMonth);var e=n.year();if(e<0){e++}var i=n.day();for(var s=1;s<n.month();s++){i+=this.daysPerMonth[s-1]}return i+o.toJD(e+1468,3,13)},fromJD:function(e){e=Math.floor(e+.5);var t=Math.floor((e-(this.jdEpoch-1))/366);while(e>=this.toJD(t+1,1,1)){t++}var r=e-Math.floor(this.toJD(t,1,1)+.5)+1;var a=1;while(r>this.daysInMonth(t,a)){r-=this.daysInMonth(t,a);a++}return this.newDate(t,a,r)}});a.calendars.nanakshahi=i},{"../main":628,"object-assign":476}],623:[function(e,t,r){var a=e("../main");var n=e("object-assign");function i(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}i.prototype=new a.baseCalendar;n(i.prototype,{name:"Nepali",jdEpoch:1700709.5,daysPerMonth:[31,31,32,32,31,30,30,29,30,29,30,30],hasYearZero:false,minMonth:1,firstMonth:1,minDay:1,daysPerYear:365,regionalOptions:{"":{name:"Nepali",epochs:["BBS","ABS"],monthNames:["Baisakh","Jestha","Ashadh","Shrawan","Bhadra","Ashwin","Kartik","Mangsir","Paush","Mangh","Falgun","Chaitra"],monthNamesShort:["Bai","Je","As","Shra","Bha","Ash","Kar","Mang","Pau","Ma","Fal","Chai"],dayNames:["Aaitabaar","Sombaar","Manglbaar","Budhabaar","Bihibaar","Shukrabaar","Shanibaar"],dayNamesShort:["Aaita","Som","Mangl","Budha","Bihi","Shukra","Shani"],dayNamesMin:["Aai","So","Man","Bu","Bi","Shu","Sha"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:1,isRTL:false}},leapYear:function(e){return this.daysInYear(e)!==this.daysPerYear},weekOfYear:function(e,t,r){var a=this.newDate(e,t,r);a.add(-a.dayOfWeek(),"d");return Math.floor((a.dayOfYear()-1)/7)+1},daysInYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,a.local.invalidYear);e=t.year();if(typeof this.NEPALI_CALENDAR_DATA[e]==="undefined"){return this.daysPerYear}var r=0;for(var n=this.minMonth;n<=12;n++){r+=this.NEPALI_CALENDAR_DATA[e][n]}return r},daysInMonth:function(e,t){if(e.year){t=e.month();e=e.year()}this._validate(e,t,this.minDay,a.local.invalidMonth);return typeof this.NEPALI_CALENDAR_DATA[e]==="undefined"?this.daysPerMonth[t-1]:this.NEPALI_CALENDAR_DATA[e][t]},weekDay:function(e,t,r){return this.dayOfWeek(e,t,r)!==6},toJD:function(e,t,r){var n=this._validate(e,t,r,a.local.invalidDate);e=n.year();t=n.month();r=n.day();var i=a.instance();var o=0;var s=t;var l=e;this._createMissingCalendarData(e);var u=e-(s>9||s===9&&r>=this.NEPALI_CALENDAR_DATA[l][0]?56:57);if(t!==9){o=r;s--}while(s!==9){if(s<=0){s=12;l--}o+=this.NEPALI_CALENDAR_DATA[l][s];s--}if(t===9){o+=r-this.NEPALI_CALENDAR_DATA[l][0];if(o<0){o+=i.daysInYear(u)}}else{o+=this.NEPALI_CALENDAR_DATA[l][9]-this.NEPALI_CALENDAR_DATA[l][0]}return i.newDate(u,1,1).add(o,"d").toJD()},fromJD:function(e){var t=a.instance();var r=t.fromJD(e);var n=r.year();var i=r.dayOfYear();var o=n+56;this._createMissingCalendarData(o);var s=9;var l=this.NEPALI_CALENDAR_DATA[o][0];var u=this.NEPALI_CALENDAR_DATA[o][s]-l+1;while(i>u){s++;if(s>12){s=1;o++}u+=this.NEPALI_CALENDAR_DATA[o][s]}var c=this.NEPALI_CALENDAR_DATA[o][s]-(u-i);return this.newDate(o,s,c)},_createMissingCalendarData:function(e){var t=this.daysPerMonth.slice(0);t.unshift(17);for(var r=e-1;r<e+2;r++){if(typeof this.NEPALI_CALENDAR_DATA[r]==="undefined"){this.NEPALI_CALENDAR_DATA[r]=t}}},NEPALI_CALENDAR_DATA:{1970:[18,31,31,32,31,31,31,30,29,30,29,30,30],1971:[18,31,31,32,31,32,30,30,29,30,29,30,30],1972:[17,31,32,31,32,31,30,30,30,29,29,30,30],1973:[19,30,32,31,32,31,30,30,30,29,30,29,31],1974:[19,31,31,32,30,31,31,30,29,30,29,30,30],1975:[18,31,31,32,32,30,31,30,29,30,29,30,30],1976:[17,31,32,31,32,31,30,30,30,29,29,30,31],1977:[18,31,32,31,32,31,31,29,30,29,30,29,31],1978:[18,31,31,32,31,31,31,30,29,30,29,30,30],1979:[18,31,31,32,32,31,30,30,29,30,29,30,30],1980:[17,31,32,31,32,31,30,30,30,29,29,30,31],1981:[18,31,31,31,32,31,31,29,30,30,29,30,30],1982:[18,31,31,32,31,31,31,30,29,30,29,30,30],1983:[18,31,31,32,32,31,30,30,29,30,29,30,30],1984:[17,31,32,31,32,31,30,30,30,29,29,30,31],1985:[18,31,31,31,32,31,31,29,30,30,29,30,30],1986:[18,31,31,32,31,31,31,30,29,30,29,30,30],1987:[18,31,32,31,32,31,30,30,29,30,29,30,30],1988:[17,31,32,31,32,31,30,30,30,29,29,30,31],1989:[18,31,31,31,32,31,31,30,29,30,29,30,30],1990:[18,31,31,32,31,31,31,30,29,30,29,30,30],1991:[18,31,32,31,32,31,30,30,29,30,29,30,30],1992:[17,31,32,31,32,31,30,30,30,29,30,29,31],1993:[18,31,31,31,32,31,31,30,29,30,29,30,30],1994:[18,31,31,32,31,31,31,30,29,30,29,30,30],1995:[17,31,32,31,32,31,30,30,30,29,29,30,30],1996:[17,31,32,31,32,31,30,30,30,29,30,29,31],1997:[18,31,31,32,31,31,31,30,29,30,29,30,30],1998:[18,31,31,32,31,31,31,30,29,30,29,30,30],1999:[17,31,32,31,32,31,30,30,30,29,29,30,31],2e3:[17,30,32,31,32,31,30,30,30,29,30,29,31],2001:[18,31,31,32,31,31,31,30,29,30,29,30,30],2002:[18,31,31,32,32,31,30,30,29,30,29,30,30],2003:[17,31,32,31,32,31,30,30,30,29,29,30,31],2004:[17,30,32,31,32,31,30,30,30,29,30,29,31],2005:[18,31,31,32,31,31,31,30,29,30,29,30,30],2006:[18,31,31,32,32,31,30,30,29,30,29,30,30],2007:[17,31,32,31,32,31,30,30,30,29,29,30,31],2008:[17,31,31,31,32,31,31,29,30,30,29,29,31],2009:[18,31,31,32,31,31,31,30,29,30,29,30,30],2010:[18,31,31,32,32,31,30,30,29,30,29,30,30],2011:[17,31,32,31,32,31,30,30,30,29,29,30,31],2012:[17,31,31,31,32,31,31,29,30,30,29,30,30],2013:[18,31,31,32,31,31,31,30,29,30,29,30,30],2014:[18,31,31,32,32,31,30,30,29,30,29,30,30],2015:[17,31,32,31,32,31,30,30,30,29,29,30,31],2016:[17,31,31,31,32,31,31,29,30,30,29,30,30],2017:[18,31,31,32,31,31,31,30,29,30,29,30,30],2018:[18,31,32,31,32,31,30,30,29,30,29,30,30],2019:[17,31,32,31,32,31,30,30,30,29,30,29,31],2020:[17,31,31,31,32,31,31,30,29,30,29,30,30],2021:[18,31,31,32,31,31,31,30,29,30,29,30,30],2022:[17,31,32,31,32,31,30,30,30,29,29,30,30],2023:[17,31,32,31,32,31,30,30,30,29,30,29,31],2024:[17,31,31,31,32,31,31,30,29,30,29,30,30],2025:[18,31,31,32,31,31,31,30,29,30,29,30,30],2026:[17,31,32,31,32,31,30,30,30,29,29,30,31],2027:[17,30,32,31,32,31,30,30,30,29,30,29,31],2028:[17,31,31,32,31,31,31,30,29,30,29,30,30],2029:[18,31,31,32,31,32,30,30,29,30,29,30,30],2030:[17,31,32,31,32,31,30,30,30,30,30,30,31],2031:[17,31,32,31,32,31,31,31,31,31,31,31,31],2032:[17,32,32,32,32,32,32,32,32,32,32,32,32],2033:[18,31,31,32,32,31,30,30,29,30,29,30,30],2034:[17,31,32,31,32,31,30,30,30,29,29,30,31],2035:[17,30,32,31,32,31,31,29,30,30,29,29,31],2036:[17,31,31,32,31,31,31,30,29,30,29,30,30],2037:[18,31,31,32,32,31,30,30,29,30,29,30,30],2038:[17,31,32,31,32,31,30,30,30,29,29,30,31],2039:[17,31,31,31,32,31,31,29,30,30,29,30,30],2040:[17,31,31,32,31,31,31,30,29,30,29,30,30],2041:[18,31,31,32,32,31,30,30,29,30,29,30,30],2042:[17,31,32,31,32,31,30,30,30,29,29,30,31],2043:[17,31,31,31,32,31,31,29,30,30,29,30,30],2044:[17,31,31,32,31,31,31,30,29,30,29,30,30],2045:[18,31,32,31,32,31,30,30,29,30,29,30,30],2046:[17,31,32,31,32,31,30,30,30,29,29,30,31],2047:[17,31,31,31,32,31,31,30,29,30,29,30,30],2048:[17,31,31,32,31,31,31,30,29,30,29,30,30],2049:[17,31,32,31,32,31,30,30,30,29,29,30,30],2050:[17,31,32,31,32,31,30,30,30,29,30,29,31],2051:[17,31,31,31,32,31,31,30,29,30,29,30,30],2052:[17,31,31,32,31,31,31,30,29,30,29,30,30],2053:[17,31,32,31,32,31,30,30,30,29,29,30,30],2054:[17,31,32,31,32,31,30,30,30,29,30,29,31],2055:[17,31,31,32,31,31,31,30,29,30,30,29,30],2056:[17,31,31,32,31,32,30,30,29,30,29,30,30],2057:[17,31,32,31,32,31,30,30,30,29,29,30,31],2058:[17,30,32,31,32,31,30,30,30,29,30,29,31],2059:[17,31,31,32,31,31,31,30,29,30,29,30,30],2060:[17,31,31,32,32,31,30,30,29,30,29,30,30],2061:[17,31,32,31,32,31,30,30,30,29,29,30,31],2062:[17,30,32,31,32,31,31,29,30,29,30,29,31],2063:[17,31,31,32,31,31,31,30,29,30,29,30,30],2064:[17,31,31,32,32,31,30,30,29,30,29,30,30],2065:[17,31,32,31,32,31,30,30,30,29,29,30,31],2066:[17,31,31,31,32,31,31,29,30,30,29,29,31],2067:[17,31,31,32,31,31,31,30,29,30,29,30,30],2068:[17,31,31,32,32,31,30,30,29,30,29,30,30],2069:[17,31,32,31,32,31,30,30,30,29,29,30,31],2070:[17,31,31,31,32,31,31,29,30,30,29,30,30],2071:[17,31,31,32,31,31,31,30,29,30,29,30,30],2072:[17,31,32,31,32,31,30,30,29,30,29,30,30],2073:[17,31,32,31,32,31,30,30,30,29,29,30,31],2074:[17,31,31,31,32,31,31,30,29,30,29,30,30],2075:[17,31,31,32,31,31,31,30,29,30,29,30,30],2076:[16,31,32,31,32,31,30,30,30,29,29,30,30],2077:[17,31,32,31,32,31,30,30,30,29,30,29,31],2078:[17,31,31,31,32,31,31,30,29,30,29,30,30],2079:[17,31,31,32,31,31,31,30,29,30,29,30,30],2080:[16,31,32,31,32,31,30,30,30,29,29,30,30],2081:[17,31,31,32,32,31,30,30,30,29,30,30,30],2082:[17,31,32,31,32,31,30,30,30,29,30,30,30],2083:[17,31,31,32,31,31,30,30,30,29,30,30,30],2084:[17,31,31,32,31,31,30,30,30,29,30,30,30],2085:[17,31,32,31,32,31,31,30,30,29,30,30,30],2086:[17,31,32,31,32,31,30,30,30,29,30,30,30],2087:[16,31,31,32,31,31,31,30,30,29,30,30,30],2088:[16,30,31,32,32,30,31,30,30,29,30,30,30],2089:[17,31,32,31,32,31,30,30,30,29,30,30,30],2090:[17,31,32,31,32,31,30,30,30,29,30,30,30],2091:[16,31,31,32,31,31,31,30,30,29,30,30,30],2092:[16,31,31,32,32,31,30,30,30,29,30,30,30],2093:[17,31,32,31,32,31,30,30,30,29,30,30,30],2094:[17,31,31,32,31,31,30,30,30,29,30,30,30],2095:[17,31,31,32,31,31,31,30,29,30,30,30,30],2096:[17,30,31,32,32,31,30,30,29,30,29,30,30],2097:[17,31,32,31,32,31,30,30,30,29,30,30,30],2098:[17,31,31,32,31,31,31,29,30,29,30,30,31],2099:[17,31,31,32,31,31,31,30,29,29,30,30,30],2100:[17,31,32,31,32,30,31,30,29,30,29,30,30]}});a.calendars.nepali=i},{"../main":628,"object-assign":476}],624:[function(e,t,r){var a=e("../main");var n=e("object-assign");function i(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}i.prototype=new a.baseCalendar;n(i.prototype,{name:"Persian",jdEpoch:1948320.5,daysPerMonth:[31,31,31,31,31,31,30,30,30,30,30,29],hasYearZero:false,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Persian",epochs:["BP","AP"],monthNames:["Farvardin","Ordibehesht","Khordad","Tir","Mordad","Shahrivar","Mehr","Aban","Azar","Day","Bahman","Esfand"],monthNamesShort:["Far","Ord","Kho","Tir","Mor","Sha","Meh","Aba","Aza","Day","Bah","Esf"],dayNames:["Yekshambe","Doshambe","Seshambe","Chæharshambe","Panjshambe","Jom'e","Shambe"],dayNamesShort:["Yek","Do","Se","Chæ","Panj","Jom","Sha"],dayNamesMin:["Ye","Do","Se","Ch","Pa","Jo","Sh"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:false}},leapYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,a.local.invalidYear);return((t.year()-(t.year()>0?474:473))%2820+474+38)*682%2816<682},weekOfYear:function(e,t,r){var a=this.newDate(e,t,r);a.add(-((a.dayOfWeek()+1)%7),"d");return Math.floor((a.dayOfYear()-1)/7)+1},daysInMonth:function(e,t){var r=this._validate(e,t,this.minDay,a.local.invalidMonth);return this.daysPerMonth[r.month()-1]+(r.month()===12&&this.leapYear(r.year())?1:0)},weekDay:function(e,t,r){return this.dayOfWeek(e,t,r)!==5},toJD:function(e,t,r){var n=this._validate(e,t,r,a.local.invalidDate);e=n.year();t=n.month();r=n.day();var i=e-(e>=0?474:473);var s=474+o(i,2820);return r+(t<=7?(t-1)*31:(t-1)*30+6)+Math.floor((s*682-110)/2816)+(s-1)*365+Math.floor(i/2820)*1029983+this.jdEpoch-1},fromJD:function(e){e=Math.floor(e)+.5;var t=e-this.toJD(475,1,1);var r=Math.floor(t/1029983);var a=o(t,1029983);var n=2820;if(a!==1029982){var i=Math.floor(a/366);var s=o(a,366);n=Math.floor((2134*i+2816*s+2815)/1028522)+i+1}var l=n+2820*r+474;l=l<=0?l-1:l;var u=e-this.toJD(l,1,1)+1;var c=u<=186?Math.ceil(u/31):Math.ceil((u-6)/30);var f=e-this.toJD(l,c,1)+1;return this.newDate(l,c,f)}});function o(e,t){return e-t*Math.floor(e/t)}a.calendars.persian=i;a.calendars.jalali=i},{"../main":628,"object-assign":476}],625:[function(e,t,r){var a=e("../main");var n=e("object-assign");var i=a.instance();function o(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}o.prototype=new a.baseCalendar;n(o.prototype,{name:"Taiwan",jdEpoch:2419402.5,yearsOffset:1911,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:false,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Taiwan",epochs:["BROC","ROC"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:1,isRTL:false}},leapYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,a.local.invalidYear);var e=this._t2gYear(t.year());return i.leapYear(e)},weekOfYear:function(e,t,r){var n=this._validate(e,this.minMonth,this.minDay,a.local.invalidYear);var e=this._t2gYear(n.year());return i.weekOfYear(e,n.month(),n.day())},daysInMonth:function(e,t){var r=this._validate(e,t,this.minDay,a.local.invalidMonth);return this.daysPerMonth[r.month()-1]+(r.month()===2&&this.leapYear(r.year())?1:0)},weekDay:function(e,t,r){return(this.dayOfWeek(e,t,r)||7)<6},toJD:function(e,t,r){var n=this._validate(e,t,r,a.local.invalidDate);var e=this._t2gYear(n.year());return i.toJD(e,n.month(),n.day())},fromJD:function(e){var t=i.fromJD(e);var r=this._g2tYear(t.year());return this.newDate(r,t.month(),t.day())},_t2gYear:function(e){return e+this.yearsOffset+(e>=-this.yearsOffset&&e<=-1?1:0)},_g2tYear:function(e){return e-this.yearsOffset-(e>=1&&e<=this.yearsOffset?1:0)}});a.calendars.taiwan=o},{"../main":628,"object-assign":476}],626:[function(e,t,r){var a=e("../main");var n=e("object-assign");var i=a.instance();function o(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}o.prototype=new a.baseCalendar;n(o.prototype,{name:"Thai",jdEpoch:1523098.5,yearsOffset:543,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:false,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Thai",epochs:["BBE","BE"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:false}},leapYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,a.local.invalidYear);var e=this._t2gYear(t.year());return i.leapYear(e)},weekOfYear:function(e,t,r){var n=this._validate(e,this.minMonth,this.minDay,a.local.invalidYear);var e=this._t2gYear(n.year());return i.weekOfYear(e,n.month(),n.day())},daysInMonth:function(e,t){var r=this._validate(e,t,this.minDay,a.local.invalidMonth);return this.daysPerMonth[r.month()-1]+(r.month()===2&&this.leapYear(r.year())?1:0)},weekDay:function(e,t,r){return(this.dayOfWeek(e,t,r)||7)<6},toJD:function(e,t,r){var n=this._validate(e,t,r,a.local.invalidDate);var e=this._t2gYear(n.year());return i.toJD(e,n.month(),n.day())},fromJD:function(e){var t=i.fromJD(e);var r=this._g2tYear(t.year());return this.newDate(r,t.month(),t.day())},_t2gYear:function(e){return e-this.yearsOffset-(e>=1&&e<=this.yearsOffset?1:0)},_g2tYear:function(e){return e+this.yearsOffset+(e>=-this.yearsOffset&&e<=-1?1:0)}});a.calendars.thai=o},{"../main":628,"object-assign":476}],627:[function(e,t,r){var a=e("../main");var n=e("object-assign");function i(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}i.prototype=new a.baseCalendar;n(i.prototype,{name:"UmmAlQura",hasYearZero:false,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Umm al-Qura",epochs:["BH","AH"],monthNames:["Al-Muharram","Safar","Rabi' al-awwal","Rabi' Al-Thani","Jumada Al-Awwal","Jumada Al-Thani","Rajab","Sha'aban","Ramadan","Shawwal","Dhu al-Qi'dah","Dhu al-Hijjah"],monthNamesShort:["Muh","Saf","Rab1","Rab2","Jum1","Jum2","Raj","Sha'","Ram","Shaw","DhuQ","DhuH"],dayNames:["Yawm al-Ahad","Yawm al-Ithnain","Yawm al-Thalāthā’","Yawm al-Arba‘ā’","Yawm al-Khamīs","Yawm al-Jum‘a","Yawm al-Sabt"],dayNamesMin:["Ah","Ith","Th","Ar","Kh","Ju","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:true}},leapYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,a.local.invalidYear);return this.daysInYear(t.year())===355},weekOfYear:function(e,t,r){var a=this.newDate(e,t,r);a.add(-a.dayOfWeek(),"d");return Math.floor((a.dayOfYear()-1)/7)+1},daysInYear:function(e){var t=0;for(var r=1;r<=12;r++){t+=this.daysInMonth(e,r)}return t},daysInMonth:function(e,t){var r=this._validate(e,t,this.minDay,a.local.invalidMonth);var n=r.toJD()-24e5+.5;var i=0;for(var s=0;s<o.length;s++){if(o[s]>n){return o[i]-o[i-1]}i++}return 30},weekDay:function(e,t,r){return this.dayOfWeek(e,t,r)!==5},toJD:function(e,t,r){var n=this._validate(e,t,r,a.local.invalidDate);var i=12*(n.year()-1)+n.month()-15292;var s=n.day()+o[i-1]-1;return s+24e5-.5},fromJD:function(e){var t=e-24e5+.5;var r=0;for(var a=0;a<o.length;a++){if(o[a]>t)break;r++}var n=r+15292;var i=Math.floor((n-1)/12);var s=i+1;var l=n-12*i;var u=t-o[r-1]+1;return this.newDate(s,l,u)},isValid:function(e,t,r){var n=a.baseCalendar.prototype.isValid.apply(this,arguments);if(n){e=e.year!=null?e.year:e;n=e>=1276&&e<=1500}return n},_validate:function(e,t,r,n){var i=a.baseCalendar.prototype._validate.apply(this,arguments);if(i.year<1276||i.year>1500){throw n.replace(/\{0\}/,this.local.name)}return i}});a.calendars.ummalqura=i;var o=[20,50,79,109,138,168,197,227,256,286,315,345,374,404,433,463,492,522,551,581,611,641,670,700,729,759,788,818,847,877,906,936,965,995,1024,1054,1083,1113,1142,1172,1201,1231,1260,1290,1320,1350,1379,1409,1438,1468,1497,1527,1556,1586,1615,1645,1674,1704,1733,1763,1792,1822,1851,1881,1910,1940,1969,1999,2028,2058,2087,2117,2146,2176,2205,2235,2264,2294,2323,2353,2383,2413,2442,2472,2501,2531,2560,2590,2619,2649,2678,2708,2737,2767,2796,2826,2855,2885,2914,2944,2973,3003,3032,3062,3091,3121,3150,3180,3209,3239,3268,3298,3327,3357,3386,3416,3446,3476,3505,3535,3564,3594,3623,3653,3682,3712,3741,3771,3800,3830,3859,3889,3918,3948,3977,4007,4036,4066,4095,4125,4155,4185,4214,4244,4273,4303,4332,4362,4391,4421,4450,4480,4509,4539,4568,4598,4627,4657,4686,4716,4745,4775,4804,4834,4863,4893,4922,4952,4981,5011,5040,5070,5099,5129,5158,5188,5218,5248,5277,5307,5336,5366,5395,5425,5454,5484,5513,5543,5572,5602,5631,5661,5690,5720,5749,5779,5808,5838,5867,5897,5926,5956,5985,6015,6044,6074,6103,6133,6162,6192,6221,6251,6281,6311,6340,6370,6399,6429,6458,6488,6517,6547,6576,6606,6635,6665,6694,6724,6753,6783,6812,6842,6871,6901,6930,6960,6989,7019,7048,7078,7107,7137,7166,7196,7225,7255,7284,7314,7344,7374,7403,7433,7462,7492,7521,7551,7580,7610,7639,7669,7698,7728,7757,7787,7816,7846,7875,7905,7934,7964,7993,8023,8053,8083,8112,8142,8171,8201,8230,8260,8289,8319,8348,8378,8407,8437,8466,8496,8525,8555,8584,8614,8643,8673,8702,8732,8761,8791,8821,8850,8880,8909,8938,8968,8997,9027,9056,9086,9115,9145,9175,9205,9234,9264,9293,9322,9352,9381,9410,9440,9470,9499,9529,9559,9589,9618,9648,9677,9706,9736,9765,9794,9824,9853,9883,9913,9943,9972,10002,10032,10061,10090,10120,10149,10178,10208,10237,10267,10297,10326,10356,10386,10415,10445,10474,10504,10533,10562,10592,10621,10651,10680,10710,10740,10770,10799,10829,10858,10888,10917,10947,10976,11005,11035,11064,11094,11124,11153,11183,11213,11242,11272,11301,11331,11360,11389,11419,11448,11478,11507,11537,11567,11596,11626,11655,11685,11715,11744,11774,11803,11832,11862,11891,11921,11950,11980,12010,12039,12069,12099,12128,12158,12187,12216,12246,12275,12304,12334,12364,12393,12423,12453,12483,12512,12542,12571,12600,12630,12659,12688,12718,12747,12777,12807,12837,12866,12896,12926,12955,12984,13014,13043,13072,13102,13131,13161,13191,13220,13250,13280,13310,13339,13368,13398,13427,13456,13486,13515,13545,13574,13604,13634,13664,13693,13723,13752,13782,13811,13840,13870,13899,13929,13958,13988,14018,14047,14077,14107,14136,14166,14195,14224,14254,14283,14313,14342,14372,14401,14431,14461,14490,14520,14550,14579,14609,14638,14667,14697,14726,14756,14785,14815,14844,14874,14904,14933,14963,14993,15021,15051,15081,15110,15140,15169,15199,15228,15258,15287,15317,15347,15377,15406,15436,15465,15494,15524,15553,15582,15612,15641,15671,15701,15731,15760,15790,15820,15849,15878,15908,15937,15966,15996,16025,16055,16085,16114,16144,16174,16204,16233,16262,16292,16321,16350,16380,16409,16439,16468,16498,16528,16558,16587,16617,16646,16676,16705,16734,16764,16793,16823,16852,16882,16912,16941,16971,17001,17030,17060,17089,17118,17148,17177,17207,17236,17266,17295,17325,17355,17384,17414,17444,17473,17502,17532,17561,17591,17620,17650,17679,17709,17738,17768,17798,17827,17857,17886,17916,17945,17975,18004,18034,18063,18093,18122,18152,18181,18211,18241,18270,18300,18330,18359,18388,18418,18447,18476,18506,18535,18565,18595,18625,18654,18684,18714,18743,18772,18802,18831,18860,18890,18919,18949,18979,19008,19038,19068,19098,19127,19156,19186,19215,19244,19274,19303,19333,19362,19392,19422,19452,19481,19511,19540,19570,19599,19628,19658,19687,19717,19746,19776,19806,19836,19865,19895,19924,19954,19983,20012,20042,20071,20101,20130,20160,20190,20219,20249,20279,20308,20338,20367,20396,20426,20455,20485,20514,20544,20573,20603,20633,20662,20692,20721,20751,20780,20810,20839,20869,20898,20928,20957,20987,21016,21046,21076,21105,21135,21164,21194,21223,21253,21282,21312,21341,21371,21400,21430,21459,21489,21519,21548,21578,21607,21637,21666,21696,21725,21754,21784,21813,21843,21873,21902,21932,21962,21991,22021,22050,22080,22109,22138,22168,22197,22227,22256,22286,22316,22346,22375,22405,22434,22464,22493,22522,22552,22581,22611,22640,22670,22700,22730,22759,22789,22818,22848,22877,22906,22936,22965,22994,23024,23054,23083,23113,23143,23173,23202,23232,23261,23290,23320,23349,23379,23408,23438,23467,23497,23527,23556,23586,23616,23645,23674,23704,23733,23763,23792,23822,23851,23881,23910,23940,23970,23999,24029,24058,24088,24117,24147,24176,24206,24235,24265,24294,24324,24353,24383,24413,24442,24472,24501,24531,24560,24590,24619,24648,24678,24707,24737,24767,24796,24826,24856,24885,24915,24944,24974,25003,25032,25062,25091,25121,25150,25180,25210,25240,25269,25299,25328,25358,25387,25416,25446,25475,25505,25534,25564,25594,25624,25653,25683,25712,25742,25771,25800,25830,25859,25888,25918,25948,25977,26007,26037,26067,26096,26126,26155,26184,26214,26243,26272,26302,26332,26361,26391,26421,26451,26480,26510,26539,26568,26598,26627,26656,26686,26715,26745,26775,26805,26834,26864,26893,26923,26952,26982,27011,27041,27070,27099,27129,27159,27188,27218,27248,27277,27307,27336,27366,27395,27425,27454,27484,27513,27542,27572,27602,27631,27661,27691,27720,27750,27779,27809,27838,27868,27897,27926,27956,27985,28015,28045,28074,28104,28134,28163,28193,28222,28252,28281,28310,28340,28369,28399,28428,28458,28488,28517,28547,28577,28607,28636,28665,28695,28724,28754,28783,28813,28843,28872,28901,28931,28960,28990,29019,29049,29078,29108,29137,29167,29196,29226,29255,29285,29315,29345,29375,29404,29434,29463,29492,29522,29551,29580,29610,29640,29669,29699,29729,29759,29788,29818,29847,29876,29906,29935,29964,29994,30023,30053,30082,30112,30141,30171,30200,30230,30259,30289,30318,30348,30378,30408,30437,30467,30496,30526,30555,30585,30614,30644,30673,30703,30732,30762,30791,30821,30850,30880,30909,30939,30968,30998,31027,31057,31086,31116,31145,31175,31204,31234,31263,31293,31322,31352,31381,31411,31441,31471,31500,31530,31559,31589,31618,31648,31676,31706,31736,31766,31795,31825,31854,31884,31913,31943,31972,32002,32031,32061,32090,32120,32150,32180,32209,32239,32268,32298,32327,32357,32386,32416,32445,32475,32504,32534,32563,32593,32622,32652,32681,32711,32740,32770,32799,32829,32858,32888,32917,32947,32976,33006,33035,33065,33094,33124,33153,33183,33213,33243,33272,33302,33331,33361,33390,33420,33450,33479,33509,33539,33568,33598,33627,33657,33686,33716,33745,33775,33804,33834,33863,33893,33922,33952,33981,34011,34040,34069,34099,34128,34158,34187,34217,34247,34277,34306,34336,34365,34395,34424,34454,34483,34512,34542,34571,34601,34631,34660,34690,34719,34749,34778,34808,34837,34867,34896,34926,34955,34985,35015,35044,35074,35103,35133,35162,35192,35222,35251,35280,35310,35340,35370,35399,35429,35458,35488,35517,35547,35576,35605,35635,35665,35694,35723,35753,35782,35811,35841,35871,35901,35930,35960,35989,36019,36048,36078,36107,36136,36166,36195,36225,36254,36284,36314,36343,36373,36403,36433,36462,36492,36521,36551,36580,36610,36639,36669,36698,36728,36757,36786,36816,36845,36875,36904,36934,36963,36993,37022,37052,37081,37111,37141,37170,37200,37229,37259,37288,37318,37347,37377,37406,37436,37465,37495,37524,37554,37584,37613,37643,37672,37701,37731,37760,37790,37819,37849,37878,37908,37938,37967,37997,38027,38056,38085,38115,38144,38174,38203,38233,38262,38292,38322,38351,38381,38410,38440,38469,38499,38528,38558,38587,38617,38646,38676,38705,38735,38764,38794,38823,38853,38882,38912,38941,38971,39001,39030,39059,39089,39118,39148,39178,39208,39237,39267,39297,39326,39355,39385,39414,39444,39473,39503,39532,39562,39592,39621,39650,39680,39709,39739,39768,39798,39827,39857,39886,39916,39946,39975,40005,40035,40064,40094,40123,40153,40182,40212,40241,40271,40300,40330,40359,40389,40418,40448,40477,40507,40536,40566,40595,40625,40655,40685,40714,40744,40773,40803,40832,40862,40892,40921,40951,40980,41009,41039,41068,41098,41127,41157,41186,41216,41245,41275,41304,41334,41364,41393,41422,41452,41481,41511,41540,41570,41599,41629,41658,41688,41718,41748,41777,41807,41836,41865,41894,41924,41953,41983,42012,42042,42072,42102,42131,42161,42190,42220,42249,42279,42308,42337,42367,42397,42426,42456,42485,42515,42545,42574,42604,42633,42662,42692,42721,42751,42780,42810,42839,42869,42899,42929,42958,42988,43017,43046,43076,43105,43135,43164,43194,43223,43253,43283,43312,43342,43371,43401,43430,43460,43489,43519,43548,43578,43607,43637,43666,43696,43726,43755,43785,43814,43844,43873,43903,43932,43962,43991,44021,44050,44080,44109,44139,44169,44198,44228,44258,44287,44317,44346,44375,44405,44434,44464,44493,44523,44553,44582,44612,44641,44671,44700,44730,44759,44788,44818,44847,44877,44906,44936,44966,44996,45025,45055,45084,45114,45143,45172,45202,45231,45261,45290,45320,45350,45380,45409,45439,45468,45498,45527,45556,45586,45615,45644,45674,45704,45733,45763,45793,45823,45852,45882,45911,45940,45970,45999,46028,46058,46088,46117,46147,46177,46206,46236,46265,46295,46324,46354,46383,46413,46442,46472,46501,46531,46560,46590,46620,46649,46679,46708,46738,46767,46797,46826,46856,46885,46915,46944,46974,47003,47033,47063,47092,47122,47151,47181,47210,47240,47269,47298,47328,47357,47387,47417,47446,47476,47506,47535,47565,47594,47624,47653,47682,47712,47741,47771,47800,47830,47860,47890,47919,47949,47978,48008,48037,48066,48096,48125,48155,48184,48214,48244,48273,48303,48333,48362,48392,48421,48450,48480,48509,48538,48568,48598,48627,48657,48687,48717,48746,48776,48805,48834,48864,48893,48922,48952,48982,49011,49041,49071,49100,49130,49160,49189,49218,49248,49277,49306,49336,49365,49395,49425,49455,49484,49514,49543,49573,49602,49632,49661,49690,49720,49749,49779,49809,49838,49868,49898,49927,49957,49986,50016,50045,50075,50104,50133,50163,50192,50222,50252,50281,50311,50340,50370,50400,50429,50459,50488,50518,50547,50576,50606,50635,50665,50694,50724,50754,50784,50813,50843,50872,50902,50931,50960,50990,51019,51049,51078,51108,51138,51167,51197,51227,51256,51286,51315,51345,51374,51403,51433,51462,51492,51522,51552,51582,51611,51641,51670,51699,51729,51758,51787,51816,51846,51876,51906,51936,51965,51995,52025,52054,52083,52113,52142,52171,52200,52230,52260,52290,52319,52349,52379,52408,52438,52467,52497,52526,52555,52585,52614,52644,52673,52703,52733,52762,52792,52822,52851,52881,52910,52939,52969,52998,53028,53057,53087,53116,53146,53176,53205,53235,53264,53294,53324,53353,53383,53412,53441,53471,53500,53530,53559,53589,53619,53648,53678,53708,53737,53767,53796,53825,53855,53884,53913,53943,53973,54003,54032,54062,54092,54121,54151,54180,54209,54239,54268,54297,54327,54357,54387,54416,54446,54476,54505,54535,54564,54593,54623,54652,54681,54711,54741,54770,54800,54830,54859,54889,54919,54948,54977,55007,55036,55066,55095,55125,55154,55184,55213,55243,55273,55302,55332,55361,55391,55420,55450,55479,55508,55538,55567,55597,55627,55657,55686,55716,55745,55775,55804,55834,55863,55892,55922,55951,55981,56011,56040,56070,56100,56129,56159,56188,56218,56247,56276,56306,56335,56365,56394,56424,56454,56483,56513,56543,56572,56601,56631,56660,56690,56719,56749,56778,56808,56837,56867,56897,56926,56956,56985,57015,57044,57074,57103,57133,57162,57192,57221,57251,57280,57310,57340,57369,57399,57429,57458,57487,57517,57546,57576,57605,57634,57664,57694,57723,57753,57783,57813,57842,57871,57901,57930,57959,57989,58018,58048,58077,58107,58137,58167,58196,58226,58255,58285,58314,58343,58373,58402,58432,58461,58491,58521,58551,58580,58610,58639,58669,58698,58727,58757,58786,58816,58845,58875,58905,58934,58964,58994,59023,59053,59082,59111,59141,59170,59200,59229,59259,59288,59318,59348,59377,59407,59436,59466,59495,59525,59554,59584,59613,59643,59672,59702,59731,59761,59791,59820,59850,59879,59909,59939,59968,59997,60027,60056,60086,60115,60145,60174,60204,60234,60264,60293,60323,60352,60381,60411,60440,60469,60499,60528,60558,60588,60618,60648,60677,60707,60736,60765,60795,60824,60853,60883,60912,60942,60972,61002,61031,61061,61090,61120,61149,61179,61208,61237,61267,61296,61326,61356,61385,61415,61445,61474,61504,61533,61563,61592,61621,61651,61680,61710,61739,61769,61799,61828,61858,61888,61917,61947,61976,62006,62035,62064,62094,62123,62153,62182,62212,62242,62271,62301,62331,62360,62390,62419,62448,62478,62507,62537,62566,62596,62625,62655,62685,62715,62744,62774,62803,62832,62862,62891,62921,62950,62980,63009,63039,63069,63099,63128,63157,63187,63216,63246,63275,63305,63334,63363,63393,63423,63453,63482,63512,63541,63571,63600,63630,63659,63689,63718,63747,63777,63807,63836,63866,63895,63925,63955,63984,64014,64043,64073,64102,64131,64161,64190,64220,64249,64279,64309,64339,64368,64398,64427,64457,64486,64515,64545,64574,64603,64633,64663,64692,64722,64752,64782,64811,64841,64870,64899,64929,64958,64987,65017,65047,65076,65106,65136,65166,65195,65225,65254,65283,65313,65342,65371,65401,65431,65460,65490,65520,65549,65579,65608,65638,65667,65697,65726,65755,65785,65815,65844,65874,65903,65933,65963,65992,66022,66051,66081,66110,66140,66169,66199,66228,66258,66287,66317,66346,66376,66405,66435,66465,66494,66524,66553,66583,66612,66641,66671,66700,66730,66760,66789,66819,66849,66878,66908,66937,66967,66996,67025,67055,67084,67114,67143,67173,67203,67233,67262,67292,67321,67351,67380,67409,67439,67468,67497,67527,67557,67587,67617,67646,67676,67705,67735,67764,67793,67823,67852,67882,67911,67941,67971,68e3,68030,68060,68089,68119,68148,68177,68207,68236,68266,68295,68325,68354,68384,68414,68443,68473,68502,68532,68561,68591,68620,68650,68679,68708,68738,68768,68797,68827,68857,68886,68916,68946,68975,69004,69034,69063,69092,69122,69152,69181,69211,69240,69270,69300,69330,69359,69388,69418,69447,69476,69506,69535,69565,69595,69624,69654,69684,69713,69743,69772,69802,69831,69861,69890,69919,69949,69978,70008,70038,70067,70097,70126,70156,70186,70215,70245,70274,70303,70333,70362,70392,70421,70451,70481,70510,70540,70570,70599,70629,70658,70687,70717,70746,70776,70805,70835,70864,70894,70924,70954,70983,71013,71042,71071,71101,71130,71159,71189,71218,71248,71278,71308,71337,71367,71397,71426,71455,71485,71514,71543,71573,71602,71632,71662,71691,71721,71751,71781,71810,71839,71869,71898,71927,71957,71986,72016,72046,72075,72105,72135,72164,72194,72223,72253,72282,72311,72341,72370,72400,72429,72459,72489,72518,72548,72577,72607,72637,72666,72695,72725,72754,72784,72813,72843,72872,72902,72931,72961,72991,73020,73050,73080,73109,73139,73168,73197,73227,73256,73286,73315,73345,73375,73404,73434,73464,73493,73523,73552,73581,73611,73640,73669,73699,73729,73758,73788,73818,73848,73877,73907,73936,73965,73995,74024,74053,74083,74113,74142,74172,74202,74231,74261,74291,74320,74349,74379,74408,74437,74467,74497,74526,74556,74586,74615,74645,74675,74704,74733,74763,74792,74822,74851,74881,74910,74940,74969,74999,75029,75058,75088,75117,75147,75176,75206,75235,75264,75294,75323,75353,75383,75412,75442,75472,75501,75531,75560,75590,75619,75648,75678,75707,75737,75766,75796,75826,75856,75885,75915,75944,75974,76003,76032,76062,76091,76121,76150,76180,76210,76239,76269,76299,76328,76358,76387,76416,76446,76475,76505,76534,76564,76593,76623,76653,76682,76712,76741,76771,76801,76830,76859,76889,76918,76948,76977,77007,77036,77066,77096,77125,77155,77185,77214,77243,77273,77302,77332,77361,77390,77420,77450,77479,77509,77539,77569,77598,77627,77657,77686,77715,77745,77774,77804,77833,77863,77893,77923,77952,77982,78011,78041,78070,78099,78129,78158,78188,78217,78247,78277,78307,78336,78366,78395,78425,78454,78483,78513,78542,78572,78601,78631,78661,78690,78720,78750,78779,78808,78838,78867,78897,78926,78956,78985,79015,79044,79074,79104,79133,79163,79192,79222,79251,79281,79310,79340,79369,79399,79428,79458,79487,79517,79546,79576,79606,79635,79665,79695,79724,79753,79783,79812,79841,79871,79900,79930,79960,79990]},{"../main":628,"object-assign":476}],628:[function(e,t,r){var a=e("object-assign");function n(){this.regionalOptions=[];this.regionalOptions[""]={invalidCalendar:"Calendar {0} not found",invalidDate:"Invalid {0} date",invalidMonth:"Invalid {0} month",invalidYear:"Invalid {0} year",differentCalendars:"Cannot mix {0} and {1} dates"};this.local=this.regionalOptions[""];this.calendars={};this._localCals={}}a(n.prototype,{instance:function(e,t){e=(e||"gregorian").toLowerCase();t=t||"";var r=this._localCals[e+"-"+t];if(!r&&this.calendars[e]){r=new this.calendars[e](t);this._localCals[e+"-"+t]=r}if(!r){throw(this.local.invalidCalendar||this.regionalOptions[""].invalidCalendar).replace(/\{0\}/,e)}return r},newDate:function(e,t,r,a,n){a=(e!=null&&e.year?e.calendar():typeof a==="string"?this.instance(a,n):a)||this.instance();return a.newDate(e,t,r)},substituteDigits:function(e){return function(t){return(t+"").replace(/[0-9]/g,(function(t){return e[t]}))}},substituteChineseDigits:function(e,t){return function(r){var a="";var n=0;while(r>0){var i=r%10;a=(i===0?"":e[i]+t[n])+a;n++;r=Math.floor(r/10)}if(a.indexOf(e[1]+t[1])===0){a=a.substr(1)}return a||e[0]}}});function i(e,t,r,a){this._calendar=e;this._year=t;this._month=r;this._day=a;if(this._calendar._validateLevel===0&&!this._calendar.isValid(this._year,this._month,this._day)){throw(u.local.invalidDate||u.regionalOptions[""].invalidDate).replace(/\{0\}/,this._calendar.local.name)}}function o(e,t){e=""+e;return"000000".substring(0,t-e.length)+e}a(i.prototype,{newDate:function(e,t,r){return this._calendar.newDate(e==null?this:e,t,r)},year:function(e){return arguments.length===0?this._year:this.set(e,"y")},month:function(e){return arguments.length===0?this._month:this.set(e,"m")},day:function(e){return arguments.length===0?this._day:this.set(e,"d")},date:function(e,t,r){if(!this._calendar.isValid(e,t,r)){throw(u.local.invalidDate||u.regionalOptions[""].invalidDate).replace(/\{0\}/,this._calendar.local.name)}this._year=e;this._month=t;this._day=r;return this},leapYear:function(){return this._calendar.leapYear(this)},epoch:function(){return this._calendar.epoch(this)},formatYear:function(){return this._calendar.formatYear(this)},monthOfYear:function(){return this._calendar.monthOfYear(this)},weekOfYear:function(){return this._calendar.weekOfYear(this)},daysInYear:function(){return this._calendar.daysInYear(this)},dayOfYear:function(){return this._calendar.dayOfYear(this)},daysInMonth:function(){return this._calendar.daysInMonth(this)},dayOfWeek:function(){return this._calendar.dayOfWeek(this)},weekDay:function(){return this._calendar.weekDay(this)},extraInfo:function(){return this._calendar.extraInfo(this)},add:function(e,t){return this._calendar.add(this,e,t)},set:function(e,t){return this._calendar.set(this,e,t)},compareTo:function(e){if(this._calendar.name!==e._calendar.name){throw(u.local.differentCalendars||u.regionalOptions[""].differentCalendars).replace(/\{0\}/,this._calendar.local.name).replace(/\{1\}/,e._calendar.local.name)}var t=this._year!==e._year?this._year-e._year:this._month!==e._month?this.monthOfYear()-e.monthOfYear():this._day-e._day;return t===0?0:t<0?-1:+1},calendar:function(){return this._calendar},toJD:function(){return this._calendar.toJD(this)},fromJD:function(e){return this._calendar.fromJD(e)},toJSDate:function(){return this._calendar.toJSDate(this)},fromJSDate:function(e){return this._calendar.fromJSDate(e)},toString:function(){return(this.year()<0?"-":"")+o(Math.abs(this.year()),4)+"-"+o(this.month(),2)+"-"+o(this.day(),2)}});function s(){this.shortYearCutoff="+10"}a(s.prototype,{_validateLevel:0,newDate:function(e,t,r){if(e==null){return this.today()}if(e.year){this._validate(e,t,r,u.local.invalidDate||u.regionalOptions[""].invalidDate);r=e.day();t=e.month();e=e.year()}return new i(this,e,t,r)},today:function(){return this.fromJSDate(new Date)},epoch:function(e){var t=this._validate(e,this.minMonth,this.minDay,u.local.invalidYear||u.regionalOptions[""].invalidYear);return t.year()<0?this.local.epochs[0]:this.local.epochs[1]},formatYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,u.local.invalidYear||u.regionalOptions[""].invalidYear);return(t.year()<0?"-":"")+o(Math.abs(t.year()),4)},monthsInYear:function(e){this._validate(e,this.minMonth,this.minDay,u.local.invalidYear||u.regionalOptions[""].invalidYear);return 12},monthOfYear:function(e,t){var r=this._validate(e,t,this.minDay,u.local.invalidMonth||u.regionalOptions[""].invalidMonth);return(r.month()+this.monthsInYear(r)-this.firstMonth)%this.monthsInYear(r)+this.minMonth},fromMonthOfYear:function(e,t){var r=(t+this.firstMonth-2*this.minMonth)%this.monthsInYear(e)+this.minMonth;this._validate(e,r,this.minDay,u.local.invalidMonth||u.regionalOptions[""].invalidMonth);return r},daysInYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,u.local.invalidYear||u.regionalOptions[""].invalidYear);return this.leapYear(t)?366:365},dayOfYear:function(e,t,r){var a=this._validate(e,t,r,u.local.invalidDate||u.regionalOptions[""].invalidDate);return a.toJD()-this.newDate(a.year(),this.fromMonthOfYear(a.year(),this.minMonth),this.minDay).toJD()+1},daysInWeek:function(){return 7},dayOfWeek:function(e,t,r){var a=this._validate(e,t,r,u.local.invalidDate||u.regionalOptions[""].invalidDate);return(Math.floor(this.toJD(a))+2)%this.daysInWeek()},extraInfo:function(e,t,r){this._validate(e,t,r,u.local.invalidDate||u.regionalOptions[""].invalidDate);return{}},add:function(e,t,r){this._validate(e,this.minMonth,this.minDay,u.local.invalidDate||u.regionalOptions[""].invalidDate);return this._correctAdd(e,this._add(e,t,r),t,r)},_add:function(e,t,r){this._validateLevel++;if(r==="d"||r==="w"){var a=e.toJD()+t*(r==="w"?this.daysInWeek():1);var n=e.calendar().fromJD(a);this._validateLevel--;return[n.year(),n.month(),n.day()]}try{var i=e.year()+(r==="y"?t:0);var o=e.monthOfYear()+(r==="m"?t:0);var n=e.day();var s=function(e){while(o<e.minMonth){i--;o+=e.monthsInYear(i)}var t=e.monthsInYear(i);while(o>t-1+e.minMonth){i++;o-=t;t=e.monthsInYear(i)}};if(r==="y"){if(e.month()!==this.fromMonthOfYear(i,o)){o=this.newDate(i,e.month(),this.minDay).monthOfYear()}o=Math.min(o,this.monthsInYear(i));n=Math.min(n,this.daysInMonth(i,this.fromMonthOfYear(i,o)))}else if(r==="m"){s(this);n=Math.min(n,this.daysInMonth(i,this.fromMonthOfYear(i,o)))}var l=[i,this.fromMonthOfYear(i,o),n];this._validateLevel--;return l}catch(u){this._validateLevel--;throw u}},_correctAdd:function(e,t,r,a){if(!this.hasYearZero&&(a==="y"||a==="m")){if(t[0]===0||e.year()>0!==t[0]>0){var n={y:[1,1,"y"],m:[1,this.monthsInYear(-1),"m"],w:[this.daysInWeek(),this.daysInYear(-1),"d"],d:[1,this.daysInYear(-1),"d"]}[a];var i=r<0?-1:+1;t=this._add(e,r*n[0]+i*n[1],n[2])}}return e.date(t[0],t[1],t[2])},set:function(e,t,r){this._validate(e,this.minMonth,this.minDay,u.local.invalidDate||u.regionalOptions[""].invalidDate);var a=r==="y"?t:e.year();var n=r==="m"?t:e.month();var i=r==="d"?t:e.day();if(r==="y"||r==="m"){i=Math.min(i,this.daysInMonth(a,n))}return e.date(a,n,i)},isValid:function(e,t,r){this._validateLevel++;var a=this.hasYearZero||e!==0;if(a){var n=this.newDate(e,t,this.minDay);a=t>=this.minMonth&&t-this.minMonth<this.monthsInYear(n)&&(r>=this.minDay&&r-this.minDay<this.daysInMonth(n))}this._validateLevel--;return a},toJSDate:function(e,t,r){var a=this._validate(e,t,r,u.local.invalidDate||u.regionalOptions[""].invalidDate);return u.instance().fromJD(this.toJD(a)).toJSDate()},fromJSDate:function(e){return this.fromJD(u.instance().fromJSDate(e).toJD())},_validate:function(e,t,r,a){if(e.year){if(this._validateLevel===0&&this.name!==e.calendar().name){throw(u.local.differentCalendars||u.regionalOptions[""].differentCalendars).replace(/\{0\}/,this.local.name).replace(/\{1\}/,e.calendar().local.name)}return e}try{this._validateLevel++;if(this._validateLevel===1&&!this.isValid(e,t,r)){throw a.replace(/\{0\}/,this.local.name)}var n=this.newDate(e,t,r);this._validateLevel--;return n}catch(i){this._validateLevel--;throw i}}});function l(e){this.local=this.regionalOptions[e]||this.regionalOptions[""]}l.prototype=new s;a(l.prototype,{name:"Gregorian",jdEpoch:1721425.5,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:false,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Gregorian",epochs:["BCE","CE"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"mm/dd/yyyy",firstDay:0,isRTL:false}},leapYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,u.local.invalidYear||u.regionalOptions[""].invalidYear);var e=t.year()+(t.year()<0?1:0);return e%4===0&&(e%100!==0||e%400===0)},weekOfYear:function(e,t,r){var a=this.newDate(e,t,r);a.add(4-(a.dayOfWeek()||7),"d");return Math.floor((a.dayOfYear()-1)/7)+1},daysInMonth:function(e,t){var r=this._validate(e,t,this.minDay,u.local.invalidMonth||u.regionalOptions[""].invalidMonth);return this.daysPerMonth[r.month()-1]+(r.month()===2&&this.leapYear(r.year())?1:0)},weekDay:function(e,t,r){return(this.dayOfWeek(e,t,r)||7)<6},toJD:function(e,t,r){var a=this._validate(e,t,r,u.local.invalidDate||u.regionalOptions[""].invalidDate);e=a.year();t=a.month();r=a.day();if(e<0){e++}if(t<3){t+=12;e--}var n=Math.floor(e/100);var i=2-n+Math.floor(n/4);return Math.floor(365.25*(e+4716))+Math.floor(30.6001*(t+1))+r+i-1524.5},fromJD:function(e){var t=Math.floor(e+.5);var r=Math.floor((t-1867216.25)/36524.25);r=t+1+r-Math.floor(r/4);var a=r+1524;var n=Math.floor((a-122.1)/365.25);var i=Math.floor(365.25*n);var o=Math.floor((a-i)/30.6001);var s=a-i-Math.floor(o*30.6001);var l=o-(o>13.5?13:1);var u=n-(l>2.5?4716:4715);if(u<=0){u--}return this.newDate(u,l,s)},toJSDate:function(e,t,r){var a=this._validate(e,t,r,u.local.invalidDate||u.regionalOptions[""].invalidDate);var n=new Date(a.year(),a.month()-1,a.day());n.setHours(0);n.setMinutes(0);n.setSeconds(0);n.setMilliseconds(0);n.setHours(n.getHours()>12?n.getHours()+2:0);return n},fromJSDate:function(e){return this.newDate(e.getFullYear(),e.getMonth()+1,e.getDate())}});var u=t.exports=new n;u.cdate=i;u.baseCalendar=s;u.calendars.gregorian=l},{"object-assign":476}],629:[function(e,t,r){var a=e("object-assign");var n=e("./main");a(n.regionalOptions[""],{invalidArguments:"Invalid arguments",invalidFormat:"Cannot format a date from another calendar",missingNumberAt:"Missing number at position {0}",unknownNameAt:"Unknown name at position {0}",unexpectedLiteralAt:"Unexpected literal at position {0}",unexpectedText:"Additional text found at end"});n.local=n.regionalOptions[""];a(n.cdate.prototype,{formatDate:function(e,t){if(typeof e!=="string"){t=e;e=""}return this._calendar.formatDate(e||"",this,t)}});a(n.baseCalendar.prototype,{UNIX_EPOCH:n.instance().newDate(1970,1,1).toJD(),SECS_PER_DAY:24*60*60,TICKS_EPOCH:n.instance().jdEpoch,TICKS_PER_DAY:24*60*60*1e7,ATOM:"yyyy-mm-dd",COOKIE:"D, dd M yyyy",FULL:"DD, MM d, yyyy",ISO_8601:"yyyy-mm-dd",JULIAN:"J",RFC_822:"D, d M yy",RFC_850:"DD, dd-M-yy",RFC_1036:"D, d M yy",RFC_1123:"D, d M yyyy",RFC_2822:"D, d M yyyy",RSS:"D, d M yy",TICKS:"!",TIMESTAMP:"@",W3C:"yyyy-mm-dd",formatDate:function(e,t,r){if(typeof e!=="string"){r=t;t=e;e=""}if(!t){return""}if(t.calendar()!==this){throw n.local.invalidFormat||n.regionalOptions[""].invalidFormat}e=e||this.local.dateFormat;r=r||{};var a=r.dayNamesShort||this.local.dayNamesShort;var i=r.dayNames||this.local.dayNames;var o=r.monthNumbers||this.local.monthNumbers;var s=r.monthNamesShort||this.local.monthNamesShort;var l=r.monthNames||this.local.monthNames;var u=r.calculateWeek||this.local.calculateWeek;var c=function(t,r){var a=1;while(b+a<e.length&&e.charAt(b+a)===t){a++}b+=a-1;return Math.floor(a/(r||1))>1};var f=function(e,t,r,a){var n=""+t;if(c(e,a)){while(n.length<r){n="0"+n}}return n};var h=function(e,t,r,a){return c(e)?a[t]:r[t]};var p=this;var v=function(e){return typeof o==="function"?o.call(p,e,c("m")):g(f("m",e.month(),2))};var d=function(e,t){if(t){return typeof l==="function"?l.call(p,e):l[e.month()-p.minMonth]}else{return typeof s==="function"?s.call(p,e):s[e.month()-p.minMonth]}};var m=this.local.digits;var g=function(e){return r.localNumbers&&m?m(e):e};var y="";var x=false;for(var b=0;b<e.length;b++){if(x){if(e.charAt(b)==="'"&&!c("'")){x=false}else{y+=e.charAt(b)}}else{switch(e.charAt(b)){case"d":y+=g(f("d",t.day(),2));break;case"D":y+=h("D",t.dayOfWeek(),a,i);break;case"o":y+=f("o",t.dayOfYear(),3);break;case"w":y+=f("w",t.weekOfYear(),2);break;case"m":y+=v(t);break;case"M":y+=d(t,c("M"));break;case"y":y+=c("y",2)?t.year():(t.year()%100<10?"0":"")+t.year()%100;break;case"Y":c("Y",2);y+=t.formatYear();break;case"J":y+=t.toJD();break;case"@":y+=(t.toJD()-this.UNIX_EPOCH)*this.SECS_PER_DAY;break;case"!":y+=(t.toJD()-this.TICKS_EPOCH)*this.TICKS_PER_DAY;break;case"'":if(c("'")){y+="'"}else{x=true}break;default:y+=e.charAt(b)}}}return y},parseDate:function(e,t,r){if(t==null){throw n.local.invalidArguments||n.regionalOptions[""].invalidArguments}t=typeof t==="object"?t.toString():t+"";if(t===""){return null}e=e||this.local.dateFormat;r=r||{};var a=r.shortYearCutoff||this.shortYearCutoff;a=typeof a!=="string"?a:this.today().year()%100+parseInt(a,10);var i=r.dayNamesShort||this.local.dayNamesShort;var o=r.dayNames||this.local.dayNames;var s=r.parseMonth||this.local.parseMonth;var l=r.monthNumbers||this.local.monthNumbers;var u=r.monthNamesShort||this.local.monthNamesShort;var c=r.monthNames||this.local.monthNames;var f=-1;var h=-1;var p=-1;var v=-1;var d=-1;var m=false;var g=false;var y=function(t,r){var a=1;while(A+a<e.length&&e.charAt(A+a)===t){a++}A+=a-1;return Math.floor(a/(r||1))>1};var x=function(e,r){var a=y(e,r);var i=[2,3,a?4:2,a?4:2,10,11,20]["oyYJ@!".indexOf(e)+1];var o=new RegExp("^-?\\d{1,"+i+"}");var s=t.substring(M).match(o);if(!s){throw(n.local.missingNumberAt||n.regionalOptions[""].missingNumberAt).replace(/\{0\}/,M)}M+=s[0].length;return parseInt(s[0],10)};var b=this;var _=function(){if(typeof l==="function"){y("m");var e=l.call(b,t.substring(M));M+=e.length;return e}return x("m")};var w=function(e,r,a,i){var o=y(e,i)?a:r;for(var s=0;s<o.length;s++){if(t.substr(M,o[s].length).toLowerCase()===o[s].toLowerCase()){M+=o[s].length;return s+b.minMonth}}throw(n.local.unknownNameAt||n.regionalOptions[""].unknownNameAt).replace(/\{0\}/,M)};var T=function(){if(typeof c==="function"){var e=y("M")?c.call(b,t.substring(M)):u.call(b,t.substring(M));M+=e.length;return e}return w("M",u,c)};var k=function(){if(t.charAt(M)!==e.charAt(A)){throw(n.local.unexpectedLiteralAt||n.regionalOptions[""].unexpectedLiteralAt).replace(/\{0\}/,M)}M++};var M=0;for(var A=0;A<e.length;A++){if(g){if(e.charAt(A)==="'"&&!y("'")){g=false}else{k()}}else{switch(e.charAt(A)){case"d":v=x("d");break;case"D":w("D",i,o);break;case"o":d=x("o");break;case"w":x("w");break;case"m":p=_();break;case"M":p=T();break;case"y":var S=A;m=!y("y",2);A=S;h=x("y",2);break;case"Y":h=x("Y",2);break;case"J":f=x("J")+.5;if(t.charAt(M)==="."){M++;x("J")}break;case"@":f=x("@")/this.SECS_PER_DAY+this.UNIX_EPOCH;break;case"!":f=x("!")/this.TICKS_PER_DAY+this.TICKS_EPOCH;break;case"*":M=t.length;break;case"'":if(y("'")){k()}else{g=true}break;default:k()}}}if(M<t.length){throw n.local.unexpectedText||n.regionalOptions[""].unexpectedText}if(h===-1){h=this.today().year()}else if(h<100&&m){h+=a===-1?1900:this.today().year()-this.today().year()%100-(h<=a?0:100)}if(typeof p==="string"){p=s.call(this,h,p)}if(d>-1){p=1;v=d;for(var E=this.daysInMonth(h,p);v>E;E=this.daysInMonth(h,p)){p++;v-=E}}return f>-1?this.fromJD(f):this.newDate(h,p,v)},determineDate:function(e,t,r,a,n){if(r&&typeof r!=="object"){n=a;a=r;r=null}if(typeof a!=="string"){n=a;a=""}var i=this;var o=function(e){try{return i.parseDate(a,e,n)}catch(l){}e=e.toLowerCase();var t=(e.match(/^c/)&&r?r.newDate():null)||i.today();var o=/([+-]?[0-9]+)\s*(d|w|m|y)?/g;var s=o.exec(e);while(s){t.add(parseInt(s[1],10),s[2]||"d");s=o.exec(e)}return t};t=t?t.newDate():null;e=e==null?t:typeof e==="string"?o(e):typeof e==="number"?isNaN(e)||e===Infinity||e===-Infinity?t:i.today().add(e,"d"):i.newDate(e);return e}})},{"./main":628,"object-assign":476}],630:[function(e,t,r){"use strict";function a(){return function(e,t,r,a,n,i){var o=e[0],s=r[0],l=[0],u=s;a|=0;var c=0,f=s;for(c=0;c<o;++c){{var h=t[a]-i;var p=t[a+u]-i;if(h>=0!==p>=0){n.push(l[0]+.5+.5*(h+p)/(h-p))}}a+=f;++l[0]}}}function n(){return a()}var i=n;function o(e){var t={};return function r(a,n,i){var o=a.dtype,s=a.order,l=[o,s.join()].join(),u=t[l];if(!u){t[l]=u=e([o,s])}return u(a.shape.slice(0),a.data,a.stride,a.offset|0,n,i)}}function s(e){return o(i.bind(undefined,e))}function l(e){return s({funcName:e.funcName})}t.exports=l({funcName:"zeroCrossings"})},{}],631:[function(e,t,r){"use strict";t.exports=n;var a=e("./lib/zc-core");function n(e,t){var r=[];t=+t||0;a(e.hi(e.shape[0]-1),r,t);return r}},{"./lib/zc-core":630}],632:[function(e,t,r){"use strict";t.exports=[{path:"",backoff:0},{path:"M-2.4,-3V3L0.6,0Z",backoff:.6},{path:"M-3.7,-2.5V2.5L1.3,0Z",backoff:1.3},{path:"M-4.45,-3L-1.65,-0.2V0.2L-4.45,3L1.55,0Z",backoff:1.55},{path:"M-2.2,-2.2L-0.2,-0.2V0.2L-2.2,2.2L-1.4,3L1.6,0L-1.4,-3Z",backoff:1.6},{path:"M-4.4,-2.1L-0.6,-0.2V0.2L-4.4,2.1L-4,3L2,0L-4,-3Z",backoff:2},{path:"M2,0A2,2 0 1,1 0,-2A2,2 0 0,1 2,0Z",backoff:0,noRotate:true},{path:"M2,2V-2H-2V2Z",backoff:0,noRotate:true}]},{}],633:[function(e,t,r){"use strict";var a=e("./arrow_paths");var n=e("../../plots/font_attributes");var i=e("../../plots/cartesian/constants");var o=e("../../plot_api/plot_template").templatedArray;var s=e("../../constants/axis_placeable_objects");function l(e){return["In order for absolute positioning of the arrow to work, *a"+e+"ref* must be exactly the same as *"+e+"ref*, otherwise *a"+e+"ref* will revert to *pixel* (explained next).","For relative positioning, *a"+e+"ref* can be set to *pixel*,","in which case the *a"+e+"* value is specified in pixels","relative to *"+e+"*.","Absolute positioning is useful","for trendline annotations which should continue to indicate","the correct trend when zoomed. Relative positioning is useful","for specifying the text offset for an annotated point."].join(" ")}function u(e,t,r){return["Sets the",e,"component of the arrow tail about the arrow head.","If `a"+e+"ref` is `pixel`, a positive (negative)","component corresponds to an arrow pointing","from",r,"to",t,"("+t,"to",r+").","If `a"+e+"ref` is not `pixel` and is exactly the same as `"+e+"ref`,","this is an absolute value on that axis,","like `"+e+"`, specified in the same coordinates as `"+e+"ref`."].join(" ")}t.exports=o("annotation",{visible:{valType:"boolean",dflt:true,editType:"calc+arraydraw"},text:{valType:"string",editType:"calc+arraydraw"},textangle:{valType:"angle",dflt:0,editType:"calc+arraydraw"},font:n({editType:"calc+arraydraw",colorEditType:"arraydraw"}),width:{valType:"number",min:1,dflt:null,editType:"calc+arraydraw"},height:{valType:"number",min:1,dflt:null,editType:"calc+arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},align:{valType:"enumerated",values:["left","center","right"],dflt:"center",editType:"arraydraw"},valign:{valType:"enumerated",values:["top","middle","bottom"],dflt:"middle",editType:"arraydraw"},bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},bordercolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},borderpad:{valType:"number",min:0,dflt:1,editType:"calc+arraydraw"},borderwidth:{valType:"number",min:0,dflt:1,editType:"calc+arraydraw"},showarrow:{valType:"boolean",dflt:true,editType:"calc+arraydraw"},arrowcolor:{valType:"color",editType:"arraydraw"},arrowhead:{valType:"integer",min:0,max:a.length,dflt:1,editType:"arraydraw"},startarrowhead:{valType:"integer",min:0,max:a.length,dflt:1,editType:"arraydraw"},arrowside:{valType:"flaglist",flags:["end","start"],extras:["none"],dflt:"end",editType:"arraydraw"},arrowsize:{valType:"number",min:.3,dflt:1,editType:"calc+arraydraw"},startarrowsize:{valType:"number",min:.3,dflt:1,editType:"calc+arraydraw"},arrowwidth:{valType:"number",min:.1,editType:"calc+arraydraw"},standoff:{valType:"number",min:0,dflt:0,editType:"calc+arraydraw"},startstandoff:{valType:"number",min:0,dflt:0,editType:"calc+arraydraw"},ax:{valType:"any",editType:"calc+arraydraw"},ay:{valType:"any",editType:"calc+arraydraw"},axref:{valType:"enumerated",dflt:"pixel",values:["pixel",i.idRegex.x.toString()],editType:"calc"},ayref:{valType:"enumerated",dflt:"pixel",values:["pixel",i.idRegex.y.toString()],editType:"calc"},xref:{valType:"enumerated",values:["paper",i.idRegex.x.toString()],editType:"calc"},x:{valType:"any",editType:"calc+arraydraw"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"auto",editType:"calc+arraydraw"},xshift:{valType:"number",dflt:0,editType:"calc+arraydraw"},yref:{valType:"enumerated",values:["paper",i.idRegex.y.toString()],editType:"calc"},y:{valType:"any",editType:"calc+arraydraw"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"auto",editType:"calc+arraydraw"},yshift:{valType:"number",dflt:0,editType:"calc+arraydraw"},clicktoshow:{valType:"enumerated",values:[false,"onoff","onout"],dflt:false,editType:"arraydraw"},xclick:{valType:"any",editType:"arraydraw"},yclick:{valType:"any",editType:"arraydraw"},hovertext:{valType:"string",editType:"arraydraw"},hoverlabel:{bgcolor:{valType:"color",editType:"arraydraw"},bordercolor:{valType:"color",editType:"arraydraw"},font:n({editType:"arraydraw"}),editType:"arraydraw"},captureevents:{valType:"boolean",editType:"arraydraw"},editType:"calc",_deprecated:{ref:{valType:"string",editType:"calc"}}})},{"../../constants/axis_placeable_objects":756,"../../plot_api/plot_template":827,"../../plots/cartesian/constants":845,"../../plots/font_attributes":867,"./arrow_paths":632}],634:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("../../plots/cartesian/axes");var i=e("./draw").draw;t.exports=function e(t){var r=t._fullLayout;var n=a.filterVisible(r.annotations);if(n.length&&t._fullData.length){return a.syncOrAsync([i,o],t)}};function o(e){var t=e._fullLayout;a.filterVisible(t.annotations).forEach((function(t){var r=n.getFromId(e,t.xref);var a=n.getFromId(e,t.yref);var i=n.getRefType(t.xref);var o=n.getRefType(t.yref);t._extremes={};if(i==="range")s(t,r);if(o==="range")s(t,a)}))}function s(e,t){var r=t._id;var a=r.charAt(0);var i=e[a];var o=e["a"+a];var s=e[a+"ref"];var l=e["a"+a+"ref"];var u=e["_"+a+"padplus"];var c=e["_"+a+"padminus"];var f={x:1,y:-1}[a]*e[a+"shift"];var h=3*e.arrowsize*e.arrowwidth||0;var p=h+f;var v=h-f;var d=3*e.startarrowsize*e.arrowwidth||0;var m=d+f;var g=d-f;var y;if(l===s){var x=n.findExtremes(t,[t.r2c(i)],{ppadplus:p,ppadminus:v});var b=n.findExtremes(t,[t.r2c(o)],{ppadplus:Math.max(u,m),ppadminus:Math.max(c,g)});y={min:[x.min[0],b.min[0]],max:[x.max[0],b.max[0]]}}else{m=o?m+o:m;g=o?g-o:g;y=n.findExtremes(t,[t.r2c(i)],{ppadplus:Math.max(u,p,m),ppadminus:Math.max(c,v,g)})}e._extremes[r]=y}},{"../../lib":787,"../../plots/cartesian/axes":838,"./draw":639}],635:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("../../registry");var i=e("../../plot_api/plot_template").arrayEditor;t.exports={hasClickToShow:o,onClick:s};function o(e,t){var r=l(e,t);return r.on.length>0||r.explicitOff.length>0}function s(e,t){var r=l(e,t);var o=r.on;var s=r.off.concat(r.explicitOff);var u={};var c=e._fullLayout.annotations;var f,h;if(!(o.length||s.length))return;for(f=0;f<o.length;f++){h=i(e.layout,"annotations",c[o[f]]);h.modifyItem("visible",true);a.extendFlat(u,h.getUpdateObj())}for(f=0;f<s.length;f++){h=i(e.layout,"annotations",c[s[f]]);h.modifyItem("visible",false);a.extendFlat(u,h.getUpdateObj())}return n.call("update",e,{},u)}function l(e,t){var r=e._fullLayout.annotations;var a=[];var n=[];var i=[];var o=(t||[]).length;var s,l,c,f,h,p,v,d;for(s=0;s<r.length;s++){c=r[s];f=c.clicktoshow;if(f){for(l=0;l<o;l++){h=t[l];p=h.xaxis;v=h.yaxis;if(p._id===c.xref&&v._id===c.yref&&p.d2r(h.x)===u(c._xclick,p)&&v.d2r(h.y)===u(c._yclick,v)){if(c.visible){if(f==="onout")d=n;else d=i}else{d=a}d.push(s);break}}if(l===o){if(c.visible&&f==="onout")n.push(s)}}}return{on:a,off:n,explicitOff:i}}function u(e,t){return t.type==="log"?t.l2r(e):t.d2r(e)}},{"../../lib":787,"../../plot_api/plot_template":827,"../../registry":915}],636:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("../color");t.exports=function e(t,r,i,o){o("opacity");var s=o("bgcolor");var l=o("bordercolor");var u=n.opacity(l);o("borderpad");var c=o("borderwidth");var f=o("showarrow");o("text",f?" ":i._dfltTitle.annotation);o("textangle");a.coerceFont(o,"font",i.font);o("width");o("align");var h=o("height");if(h)o("valign");if(f){var p=o("arrowside");var v;var d;if(p.indexOf("end")!==-1){v=o("arrowhead");d=o("arrowsize")}if(p.indexOf("start")!==-1){o("startarrowhead",v);o("startarrowsize",d)}o("arrowcolor",u?r.bordercolor:n.defaultLine);o("arrowwidth",(u&&c||1)*2);o("standoff");o("startstandoff")}var m=o("hovertext");var g=i.hoverlabel||{};if(m){var y=o("hoverlabel.bgcolor",g.bgcolor||(n.opacity(s)?n.rgb(s):n.defaultLine));var x=o("hoverlabel.bordercolor",g.bordercolor||n.contrast(y));a.coerceFont(o,"hoverlabel.font",{family:g.font.family,size:g.font.size,color:g.font.color||x})}o("captureevents",!!m)}},{"../../lib":787,"../color":650}],637:[function(e,t,r){"use strict";var a=e("fast-isnumeric");var n=e("../../lib/to_log_range");t.exports=function e(t,r,i,o){r=r||{};var s=i==="log"&&r.type==="linear";var l=i==="linear"&&r.type==="log";if(!(s||l))return;var u=t._fullLayout.annotations;var c=r._id.charAt(0);var f;var h;function p(e){var t=f[e];var i=null;if(s)i=n(t,r.range);else i=Math.pow(10,t);if(!a(i))i=null;o(h+e,i)}for(var v=0;v<u.length;v++){f=u[v];h="annotations["+v+"].";if(f[c+"ref"]===r._id)p(c);if(f["a"+c+"ref"]===r._id)p("a"+c)}}},{"../../lib/to_log_range":815,"fast-isnumeric":246}],638:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("../../plots/cartesian/axes");var i=e("../../plots/array_container_defaults");var o=e("./common_defaults");var s=e("./attributes");t.exports=function e(t,r){i(t,r,{name:"annotations",handleItemDefaults:l})};function l(e,t,r){function i(r,n){return a.coerce(e,t,s,r,n)}var l=i("visible");var u=i("clicktoshow");if(!(l||u))return;o(e,t,r,i);var c=t.showarrow;var f=["x","y"];var h=[-10,-30];var p={_fullLayout:r};for(var v=0;v<2;v++){var d=f[v];var m=n.coerceRef(e,t,p,d,"","paper");if(m!=="paper"){var g=n.getFromId(p,m);g._annIndices.push(t._index)}n.coercePosition(t,p,i,m,d,.5);if(c){var y="a"+d;var x=n.coerceRef(e,t,p,y,"pixel",["pixel","paper"]);if(x!=="pixel"&&x!==m){x=t[y]="pixel"}var b=x==="pixel"?h[v]:.4;n.coercePosition(t,p,i,x,y,b)}i(d+"anchor");i(d+"shift")}a.noneOrAll(e,t,["x","y"]);if(c){a.noneOrAll(e,t,["ax","ay"])}if(u){var _=i("xclick");var w=i("yclick");t._xclick=_===undefined?t.x:n.cleanPosition(_,p,t.xref);t._yclick=w===undefined?t.y:n.cleanPosition(w,p,t.yref)}}},{"../../lib":787,"../../plots/array_container_defaults":833,"../../plots/cartesian/axes":838,"./attributes":633,"./common_defaults":636}],639:[function(e,t,r){"use strict";var a=e("@plotly/d3");var n=e("../../registry");var i=e("../../plots/plots");var o=e("../../lib");var s=o.strTranslate;var l=e("../../plots/cartesian/axes");var u=e("../color");var c=e("../drawing");var f=e("../fx");var h=e("../../lib/svg_text_utils");var p=e("../../lib/setcursor");var v=e("../dragelement");var d=e("../../plot_api/plot_template").arrayEditor;var m=e("./draw_arrow_head");t.exports={draw:g,drawOne:y,drawRaw:b};function g(e){var t=e._fullLayout;t._infolayer.selectAll(".annotation").remove();for(var r=0;r<t.annotations.length;r++){if(t.annotations[r].visible){y(e,r)}}return i.previousPromises(e)}function y(e,t){var r=e._fullLayout;var a=r.annotations[t]||{};var n=l.getFromId(e,a.xref);var i=l.getFromId(e,a.yref);if(n)n.setScale();if(i)i.setScale();b(e,a,t,false,n,i)}function x(e,t,r,a,n){var i=n[r];var o=n[r+"ref"];var s=r.indexOf("y")!==-1;var u=l.getRefType(o)==="domain";var c=s?a.h:a.w;if(e){if(u){return i+(s?-t:t)/e._length}else{return e.p2r(e.r2p(i)+t)}}else{return i+(s?-t:t)/c}}function b(e,t,r,i,g,y){var b=e._fullLayout;var _=e._fullLayout._size;var w=e._context.edits;var T,k;if(i){T="annotation-"+i;k=i+".annotations"}else{T="annotation";k="annotations"}var M=d(e.layout,k,t);var A=M.modifyBase;var S=M.modifyItem;var E=M.getUpdateObj;b._infolayer.selectAll("."+T+'[data-index="'+r+'"]').remove();var L="clip"+b._uid+"_ann"+r;if(!t._input||t.visible===false){a.selectAll("#"+L).remove();return}var C={x:{},y:{}};var I=+t.textangle||0;var P=b._infolayer.append("g").classed(T,true).attr("data-index",String(r)).style("opacity",t.opacity);var O=P.append("g").classed("annotation-text-g",true);var z=w[t.showarrow?"annotationTail":"annotationPosition"];var D=t.captureevents||w.annotationText||z;function R(e){var a={index:r,annotation:t._input,fullAnnotation:t,event:e};if(i){a.subplotId=i}return a}var F=O.append("g").style("pointer-events",D?"all":null).call(p,"pointer").on("click",(function(){e._dragging=false;e.emit("plotly_clickannotation",R(a.event))}));if(t.hovertext){F.on("mouseover",(function(){var r=t.hoverlabel;var a=r.font;var n=this.getBoundingClientRect();var i=e.getBoundingClientRect();f.loneHover({x0:n.left-i.left,x1:n.right-i.left,y:(n.top+n.bottom)/2-i.top,text:t.hovertext,color:r.bgcolor,borderColor:r.bordercolor,fontFamily:a.family,fontSize:a.size,fontColor:a.color},{container:b._hoverlayer.node(),outerContainer:b._paper.node(),gd:e})})).on("mouseout",(function(){f.loneUnhover(b._hoverlayer.node())}))}var B=t.borderwidth;var N=t.borderpad;var j=B+N;var U=F.append("rect").attr("class","bg").style("stroke-width",B+"px").call(u.stroke,t.bordercolor).call(u.fill,t.bgcolor);var V=t.width||t.height;var H=b._topclips.selectAll("#"+L).data(V?[0]:[]);H.enter().append("clipPath").classed("annclip",true).attr("id",L).append("rect");H.exit().remove();var q=t.font;var G=b._meta?o.templateString(t.text,b._meta):t.text;var Y=F.append("text").classed("annotation-text",true).text(G);function W(r){r.call(c.font,q).attr({"text-anchor":{left:"start",right:"end"}[t.align]||"middle"});h.convertToTspans(r,e,X);return r}function X(){var r=Y.selectAll("a");if(r.size()===1&&r.text()===Y.text()){var a=F.insert("a",":first-child").attr({"xlink:xlink:href":r.attr("xlink:href"),"xlink:xlink:show":r.attr("xlink:show")}).style({cursor:"pointer"});a.node().appendChild(U.node())}var f=F.select(".annotation-text-math-group");var d=!f.empty();var T=c.bBox((d?f:Y).node());var k=T.width;var M=T.height;var D=t.width||k;var N=t.height||M;var q=Math.round(D+2*j);var G=Math.round(N+2*j);function W(e,t){if(t==="auto"){if(e<1/3)t="left";else if(e>2/3)t="right";else t="center"}return{center:0,middle:0,left:.5,bottom:-.5,right:-.5,top:.5}[t]}var X=false;var Z=["x","y"];for(var J=0;J<Z.length;J++){var K=Z[J];var Q=t[K+"ref"]||K;var $=t["a"+K+"ref"];var ee={x:g,y}[K];var te=(I+(K==="x"?0:-90))*Math.PI/180;var re=q*Math.cos(te);var ae=G*Math.sin(te);var ne=Math.abs(re)+Math.abs(ae);var ie=t[K+"anchor"];var oe=t[K+"shift"]*(K==="x"?1:-1);var se=C[K];var le;var ue;var ce;var fe;var he;var pe=l.getRefType(Q);if(ee&&pe!=="domain"){var ve=ee.r2fraction(t[K]);if(ve<0||ve>1){if($===Q){ve=ee.r2fraction(t["a"+K]);if(ve<0||ve>1){X=true}}else{X=true}}le=ee._offset+ee.r2p(t[K]);fe=.5}else{var de=pe==="domain";if(K==="x"){ce=t[K];le=de?ee._offset+ee._length*ce:le=_.l+_.w*ce}else{ce=1-t[K];le=de?ee._offset+ee._length*ce:le=_.t+_.h*ce}fe=t.showarrow?.5:ce}if(t.showarrow){se.head=le;var me=t["a"+K];he=re*W(.5,t.xanchor)-ae*W(.5,t.yanchor);if($===Q){var ge=l.getRefType($);if(ge==="domain"){if(K==="y"){me=1-me}se.tail=ee._offset+ee._length*me}else if(ge==="paper"){if(K==="y"){me=1-me;se.tail=_.t+_.h*me}else{se.tail=_.l+_.w*me}}else{se.tail=ee._offset+ee.r2p(me)}ue=he}else{se.tail=le+me;ue=he+me}se.text=se.tail+he;var ye=b[K==="x"?"width":"height"];if(Q==="paper"){se.head=o.constrain(se.head,1,ye-1)}if($==="pixel"){var xe=-Math.max(se.tail-3,se.text);var be=Math.min(se.tail+3,se.text)-ye;if(xe>0){se.tail+=xe;se.text+=xe}else if(be>0){se.tail-=be;se.text-=be}}se.tail+=oe;se.head+=oe}else{he=ne*W(fe,ie);ue=he;se.text=le+he}se.text+=oe;he+=oe;ue+=oe;t["_"+K+"padplus"]=ne/2+ue;t["_"+K+"padminus"]=ne/2-ue;t["_"+K+"size"]=ne;t["_"+K+"shift"]=he}if(X){F.remove();return}var _e=0;var we=0;if(t.align!=="left"){_e=(D-k)*(t.align==="center"?.5:1)}if(t.valign!=="top"){we=(N-M)*(t.valign==="middle"?.5:1)}if(d){f.select("svg").attr({x:j+_e-1,y:j+we}).call(c.setClipUrl,V?L:null,e)}else{var Te=j+we-T.top;var ke=j+_e-T.left;Y.call(h.positionText,ke,Te).call(c.setClipUrl,V?L:null,e)}H.select("rect").call(c.setRect,j,j,D,N);U.call(c.setRect,B/2,B/2,q-B,G-B);F.call(c.setTranslate,Math.round(C.x.text-q/2),Math.round(C.y.text-G/2));O.attr({transform:"rotate("+I+","+C.x.text+","+C.y.text+")"});var Me=function(r,a){P.selectAll(".annotation-arrow-g").remove();var l=C.x.head;var f=C.y.head;var h=C.x.tail+r;var p=C.y.tail+a;var d=C.x.text+r;var b=C.y.text+a;var T=o.rotationXYMatrix(I,d,b);var k=o.apply2DTransform(T);var M=o.apply2DTransform2(T);var L=+U.attr("width");var z=+U.attr("height");var D=d-.5*L;var R=D+L;var B=b-.5*z;var N=B+z;var j=[[D,B,D,N],[D,N,R,N],[R,N,R,B],[R,B,D,B]].map(M);if(j.reduce((function(e,t){return e^!!o.segmentsIntersect(l,f,l+1e6,f+1e6,t[0],t[1],t[2],t[3])}),false)){return}j.forEach((function(e){var t=o.segmentsIntersect(h,p,l,f,e[0],e[1],e[2],e[3]);if(t){h=t.x;p=t.y}}));var V=t.arrowwidth;var H=t.arrowcolor;var q=t.arrowside;var G=P.append("g").style({opacity:u.opacity(H)}).classed("annotation-arrow-g",true);var Y=G.append("path").attr("d","M"+h+","+p+"L"+l+","+f).style("stroke-width",V+"px").call(u.stroke,u.rgb(H));m(Y,q,t);if(w.annotationPosition&&Y.node().parentNode&&!i){var W=l;var X=f;if(t.standoff){var Z=Math.sqrt(Math.pow(l-h,2)+Math.pow(f-p,2));W+=t.standoff*(h-l)/Z;X+=t.standoff*(p-f)/Z}var J=G.append("path").classed("annotation-arrow",true).classed("anndrag",true).classed("cursor-move",true).attr({d:"M3,3H-3V-3H3ZM0,0L"+(h-W)+","+(p-X),transform:s(W,X)}).style("stroke-width",V+6+"px").call(u.stroke,"rgba(0,0,0,0)").call(u.fill,"rgba(0,0,0,0)");var K,Q;v.init({element:J.node(),gd:e,prepFn:function(){var e=c.getTranslate(F);K=e.x;Q=e.y;if(g&&g.autorange){A(g._name+".autorange",true)}if(y&&y.autorange){A(y._name+".autorange",true)}},moveFn:function(e,r){var a=k(K,Q);var n=a[0]+e;var i=a[1]+r;F.call(c.setTranslate,n,i);S("x",x(g,e,"x",_,t));S("y",x(y,r,"y",_,t));if(t.axref===t.xref){S("ax",x(g,e,"ax",_,t))}if(t.ayref===t.yref){S("ay",x(y,r,"ay",_,t))}G.attr("transform",s(e,r));O.attr({transform:"rotate("+I+","+n+","+i+")"})},doneFn:function(){n.call("_guiRelayout",e,E());var t=document.querySelector(".js-notes-box-panel");if(t)t.redraw(t.selectedObj)}})}};if(t.showarrow)Me(0,0);if(z){var Ae;v.init({element:F.node(),gd:e,prepFn:function(){Ae=O.attr("transform")},moveFn:function(e,r){var a="pointer";if(t.showarrow){if(t.axref===t.xref){S("ax",x(g,e,"ax",_,t))}else{S("ax",t.ax+e)}if(t.ayref===t.yref){S("ay",x(y,r,"ay",_.w,t))}else{S("ay",t.ay+r)}Me(e,r)}else if(!i){var n,o;if(g){n=x(g,e,"x",_,t)}else{var l=t._xsize/_.w;var u=t.x+(t._xshift-t.xshift)/_.w-l/2;n=v.align(u+e/_.w,l,0,1,t.xanchor)}if(y){o=x(y,r,"y",_,t)}else{var c=t._ysize/_.h;var f=t.y-(t._yshift+t.yshift)/_.h-c/2;o=v.align(f-r/_.h,c,0,1,t.yanchor)}S("x",n);S("y",o);if(!g||!y){a=v.getCursor(g?.5:n,y?.5:o,t.xanchor,t.yanchor)}}else return;O.attr({transform:s(e,r)+Ae});p(F,a)},clickFn:function(r,a){if(t.captureevents){e.emit("plotly_clickannotation",R(a))}},doneFn:function(){p(F);n.call("_guiRelayout",e,E());var t=document.querySelector(".js-notes-box-panel");if(t)t.redraw(t.selectedObj)}})}}if(w.annotationText){Y.call(h.makeEditable,{delegate:F,gd:e}).call(W).on("edit",(function(r){t.text=r;this.call(W);S("text",r);if(g&&g.autorange){A(g._name+".autorange",true)}if(y&&y.autorange){A(y._name+".autorange",true)}n.call("_guiRelayout",e,E())}))}else Y.call(W)}},{"../../lib":787,"../../lib/setcursor":808,"../../lib/svg_text_utils":813,"../../plot_api/plot_template":827,"../../plots/cartesian/axes":838,"../../plots/plots":901,"../../registry":915,"../color":650,"../dragelement":669,"../drawing":672,"../fx":690,"./draw_arrow_head":640,"@plotly/d3":58}],640:[function(e,t,r){"use strict";var a=e("@plotly/d3");var n=e("../color");var i=e("./arrow_paths");var o=e("../../lib");var s=o.strScale;var l=o.strRotate;var u=o.strTranslate;t.exports=function e(t,r,o){var c=t.node();var f=i[o.arrowhead||0];var h=i[o.startarrowhead||0];var p=(o.arrowwidth||1)*(o.arrowsize||1);var v=(o.arrowwidth||1)*(o.startarrowsize||1);var d=r.indexOf("start")>=0;var m=r.indexOf("end")>=0;var g=f.backoff*p+o.standoff;var y=h.backoff*v+o.startstandoff;var x,b,_,w;if(c.nodeName==="line"){x={x:+t.attr("x1"),y:+t.attr("y1")};b={x:+t.attr("x2"),y:+t.attr("y2")};var T=x.x-b.x;var k=x.y-b.y;_=Math.atan2(k,T);w=_+Math.PI;if(g&&y){if(g+y>Math.sqrt(T*T+k*k)){R();return}}if(g){if(g*g>T*T+k*k){R();return}var M=g*Math.cos(_);var A=g*Math.sin(_);b.x+=M;b.y+=A;t.attr({x2:b.x,y2:b.y})}if(y){if(y*y>T*T+k*k){R();return}var S=y*Math.cos(_);var E=y*Math.sin(_);x.x-=S;x.y-=E;t.attr({x1:x.x,y1:x.y})}}else if(c.nodeName==="path"){var L=c.getTotalLength();var C="";if(L<g+y){R();return}var I=c.getPointAtLength(0);var P=c.getPointAtLength(.1);_=Math.atan2(I.y-P.y,I.x-P.x);x=c.getPointAtLength(Math.min(y,L));C="0px,"+y+"px,";var O=c.getPointAtLength(L);var z=c.getPointAtLength(L-.1);w=Math.atan2(O.y-z.y,O.x-z.x);b=c.getPointAtLength(Math.max(0,L-g));var D=C?y+g:g;C+=L-D+"px,"+L+"px";t.style("stroke-dasharray",C)}function R(){t.style("stroke-dasharray","0px,100px")}function F(e,r,i,f){if(!e.path)return;if(e.noRotate)i=0;a.select(c.parentNode).append("path").attr({class:t.attr("class"),d:e.path,transform:u(r.x,r.y)+l(i*180/Math.PI)+s(f)}).style({fill:n.rgb(o.arrowcolor),"stroke-width":0})}if(d)F(h,x,_,v);if(m)F(f,b,w,p)}},{"../../lib":787,"../color":650,"./arrow_paths":632,"@plotly/d3":58}],641:[function(e,t,r){"use strict";var a=e("./draw");var n=e("./click");t.exports={moduleType:"component",name:"annotations",layoutAttributes:e("./attributes"),supplyLayoutDefaults:e("./defaults"),includeBasePlot:e("../../plots/cartesian/include_components")("annotations"),calcAutorange:e("./calc_autorange"),draw:a.draw,drawOne:a.drawOne,drawRaw:a.drawRaw,hasClickToShow:n.hasClickToShow,onClick:n.onClick,convertCoords:e("./convert_coords")}},{"../../plots/cartesian/include_components":851,"./attributes":633,"./calc_autorange":634,"./click":635,"./convert_coords":637,"./defaults":638,"./draw":639}],642:[function(e,t,r){"use strict";var a=e("../annotations/attributes");var n=e("../../plot_api/edit_types").overrideAll;var i=e("../../plot_api/plot_template").templatedArray;t.exports=n(i("annotation",{visible:a.visible,x:{valType:"any"},y:{valType:"any"},z:{valType:"any"},ax:{valType:"number"},ay:{valType:"number"},xanchor:a.xanchor,xshift:a.xshift,yanchor:a.yanchor,yshift:a.yshift,text:a.text,textangle:a.textangle,font:a.font,width:a.width,height:a.height,opacity:a.opacity,align:a.align,valign:a.valign,bgcolor:a.bgcolor,bordercolor:a.bordercolor,borderpad:a.borderpad,borderwidth:a.borderwidth,showarrow:a.showarrow,arrowcolor:a.arrowcolor,arrowhead:a.arrowhead,startarrowhead:a.startarrowhead,arrowside:a.arrowside,arrowsize:a.arrowsize,startarrowsize:a.startarrowsize,arrowwidth:a.arrowwidth,standoff:a.standoff,startstandoff:a.startstandoff,hovertext:a.hovertext,hoverlabel:a.hoverlabel,captureevents:a.captureevents}),"calc","from-root")},{"../../plot_api/edit_types":820,"../../plot_api/plot_template":827,"../annotations/attributes":633}],643:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("../../plots/cartesian/axes");t.exports=function e(t){var r=t.fullSceneLayout;var a=r.annotations;for(var n=0;n<a.length;n++){i(a[n],t)}t.fullLayout._infolayer.selectAll(".annotation-"+t.id).remove()};function i(e,t){var r=t.fullSceneLayout;var i=r.domain;var o=t.fullLayout._size;var s={pdata:null,type:"linear",autorange:false,range:[-Infinity,Infinity]};e._xa={};a.extendFlat(e._xa,s);n.setConvert(e._xa);e._xa._offset=o.l+i.x[0]*o.w;e._xa.l2p=function(){return.5*(1+e._pdata[0]/e._pdata[3])*o.w*(i.x[1]-i.x[0])};e._ya={};a.extendFlat(e._ya,s);n.setConvert(e._ya);e._ya._offset=o.t+(1-i.y[1])*o.h;e._ya.l2p=function(){return.5*(1-e._pdata[1]/e._pdata[3])*o.h*(i.y[1]-i.y[0])}}},{"../../lib":787,"../../plots/cartesian/axes":838}],644:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("../../plots/cartesian/axes");var i=e("../../plots/array_container_defaults");var o=e("../annotations/common_defaults");var s=e("./attributes");t.exports=function e(t,r,a){i(t,r,{name:"annotations",handleItemDefaults:l,fullLayout:a.fullLayout})};function l(e,t,r,i){function l(r,n){return a.coerce(e,t,s,r,n)}function u(e){var a=e+"axis";var i={_fullLayout:{}};i._fullLayout[a]=r[a];return n.coercePosition(t,i,l,e,e,.5)}var c=l("visible");if(!c)return;o(e,t,i.fullLayout,l);u("x");u("y");u("z");a.noneOrAll(e,t,["x","y","z"]);t.xref="x";t.yref="y";t.zref="z";l("xanchor");l("yanchor");l("xshift");l("yshift");if(t.showarrow){t.axref="pixel";t.ayref="pixel";l("ax",-10);l("ay",-30);a.noneOrAll(e,t,["ax","ay"])}}},{"../../lib":787,"../../plots/array_container_defaults":833,"../../plots/cartesian/axes":838,"../annotations/common_defaults":636,"./attributes":642}],645:[function(e,t,r){"use strict";var a=e("../annotations/draw").drawRaw;var n=e("../../plots/gl3d/project");var i=["x","y","z"];t.exports=function e(t){var r=t.fullSceneLayout;var o=t.dataScale;var s=r.annotations;for(var l=0;l<s.length;l++){var u=s[l];var c=false;for(var f=0;f<3;f++){var h=i[f];var p=u[h];var v=r[h+"axis"];var d=v.r2fraction(p);if(d<0||d>1){c=true;break}}if(c){t.fullLayout._infolayer.select(".annotation-"+t.id+'[data-index="'+l+'"]').remove()}else{u._pdata=n(t.glplot.cameraParams,[r.xaxis.r2l(u.x)*o[0],r.yaxis.r2l(u.y)*o[1],r.zaxis.r2l(u.z)*o[2]]);a(t.graphDiv,u,l,t.id,u._xa,u._ya)}}}},{"../../plots/gl3d/project":889,"../annotations/draw":639}],646:[function(e,t,r){"use strict";var a=e("../../registry");var n=e("../../lib");t.exports={moduleType:"component",name:"annotations3d",schema:{subplots:{scene:{annotations:e("./attributes")}}},layoutAttributes:e("./attributes"),handleDefaults:e("./defaults"),includeBasePlot:i,convert:e("./convert"),draw:e("./draw")};function i(e,t){var r=a.subplotsRegistry.gl3d;if(!r)return;var i=r.attrRegex;var o=Object.keys(e);for(var s=0;s<o.length;s++){var l=o[s];if(i.test(l)&&(e[l].annotations||[]).length){n.pushUnique(t._basePlotModules,r);n.pushUnique(t._subplots.gl3d,l)}}}},{"../../lib":787,"../../registry":915,"./attributes":642,"./convert":643,"./defaults":644,"./draw":645}],647:[function(e,t,r){"use strict";t.exports=e("world-calendars/dist/main");e("world-calendars/dist/plus");e("world-calendars/dist/calendars/chinese");e("world-calendars/dist/calendars/coptic");e("world-calendars/dist/calendars/discworld");e("world-calendars/dist/calendars/ethiopian");e("world-calendars/dist/calendars/hebrew");e("world-calendars/dist/calendars/islamic");e("world-calendars/dist/calendars/julian");e("world-calendars/dist/calendars/mayan");e("world-calendars/dist/calendars/nanakshahi");e("world-calendars/dist/calendars/nepali");e("world-calendars/dist/calendars/persian");e("world-calendars/dist/calendars/taiwan");e("world-calendars/dist/calendars/thai");e("world-calendars/dist/calendars/ummalqura")},{"world-calendars/dist/calendars/chinese":614,"world-calendars/dist/calendars/coptic":615,"world-calendars/dist/calendars/discworld":616,"world-calendars/dist/calendars/ethiopian":617,"world-calendars/dist/calendars/hebrew":618,"world-calendars/dist/calendars/islamic":619,"world-calendars/dist/calendars/julian":620,"world-calendars/dist/calendars/mayan":621,"world-calendars/dist/calendars/nanakshahi":622,"world-calendars/dist/calendars/nepali":623,"world-calendars/dist/calendars/persian":624,"world-calendars/dist/calendars/taiwan":625,"world-calendars/dist/calendars/thai":626,"world-calendars/dist/calendars/ummalqura":627,"world-calendars/dist/main":628,"world-calendars/dist/plus":629}],648:[function(e,t,r){"use strict";var a=e("./calendars");var n=e("../../lib");var i=e("../../constants/numerical");var o=i.EPOCHJD;var s=i.ONEDAY;var l={valType:"enumerated",values:n.sortObjectKeys(a.calendars),editType:"calc",dflt:"gregorian"};var u=function(e,t,r,a){var i={};i[r]=l;return n.coerce(e,t,i,r,a)};var c=function(e,t,r,a){for(var n=0;n<r.length;n++){u(e,t,r[n]+"calendar",a.calendar)}};var f={chinese:"2000-01-01",coptic:"2000-01-01",discworld:"2000-01-01",ethiopian:"2000-01-01",hebrew:"5000-01-01",islamic:"1000-01-01",julian:"2000-01-01",mayan:"5000-01-01",nanakshahi:"1000-01-01",nepali:"2000-01-01",persian:"1000-01-01",jalali:"1000-01-01",taiwan:"1000-01-01",thai:"2000-01-01",ummalqura:"1400-01-01"};var h={chinese:"2000-01-02",coptic:"2000-01-03",discworld:"2000-01-03",ethiopian:"2000-01-05",hebrew:"5000-01-01",islamic:"1000-01-02",julian:"2000-01-03",mayan:"5000-01-01",nanakshahi:"1000-01-05",nepali:"2000-01-05",persian:"1000-01-01",jalali:"1000-01-01",taiwan:"1000-01-04",thai:"2000-01-04",ummalqura:"1400-01-06"};var p={chinese:["2000-01-01","2001-01-01"],coptic:["1700-01-01","1701-01-01"],discworld:["1800-01-01","1801-01-01"],ethiopian:["2000-01-01","2001-01-01"],hebrew:["5700-01-01","5701-01-01"],islamic:["1400-01-01","1401-01-01"],julian:["2000-01-01","2001-01-01"],mayan:["5200-01-01","5201-01-01"],nanakshahi:["0500-01-01","0501-01-01"],nepali:["2000-01-01","2001-01-01"],persian:["1400-01-01","1401-01-01"],jalali:["1400-01-01","1401-01-01"],taiwan:["0100-01-01","0101-01-01"],thai:["2500-01-01","2501-01-01"],ummalqura:["1400-01-01","1401-01-01"]};var v="##";var d={d:{0:"dd","-":"d"},e:{0:"d","-":"d"},a:{0:"D","-":"D"},A:{0:"DD","-":"DD"},j:{0:"oo","-":"o"},W:{0:"ww","-":"w"},m:{0:"mm","-":"m"},b:{0:"M","-":"M"},B:{0:"MM","-":"MM"},y:{0:"yy","-":"yy"},Y:{0:"yyyy","-":"yyyy"},U:v,w:v,c:{0:"D M d %X yyyy","-":"D M d %X yyyy"},x:{0:"mm/dd/yyyy","-":"mm/dd/yyyy"}};function m(e,t,r){var a=Math.floor((t+.05)/s)+o;var n=y(r).fromJD(a);var i=0;var l,u,c,f,h;while((i=e.indexOf("%",i))!==-1){l=e.charAt(i+1);if(l==="0"||l==="-"||l==="_"){c=3;u=e.charAt(i+2);if(l==="_")l="-"}else{u=l;l="0";c=2}f=d[u];if(!f){i+=c}else{if(f===v)h=v;else h=n.formatDate(f[l]);e=e.substr(0,i)+h+e.substr(i+c);i+=h.length}}return e}var g={};function y(e){var t=g[e];if(t)return t;t=g[e]=a.instance(e);return t}function x(e){return n.extendFlat({},l,{description:e})}function b(e){return"Sets the calendar system to use with `"+e+"` date data."}var _={xcalendar:x(b("x"))};var w=n.extendFlat({},_,{ycalendar:x(b("y"))});var T=n.extendFlat({},w,{zcalendar:x(b("z"))});var k=x(["Sets the calendar system to use for `range` and `tick0`","if this is a date axis. This does not set the calendar for","interpreting data on this axis, that's specified in the trace","or via the global `layout.calendar`"].join(" "));t.exports={moduleType:"component",name:"calendars",schema:{traces:{scatter:w,bar:w,box:w,heatmap:w,contour:w,histogram:w,histogram2d:w,histogram2dcontour:w,scatter3d:T,surface:T,mesh3d:T,scattergl:w,ohlc:_,candlestick:_},layout:{calendar:x(["Sets the default calendar system to use for interpreting and","displaying dates throughout the plot."].join(" "))},subplots:{xaxis:{calendar:k},yaxis:{calendar:k},scene:{xaxis:{calendar:k},yaxis:{calendar:k},zaxis:{calendar:k}},polar:{radialaxis:{calendar:k}}},transforms:{filter:{valuecalendar:x(["WARNING: All transforms are deprecated and may be removed from the API in next major version.","Sets the calendar system to use for `value`, if it is a date."].join(" ")),targetcalendar:x(["WARNING: All transforms are deprecated and may be removed from the API in next major version.","Sets the calendar system to use for `target`, if it is an","array of dates. If `target` is a string (eg *x*) we use the","corresponding trace attribute (eg `xcalendar`) if it exists,","even if `targetcalendar` is provided."].join(" "))}}},layoutAttributes:l,handleDefaults:u,handleTraceDefaults:c,CANONICAL_SUNDAY:h,CANONICAL_TICK:f,DFLTRANGE:p,getCal:y,worldCalFmt:m}},{"../../constants/numerical":763,"../../lib":787,"./calendars":647}],649:[function(e,t,r){"use strict";r.defaults=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"];r.defaultLine="#444";r.lightLine="#eee";r.background="#fff";r.borderLine="#BEC8D9";r.lightFraction=100*(14-4)/(15-4)},{}],650:[function(e,t,r){"use strict";var a=e("tinycolor2");var n=e("fast-isnumeric");var i=e("../../lib/array").isTypedArray;var o=t.exports={};var s=e("./attributes");o.defaults=s.defaults;var l=o.defaultLine=s.defaultLine;o.lightLine=s.lightLine;var u=o.background=s.background;o.tinyRGB=function(e){var t=e.toRgb();return"rgb("+Math.round(t.r)+", "+Math.round(t.g)+", "+Math.round(t.b)+")"};o.rgb=function(e){return o.tinyRGB(a(e))};o.opacity=function(e){return e?a(e).getAlpha():0};o.addOpacity=function(e,t){var r=a(e).toRgb();return"rgba("+Math.round(r.r)+", "+Math.round(r.g)+", "+Math.round(r.b)+", "+t+")"};o.combine=function(e,t){var r=a(e).toRgb();if(r.a===1)return a(e).toRgbString();var n=a(t||u).toRgb();var i=n.a===1?n:{r:255*(1-n.a)+n.r*n.a,g:255*(1-n.a)+n.g*n.a,b:255*(1-n.a)+n.b*n.a};var o={r:i.r*(1-r.a)+r.r*r.a,g:i.g*(1-r.a)+r.g*r.a,b:i.b*(1-r.a)+r.b*r.a};return a(o).toRgbString()};o.contrast=function(e,t,r){var n=a(e);if(n.getAlpha()!==1)n=a(o.combine(e,u));var i=n.isDark()?t?n.lighten(t):u:r?n.darken(r):l;return i.toString()};o.stroke=function(e,t){var r=a(t);e.style({stroke:o.tinyRGB(r),"stroke-opacity":r.getAlpha()})};o.fill=function(e,t){var r=a(t);e.style({fill:o.tinyRGB(r),"fill-opacity":r.getAlpha()})};o.clean=function(e){if(!e||typeof e!=="object")return;var t=Object.keys(e);var r,a,n,s;for(r=0;r<t.length;r++){n=t[r];s=e[n];if(n.substr(n.length-5)==="color"){if(Array.isArray(s)){for(a=0;a<s.length;a++)s[a]=c(s[a])}else e[n]=c(s)}else if(n.substr(n.length-10)==="colorscale"&&Array.isArray(s)){for(a=0;a<s.length;a++){if(Array.isArray(s[a]))s[a][1]=c(s[a][1])}}else if(Array.isArray(s)){var l=s[0];if(!Array.isArray(l)&&l&&typeof l==="object"){for(a=0;a<s.length;a++)o.clean(s[a])}}else if(s&&typeof s==="object"&&!i(s))o.clean(s)}};function c(e){if(n(e)||typeof e!=="string")return e;var t=e.trim();if(t.substr(0,3)!=="rgb")return e;var r=t.match(/^rgba?\s*\(([^()]*)\)$/);if(!r)return e;var a=r[1].trim().split(/\s*[\s,]\s*/);var i=t.charAt(3)==="a"&&a.length===4;if(!i&&a.length!==3)return e;for(var o=0;o<a.length;o++){if(!a[o].length)return e;a[o]=Number(a[o]);if(!(a[o]>=0)){return e}if(o===3){if(a[o]>1)a[o]=1}else if(a[o]>=1){return e}}var s=Math.round(a[0]*255)+", "+Math.round(a[1]*255)+", "+Math.round(a[2]*255);if(i)return"rgba("+s+", "+a[3]+")";return"rgb("+s+")"}},{"../../lib/array":769,"./attributes":649,"fast-isnumeric":246,tinycolor2:583}],651:[function(e,t,r){"use strict";var a=e("../../plots/cartesian/layout_attributes");var n=e("../../plots/font_attributes");var i=e("../../lib/extend").extendFlat;var o=e("../../plot_api/edit_types").overrideAll;t.exports=o({thicknessmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"pixels"},thickness:{valType:"number",min:0,dflt:30},lenmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"fraction"},len:{valType:"number",min:0,dflt:1},x:{valType:"number",dflt:1.02,min:-2,max:3},xanchor:{valType:"enumerated",values:["left","center","right"],dflt:"left"},xpad:{valType:"number",min:0,dflt:10},y:{valType:"number",dflt:.5,min:-2,max:3},yanchor:{valType:"enumerated",values:["top","middle","bottom"],dflt:"middle"},ypad:{valType:"number",min:0,dflt:10},outlinecolor:a.linecolor,outlinewidth:a.linewidth,bordercolor:a.linecolor,borderwidth:{valType:"number",min:0,dflt:0},bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)"},tickmode:a.tickmode,nticks:a.nticks,tick0:a.tick0,dtick:a.dtick,tickvals:a.tickvals,ticktext:a.ticktext,ticks:i({},a.ticks,{dflt:""}),ticklabeloverflow:i({},a.ticklabeloverflow,{}),ticklabelposition:{valType:"enumerated",values:["outside","inside","outside top","inside top","outside bottom","inside bottom"],dflt:"outside"},ticklen:a.ticklen,tickwidth:a.tickwidth,tickcolor:a.tickcolor,showticklabels:a.showticklabels,tickfont:n({}),tickangle:a.tickangle,tickformat:a.tickformat,tickformatstops:a.tickformatstops,tickprefix:a.tickprefix,showtickprefix:a.showtickprefix,ticksuffix:a.ticksuffix,showticksuffix:a.showticksuffix,separatethousands:a.separatethousands,exponentformat:a.exponentformat,minexponent:a.minexponent,showexponent:a.showexponent,title:{text:{valType:"string"},font:n({}),side:{valType:"enumerated",values:["right","top","bottom"],dflt:"top"}},_deprecated:{title:{valType:"string"},titlefont:n({}),titleside:{valType:"enumerated",values:["right","top","bottom"],dflt:"top"}}},"colorbars","from-root")},{"../../lib/extend":777,"../../plot_api/edit_types":820,"../../plots/cartesian/layout_attributes":853,"../../plots/font_attributes":867}],652:[function(e,t,r){"use strict";t.exports={cn:{colorbar:"colorbar",cbbg:"cbbg",cbfill:"cbfill",cbfills:"cbfills",cbline:"cbline",cblines:"cblines",cbaxis:"cbaxis",cbtitleunshift:"cbtitleunshift",cbtitle:"cbtitle",cboutline:"cboutline",crisp:"crisp",jsPlaceholder:"js-placeholder"}}},{}],653:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("../../plot_api/plot_template");var i=e("../../plots/cartesian/tick_value_defaults");var o=e("../../plots/cartesian/tick_mark_defaults");var s=e("../../plots/cartesian/tick_label_defaults");var l=e("./attributes");t.exports=function e(t,r,u){var c=n.newContainer(r,"colorbar");var f=t.colorbar||{};function h(e,t){return a.coerce(f,c,l,e,t)}var p=h("thicknessmode");h("thickness",p==="fraction"?30/(u.width-u.margin.l-u.margin.r):30);var v=h("lenmode");h("len",v==="fraction"?1:u.height-u.margin.t-u.margin.b);h("x");h("xanchor");h("xpad");h("y");h("yanchor");h("ypad");a.noneOrAll(f,c,["x","y"]);h("outlinecolor");h("outlinewidth");h("bordercolor");h("borderwidth");h("bgcolor");var d=h("ticklabelposition");h("ticklabeloverflow",d.indexOf("inside")!==-1?"hide past domain":"hide past div");i(f,c,h,"linear");var m=u.font;var g={outerTicks:false,font:m};if(d.indexOf("inside")!==-1){g.bgColor="black"}s(f,c,h,"linear",g);o(f,c,h,"linear",g);h("title.text",u._dfltTitle.colorbar);var y=c.tickfont;var x=a.extendFlat({},y,{color:m.color,size:a.bigFont(y.size)});a.coerceFont(h,"title.font",x);h("title.side")}},{"../../lib":787,"../../plot_api/plot_template":827,"../../plots/cartesian/tick_label_defaults":860,"../../plots/cartesian/tick_mark_defaults":861,"../../plots/cartesian/tick_value_defaults":862,"./attributes":651}],654:[function(e,t,r){"use strict";var a=e("@plotly/d3");var n=e("tinycolor2");var i=e("../../plots/plots");var o=e("../../registry");var s=e("../../plots/cartesian/axes");var l=e("../dragelement");var u=e("../../lib");var c=u.strTranslate;var f=e("../../lib/extend").extendFlat;var h=e("../../lib/setcursor");var p=e("../drawing");var v=e("../color");var d=e("../titles");var m=e("../../lib/svg_text_utils");var g=e("../colorscale/helpers").flipScale;var y=e("../../plots/cartesian/axis_defaults");var x=e("../../plots/cartesian/position_defaults");var b=e("../../plots/cartesian/layout_attributes");var _=e("../../constants/alignment");var w=_.LINE_SPACING;var T=_.FROM_TL;var k=_.FROM_BR;var M=e("./constants").cn;function A(e){var t=e._fullLayout;var r=t._infolayer.selectAll("g."+M.colorbar).data(S(e),(function(e){return e._id}));r.enter().append("g").attr("class",(function(e){return e._id})).classed(M.colorbar,true);r.each((function(t){var r=a.select(this);u.ensureSingle(r,"rect",M.cbbg);u.ensureSingle(r,"g",M.cbfills);u.ensureSingle(r,"g",M.cblines);u.ensureSingle(r,"g",M.cbaxis,(function(e){e.classed(M.crisp,true)}));u.ensureSingle(r,"g",M.cbtitleunshift,(function(e){e.append("g").classed(M.cbtitle,true)}));u.ensureSingle(r,"rect",M.cboutline);var n=E(r,t,e);if(n&&n.then)(e._promises||[]).push(n);if(e._context.edits.colorbarPosition){L(r,t,e)}}));r.exit().each((function(t){i.autoMargin(e,t._id)})).remove();r.order()}function S(e){var t=e._fullLayout;var r=e.calcdata;var a=[];var n;var i;var o;var s;function l(e){return f(e,{_fillcolor:null,_line:{color:null,width:null,dash:null},_levels:{start:null,end:null,size:null},_filllevels:null,_fillgradient:null,_zrange:null})}function u(){if(typeof s.calc==="function"){s.calc(e,o,n)}else{n._fillgradient=i.reversescale?g(i.colorscale):i.colorscale;n._zrange=[i[s.min],i[s.max]]}}for(var c=0;c<r.length;c++){var h=r[c];o=h[0].trace;var p=o._module.colorbar;if(o.visible===true&&p){var v=Array.isArray(p);var d=v?p:[p];for(var m=0;m<d.length;m++){s=d[m];var y=s.container;i=y?o[y]:o;if(i&&i.showscale){n=l(i.colorbar);n._id="cb"+o.uid+(v&&y?"-"+y:"");n._traceIndex=o.index;n._propPrefix=(y?y+".":"")+"colorbar.";n._meta=o._meta;u();a.push(n)}}}}for(var x in t._colorAxes){i=t[x];if(i.showscale){var b=t._colorAxes[x];n=l(i.colorbar);n._id="cb"+x;n._propPrefix=x+".colorbar.";n._meta=t._meta;s={min:"cmin",max:"cmax"};if(b[0]!=="heatmap"){o=b[1];s.calc=o._module.colorbar.calc}u();a.push(n)}}return a}function E(e,t,r){var o=r._fullLayout;var l=o._size;var h=t._fillcolor;var g=t._line;var y=t.title;var x=y.side;var b=t._zrange||a.extent((typeof h==="function"?h:g.color).domain());var _=typeof g.color==="function"?g.color:function(){return g.color};var A=typeof h==="function"?h:function(){return h};var S=t._levels;var E=C(r,t,b);var L=E.fill;var P=E.line;var O=Math.round(t.thickness*(t.thicknessmode==="fraction"?l.w:1));var z=O/l.w;var D=Math.round(t.len*(t.lenmode==="fraction"?l.h:1));var R=D/l.h;var F=t.xpad/l.w;var B=(t.borderwidth+t.outlinewidth)/2;var N=t.ypad/l.h;var j=Math.round(t.x*l.w+t.xpad);var U=t.x-z*({middle:.5,right:1}[t.xanchor]||0);var V=t.y+R*(({top:-.5,bottom:.5}[t.yanchor]||0)-.5);var H=Math.round(l.h*(1-V));var q=H-D;t._lenFrac=R;t._thickFrac=z;t._xLeftFrac=U;t._yBottomFrac=V;var G=t._axis=I(r,t,b);G.position=t.x+F+z;if(["top","bottom"].indexOf(x)!==-1){G.title.side=x;G.titlex=t.x+F;G.titley=V+(y.side==="top"?R-N:N)}if(g.color&&t.tickmode==="auto"){G.tickmode="linear";G.tick0=S.start;var Y=S.size;var W=u.constrain((H-q)/50,4,15)+1;var X=(b[1]-b[0])/((t.nticks||W)*Y);if(X>1){var Z=Math.pow(10,Math.floor(Math.log(X)/Math.LN10));Y*=Z*u.roundUp(X/Z,[2,5,10]);if((Math.abs(S.start)/S.size+1e-6)%1<2e-6){G.tick0=0}}G.dtick=Y}G.domain=[V+N,V+R-N];G.setScale();e.attr("transform",c(Math.round(l.l),Math.round(l.t)));var J=e.select("."+M.cbtitleunshift).attr("transform",c(-Math.round(l.l),-Math.round(l.t)));var K=e.select("."+M.cbaxis);var Q;var $=0;function ee(a,n){var i={propContainer:G,propName:t._propPrefix+"title",traceIndex:t._traceIndex,_meta:t._meta,placeholder:o._dfltTitle.colorbar,containerGroup:e.select("."+M.cbtitle)};var s=a.charAt(0)==="h"?a.substr(1):"h"+a;e.selectAll("."+s+",."+s+"-math-group").remove();d.draw(r,a,f(i,n||{}))}function te(){if(["top","bottom"].indexOf(x)!==-1){var e=l.l+(t.x+F)*l.w;var r=G.title.font.size;var a;if(x==="top"){a=(1-(V+R-N))*l.h+l.t+3+r*.75}else{a=(1-(V+N))*l.h+l.t-3-r*.25}ee(G._id+"title",{attributes:{x:e,y:a,"text-anchor":"start"}})}}function re(){if(["top","bottom"].indexOf(x)===-1){var e=G.title.font.size;var t=G._offset+G._length/2;var n=l.l+(G.position||0)*l.w+(G.side==="right"?10+e*(G.showticklabels?1:.5):-10-e*(G.showticklabels?.5:0));ee("h"+G._id+"title",{avoid:{selection:a.select(r).selectAll("g."+G._id+"tick"),side:x,offsetLeft:l.l,offsetTop:0,maxShift:o.width},attributes:{x:n,y:t,"text-anchor":"middle"},transform:{rotate:"-90",offset:0}})}}function ae(){if(["top","bottom"].indexOf(x)!==-1){var i=e.select("."+M.cbtitle);var o=i.select("text");var f=[-t.outlinewidth/2,t.outlinewidth/2];var h=i.select(".h"+G._id+"title-math-group").node();var v=15.6;if(o.node()){v=parseInt(o.node().style.fontSize,10)*w}if(h){$=p.bBox(h).height;if($>v){f[1]-=($-v)/2}}else if(o.node()&&!o.classed(M.jsPlaceholder)){$=p.bBox(o.node()).height}if($){$+=5;if(x==="top"){G.domain[1]-=$/l.h;f[1]*=-1}else{G.domain[0]+=$/l.h;var d=m.lineCount(o);f[1]+=(1-d)*v}i.attr("transform",c(f[0],f[1]));G.setScale()}}e.selectAll("."+M.cbfills+",."+M.cblines).attr("transform",c(0,Math.round(l.h*(1-G.domain[1]))));K.attr("transform",c(0,Math.round(-l.t)));var y=e.select("."+M.cbfills).selectAll("rect."+M.cbfill).attr("style","").data(L);y.enter().append("rect").classed(M.cbfill,true).style("stroke","none");y.exit().remove();var T=b.map(G.c2p).map(Math.round).sort((function(e,t){return e-t}));y.each((function(e,i){var o=[i===0?b[0]:(L[i]+L[i-1])/2,i===L.length-1?b[1]:(L[i]+L[i+1])/2].map(G.c2p).map(Math.round);o[1]=u.constrain(o[1]+(o[1]>o[0])?1:-1,T[0],T[1]);var s=a.select(this).attr({x:j,width:Math.max(O,2),y:a.min(o),height:Math.max(a.max(o)-a.min(o),2)});if(t._fillgradient){p.gradient(s,r,t._id,"vertical",t._fillgradient,"fill")}else{var l=A(e).replace("e-","");s.attr("fill",n(l).toHexString())}}));var k=e.select("."+M.cblines).selectAll("path."+M.cbline).data(g.color&&g.width?P:[]);k.enter().append("path").classed(M.cbline,true);k.exit().remove();k.each((function(e){a.select(this).attr("d","M"+j+","+(Math.round(G.c2p(e))+g.width/2%1)+"h"+O).call(p.lineGroupStyle,g.width,_(e),g.dash)}));K.selectAll("g."+G._id+"tick,path").remove();var S=j+O+(t.outlinewidth||0)/2-(t.ticks==="outside"?1:0);var E=s.calcTicks(G);var C=s.getTickSigns(G)[2];s.drawTicks(r,G,{vals:G.ticks==="inside"?s.clipEnds(G,E):E,layer:K,path:s.makeTickPath(G,S,C),transFn:s.makeTransTickFn(G)});return s.drawLabels(r,G,{vals:E,layer:K,transFn:s.makeTransTickLabelFn(G),labelFns:s.makeLabelFns(G,S)})}function ne(){var a=O+t.outlinewidth/2;if(G.ticklabelposition.indexOf("inside")===-1){a+=p.bBox(K.node()).width}Q=J.select("text");if(Q.node()&&!Q.classed(M.jsPlaceholder)){var n=J.select(".h"+G._id+"title-math-group").node();var o;if(n&&["top","bottom"].indexOf(x)!==-1){o=p.bBox(n).width}else{o=p.bBox(J.node()).right-j-l.l}a=Math.max(a,o)}var s=2*t.xpad+a+t.borderwidth+t.outlinewidth/2;var u=H-q;e.select("."+M.cbbg).attr({x:j-t.xpad-(t.borderwidth+t.outlinewidth)/2,y:q-B,width:Math.max(s,2),height:Math.max(u+2*B,2)}).call(v.fill,t.bgcolor).call(v.stroke,t.bordercolor).style("stroke-width",t.borderwidth);e.selectAll("."+M.cboutline).attr({x:j,y:q+t.ypad+(x==="top"?$:0),width:Math.max(O,2),height:Math.max(u-2*t.ypad-$,2)}).call(v.stroke,t.outlinecolor).style({fill:"none","stroke-width":t.outlinewidth});var f=({center:.5,right:1}[t.xanchor]||0)*s;e.attr("transform",c(l.l-f,l.t));var h={};var d=T[t.yanchor];var m=k[t.yanchor];if(t.lenmode==="pixels"){h.y=t.y;h.t=u*d;h.b=u*m}else{h.t=h.b=0;h.yt=t.y+t.len*d;h.yb=t.y-t.len*m}var g=T[t.xanchor];var y=k[t.xanchor];if(t.thicknessmode==="pixels"){h.x=t.x;h.l=s*g;h.r=s*y}else{var b=s-O;h.l=b*g;h.r=b*y;h.xl=t.x-t.thickness*g;h.xr=t.x+t.thickness*y}i.autoMargin(r,t._id,h)}return u.syncOrAsync([i.previousPromises,te,ae,re,i.previousPromises,ne],r)}function L(e,t,r){var a=r._fullLayout;var n=a._size;var i,s,u;l.init({element:e.node(),gd:r,prepFn:function(){i=e.attr("transform");h(e)},moveFn:function(r,a){e.attr("transform",i+c(r,a));s=l.align(t._xLeftFrac+r/n.w,t._thickFrac,0,1,t.xanchor);u=l.align(t._yBottomFrac-a/n.h,t._lenFrac,0,1,t.yanchor);var o=l.getCursor(s,u,t.xanchor,t.yanchor);h(e,o)},doneFn:function(){h(e);if(s!==undefined&&u!==undefined){var a={};a[t._propPrefix+"x"]=s;a[t._propPrefix+"y"]=u;if(t._traceIndex!==undefined){o.call("_guiRestyle",r,a,t._traceIndex)}else{o.call("_guiRelayout",r,a)}}}})}function C(e,t,r){var a=t._levels;var n=[];var i=[];var o;var s;var l=a.end+a.size/100;var u=a.size;var c=1.001*r[0]-.001*r[1];var f=1.001*r[1]-.001*r[0];for(s=0;s<1e5;s++){o=a.start+s*u;if(u>0?o>=l:o<=l)break;if(o>c&&o<f)n.push(o)}if(t._fillgradient){i=[0]}else if(typeof t._fillcolor==="function"){var h=t._filllevels;if(h){l=h.end+h.size/100;u=h.size;for(s=0;s<1e5;s++){o=h.start+s*u;if(u>0?o>=l:o<=l)break;if(o>r[0]&&o<r[1])i.push(o)}}else{i=n.map((function(e){return e-a.size/2}));i.push(i[i.length-1]+a.size)}}else if(t._fillcolor&&typeof t._fillcolor==="string"){i=[0]}if(a.size<0){n.reverse();i.reverse()}return{line:n,fill:i}}function I(e,t,r){var a=e._fullLayout;var n={type:"linear",range:r,tickmode:t.tickmode,nticks:t.nticks,tick0:t.tick0,dtick:t.dtick,tickvals:t.tickvals,ticktext:t.ticktext,ticks:t.ticks,ticklen:t.ticklen,tickwidth:t.tickwidth,tickcolor:t.tickcolor,showticklabels:t.showticklabels,ticklabelposition:t.ticklabelposition,ticklabeloverflow:t.ticklabeloverflow,tickfont:t.tickfont,tickangle:t.tickangle,tickformat:t.tickformat,exponentformat:t.exponentformat,minexponent:t.minexponent,separatethousands:t.separatethousands,showexponent:t.showexponent,showtickprefix:t.showtickprefix,tickprefix:t.tickprefix,showticksuffix:t.showticksuffix,ticksuffix:t.ticksuffix,title:t.title,showline:true,anchor:"free",side:"right",position:1};var i={type:"linear",_id:"y"+t._id};var o={letter:"y",font:a.font,noHover:true,noTickson:true,noTicklabelmode:true,calendar:a.calendar};function s(e,t){return u.coerce(n,i,b,e,t)}y(n,i,s,o,a);x(n,i,s,o);return i}t.exports={draw:A}},{"../../constants/alignment":755,"../../lib":787,"../../lib/extend":777,"../../lib/setcursor":808,"../../lib/svg_text_utils":813,"../../plots/cartesian/axes":838,"../../plots/cartesian/axis_defaults":840,"../../plots/cartesian/layout_attributes":853,"../../plots/cartesian/position_defaults":856,"../../plots/plots":901,"../../registry":915,"../color":650,"../colorscale/helpers":661,"../dragelement":669,"../drawing":672,"../titles":748,"./constants":652,"@plotly/d3":58,tinycolor2:583}],655:[function(e,t,r){"use strict";var a=e("../../lib");t.exports=function e(t){return a.isPlainObject(t.colorbar)}},{"../../lib":787}],656:[function(e,t,r){"use strict";t.exports={moduleType:"component",name:"colorbar",attributes:e("./attributes"),supplyDefaults:e("./defaults"),draw:e("./draw").draw,hasColorbar:e("./has_colorbar")}},{"./attributes":651,"./defaults":653,"./draw":654,"./has_colorbar":655}],657:[function(e,t,r){"use strict";var a=e("../colorbar/attributes");var n=e("../../lib/regex").counter;var i=e("../../lib/sort_object_keys");var o=e("./scales.js").scales;var s=i(o);function l(e){return"`"+e+"`"}t.exports=function e(t,r){t=t||"";r=r||{};var i=r.cLetter||"c";var s="onlyIfNumerical"in r?r.onlyIfNumerical:Boolean(t);var u="noScale"in r?r.noScale:t==="marker.line";var c="showScaleDflt"in r?r.showScaleDflt:i==="z";var f=typeof r.colorscaleDflt==="string"?o[r.colorscaleDflt]:null;var h=r.editTypeOverride||"";var p=t?t+".":"";var v,d;if("colorAttr"in r){v=r.colorAttr;d=r.colorAttr}else{v={z:"z",c:"color"}[i];d="in "+l(p+v)}var m=s?" Has an effect only if "+d+"is set to a numerical array.":"";var g=i+"auto";var y=i+"min";var x=i+"max";var b=i+"mid";var _=l(p+g);var w=l(p+y);var T=l(p+x);var k=w+" and "+T;var M={};M[y]=M[x]=undefined;var A={};A[g]=false;var S={};if(v==="color"){S.color={valType:"color",arrayOk:true,editType:h||"style"};if(r.anim){S.color.anim=true}}S[g]={valType:"boolean",dflt:true,editType:"calc",impliedEdits:M};S[y]={valType:"number",dflt:null,editType:h||"plot",impliedEdits:A};S[x]={valType:"number",dflt:null,editType:h||"plot",impliedEdits:A};S[b]={valType:"number",dflt:null,editType:"calc",impliedEdits:M};S.colorscale={valType:"colorscale",editType:"calc",dflt:f,impliedEdits:{autocolorscale:false}};S.autocolorscale={valType:"boolean",dflt:r.autoColorDflt===false?false:true,editType:"calc",impliedEdits:{colorscale:undefined}};S.reversescale={valType:"boolean",dflt:false,editType:"plot"};if(!u){S.showscale={valType:"boolean",dflt:c,editType:"calc"};S.colorbar=a}if(!r.noColorAxis){S.coloraxis={valType:"subplotid",regex:n("coloraxis"),dflt:null,editType:"calc"}}return S}},{"../../lib/regex":804,"../../lib/sort_object_keys":810,"../colorbar/attributes":651,"./scales.js":665}],658:[function(e,t,r){"use strict";var a=e("fast-isnumeric");var n=e("../../lib");var i=e("./helpers").extractOpts;t.exports=function e(t,r,o){var s=t._fullLayout;var l=o.vals;var u=o.containerStr;var c=u?n.nestedProperty(r,u).get():r;var f=i(c);var h=f.auto!==false;var p=f.min;var v=f.max;var d=f.mid;var m=function(){return n.aggNums(Math.min,null,l)};var g=function(){return n.aggNums(Math.max,null,l)};if(p===undefined){p=m()}else if(h){if(c._colorAx&&a(p)){p=Math.min(p,m())}else{p=m()}}if(v===undefined){v=g()}else if(h){if(c._colorAx&&a(v)){v=Math.max(v,g())}else{v=g()}}if(h&&d!==undefined){if(v-d>d-p){p=d-(v-d)}else if(v-d<d-p){v=d+(d-p)}}if(p===v){p-=.5;v+=.5}f._sync("min",p);f._sync("max",v);if(f.autocolorscale){var y;if(p*v<0)y=s.colorscale.diverging;else if(p>=0)y=s.colorscale.sequential;else y=s.colorscale.sequentialminus;f._sync("colorscale",y)}}},{"../../lib":787,"./helpers":661,"fast-isnumeric":246}],659:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("./helpers").hasColorscale;var i=e("./helpers").extractOpts;t.exports=function e(t,r){function o(e,t){var r=e["_"+t];if(r!==undefined){e[t]=r}}function s(e,t){var n=t.container?a.nestedProperty(e,t.container).get():e;if(n){if(n.coloraxis){n._colorAx=r[n.coloraxis]}else{var s=i(n);var l=s.auto;if(l||s.min===undefined){o(n,t.min)}if(l||s.max===undefined){o(n,t.max)}if(s.autocolorscale){o(n,"colorscale")}}}}for(var l=0;l<t.length;l++){var u=t[l];var c=u._module.colorbar;if(c){if(Array.isArray(c)){for(var f=0;f<c.length;f++){s(u,c[f])}}else{s(u,c)}}if(n(u,"marker.line")){s(u,{container:"marker.line",min:"cmin",max:"cmax"})}}for(var h in r._colorAxes){s(r[h],{min:"cmin",max:"cmax"})}}},{"../../lib":787,"./helpers":661}],660:[function(e,t,r){"use strict";var a=e("fast-isnumeric");var n=e("../../lib");var i=e("../colorbar/has_colorbar");var o=e("../colorbar/defaults");var s=e("./scales").isValid;var l=e("../../registry").traceIs;function u(e,t){var r=t.slice(0,t.length-1);return t?n.nestedProperty(e,r).get()||{}:e}t.exports=function e(t,r,c,f,h){var p=h.prefix;var v=h.cLetter;var d="_module"in r;var m=u(t,p);var g=u(r,p);var y=u(r._template||{},p)||{};var x=function(){delete t.coloraxis;delete r.coloraxis;return e(t,r,c,f,h)};if(d){var b=c._colorAxes||{};var _=f(p+"coloraxis");if(_){var w=l(r,"contour")&&n.nestedProperty(r,"contours.coloring").get()||"heatmap";var T=b[_];if(T){T[2].push(x);if(T[0]!==w){T[0]=false;n.warn(["Ignoring coloraxis:",_,"setting","as it is linked to incompatible colorscales."].join(" "))}}else{b[_]=[w,r,[x]]}return}}var k=m[v+"min"];var M=m[v+"max"];var A=a(k)&&a(M)&&k<M;var S=f(p+v+"auto",!A);if(S){f(p+v+"mid")}else{f(p+v+"min");f(p+v+"max")}var E=m.colorscale;var L=y.colorscale;var C;if(E!==undefined)C=!s(E);if(L!==undefined)C=!s(L);f(p+"autocolorscale",C);f(p+"colorscale");f(p+"reversescale");if(p!=="marker.line."){var I;if(p&&d)I=i(m);var P=f(p+"showscale",I);if(P){if(p&&y)g._template=y;o(m,g,c)}}}},{"../../lib":787,"../../registry":915,"../colorbar/defaults":653,"../colorbar/has_colorbar":655,"./scales":665,"fast-isnumeric":246}],661:[function(e,t,r){"use strict";var a=e("@plotly/d3");var n=e("tinycolor2");var i=e("fast-isnumeric");var o=e("../../lib");var s=e("../color");var l=e("./scales").isValid;function u(e,t,r){var a=t?o.nestedProperty(e,t).get()||{}:e;var n=a[r||"color"];var s=false;if(o.isArrayOrTypedArray(n)){for(var u=0;u<n.length;u++){if(i(n[u])){s=true;break}}}return o.isPlainObject(a)&&(s||a.showscale===true||i(a.cmin)&&i(a.cmax)||l(a.colorscale)||o.isPlainObject(a.colorbar))}var c=["showscale","autocolorscale","colorscale","reversescale","colorbar"];var f=["min","max","mid","auto"];function h(e){var t=e._colorAx;var r=t?t:e;var a={};var n;var i,o;for(i=0;i<c.length;i++){o=c[i];a[o]=r[o]}if(t){n="c";for(i=0;i<f.length;i++){o=f[i];a[o]=r["c"+o]}}else{var s;for(i=0;i<f.length;i++){o=f[i];s="c"+o;if(s in r){a[o]=r[s];continue}s="z"+o;if(s in r){a[o]=r[s]}}n=s.charAt(0)}a._sync=function(e,t){var a=f.indexOf(e)!==-1?n+e:e;r[a]=r["_"+a]=t};return a}function p(e){var t=h(e);var r=t.min;var a=t.max;var n=t.reversescale?v(t.colorscale):t.colorscale;var i=n.length;var o=new Array(i);var s=new Array(i);for(var l=0;l<i;l++){var u=n[l];o[l]=r+u[0]*(a-r);s[l]=u[1]}return{domain:o,range:s}}function v(e){var t=e.length;var r=new Array(t);for(var a=t-1,n=0;a>=0;a--,n++){var i=e[a];r[n]=[1-i[0],i[1]]}return r}function d(e,t){t=t||{};var r=e.domain;var o=e.range;var l=o.length;var u=new Array(l);for(var c=0;c<l;c++){var f=n(o[c]).toRgb();u[c]=[f.r,f.g,f.b,f.a]}var h=a.scale.linear().domain(r).range(u).clamp(true);var p=t.noNumericCheck;var v=t.returnArray;var d;if(p&&v){d=h}else if(p){d=function(e){return g(h(e))}}else if(v){d=function(e){if(i(e))return h(e);else if(n(e).isValid())return e;else return s.defaultLine}}else{d=function(e){if(i(e))return g(h(e));else if(n(e).isValid())return e;else return s.defaultLine}}d.domain=h.domain;d.range=function(){return o};return d}function m(e,t){return d(p(e),t)}function g(e){var t={r:e[0],g:e[1],b:e[2],a:e[3]};return n(t).toRgbString()}t.exports={hasColorscale:u,extractOpts:h,extractScale:p,flipScale:v,makeColorScaleFunc:d,makeColorScaleFuncFromTrace:m}},{"../../lib":787,"../color":650,"./scales":665,"@plotly/d3":58,"fast-isnumeric":246,tinycolor2:583}],662:[function(e,t,r){"use strict";var a=e("./scales");var n=e("./helpers");t.exports={moduleType:"component",name:"colorscale",attributes:e("./attributes"),layoutAttributes:e("./layout_attributes"),supplyLayoutDefaults:e("./layout_defaults"),handleDefaults:e("./defaults"),crossTraceDefaults:e("./cross_trace_defaults"),calc:e("./calc"),scales:a.scales,defaultScale:a.defaultScale,getScale:a.get,isValidScale:a.isValid,hasColorscale:n.hasColorscale,extractOpts:n.extractOpts,extractScale:n.extractScale,flipScale:n.flipScale,makeColorScaleFunc:n.makeColorScaleFunc,makeColorScaleFuncFromTrace:n.makeColorScaleFuncFromTrace}},{"./attributes":657,"./calc":658,"./cross_trace_defaults":659,"./defaults":660,"./helpers":661,"./layout_attributes":663,"./layout_defaults":664,"./scales":665}],663:[function(e,t,r){"use strict";var a=e("../../lib/extend").extendFlat;var n=e("./attributes");var i=e("./scales").scales;var o="Note that `autocolorscale` must be true for this attribute to work.";t.exports={editType:"calc",colorscale:{editType:"calc",sequential:{valType:"colorscale",dflt:i.Reds,editType:"calc"},sequentialminus:{valType:"colorscale",dflt:i.Blues,editType:"calc"},diverging:{valType:"colorscale",dflt:i.RdBu,editType:"calc"}},coloraxis:a({_isSubplotObj:true,editType:"calc"},n("",{colorAttr:"corresponding trace color array(s)",noColorAxis:true,showScaleDflt:true}))}},{"../../lib/extend":777,"./attributes":657,"./scales":665}],664:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("../../plot_api/plot_template");var i=e("./layout_attributes");var o=e("./defaults");t.exports=function e(t,r){function s(e,n){return a.coerce(t,r,i,e,n)}s("colorscale.sequential");s("colorscale.sequentialminus");s("colorscale.diverging");var l=r._colorAxes;var u,c;function f(e,t){return a.coerce(u,c,i.coloraxis,e,t)}for(var h in l){var p=l[h];if(p[0]){u=t[h]||{};c=n.newContainer(r,h,"coloraxis");c._name=h;o(u,c,r,f,{prefix:"",cLetter:"c"})}else{for(var v=0;v<p[2].length;v++){p[2][v]()}delete r._colorAxes[h]}}}},{"../../lib":787,"../../plot_api/plot_template":827,"./defaults":660,"./layout_attributes":663}],665:[function(e,t,r){"use strict";var a=e("tinycolor2");var n={Greys:[[0,"rgb(0,0,0)"],[1,"rgb(255,255,255)"]],YlGnBu:[[0,"rgb(8,29,88)"],[.125,"rgb(37,52,148)"],[.25,"rgb(34,94,168)"],[.375,"rgb(29,145,192)"],[.5,"rgb(65,182,196)"],[.625,"rgb(127,205,187)"],[.75,"rgb(199,233,180)"],[.875,"rgb(237,248,217)"],[1,"rgb(255,255,217)"]],Greens:[[0,"rgb(0,68,27)"],[.125,"rgb(0,109,44)"],[.25,"rgb(35,139,69)"],[.375,"rgb(65,171,93)"],[.5,"rgb(116,196,118)"],[.625,"rgb(161,217,155)"],[.75,"rgb(199,233,192)"],[.875,"rgb(229,245,224)"],[1,"rgb(247,252,245)"]],YlOrRd:[[0,"rgb(128,0,38)"],[.125,"rgb(189,0,38)"],[.25,"rgb(227,26,28)"],[.375,"rgb(252,78,42)"],[.5,"rgb(253,141,60)"],[.625,"rgb(254,178,76)"],[.75,"rgb(254,217,118)"],[.875,"rgb(255,237,160)"],[1,"rgb(255,255,204)"]],Bluered:[[0,"rgb(0,0,255)"],[1,"rgb(255,0,0)"]],RdBu:[[0,"rgb(5,10,172)"],[.35,"rgb(106,137,247)"],[.5,"rgb(190,190,190)"],[.6,"rgb(220,170,132)"],[.7,"rgb(230,145,90)"],[1,"rgb(178,10,28)"]],Reds:[[0,"rgb(220,220,220)"],[.2,"rgb(245,195,157)"],[.4,"rgb(245,160,105)"],[1,"rgb(178,10,28)"]],Blues:[[0,"rgb(5,10,172)"],[.35,"rgb(40,60,190)"],[.5,"rgb(70,100,245)"],[.6,"rgb(90,120,245)"],[.7,"rgb(106,137,247)"],[1,"rgb(220,220,220)"]],Picnic:[[0,"rgb(0,0,255)"],[.1,"rgb(51,153,255)"],[.2,"rgb(102,204,255)"],[.3,"rgb(153,204,255)"],[.4,"rgb(204,204,255)"],[.5,"rgb(255,255,255)"],[.6,"rgb(255,204,255)"],[.7,"rgb(255,153,255)"],[.8,"rgb(255,102,204)"],[.9,"rgb(255,102,102)"],[1,"rgb(255,0,0)"]],Rainbow:[[0,"rgb(150,0,90)"],[.125,"rgb(0,0,200)"],[.25,"rgb(0,25,255)"],[.375,"rgb(0,152,255)"],[.5,"rgb(44,255,150)"],[.625,"rgb(151,255,0)"],[.75,"rgb(255,234,0)"],[.875,"rgb(255,111,0)"],[1,"rgb(255,0,0)"]],Portland:[[0,"rgb(12,51,131)"],[.25,"rgb(10,136,186)"],[.5,"rgb(242,211,56)"],[.75,"rgb(242,143,56)"],[1,"rgb(217,30,30)"]],Jet:[[0,"rgb(0,0,131)"],[.125,"rgb(0,60,170)"],[.375,"rgb(5,255,255)"],[.625,"rgb(255,255,0)"],[.875,"rgb(250,0,0)"],[1,"rgb(128,0,0)"]],Hot:[[0,"rgb(0,0,0)"],[.3,"rgb(230,0,0)"],[.6,"rgb(255,210,0)"],[1,"rgb(255,255,255)"]],Blackbody:[[0,"rgb(0,0,0)"],[.2,"rgb(230,0,0)"],[.4,"rgb(230,210,0)"],[.7,"rgb(255,255,255)"],[1,"rgb(160,200,255)"]],Earth:[[0,"rgb(0,0,130)"],[.1,"rgb(0,180,180)"],[.2,"rgb(40,210,40)"],[.4,"rgb(230,230,50)"],[.6,"rgb(120,70,20)"],[1,"rgb(255,255,255)"]],Electric:[[0,"rgb(0,0,0)"],[.15,"rgb(30,0,100)"],[.4,"rgb(120,0,100)"],[.6,"rgb(160,90,0)"],[.8,"rgb(230,200,0)"],[1,"rgb(255,250,220)"]],Viridis:[[0,"#440154"],[.06274509803921569,"#48186a"],[.12549019607843137,"#472d7b"],[.18823529411764706,"#424086"],[.25098039215686274,"#3b528b"],[.3137254901960784,"#33638d"],[.3764705882352941,"#2c728e"],[.4392156862745098,"#26828e"],[.5019607843137255,"#21918c"],[.5647058823529412,"#1fa088"],[.6274509803921569,"#28ae80"],[.6901960784313725,"#3fbc73"],[.7529411764705882,"#5ec962"],[.8156862745098039,"#84d44b"],[.8784313725490196,"#addc30"],[.9411764705882353,"#d8e219"],[1,"#fde725"]],Cividis:[[0,"rgb(0,32,76)"],[.058824,"rgb(0,42,102)"],[.117647,"rgb(0,52,110)"],[.176471,"rgb(39,63,108)"],[.235294,"rgb(60,74,107)"],[.294118,"rgb(76,85,107)"],[.352941,"rgb(91,95,109)"],[.411765,"rgb(104,106,112)"],[.470588,"rgb(117,117,117)"],[.529412,"rgb(131,129,120)"],[.588235,"rgb(146,140,120)"],[.647059,"rgb(161,152,118)"],[.705882,"rgb(176,165,114)"],[.764706,"rgb(192,177,109)"],[.823529,"rgb(209,191,102)"],[.882353,"rgb(225,204,92)"],[.941176,"rgb(243,219,79)"],[1,"rgb(255,233,69)"]]};var i=n.RdBu;function o(e,t){if(!t)t=i;if(!e)return t;function r(){try{e=n[e]||JSON.parse(e)}catch(r){e=t}}if(typeof e==="string"){r();if(typeof e==="string")r()}if(!s(e))return t;return e}function s(e){var t=0;if(!Array.isArray(e)||e.length<2)return false;if(!e[0]||!e[e.length-1])return false;if(+e[0][0]!==0||+e[e.length-1][0]!==1)return false;for(var r=0;r<e.length;r++){var n=e[r];if(n.length!==2||+n[0]<t||!a(n[1]).isValid()){return false}t=+n[0]}return true}function l(e){if(n[e]!==undefined)return true;else return s(e)}t.exports={scales:n,defaultScale:i,get:o,isValid:l}},{tinycolor2:583}],666:[function(e,t,r){"use strict";t.exports=function e(t,r,a,n,i){var o=(t-a)/(n-a);var s=o+r/(n-a);var l=(o+s)/2;if(i==="left"||i==="bottom")return o;if(i==="center"||i==="middle")return l;if(i==="right"||i==="top")return s;if(o<2/3-l)return o;if(s>4/3-l)return s;return l}},{}],667:[function(e,t,r){"use strict";var a=e("../../lib");var n=[["sw-resize","s-resize","se-resize"],["w-resize","move","e-resize"],["nw-resize","n-resize","ne-resize"]];t.exports=function e(t,r,i,o){if(i==="left")t=0;else if(i==="center")t=1;else if(i==="right")t=2;else t=a.constrain(Math.floor(t*3),0,2);if(o==="bottom")r=0;else if(o==="middle")r=1;else if(o==="top")r=2;else r=a.constrain(Math.floor(r*3),0,2);return n[r][t]}},{"../../lib":787}],668:[function(e,t,r){"use strict";r.selectMode=function(e){return e==="lasso"||e==="select"};r.drawMode=function(e){return e==="drawclosedpath"||e==="drawopenpath"||e==="drawline"||e==="drawrect"||e==="drawcircle"};r.openMode=function(e){return e==="drawline"||e==="drawopenpath"};r.rectMode=function(e){return e==="select"||e==="drawline"||e==="drawrect"||e==="drawcircle"};r.freeMode=function(e){return e==="lasso"||e==="drawclosedpath"||e==="drawopenpath"};r.selectingOrDrawing=function(e){return r.freeMode(e)||r.rectMode(e)}},{}],669:[function(e,t,r){"use strict";var a=e("mouse-event-offset");var n=e("has-hover");var i=e("has-passive-events");var o=e("../../lib").removeElement;var s=e("../../plots/cartesian/constants");var l=t.exports={};l.align=e("./align");l.getCursor=e("./cursor");var u=e("./unhover");l.unhover=u.wrapped;l.unhoverRaw=u.raw;l.init=function e(t){var r=t.gd;var a=1;var u=r._context.doubleClickDelay;var h=t.element;var p,v,d,m,g,y,x,b;if(!r._mouseDownTime)r._mouseDownTime=0;h.style.pointerEvents="all";h.onmousedown=T;if(!i){h.ontouchstart=T}else{if(h._ontouchstart){h.removeEventListener("touchstart",h._ontouchstart)}h._ontouchstart=T;h.addEventListener("touchstart",T,{passive:false})}function _(e,t,r){if(Math.abs(e)<r)e=0;if(Math.abs(t)<r)t=0;return[e,t]}var w=t.clampFn||_;function T(e){r._dragged=false;r._dragging=true;var i=f(e);p=i[0];v=i[1];x=e.target;y=e;b=e.buttons===2||e.ctrlKey;if(typeof e.clientX==="undefined"&&typeof e.clientY==="undefined"){e.clientX=p;e.clientY=v}d=(new Date).getTime();if(d-r._mouseDownTime<u){a+=1}else{a=1;r._mouseDownTime=d}if(t.prepFn)t.prepFn(e,p,v);if(n&&!b){g=c();g.style.cursor=window.getComputedStyle(h).cursor}else if(!n){g=document;m=window.getComputedStyle(document.documentElement).cursor;document.documentElement.style.cursor=window.getComputedStyle(h).cursor}document.addEventListener("mouseup",M);document.addEventListener("touchend",M);if(t.dragmode!==false){e.preventDefault();document.addEventListener("mousemove",k);document.addEventListener("touchmove",k,{passive:false})}return}function k(e){e.preventDefault();var a=f(e);var n=t.minDrag||s.MINDRAG;var i=w(a[0]-p,a[1]-v,n);var o=i[0];var u=i[1];if(o||u){r._dragged=true;l.unhover(r,e)}if(r._dragged&&t.moveFn&&!b){r._dragdata={element:h,dx:o,dy:u};t.moveFn(o,u)}return}function M(e){delete r._dragdata;if(t.dragmode!==false){e.preventDefault();document.removeEventListener("mousemove",k);document.removeEventListener("touchmove",k)}document.removeEventListener("mouseup",M);document.removeEventListener("touchend",M);if(n){o(g)}else if(m){g.documentElement.style.cursor=m;m=null}if(!r._dragging){r._dragged=false;return}r._dragging=false;if((new Date).getTime()-r._mouseDownTime>u){a=Math.max(a-1,1)}if(r._dragged){if(t.doneFn)t.doneFn()}else{if(t.clickFn)t.clickFn(a,y);if(!b){var i;try{i=new MouseEvent("click",e)}catch(l){var s=f(e);i=document.createEvent("MouseEvents");i.initMouseEvent("click",e.bubbles,e.cancelable,e.view,e.detail,e.screenX,e.screenY,s[0],s[1],e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,e.button,e.relatedTarget)}x.dispatchEvent(i)}}r._dragging=false;r._dragged=false;return}};function c(){var e=document.createElement("div");e.className="dragcover";var t=e.style;t.position="fixed";t.left=0;t.right=0;t.top=0;t.bottom=0;t.zIndex=999999999;t.background="none";document.body.appendChild(e);return e}l.coverSlip=c;function f(e){return a(e.changedTouches?e.changedTouches[0]:e,document.body)}},{"../../lib":787,"../../plots/cartesian/constants":845,"./align":666,"./cursor":667,"./unhover":670,"has-hover":435,"has-passive-events":436,"mouse-event-offset":460}],670:[function(e,t,r){"use strict";var a=e("../../lib/events");var n=e("../../lib/throttle");var i=e("../../lib/dom").getGraphDiv;var o=e("../fx/constants");var s=t.exports={};s.wrapped=function(e,t,r){e=i(e);if(e._fullLayout){n.clear(e._fullLayout._uid+o.HOVERID)}s.raw(e,t,r)};s.raw=function e(t,r){var n=t._fullLayout;var i=t._hoverdata;if(!r)r={};if(r.target&&!t._dragged&&a.triggerHandler(t,"plotly_beforehover",r)===false){return}n._hoverlayer.selectAll("g").remove();n._hoverlayer.selectAll("line").remove();n._hoverlayer.selectAll("circle").remove();t._hoverdata=undefined;if(r.target&&i){t.emit("plotly_unhover",{event:r,points:i})}}},{"../../lib/dom":775,"../../lib/events":776,"../../lib/throttle":814,"../fx/constants":684}],671:[function(e,t,r){"use strict";r.dash={valType:"string",values:["solid","dot","dash","longdash","dashdot","longdashdot"],dflt:"solid",editType:"style"};r.pattern={shape:{valType:"enumerated",values:["","/","\\","x","-","|","+","."],dflt:"",arrayOk:true,editType:"style"},fillmode:{valType:"enumerated",values:["replace","overlay"],dflt:"replace",editType:"style"},bgcolor:{valType:"color",arrayOk:true,editType:"style"},fgcolor:{valType:"color",arrayOk:true,editType:"style"},fgopacity:{valType:"number",editType:"style",min:0,max:1},size:{valType:"number",min:0,dflt:8,arrayOk:true,editType:"style"},solidity:{valType:"number",min:0,max:1,dflt:.3,arrayOk:true,editType:"style"},editType:"style"}},{}],672:[function(e,t,r){"use strict";var a=e("@plotly/d3");var n=e("../../lib");var i=n.numberFormat;var o=e("fast-isnumeric");var s=e("tinycolor2");var l=e("../../registry");var u=e("../color");var c=e("../colorscale");var f=n.strTranslate;var h=e("../../lib/svg_text_utils");var p=e("../../constants/xmlns_namespaces");var v=e("../../constants/alignment");var d=v.LINE_SPACING;var m=e("../../constants/interactions").DESELECTDIM;var g=e("../../traces/scatter/subtypes");var y=e("../../traces/scatter/make_bubble_size_func");var x=e("../../components/fx/helpers").appendArrayPointValue;var b=t.exports={};b.font=function(e,t,r,a){if(n.isPlainObject(t)){a=t.color;r=t.size;t=t.family}if(t)e.style("font-family",t);if(r+1)e.style("font-size",r+"px");if(a)e.call(u.fill,a)};b.setPosition=function(e,t,r){e.attr("x",t).attr("y",r)};b.setSize=function(e,t,r){e.attr("width",t).attr("height",r)};b.setRect=function(e,t,r,a,n){e.call(b.setPosition,t,r).call(b.setSize,a,n)};b.translatePoint=function(e,t,r,a){var n=r.c2p(e.x);var i=a.c2p(e.y);if(o(n)&&o(i)&&t.node()){if(t.node().nodeName==="text"){t.attr("x",n).attr("y",i)}else{t.attr("transform",f(n,i))}}else{return false}return true};b.translatePoints=function(e,t,r){e.each((function(e){var n=a.select(this);b.translatePoint(e,n,t,r)}))};b.hideOutsideRangePoint=function(e,t,r,a,n,i){t.attr("display",r.isPtWithinRange(e,n)&&a.isPtWithinRange(e,i)?null:"none")};b.hideOutsideRangePoints=function(e,t){if(!t._hasClipOnAxisFalse)return;var r=t.xaxis;var n=t.yaxis;e.each((function(t){var i=t[0].trace;var o=i.xcalendar;var s=i.ycalendar;var u=l.traceIs(i,"bar-like")?".bartext":".point,.textpoint";e.selectAll(u).each((function(e){b.hideOutsideRangePoint(e,a.select(this),r,n,o,s)}))}))};b.crispRound=function(e,t,r){if(!t||!o(t))return r||0;if(e._context.staticPlot)return t;if(t<1)return 1;return Math.round(t)};b.singleLineStyle=function(e,t,r,a,n){t.style("fill","none");var i=(((e||[])[0]||{}).trace||{}).line||{};var o=r||i.width||0;var s=n||i.dash||"";u.stroke(t,a||i.color);b.dashLine(t,s,o)};b.lineGroupStyle=function(e,t,r,n){e.style("fill","none").each((function(e){var i=(((e||[])[0]||{}).trace||{}).line||{};var o=t||i.width||0;var s=n||i.dash||"";a.select(this).call(u.stroke,r||i.color).call(b.dashLine,s,o)}))};b.dashLine=function(e,t,r){r=+r||0;t=b.dashStyle(t,r);e.style({"stroke-dasharray":t,"stroke-width":r+"px"})};b.dashStyle=function(e,t){t=+t||1;var r=Math.max(t,3);if(e==="solid")e="";else if(e==="dot")e=r+"px,"+r+"px";else if(e==="dash")e=3*r+"px,"+3*r+"px";else if(e==="longdash")e=5*r+"px,"+5*r+"px";else if(e==="dashdot"){e=3*r+"px,"+r+"px,"+r+"px,"+r+"px"}else if(e==="longdashdot"){e=5*r+"px,"+2*r+"px,"+r+"px,"+2*r+"px"}return e};b.singleFillStyle=function(e){var t=a.select(e.node());var r=t.data();var n=(((r[0]||[])[0]||{}).trace||{}).fillcolor;if(n){e.call(u.fill,n)}};b.fillGroupStyle=function(e){e.style("stroke-width",0).each((function(e){var t=a.select(this);if(e[0].trace){t.call(u.fill,e[0].trace.fillcolor)}}))};var _=e("./symbol_defs");b.symbolNames=[];b.symbolFuncs=[];b.symbolNeedLines={};b.symbolNoDot={};b.symbolNoFill={};b.symbolList=[];Object.keys(_).forEach((function(e){var t=_[e];var r=t.n;b.symbolList.push(r,String(r),e,r+100,String(r+100),e+"-open");b.symbolNames[r]=e;b.symbolFuncs[r]=t.f;if(t.needLine){b.symbolNeedLines[r]=true}if(t.noDot){b.symbolNoDot[r]=true}else{b.symbolList.push(r+200,String(r+200),e+"-dot",r+300,String(r+300),e+"-open-dot")}if(t.noFill){b.symbolNoFill[r]=true}}));var w=b.symbolNames.length;var T="M0,0.5L0.5,0L0,-0.5L-0.5,0Z";b.symbolNumber=function(e){if(o(e)){e=+e}else if(typeof e==="string"){var t=0;if(e.indexOf("-open")>0){t=100;e=e.replace("-open","")}if(e.indexOf("-dot")>0){t+=200;e=e.replace("-dot","")}e=b.symbolNames.indexOf(e);if(e>=0){e+=t}}return e%100>=w||e>=400?0:Math.floor(Math.max(e,0))};function k(e,t){var r=e%100;return b.symbolFuncs[r](t)+(e>=200?T:"")}var M={x1:1,x2:0,y1:0,y2:0};var A={x1:0,x2:0,y1:1,y2:0};var S=i("~f");var E={radial:{node:"radialGradient"},radialreversed:{node:"radialGradient",reversed:true},horizontal:{node:"linearGradient",attrs:M},horizontalreversed:{node:"linearGradient",attrs:M,reversed:true},vertical:{node:"linearGradient",attrs:A},verticalreversed:{node:"linearGradient",attrs:A,reversed:true}};b.gradient=function(e,t,r,i,o,l){var c=o.length;var f=E[i];var h=new Array(c);for(var p=0;p<c;p++){if(f.reversed){h[c-1-p]=[S((1-o[p][0])*100),o[p][1]]}else{h[p]=[S(o[p][0]*100),o[p][1]]}}var v=t._fullLayout;var d="g"+v._uid+"-"+r;var m=v._defs.select(".gradients").selectAll("#"+d).data([i+h.join(";")],n.identity);m.exit().remove();m.enter().append(f.node).each((function(){var e=a.select(this);if(f.attrs)e.attr(f.attrs);e.attr("id",d);var t=e.selectAll("stop").data(h);t.exit().remove();t.enter().append("stop");t.each((function(e){var t=s(e[1]);a.select(this).attr({offset:e[0]+"%","stop-color":u.tinyRGB(t),"stop-opacity":t.getAlpha()})}))}));e.style(l,N(d,t)).style(l+"-opacity",null);var g=function(e){return"."+e.attr("class").replace(/\s/g,".")};var y=g(a.select(e.node().parentNode))+">"+g(e);v._gradientUrlQueryParts[y]=1};b.pattern=function(e,t,r,i,o,s,l,c,f,h,p,v){var d=t==="legend";if(c){if(f==="overlay"){h=c;p=u.contrast(h)}else{h=undefined;p=c}}var m=r._fullLayout;var g="p"+m._uid+"-"+i;var y,x;var b=function(e,t,r,a,n){return a+(n-a)*(e-t)/(r-t)};var _,w,T;var k;var M={};switch(o){case"/":y=s*Math.sqrt(2);x=s*Math.sqrt(2);_="M-"+y/4+","+x/4+"l"+y/2+",-"+x/2+"M0,"+x+"L"+y+",0"+"M"+y/4*3+","+x/4*5+"l"+y/2+",-"+x/2;w=l*s;k="path";M={d:_,opacity:v,stroke:p,"stroke-width":w+"px"};break;case"\\":y=s*Math.sqrt(2);x=s*Math.sqrt(2);_="M"+y/4*3+",-"+x/4+"l"+y/2+","+x/2+"M0,0L"+y+","+x+"M-"+y/4+","+x/4*3+"l"+y/2+","+x/2;w=l*s;k="path";M={d:_,opacity:v,stroke:p,"stroke-width":w+"px"};break;case"x":y=s*Math.sqrt(2);x=s*Math.sqrt(2);_="M-"+y/4+","+x/4+"l"+y/2+",-"+x/2+"M0,"+x+"L"+y+",0"+"M"+y/4*3+","+x/4*5+"l"+y/2+",-"+x/2+"M"+y/4*3+",-"+x/4+"l"+y/2+","+x/2+"M0,0L"+y+","+x+"M-"+y/4+","+x/4*3+"l"+y/2+","+x/2;w=s-s*Math.sqrt(1-l);k="path";M={d:_,opacity:v,stroke:p,"stroke-width":w+"px"};break;case"|":y=s;x=s;k="path";_="M"+y/2+",0L"+y/2+","+x;w=l*s;k="path";M={d:_,opacity:v,stroke:p,"stroke-width":w+"px"};break;case"-":y=s;x=s;k="path";_="M0,"+x/2+"L"+y+","+x/2;w=l*s;k="path";M={d:_,opacity:v,stroke:p,"stroke-width":w+"px"};break;case"+":y=s;x=s;k="path";_="M"+y/2+",0L"+y/2+","+x+"M0,"+x/2+"L"+y+","+x/2;w=s-s*Math.sqrt(1-l);k="path";M={d:_,opacity:v,stroke:p,"stroke-width":w+"px"};break;case".":y=s;x=s;if(l<Math.PI/4){T=Math.sqrt(l*s*s/Math.PI)}else{T=b(l,Math.PI/4,1,s/2,s/Math.sqrt(2))}k="circle";M={cx:y/2,cy:x/2,r:T,opacity:v,fill:p};break}var A=[o||"noSh",h||"noBg",p||"noFg",s,l].join(";");var S=m._defs.select(".patterns").selectAll("#"+g).data([A],n.identity);S.exit().remove();S.enter().append("pattern").each((function(){var e=a.select(this);e.attr({id:g,width:y+"px",height:x+"px",patternUnits:"userSpaceOnUse",patternTransform:d?"scale(0.8)":""});if(h){var t=e.selectAll("rect").data([0]);t.exit().remove();t.enter().append("rect").attr({width:y+"px",height:x+"px",fill:h})}var r=e.selectAll(k).data([0]);r.exit().remove();r.enter().append(k).attr(M)}));e.style("fill",N(g,r)).style("fill-opacity",null);e.classed("pattern_filled",true);var E=function(e){return"."+e.attr("class").replace(/\s/g,".")};var L=E(a.select(e.node().parentNode))+">.pattern_filled";m._patternUrlQueryParts[L]=1};b.initGradients=function(e){var t=e._fullLayout;var r=n.ensureSingle(t._defs,"g","gradients");r.selectAll("linearGradient,radialGradient").remove();t._gradientUrlQueryParts={}};b.initPatterns=function(e){var t=e._fullLayout;var r=n.ensureSingle(t._defs,"g","patterns");r.selectAll("pattern").remove();t._patternUrlQueryParts={}};b.getPatternAttr=function(e,t,r){if(e&&n.isArrayOrTypedArray(e)){return t<e.length?e[t]:r}return e};b.pointStyle=function(e,t,r){if(!e.size())return;var n=b.makePointStyleFns(t);e.each((function(e){b.singlePointStyle(e,a.select(this),t,n,r)}))};b.singlePointStyle=function(e,t,r,a,i){var o=r.marker;var s=o.line;t.style("opacity",a.selectedOpacityFn?a.selectedOpacityFn(e):e.mo===undefined?o.opacity:e.mo);if(a.ms2mrc){var l;if(e.ms==="various"||o.size==="various"){l=3}else{l=a.ms2mrc(e.ms)}e.mrc=l;if(a.selectedSizeFn){l=e.mrc=a.selectedSizeFn(e)}var c=b.symbolNumber(e.mx||o.symbol)||0;e.om=c%200>=100;t.attr("d",k(c,l))}var f=false;var h,p,v;if(e.so){v=s.outlierwidth;p=s.outliercolor;h=o.outliercolor}else{var d=(s||{}).width;v=(e.mlw+1||d+1||(e.trace?(e.trace.marker.line||{}).width:0)+1)-1||0;if("mlc"in e)p=e.mlcc=a.lineScale(e.mlc);else if(n.isArrayOrTypedArray(s.color))p=u.defaultLine;else p=s.color;if(n.isArrayOrTypedArray(o.color)){h=u.defaultLine;f=true}if("mc"in e){h=e.mcc=a.markerScale(e.mc)}else{h=o.color||"rgba(0,0,0,0)"}if(a.selectedColorFn){h=a.selectedColorFn(e)}}if(e.om){t.call(u.stroke,h).style({"stroke-width":(v||1)+"px",fill:"none"})}else{t.style("stroke-width",(e.isBlank?0:v)+"px");var m=o.gradient;var g=e.mgt;if(g)f=true;else g=m&&m.type;if(n.isArrayOrTypedArray(g)){g=g[0];if(!E[g])g=0}var y=o.pattern;var x=y&&b.getPatternAttr(y.shape,e.i,"");if(g&&g!=="none"){var _=e.mgc;if(_)f=true;else _=m.color;var w=r.uid;if(f)w+="-"+e.i;b.gradient(t,i,w,g,[[0,_],[1,h]],"fill")}else if(x){var T=b.getPatternAttr(y.bgcolor,e.i,null);var M=b.getPatternAttr(y.fgcolor,e.i,null);var A=y.fgopacity;var S=b.getPatternAttr(y.size,e.i,8);var L=b.getPatternAttr(y.solidity,e.i,.3);var C=e.mcc||n.isArrayOrTypedArray(y.shape)||n.isArrayOrTypedArray(y.bgcolor)||n.isArrayOrTypedArray(y.size)||n.isArrayOrTypedArray(y.solidity);var I=r.uid;if(C)I+="-"+e.i;b.pattern(t,"point",i,I,x,S,L,e.mcc,y.fillmode,T,M,A)}else{u.fill(t,h)}if(v){u.stroke(t,p)}}};b.makePointStyleFns=function(e){var t={};var r=e.marker;t.markerScale=b.tryColorscale(r,"");t.lineScale=b.tryColorscale(r,"line");if(l.traceIs(e,"symbols")){t.ms2mrc=g.isBubble(e)?y(e):function(){return(r.size||6)/2}}if(e.selectedpoints){n.extendFlat(t,b.makeSelectedPointStyleFns(e))}return t};b.makeSelectedPointStyleFns=function(e){var t={};var r=e.selected||{};var a=e.unselected||{};var i=e.marker||{};var o=r.marker||{};var s=a.marker||{};var u=i.opacity;var c=o.opacity;var f=s.opacity;var h=c!==undefined;var p=f!==undefined;if(n.isArrayOrTypedArray(u)||h||p){t.selectedOpacityFn=function(e){var t=e.mo===undefined?i.opacity:e.mo;if(e.selected){return h?c:t}else{return p?f:m*t}}}var v=i.color;var d=o.color;var g=s.color;if(d||g){t.selectedColorFn=function(e){var t=e.mcc||v;if(e.selected){return d||t}else{return g||t}}}var y=i.size;var x=o.size;var b=s.size;var _=x!==undefined;var w=b!==undefined;if(l.traceIs(e,"symbols")&&(_||w)){t.selectedSizeFn=function(e){var t=e.mrc||y/2;if(e.selected){return _?x/2:t}else{return w?b/2:t}}}return t};b.makeSelectedTextStyleFns=function(e){var t={};var r=e.selected||{};var a=e.unselected||{};var n=e.textfont||{};var i=r.textfont||{};var o=a.textfont||{};var s=n.color;var l=i.color;var c=o.color;t.selectedTextColorFn=function(e){var t=e.tc||s;if(e.selected){return l||t}else{if(c)return c;else return l?t:u.addOpacity(t,m)}};return t};b.selectedPointStyle=function(e,t){if(!e.size()||!t.selectedpoints)return;var r=b.makeSelectedPointStyleFns(t);var n=t.marker||{};var i=[];if(r.selectedOpacityFn){i.push((function(e,t){e.style("opacity",r.selectedOpacityFn(t))}))}if(r.selectedColorFn){i.push((function(e,t){u.fill(e,r.selectedColorFn(t))}))}if(r.selectedSizeFn){i.push((function(e,t){var a=t.mx||n.symbol||0;var i=r.selectedSizeFn(t);e.attr("d",k(b.symbolNumber(a),i));t.mrc2=i}))}if(i.length){e.each((function(e){var t=a.select(this);for(var r=0;r<i.length;r++){i[r](t,e)}}))}};b.tryColorscale=function(e,t){var r=t?n.nestedProperty(e,t).get():e;if(r){var a=r.color;if((r.colorscale||r._colorAx)&&n.isArrayOrTypedArray(a)){return c.makeColorScaleFuncFromTrace(r)}}return n.identity};var L={start:1,end:-1,middle:0,bottom:1,top:-1};function C(e,t,r,n){var i=a.select(e.node().parentNode);var o=t.indexOf("top")!==-1?"top":t.indexOf("bottom")!==-1?"bottom":"middle";var s=t.indexOf("left")!==-1?"end":t.indexOf("right")!==-1?"start":"middle";var l=n?n/.8+1:0;var u=(h.lineCount(e)-1)*d+1;var c=L[s]*l;var p=r*.75+L[o]*l+(L[o]-1)*u*r/2;e.attr("text-anchor",s);i.attr("transform",f(c,p))}function I(e,t){var r=e.ts||t.textfont.size;return o(r)&&r>0?r:0}b.textPointStyle=function(e,t,r){if(!e.size())return;var i;if(t.selectedpoints){var o=b.makeSelectedTextStyleFns(t);i=o.selectedTextColorFn}var s=t.texttemplate;var l=r._fullLayout;e.each((function(e){var o=a.select(this);var u=s?n.extractOption(e,t,"txt","texttemplate"):n.extractOption(e,t,"tx","text");if(!u&&u!==0){o.remove();return}if(s){var c=t._module.formatLabels;var f=c?c(e,t,l):{};var p={};x(p,t,e.i);var v=t._meta||{};u=n.texttemplateString(u,f,l._d3locale,p,e,v)}var d=e.tp||t.textposition;var m=I(e,t);var g=i?i(e):e.tc||t.textfont.color;o.call(b.font,e.tf||t.textfont.family,m,g).text(u).call(h.convertToTspans,r).call(C,d,m,e.mrc)}))};b.selectedTextStyle=function(e,t){if(!e.size()||!t.selectedpoints)return;var r=b.makeSelectedTextStyleFns(t);e.each((function(e){var n=a.select(this);var i=r.selectedTextColorFn(e);var o=e.tp||t.textposition;var s=I(e,t);u.fill(n,i);C(n,o,s,e.mrc2||e.mrc)}))};var P=.5;b.smoothopen=function(e,t){if(e.length<3){return"M"+e.join("L")}var r="M"+e[0];var a=[];var n;for(n=1;n<e.length-1;n++){a.push(O(e[n-1],e[n],e[n+1],t))}r+="Q"+a[0][0]+" "+e[1];for(n=2;n<e.length-1;n++){r+="C"+a[n-2][1]+" "+a[n-1][0]+" "+e[n]}r+="Q"+a[e.length-3][1]+" "+e[e.length-1];return r};b.smoothclosed=function(e,t){if(e.length<3){return"M"+e.join("L")+"Z"}var r="M"+e[0];var a=e.length-1;var n=[O(e[a],e[0],e[1],t)];var i;for(i=1;i<a;i++){n.push(O(e[i-1],e[i],e[i+1],t))}n.push(O(e[a-1],e[a],e[0],t));for(i=1;i<=a;i++){r+="C"+n[i-1][1]+" "+n[i][0]+" "+e[i]}r+="C"+n[a][1]+" "+n[0][0]+" "+e[0]+"Z";return r};function O(e,t,r,n){var i=e[0]-t[0];var o=e[1]-t[1];var s=r[0]-t[0];var l=r[1]-t[1];var u=Math.pow(i*i+o*o,P/2);var c=Math.pow(s*s+l*l,P/2);var f=(c*c*i-u*u*s)*n;var h=(c*c*o-u*u*l)*n;var p=3*c*(u+c);var v=3*u*(u+c);return[[a.round(t[0]+(p&&f/p),2),a.round(t[1]+(p&&h/p),2)],[a.round(t[0]-(v&&f/v),2),a.round(t[1]-(v&&h/v),2)]]}var z={hv:function(e,t){return"H"+a.round(t[0],2)+"V"+a.round(t[1],2)},vh:function(e,t){return"V"+a.round(t[1],2)+"H"+a.round(t[0],2)},hvh:function(e,t){return"H"+a.round((e[0]+t[0])/2,2)+"V"+a.round(t[1],2)+"H"+a.round(t[0],2)},vhv:function(e,t){return"V"+a.round((e[1]+t[1])/2,2)+"H"+a.round(t[0],2)+"V"+a.round(t[1],2)}};var D=function(e,t){return"L"+a.round(t[0],2)+","+a.round(t[1],2)};b.steps=function(e){var t=z[e]||D;return function(e){var r="M"+a.round(e[0][0],2)+","+a.round(e[0][1],2);for(var n=1;n<e.length;n++){r+=t(e[n-1],e[n])}return r}};b.makeTester=function(){var e=n.ensureSingleById(a.select("body"),"svg","js-plotly-tester",(function(e){e.attr(p.svgAttrs).style({position:"absolute",left:"-10000px",top:"-10000px",width:"9000px",height:"9000px","z-index":"1"})}));var t=n.ensureSingle(e,"path","js-reference-point",(function(e){e.attr("d","M0,0H1V1H0Z").style({"stroke-width":0,fill:"black"})}));b.tester=e;b.testref=t};b.savedBBoxes={};var R=0;var F=1e4;b.bBox=function(e,t,r){if(!r)r=B(e);var i;if(r){i=b.savedBBoxes[r];if(i)return n.extendFlat({},i)}else if(e.childNodes.length===1){var o=e.childNodes[0];r=B(o);if(r){var s=+o.getAttribute("x")||0;var l=+o.getAttribute("y")||0;var u=o.getAttribute("transform");if(!u){var c=b.bBox(o,false,r);if(s){c.left+=s;c.right+=s}if(l){c.top+=l;c.bottom+=l}return c}r+="~"+s+"~"+l+"~"+u;i=b.savedBBoxes[r];if(i)return n.extendFlat({},i)}}var f,p;if(t){f=e}else{p=b.tester.node();f=e.cloneNode(true);p.appendChild(f)}a.select(f).attr("transform",null).call(h.positionText,0,0);var v=f.getBoundingClientRect();var d=b.testref.node().getBoundingClientRect();if(!t)p.removeChild(f);var m={height:v.height,width:v.width,left:v.left-d.left,top:v.top-d.top,right:v.right-d.left,bottom:v.bottom-d.top};if(R>=F){b.savedBBoxes={};R=0}if(r)b.savedBBoxes[r]=m;R++;return n.extendFlat({},m)};function B(e){var t=e.getAttribute("data-unformatted");if(t===null)return;return t+e.getAttribute("data-math")+e.getAttribute("text-anchor")+e.getAttribute("style")}b.setClipUrl=function(e,t,r){e.attr("clip-path",N(t,r))};function N(e,t){if(!e)return null;var r=t._context;var a=r._exportedPlot?"":r._baseUrl||"";return a?"url('"+a+"#"+e+"')":"url(#"+e+")"}b.getTranslate=function(e){var t=/.*\btranslate\((-?\d*\.?\d*)[^-\d]*(-?\d*\.?\d*)[^\d].*/;var r=e.attr?"attr":"getAttribute";var a=e[r]("transform")||"";var n=a.replace(t,(function(e,t,r){return[t,r].join(" ")})).split(" ");return{x:+n[0]||0,y:+n[1]||0}};b.setTranslate=function(e,t,r){var a=/(\btranslate\(.*?\);?)/;var n=e.attr?"attr":"getAttribute";var i=e.attr?"attr":"setAttribute";var o=e[n]("transform")||"";t=t||0;r=r||0;o=o.replace(a,"").trim();o+=f(t,r);o=o.trim();e[i]("transform",o);return o};b.getScale=function(e){var t=/.*\bscale\((\d*\.?\d*)[^\d]*(\d*\.?\d*)[^\d].*/;var r=e.attr?"attr":"getAttribute";var a=e[r]("transform")||"";var n=a.replace(t,(function(e,t,r){return[t,r].join(" ")})).split(" ");return{x:+n[0]||1,y:+n[1]||1}};b.setScale=function(e,t,r){var a=/(\bscale\(.*?\);?)/;var n=e.attr?"attr":"getAttribute";var i=e.attr?"attr":"setAttribute";var o=e[n]("transform")||"";t=t||1;r=r||1;o=o.replace(a,"").trim();o+="scale("+t+","+r+")";o=o.trim();e[i]("transform",o);return o};var j=/\s*sc.*/;b.setPointGroupScale=function(e,t,r){t=t||1;r=r||1;if(!e)return;var a=t===1&&r===1?"":"scale("+t+","+r+")";e.each((function(){var e=(this.getAttribute("transform")||"").replace(j,"");e+=a;e=e.trim();this.setAttribute("transform",e)}))};var U=/translate\([^)]*\)\s*$/;b.setTextPointsScale=function(e,t,r){if(!e)return;e.each((function(){var e;var n=a.select(this);var i=n.select("text");if(!i.node())return;var o=parseFloat(i.attr("x")||0);var s=parseFloat(i.attr("y")||0);var l=(n.attr("transform")||"").match(U);if(t===1&&r===1){e=[]}else{e=[f(o,s),"scale("+t+","+r+")",f(-o,-s)]}if(l){e.push(l)}n.attr("transform",e.join(""))}))}},{"../../components/fx/helpers":686,"../../constants/alignment":755,"../../constants/interactions":762,"../../constants/xmlns_namespaces":764,"../../lib":787,"../../lib/svg_text_utils":813,"../../registry":915,"../../traces/scatter/make_bubble_size_func":1219,"../../traces/scatter/subtypes":1227,"../color":650,"../colorscale":662,"./symbol_defs":673,"@plotly/d3":58,"fast-isnumeric":246,tinycolor2:583}],673:[function(e,t,r){"use strict";var a=e("@plotly/d3");t.exports={circle:{n:0,f:function(e){var t=a.round(e,2);return"M"+t+",0A"+t+","+t+" 0 1,1 0,-"+t+"A"+t+","+t+" 0 0,1 "+t+",0Z"}},square:{n:1,f:function(e){var t=a.round(e,2);return"M"+t+","+t+"H-"+t+"V-"+t+"H"+t+"Z"}},diamond:{n:2,f:function(e){var t=a.round(e*1.3,2);return"M"+t+",0L0,"+t+"L-"+t+",0L0,-"+t+"Z"}},cross:{n:3,f:function(e){var t=a.round(e*.4,2);var r=a.round(e*1.2,2);return"M"+r+","+t+"H"+t+"V"+r+"H-"+t+"V"+t+"H-"+r+"V-"+t+"H-"+t+"V-"+r+"H"+t+"V-"+t+"H"+r+"Z"}},x:{n:4,f:function(e){var t=a.round(e*.8/Math.sqrt(2),2);var r="l"+t+","+t;var n="l"+t+",-"+t;var i="l-"+t+",-"+t;var o="l-"+t+","+t;return"M0,"+t+r+n+i+n+i+o+i+o+r+o+r+"Z"}},"triangle-up":{n:5,f:function(e){var t=a.round(e*2/Math.sqrt(3),2);var r=a.round(e/2,2);var n=a.round(e,2);return"M-"+t+","+r+"H"+t+"L0,-"+n+"Z"}},"triangle-down":{n:6,f:function(e){var t=a.round(e*2/Math.sqrt(3),2);var r=a.round(e/2,2);var n=a.round(e,2);return"M-"+t+",-"+r+"H"+t+"L0,"+n+"Z"}},"triangle-left":{n:7,f:function(e){var t=a.round(e*2/Math.sqrt(3),2);var r=a.round(e/2,2);var n=a.round(e,2);return"M"+r+",-"+t+"V"+t+"L-"+n+",0Z"}},"triangle-right":{n:8,f:function(e){var t=a.round(e*2/Math.sqrt(3),2);var r=a.round(e/2,2);var n=a.round(e,2);return"M-"+r+",-"+t+"V"+t+"L"+n+",0Z"}},"triangle-ne":{n:9,f:function(e){var t=a.round(e*.6,2);var r=a.round(e*1.2,2);return"M-"+r+",-"+t+"H"+t+"V"+r+"Z"}},"triangle-se":{n:10,f:function(e){var t=a.round(e*.6,2);var r=a.round(e*1.2,2);return"M"+t+",-"+r+"V"+t+"H-"+r+"Z"}},"triangle-sw":{n:11,f:function(e){var t=a.round(e*.6,2);var r=a.round(e*1.2,2);return"M"+r+","+t+"H-"+t+"V-"+r+"Z"}},"triangle-nw":{n:12,f:function(e){var t=a.round(e*.6,2);var r=a.round(e*1.2,2);return"M-"+t+","+r+"V-"+t+"H"+r+"Z"}},pentagon:{n:13,f:function(e){var t=a.round(e*.951,2);var r=a.round(e*.588,2);var n=a.round(-e,2);var i=a.round(e*-.309,2);var o=a.round(e*.809,2);return"M"+t+","+i+"L"+r+","+o+"H-"+r+"L-"+t+","+i+"L0,"+n+"Z"}},hexagon:{n:14,f:function(e){var t=a.round(e,2);var r=a.round(e/2,2);var n=a.round(e*Math.sqrt(3)/2,2);return"M"+n+",-"+r+"V"+r+"L0,"+t+"L-"+n+","+r+"V-"+r+"L0,-"+t+"Z"}},hexagon2:{n:15,f:function(e){var t=a.round(e,2);var r=a.round(e/2,2);var n=a.round(e*Math.sqrt(3)/2,2);return"M-"+r+","+n+"H"+r+"L"+t+",0L"+r+",-"+n+"H-"+r+"L-"+t+",0Z"}},octagon:{n:16,f:function(e){var t=a.round(e*.924,2);var r=a.round(e*.383,2);return"M-"+r+",-"+t+"H"+r+"L"+t+",-"+r+"V"+r+"L"+r+","+t+"H-"+r+"L-"+t+","+r+"V-"+r+"Z"}},star:{n:17,f:function(e){var t=e*1.4;var r=a.round(t*.225,2);var n=a.round(t*.951,2);var i=a.round(t*.363,2);var o=a.round(t*.588,2);var s=a.round(-t,2);var l=a.round(t*-.309,2);var u=a.round(t*.118,2);var c=a.round(t*.809,2);var f=a.round(t*.382,2);return"M"+r+","+l+"H"+n+"L"+i+","+u+"L"+o+","+c+"L0,"+f+"L-"+o+","+c+"L-"+i+","+u+"L-"+n+","+l+"H-"+r+"L0,"+s+"Z"}},hexagram:{n:18,f:function(e){var t=a.round(e*.66,2);var r=a.round(e*.38,2);var n=a.round(e*.76,2);return"M-"+n+",0l-"+r+",-"+t+"h"+n+"l"+r+",-"+t+"l"+r+","+t+"h"+n+"l-"+r+","+t+"l"+r+","+t+"h-"+n+"l-"+r+","+t+"l-"+r+",-"+t+"h-"+n+"Z"}},"star-triangle-up":{n:19,f:function(e){var t=a.round(e*Math.sqrt(3)*.8,2);var r=a.round(e*.8,2);var n=a.round(e*1.6,2);var i=a.round(e*4,2);var o="A "+i+","+i+" 0 0 1 ";return"M-"+t+","+r+o+t+","+r+o+"0,-"+n+o+"-"+t+","+r+"Z"}},"star-triangle-down":{n:20,f:function(e){var t=a.round(e*Math.sqrt(3)*.8,2);var r=a.round(e*.8,2);var n=a.round(e*1.6,2);var i=a.round(e*4,2);var o="A "+i+","+i+" 0 0 1 ";return"M"+t+",-"+r+o+"-"+t+",-"+r+o+"0,"+n+o+t+",-"+r+"Z"}},"star-square":{n:21,f:function(e){var t=a.round(e*1.1,2);var r=a.round(e*2,2);var n="A "+r+","+r+" 0 0 1 ";return"M-"+t+",-"+t+n+"-"+t+","+t+n+t+","+t+n+t+",-"+t+n+"-"+t+",-"+t+"Z"}},"star-diamond":{n:22,f:function(e){var t=a.round(e*1.4,2);var r=a.round(e*1.9,2);var n="A "+r+","+r+" 0 0 1 ";return"M-"+t+",0"+n+"0,"+t+n+t+",0"+n+"0,-"+t+n+"-"+t+",0"+"Z"}},"diamond-tall":{n:23,f:function(e){var t=a.round(e*.7,2);var r=a.round(e*1.4,2);return"M0,"+r+"L"+t+",0L0,-"+r+"L-"+t+",0Z"}},"diamond-wide":{n:24,f:function(e){var t=a.round(e*1.4,2);var r=a.round(e*.7,2);return"M0,"+r+"L"+t+",0L0,-"+r+"L-"+t+",0Z"}},hourglass:{n:25,f:function(e){var t=a.round(e,2);return"M"+t+","+t+"H-"+t+"L"+t+",-"+t+"H-"+t+"Z"},noDot:true},bowtie:{n:26,f:function(e){var t=a.round(e,2);return"M"+t+","+t+"V-"+t+"L-"+t+","+t+"V-"+t+"Z"},noDot:true},"circle-cross":{n:27,f:function(e){var t=a.round(e,2);return"M0,"+t+"V-"+t+"M"+t+",0H-"+t+"M"+t+",0A"+t+","+t+" 0 1,1 0,-"+t+"A"+t+","+t+" 0 0,1 "+t+",0Z"},needLine:true,noDot:true},"circle-x":{n:28,f:function(e){var t=a.round(e,2);var r=a.round(e/Math.sqrt(2),2);return"M"+r+","+r+"L-"+r+",-"+r+"M"+r+",-"+r+"L-"+r+","+r+"M"+t+",0A"+t+","+t+" 0 1,1 0,-"+t+"A"+t+","+t+" 0 0,1 "+t+",0Z"},needLine:true,noDot:true},"square-cross":{n:29,f:function(e){var t=a.round(e,2);return"M0,"+t+"V-"+t+"M"+t+",0H-"+t+"M"+t+","+t+"H-"+t+"V-"+t+"H"+t+"Z"},needLine:true,noDot:true},"square-x":{n:30,f:function(e){var t=a.round(e,2);return"M"+t+","+t+"L-"+t+",-"+t+"M"+t+",-"+t+"L-"+t+","+t+"M"+t+","+t+"H-"+t+"V-"+t+"H"+t+"Z"},needLine:true,noDot:true},"diamond-cross":{n:31,f:function(e){var t=a.round(e*1.3,2);return"M"+t+",0L0,"+t+"L-"+t+",0L0,-"+t+"Z"+"M0,-"+t+"V"+t+"M-"+t+",0H"+t},needLine:true,noDot:true},"diamond-x":{n:32,f:function(e){var t=a.round(e*1.3,2);var r=a.round(e*.65,2);return"M"+t+",0L0,"+t+"L-"+t+",0L0,-"+t+"Z"+"M-"+r+",-"+r+"L"+r+","+r+"M-"+r+","+r+"L"+r+",-"+r},needLine:true,noDot:true},"cross-thin":{n:33,f:function(e){var t=a.round(e*1.4,2);return"M0,"+t+"V-"+t+"M"+t+",0H-"+t},needLine:true,noDot:true,noFill:true},"x-thin":{n:34,f:function(e){var t=a.round(e,2);return"M"+t+","+t+"L-"+t+",-"+t+"M"+t+",-"+t+"L-"+t+","+t},needLine:true,noDot:true,noFill:true},asterisk:{n:35,f:function(e){var t=a.round(e*1.2,2);var r=a.round(e*.85,2);return"M0,"+t+"V-"+t+"M"+t+",0H-"+t+"M"+r+","+r+"L-"+r+",-"+r+"M"+r+",-"+r+"L-"+r+","+r},needLine:true,noDot:true,noFill:true},hash:{n:36,f:function(e){var t=a.round(e/2,2);var r=a.round(e,2);return"M"+t+","+r+"V-"+r+"m-"+r+",0V"+r+"M"+r+","+t+"H-"+r+"m0,-"+r+"H"+r},needLine:true,noFill:true},"y-up":{n:37,f:function(e){var t=a.round(e*1.2,2);var r=a.round(e*1.6,2);var n=a.round(e*.8,2);return"M-"+t+","+n+"L0,0M"+t+","+n+"L0,0M0,-"+r+"L0,0"},needLine:true,noDot:true,noFill:true},"y-down":{n:38,f:function(e){var t=a.round(e*1.2,2);var r=a.round(e*1.6,2);var n=a.round(e*.8,2);return"M-"+t+",-"+n+"L0,0M"+t+",-"+n+"L0,0M0,"+r+"L0,0"},needLine:true,noDot:true,noFill:true},"y-left":{n:39,f:function(e){var t=a.round(e*1.2,2);var r=a.round(e*1.6,2);var n=a.round(e*.8,2);return"M"+n+","+t+"L0,0M"+n+",-"+t+"L0,0M-"+r+",0L0,0"},needLine:true,noDot:true,noFill:true},"y-right":{n:40,f:function(e){var t=a.round(e*1.2,2);var r=a.round(e*1.6,2);var n=a.round(e*.8,2);return"M-"+n+","+t+"L0,0M-"+n+",-"+t+"L0,0M"+r+",0L0,0"},needLine:true,noDot:true,noFill:true},"line-ew":{n:41,f:function(e){var t=a.round(e*1.4,2);return"M"+t+",0H-"+t},needLine:true,noDot:true,noFill:true},"line-ns":{n:42,f:function(e){var t=a.round(e*1.4,2);return"M0,"+t+"V-"+t},needLine:true,noDot:true,noFill:true},"line-ne":{n:43,f:function(e){var t=a.round(e,2);return"M"+t+",-"+t+"L-"+t+","+t},needLine:true,noDot:true,noFill:true},"line-nw":{n:44,f:function(e){var t=a.round(e,2);return"M"+t+","+t+"L-"+t+",-"+t},needLine:true,noDot:true,noFill:true},"arrow-up":{n:45,f:function(e){var t=a.round(e,2);var r=a.round(e*2,2);return"M0,0L-"+t+","+r+"H"+t+"Z"},noDot:true},"arrow-down":{n:46,f:function(e){var t=a.round(e,2);var r=a.round(e*2,2);return"M0,0L-"+t+",-"+r+"H"+t+"Z"},noDot:true},"arrow-left":{n:47,f:function(e){var t=a.round(e*2,2);var r=a.round(e,2);return"M0,0L"+t+",-"+r+"V"+r+"Z"},noDot:true},"arrow-right":{n:48,f:function(e){var t=a.round(e*2,2);var r=a.round(e,2);return"M0,0L-"+t+",-"+r+"V"+r+"Z"},noDot:true},"arrow-bar-up":{n:49,f:function(e){var t=a.round(e,2);var r=a.round(e*2,2);return"M-"+t+",0H"+t+"M0,0L-"+t+","+r+"H"+t+"Z"},needLine:true,noDot:true},"arrow-bar-down":{n:50,f:function(e){var t=a.round(e,2);var r=a.round(e*2,2);return"M-"+t+",0H"+t+"M0,0L-"+t+",-"+r+"H"+t+"Z"},needLine:true,noDot:true},"arrow-bar-left":{n:51,f:function(e){var t=a.round(e*2,2);var r=a.round(e,2);return"M0,-"+r+"V"+r+"M0,0L"+t+",-"+r+"V"+r+"Z"},needLine:true,noDot:true},"arrow-bar-right":{n:52,f:function(e){var t=a.round(e*2,2);var r=a.round(e,2);return"M0,-"+r+"V"+r+"M0,0L-"+t+",-"+r+"V"+r+"Z"},needLine:true,noDot:true}}},{"@plotly/d3":58}],674:[function(e,t,r){"use strict";t.exports={visible:{valType:"boolean",editType:"calc"},type:{valType:"enumerated",values:["percent","constant","sqrt","data"],editType:"calc"},symmetric:{valType:"boolean",editType:"calc"},array:{valType:"data_array",editType:"calc"},arrayminus:{valType:"data_array",editType:"calc"},value:{valType:"number",min:0,dflt:10,editType:"calc"},valueminus:{valType:"number",min:0,dflt:10,editType:"calc"},traceref:{valType:"integer",min:0,dflt:0,editType:"style"},tracerefminus:{valType:"integer",min:0,dflt:0,editType:"style"},copy_ystyle:{valType:"boolean",editType:"plot"},copy_zstyle:{valType:"boolean",editType:"style"},color:{valType:"color",editType:"style"},thickness:{valType:"number",min:0,dflt:2,editType:"style"},width:{valType:"number",min:0,editType:"plot"},editType:"calc",_deprecated:{opacity:{valType:"number",editType:"style"}}}},{}],675:[function(e,t,r){"use strict";var a=e("fast-isnumeric");var n=e("../../registry");var i=e("../../plots/cartesian/axes");var o=e("../../lib");var s=e("./compute_error");t.exports=function e(t){var r=t.calcdata;for(var a=0;a<r.length;a++){var o=r[a];var s=o[0].trace;if(s.visible===true&&n.traceIs(s,"errorBarsOK")){var u=i.getFromId(t,s.xaxis);var c=i.getFromId(t,s.yaxis);l(o,s,u,"x");l(o,s,c,"y")}}};function l(e,t,r,n){var l=t["error_"+n]||{};var u=l.visible&&["linear","log"].indexOf(r.type)!==-1;var c=[];if(!u)return;var f=s(l);for(var h=0;h<e.length;h++){var p=e[h];var v=p.i;if(v===undefined)v=h;else if(v===null)continue;var d=p[n];if(!a(r.c2l(d)))continue;var m=f(d,v);if(a(m[0])&&a(m[1])){var g=p[n+"s"]=d-m[0];var y=p[n+"h"]=d+m[1];c.push(g,y)}}var x=r._id;var b=t._extremes[x];var _=i.findExtremes(r,c,o.extendFlat({tozero:b.opts.tozero},{padded:true}));b.min=b.min.concat(_.min);b.max=b.max.concat(_.max)}},{"../../lib":787,"../../plots/cartesian/axes":838,"../../registry":915,"./compute_error":676,"fast-isnumeric":246}],676:[function(e,t,r){"use strict";t.exports=function e(t){var r=t.type;var n=t.symmetric;if(r==="data"){var i=t.array||[];if(n){return function e(t,r){var a=+i[r];return[a,a]}}else{var o=t.arrayminus||[];return function e(t,r){var a=+i[r];var n=+o[r];if(!isNaN(a)||!isNaN(n)){return[n||0,a||0]}return[NaN,NaN]}}}else{var s=a(r,t.value);var l=a(r,t.valueminus);if(n||t.valueminus===undefined){return function e(t){var r=s(t);return[r,r]}}else{return function e(t){return[l(t),s(t)]}}}};function a(e,t){if(e==="percent"){return function(e){return Math.abs(e*t/100)}}if(e==="constant"){return function(){return Math.abs(t)}}if(e==="sqrt"){return function(e){return Math.sqrt(Math.abs(e))}}}},{}],677:[function(e,t,r){"use strict";var a=e("fast-isnumeric");var n=e("../../registry");var i=e("../../lib");var o=e("../../plot_api/plot_template");var s=e("./attributes");t.exports=function(e,t,r,l){var u="error_"+l.axis;var c=o.newContainer(t,u);var f=e[u]||{};function h(e,t){return i.coerce(f,c,s,e,t)}var p=f.array!==undefined||f.value!==undefined||f.type==="sqrt";var v=h("visible",p);if(v===false)return;var d=h("type","array"in f?"data":"percent");var m=true;if(d!=="sqrt"){m=h("symmetric",!((d==="data"?"arrayminus":"valueminus")in f))}if(d==="data"){h("array");h("traceref");if(!m){h("arrayminus");h("tracerefminus")}}else if(d==="percent"||d==="constant"){h("value");if(!m)h("valueminus")}var g="copy_"+l.inherit+"style";if(l.inherit){var y=t["error_"+l.inherit];if((y||{}).visible){h(g,!(f.color||a(f.thickness)||a(f.width)))}}if(!l.inherit||!c[g]){h("color",r);h("thickness");h("width",n.traceIs(t,"gl3d")?0:4)}}},{"../../lib":787,"../../plot_api/plot_template":827,"../../registry":915,"./attributes":674,"fast-isnumeric":246}],678:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("../../plot_api/edit_types").overrideAll;var i=e("./attributes");var o={error_x:a.extendFlat({},i),error_y:a.extendFlat({},i)};delete o.error_x.copy_zstyle;delete o.error_y.copy_zstyle;delete o.error_y.copy_ystyle;var s={error_x:a.extendFlat({},i),error_y:a.extendFlat({},i),error_z:a.extendFlat({},i)};delete s.error_x.copy_ystyle;delete s.error_y.copy_ystyle;delete s.error_z.copy_ystyle;delete s.error_z.copy_zstyle;t.exports={moduleType:"component",name:"errorbars",schema:{traces:{scatter:o,bar:o,histogram:o,scatter3d:n(s,"calc","nested"),scattergl:n(o,"calc","nested")}},supplyDefaults:e("./defaults"),calc:e("./calc"),makeComputeError:e("./compute_error"),plot:e("./plot"),style:e("./style"),hoverInfo:l};function l(e,t,r){if((t.error_y||{}).visible){r.yerr=e.yh-e.y;if(!t.error_y.symmetric)r.yerrneg=e.y-e.ys}if((t.error_x||{}).visible){r.xerr=e.xh-e.x;if(!t.error_x.symmetric)r.xerrneg=e.x-e.xs}}},{"../../lib":787,"../../plot_api/edit_types":820,"./attributes":674,"./calc":675,"./compute_error":676,"./defaults":677,"./plot":679,"./style":680}],679:[function(e,t,r){"use strict";var a=e("@plotly/d3");var n=e("fast-isnumeric");var i=e("../drawing");var o=e("../../traces/scatter/subtypes");t.exports=function e(t,r,l,u){var c;var f=l.xaxis;var h=l.yaxis;var p=u&&u.duration>0;r.each((function(e){var r=e[0].trace;var v=r.error_x||{};var d=r.error_y||{};var m;if(r.ids){m=function(e){return e.id}}var g=o.hasMarkers(r)&&r.marker.maxdisplayed>0;if(!d.visible&&!v.visible)e=[];var y=a.select(this).selectAll("g.errorbar").data(e,m);y.exit().remove();if(!e.length)return;if(!v.visible)y.selectAll("path.xerror").remove();if(!d.visible)y.selectAll("path.yerror").remove();y.style("opacity",1);var x=y.enter().append("g").classed("errorbar",true);if(p){x.style("opacity",0).transition().duration(u.duration).style("opacity",1)}i.setClipUrl(y,l.layerClipId,t);y.each((function(e){var t=a.select(this);var r=s(e,f,h);if(g&&!e.vis)return;var i;var o=t.select("path.yerror");if(d.visible&&n(r.x)&&n(r.yh)&&n(r.ys)){var l=d.width;i="M"+(r.x-l)+","+r.yh+"h"+2*l+"m-"+l+",0V"+r.ys;if(!r.noYS)i+="m-"+l+",0h"+2*l;c=!o.size();if(c){o=t.append("path").style("vector-effect","non-scaling-stroke").classed("yerror",true)}else if(p){o=o.transition().duration(u.duration).ease(u.easing)}o.attr("d",i)}else o.remove();var m=t.select("path.xerror");if(v.visible&&n(r.y)&&n(r.xh)&&n(r.xs)){var y=(v.copy_ystyle?d:v).width;i="M"+r.xh+","+(r.y-y)+"v"+2*y+"m0,-"+y+"H"+r.xs;if(!r.noXS)i+="m0,-"+y+"v"+2*y;c=!m.size();if(c){m=t.append("path").style("vector-effect","non-scaling-stroke").classed("xerror",true)}else if(p){m=m.transition().duration(u.duration).ease(u.easing)}m.attr("d",i)}else m.remove()}))}))};function s(e,t,r){var a={x:t.c2p(e.x),y:r.c2p(e.y)};if(e.yh!==undefined){a.yh=r.c2p(e.yh);a.ys=r.c2p(e.ys);if(!n(a.ys)){a.noYS=true;a.ys=r.c2p(e.ys,true)}}if(e.xh!==undefined){a.xh=t.c2p(e.xh);a.xs=t.c2p(e.xs);if(!n(a.xs)){a.noXS=true;a.xs=t.c2p(e.xs,true)}}return a}},{"../../traces/scatter/subtypes":1227,"../drawing":672,"@plotly/d3":58,"fast-isnumeric":246}],680:[function(e,t,r){"use strict";var a=e("@plotly/d3");var n=e("../color");t.exports=function e(t){t.each((function(e){var t=e[0].trace;var r=t.error_y||{};var i=t.error_x||{};var o=a.select(this);o.selectAll("path.yerror").style("stroke-width",r.thickness+"px").call(n.stroke,r.color);if(i.copy_ystyle)i=r;o.selectAll("path.xerror").style("stroke-width",i.thickness+"px").call(n.stroke,i.color)}))}},{"../color":650,"@plotly/d3":58}],681:[function(e,t,r){"use strict";var a=e("../../plots/font_attributes");var n=e("./layout_attributes").hoverlabel;var i=e("../../lib/extend").extendFlat;t.exports={hoverlabel:{bgcolor:i({},n.bgcolor,{arrayOk:true}),bordercolor:i({},n.bordercolor,{arrayOk:true}),font:a({arrayOk:true,editType:"none"}),align:i({},n.align,{arrayOk:true}),namelength:i({},n.namelength,{arrayOk:true}),editType:"none"}}},{"../../lib/extend":777,"../../plots/font_attributes":867,"./layout_attributes":691}],682:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("../../registry");t.exports=function e(t){var r=t.calcdata;var o=t._fullLayout;function s(e){return function(t){return a.coerceHoverinfo({hoverinfo:t},{_module:e._module},o)}}for(var l=0;l<r.length;l++){var u=r[l];var c=u[0].trace;if(n.traceIs(c,"pie-like"))continue;var f=n.traceIs(c,"2dMap")?i:a.fillArray;f(c.hoverinfo,u,"hi",s(c));if(c.hovertemplate)f(c.hovertemplate,u,"ht");if(!c.hoverlabel)continue;f(c.hoverlabel.bgcolor,u,"hbg");f(c.hoverlabel.bordercolor,u,"hbc");f(c.hoverlabel.font.size,u,"hts");f(c.hoverlabel.font.color,u,"htc");f(c.hoverlabel.font.family,u,"htf");f(c.hoverlabel.namelength,u,"hnl");f(c.hoverlabel.align,u,"hta")}};function i(e,t,r,n){n=n||a.identity;if(Array.isArray(e)){t[0][r]=n(e)}}},{"../../lib":787,"../../registry":915}],683:[function(e,t,r){"use strict";var a=e("../../registry");var n=e("./hover").hover;t.exports=function e(t,r,i){var o=a.getComponentMethod("annotations","onClick")(t,t._hoverdata);if(i!==undefined){n(t,r,i,true)}function s(){t.emit("plotly_click",{points:t._hoverdata,event:r})}if(t._hoverdata&&r&&r.target){if(o&&o.then){o.then(s)}else s();if(r.stopImmediatePropagation)r.stopImmediatePropagation()}}},{"../../registry":915,"./hover":687}],684:[function(e,t,r){"use strict";t.exports={YANGLE:60,HOVERARROWSIZE:6,HOVERTEXTPAD:3,HOVERFONTSIZE:13,HOVERFONT:"Arial, sans-serif",HOVERMINTIME:50,HOVERID:"-hover"}},{}],685:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("./attributes");var i=e("./hoverlabel_defaults");t.exports=function e(t,r,o,s){function l(e,i){return a.coerce(t,r,n,e,i)}var u=a.extendFlat({},s.hoverlabel);if(r.hovertemplate)u.namelength=-1;i(t,r,l,u)}},{"../../lib":787,"./attributes":681,"./hoverlabel_defaults":688}],686:[function(e,t,r){"use strict";var a=e("../../lib");r.getSubplot=function(e){return e.subplot||e.xaxis+e.yaxis||e.geo};r.isTraceInSubplots=function(e,t){if(e.type==="splom"){var a=e.xaxes||[];var n=e.yaxes||[];for(var i=0;i<a.length;i++){for(var o=0;o<n.length;o++){if(t.indexOf(a[i]+n[o])!==-1){return true}}}return false}return t.indexOf(r.getSubplot(e))!==-1};r.flat=function(e,t){var r=new Array(e.length);for(var a=0;a<e.length;a++){r[a]=t}return r};r.p2c=function(e,t){var r=new Array(e.length);for(var a=0;a<e.length;a++){r[a]=e[a].p2c(t)}return r};r.getDistanceFunction=function(e,t,a,n){if(e==="closest")return n||r.quadrature(t,a);return e.charAt(0)==="x"?t:a};r.getClosest=function(e,t,r){if(r.index!==false){if(r.index>=0&&r.index<e.length){r.distance=0}else r.index=false}else{for(var a=0;a<e.length;a++){var n=t(e[a]);if(n<=r.distance){r.index=a;r.distance=n}}}return r};r.inbox=function(e,t,r){return e*t<0||e===0?r:Infinity};r.quadrature=function(e,t){return function(r){var a=e(r);var n=t(r);return Math.sqrt(a*a+n*n)}};r.makeEventData=function(e,t,a){var n="index"in e?e.index:e.pointNumber;var i={data:t._input,fullData:t,curveNumber:t.index,pointNumber:n};if(t._indexToPoints){var o=t._indexToPoints[n];if(o.length===1){i.pointIndex=o[0]}else{i.pointIndices=o}}else{i.pointIndex=n}if(t._module.eventData){i=t._module.eventData(i,e,t,a,n)}else{if("xVal"in e)i.x=e.xVal;else if("x"in e)i.x=e.x;if("yVal"in e)i.y=e.yVal;else if("y"in e)i.y=e.y;if(e.xa)i.xaxis=e.xa;if(e.ya)i.yaxis=e.ya;if(e.zLabelVal!==undefined)i.z=e.zLabelVal}r.appendArrayPointValue(i,t,n);return i};r.appendArrayPointValue=function(e,t,r){var n=t._arrayAttrs;if(!n){return}for(var s=0;s<n.length;s++){var l=n[s];var u=i(l);if(e[u]===undefined){var c=a.nestedProperty(t,l).get();var f=o(c,r);if(f!==undefined)e[u]=f}}};r.appendArrayMultiPointValues=function(e,t,r){var n=t._arrayAttrs;if(!n){return}for(var s=0;s<n.length;s++){var l=n[s];var u=i(l);if(e[u]===undefined){var c=a.nestedProperty(t,l).get();var f=new Array(r.length);for(var h=0;h<r.length;h++){f[h]=o(c,r[h])}e[u]=f}}};var n={ids:"id",locations:"location",labels:"label",values:"value","marker.colors":"color",parents:"parent"};function i(e){return n[e]||e}function o(e,t){if(Array.isArray(t)){if(Array.isArray(e)&&Array.isArray(e[t[0]])){return e[t[0]][t[1]]}}else{return e[t]}}var s={x:true,y:true};var l={"x unified":true,"y unified":true};r.isUnifiedHover=function(e){if(typeof e!=="string")return false;return!!l[e]};r.isXYhover=function(e){if(typeof e!=="string")return false;return!!s[e]}},{"../../lib":787}],687:[function(e,t,r){"use strict";var a=e("@plotly/d3");var n=e("fast-isnumeric");var i=e("tinycolor2");var o=e("../../lib");var s=o.strTranslate;var l=o.strRotate;var u=e("../../lib/events");var c=e("../../lib/svg_text_utils");var f=e("../../lib/override_cursor");var h=e("../drawing");var p=e("../color");var v=e("../dragelement");var d=e("../../plots/cartesian/axes");var m=e("../../registry");var g=e("./helpers");var y=e("./constants");var x=e("../legend/defaults");var b=e("../legend/draw");var _=y.YANGLE;var w=Math.PI*_/180;var T=1/Math.sin(w);var k=Math.cos(w);var M=Math.sin(w);var A=y.HOVERARROWSIZE;var S=y.HOVERTEXTPAD;var E={box:true,ohlc:true,violin:true,candlestick:true};var L={scatter:true,scattergl:true,splom:true};r.hover=function e(t,r,a,n){t=o.getGraphDiv(t);o.throttle(t._fullLayout._uid+y.HOVERID,y.HOVERMINTIME,(function(){C(t,r,a,n)}))};r.loneHover=function e(t,r){var n=true;if(!Array.isArray(t)){n=false;t=[t]}var i=r.gd;var o=q(i);var s=G(i);var l=t.map((function(e){var t=e._x0||e.x0||e.x||0;var a=e._x1||e.x1||e.x||0;var n=e._y0||e.y0||e.y||0;var l=e._y1||e.y1||e.y||0;var u=e.eventData;if(u){var c=Math.min(t,a);var f=Math.max(t,a);var h=Math.min(n,l);var v=Math.max(n,l);var d=e.trace;if(m.traceIs(d,"gl3d")){var g=i._fullLayout[d.scene]._scene.container;var y=g.offsetLeft;var x=g.offsetTop;c+=y;f+=y;h+=x;v+=x}u.bbox={x0:c+s,x1:f+s,y0:h+o,y1:v+o};if(r.inOut_bbox){r.inOut_bbox.push(u.bbox)}}else{u=false}return{color:e.color||p.defaultLine,x0:e.x0||e.x||0,x1:e.x1||e.x||0,y0:e.y0||e.y||0,y1:e.y1||e.y||0,xLabel:e.xLabel,yLabel:e.yLabel,zLabel:e.zLabel,text:e.text,name:e.name,idealAlign:e.idealAlign,borderColor:e.borderColor,fontFamily:e.fontFamily,fontSize:e.fontSize,fontColor:e.fontColor,nameLength:e.nameLength,textAlign:e.textAlign,trace:e.trace||{index:0,hoverinfo:""},xa:{_offset:0},ya:{_offset:0},index:0,hovertemplate:e.hovertemplate||false,hovertemplateLabels:e.hovertemplateLabels||false,eventData:u}}));var u=false;var c=O(l,{gd:i,hovermode:"closest",rotateLabels:u,bgColor:r.bgColor||p.background,container:a.select(r.container),outerContainer:r.outerContainer||r.container});var f=5;var h=0;var v=0;c.sort((function(e,t){return e.y0-t.y0})).each((function(e,t){var a=e.y0-e.by/2;if(a-f<h){e.offset=h-a+f}else{e.offset=0}h=a+e.by+e.offset;if(t===r.anchorIndex||0)v=e.offset})).each((function(e){e.offset-=v}));var d=i._fullLayout._invScaleX;var g=i._fullLayout._invScaleY;R(c,u,d,g);return n?c:c.node()};function C(e,t,r,i){if(!r)r="xy";var s=Array.isArray(r)?r:[r];var l=e._fullLayout;var c=l._plots||[];var h=c[r];var d=l._has("cartesian");if(h){var y=h.overlays.map((function(e){return e.id}));s=s.concat(y)}var x=s.length;var b=new Array(x);var _=new Array(x);var w=false;for(var T=0;T<x;T++){var k=s[T];if(c[k]){w=true;b[T]=c[k].xaxis;_[T]=c[k].yaxis}else if(l[k]&&l[k]._subplot){var M=l[k]._subplot;b[T]=M.xaxis;_[T]=M.yaxis}else{o.warn("Unrecognized subplot: "+k);return}}var A=t.hovermode||l.hovermode;if(A&&!w)A="closest";if(["x","y","closest","x unified","y unified"].indexOf(A)===-1||!e.calcdata||e.querySelector(".zoombox")||e._dragging){return v.unhoverRaw(e,t)}var S=l.hoverdistance;if(S===-1)S=Infinity;var C=l.spikedistance;if(C===-1)C=Infinity;var P=[];var z=[];var U,Y;var W,X,Z,J,K,Q,$,ee,te,re,ae;var ne={hLinePoint:null,vLinePoint:null};var ie=false;if(Array.isArray(t)){A="array";for(W=0;W<t.length;W++){Z=e.calcdata[t[W].curveNumber||0];if(Z){J=Z[0].trace;if(Z[0].trace.hoverinfo!=="skip"){z.push(Z);if(J.orientation==="h"){ie=true}}}}}else{for(X=0;X<e.calcdata.length;X++){Z=e.calcdata[X];J=Z[0].trace;if(J.hoverinfo!=="skip"&&g.isTraceInSubplots(J,s)){z.push(Z);if(J.orientation==="h"){ie=true}}}var oe=!t.target;var se,le;if(oe){if("xpx"in t)se=t.xpx;else se=b[0]._length/2;if("ypx"in t)le=t.ypx;else le=_[0]._length/2}else{if(u.triggerHandler(e,"plotly_beforehover",t)===false){return}var ue=t.composedPath&&t.composedPath()[0];if(!ue){ue=t.target}var ce=ue.getBoundingClientRect();se=t.clientX-ce.left;le=t.clientY-ce.top;l._calcInverseTransform(e);var fe=o.apply3DTransform(l._invTransform)(se,le);se=fe[0];le=fe[1];if(se<0||se>b[0]._length||le<0||le>_[0]._length){return v.unhoverRaw(e,t)}}t.pointerX=se+b[0]._offset;t.pointerY=le+_[0]._offset;if("xval"in t)U=g.flat(s,t.xval);else U=g.p2c(b,se);if("yval"in t)Y=g.flat(s,t.yval);else Y=g.p2c(_,le);if(!n(U[0])||!n(Y[0])){o.warn("Fx.hover failed",t,e);return v.unhoverRaw(e,t)}}var he=Infinity;function pe(e,r){for(X=0;X<z.length;X++){Z=z[X];if(!Z||!Z[0]||!Z[0].trace)continue;J=Z[0].trace;if(J.visible!==true||J._length===0)continue;if(["carpet","contourcarpet"].indexOf(J._module.name)!==-1)continue;if(J.type==="splom"){Q=0;K=s[Q]}else{K=g.getSubplot(J);Q=s.indexOf(K)}$=A;if(g.isUnifiedHover($)){$=$.charAt(0)}re={cd:Z,trace:J,xa:b[Q],ya:_[Q],maxHoverDistance:S,maxSpikeDistance:C,index:false,distance:Math.min(he,S),spikeDistance:Infinity,xSpike:undefined,ySpike:undefined,color:p.defaultLine,name:J.name,x0:undefined,x1:undefined,y0:undefined,y1:undefined,xLabelVal:undefined,yLabelVal:undefined,zLabelVal:undefined,text:undefined};if(l[K]){re.subplot=l[K]._subplot}if(l._splomScenes&&l._splomScenes[J.uid]){re.scene=l._splomScenes[J.uid]}ae=P.length;if($==="array"){var a=t[X];if("pointNumber"in a){re.index=a.pointNumber;$="closest"}else{$="";if("xval"in a){ee=a.xval;$="x"}if("yval"in a){te=a.yval;$=$?"closest":"y"}}}else if(e!==undefined&&r!==undefined){ee=e;te=r}else{ee=U[Q];te=Y[Q]}if(S!==0){if(J._module&&J._module.hoverPoints){var i=J._module.hoverPoints(re,ee,te,$,{finiteRange:true,hoverLayer:l._hoverlayer});if(i){var u;for(var c=0;c<i.length;c++){u=i[c];if(n(u.x0)&&n(u.y0)){P.push(F(u,A))}}}}else{o.log("Unrecognized trace type in hover:",J)}}if(A==="closest"&&P.length>ae){P.splice(0,ae);he=P[0].distance}if(d&&C!==0){if(P.length===0){re.distance=C;re.index=false;var f=J._module.hoverPoints(re,ee,te,"closest",{hoverLayer:l._hoverlayer});if(f){f=f.filter((function(e){return e.spikeDistance<=C}))}if(f&&f.length){var h;var v=f.filter((function(e){return e.xa.showspikes&&e.xa.spikesnap!=="hovered data"}));if(v.length){var m=v[0];if(n(m.x0)&&n(m.y0)){h=de(m);if(!ne.vLinePoint||ne.vLinePoint.spikeDistance>h.spikeDistance){ne.vLinePoint=h}}}var y=f.filter((function(e){return e.ya.showspikes&&e.ya.spikesnap!=="hovered data"}));if(y.length){var x=y[0];if(n(x.x0)&&n(x.y0)){h=de(x);if(!ne.hLinePoint||ne.hLinePoint.spikeDistance>h.spikeDistance){ne.hLinePoint=h}}}}}}}}pe();function ve(e,t,r){var a=null;var n=Infinity;var i;for(var o=0;o<e.length;o++){i=e[o].spikeDistance;if(r&&o===0)i=-Infinity;if(i<=n&&i<=t){a=e[o];n=i}}return a}function de(e){if(!e)return null;return{xa:e.xa,ya:e.ya,x:e.xSpike!==undefined?e.xSpike:(e.x0+e.x1)/2,y:e.ySpike!==undefined?e.ySpike:(e.y0+e.y1)/2,distance:e.distance,spikeDistance:e.spikeDistance,curveNumber:e.trace.index,color:e.color,pointNumber:e.index}}var me={fullLayout:l,container:l._hoverlayer,event:t};var ge=e._spikepoints;var ye={vLinePoint:ne.vLinePoint,hLinePoint:ne.hLinePoint};e._spikepoints=ye;var xe=function(){P.sort((function(e,t){return e.distance-t.distance}));P=V(P,A)};xe();var be=A.charAt(0);var _e=(be==="x"||be==="y")&&P[0]&&L[P[0].trace.type];if(d&&C!==0){if(P.length!==0){var we=P.filter((function(e){return e.ya.showspikes}));var Te=ve(we,C,_e);ne.hLinePoint=de(Te);var ke=P.filter((function(e){return e.xa.showspikes}));var Me=ve(ke,C,_e);ne.vLinePoint=de(Me)}}if(P.length===0){var Ae=v.unhoverRaw(e,t);if(d&&(ne.hLinePoint!==null||ne.vLinePoint!==null)){if(j(ge)){B(e,ne,me)}}return Ae}if(d){if(j(ge)){B(e,ne,me)}}if(g.isXYhover($)&&P[0].length!==0&&P[0].trace.type!=="splom"){var Se=P[0];if(E[Se.trace.type]){P=P.filter((function(e){return e.trace.index===Se.trace.index}))}else{P=[Se]}var Ee=P.length;var Le=H("x",Se,l);var Ce=H("y",Se,l);pe(Le,Ce);var Ie=[];var Pe={};var Oe=0;var ze=function(e){var t=E[e.trace.type]?I(e):e.trace.index;if(!Pe[t]){Oe++;Pe[t]=Oe;Ie.push(e)}else{var r=Pe[t]-1;var a=Ie[r];if(r>0&&Math.abs(e.distance)<Math.abs(a.distance)){Ie[r]=e}}};var De;for(De=0;De<Ee;De++){ze(P[De])}for(De=P.length-1;De>Ee-1;De--){ze(P[De])}P=Ie;xe()}var Re=e._hoverdata;var Fe=[];var Be=q(e);var Ne=G(e);for(W=0;W<P.length;W++){var je=P[W];var Ue=g.makeEventData(je,je.trace,je.cd);if(je.hovertemplate!==false){var Ve=false;if(je.cd[je.index]&&je.cd[je.index].ht){Ve=je.cd[je.index].ht}je.hovertemplate=Ve||je.trace.hovertemplate||false}if(je.xa&&je.ya){var He=je.x0+je.xa._offset;var qe=je.x1+je.xa._offset;var Ge=je.y0+je.ya._offset;var Ye=je.y1+je.ya._offset;var We=Math.min(He,qe);var Xe=Math.max(He,qe);var Ze=Math.min(Ge,Ye);var Je=Math.max(Ge,Ye);Ue.bbox={x0:We+Ne,x1:Xe+Ne,y0:Ze+Be,y1:Je+Be}}je.eventData=[Ue];Fe.push(Ue)}e._hoverdata=Fe;var Ke=A==="y"&&(z.length>1||P.length>1)||A==="closest"&&ie&&P.length>1;var Qe=p.combine(l.plot_bgcolor||p.background,l.paper_bgcolor);var $e=O(P,{gd:e,hovermode:A,rotateLabels:Ke,bgColor:Qe,container:l._hoverlayer,outerContainer:l._paper.node(),commonLabelOpts:l.hoverlabel,hoverdistance:l.hoverdistance});if(!g.isUnifiedHover(A)){D($e,Ke?"xa":"ya",l);R($e,Ke,l._invScaleX,l._invScaleY)}if(t.target&&t.target.tagName){var et=m.getComponentMethod("annotations","hasClickToShow")(e,Fe);f(a.select(t.target),et?"pointer":"")}if(!t.target||i||!N(e,t,Re))return;if(Re){e.emit("plotly_unhover",{event:t,points:Re})}e.emit("plotly_hover",{event:t,points:e._hoverdata,xaxes:b,yaxes:_,xvals:U,yvals:Y})}function I(e){return[e.trace.index,e.index,e.x0,e.y0,e.name,e.attr,e.xa?e.xa._id:"",e.ya?e.ya._id:""].join(",")}var P=/<extra>([\s\S]*)<\/extra>/;function O(e,t){var r=t.gd;var n=r._fullLayout;var i=t.hovermode;var u=t.rotateLabels;var f=t.bgColor;var v=t.container;var d=t.outerContainer;var w=t.commonLabelOpts||{};var T=t.fontFamily||y.HOVERFONT;var k=t.fontSize||y.HOVERFONTSIZE;var M=e[0];var E=M.xa;var L=M.ya;var C=i.charAt(0);var P=M[C+"Label"];var O=Y(r,d);var D=O.top;var R=O.width;var F=O.height;var B=P!==undefined&&M.distance<=t.hoverdistance&&(i==="x"||i==="y");if(B){var N=true;var j,U;for(j=0;j<e.length;j++){if(N&&e[j].zLabel===undefined)N=false;U=e[j].hoverinfo||e[j].trace.hoverinfo;if(U){var V=Array.isArray(U)?U:U.split("+");if(V.indexOf("all")===-1&&V.indexOf(i)===-1){B=false;break}}}if(N)B=false}var H=v.selectAll("g.axistext").data(B?[0]:[]);H.enter().append("g").classed("axistext",true);H.exit().remove();H.each((function(){var e=a.select(this);var t=o.ensureSingle(e,"path","",(function(e){e.style({"stroke-width":"1px"})}));var l=o.ensureSingle(e,"text","",(function(e){e.attr("data-notex",1)}));var u=w.bgcolor||p.defaultLine;var f=w.bordercolor||p.contrast(u);var v=p.contrast(u);var d={family:w.font.family||T,size:w.font.size||k,color:w.font.color||v};t.style({fill:u,stroke:f});l.text(P).call(h.font,d).call(c.positionText,0,0).call(c.convertToTspans,r);e.attr("transform","");var m=Y(r,l.node());var g,y;if(i==="x"){var x=E.side==="top"?"-":"";l.attr("text-anchor","middle").call(c.positionText,0,E.side==="top"?D-m.bottom-A-S:D-m.top+A+S);g=E._offset+(M.x0+M.x1)/2;y=L._offset+(E.side==="top"?0:L._length);var b=m.width/2+S;if(g<b){g=b;t.attr("d","M-"+(b-A)+",0"+"L-"+(b-A*2)+","+x+A+"H"+(S+m.width/2)+"v"+x+(S*2+m.height)+"H-"+b+"V"+x+A+"Z")}else if(g>n.width-b){g=n.width-b;t.attr("d","M"+(b-A)+",0"+"L"+b+","+x+A+"v"+x+(S*2+m.height)+"H-"+b+"V"+x+A+"H"+(b-A*2)+"Z")}else{t.attr("d","M0,0"+"L"+A+","+x+A+"H"+(S+m.width/2)+"v"+x+(S*2+m.height)+"H-"+(S+m.width/2)+"V"+x+A+"H-"+A+"Z")}}else{var _;var C;var I;if(L.side==="right"){_="start";C=1;I="";g=E._offset+E._length}else{_="end";C=-1;I="-";g=E._offset}y=L._offset+(M.y0+M.y1)/2;l.attr("text-anchor",_);t.attr("d","M0,0"+"L"+I+A+","+A+"V"+(S+m.height/2)+"h"+I+(S*2+m.width)+"V-"+(S+m.height/2)+"H"+I+A+"V-"+A+"Z");var O=m.height/2;var z=D-m.top-O;var R="clip"+n._uid+"commonlabel"+L._id;var F;if(g<m.width+2*S+A){F="M-"+(A+S)+"-"+O+"h-"+(m.width-S)+"V"+O+"h"+(m.width-S)+"Z";var B=m.width-g+S;c.positionText(l,B,z);if(_==="end"){l.selectAll("tspan").each((function(){var e=a.select(this);var t=h.tester.append("text").text(e.text()).call(h.font,d);var n=Y(r,t.node());if(Math.round(n.width)<Math.round(m.width)){e.attr("x",B-n.width)}t.remove()}))}}else{c.positionText(l,C*(S+A),z);F=null}var N=n._topclips.selectAll("#"+R).data(F?[0]:[]);N.enter().append("clipPath").attr("id",R).append("path");N.exit().remove();N.select("path").attr("d",F);h.setClipUrl(l,F?R:null,r)}e.attr("transform",s(g,y))}));if(g.isUnifiedHover(i)){v.selectAll("g.hovertext").remove();if(e.length===0)return;var q=n.hoverlabel;var G=q.font;var W={showlegend:true,legend:{title:{text:P,font:G},font:G,bgcolor:q.bgcolor,bordercolor:q.bordercolor,borderwidth:1,tracegroupgap:7,traceorder:n.legend?n.legend.traceorder:undefined,orientation:"v"}};var X={};x(W,X,r._fullData);var Z=X.legend;Z.entries=[];for(var J=0;J<e.length;J++){var K=z(e[J],true,i,n,P);var Q=K[0];var $=K[1];var ee=e[J];ee.name=$;if($!==""){ee.text=$+" : "+Q}else{ee.text=Q}var te=ee.cd[ee.index];if(te){if(te.mc)ee.mc=te.mc;if(te.mcc)ee.mc=te.mcc;if(te.mlc)ee.mlc=te.mlc;if(te.mlcc)ee.mlc=te.mlcc;if(te.mlw)ee.mlw=te.mlw;if(te.mrc)ee.mrc=te.mrc;if(te.dir)ee.dir=te.dir}ee._distinct=true;Z.entries.push([ee])}Z.entries.sort((function(e,t){return e[0].trace.index-t[0].trace.index}));Z.layer=v;Z._inHover=true;Z._groupTitleFont=G;b(r,Z);var re=v.select("g.legend");var ae=Y(r,re.node());var ne=ae.width+2*S;var ie=ae.height+2*S;var oe=e[0];var se=(oe.x0+oe.x1)/2;var le=(oe.y0+oe.y1)/2;var ue=!(m.traceIs(oe.trace,"bar-like")||m.traceIs(oe.trace,"box-violin"));var ce,fe;if(C==="y"){if(ue){fe=le-S;ce=le+S}else{fe=Math.min.apply(null,e.map((function(e){return Math.min(e.y0,e.y1)})));ce=Math.max.apply(null,e.map((function(e){return Math.max(e.y0,e.y1)})))}}else{fe=ce=o.mean(e.map((function(e){return(e.y0+e.y1)/2})))-ie/2}var he,pe;if(C==="x"){if(ue){he=se+S;pe=se-S}else{he=Math.max.apply(null,e.map((function(e){return Math.max(e.x0,e.x1)})));pe=Math.min.apply(null,e.map((function(e){return Math.min(e.x0,e.x1)})))}}else{he=pe=o.mean(e.map((function(e){return(e.x0+e.x1)/2})))-ne/2}var ve=E._offset;var de=L._offset;ce+=de;he+=ve;pe+=ve-ne;fe+=de-ie;var me,ge;if(he+ne<R&&he>=0){me=he}else if(pe+ne<R&&pe>=0){me=pe}else if(ve+ne<R){me=ve}else{if(he-se<se-pe+ne){me=R-ne}else{me=0}}me+=S;if(ce+ie<F&&ce>=0){ge=ce}else if(fe+ie<F&&fe>=0){ge=fe}else if(de+ie<F){ge=de}else{if(ce-le<le-fe+ie){ge=F-ie}else{ge=0}}ge+=S;re.attr("transform",s(me-1,ge-1));return re}var ye=v.selectAll("g.hovertext").data(e,(function(e){return I(e)}));ye.enter().append("g").classed("hovertext",true).each((function(){var e=a.select(this);e.append("rect").call(p.fill,p.addOpacity(f,.8));e.append("text").classed("name",true);e.append("path").style("stroke-width","1px");e.append("text").classed("nums",true).call(h.font,T,k)}));ye.exit().remove();ye.each((function(e){var t=a.select(this).attr("transform","");var o=e.color;if(Array.isArray(o)){o=o[e.eventData[0].pointNumber]}var v=e.bgcolor||o;var d=p.combine(p.opacity(v)?v:p.defaultLine,f);var m=p.combine(p.opacity(o)?o:p.defaultLine,f);var g=e.borderColor||p.contrast(d);var y=z(e,B,i,n,P,t);var x=y[0];var b=y[1];var w=t.select("text.nums").call(h.font,e.fontFamily||T,e.fontSize||k,e.fontColor||g).text(x).attr("data-notex",1).call(c.positionText,0,0).call(c.convertToTspans,r);var M=t.select("text.name");var E=0;var L=0;if(b&&b!==x){M.call(h.font,e.fontFamily||T,e.fontSize||k,m).text(b).attr("data-notex",1).call(c.positionText,0,0).call(c.convertToTspans,r);var C=Y(r,M.node());E=C.width+2*S;L=C.height+2*S}else{M.remove();t.select("rect").remove()}t.select("path").style({fill:d,stroke:g});var I=e.xa._offset+(e.x0+e.x1)/2;var O=e.ya._offset+(e.y0+e.y1)/2;var N=Math.abs(e.x1-e.x0);var j=Math.abs(e.y1-e.y0);var U=Y(r,w.node());var V=U.width/n._invScaleX;var H=U.height/n._invScaleY;e.ty0=(D-U.top)/n._invScaleY;e.bx=V+2*S;e.by=Math.max(H+2*S,L);e.anchor="start";e.txwidth=V;e.tx2width=E;e.offset=0;var q=(V+A+S+E)*n._invScaleX;var G,W;if(u){e.pos=I;G=O+j/2+q<=F;W=O-j/2-q>=0;if((e.idealAlign==="top"||!G)&&W){O-=j/2;e.anchor="end"}else if(G){O+=j/2;e.anchor="start"}else e.anchor="middle"}else{e.pos=O;G=I+N/2+q<=R;W=I-N/2-q>=0;if((e.idealAlign==="left"||!G)&&W){I-=N/2;e.anchor="end"}else if(G){I+=N/2;e.anchor="start"}else{e.anchor="middle";var X=q/2;var Z=I+X-R;var J=I-X;if(Z>0)I-=Z;if(J<0)I+=-J}}w.attr("text-anchor",e.anchor);if(E)M.attr("text-anchor",e.anchor);t.attr("transform",s(I,O)+(u?l(_):""))}));return ye}function z(e,t,r,a,n,i){var s="";var l="";if(e.nameOverride!==undefined)e.name=e.nameOverride;if(e.name){if(e.trace._meta){e.name=o.templateString(e.name,e.trace._meta)}s=U(e.name,e.nameLength)}var u=r.charAt(0);var c=u==="x"?"y":"x";if(e.zLabel!==undefined){if(e.xLabel!==undefined)l+="x: "+e.xLabel+"<br>";if(e.yLabel!==undefined)l+="y: "+e.yLabel+"<br>";if(e.trace.type!=="choropleth"&&e.trace.type!=="choroplethmapbox"){l+=(l?"z: ":"")+e.zLabel}}else if(t&&e[u+"Label"]===n){l=e[c+"Label"]||""}else if(e.xLabel===undefined){if(e.yLabel!==undefined&&e.trace.type!=="scattercarpet"){l=e.yLabel}}else if(e.yLabel===undefined)l=e.xLabel;else l="("+e.xLabel+", "+e.yLabel+")";if((e.text||e.text===0)&&!Array.isArray(e.text)){l+=(l?"<br>":"")+e.text}if(e.extraText!==undefined)l+=(l?"<br>":"")+e.extraText;if(i&&l===""&&!e.hovertemplate){if(s==="")i.remove();l=s}var f=e.hovertemplate||false;if(f){var h=e.hovertemplateLabels||e;if(e[u+"Label"]!==n){h[u+"other"]=h[u+"Val"];h[u+"otherLabel"]=h[u+"Label"]}l=o.hovertemplateString(f,h,a._d3locale,e.eventData[0]||{},e.trace._meta);l=l.replace(P,(function(t,r){s=U(r,e.nameLength);return""}))}return[l,s]}function D(e,t,r){var a=0;var n=1;var i=e.size();var o=new Array(i);var s=0;e.each((function(e){var a=e[t];var i=a._id.charAt(0)==="x";var l=a.range;if(s===0&&l&&l[0]>l[1]!==i){n=-1}o[s++]=[{datum:e,traceIndex:e.trace.index,dp:0,pos:e.pos,posref:e.posref,size:e.by*(i?T:1)/2,pmin:0,pmax:i?r.width:r.height}]}));o.sort((function(e,t){return e[0].posref-t[0].posref||n*(t[0].traceIndex-e[0].traceIndex)}));var l,u,c,f,h,p,v;function d(e){var t=e[0];var r=e[e.length-1];u=t.pmin-t.pos-t.dp+t.size;c=r.pos+r.dp+r.size-t.pmax;if(u>.01){for(h=e.length-1;h>=0;h--)e[h].dp+=u;l=false}if(c<.01)return;if(u<-.01){for(h=e.length-1;h>=0;h--)e[h].dp-=c;l=false}if(!l)return;var a=0;for(f=0;f<e.length;f++){p=e[f];if(p.pos+p.dp+p.size>t.pmax)a++}for(f=e.length-1;f>=0;f--){if(a<=0)break;p=e[f];if(p.pos>t.pmax-1){p.del=true;a--}}for(f=0;f<e.length;f++){if(a<=0)break;p=e[f];if(p.pos<t.pmin+1){p.del=true;a--;c=p.size*2;for(h=e.length-1;h>=0;h--)e[h].dp-=c}}for(f=e.length-1;f>=0;f--){if(a<=0)break;p=e[f];if(p.pos+p.dp+p.size>t.pmax){p.del=true;a--}}}while(!l&&a<=i){a++;l=true;f=0;while(f<o.length-1){var m=o[f];var g=o[f+1];var y=m[m.length-1];var x=g[0];u=y.pos+y.dp+y.size-x.pos-x.dp+x.size;if(u>.01&&y.pmin===x.pmin&&y.pmax===x.pmax){for(h=g.length-1;h>=0;h--)g[h].dp+=u;m.push.apply(m,g);o.splice(f+1,1);v=0;for(h=m.length-1;h>=0;h--)v+=m[h].dp;c=v/m.length;for(h=m.length-1;h>=0;h--)m[h].dp-=c;l=false}else f++}o.forEach(d)}for(f=o.length-1;f>=0;f--){var b=o[f];for(h=b.length-1;h>=0;h--){var _=b[h];var w=_.datum;w.offset=_.dp;w.del=_.del}}}function R(e,t,r,n){var i=function(e){return e*r};var o=function(e){return e*n};e.each((function(e){var r=a.select(this);if(e.del)return r.remove();var n=r.select("text.nums");var s=e.anchor;var l=s==="end"?-1:1;var u={start:1,end:-1,middle:0}[s];var f=u*(A+S);var p=f+u*(e.txwidth+S);var v=0;var d=e.offset;var m=s==="middle";if(m){f-=e.tx2width/2;p+=e.txwidth/2+S}if(t){d*=-M;v=e.offset*k}r.select("path").attr("d",m?"M-"+i(e.bx/2+e.tx2width/2)+","+o(d-e.by/2)+"h"+i(e.bx)+"v"+o(e.by)+"h-"+i(e.bx)+"Z":"M0,0L"+i(l*A+v)+","+o(A+d)+"v"+o(e.by/2-A)+"h"+i(l*e.bx)+"v-"+o(e.by)+"H"+i(l*A+v)+"V"+o(d-A)+"Z");var g=v+f;var y=d+e.ty0-e.by/2+S;var x=e.textAlign||"auto";if(x!=="auto"){if(x==="left"&&s!=="start"){n.attr("text-anchor","start");g=m?-e.bx/2-e.tx2width/2+S:-e.bx-S}else if(x==="right"&&s!=="end"){n.attr("text-anchor","end");g=m?e.bx/2-e.tx2width/2-S:e.bx+S}}n.call(c.positionText,i(g),o(y));if(e.tx2width){r.select("text.name").call(c.positionText,i(p+u*S+v),o(d+e.ty0-e.by/2+S));r.select("rect").call(h.setRect,i(p+(u-1)*e.tx2width/2+v),o(d-e.by/2-1),i(e.tx2width),o(e.by+2))}}))}function F(e,t){var r=e.index;var a=e.trace||{};var i=e.cd[0];var s=e.cd[r]||{};function l(e){return e||n(e)&&e===0}var u=Array.isArray(r)?function(e,t){var n=o.castOption(i,r,e);return l(n)?n:o.extractOption({},a,"",t)}:function(e,t){return o.extractOption(s,a,e,t)};function c(t,r,a){var n=u(r,a);if(l(n))e[t]=n}c("hoverinfo","hi","hoverinfo");c("bgcolor","hbg","hoverlabel.bgcolor");c("borderColor","hbc","hoverlabel.bordercolor");c("fontFamily","htf","hoverlabel.font.family");c("fontSize","hts","hoverlabel.font.size");c("fontColor","htc","hoverlabel.font.color");c("nameLength","hnl","hoverlabel.namelength");c("textAlign","hta","hoverlabel.align");e.posref=t==="y"||t==="closest"&&a.orientation==="h"?e.xa._offset+(e.x0+e.x1)/2:e.ya._offset+(e.y0+e.y1)/2;e.x0=o.constrain(e.x0,0,e.xa._length);e.x1=o.constrain(e.x1,0,e.xa._length);e.y0=o.constrain(e.y0,0,e.ya._length);e.y1=o.constrain(e.y1,0,e.ya._length);if(e.xLabelVal!==undefined){e.xLabel="xLabel"in e?e.xLabel:d.hoverLabelText(e.xa,e.xLabelVal,a.xhoverformat);e.xVal=e.xa.c2d(e.xLabelVal)}if(e.yLabelVal!==undefined){e.yLabel="yLabel"in e?e.yLabel:d.hoverLabelText(e.ya,e.yLabelVal,a.yhoverformat);e.yVal=e.ya.c2d(e.yLabelVal)}if(e.zLabelVal!==undefined&&e.zLabel===undefined){e.zLabel=String(e.zLabelVal)}if(!isNaN(e.xerr)&&!(e.xa.type==="log"&&e.xerr<=0)){var f=d.tickText(e.xa,e.xa.c2l(e.xerr),"hover").text;if(e.xerrneg!==undefined){e.xLabel+=" +"+f+" / -"+d.tickText(e.xa,e.xa.c2l(e.xerrneg),"hover").text}else e.xLabel+=" ± "+f;if(t==="x")e.distance+=1}if(!isNaN(e.yerr)&&!(e.ya.type==="log"&&e.yerr<=0)){var h=d.tickText(e.ya,e.ya.c2l(e.yerr),"hover").text;if(e.yerrneg!==undefined){e.yLabel+=" +"+h+" / -"+d.tickText(e.ya,e.ya.c2l(e.yerrneg),"hover").text}else e.yLabel+=" ± "+h;if(t==="y")e.distance+=1}var p=e.hoverinfo||e.trace.hoverinfo;if(p&&p!=="all"){p=Array.isArray(p)?p:p.split("+");if(p.indexOf("x")===-1)e.xLabel=undefined;if(p.indexOf("y")===-1)e.yLabel=undefined;if(p.indexOf("z")===-1)e.zLabel=undefined;if(p.indexOf("text")===-1)e.text=undefined;if(p.indexOf("name")===-1)e.name=undefined}return e}function B(e,t,r){var a=r.container;var n=r.fullLayout;var o=n._size;var s=r.event;var l=!!t.hLinePoint;var u=!!t.vLinePoint;var c,f;a.selectAll(".spikeline").remove();if(!(u||l))return;var v=p.combine(n.plot_bgcolor,n.paper_bgcolor);if(l){var m=t.hLinePoint;var g,y;c=m&&m.xa;f=m&&m.ya;var x=f.spikesnap;if(x==="cursor"){g=s.pointerX;y=s.pointerY}else{g=c._offset+m.x;y=f._offset+m.y}var b=i.readability(m.color,v)<1.5?p.contrast(v):m.color;var _=f.spikemode;var w=f.spikethickness;var T=f.spikecolor||b;var k=d.getPxPosition(e,f);var M,A;if(_.indexOf("toaxis")!==-1||_.indexOf("across")!==-1){if(_.indexOf("toaxis")!==-1){M=k;A=g}if(_.indexOf("across")!==-1){var S=f._counterDomainMin;var E=f._counterDomainMax;if(f.anchor==="free"){S=Math.min(S,f.position);E=Math.max(E,f.position)}M=o.l+S*o.w;A=o.l+E*o.w}a.insert("line",":first-child").attr({x1:M,x2:A,y1:y,y2:y,"stroke-width":w,stroke:T,"stroke-dasharray":h.dashStyle(f.spikedash,w)}).classed("spikeline",true).classed("crisp",true);a.insert("line",":first-child").attr({x1:M,x2:A,y1:y,y2:y,"stroke-width":w+2,stroke:v}).classed("spikeline",true).classed("crisp",true)}if(_.indexOf("marker")!==-1){a.insert("circle",":first-child").attr({cx:k+(f.side!=="right"?w:-w),cy:y,r:w,fill:T}).classed("spikeline",true)}}if(u){var L=t.vLinePoint;var C,I;c=L&&L.xa;f=L&&L.ya;var P=c.spikesnap;if(P==="cursor"){C=s.pointerX;I=s.pointerY}else{C=c._offset+L.x;I=f._offset+L.y}var O=i.readability(L.color,v)<1.5?p.contrast(v):L.color;var z=c.spikemode;var D=c.spikethickness;var R=c.spikecolor||O;var F=d.getPxPosition(e,c);var B,N;if(z.indexOf("toaxis")!==-1||z.indexOf("across")!==-1){if(z.indexOf("toaxis")!==-1){B=F;N=I}if(z.indexOf("across")!==-1){var j=c._counterDomainMin;var U=c._counterDomainMax;if(c.anchor==="free"){j=Math.min(j,c.position);U=Math.max(U,c.position)}B=o.t+(1-U)*o.h;N=o.t+(1-j)*o.h}a.insert("line",":first-child").attr({x1:C,x2:C,y1:B,y2:N,"stroke-width":D,stroke:R,"stroke-dasharray":h.dashStyle(c.spikedash,D)}).classed("spikeline",true).classed("crisp",true);a.insert("line",":first-child").attr({x1:C,x2:C,y1:B,y2:N,"stroke-width":D+2,stroke:v}).classed("spikeline",true).classed("crisp",true)}if(z.indexOf("marker")!==-1){a.insert("circle",":first-child").attr({cx:C,cy:F-(c.side!=="top"?D:-D),r:D,fill:R}).classed("spikeline",true)}}}function N(e,t,r){if(!r||r.length!==e._hoverdata.length)return true;for(var a=r.length-1;a>=0;a--){var n=r[a];var i=e._hoverdata[a];if(n.curveNumber!==i.curveNumber||String(n.pointNumber)!==String(i.pointNumber)||String(n.pointNumbers)!==String(i.pointNumbers)){return true}}return false}function j(e,t){if(!t)return true;if(t.vLinePoint!==e._spikepoints.vLinePoint||t.hLinePoint!==e._spikepoints.hLinePoint)return true;return false}function U(e,t){return c.plainText(e||"",{len:t,allowedTags:["br","sub","sup","b","i","em"]})}function V(e,t){var r=t.charAt(0);var a=[];var n=[];var i=[];for(var o=0;o<e.length;o++){var s=e[o];if(m.traceIs(s.trace,"bar-like")||m.traceIs(s.trace,"box-violin")){i.push(s)}else if(s.trace[r+"period"]){n.push(s)}else{a.push(s)}}return a.concat(n).concat(i)}function H(e,t,r){var a=t[e+"a"];var n=t[e+"Val"];var i=t.cd[0];if(a.type==="category")n=a._categoriesMap[n];else if(a.type==="date"){var o=t.trace[e+"periodalignment"];if(o){var s=t.cd[t.index];var l=s[e+"Start"];if(l===undefined)l=s[e];var u=s[e+"End"];if(u===undefined)u=s[e];var c=u-l;if(o==="end"){n+=c}else if(o==="middle"){n+=c/2}}n=a.d2c(n)}if(i&&i.t&&i.t.posLetter===a._id){if(r.boxmode==="group"||r.violinmode==="group"){n+=i.t.dPos}}return n}function q(e){return e.offsetTop+e.clientTop}function G(e){return e.offsetLeft+e.clientLeft}function Y(e,t){var r=e._fullLayout;var a=t.getBoundingClientRect();var n=a.x;var i=a.y;var s=n+a.width;var l=i+a.height;var u=o.apply3DTransform(r._invTransform)(n,i);var c=o.apply3DTransform(r._invTransform)(s,l);var f=u[0];var h=u[1];var p=c[0];var v=c[1];return{x:f,y:h,width:p-f,height:v-h,top:Math.min(h,v),left:Math.min(f,p),right:Math.max(f,p),bottom:Math.max(h,v)}}},{"../../lib":787,"../../lib/events":776,"../../lib/override_cursor":798,"../../lib/svg_text_utils":813,"../../plots/cartesian/axes":838,"../../registry":915,"../color":650,"../dragelement":669,"../drawing":672,"../legend/defaults":702,"../legend/draw":703,"./constants":684,"./helpers":686,"@plotly/d3":58,"fast-isnumeric":246,tinycolor2:583}],688:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("../color");var i=e("./helpers").isUnifiedHover;t.exports=function e(t,r,o,s){s=s||{};function l(e){if(!s.font[e]){s.font[e]=r.legend?r.legend.font[e]:r.font[e]}}if(r&&i(r.hovermode)){if(!s.font)s.font={};l("size");l("family");l("color");if(r.legend){if(!s.bgcolor)s.bgcolor=n.combine(r.legend.bgcolor,r.paper_bgcolor);if(!s.bordercolor)s.bordercolor=r.legend.bordercolor}else{if(!s.bgcolor)s.bgcolor=r.paper_bgcolor}}o("hoverlabel.bgcolor",s.bgcolor);o("hoverlabel.bordercolor",s.bordercolor);o("hoverlabel.namelength",s.namelength);a.coerceFont(o,"hoverlabel.font",s.font);o("hoverlabel.align",s.align)}},{"../../lib":787,"../color":650,"./helpers":686}],689:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("./layout_attributes");t.exports=function e(t,r){function i(e,i){if(r[e]!==undefined)return r[e];return a.coerce(t,r,n,e,i)}i("clickmode");return i("hovermode")}},{"../../lib":787,"./layout_attributes":691}],690:[function(e,t,r){"use strict";var a=e("@plotly/d3");var n=e("../../lib");var i=e("../dragelement");var o=e("./helpers");var s=e("./layout_attributes");var l=e("./hover");t.exports={moduleType:"component",name:"fx",constants:e("./constants"),schema:{layout:s},attributes:e("./attributes"),layoutAttributes:s,supplyLayoutGlobalDefaults:e("./layout_global_defaults"),supplyDefaults:e("./defaults"),supplyLayoutDefaults:e("./layout_defaults"),calc:e("./calc"),getDistanceFunction:o.getDistanceFunction,getClosest:o.getClosest,inbox:o.inbox,quadrature:o.quadrature,appendArrayPointValue:o.appendArrayPointValue,castHoverOption:c,castHoverinfo:f,hover:l.hover,unhover:i.unhover,loneHover:l.loneHover,loneUnhover:u,click:e("./click")};function u(e){var t=n.isD3Selection(e)?e:a.select(e);t.selectAll("g.hovertext").remove();t.selectAll(".spikeline").remove()}function c(e,t,r){return n.castOption(e,t,"hoverlabel."+r)}function f(e,t,r){function a(r){return n.coerceHoverinfo({hoverinfo:r},{_module:e._module},t)}return n.castOption(e,r,"hoverinfo",a)}},{"../../lib":787,"../dragelement":669,"./attributes":681,"./calc":682,"./click":683,"./constants":684,"./defaults":685,"./helpers":686,"./hover":687,"./layout_attributes":691,"./layout_defaults":692,"./layout_global_defaults":693,"@plotly/d3":58}],691:[function(e,t,r){"use strict";var a=e("./constants");var n=e("../../plots/font_attributes")({editType:"none"});n.family.dflt=a.HOVERFONT;n.size.dflt=a.HOVERFONTSIZE;t.exports={clickmode:{valType:"flaglist",flags:["event","select"],dflt:"event",editType:"plot",extras:["none"]},dragmode:{valType:"enumerated",values:["zoom","pan","select","lasso","drawclosedpath","drawopenpath","drawline","drawrect","drawcircle","orbit","turntable",false],dflt:"zoom",editType:"modebar"},hovermode:{valType:"enumerated",values:["x","y","closest",false,"x unified","y unified"],dflt:"closest",editType:"modebar"},hoverdistance:{valType:"integer",min:-1,dflt:20,editType:"none"},spikedistance:{valType:"integer",min:-1,dflt:-1,editType:"none"},hoverlabel:{bgcolor:{valType:"color",editType:"none"},bordercolor:{valType:"color",editType:"none"},font:n,align:{valType:"enumerated",values:["left","right","auto"],dflt:"auto",editType:"none"},namelength:{valType:"integer",min:-1,dflt:15,editType:"none"},editType:"none"},selectdirection:{valType:"enumerated",values:["h","v","d","any"],dflt:"any",editType:"none"}}},{"../../plots/font_attributes":867,"./constants":684}],692:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("./layout_attributes");var i=e("./hovermode_defaults");var o=e("./hoverlabel_defaults");t.exports=function e(t,r){function s(e,i){return a.coerce(t,r,n,e,i)}var l=i(t,r);if(l){s("hoverdistance");s("spikedistance")}var u=s("dragmode");if(u==="select")s("selectdirection");var c=r._has("mapbox");var f=r._has("geo");var h=r._basePlotModules.length;if(r.dragmode==="zoom"&&((c||f)&&h===1||c&&f&&h===2)){r.dragmode="pan"}o(t,r,s)}},{"../../lib":787,"./hoverlabel_defaults":688,"./hovermode_defaults":689,"./layout_attributes":691}],693:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("./hoverlabel_defaults");var i=e("./layout_attributes");t.exports=function e(t,r){function o(e,n){return a.coerce(t,r,i,e,n)}n(t,r,o)}},{"../../lib":787,"./hoverlabel_defaults":688,"./layout_attributes":691}],694:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("../../lib/regex").counter;var i=e("../../plots/domain").attributes;var o=e("../../plots/cartesian/constants").idRegex;var s=e("../../plot_api/plot_template");var l={rows:{valType:"integer",min:1,editType:"plot"},roworder:{valType:"enumerated",values:["top to bottom","bottom to top"],dflt:"top to bottom",editType:"plot"},columns:{valType:"integer",min:1,editType:"plot"},subplots:{valType:"info_array",freeLength:true,dimensions:2,items:{valType:"enumerated",values:[n("xy").toString(),""],editType:"plot"},editType:"plot"},xaxes:{valType:"info_array",freeLength:true,items:{valType:"enumerated",values:[o.x.toString(),""],editType:"plot"},editType:"plot"},yaxes:{valType:"info_array",freeLength:true,items:{valType:"enumerated",values:[o.y.toString(),""],editType:"plot"},editType:"plot"},pattern:{valType:"enumerated",values:["independent","coupled"],dflt:"coupled",editType:"plot"},xgap:{valType:"number",min:0,max:1,editType:"plot"},ygap:{valType:"number",min:0,max:1,editType:"plot"},domain:i({name:"grid",editType:"plot",noGridCell:true},{}),xside:{valType:"enumerated",values:["bottom","bottom plot","top plot","top"],dflt:"bottom plot",editType:"plot"},yside:{valType:"enumerated",values:["left","left plot","right plot","right"],dflt:"left plot",editType:"plot"},editType:"plot"};function u(e,t,r){var a=t[r+"axes"];var n=Object.keys((e._splomAxes||{})[r]||{});if(Array.isArray(a))return a;if(n.length)return n}function c(e,t){var r=e.grid||{};var n=u(t,r,"x");var i=u(t,r,"y");if(!e.grid&&!n&&!i)return;var o=Array.isArray(r.subplots)&&Array.isArray(r.subplots[0]);var c=Array.isArray(n);var h=Array.isArray(i);var p=c&&n!==r.xaxes&&h&&i!==r.yaxes;var v,d;if(o){v=r.subplots.length;d=r.subplots[0].length}else{if(h)v=i.length;if(c)d=n.length}var m=s.newContainer(t,"grid");function g(e,t){return a.coerce(r,m,l,e,t)}var y=g("rows",v);var x=g("columns",d);if(!(y*x>1)){delete t.grid;return}if(!o&&!c&&!h){var b=g("pattern")==="independent";if(b)o=true}m._hasSubplotGrid=o;var _=g("roworder");var w=_==="top to bottom";var T=o?.2:.1;var k=o?.3:.1;var M,A;if(p&&t._splomGridDflt){M=t._splomGridDflt.xside;A=t._splomGridDflt.yside}m._domains={x:f("x",g,T,M,x),y:f("y",g,k,A,y,w)}}function f(e,t,r,a,n,i){var o=t(e+"gap",r);var s=t("domain."+e);t(e+"side",a);var l=new Array(n);var u=s[0];var c=(s[1]-u)/(n-o);var f=c*(1-o);for(var h=0;h<n;h++){var p=u+c*h;l[i?n-1-h:h]=[p,p+f]}return l}function h(e,t){var r=t.grid;if(!r||!r._domains)return;var a=e.grid||{};var n=t._subplots;var i=r._hasSubplotGrid;var o=r.rows;var s=r.columns;var l=r.pattern==="independent";var c,f,h,v,d,m,g;var y=r._axisMap={};if(i){var x=a.subplots||[];m=r.subplots=new Array(o);var b=1;for(c=0;c<o;c++){var _=m[c]=new Array(s);var w=x[c]||[];for(f=0;f<s;f++){if(l){d=b===1?"xy":"x"+b+"y"+b;b++}else d=w[f];_[f]="";if(n.cartesian.indexOf(d)!==-1){g=d.indexOf("y");h=d.slice(0,g);v=d.slice(g);if(y[h]!==undefined&&y[h]!==f||y[v]!==undefined&&y[v]!==c){continue}_[f]=d;y[h]=f;y[v]=c}}}}else{var T=u(t,a,"x");var k=u(t,a,"y");r.xaxes=p(T,n.xaxis,s,y,"x");r.yaxes=p(k,n.yaxis,o,y,"y")}var M=r._anchors={};var A=r.roworder==="top to bottom";for(var S in y){var E=S.charAt(0);var L=r[E+"side"];var C,I,P;if(L.length<8){M[S]="free"}else if(E==="x"){if(L.charAt(0)==="t"===A){C=0;I=1;P=o}else{C=o-1;I=-1;P=-1}if(i){var O=y[S];for(c=C;c!==P;c+=I){d=m[c][O];if(!d)continue;g=d.indexOf("y");if(d.slice(0,g)===S){M[S]=d.slice(g);break}}}else{for(c=C;c!==P;c+=I){v=r.yaxes[c];if(n.cartesian.indexOf(S+v)!==-1){M[S]=v;break}}}}else{if(L.charAt(0)==="l"){C=0;I=1;P=s}else{C=s-1;I=-1;P=-1}if(i){var z=y[S];for(c=C;c!==P;c+=I){d=m[z][c];if(!d)continue;g=d.indexOf("y");if(d.slice(g)===S){M[S]=d.slice(0,g);break}}}else{for(c=C;c!==P;c+=I){h=r.xaxes[c];if(n.cartesian.indexOf(h+S)!==-1){M[S]=h;break}}}}}}function p(e,t,r,a,n){var i=new Array(r);var o;function s(e,r){if(t.indexOf(r)!==-1&&a[r]===undefined){i[e]=r;a[r]=e}else i[e]=""}if(Array.isArray(e)){for(o=0;o<r;o++){s(o,e[o])}}else{s(0,n);for(o=1;o<r;o++){s(o,n+(o+1))}}return i}t.exports={moduleType:"component",name:"grid",schema:{layout:{grid:l}},layoutAttributes:l,sizeDefaults:c,contentDefaults:h}},{"../../lib":787,"../../lib/regex":804,"../../plot_api/plot_template":827,"../../plots/cartesian/constants":845,"../../plots/domain":866}],695:[function(e,t,r){"use strict";var a=e("../../plots/cartesian/constants");var n=e("../../plot_api/plot_template").templatedArray;var i=e("../../constants/axis_placeable_objects");t.exports=n("image",{visible:{valType:"boolean",dflt:true,editType:"arraydraw"},source:{valType:"string",editType:"arraydraw"},layer:{valType:"enumerated",values:["below","above"],dflt:"above",editType:"arraydraw"},sizex:{valType:"number",dflt:0,editType:"arraydraw"},sizey:{valType:"number",dflt:0,editType:"arraydraw"},sizing:{valType:"enumerated",values:["fill","contain","stretch"],dflt:"contain",editType:"arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},x:{valType:"any",dflt:0,editType:"arraydraw"},y:{valType:"any",dflt:0,editType:"arraydraw"},xanchor:{valType:"enumerated",values:["left","center","right"],dflt:"left",editType:"arraydraw"},yanchor:{valType:"enumerated",values:["top","middle","bottom"],dflt:"top",editType:"arraydraw"},xref:{valType:"enumerated",values:["paper",a.idRegex.x.toString()],dflt:"paper",editType:"arraydraw"},yref:{valType:"enumerated",values:["paper",a.idRegex.y.toString()],dflt:"paper",editType:"arraydraw"},editType:"arraydraw"})},{"../../constants/axis_placeable_objects":756,"../../plot_api/plot_template":827,"../../plots/cartesian/constants":845}],696:[function(e,t,r){"use strict";var a=e("fast-isnumeric");var n=e("../../lib/to_log_range");t.exports=function e(t,r,i,o){r=r||{};var s=i==="log"&&r.type==="linear";var l=i==="linear"&&r.type==="log";if(!(s||l))return;var u=t._fullLayout.images;var c=r._id.charAt(0);var f;var h;for(var p=0;p<u.length;p++){f=u[p];h="images["+p+"].";if(f[c+"ref"]===r._id){var v=f[c];var d=f["size"+c];var m=null;var g=null;if(s){m=n(v,r.range);var y=d/Math.pow(10,m)/2;g=2*Math.log(y+Math.sqrt(1+y*y))/Math.LN10}else{m=Math.pow(10,v);g=m*(Math.pow(10,d/2)-Math.pow(10,-d/2))}if(!a(m)){m=null;g=null}else if(!a(g))g=null;o(h+c,m);o(h+"size"+c,g)}}}},{"../../lib/to_log_range":815,"fast-isnumeric":246}],697:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("../../plots/cartesian/axes");var i=e("../../plots/array_container_defaults");var o=e("./attributes");var s="images";t.exports=function e(t,r){var a={name:s,handleItemDefaults:l};i(t,r,a)};function l(e,t,r){function i(r,n){return a.coerce(e,t,o,r,n)}var s=i("source");var l=i("visible",!!s);if(!l)return t;i("layer");i("xanchor");i("yanchor");i("sizex");i("sizey");i("sizing");i("opacity");var u={_fullLayout:r};var c=["x","y"];for(var f=0;f<2;f++){var h=c[f];var p=n.coerceRef(e,t,u,h,"paper",undefined);if(p!=="paper"){var v=n.getFromId(u,p);v._imgIndices.push(t._index)}n.coercePosition(t,u,i,p,h,0)}return t}},{"../../lib":787,"../../plots/array_container_defaults":833,"../../plots/cartesian/axes":838,"./attributes":695}],698:[function(e,t,r){"use strict";var a=e("@plotly/d3");var n=e("../drawing");var i=e("../../plots/cartesian/axes");var o=e("../../plots/cartesian/axis_ids");var s=e("../../constants/xmlns_namespaces");t.exports=function e(t){var r=t._fullLayout;var l=[];var u={};var c=[];var f;var h;for(h=0;h<r.images.length;h++){var p=r.images[h];if(p.visible){if(p.layer==="below"&&p.xref!=="paper"&&p.yref!=="paper"){f=o.ref2id(p.xref)+o.ref2id(p.yref);var v=r._plots[f];if(!v){c.push(p);continue}if(v.mainplot){f=v.mainplot.id}if(!u[f]){u[f]=[]}u[f].push(p)}else if(p.layer==="above"){l.push(p)}else{c.push(p)}}}var d={x:{left:{sizing:"xMin",offset:0},center:{sizing:"xMid",offset:-1/2},right:{sizing:"xMax",offset:-1}},y:{top:{sizing:"YMin",offset:0},middle:{sizing:"YMid",offset:-1/2},bottom:{sizing:"YMax",offset:-1}}};function m(e){var r=a.select(this);if(this._imgSrc===e.source){return}r.attr("xmlns",s.svg);if(e.source&&e.source.slice(0,5)==="data:"){r.attr("xlink:href",e.source);this._imgSrc=e.source}else{var n=new Promise(function(t){var a=new Image;this.img=a;a.setAttribute("crossOrigin","anonymous");a.onerror=n;a.onload=function(){var e=document.createElement("canvas");e.width=this.width;e.height=this.height;var a=e.getContext("2d");a.drawImage(this,0,0);var n=e.toDataURL("image/png");r.attr("xlink:href",n);t()};r.on("error",n);a.src=e.source;this._imgSrc=e.source;function n(){r.remove();t()}}.bind(this));t._promises.push(n)}}function g(e){var o=a.select(this);var s=i.getFromId(t,e.xref);var l=i.getFromId(t,e.yref);var u=i.getRefType(e.xref)==="domain";var c=i.getRefType(e.yref)==="domain";var f=r._size;var h,p;if(s!==undefined){h=typeof e.xref==="string"&&u?s._length*e.sizex:Math.abs(s.l2p(e.sizex)-s.l2p(0))}else{h=e.sizex*f.w}if(l!==undefined){p=typeof e.yref==="string"&&c?l._length*e.sizey:Math.abs(l.l2p(e.sizey)-l.l2p(0))}else{p=e.sizey*f.h}var v=h*d.x[e.xanchor].offset;var m=p*d.y[e.yanchor].offset;var g=d.x[e.xanchor].sizing+d.y[e.yanchor].sizing;var y,x;if(s!==undefined){y=typeof e.xref==="string"&&u?s._length*e.x+s._offset:s.r2p(e.x)+s._offset}else{y=e.x*f.w+f.l}y+=v;if(l!==undefined){x=typeof e.yref==="string"&&c?l._length*(1-e.y)+l._offset:l.r2p(e.y)+l._offset}else{x=f.h-e.y*f.h+f.t}x+=m;switch(e.sizing){case"fill":g+=" slice";break;case"stretch":g="none";break}o.attr({x:y,y:x,width:h,height:p,preserveAspectRatio:g,opacity:e.opacity});var b=s&&i.getRefType(e.xref)!=="domain"?s._id:"";var _=l&&i.getRefType(e.yref)!=="domain"?l._id:"";var w=b+_;n.setClipUrl(o,w?"clip"+r._uid+w:null,t)}var y=r._imageLowerLayer.selectAll("image").data(c);var x=r._imageUpperLayer.selectAll("image").data(l);y.enter().append("image");x.enter().append("image");y.exit().remove();x.exit().remove();y.each((function(e){m.bind(this)(e);g.bind(this)(e)}));x.each((function(e){m.bind(this)(e);g.bind(this)(e)}));var b=Object.keys(r._plots);for(h=0;h<b.length;h++){f=b[h];var _=r._plots[f];if(!_.imagelayer)continue;var w=_.imagelayer.selectAll("image").data(u[f]||[]);w.enter().append("image");w.exit().remove();w.each((function(e){m.bind(this)(e);g.bind(this)(e)}))}}},{"../../constants/xmlns_namespaces":764,"../../plots/cartesian/axes":838,"../../plots/cartesian/axis_ids":842,"../drawing":672,"@plotly/d3":58}],699:[function(e,t,r){"use strict";t.exports={moduleType:"component",name:"images",layoutAttributes:e("./attributes"),supplyLayoutDefaults:e("./defaults"),includeBasePlot:e("../../plots/cartesian/include_components")("images"),draw:e("./draw"),convertCoords:e("./convert_coords")}},{"../../plots/cartesian/include_components":851,"./attributes":695,"./convert_coords":696,"./defaults":697,"./draw":698}],700:[function(e,t,r){"use strict";var a=e("../../plots/font_attributes");var n=e("../color/attributes");t.exports={bgcolor:{valType:"color",editType:"legend"},bordercolor:{valType:"color",dflt:n.defaultLine,editType:"legend"},borderwidth:{valType:"number",min:0,dflt:0,editType:"legend"},font:a({editType:"legend"}),orientation:{valType:"enumerated",values:["v","h"],dflt:"v",editType:"legend"},traceorder:{valType:"flaglist",flags:["reversed","grouped"],extras:["normal"],editType:"legend"},tracegroupgap:{valType:"number",min:0,dflt:10,editType:"legend"},itemsizing:{valType:"enumerated",values:["trace","constant"],dflt:"trace",editType:"legend"},itemwidth:{valType:"number",min:30,dflt:30,editType:"legend"},itemclick:{valType:"enumerated",values:["toggle","toggleothers",false],dflt:"toggle",editType:"legend"},itemdoubleclick:{valType:"enumerated",values:["toggle","toggleothers",false],dflt:"toggleothers",editType:"legend"},groupclick:{valType:"enumerated",values:["toggleitem","togglegroup"],dflt:"togglegroup",editType:"legend"},x:{valType:"number",min:-2,max:3,editType:"legend"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left",editType:"legend"},y:{valType:"number",min:-2,max:3,editType:"legend"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],editType:"legend"},uirevision:{valType:"any",editType:"none"},valign:{valType:"enumerated",values:["top","middle","bottom"],dflt:"middle",editType:"legend"},title:{text:{valType:"string",dflt:"",editType:"legend"},font:a({editType:"legend"}),side:{valType:"enumerated",values:["top","left","top left"],editType:"legend"},editType:"legend"},editType:"legend"}},{"../../plots/font_attributes":867,"../color/attributes":649}],701:[function(e,t,r){"use strict";t.exports={scrollBarWidth:6,scrollBarMinHeight:20,scrollBarColor:"#808BA4",scrollBarMargin:4,scrollBarEnterAttrs:{rx:20,ry:3,width:0,height:0},titlePad:2,itemGap:5}},{}],702:[function(e,t,r){"use strict";var a=e("../../registry");var n=e("../../lib");var i=e("../../plot_api/plot_template");var o=e("./attributes");var s=e("../../plots/layout_attributes");var l=e("./helpers");t.exports=function e(t,r,u){var c=t.legend||{};var f=0;var h=false;var p="normal";for(var v=0;v<u.length;v++){var d=u[v];if(!d.visible)continue;if(d.showlegend||d._dfltShowLegend&&!(d._module&&d._module.attributes&&d._module.attributes.showlegend&&d._module.attributes.showlegend.dflt===false)){f++;if(d.showlegend){h=true;if(a.traceIs(d,"pie-like")||d._input.showlegend===true){f++}}}if(a.traceIs(d,"bar")&&r.barmode==="stack"||["tonextx","tonexty"].indexOf(d.fill)!==-1){p=l.isGrouped({traceorder:p})?"grouped+reversed":"reversed"}if(d.legendgroup!==undefined&&d.legendgroup!==""){p=l.isReversed({traceorder:p})?"reversed+grouped":"grouped"}}var m=n.coerce(t,r,s,"showlegend",h&&f>1);if(m===false&&!c.uirevision)return;var g=i.newContainer(r,"legend");function y(e,t){return n.coerce(c,g,o,e,t)}y("uirevision",r.uirevision);if(m===false)return;y("bgcolor",r.paper_bgcolor);y("bordercolor");y("borderwidth");var x=n.coerceFont(y,"font",r.font);var b=y("orientation");var _=b==="h";var w,T,k;if(_){w=0;if(a.getComponentMethod("rangeslider","isVisible")(t.xaxis)){T=1.1;k="bottom"}else{T=-.1;k="top"}}else{w=1.02;T=1;k="auto"}y("traceorder",p);if(l.isGrouped(r.legend))y("tracegroupgap");y("itemsizing");y("itemwidth");y("itemclick");y("itemdoubleclick");y("groupclick");y("x",w);y("xanchor");y("y",T);y("yanchor",k);y("valign");n.noneOrAll(c,g,["x","y"]);var M=y("title.text");if(M){y("title.side",_?"left":"top");var A=n.extendFlat({},x,{size:n.bigFont(x.size)});n.coerceFont(y,"title.font",A)}}},{"../../lib":787,"../../plot_api/plot_template":827,"../../plots/layout_attributes":892,"../../registry":915,"./attributes":700,"./helpers":706}],703:[function(e,t,r){"use strict";var a=e("@plotly/d3");var n=e("../../lib");var i=e("../../plots/plots");var o=e("../../registry");var s=e("../../lib/events");var l=e("../dragelement");var u=e("../drawing");var c=e("../color");var f=e("../../lib/svg_text_utils");var h=e("./handle_click");var p=e("./constants");var v=e("../../constants/alignment");var d=v.LINE_SPACING;var m=v.FROM_TL;var g=v.FROM_BR;var y=e("./get_legend_data");var x=e("./style");var b=e("./helpers");var _=1;t.exports=function e(t,r){if(!r)r=t._fullLayout.legend||{};return w(t,r)};function w(e,t){var r=e._fullLayout;var s="legend"+r._uid;var f;var h=t._inHover;if(h){f=t.layer;s+="-hover"}else{f=r._infolayer}if(!f)return;if(!e._legendMouseDownTime)e._legendMouseDownTime=0;var v;if(!h){if(!e.calcdata)return;v=r.showlegend&&y(e.calcdata,t)}else{if(!t.entries)return;v=y(t.entries,t)}var d=r.hiddenlabels||[];if(!h&&(!r.showlegend||!v.length)){f.selectAll(".legend").remove();r._topdefs.select("#"+s).remove();return i.autoMargin(e,"legend")}var g=n.ensureSingle(f,"g","legend",(function(e){if(!h)e.attr("pointer-events","all")}));var b=n.ensureSingleById(r._topdefs,"clipPath",s,(function(e){e.append("rect")}));var w=n.ensureSingle(g,"rect","bg",(function(e){e.attr("shape-rendering","crispEdges")}));w.call(c.stroke,t.bordercolor).call(c.fill,t.bgcolor).style("stroke-width",t.borderwidth+"px");var M=n.ensureSingle(g,"g","scrollbox");var E=t.title;t._titleWidth=0;t._titleHeight=0;if(E.text){var L=n.ensureSingle(M,"text","legendtitletext");L.attr("text-anchor","start").call(u.font,E.font).text(E.text);S(L,M,e,t,_)}else{M.selectAll(".legendtitletext").remove()}var z=n.ensureSingle(g,"rect","scrollbar",(function(e){e.attr(p.scrollBarEnterAttrs).call(c.fill,p.scrollBarColor)}));var D=M.selectAll("g.groups").data(v);D.enter().append("g").attr("class","groups");D.exit().remove();var R=D.selectAll("g.traces").data(n.identity);R.enter().append("g").attr("class","traces");R.exit().remove();R.style("opacity",(function(e){var t=e[0].trace;if(o.traceIs(t,"pie-like")){return d.indexOf(e[0].label)!==-1?.5:1}else{return t.visible==="legendonly"?.5:1}})).each((function(){a.select(this).call(k,e,t)})).call(x,e,t).each((function(){if(!h)a.select(this).call(A,e)}));n.syncOrAsync([i.previousPromises,function(){return C(e,D,R,t)},function(){if(!h&&I(e))return;var i=r._size;var c=t.borderwidth;var v=i.l+i.w*t.x-m[P(t)]*t._width;var d=i.t+i.h*(1-t.y)-m[O(t)]*t._effHeight;if(!h&&r.margin.autoexpand){var y=v;var x=d;v=n.constrain(v,0,r.width-t._width);d=n.constrain(d,0,r.height-t._effHeight);if(v!==y){n.log("Constrain legend.x to make legend fit inside graph")}if(d!==x){n.log("Constrain legend.y to make legend fit inside graph")}}if(!h)u.setTranslate(g,v,d);z.on(".drag",null);g.on("wheel",null);if(h||t._height<=t._maxHeight||e._context.staticPlot){var _=t._effHeight;if(h)_=t._height;w.attr({width:t._width-c,height:_-c,x:c/2,y:c/2});u.setTranslate(M,0,0);b.select("rect").attr({width:t._width-2*c,height:_-2*c,x:c,y:c});u.setClipUrl(M,s,e);u.setRect(z,0,0,0,0);delete t._scrollY}else{var k=Math.max(p.scrollBarMinHeight,t._effHeight*t._effHeight/t._height);var A=t._effHeight-k-2*p.scrollBarMargin;var S=t._height-t._effHeight;var E=A/S;var L=Math.min(t._scrollY||0,S);w.attr({width:t._width-2*c+p.scrollBarWidth+p.scrollBarMargin,height:t._effHeight-c,x:c/2,y:c/2});b.select("rect").attr({width:t._width-2*c+p.scrollBarWidth+p.scrollBarMargin,height:t._effHeight-2*c,x:c,y:c+L});u.setClipUrl(M,s,e);U(L,k,E);g.on("wheel",(function(){L=n.constrain(t._scrollY+a.event.deltaY/A*S,0,S);U(L,k,E);if(L!==0&&L!==S){a.event.preventDefault()}}));var C,D,R;var F=function(e,t,r){var a=(r-t)/E+e;return n.constrain(a,0,S)};var B=function(e,t,r){var a=(t-r)/E+e;return n.constrain(a,0,S)};var N=a.behavior.drag().on("dragstart",(function(){var e=a.event.sourceEvent;if(e.type==="touchstart"){C=e.changedTouches[0].clientY}else{C=e.clientY}R=L})).on("drag",(function(){var e=a.event.sourceEvent;if(e.buttons===2||e.ctrlKey)return;if(e.type==="touchmove"){D=e.changedTouches[0].clientY}else{D=e.clientY}L=F(R,C,D);U(L,k,E)}));z.call(N);var j=a.behavior.drag().on("dragstart",(function(){var e=a.event.sourceEvent;if(e.type==="touchstart"){C=e.changedTouches[0].clientY;R=L}})).on("drag",(function(){var e=a.event.sourceEvent;if(e.type==="touchmove"){D=e.changedTouches[0].clientY;L=B(R,C,D);U(L,k,E)}}));M.call(j)}function U(r,a,n){t._scrollY=e._fullLayout.legend._scrollY=r;u.setTranslate(M,0,-r);u.setRect(z,t._width,p.scrollBarMargin+r*n,p.scrollBarWidth,a);b.select("rect").attr("y",c+r)}if(e._context.edits.legendPosition){var V,H,q,G;g.classed("cursor-move",true);l.init({element:g.node(),gd:e,prepFn:function(){var e=u.getTranslate(g);q=e.x;G=e.y},moveFn:function(e,r){var a=q+e;var n=G+r;u.setTranslate(g,a,n);V=l.align(a,0,i.l,i.l+i.w,t.xanchor);H=l.align(n,0,i.t+i.h,i.t,t.yanchor)},doneFn:function(){if(V!==undefined&&H!==undefined){o.call("_guiRelayout",e,{"legend.x":V,"legend.y":H})}},clickFn:function(t,r){var a=f.selectAll("g.traces").filter((function(){var e=this.getBoundingClientRect();return r.clientX>=e.left&&r.clientX<=e.right&&r.clientY>=e.top&&r.clientY<=e.bottom}));if(a.size()>0){T(e,g,a,t,r)}}})}}],e)}function T(e,t,r,a,n){var i=r.data()[0][0].trace;var l={event:n,node:r.node(),curveNumber:i.index,expandedIndex:i._expandedIndex,data:e.data,layout:e.layout,frames:e._transitionData._frames,config:e._context,fullData:e._fullData,fullLayout:e._fullLayout};if(i._group){l.group=i._group}if(o.traceIs(i,"pie-like")){l.label=r.datum()[0].label}var u=s.triggerHandler(e,"plotly_legendclick",l);if(u===false)return;if(a===1){t._clickTimeout=setTimeout((function(){if(!e._fullLayout)return;h(r,e,a)}),e._context.doubleClickDelay)}else if(a===2){if(t._clickTimeout)clearTimeout(t._clickTimeout);e._legendMouseDownTime=0;var c=s.triggerHandler(e,"plotly_legenddoubleclick",l);if(c!==false)h(r,e,a)}}function k(e,t,r){var a=e.data()[0][0];var i=a.trace;var s=o.traceIs(i,"pie-like");var l=!r._inHover&&t._context.edits.legendText&&!s;var c=r._maxNameLength;var h,v;if(a.groupTitle){h=a.groupTitle.text;v=a.groupTitle.font}else{v=r.font;if(!r.entries){h=s?a.label:i.name;if(i._meta){h=n.templateString(h,i._meta)}}else{h=a.text}}var d=n.ensureSingle(e,"text","legendtext");d.attr("text-anchor","start").call(u.font,v).text(l?M(h,c):h);var m=r.itemwidth+p.itemGap*2;f.positionText(d,m,0);if(l){d.call(f.makeEditable,{gd:t,text:h}).call(S,e,t,r).on("edit",(function(s){this.text(M(s,c)).call(S,e,t,r);var l=a.trace._fullInput||{};var u={};if(o.hasTransform(l,"groupby")){var f=o.getTransformIndices(l,"groupby");var h=f[f.length-1];var p=n.keyedContainer(l,"transforms["+h+"].styles","target","value.name");p.set(a.trace._group,s);u=p.constructUpdate()}else{u.name=s}return o.call("_guiRestyle",t,u,i.index)}))}else{S(d,e,t,r)}}function M(e,t){var r=Math.max(4,t);if(e&&e.trim().length>=r/2)return e;e=e||"";for(var a=r-e.length;a>0;a--)e+=" ";return e}function A(e,t){var r=t._context.doubleClickDelay;var i;var o=1;var s=n.ensureSingle(e,"rect","legendtoggle",(function(e){if(!t._context.staticPlot){e.style("cursor","pointer").attr("pointer-events","all")}e.call(c.fill,"rgba(0,0,0,0)")}));if(t._context.staticPlot)return;s.on("mousedown",(function(){i=(new Date).getTime();if(i-t._legendMouseDownTime<r){o+=1}else{o=1;t._legendMouseDownTime=i}}));s.on("mouseup",(function(){if(t._dragged||t._editing)return;var n=t._fullLayout.legend;if((new Date).getTime()-t._legendMouseDownTime>r){o=Math.max(o-1,1)}T(t,n,e,o,a.event)}))}function S(e,t,r,a,n){if(a._inHover)e.attr("data-notex",true);f.convertToTspans(e,r,(function(){E(t,r,a,n)}))}function E(e,t,r,a){var n=e.data()[0][0];if(!r._inHover&&n&&!n.trace.showlegend){e.remove();return}var i=e.select("g[class*=math-group]");var o=i.node();if(!r)r=t._fullLayout.legend;var s=r.borderwidth;var l;if(a===_){l=r.title.font}else if(n.groupTitle){l=n.groupTitle.font}else{l=r.font}var c=l.size*d;var h,v;if(o){var m=u.bBox(o);h=m.height;v=m.width;if(a===_){u.setTranslate(i,s,s+h*.75)}else{u.setTranslate(i,0,h*.25)}}else{var g=e.select(a===_?".legendtitletext":".legendtext");var y=f.lineCount(g);var x=g.node();h=c*y;v=x?u.bBox(x).width:0;if(a===_){if(r.title.side==="left"){v+=p.itemGap*2}f.positionText(g,s+p.titlePad,s+c)}else{var b=p.itemGap*2+r.itemwidth;if(n.groupTitle){b=p.itemGap;v-=r.itemwidth}f.positionText(g,b,-c*((y-1)/2-.3))}}if(a===_){r._titleWidth=v;r._titleHeight=h}else{n.lineHeight=c;n.height=Math.max(h,16)+3;n.width=v}}function L(e){var t=0;var r=0;var a=e.title.side;if(a){if(a.indexOf("left")!==-1){t=e._titleWidth}if(a.indexOf("top")!==-1){r=e._titleHeight}}return[t,r]}function C(e,t,r,n){var i=e._fullLayout;if(!n)n=i.legend;var o=i._size;var s=b.isVertical(n);var l=b.isGrouped(n);var c=n.borderwidth;var f=2*c;var h=p.itemGap;var v=n.itemwidth+h*2;var d=2*(c+h);var m=O(n);var g=n.y<0||n.y===0&&m==="top";var y=n.y>1||n.y===1&&m==="bottom";var x=n.tracegroupgap;n._maxHeight=Math.max(g||y?i.height/2:o.h,30);var _=0;n._width=0;n._height=0;var w=L(n);if(s){r.each((function(e){var t=e[0].height;u.setTranslate(this,c+w[0],c+w[1]+n._height+t/2+h);n._height+=t;n._width=Math.max(n._width,e[0].width)}));_=v+n._width;n._width+=h+v+f;n._height+=d;if(l){t.each((function(e,t){u.setTranslate(this,0,t*n.tracegroupgap)}));n._height+=(n._lgroupsLength-1)*n.tracegroupgap}}else{var T=P(n);var k=n.x<0||n.x===0&&T==="right";var M=n.x>1||n.x===1&&T==="left";var A=y||g;var S=i.width/2;n._maxWidth=Math.max(k?A&&T==="left"?o.l+o.w:S:M?A&&T==="right"?o.r+o.w:S:o.w,2*v);var E=0;var C=0;r.each((function(e){var t=e[0].width+v;E=Math.max(E,t);C+=t}));_=null;var I=0;if(l){var z=0;var D=0;var R=0;t.each((function(){var e=0;var t=0;a.select(this).selectAll("g.traces").each((function(r){var a=r[0].height;u.setTranslate(this,w[0],w[1]+c+h+a/2+t);t+=a;e=Math.max(e,v+r[0].width)}));z=Math.max(z,t);var r=e+h;if(r+c+D>n._maxWidth){I=Math.max(I,D);D=0;R+=z+x;z=t}u.setTranslate(this,D,R);D+=r}));n._width=Math.max(I,D)+c;n._height=R+z+d}else{var F=r.size();var B=C+f+(F-1)*h<n._maxWidth;var N=0;var j=0;var U=0;var V=0;r.each((function(e){var t=e[0].height;var r=v+e[0].width;var a=(B?r:E)+h;if(a+c+j-h>=n._maxWidth){I=Math.max(I,V);j=0;U+=N;n._height+=N;N=0}u.setTranslate(this,w[0]+c+j,w[1]+c+U+t/2+h);V=j+r+h;j+=a;N=Math.max(N,t)}));if(B){n._width=j+f;n._height=N+d}else{n._width=Math.max(I,V)+f;n._height+=N+d}}}n._width=Math.ceil(Math.max(n._width+w[0],n._titleWidth+2*(c+p.titlePad)));n._height=Math.ceil(Math.max(n._height+w[1],n._titleHeight+2*(c+p.itemGap)));n._effHeight=Math.min(n._height,n._maxHeight);var H=e._context.edits;var q=H.legendText||H.legendPosition;r.each((function(e){var t=a.select(this).select(".legendtoggle");var r=e[0].height;var n=q?v:_||v+e[0].width;if(!s)n+=h/2;u.setRect(t,0,-r/2,n,r)}))}function I(e){var t=e._fullLayout;var r=t.legend;var a=P(r);var n=O(r);return i.autoMargin(e,"legend",{x:r.x,y:r.y,l:r._width*m[a],r:r._width*g[a],b:r._effHeight*g[n],t:r._effHeight*m[n]})}function P(e){return n.isRightAnchor(e)?"right":n.isCenterAnchor(e)?"center":"left"}function O(e){return n.isBottomAnchor(e)?"bottom":n.isMiddleAnchor(e)?"middle":"top"}},{"../../constants/alignment":755,"../../lib":787,"../../lib/events":776,"../../lib/svg_text_utils":813,"../../plots/plots":901,"../../registry":915,"../color":650,"../dragelement":669,"../drawing":672,"./constants":701,"./get_legend_data":704,"./handle_click":705,"./helpers":706,"./style":708,"@plotly/d3":58}],704:[function(e,t,r){"use strict";var a=e("../../registry");var n=e("./helpers");t.exports=function e(t,r){var i=r._inHover;var o=n.isGrouped(r);var s=n.isReversed(r);var l={};var u=[];var c=false;var f={};var h=0;var p=0;var v,d;function m(e,t){if(e===""||!n.isGrouped(r)){var a="~~i"+h;u.push(a);l[a]=[t];h++}else if(u.indexOf(e)===-1){u.push(e);c=true;l[e]=[t]}else{l[e].push(t)}}for(v=0;v<t.length;v++){var g=t[v];var y=g[0];var x=y.trace;var b=x.legendgroup;if(!i&&(!x.visible||!x.showlegend))continue;if(a.traceIs(x,"pie-like")){if(!f[b])f[b]={};for(d=0;d<g.length;d++){var _=g[d].label;if(!f[b][_]){m(b,{label:_,color:g[d].color,i:g[d].i,trace:x,pts:g[d].pts});f[b][_]=true;p=Math.max(p,(_||"").length)}}}else{m(b,y);p=Math.max(p,(x.name||"").length)}}if(!u.length)return[];var w=!c||!o;var T=[];for(v=0;v<u.length;v++){var k=l[u[v]];if(w){T.push(k[0])}else{T.push(k)}}if(w)T=[T];for(v=0;v<T.length;v++){var M=Infinity;for(d=0;d<T[v].length;d++){var A=T[v][d].trace.legendrank;if(M>A)M=A}T[v][0]._groupMinRank=M;T[v][0]._preGroupSort=v}var S=function(e,t){return e[0]._groupMinRank-t[0]._groupMinRank||e[0]._preGroupSort-t[0]._preGroupSort};var E=function(e,t){return e.trace.legendrank-t.trace.legendrank||e._preSort-t._preSort};T.forEach((function(e,t){e[0]._preGroupSort=t}));T.sort(S);for(v=0;v<T.length;v++){T[v].forEach((function(e,t){e._preSort=t}));T[v].sort(E);var L=T[v][0].trace;var C=null;for(d=0;d<T[v].length;d++){var I=T[v][d].trace.legendgrouptitle;if(I&&I.text){C=I;if(i)I.font=r._groupTitleFont;break}}if(s)T[v].reverse();if(C){var P=false;for(d=0;d<T[v].length;d++){if(a.traceIs(T[v][d].trace,"pie-like")){P=true;break}}T[v].unshift({i:-1,groupTitle:C,noClick:P,trace:{showlegend:L.showlegend,legendgroup:L.legendgroup,visible:r.groupclick==="toggleitem"?true:L.visible}})}for(d=0;d<T[v].length;d++){T[v][d]=[T[v][d]]}}r._lgroupsLength=T.length;r._maxNameLength=p;return T}},{"../../registry":915,"./helpers":706}],705:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("../../registry");var i=true;t.exports=function e(t,r,o){var s=r._fullLayout;if(r._dragged||r._editing)return;var l=s.legend.itemclick;var u=s.legend.itemdoubleclick;var c=s.legend.groupclick;if(o===1&&l==="toggle"&&u==="toggleothers"&&i&&r.data&&r._context.showTips){a.notifier(a._(r,"Double-click on legend to isolate one trace"),"long");i=false}else{i=false}var f;if(o===1)f=l;else if(o===2)f=u;if(!f)return;var h=c==="togglegroup";var p=s.hiddenlabels?s.hiddenlabels.slice():[];var v=t.data()[0][0];if(v.groupTitle&&v.noClick)return;var d=r._fullData;var m=v.trace;var g=m.legendgroup;var y,x,b,_,w,T;var k={};var M=[];var A=[];var S=[];function E(e,t,r){var a=M.indexOf(e);var n=k[t];if(!n){n=k[t]=[]}if(M.indexOf(e)===-1){M.push(e);a=M.length-1}n[a]=r;return a}function L(e,t){if(v.groupTitle&&!h)return;var r=e._fullInput;if(n.hasTransform(r,"groupby")){var i=A[r.index];if(!i){var o=n.getTransformIndices(r,"groupby");var s=o[o.length-1];i=a.keyedContainer(r,"transforms["+s+"].styles","target","value.visible");A[r.index]=i}var l=i.get(e._group);if(l===undefined){l=true}if(l!==false){i.set(e._group,t)}S[r.index]=E(r.index,"visible",r.visible===false?false:true)}else{var u=r.visible===false?false:t;E(r.index,"visible",u)}}if(n.traceIs(m,"pie-like")){var C=v.label;var I=p.indexOf(C);if(f==="toggle"){if(I===-1)p.push(C);else p.splice(I,1)}else if(f==="toggleothers"){p=[];r.calcdata[0].forEach((function(e){if(C!==e.label){p.push(e.label)}}));if(r._fullLayout.hiddenlabels&&r._fullLayout.hiddenlabels.length===p.length&&I===-1){p=[]}}n.call("_guiRelayout",r,"hiddenlabels",p)}else{var P=g&&g.length;var O=[];var z;if(P){for(y=0;y<d.length;y++){z=d[y];if(!z.visible)continue;if(z.legendgroup===g){O.push(y)}}}if(f==="toggle"){var D;switch(m.visible){case true:D="legendonly";break;case false:D=false;break;case"legendonly":D=true;break}if(P){if(h){for(y=0;y<d.length;y++){if(d[y].visible!==false&&d[y].legendgroup===g){L(d[y],D)}}}else{L(m,D)}}else{L(m,D)}}else if(f==="toggleothers"){var R,F,B,N;var j=true;for(y=0;y<d.length;y++){R=d[y]===m;B=d[y].showlegend!==true;if(R||B)continue;F=P&&d[y].legendgroup===g;if(!F&&d[y].visible===true&&!n.traceIs(d[y],"notLegendIsolatable")){j=false;break}}for(y=0;y<d.length;y++){if(d[y].visible===false)continue;if(n.traceIs(d[y],"notLegendIsolatable")){continue}switch(m.visible){case"legendonly":L(d[y],true);break;case true:N=j?true:"legendonly";R=d[y]===m;B=d[y].showlegend!==true&&!d[y].legendgroup;F=R||P&&d[y].legendgroup===g;L(d[y],F||B?true:N);break}}}for(y=0;y<A.length;y++){b=A[y];if(!b)continue;var U=b.constructUpdate();var V=Object.keys(U);for(x=0;x<V.length;x++){_=V[x];T=k[_]=k[_]||[];T[S[y]]=U[_]}}w=Object.keys(k);for(y=0;y<w.length;y++){_=w[y];for(x=0;x<M.length;x++){if(!k[_].hasOwnProperty(x)){k[_][x]=undefined}}}n.call("_guiRestyle",r,k,M)}}},{"../../lib":787,"../../registry":915}],706:[function(e,t,r){"use strict";r.isGrouped=function e(t){return(t.traceorder||"").indexOf("grouped")!==-1};r.isVertical=function e(t){return t.orientation!=="h"};r.isReversed=function e(t){return(t.traceorder||"").indexOf("reversed")!==-1}},{}],707:[function(e,t,r){"use strict";t.exports={moduleType:"component",name:"legend",layoutAttributes:e("./attributes"),supplyLayoutDefaults:e("./defaults"),draw:e("./draw"),style:e("./style")}},{"./attributes":700,"./defaults":702,"./draw":703,"./style":708}],708:[function(e,t,r){"use strict";var a=e("@plotly/d3");var n=e("../../registry");var i=e("../../lib");var o=i.strTranslate;var s=e("../drawing");var l=e("../color");var u=e("../colorscale/helpers").extractOpts;var c=e("../../traces/scatter/subtypes");var f=e("../../traces/pie/style_one");var h=e("../../traces/pie/helpers").castOption;var p=e("./constants");var v=12;var d=5;var m=2;var g=10;var y=5;t.exports=function e(t,r,w){var T=r._fullLayout;if(!w)w=T.legend;var k=w.itemsizing==="constant";var M=w.itemwidth;var A=(M+p.itemGap*2)/2;var S=o(A,0);var E=function(e,t,r,a){var n;if(e+1){n=e}else if(t&&t.width>0){n=t.width}else{return 0}return k?a:Math.min(n,r)};t.each((function(e){var t=a.select(this);var r=i.ensureSingle(t,"g","layers");r.style("opacity",e[0].trace.opacity);var n=w.valign;var s=e[0].lineHeight;var l=e[0].height;if(n==="middle"||!s||!l){r.attr("transform",null)}else{var u={top:1,bottom:-1}[n];var c=u*(.5*(s-l+3));r.attr("transform",o(0,c))}var f=r.selectAll("g.legendfill").data([e]);f.enter().append("g").classed("legendfill",true);var h=r.selectAll("g.legendlines").data([e]);h.enter().append("g").classed("legendlines",true);var p=r.selectAll("g.legendsymbols").data([e]);p.enter().append("g").classed("legendsymbols",true);p.selectAll("g.legendpoints").data([e]).enter().append("g").classed("legendpoints",true)})).each(U).each(I).each(O).each(P).each(D).each(N).each(B).each(L).each(C).each(R).each(F);function L(e){var t=b(e);var n=t.showFill;var o=t.showLine;var l=t.showGradientLine;var f=t.showGradientFill;var h=t.anyFill;var p=t.anyLine;var v=e[0];var m=v.trace;var y,_;var w=u(m);var T=w.colorscale;var k=w.reversescale;var A=function(e){if(e.size()){var t="legendfill-"+m.uid;s.gradient(e,r,t,x(k),T,"fill")}};var S=function(e){if(e.size()){var t="legendline-"+m.uid;s.lineGroupStyle(e);s.gradient(e,r,t,x(k),T,"stroke")}};var L=c.hasMarkers(m)||!h?"M5,0":p?"M5,-2":"M5,-3";var C=a.select(this);var I=C.select(".legendfill").selectAll("path").data(n||f?[e]:[]);I.enter().append("path").classed("js-fill",true);I.exit().remove();I.attr("d",L+"h"+M+"v6h-"+M+"z").call(n?s.fillGroupStyle:A);if(o||l){var P=E(undefined,m.line,g,d);_=i.minExtend(m,{line:{width:P}});y=[i.minExtend(v,{trace:_})]}var O=C.select(".legendlines").selectAll("path").data(o||l?[y]:[]);O.enter().append("path").classed("js-line",true);O.exit().remove();O.attr("d",L+(l?"l"+M+",0.0001":"h"+M)).call(o?s.lineGroupStyle:S)}function C(e){var t=b(e);var n=t.anyFill;var o=t.anyLine;var l=t.showLine;var u=t.showMarker;var f=e[0];var h=f.trace;var p=!u&&!o&&!n&&c.hasText(h);var g,y;function x(e,t,r,a){var n=i.nestedProperty(h,e).get();var o=i.isArrayOrTypedArray(n)&&t?t(n):n;if(k&&o&&a!==undefined){o=a}if(r){if(o<r[0])return r[0];else if(o>r[1])return r[1]}return o}function _(e){if(f._distinct&&f.index&&e[f.index])return e[f.index];return e[0]}if(u||p||l){var w={};var T={};if(u){w.mc=x("marker.color",_);w.mx=x("marker.symbol",_);w.mo=x("marker.opacity",i.mean,[.2,1]);w.mlc=x("marker.line.color",_);w.mlw=x("marker.line.width",i.mean,[0,5],m);T.marker={sizeref:1,sizemin:1,sizemode:"diameter"};var M=x("marker.size",i.mean,[2,16],v);w.ms=M;T.marker.size=M}if(l){T.line={width:x("line.width",_,[0,10],d)}}if(p){w.tx="Aa";w.tp=x("textposition",_);w.ts=10;w.tc=x("textfont.color",_);w.tf=x("textfont.family",_)}g=[i.minExtend(f,w)];y=i.minExtend(h,T);y.selectedpoints=null;y.texttemplate=null}var A=a.select(this).select("g.legendpoints");var E=A.selectAll("path.scatterpts").data(u?g:[]);E.enter().insert("path",":first-child").classed("scatterpts",true).attr("transform",S);E.exit().remove();E.call(s.pointStyle,y,r);if(u)g[0].mrc=3;var L=A.selectAll("g.pointtext").data(p?g:[]);L.enter().append("g").classed("pointtext",true).append("text").attr("transform",S);L.exit().remove();L.selectAll("text").call(s.textPointStyle,y,r)}function I(e){var t=e[0].trace;var r=t.type==="waterfall";if(e[0]._distinct&&r){var n=e[0].trace[e[0].dir].marker;e[0].mc=n.color;e[0].mlw=n.line.width;e[0].mlc=n.line.color;return z(e,this,"waterfall")}var i=[];if(t.visible&&r){i=e[0].hasTotals?[["increasing","M-6,-6V6H0Z"],["totals","M6,6H0L-6,-6H-0Z"],["decreasing","M6,6V-6H0Z"]]:[["increasing","M-6,-6V6H6Z"],["decreasing","M6,6V-6H-6Z"]]}var o=a.select(this).select("g.legendpoints").selectAll("path.legendwaterfall").data(i);o.enter().append("path").classed("legendwaterfall",true).attr("transform",S).style("stroke-miterlimit",1);o.exit().remove();o.each((function(e){var r=a.select(this);var n=t[e[0]].marker;var i=E(undefined,n.line,y,m);r.attr("d",e[1]).style("stroke-width",i+"px").call(l.fill,n.color);if(i){r.call(l.stroke,n.line.color)}}))}function P(e){z(e,this)}function O(e){z(e,this,"funnel")}function z(e,t,i){var o=e[0].trace;var c=o.marker||{};var f=c.line||{};var h=!i?n.traceIs(o,"bar"):o.visible&&o.type===i;var p=a.select(t).select("g.legendpoints").selectAll("path.legend"+i).data(h?[e]:[]);p.enter().append("path").classed("legend"+i,true).attr("d","M6,6H-6V-6H6Z").attr("transform",S);p.exit().remove();p.each((function(e){var t=a.select(this);var n=e[0];var i=E(n.mlw,c.line,y,m);t.style("stroke-width",i+"px");var h=n.mcc;if(!w._inHover&&"mc"in n){var p=u(c);var v=p.mid;if(v===undefined)v=(p.max+p.min)/2;h=s.tryColorscale(c,"")(v)}var d=h||n.mc||c.color;var g=c.pattern;var x=g&&s.getPatternAttr(g.shape,0,"");if(x){var b=s.getPatternAttr(g.bgcolor,0,null);var T=s.getPatternAttr(g.fgcolor,0,null);var k=g.fgopacity;var M=_(g.size,8,10);var A=_(g.solidity,.5,1);var S="legend-"+o.uid;t.call(s.pattern,"legend",r,S,x,M,A,h,g.fillmode,b,T,k)}else{t.call(l.fill,d)}if(i)l.stroke(t,n.mlc||f.color)}))}function D(e){var t=e[0].trace;var o=a.select(this).select("g.legendpoints").selectAll("path.legendbox").data(t.visible&&n.traceIs(t,"box-violin")?[e]:[]);o.enter().append("path").classed("legendbox",true).attr("d","M6,6H-6V-6H6Z").attr("transform",S);o.exit().remove();o.each((function(){var e=a.select(this);if((t.boxpoints==="all"||t.points==="all")&&l.opacity(t.fillcolor)===0&&l.opacity((t.line||{}).color)===0){var n=i.minExtend(t,{marker:{size:k?v:i.constrain(t.marker.size,2,16),sizeref:1,sizemin:1,sizemode:"diameter"}});o.call(s.pointStyle,n,r)}else{var u=E(undefined,t.line,y,m);e.style("stroke-width",u+"px").call(l.fill,t.fillcolor);if(u)l.stroke(e,t.line.color)}}))}function R(e){var t=e[0].trace;var r=a.select(this).select("g.legendpoints").selectAll("path.legendcandle").data(t.visible&&t.type==="candlestick"?[e,e]:[]);r.enter().append("path").classed("legendcandle",true).attr("d",(function(e,t){if(t)return"M-15,0H-8M-8,6V-6H8Z";return"M15,0H8M8,-6V6H-8Z"})).attr("transform",S).style("stroke-miterlimit",1);r.exit().remove();r.each((function(e,r){var n=a.select(this);var i=t[r?"increasing":"decreasing"];var o=E(undefined,i.line,y,m);n.style("stroke-width",o+"px").call(l.fill,i.fillcolor);if(o)l.stroke(n,i.line.color)}))}function F(e){var t=e[0].trace;var r=a.select(this).select("g.legendpoints").selectAll("path.legendohlc").data(t.visible&&t.type==="ohlc"?[e,e]:[]);r.enter().append("path").classed("legendohlc",true).attr("d",(function(e,t){if(t)return"M-15,0H0M-8,-6V0";return"M15,0H0M8,6V0"})).attr("transform",S).style("stroke-miterlimit",1);r.exit().remove();r.each((function(e,r){var n=a.select(this);var i=t[r?"increasing":"decreasing"];var o=E(undefined,i.line,y,m);n.style("fill","none").call(s.dashLine,i.line.dash,o);if(o)l.stroke(n,i.line.color)}))}function B(e){j(e,this,"pie")}function N(e){j(e,this,"funnelarea")}function j(e,t,r){var o=e[0];var s=o.trace;var l=!r?n.traceIs(s,r):s.visible&&s.type===r;var u=a.select(t).select("g.legendpoints").selectAll("path.legend"+r).data(l?[e]:[]);u.enter().append("path").classed("legend"+r,true).attr("d","M6,6H-6V-6H6Z").attr("transform",S);u.exit().remove();if(u.size()){var c=(s.marker||{}).line;var p=E(h(c.width,o.pts),c,y,m);var v=i.minExtend(s,{marker:{line:{width:p}}});v.marker.line.color=c.color;var d=i.minExtend(o,{trace:v});f(u,d,v)}}function U(e){var t=e[0].trace;var n;var o=[];if(t.visible){switch(t.type){case"histogram2d":case"heatmap":o=[["M-15,-2V4H15V-2Z"]];n=true;break;case"choropleth":case"choroplethmapbox":o=[["M-6,-6V6H6V-6Z"]];n=true;break;case"densitymapbox":o=[["M-6,0 a6,6 0 1,0 12,0 a 6,6 0 1,0 -12,0"]];n="radial";break;case"cone":o=[["M-6,2 A2,2 0 0,0 -6,6 V6L6,4Z"],["M-6,-6 A2,2 0 0,0 -6,-2 L6,-4Z"],["M-6,-2 A2,2 0 0,0 -6,2 L6,0Z"]];n=false;break;case"streamtube":o=[["M-6,2 A2,2 0 0,0 -6,6 H6 A2,2 0 0,1 6,2 Z"],["M-6,-6 A2,2 0 0,0 -6,-2 H6 A2,2 0 0,1 6,-6 Z"],["M-6,-2 A2,2 0 0,0 -6,2 H6 A2,2 0 0,1 6,-2 Z"]];n=false;break;case"surface":o=[["M-6,-6 A2,3 0 0,0 -6,0 H6 A2,3 0 0,1 6,-6 Z"],["M-6,1 A2,3 0 0,1 -6,6 H6 A2,3 0 0,0 6,0 Z"]];n=true;break;case"mesh3d":o=[["M-6,6H0L-6,-6Z"],["M6,6H0L6,-6Z"],["M-6,-6H6L0,6Z"]];n=false;break;case"volume":o=[["M-6,6H0L-6,-6Z"],["M6,6H0L6,-6Z"],["M-6,-6H6L0,6Z"]];n=true;break;case"isosurface":o=[["M-6,6H0L-6,-6Z"],["M6,6H0L6,-6Z"],["M-6,-6 A12,24 0 0,0 6,-6 L0,6Z"]];n=false;break}}var c=a.select(this).select("g.legendpoints").selectAll("path.legend3dandfriends").data(o);c.enter().append("path").classed("legend3dandfriends",true).attr("transform",S).style("stroke-miterlimit",1);c.exit().remove();c.each((function(e,o){var c=a.select(this);var f=u(t);var h=f.colorscale;var p=f.reversescale;var v=function(e){if(e.size()){var a="legendfill-"+t.uid;s.gradient(e,r,a,x(p,n==="radial"),h,"fill")}};var d;if(!h){var m=t.vertexcolor||t.facecolor||t.color;d=i.isArrayOrTypedArray(m)?m[o]||m[0]:m}else{if(!n){var g=h.length;d=o===0?h[p?g-1:0][1]:o===1?h[p?0:g-1][1]:h[Math.floor((g-1)/2)][1]}}c.attr("d",e[0]);if(d){c.call(l.fill,d)}else{c.call(v)}}))}};function x(e,t){var r=t?"radial":"horizontal";return r+(e?"":"reversed")}function b(e){var t=e[0].trace;var r=t.contours;var a=c.hasLines(t);var n=c.hasMarkers(t);var i=t.visible&&t.fill&&t.fill!=="none";var o=false;var s=false;if(r){var l=r.coloring;if(l==="lines"){o=true}else{a=l==="none"||l==="heatmap"||r.showlines}if(r.type==="constraint"){i=r._operation!=="="}else if(l==="fill"||l==="heatmap"){s=true}}return{showMarker:n,showLine:a,showFill:i,showGradientLine:o,showGradientFill:s,anyLine:a||o,anyFill:i||s}}function _(e,t,r){if(e&&i.isArrayOrTypedArray(e))return t;if(e>r)return r;return e}},{"../../lib":787,"../../registry":915,"../../traces/pie/helpers":1181,"../../traces/pie/style_one":1187,"../../traces/scatter/subtypes":1227,"../color":650,"../colorscale/helpers":661,"../drawing":672,"./constants":701,"@plotly/d3":58}],709:[function(e,t,r){"use strict";var a=e("./constants");t.exports={editType:"modebar",orientation:{valType:"enumerated",values:["v","h"],dflt:"h",editType:"modebar"},bgcolor:{valType:"color",editType:"modebar"},color:{valType:"color",editType:"modebar"},activecolor:{valType:"color",editType:"modebar"},uirevision:{valType:"any",editType:"none"},add:{valType:"string",arrayOk:true,dflt:"",editType:"modebar"},remove:{valType:"string",arrayOk:true,dflt:"",editType:"modebar"}}},{"./constants":711}],710:[function(e,t,r){"use strict";var a=e("../../registry");var n=e("../../plots/plots");var i=e("../../plots/cartesian/axis_ids");var o=e("../../fonts/ploticon");var s=e("../shapes/draw").eraseActiveShape;var l=e("../../lib");var u=l._;var c=t.exports={};c.toImage={name:"toImage",title:function(e){var t=e._context.toImageButtonOptions||{};var r=t.format||"png";return r==="png"?u(e,"Download plot as a png"):u(e,"Download plot")},icon:o.camera,click:function(e){var t=e._context.toImageButtonOptions;var r={format:t.format||"png"};l.notifier(u(e,"Taking snapshot - this may take a few seconds"),"long");if(r.format!=="svg"&&l.isIE()){l.notifier(u(e,"IE only supports svg.  Changing format to svg."),"long");r.format="svg"}["filename","width","height","scale"].forEach((function(e){if(e in t){r[e]=t[e]}}));a.call("downloadImage",e,r).then((function(t){l.notifier(u(e,"Snapshot succeeded")+" - "+t,"long")})).catch((function(){l.notifier(u(e,"Sorry, there was a problem downloading your snapshot!"),"long")}))}};c.sendDataToCloud={name:"sendDataToCloud",title:function(e){return u(e,"Edit in Chart Studio")},icon:o.disk,click:function(e){n.sendDataToCloud(e)}};c.editInChartStudio={name:"editInChartStudio",title:function(e){return u(e,"Edit in Chart Studio")},icon:o.pencil,click:function(e){n.sendDataToCloud(e)}};c.zoom2d={name:"zoom2d",_cat:"zoom",title:function(e){return u(e,"Zoom")},attr:"dragmode",val:"zoom",icon:o.zoombox,click:f};c.pan2d={name:"pan2d",_cat:"pan",title:function(e){return u(e,"Pan")},attr:"dragmode",val:"pan",icon:o.pan,click:f};c.select2d={name:"select2d",_cat:"select",title:function(e){return u(e,"Box Select")},attr:"dragmode",val:"select",icon:o.selectbox,click:f};c.lasso2d={name:"lasso2d",_cat:"lasso",title:function(e){return u(e,"Lasso Select")},attr:"dragmode",val:"lasso",icon:o.lasso,click:f};c.drawclosedpath={name:"drawclosedpath",title:function(e){return u(e,"Draw closed freeform")},attr:"dragmode",val:"drawclosedpath",icon:o.drawclosedpath,click:f};c.drawopenpath={name:"drawopenpath",title:function(e){return u(e,"Draw open freeform")},attr:"dragmode",val:"drawopenpath",icon:o.drawopenpath,click:f};c.drawline={name:"drawline",title:function(e){return u(e,"Draw line")},attr:"dragmode",val:"drawline",icon:o.drawline,click:f};c.drawrect={name:"drawrect",title:function(e){return u(e,"Draw rectangle")},attr:"dragmode",val:"drawrect",icon:o.drawrect,click:f};c.drawcircle={name:"drawcircle",title:function(e){return u(e,"Draw circle")},attr:"dragmode",val:"drawcircle",icon:o.drawcircle,click:f};c.eraseshape={name:"eraseshape",title:function(e){return u(e,"Erase active shape")},icon:o.eraseshape,click:s};c.zoomIn2d={name:"zoomIn2d",_cat:"zoomin",title:function(e){return u(e,"Zoom in")},attr:"zoom",val:"in",icon:o.zoom_plus,click:f};c.zoomOut2d={name:"zoomOut2d",_cat:"zoomout",title:function(e){return u(e,"Zoom out")},attr:"zoom",val:"out",icon:o.zoom_minus,click:f};c.autoScale2d={name:"autoScale2d",_cat:"autoscale",title:function(e){return u(e,"Autoscale")},attr:"zoom",val:"auto",icon:o.autoscale,click:f};c.resetScale2d={name:"resetScale2d",_cat:"resetscale",title:function(e){return u(e,"Reset axes")},attr:"zoom",val:"reset",icon:o.home,click:f};c.hoverClosestCartesian={name:"hoverClosestCartesian",_cat:"hoverclosest",title:function(e){return u(e,"Show closest data on hover")},attr:"hovermode",val:"closest",icon:o.tooltip_basic,gravity:"ne",click:f};c.hoverCompareCartesian={name:"hoverCompareCartesian",_cat:"hoverCompare",title:function(e){return u(e,"Compare data on hover")},attr:"hovermode",val:function(e){return e._fullLayout._isHoriz?"y":"x"},icon:o.tooltip_compare,gravity:"ne",click:f};function f(e,t){var r=t.currentTarget;var n=r.getAttribute("data-attr");var o=r.getAttribute("data-val")||true;var s=e._fullLayout;var l={};var u=i.list(e,null,true);var c=s._cartesianSpikesEnabled;var f,h;if(n==="zoom"){var p=o==="in"?.5:2;var v=(1+p)/2;var d=(1-p)/2;var m;for(h=0;h<u.length;h++){f=u[h];if(!f.fixedrange){m=f._name;if(o==="auto"){l[m+".autorange"]=true}else if(o==="reset"){if(f._rangeInitial===undefined){l[m+".autorange"]=true}else{var g=f._rangeInitial.slice();l[m+".range[0]"]=g[0];l[m+".range[1]"]=g[1]}if(f._showSpikeInitial!==undefined){l[m+".showspikes"]=f._showSpikeInitial;if(c==="on"&&!f._showSpikeInitial){c="off"}}}else{var y=[f.r2l(f.range[0]),f.r2l(f.range[1])];var x=[v*y[0]+d*y[1],v*y[1]+d*y[0]];l[m+".range[0]"]=f.l2r(x[0]);l[m+".range[1]"]=f.l2r(x[1])}}}}else{if(n==="hovermode"&&(o==="x"||o==="y")){o=s._isHoriz?"y":"x";r.setAttribute("data-val",o)}l[n]=o}s._cartesianSpikesEnabled=c;a.call("_guiRelayout",e,l)}c.zoom3d={name:"zoom3d",_cat:"zoom",title:function(e){return u(e,"Zoom")},attr:"scene.dragmode",val:"zoom",icon:o.zoombox,click:h};c.pan3d={name:"pan3d",_cat:"pan",title:function(e){return u(e,"Pan")},attr:"scene.dragmode",val:"pan",icon:o.pan,click:h};c.orbitRotation={name:"orbitRotation",title:function(e){return u(e,"Orbital rotation")},attr:"scene.dragmode",val:"orbit",icon:o["3d_rotate"],click:h};c.tableRotation={name:"tableRotation",title:function(e){return u(e,"Turntable rotation")},attr:"scene.dragmode",val:"turntable",icon:o["z-axis"],click:h};function h(e,t){var r=t.currentTarget;var n=r.getAttribute("data-attr");var i=r.getAttribute("data-val")||true;var o=e._fullLayout._subplots.gl3d||[];var s={};var l=n.split(".");for(var u=0;u<o.length;u++){s[o[u]+"."+l[1]]=i}var c=i==="pan"?i:"zoom";s.dragmode=c;a.call("_guiRelayout",e,s)}c.resetCameraDefault3d={name:"resetCameraDefault3d",_cat:"resetCameraDefault",title:function(e){return u(e,"Reset camera to default")},attr:"resetDefault",icon:o.home,click:p};c.resetCameraLastSave3d={name:"resetCameraLastSave3d",_cat:"resetCameraLastSave",title:function(e){return u(e,"Reset camera to last save")},attr:"resetLastSave",icon:o.movie,click:p};function p(e,t){var r=t.currentTarget;var n=r.getAttribute("data-attr");var i=n==="resetLastSave";var o=n==="resetDefault";var s=e._fullLayout;var l=s._subplots.gl3d||[];var u={};for(var c=0;c<l.length;c++){var f=l[c];var h=f+".camera";var p=f+".aspectratio";var v=f+".aspectmode";var d=s[f]._scene;var m;if(i){u[h+".up"]=d.viewInitial.up;u[h+".eye"]=d.viewInitial.eye;u[h+".center"]=d.viewInitial.center;m=true}else if(o){u[h+".up"]=null;u[h+".eye"]=null;u[h+".center"]=null;m=true}if(m){u[p+".x"]=d.viewInitial.aspectratio.x;u[p+".y"]=d.viewInitial.aspectratio.y;u[p+".z"]=d.viewInitial.aspectratio.z;u[v]=d.viewInitial.aspectmode}}a.call("_guiRelayout",e,u)}c.hoverClosest3d={name:"hoverClosest3d",_cat:"hoverclosest",title:function(e){return u(e,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:true,icon:o.tooltip_basic,gravity:"ne",click:d};function v(e,t){var r=t.currentTarget;var a=r._previousVal;var n=e._fullLayout;var i=n._subplots.gl3d||[];var o=["xaxis","yaxis","zaxis"];var s={};var l={};if(a){l=a;r._previousVal=null}else{for(var u=0;u<i.length;u++){var c=i[u];var f=n[c];var h=c+".hovermode";s[h]=f.hovermode;l[h]=false;for(var p=0;p<3;p++){var v=o[p];var d=c+"."+v+".showspikes";l[d]=false;s[d]=f[v].showspikes}}r._previousVal=s}return l}function d(e,t){var r=v(e,t);a.call("_guiRelayout",e,r)}c.zoomInGeo={name:"zoomInGeo",_cat:"zoomin",title:function(e){return u(e,"Zoom in")},attr:"zoom",val:"in",icon:o.zoom_plus,click:m};c.zoomOutGeo={name:"zoomOutGeo",_cat:"zoomout",title:function(e){return u(e,"Zoom out")},attr:"zoom",val:"out",icon:o.zoom_minus,click:m};c.resetGeo={name:"resetGeo",_cat:"reset",title:function(e){return u(e,"Reset")},attr:"reset",val:null,icon:o.autoscale,click:m};c.hoverClosestGeo={name:"hoverClosestGeo",_cat:"hoverclosest",title:function(e){return u(e,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:true,icon:o.tooltip_basic,gravity:"ne",click:y};function m(e,t){var r=t.currentTarget;var n=r.getAttribute("data-attr");var i=r.getAttribute("data-val")||true;var o=e._fullLayout;var s=o._subplots.geo||[];for(var l=0;l<s.length;l++){var u=s[l];var c=o[u];if(n==="zoom"){var f=c.projection.scale;var h=i==="in"?2*f:.5*f;a.call("_guiRelayout",e,u+".projection.scale",h)}}if(n==="reset"){_(e,"geo")}}c.hoverClosestGl2d={name:"hoverClosestGl2d",_cat:"hoverclosest",title:function(e){return u(e,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:true,icon:o.tooltip_basic,gravity:"ne",click:y};c.hoverClosestPie={name:"hoverClosestPie",_cat:"hoverclosest",title:function(e){return u(e,"Toggle show closest data on hover")},attr:"hovermode",val:"closest",icon:o.tooltip_basic,gravity:"ne",click:y};function g(e){var t=e._fullLayout;if(t.hovermode)return false;if(t._has("cartesian")){return t._isHoriz?"y":"x"}return"closest"}function y(e){var t=g(e);a.call("_guiRelayout",e,"hovermode",t)}c.resetViewSankey={name:"resetSankeyGroup",title:function(e){return u(e,"Reset view")},icon:o.home,click:function(e){var t={"node.groups":[],"node.x":[],"node.y":[]};for(var r=0;r<e._fullData.length;r++){var n=e._fullData[r]._viewInitial;t["node.groups"].push(n.node.groups.slice());t["node.x"].push(n.node.x.slice());t["node.y"].push(n.node.y.slice())}a.call("restyle",e,t)}};c.toggleHover={name:"toggleHover",title:function(e){return u(e,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:true,icon:o.tooltip_basic,gravity:"ne",click:function(e,t){var r=v(e,t);r.hovermode=g(e);a.call("_guiRelayout",e,r)}};c.resetViews={name:"resetViews",title:function(e){return u(e,"Reset views")},icon:o.home,click:function(e,t){var r=t.currentTarget;r.setAttribute("data-attr","zoom");r.setAttribute("data-val","reset");f(e,t);r.setAttribute("data-attr","resetLastSave");p(e,t);_(e,"geo");_(e,"mapbox")}};c.toggleSpikelines={name:"toggleSpikelines",title:function(e){return u(e,"Toggle Spike Lines")},icon:o.spikeline,attr:"_cartesianSpikesEnabled",val:"on",click:function(e){var t=e._fullLayout;var r=t._cartesianSpikesEnabled;t._cartesianSpikesEnabled=r==="on"?"off":"on";a.call("_guiRelayout",e,x(e))}};function x(e){var t=e._fullLayout;var r=t._cartesianSpikesEnabled==="on";var a=i.list(e,null,true);var n={};for(var o=0;o<a.length;o++){var s=a[o];n[s._name+".showspikes"]=r?true:s._showSpikeInitial}return n}c.resetViewMapbox={name:"resetViewMapbox",_cat:"resetView",title:function(e){return u(e,"Reset view")},attr:"reset",icon:o.home,click:function(e){_(e,"mapbox")}};c.zoomInMapbox={name:"zoomInMapbox",_cat:"zoomin",title:function(e){return u(e,"Zoom in")},attr:"zoom",val:"in",icon:o.zoom_plus,click:b};c.zoomOutMapbox={name:"zoomOutMapbox",_cat:"zoomout",title:function(e){return u(e,"Zoom out")},attr:"zoom",val:"out",icon:o.zoom_minus,click:b};function b(e,t){var r=t.currentTarget;var n=r.getAttribute("data-val");var i=e._fullLayout;var o=i._subplots.mapbox||[];var s=1.05;var l={};for(var u=0;u<o.length;u++){var c=o[u];var f=i[c].zoom;var h=n==="in"?s*f:f/s;l[c+".zoom"]=h}a.call("_guiRelayout",e,l)}function _(e,t){var r=e._fullLayout;var n=r._subplots[t]||[];var i={};for(var o=0;o<n.length;o++){var s=n[o];var l=r[s]._subplot;var u=l.viewInitial;var c=Object.keys(u);for(var f=0;f<c.length;f++){var h=c[f];i[s+"."+h]=u[h]}}a.call("_guiRelayout",e,i)}},{"../../fonts/ploticon":766,"../../lib":787,"../../plots/cartesian/axis_ids":842,"../../plots/plots":901,"../../registry":915,"../shapes/draw":734}],711:[function(e,t,r){"use strict";var a=e("./buttons");var n=Object.keys(a);var i=["drawline","drawopenpath","drawclosedpath","drawcircle","drawrect","eraseshape"];var o=["v1hovermode","hoverclosest","hovercompare","togglehover","togglespikelines"].concat(i);var s=[];var l=function(e){if(o.indexOf(e._cat||e.name)!==-1)return;var t=e.name;var r=(e._cat||e.name).toLowerCase();if(s.indexOf(t)===-1)s.push(t);if(s.indexOf(r)===-1)s.push(r)};n.forEach((function(e){l(a[e])}));s.sort();t.exports={DRAW_MODES:i,backButtons:o,foreButtons:s}},{"./buttons":710}],712:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("../color");var i=e("../../plot_api/plot_template");var o=e("./attributes");t.exports=function e(t,r){var s=t.modebar||{};var l=i.newContainer(r,"modebar");function u(e,t){return a.coerce(s,l,o,e,t)}u("orientation");u("bgcolor",n.addOpacity(r.paper_bgcolor,.5));var c=n.contrast(n.rgb(r.modebar.bgcolor));u("color",n.addOpacity(c,.3));u("activecolor",n.addOpacity(c,.7));u("uirevision",r.uirevision);u("add");u("remove")}},{"../../lib":787,"../../plot_api/plot_template":827,"../color":650,"./attributes":709}],713:[function(e,t,r){"use strict";t.exports={moduleType:"component",name:"modebar",layoutAttributes:e("./attributes"),supplyLayoutDefaults:e("./defaults"),manage:e("./manage")}},{"./attributes":709,"./defaults":712,"./manage":714}],714:[function(e,t,r){"use strict";var a=e("../../plots/cartesian/axis_ids");var n=e("../../traces/scatter/subtypes");var i=e("../../registry");var o=e("../fx/helpers").isUnifiedHover;var s=e("./modebar");var l=e("./buttons");var u=e("./constants").DRAW_MODES;t.exports=function e(t){var r=t._fullLayout;var a=t._context;var n=r._modeBar;if(!a.displayModeBar&&!a.watermark){if(n){n.destroy();delete r._modeBar}return}if(!Array.isArray(a.modeBarButtonsToRemove)){throw new Error(["*modeBarButtonsToRemove* configuration options","must be an array."].join(" "))}if(!Array.isArray(a.modeBarButtonsToAdd)){throw new Error(["*modeBarButtonsToAdd* configuration options","must be an array."].join(" "))}var i=a.modeBarButtons;var o;if(Array.isArray(i)&&i.length){o=d(i)}else if(!a.displayModeBar&&a.watermark){o=[]}else{o=c(t)}if(n)n.update(t,o);else r._modeBar=s(t,o)};function c(e){var t=e._fullLayout;var r=e._fullData;var a=e._context;function n(e,t){if(typeof t==="string"){if(t.toLowerCase()===e.toLowerCase())return true}else{var r=t.name;var a=t._cat||t.name;if(r===e||a===e.toLowerCase())return true}return false}var i=t.modebar.add;if(typeof i==="string")i=[i];var s=t.modebar.remove;if(typeof s==="string")s=[s];var c=a.modeBarButtonsToAdd.concat(i.filter((function(e){for(var t=0;t<a.modeBarButtonsToRemove.length;t++){if(n(e,a.modeBarButtonsToRemove[t]))return false}return true})));var d=a.modeBarButtonsToRemove.concat(s.filter((function(e){for(var t=0;t<a.modeBarButtonsToAdd.length;t++){if(n(e,a.modeBarButtonsToAdd[t]))return false}return true})));var m=t._has("cartesian");var g=t._has("gl3d");var y=t._has("geo");var x=t._has("pie");var b=t._has("funnelarea");var _=t._has("gl2d");var w=t._has("ternary");var T=t._has("mapbox");var k=t._has("polar");var M=t._has("sankey");var A=f(t);var S=o(t.hovermode);var E=[];function L(e){if(!e.length)return;var t=[];for(var r=0;r<e.length;r++){var a=e[r];var n=l[a];var i=n.name.toLowerCase();var o=(n._cat||n.name).toLowerCase();var s=false;for(var u=0;u<d.length;u++){var c=d[u].toLowerCase();if(c===i||c===o){s=true;break}}if(s)continue;t.push(l[a])}E.push(t)}var C=["toImage"];if(a.showEditInChartStudio)C.push("editInChartStudio");else if(a.showSendToCloud)C.push("sendDataToCloud");L(C);var I=[];var P=[];var O=[];var z=[];if((m||_||x||b||w)+y+g+T+k>1){P=["toggleHover"];O=["resetViews"]}else if(y){I=["zoomInGeo","zoomOutGeo"];P=["hoverClosestGeo"];O=["resetGeo"]}else if(g){P=["hoverClosest3d"];O=["resetCameraDefault3d","resetCameraLastSave3d"]}else if(T){I=["zoomInMapbox","zoomOutMapbox"];P=["toggleHover"];O=["resetViewMapbox"]}else if(_){P=["hoverClosestGl2d"]}else if(x){P=["hoverClosestPie"]}else if(M){P=["hoverClosestCartesian","hoverCompareCartesian"];O=["resetViewSankey"]}else{P=["toggleHover"]}if(m){P=["toggleSpikelines","hoverClosestCartesian","hoverCompareCartesian"]}if(p(r)||S){P=[]}if((m||_)&&!A){I=["zoomIn2d","zoomOut2d","autoScale2d"];if(O[0]!=="resetViews")O=["resetScale2d"]}if(g){z=["zoom3d","pan3d","orbitRotation","tableRotation"]}else if((m||_)&&!A||w){z=["zoom2d","pan2d"]}else if(T||y){z=["pan2d"]}else if(k){z=["zoom2d"]}if(h(r)){z.push("select2d","lasso2d")}var D=[];var R=function(e){if(D.indexOf(e)!==-1)return;if(P.indexOf(e)!==-1){D.push(e)}};if(Array.isArray(c)){var F=[];for(var B=0;B<c.length;B++){var N=c[B];if(typeof N==="string"){N=N.toLowerCase();if(u.indexOf(N)!==-1){if(t._has("mapbox")||t._has("cartesian")){z.push(N)}}else if(N==="togglespikelines"){R("toggleSpikelines")}else if(N==="togglehover"){R("toggleHover")}else if(N==="hovercompare"){R("hoverCompareCartesian")}else if(N==="hoverclosest"){R("hoverClosestCartesian");R("hoverClosestGeo");R("hoverClosest3d");R("hoverClosestGl2d");R("hoverClosestPie")}else if(N==="v1hovermode"){R("toggleHover");R("hoverClosestCartesian");R("hoverCompareCartesian");R("hoverClosestGeo");R("hoverClosest3d");R("hoverClosestGl2d");R("hoverClosestPie")}}else F.push(N)}c=F}L(z);L(I.concat(O));L(D);return v(E,c)}function f(e){var t=a.list({_fullLayout:e},null,true);for(var r=0;r<t.length;r++){if(!t[r].fixedrange){return false}}return true}function h(e){var t=false;for(var r=0;r<e.length;r++){if(t)break;var a=e[r];if(!a._module||!a._module.selectPoints)continue;if(i.traceIs(a,"scatter-like")){if(n.hasMarkers(a)||n.hasText(a)){t=true}}else if(i.traceIs(a,"box-violin")){if(a.boxpoints==="all"||a.points==="all"){t=true}}else{t=true}}return t}function p(e){for(var t=0;t<e.length;t++){if(!i.traceIs(e[t],"noHover"))return false}return true}function v(e,t){if(t.length){if(Array.isArray(t[0])){for(var r=0;r<t.length;r++){e.push(t[r])}}else e.push(t)}return e}function d(e){for(var t=0;t<e.length;t++){var r=e[t];for(var a=0;a<r.length;a++){var n=r[a];if(typeof n==="string"){if(l[n]!==undefined){e[t][a]=l[n]}else{throw new Error(["*modeBarButtons* configuration options","invalid button name"].join(" "))}}}}return e}},{"../../plots/cartesian/axis_ids":842,"../../registry":915,"../../traces/scatter/subtypes":1227,"../fx/helpers":686,"./buttons":710,"./constants":711,"./modebar":715}],715:[function(e,t,r){"use strict";var a=e("@plotly/d3");var n=e("fast-isnumeric");var i=e("../../lib");var o=e("../../fonts/ploticon");var s=new DOMParser;function l(e){this.container=e.container;this.element=document.createElement("div");this.update(e.graphInfo,e.buttons);this.container.appendChild(this.element)}var u=l.prototype;u.update=function(e,t){this.graphInfo=e;var r=this.graphInfo._context;var a=this.graphInfo._fullLayout;var n="modebar-"+a._uid;this.element.setAttribute("id",n);this._uid=n;this.element.className="modebar";if(r.displayModeBar==="hover")this.element.className+=" modebar--hover ease-bg";if(a.modebar.orientation==="v"){this.element.className+=" vertical";t=t.reverse()}var o=a.modebar;var s=r.displayModeBar==="hover"?".js-plotly-plot .plotly:hover ":"";i.deleteRelatedStyleRule(n);i.addRelatedStyleRule(n,s+"#"+n+" .modebar-group","background-color: "+o.bgcolor);i.addRelatedStyleRule(n,"#"+n+" .modebar-btn .icon path","fill: "+o.color);i.addRelatedStyleRule(n,"#"+n+" .modebar-btn:hover .icon path","fill: "+o.activecolor);i.addRelatedStyleRule(n,"#"+n+" .modebar-btn.active .icon path","fill: "+o.activecolor);var l=!this.hasButtons(t);var u=this.hasLogo!==r.displaylogo;var c=this.locale!==r.locale;this.locale=r.locale;if(l||u||c){this.removeAllButtons();this.updateButtons(t);if(r.watermark||r.displaylogo){var f=this.getLogo();if(r.watermark){f.className=f.className+" watermark"}if(a.modebar.orientation==="v"){this.element.insertBefore(f,this.element.childNodes[0])}else{this.element.appendChild(f)}this.hasLogo=true}}this.updateActiveButton()};u.updateButtons=function(e){var t=this;this.buttons=e;this.buttonElements=[];this.buttonsNames=[];this.buttons.forEach((function(e){var r=t.createGroup();e.forEach((function(e){var a=e.name;if(!a){throw new Error("must provide button 'name' in button config")}if(t.buttonsNames.indexOf(a)!==-1){throw new Error("button name '"+a+"' is taken")}t.buttonsNames.push(a);var n=t.createButton(e);t.buttonElements.push(n);r.appendChild(n)}));t.element.appendChild(r)}))};u.createGroup=function(){var e=document.createElement("div");e.className="modebar-group";return e};u.createButton=function(e){var t=this;var r=document.createElement("a");r.setAttribute("rel","tooltip");r.className="modebar-btn";var n=e.title;if(n===undefined)n=e.name;else if(typeof n==="function")n=n(this.graphInfo);if(n||n===0)r.setAttribute("data-title",n);if(e.attr!==undefined)r.setAttribute("data-attr",e.attr);var i=e.val;if(i!==undefined){if(typeof i==="function")i=i(this.graphInfo);r.setAttribute("data-val",i)}var s=e.click;if(typeof s!=="function"){throw new Error("must provide button 'click' function in button config")}else{r.addEventListener("click",(function(r){e.click(t.graphInfo,r);t.updateActiveButton(r.currentTarget)}))}r.setAttribute("data-toggle",e.toggle||false);if(e.toggle)a.select(r).classed("active",true);var l=e.icon;if(typeof l==="function"){r.appendChild(l())}else{r.appendChild(this.createIcon(l||o.question))}r.setAttribute("data-gravity",e.gravity||"n");return r};u.createIcon=function(e){var t=n(e.height)?Number(e.height):e.ascent-e.descent;var r="http://www.w3.org/2000/svg";var a;if(e.path){a=document.createElementNS(r,"svg");a.setAttribute("viewBox",[0,0,e.width,t].join(" "));a.setAttribute("class","icon");var i=document.createElementNS(r,"path");i.setAttribute("d",e.path);if(e.transform){i.setAttribute("transform",e.transform)}else if(e.ascent!==undefined){i.setAttribute("transform","matrix(1 0 0 -1 0 "+e.ascent+")")}a.appendChild(i)}if(e.svg){var o=s.parseFromString(e.svg,"application/xml");a=o.childNodes[0]}a.setAttribute("height","1em");a.setAttribute("width","1em");return a};u.updateActiveButton=function(e){var t=this.graphInfo._fullLayout;var r=e!==undefined?e.getAttribute("data-attr"):null;this.buttonElements.forEach((function(e){var n=e.getAttribute("data-val")||true;var o=e.getAttribute("data-attr");var s=e.getAttribute("data-toggle")==="true";var l=a.select(e);if(s){if(o===r){l.classed("active",!l.classed("active"))}}else{var u=o===null?o:i.nestedProperty(t,o).get();l.classed("active",u===n)}}))};u.hasButtons=function(e){var t=this.buttons;if(!t)return false;if(e.length!==t.length)return false;for(var r=0;r<e.length;++r){if(e[r].length!==t[r].length)return false;for(var a=0;a<e[r].length;a++){if(e[r][a].name!==t[r][a].name)return false}}return true};u.getLogo=function(){var e=this.createGroup();var t=document.createElement("a");t.href="https://plotly.com/";t.target="_blank";t.setAttribute("data-title",i._(this.graphInfo,"Produced with Plotly"));t.className="modebar-btn plotlyjsicon modebar-btn--logo";t.appendChild(this.createIcon(o.newplotlylogo));e.appendChild(t);return e};u.removeAllButtons=function(){while(this.element.firstChild){this.element.removeChild(this.element.firstChild)}this.hasLogo=false};u.destroy=function(){i.removeElement(this.container.querySelector(".modebar"));i.deleteRelatedStyleRule(this._uid)};function c(e,t){var r=e._fullLayout;var n=new l({graphInfo:e,container:r._modebardiv.node(),buttons:t});if(r._privateplot){a.select(n.element).append("span").classed("badge-private float--left",true).text("PRIVATE")}return n}t.exports=c},{"../../fonts/ploticon":766,"../../lib":787,"@plotly/d3":58,"fast-isnumeric":246}],716:[function(e,t,r){"use strict";var a=e("../../plots/font_attributes");var n=e("../color/attributes");var i=e("../../plot_api/plot_template").templatedArray;var o=i("button",{visible:{valType:"boolean",dflt:true,editType:"plot"},step:{valType:"enumerated",values:["month","year","day","hour","minute","second","all"],dflt:"month",editType:"plot"},stepmode:{valType:"enumerated",values:["backward","todate"],dflt:"backward",editType:"plot"},count:{valType:"number",min:0,dflt:1,editType:"plot"},label:{valType:"string",editType:"plot"},editType:"plot"});t.exports={visible:{valType:"boolean",editType:"plot"},buttons:o,x:{valType:"number",min:-2,max:3,editType:"plot"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left",editType:"plot"},y:{valType:"number",min:-2,max:3,editType:"plot"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"bottom",editType:"plot"},font:a({editType:"plot"}),bgcolor:{valType:"color",dflt:n.lightLine,editType:"plot"},activecolor:{valType:"color",editType:"plot"},bordercolor:{valType:"color",dflt:n.defaultLine,editType:"plot"},borderwidth:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"plot"}},{"../../plot_api/plot_template":827,"../../plots/font_attributes":867,"../color/attributes":649}],717:[function(e,t,r){"use strict";t.exports={yPad:.02,minButtonWidth:30,rx:3,ry:3,lightAmount:25,darkAmount:10}},{}],718:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("../color");var i=e("../../plot_api/plot_template");var o=e("../../plots/array_container_defaults");var s=e("./attributes");var l=e("./constants");t.exports=function e(t,r,f,h,p){var v=t.rangeselector||{};var d=i.newContainer(r,"rangeselector");function m(e,t){return a.coerce(v,d,s,e,t)}var g=o(v,d,{name:"buttons",handleItemDefaults:u,calendar:p});var y=m("visible",g.length>0);if(y){var x=c(r,f,h);m("x",x[0]);m("y",x[1]);a.noneOrAll(t,r,["x","y"]);m("xanchor");m("yanchor");a.coerceFont(m,"font",f.font);var b=m("bgcolor");m("activecolor",n.contrast(b,l.lightAmount,l.darkAmount));m("bordercolor");m("borderwidth")}};function u(e,t,r,n){var i=n.calendar;function o(r,n){return a.coerce(e,t,s.buttons,r,n)}var l=o("visible");if(l){var u=o("step");if(u!=="all"){if(i&&i!=="gregorian"&&(u==="month"||u==="year")){t.stepmode="backward"}else{o("stepmode")}o("count")}o("label")}}function c(e,t,r){var a=r.filter((function(r){return t[r].anchor===e._id}));var n=0;for(var i=0;i<a.length;i++){var o=t[a[i]].domain;if(o)n=Math.max(o[1],n)}return[e.domain[0],n+l.yPad]}},{"../../lib":787,"../../plot_api/plot_template":827,"../../plots/array_container_defaults":833,"../color":650,"./attributes":716,"./constants":717}],719:[function(e,t,r){"use strict";var a=e("@plotly/d3");var n=e("../../registry");var i=e("../../plots/plots");var o=e("../color");var s=e("../drawing");var l=e("../../lib");var u=l.strTranslate;var c=e("../../lib/svg_text_utils");var f=e("../../plots/cartesian/axis_ids");var h=e("../../constants/alignment");var p=h.LINE_SPACING;var v=h.FROM_TL;var d=h.FROM_BR;var m=e("./constants");var g=e("./get_update_object");t.exports=function e(t){var r=t._fullLayout;var i=r._infolayer.selectAll(".rangeselector").data(y(t),x);i.enter().append("g").classed("rangeselector",true);i.exit().remove();i.style({cursor:"pointer","pointer-events":"all"});i.each((function(e){var r=a.select(this);var i=e;var o=i.rangeselector;var s=r.selectAll("g.button").data(l.filterVisible(o.buttons));s.enter().append("g").classed("button",true);s.exit().remove();s.each((function(e){var r=a.select(this);var s=g(i,e);e._isActive=b(i,e,s);r.call(_,o,e);r.call(T,o,e,t);r.on("click",(function(){if(t._dragged)return;n.call("_guiRelayout",t,s)}));r.on("mouseover",(function(){e._isHovered=true;r.call(_,o,e)}));r.on("mouseout",(function(){e._isHovered=false;r.call(_,o,e)}))}));M(t,s,o,i._name,r)}))};function y(e){var t=f.list(e,"x",true);var r=[];for(var a=0;a<t.length;a++){var n=t[a];if(n.rangeselector&&n.rangeselector.visible){r.push(n)}}return r}function x(e){return e._id}function b(e,t,r){if(t.step==="all"){return e.autorange===true}else{var a=Object.keys(r);return e.range[0]===r[a[0]]&&e.range[1]===r[a[1]]}}function _(e,t,r){var a=l.ensureSingle(e,"rect","selector-rect",(function(e){e.attr("shape-rendering","crispEdges")}));a.attr({rx:m.rx,ry:m.ry});a.call(o.stroke,t.bordercolor).call(o.fill,w(t,r)).style("stroke-width",t.borderwidth+"px")}function w(e,t){return t._isActive||t._isHovered?e.activecolor:e.bgcolor}function T(e,t,r,a){function n(e){c.convertToTspans(e,a)}var i=l.ensureSingle(e,"text","selector-text",(function(e){e.attr("text-anchor","middle")}));i.call(s.font,t.font).text(k(r,a._fullLayout._meta)).call(n)}function k(e,t){if(e.label){return t?l.templateString(e.label,t):e.label}if(e.step==="all")return"all";return e.count+e.step.charAt(0)}function M(e,t,r,n,o){var f=0;var h=0;var g=r.borderwidth;t.each((function(){var e=a.select(this);var t=e.select(".selector-text");var n=r.font.size*p;var i=Math.max(n*c.lineCount(t),16)+3;h=Math.max(h,i)}));t.each((function(){var e=a.select(this);var t=e.select(".selector-rect");var n=e.select(".selector-text");var i=n.node()&&s.bBox(n.node()).width;var o=r.font.size*p;var l=c.lineCount(n);var v=Math.max(i+10,m.minButtonWidth);e.attr("transform",u(g+f,g));t.attr({x:0,y:0,width:v,height:h});c.positionText(n,v/2,h/2-(l-1)*o/2+3);f+=v+5}));var y=e._fullLayout._size;var x=y.l+y.w*r.x;var b=y.t+y.h*(1-r.y);var _="left";if(l.isRightAnchor(r)){x-=f;_="right"}if(l.isCenterAnchor(r)){x-=f/2;_="center"}var w="top";if(l.isBottomAnchor(r)){b-=h;w="bottom"}if(l.isMiddleAnchor(r)){b-=h/2;w="middle"}f=Math.ceil(f);h=Math.ceil(h);x=Math.round(x);b=Math.round(b);i.autoMargin(e,n+"-range-selector",{x:r.x,y:r.y,l:f*v[_],r:f*d[_],b:h*d[w],t:h*v[w]});o.attr("transform",u(x,b))}},{"../../constants/alignment":755,"../../lib":787,"../../lib/svg_text_utils":813,"../../plots/cartesian/axis_ids":842,"../../plots/plots":901,"../../registry":915,"../color":650,"../drawing":672,"./constants":717,"./get_update_object":720,"@plotly/d3":58}],720:[function(e,t,r){"use strict";var a=e("d3-time");var n=e("../../lib").titleCase;t.exports=function e(t,r){var a=t._name;var n={};if(r.step==="all"){n[a+".autorange"]=true}else{var o=i(t,r);n[a+".range[0]"]=o[0];n[a+".range[1]"]=o[1]}return n};function i(e,t){var r=e.range;var i=new Date(e.r2l(r[1]));var o=t.step;var s=a["utc"+n(o)];var l=t.count;var u;switch(t.stepmode){case"backward":u=e.l2r(+s.offset(i,-l));break;case"todate":var c=s.offset(i,-l);u=e.l2r(+s.ceil(c));break}var f=r[1];return[u,f]}},{"../../lib":787,"d3-time":174}],721:[function(e,t,r){"use strict";t.exports={moduleType:"component",name:"rangeselector",schema:{subplots:{xaxis:{rangeselector:e("./attributes")}}},layoutAttributes:e("./attributes"),handleDefaults:e("./defaults"),draw:e("./draw")}},{"./attributes":716,"./defaults":718,"./draw":719}],722:[function(e,t,r){"use strict";var a=e("../color/attributes");t.exports={bgcolor:{valType:"color",dflt:a.background,editType:"plot"},bordercolor:{valType:"color",dflt:a.defaultLine,editType:"plot"},borderwidth:{valType:"integer",dflt:0,min:0,editType:"plot"},autorange:{valType:"boolean",dflt:true,editType:"calc",impliedEdits:{"range[0]":undefined,"range[1]":undefined}},range:{valType:"info_array",items:[{valType:"any",editType:"calc",impliedEdits:{"^autorange":false}},{valType:"any",editType:"calc",impliedEdits:{"^autorange":false}}],editType:"calc",impliedEdits:{autorange:false}},thickness:{valType:"number",dflt:.15,min:0,max:1,editType:"plot"},visible:{valType:"boolean",dflt:true,editType:"calc"},editType:"calc"}},{"../color/attributes":649}],723:[function(e,t,r){"use strict";var a=e("../../plots/cartesian/axis_ids").list;var n=e("../../plots/cartesian/autorange").getAutoRange;var i=e("./constants");t.exports=function e(t){var r=a(t,"x",true);for(var o=0;o<r.length;o++){var s=r[o];var l=s[i.name];if(l&&l.visible&&l.autorange){l._input.autorange=true;l._input.range=l.range=n(t,s)}}}},{"../../plots/cartesian/autorange":837,"../../plots/cartesian/axis_ids":842,"./constants":724}],724:[function(e,t,r){"use strict";t.exports={name:"rangeslider",containerClassName:"rangeslider-container",bgClassName:"rangeslider-bg",rangePlotClassName:"rangeslider-rangeplot",maskMinClassName:"rangeslider-mask-min",maskMaxClassName:"rangeslider-mask-max",slideBoxClassName:"rangeslider-slidebox",grabberMinClassName:"rangeslider-grabber-min",grabAreaMinClassName:"rangeslider-grabarea-min",handleMinClassName:"rangeslider-handle-min",grabberMaxClassName:"rangeslider-grabber-max",grabAreaMaxClassName:"rangeslider-grabarea-max",handleMaxClassName:"rangeslider-handle-max",maskMinOppAxisClassName:"rangeslider-mask-min-opp-axis",maskMaxOppAxisClassName:"rangeslider-mask-max-opp-axis",maskColor:"rgba(0,0,0,0.4)",maskOppAxisColor:"rgba(0,0,0,0.2)",slideBoxFill:"transparent",slideBoxCursor:"ew-resize",grabAreaFill:"transparent",grabAreaCursor:"col-resize",grabAreaWidth:10,handleWidth:4,handleRadius:1,handleStrokeWidth:1,extraPad:15}},{}],725:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("../../plot_api/plot_template");var i=e("../../plots/cartesian/axis_ids");var o=e("./attributes");var s=e("./oppaxis_attributes");t.exports=function e(t,r,l){var u=t[l];var c=r[l];if(!(u.rangeslider||r._requestRangeslider[c._id]))return;if(!a.isPlainObject(u.rangeslider)){u.rangeslider={}}var f=u.rangeslider;var h=n.newContainer(c,"rangeslider");function p(e,t){return a.coerce(f,h,o,e,t)}var v,d;function m(e,t){return a.coerce(v,d,s,e,t)}var g=p("visible");if(!g)return;p("bgcolor",r.plot_bgcolor);p("bordercolor");p("borderwidth");p("thickness");p("autorange",!c.isValidRange(f.range));p("range");var y=r._subplots;if(y){var x=y.cartesian.filter((function(e){return e.substr(0,e.indexOf("y"))===i.name2id(l)})).map((function(e){return e.substr(e.indexOf("y"),e.length)}));var b=a.simpleMap(x,i.id2name);for(var _=0;_<b.length;_++){var w=b[_];v=f[w]||{};d=n.newContainer(h,w,"yaxis");var T=r[w];var k;if(v.range&&T.isValidRange(v.range)){k="fixed"}var M=m("rangemode",k);if(M!=="match"){m("range",T.range.slice())}}}h._input=f}},{"../../lib":787,"../../plot_api/plot_template":827,"../../plots/cartesian/axis_ids":842,"./attributes":722,"./oppaxis_attributes":729}],726:[function(e,t,r){"use strict";var a=e("@plotly/d3");var n=e("../../registry");var i=e("../../plots/plots");var o=e("../../lib");var s=o.strTranslate;var l=e("../drawing");var u=e("../color");var c=e("../titles");var f=e("../../plots/cartesian");var h=e("../../plots/cartesian/axis_ids");var p=e("../dragelement");var v=e("../../lib/setcursor");var d=e("./constants");t.exports=function(e){var t=e._fullLayout;var r=t._rangeSliderData;for(var n=0;n<r.length;n++){var i=r[n][d.name];i._clipId=i._id+"-"+t._uid}function l(e){return e._name}var u=t._infolayer.selectAll("g."+d.containerClassName).data(r,l);u.exit().each((function(e){var r=e[d.name];t._topdefs.select("#"+r._clipId).remove()})).remove();if(r.length===0)return;u.enter().append("g").classed(d.containerClassName,true).attr("pointer-events","all");u.each((function(r){var n=a.select(this);var i=r[d.name];var l=t[h.id2name(r.anchor)];var u=i[h.id2name(r.anchor)];if(i.range){var f=o.simpleMap(i.range,r.r2l);var p=o.simpleMap(r.range,r.r2l);var v;if(p[0]<p[1]){v=[Math.min(f[0],p[0]),Math.max(f[1],p[1])]}else{v=[Math.max(f[0],p[0]),Math.min(f[1],p[1])]}i.range=i._input.range=o.simpleMap(v,r.l2r)}r.cleanRange("rangeslider.range");var g=t._size;var w=r.domain;i._width=g.w*(w[1]-w[0]);var A=Math.round(g.l+g.w*w[0]);var S=Math.round(g.t+g.h*(1-r._counterDomainMin)+(r.side==="bottom"?r._depth:0)+i._offsetShift+d.extraPad);n.attr("transform",s(A,S));i._rl=o.simpleMap(i.range,r.r2l);var E=i._rl[0];var L=i._rl[1];var C=L-E;i.p2d=function(e){return e/i._width*C+E};i.d2p=function(e){return(e-E)/C*i._width};if(r.rangebreaks){var I=r.locateBreaks(E,L);if(I.length){var P,O;var z=0;for(P=0;P<I.length;P++){O=I[P];z+=O.max-O.min}var D=i._width/(L-E-z);var R=[-D*E];for(P=0;P<I.length;P++){O=I[P];R.push(R[R.length-1]-D*(O.max-O.min))}i.d2p=function(e){var t=R[0];for(var r=0;r<I.length;r++){var a=I[r];if(e>=a.max)t=R[r+1];else if(e<a.min)break}return t+D*e};for(P=0;P<I.length;P++){O=I[P];O.pmin=i.d2p(O.min);O.pmax=i.d2p(O.max)}i.p2d=function(e){var t=R[0];for(var r=0;r<I.length;r++){var a=I[r];if(e>=a.pmax)t=R[r+1];else if(e<a.pmin)break}return(e-t)/D}}}if(u.rangemode!=="match"){var F=l.r2l(u.range[0]);var B=l.r2l(u.range[1]);var N=B-F;i.d2pOppAxis=function(e){return(e-F)/N*i._height}}n.call(x,e,r,i).call(b,e,r,i).call(_,e,r,i).call(T,e,r,i,u).call(k,e,r,i).call(M,e,r,i);m(n,e,r,i);y(n,e,r,i,l,u);if(r.side==="bottom"){c.draw(e,r._id+"title",{propContainer:r,propName:r._name+".title",placeholder:t._dfltTitle.x,attributes:{x:r._offset+r._length/2,y:S+i._height+i._offsetShift+10+1.5*r.title.font.size,"text-anchor":"middle"}})}}))};function m(e,t,r,n){if(t._context.staticPlot)return;var i=e.select("rect."+d.slideBoxClassName).node();var s=e.select("rect."+d.grabAreaMinClassName).node();var l=e.select("rect."+d.grabAreaMaxClassName).node();function u(){var u=a.event;var c=u.target;var f=u.clientX||u.touches[0].clientX;var h=f-e.node().getBoundingClientRect().left;var d=n.d2p(r._rl[0]);var m=n.d2p(r._rl[1]);var y=p.coverSlip();this.addEventListener("touchmove",x);this.addEventListener("touchend",b);y.addEventListener("mousemove",x);y.addEventListener("mouseup",b);function x(o){var u=o.clientX||o.touches[0].clientX;var p=+u-f;var x,b,_;switch(c){case i:_="ew-resize";x=d+p;b=m+p;break;case s:_="col-resize";x=d+p;b=m;break;case l:_="col-resize";x=d;b=m+p;break;default:_="ew-resize";x=h;b=h+p;break}if(b<x){var w=b;b=x;x=w}n._pixelMin=x;n._pixelMax=b;v(a.select(y),_);g(e,t,r,n)}function b(){y.removeEventListener("mousemove",x);y.removeEventListener("mouseup",b);this.removeEventListener("touchmove",x);this.removeEventListener("touchend",b);o.removeElement(y)}}e.on("mousedown",u);e.on("touchstart",u)}function g(e,t,r,a){function i(e){return r.l2r(o.constrain(e,a._rl[0],a._rl[1]))}var s=i(a.p2d(a._pixelMin));var l=i(a.p2d(a._pixelMax));window.requestAnimationFrame((function(){n.call("_guiRelayout",t,r._name+".range",[s,l])}))}function y(e,t,r,a,n,i){var l=d.handleWidth/2;function u(e){return o.constrain(e,0,a._width)}function c(e){return o.constrain(e,0,a._height)}function f(e){return o.constrain(e,-l,a._width+l)}var h=u(a.d2p(r._rl[0]));var p=u(a.d2p(r._rl[1]));e.select("rect."+d.slideBoxClassName).attr("x",h).attr("width",p-h);e.select("rect."+d.maskMinClassName).attr("width",h);e.select("rect."+d.maskMaxClassName).attr("x",p).attr("width",a._width-p);if(i.rangemode!=="match"){var v=a._height-c(a.d2pOppAxis(n._rl[1]));var m=a._height-c(a.d2pOppAxis(n._rl[0]));e.select("rect."+d.maskMinOppAxisClassName).attr("x",h).attr("height",v).attr("width",p-h);e.select("rect."+d.maskMaxOppAxisClassName).attr("x",h).attr("y",m).attr("height",a._height-m).attr("width",p-h);e.select("rect."+d.slideBoxClassName).attr("y",v).attr("height",m-v)}var g=.5;var y=Math.round(f(h-l))-g;var x=Math.round(f(p-l))+g;e.select("g."+d.grabberMinClassName).attr("transform",s(y,g));e.select("g."+d.grabberMaxClassName).attr("transform",s(x,g))}function x(e,t,r,a){var n=o.ensureSingle(e,"rect",d.bgClassName,(function(e){e.attr({x:0,y:0,"shape-rendering":"crispEdges"})}));var i=a.borderwidth%2===0?a.borderwidth:a.borderwidth-1;var u=-a._offsetShift;var c=l.crispRound(t,a.borderwidth);n.attr({width:a._width+i,height:a._height+i,transform:s(u,u),fill:a.bgcolor,stroke:a.bordercolor,"stroke-width":c})}function b(e,t,r,a){var n=t._fullLayout;var i=o.ensureSingleById(n._topdefs,"clipPath",a._clipId,(function(e){e.append("rect").attr({x:0,y:0})}));i.select("rect").attr({width:a._width,height:a._height})}function _(e,t,r,n){var s=t.calcdata;var u=e.selectAll("g."+d.rangePlotClassName).data(r._subplotsWith,o.identity);u.enter().append("g").attr("class",(function(e){return d.rangePlotClassName+" "+e})).call(l.setClipUrl,n._clipId,t);u.order();u.exit().remove();var c;u.each((function(e,o){var l=a.select(this);var u=o===0;var p=h.getFromId(t,e,"y");var v=p._name;var d=n[v];var m={data:[],layout:{xaxis:{type:r.type,domain:[0,1],range:n.range.slice(),calendar:r.calendar},width:n._width,height:n._height,margin:{t:0,b:0,l:0,r:0}},_context:t._context};if(r.rangebreaks){m.layout.xaxis.rangebreaks=r.rangebreaks}m.layout[v]={type:p.type,domain:[0,1],range:d.rangemode!=="match"?d.range.slice():p.range.slice(),calendar:p.calendar};if(p.rangebreaks){m.layout[v].rangebreaks=p.rangebreaks}i.supplyDefaults(m);var g=m._fullLayout.xaxis;var y=m._fullLayout[v];g.clearCalc();g.setScale();y.clearCalc();y.setScale();var x={id:e,plotgroup:l,xaxis:g,yaxis:y,isRangePlot:true};if(u)c=x;else{x.mainplot="xy";x.mainplotinfo=c}f.rangePlot(t,x,w(s,e))}))}function w(e,t){var r=[];for(var a=0;a<e.length;a++){var n=e[a];var i=n[0].trace;if(i.xaxis+i.yaxis===t){r.push(n)}}return r}function T(e,t,r,a,n){var i=o.ensureSingle(e,"rect",d.maskMinClassName,(function(e){e.attr({x:0,y:0,"shape-rendering":"crispEdges"})}));i.attr("height",a._height).call(u.fill,d.maskColor);var s=o.ensureSingle(e,"rect",d.maskMaxClassName,(function(e){e.attr({y:0,"shape-rendering":"crispEdges"})}));s.attr("height",a._height).call(u.fill,d.maskColor);if(n.rangemode!=="match"){var l=o.ensureSingle(e,"rect",d.maskMinOppAxisClassName,(function(e){e.attr({y:0,"shape-rendering":"crispEdges"})}));l.attr("width",a._width).call(u.fill,d.maskOppAxisColor);var c=o.ensureSingle(e,"rect",d.maskMaxOppAxisClassName,(function(e){e.attr({y:0,"shape-rendering":"crispEdges"})}));c.attr("width",a._width).style("border-top",d.maskOppBorder).call(u.fill,d.maskOppAxisColor)}}function k(e,t,r,a){if(t._context.staticPlot)return;var n=o.ensureSingle(e,"rect",d.slideBoxClassName,(function(e){e.attr({y:0,cursor:d.slideBoxCursor,"shape-rendering":"crispEdges"})}));n.attr({height:a._height,fill:d.slideBoxFill})}function M(e,t,r,a){var n=o.ensureSingle(e,"g",d.grabberMinClassName);var i=o.ensureSingle(e,"g",d.grabberMaxClassName);var s={x:0,width:d.handleWidth,rx:d.handleRadius,fill:u.background,stroke:u.defaultLine,"stroke-width":d.handleStrokeWidth,"shape-rendering":"crispEdges"};var l={y:Math.round(a._height/4),height:Math.round(a._height/2)};var c=o.ensureSingle(n,"rect",d.handleMinClassName,(function(e){e.attr(s)}));c.attr(l);var f=o.ensureSingle(i,"rect",d.handleMaxClassName,(function(e){e.attr(s)}));f.attr(l);var h={width:d.grabAreaWidth,x:0,y:0,fill:d.grabAreaFill,cursor:!t._context.staticPlot?d.grabAreaCursor:undefined};var p=o.ensureSingle(n,"rect",d.grabAreaMinClassName,(function(e){e.attr(h)}));p.attr("height",a._height);var v=o.ensureSingle(i,"rect",d.grabAreaMaxClassName,(function(e){e.attr(h)}));v.attr("height",a._height)}},{"../../lib":787,"../../lib/setcursor":808,"../../plots/cartesian":852,"../../plots/cartesian/axis_ids":842,"../../plots/plots":901,"../../registry":915,"../color":650,"../dragelement":669,"../drawing":672,"../titles":748,"./constants":724,"@plotly/d3":58}],727:[function(e,t,r){"use strict";var a=e("../../plots/cartesian/axis_ids");var n=e("../../lib/svg_text_utils");var i=e("./constants");var o=e("../../constants/alignment").LINE_SPACING;var s=i.name;function l(e){var t=e&&e[s];return t&&t.visible}r.isVisible=l;r.makeData=function(e){var t=a.list({_fullLayout:e},"x",true);var r=e.margin;var n=[];if(!e._has("gl2d")){for(var i=0;i<t.length;i++){var o=t[i];if(l(o)){n.push(o);var u=o[s];u._id=s+o._id;u._height=(e.height-r.b-r.t)*u.thickness;u._offsetShift=Math.floor(u.borderwidth/2)}}}e._rangeSliderData=n};r.autoMarginOpts=function(e,t){var r=e._fullLayout;var a=t[s];var l=t._id.charAt(0);var u=0;var c=0;if(t.side==="bottom"){u=t._depth;if(t.title.text!==r._dfltTitle[l]){c=1.5*t.title.font.size+10+a._offsetShift;var f=(t.title.text.match(n.BR_TAG_ALL)||[]).length;c+=f*t.title.font.size*o}}return{x:0,y:t._counterDomainMin,l:0,r:0,t:0,b:a._height+u+Math.max(r.margin.b,c),pad:i.extraPad+a._offsetShift*2}}},{"../../constants/alignment":755,"../../lib/svg_text_utils":813,"../../plots/cartesian/axis_ids":842,"./constants":724}],728:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("./attributes");var i=e("./oppaxis_attributes");var o=e("./helpers");t.exports={moduleType:"component",name:"rangeslider",schema:{subplots:{xaxis:{rangeslider:a.extendFlat({},n,{yaxis:i})}}},layoutAttributes:e("./attributes"),handleDefaults:e("./defaults"),calcAutorange:e("./calc_autorange"),draw:e("./draw"),isVisible:o.isVisible,makeData:o.makeData,autoMarginOpts:o.autoMarginOpts}},{"../../lib":787,"./attributes":722,"./calc_autorange":723,"./defaults":725,"./draw":726,"./helpers":727,"./oppaxis_attributes":729}],729:[function(e,t,r){"use strict";t.exports={_isSubplotObj:true,rangemode:{valType:"enumerated",values:["auto","fixed","match"],dflt:"match",editType:"calc"},range:{valType:"info_array",items:[{valType:"any",editType:"plot"},{valType:"any",editType:"plot"}],editType:"plot"},editType:"calc"}},{}],730:[function(e,t,r){"use strict";var a=e("../annotations/attributes");var n=e("../../traces/scatter/attributes").line;var i=e("../drawing/attributes").dash;var o=e("../../lib/extend").extendFlat;var s=e("../../plot_api/plot_template").templatedArray;var l=e("../../constants/axis_placeable_objects");t.exports=s("shape",{visible:{valType:"boolean",dflt:true,editType:"calc+arraydraw"},type:{valType:"enumerated",values:["circle","rect","path","line"],editType:"calc+arraydraw"},layer:{valType:"enumerated",values:["below","above"],dflt:"above",editType:"arraydraw"},xref:o({},a.xref,{}),xsizemode:{valType:"enumerated",values:["scaled","pixel"],dflt:"scaled",editType:"calc+arraydraw"},xanchor:{valType:"any",editType:"calc+arraydraw"},x0:{valType:"any",editType:"calc+arraydraw"},x1:{valType:"any",editType:"calc+arraydraw"},yref:o({},a.yref,{}),ysizemode:{valType:"enumerated",values:["scaled","pixel"],dflt:"scaled",editType:"calc+arraydraw"},yanchor:{valType:"any",editType:"calc+arraydraw"},y0:{valType:"any",editType:"calc+arraydraw"},y1:{valType:"any",editType:"calc+arraydraw"},path:{valType:"string",editType:"calc+arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},line:{color:o({},n.color,{editType:"arraydraw"}),width:o({},n.width,{editType:"calc+arraydraw"}),dash:o({},i,{editType:"arraydraw"}),editType:"calc+arraydraw"},fillcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},fillrule:{valType:"enumerated",values:["evenodd","nonzero"],dflt:"evenodd",editType:"arraydraw"},editable:{valType:"boolean",dflt:false,editType:"calc+arraydraw"},editType:"arraydraw"})},{"../../constants/axis_placeable_objects":756,"../../lib/extend":777,"../../plot_api/plot_template":827,"../../traces/scatter/attributes":1202,"../annotations/attributes":633,"../drawing/attributes":671}],731:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("../../plots/cartesian/axes");var i=e("./constants");var o=e("./helpers");t.exports=function e(t){var r=t._fullLayout;var o=a.filterVisible(r.shapes);if(!o.length||!t._fullData.length)return;for(var u=0;u<o.length;u++){var f=o[u];f._extremes={};var h;var p;var v=n.getRefType(f.xref);var d=n.getRefType(f.yref);if(f.xref!=="paper"&&v!=="domain"){var m=f.xsizemode==="pixel"?f.xanchor:f.x0;var g=f.xsizemode==="pixel"?f.xanchor:f.x1;h=n.getFromId(t,f.xref);p=c(h,m,g,f.path,i.paramIsX);if(p){f._extremes[h._id]=n.findExtremes(h,p,s(f))}}if(f.yref!=="paper"&&d!=="domain"){var y=f.ysizemode==="pixel"?f.yanchor:f.y0;var x=f.ysizemode==="pixel"?f.yanchor:f.y1;h=n.getFromId(t,f.yref);p=c(h,y,x,f.path,i.paramIsY);if(p){f._extremes[h._id]=n.findExtremes(h,p,l(f))}}}};function s(e){return u(e.line.width,e.xsizemode,e.x0,e.x1,e.path,false)}function l(e){return u(e.line.width,e.ysizemode,e.y0,e.y1,e.path,true)}function u(e,t,r,n,s,l){var u=e/2;var c=l;if(t==="pixel"){var f=s?o.extractPathCoords(s,l?i.paramIsY:i.paramIsX):[r,n];var h=a.aggNums(Math.max,null,f);var p=a.aggNums(Math.min,null,f);var v=p<0?Math.abs(p)+u:u;var d=h>0?h+u:u;return{ppad:u,ppadplus:c?v:d,ppadminus:c?d:v}}else{return{ppad:u}}}function c(e,t,r,a,n){var s=e.type==="category"||e.type==="multicategory"?e.r2c:e.d2c;if(t!==undefined)return[s(t),s(r)];if(!a)return;var l=Infinity;var u=-Infinity;var c=a.match(i.segmentRE);var f;var h;var p;var v;var d;if(e.type==="date")s=o.decodeDate(s);for(f=0;f<c.length;f++){h=c[f];p=n[h.charAt(0)].drawn;if(p===undefined)continue;v=c[f].substr(1).match(i.paramRE);if(!v||v.length<p)continue;d=s(v[p]);if(d<l)l=d;if(d>u)u=d}if(u>=l)return[l,u]}},{"../../lib":787,"../../plots/cartesian/axes":838,"./constants":732,"./helpers":741}],732:[function(e,t,r){"use strict";t.exports={segmentRE:/[MLHVQCTSZ][^MLHVQCTSZ]*/g,paramRE:/[^\s,]+/g,paramIsX:{M:{0:true,drawn:0},L:{0:true,drawn:0},H:{0:true,drawn:0},V:{},Q:{0:true,2:true,drawn:2},C:{0:true,2:true,4:true,drawn:4},T:{0:true,drawn:0},S:{0:true,2:true,drawn:2},Z:{}},paramIsY:{M:{1:true,drawn:1},L:{1:true,drawn:1},H:{},V:{0:true,drawn:0},Q:{1:true,3:true,drawn:3},C:{1:true,3:true,5:true,drawn:5},T:{1:true,drawn:1},S:{1:true,3:true,drawn:5},Z:{}},numParams:{M:2,L:2,H:1,V:1,Q:4,C:6,T:2,S:4,Z:0}}},{}],733:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("../../plots/cartesian/axes");var i=e("../../plots/array_container_defaults");var o=e("./attributes");var s=e("./helpers");t.exports=function e(t,r){i(t,r,{name:"shapes",handleItemDefaults:l})};function l(e,t,r){function i(r,n){return a.coerce(e,t,o,r,n)}var l=i("visible");if(!l)return;var u=i("path");var c=u?"path":"rect";var f=i("type",c);if(t.type!=="path")delete t.path;i("editable");i("layer");i("opacity");i("fillcolor");i("fillrule");var h=i("line.width");if(h){i("line.color");i("line.dash")}var p=i("xsizemode");var v=i("ysizemode");var d=["x","y"];for(var m=0;m<2;m++){var g=d[m];var y=g+"anchor";var x=g==="x"?p:v;var b={_fullLayout:r};var _;var w;var T;var k=n.coerceRef(e,t,b,g,undefined,"paper");var M=n.getRefType(k);if(M==="range"){_=n.getFromId(b,k);_._shapeIndices.push(t._index);T=s.rangeToShapePosition(_);w=s.shapePositionToRange(_)}else{w=T=a.identity}if(f!=="path"){var A=.25;var S=.75;var E=g+"0";var L=g+"1";var C=e[E];var I=e[L];e[E]=w(e[E],true);e[L]=w(e[L],true);if(x==="pixel"){i(E,0);i(L,10)}else{n.coercePosition(t,b,i,k,E,A);n.coercePosition(t,b,i,k,L,S)}t[E]=T(t[E]);t[L]=T(t[L]);e[E]=C;e[L]=I}if(x==="pixel"){var P=e[y];e[y]=w(e[y],true);n.coercePosition(t,b,i,k,y,.25);t[y]=T(t[y]);e[y]=P}}if(f==="path"){i("path")}else{a.noneOrAll(e,t,["x0","x1","y0","y1"])}}},{"../../lib":787,"../../plots/array_container_defaults":833,"../../plots/cartesian/axes":838,"./attributes":730,"./helpers":741}],734:[function(e,t,r){"use strict";var a=e("../../registry");var n=e("../../lib");var i=e("../../plots/cartesian/axes");var o=e("./draw_newshape/helpers").readPaths;var s=e("./draw_newshape/display_outlines");var l=e("../../plots/cartesian/handle_outline").clearOutlineControllers;var u=e("../color");var c=e("../drawing");var f=e("../../plot_api/plot_template").arrayEditor;var h=e("../dragelement");var p=e("../../lib/setcursor");var v=e("./constants");var d=e("./helpers");t.exports={draw:m,drawOne:x,eraseActiveShape:S};function m(e){var t=e._fullLayout;t._shapeUpperLayer.selectAll("path").remove();t._shapeLowerLayer.selectAll("path").remove();for(var r in t._plots){var a=t._plots[r].shapelayer;if(a)a.selectAll("path").remove()}for(var n=0;n<t.shapes.length;n++){if(t.shapes[n].visible){x(e,n)}}}function g(e){return!!e._fullLayout._drawing}function y(e){return!e._context.edits.shapePosition}function x(e,t){e._fullLayout._paperdiv.selectAll('.shapelayer [data-index="'+t+'"]').remove();var r=d.makeOptionsAndPlotinfo(e,t);var a=r.options;var n=r.plotinfo;if(!a._input||a.visible===false)return;if(a.layer!=="below"){l(e._fullLayout._shapeUpperLayer)}else if(a.xref==="paper"||a.yref==="paper"){l(e._fullLayout._shapeLowerLayer)}else{if(n._hadPlotinfo){var i=n.mainplotinfo||n;l(i.shapelayer)}else{l(e._fullLayout._shapeLowerLayer)}}function l(r){var i=w(e,a);var l={"data-index":t,"fill-rule":a.fillrule,d:i};var h=a.opacity;var p=a.fillcolor;var v=a.line.width?a.line.color:"rgba(0,0,0,0)";var d=a.line.width;var m=a.line.dash;if(!d&&a.editable===true){d=5;m="solid"}var g=i[i.length-1]!=="Z";var x=y(e)&&a.editable&&e._fullLayout._activeShapeIndex===t;if(x){p=g?"rgba(0,0,0,0)":e._fullLayout.activeshape.fillcolor;h=e._fullLayout.activeshape.opacity}var T=r.append("path").attr(l).style("opacity",h).call(u.stroke,v).call(u.fill,p).call(c.dashLine,m,d);b(T,e,a);var k;if(x||e._context.edits.shapePosition)k=f(e.layout,"shapes",a);if(x){T.style({cursor:"move"});var A={element:T.node(),plotinfo:n,gd:e,editHelpers:k,isActiveShape:true};var S=o(i,e);s(S,T,A)}else{if(e._context.edits.shapePosition){_(e,T,a,t,r,k)}else if(a.editable===true){T.style("pointer-events",g||u.opacity(p)*h<=.5?"stroke":"all")}}T.node().addEventListener("click",(function(){return M(e,T)}))}}function b(e,t,r){var a=(r.xref+r.yref).replace(/paper/g,"").replace(/[xyz][1-9]* *domain/g,"");c.setClipUrl(e,a?"clip"+t._fullLayout._uid+a:null,t)}function _(e,t,r,o,s,l){var u=10;var f=10;var m=r.xsizemode==="pixel";var y=r.ysizemode==="pixel";var x=r.type==="line";var _=r.type==="path";var T=l.modifyItem;var M,A,S,E,L,C;var I,P,O,z,D,R,F,B;var N;var j=i.getFromId(e,r.xref);var U=i.getRefType(r.xref);var V=i.getFromId(e,r.yref);var H=i.getRefType(r.yref);var q=d.getDataToPixel(e,j,false,U);var G=d.getDataToPixel(e,V,true,H);var Y=d.getPixelToData(e,j,false,U);var W=d.getPixelToData(e,V,true,H);var X=K();var Z={element:X.node(),gd:e,prepFn:ee,doneFn:te,clickFn:re};var J;h.init(Z);X.node().onmousemove=$;function K(){return x?Q():t}function Q(){var e=10;var a=Math.max(r.line.width,e);var n=s.append("g").attr("data-index",o);n.append("path").attr("d",t.attr("d")).style({cursor:"move","stroke-width":a,"stroke-opacity":"0"});var i={"fill-opacity":"0"};var l=Math.max(a/2,e);n.append("circle").attr({"data-line-point":"start-point",cx:m?q(r.xanchor)+r.x0:q(r.x0),cy:y?G(r.yanchor)-r.y0:G(r.y0),r:l}).style(i).classed("cursor-grab",true);n.append("circle").attr({"data-line-point":"end-point",cx:m?q(r.xanchor)+r.x1:q(r.x1),cy:y?G(r.yanchor)-r.y1:G(r.y1),r:l}).style(i).classed("cursor-grab",true);return n}function $(r){if(g(e)){J=null;return}if(x){if(r.target.tagName==="path"){J="move"}else{J=r.target.attributes["data-line-point"].value==="start-point"?"resize-over-start-point":"resize-over-end-point"}}else{var a=Z.element.getBoundingClientRect();var n=a.right-a.left;var i=a.bottom-a.top;var o=r.clientX-a.left;var s=r.clientY-a.top;var l=!_&&n>u&&i>f&&!r.shiftKey?h.getCursor(o/n,1-s/i):"move";p(t,l);J=l.split("-")[0]}}function ee(a){if(g(e))return;if(m){L=q(r.xanchor)}if(y){C=G(r.yanchor)}if(r.type==="path"){N=r.path}else{M=m?r.x0:q(r.x0);A=y?r.y0:G(r.y0);S=m?r.x1:q(r.x1);E=y?r.y1:G(r.y1)}if(M<S){O=M;F="x0";z=S;B="x1"}else{O=S;F="x1";z=M;B="x0"}if(!y&&A<E||y&&A>E){I=A;D="y0";P=E;R="y1"}else{I=E;D="y1";P=A;R="y0"}$(a);ie(s,r);se(t,r,e);Z.moveFn=J==="move"?ae:ne;Z.altKey=a.altKey}function te(){if(g(e))return;p(t);oe(s);b(t,e,r);a.call("_guiRelayout",e,l.getUpdateObj())}function re(){if(g(e))return;oe(s)}function ae(a,n){if(r.type==="path"){var i=function(e){return e};var o=i;var l=i;if(m){T("xanchor",r.xanchor=Y(L+a))}else{o=function e(t){return Y(q(t)+a)};if(j&&j.type==="date")o=d.encodeDate(o)}if(y){T("yanchor",r.yanchor=W(C+n))}else{l=function e(t){return W(G(t)+n)};if(V&&V.type==="date")l=d.encodeDate(l)}T("path",r.path=k(N,o,l))}else{if(m){T("xanchor",r.xanchor=Y(L+a))}else{T("x0",r.x0=Y(M+a));T("x1",r.x1=Y(S+a))}if(y){T("yanchor",r.yanchor=W(C+n))}else{T("y0",r.y0=W(A+n));T("y1",r.y1=W(E+n))}}t.attr("d",w(e,r));ie(s,r)}function ne(a,n){if(_){var i=function(e){return e};var o=i;var l=i;if(m){T("xanchor",r.xanchor=Y(L+a))}else{o=function e(t){return Y(q(t)+a)};if(j&&j.type==="date")o=d.encodeDate(o)}if(y){T("yanchor",r.yanchor=W(C+n))}else{l=function e(t){return W(G(t)+n)};if(V&&V.type==="date")l=d.encodeDate(l)}T("path",r.path=k(N,o,l))}else if(x){if(J==="resize-over-start-point"){var c=M+a;var h=y?A-n:A+n;T("x0",r.x0=m?c:Y(c));T("y0",r.y0=y?h:W(h))}else if(J==="resize-over-end-point"){var p=S+a;var v=y?E-n:E+n;T("x1",r.x1=m?p:Y(p));T("y1",r.y1=y?v:W(v))}}else{var g=function(e){return J.indexOf(e)!==-1};var b=g("n");var U=g("s");var H=g("w");var X=g("e");var Z=b?I+n:I;var K=U?P+n:P;var Q=H?O+a:O;var $=X?z+a:z;if(y){if(b)Z=I-n;if(U)K=P-n}if(!y&&K-Z>f||y&&Z-K>f){T(D,r[D]=y?Z:W(Z));T(R,r[R]=y?K:W(K))}if($-Q>u){T(F,r[F]=m?Q:Y(Q));T(B,r[B]=m?$:Y($))}}t.attr("d",w(e,r));ie(s,r)}function ie(e,t){if(m||y){r()}function r(){var r=t.type!=="path";var a=e.selectAll(".visual-cue").data([0]);var i=1;a.enter().append("path").attr({fill:"#fff","fill-rule":"evenodd",stroke:"#000","stroke-width":i}).classed("visual-cue",true);var o=q(m?t.xanchor:n.midRange(r?[t.x0,t.x1]:d.extractPathCoords(t.path,v.paramIsX)));var s=G(y?t.yanchor:n.midRange(r?[t.y0,t.y1]:d.extractPathCoords(t.path,v.paramIsY)));o=d.roundPositionForSharpStrokeRendering(o,i);s=d.roundPositionForSharpStrokeRendering(s,i);if(m&&y){var l="M"+(o-1-i)+","+(s-1-i)+"h-8v2h8 v8h2v-8 h8v-2h-8 v-8h-2 Z";a.attr("d",l)}else if(m){var u="M"+(o-1-i)+","+(s-9-i)+"v18 h2 v-18 Z";a.attr("d",u)}else{var c="M"+(o-9-i)+","+(s-1-i)+"h18 v2 h-18 Z";a.attr("d",c)}}}function oe(e){e.selectAll(".visual-cue").remove()}function se(e,t,r){var a=t.xref;var n=t.yref;var o=i.getFromId(r,a);var s=i.getFromId(r,n);var l="";if(a!=="paper"&&!o.autorange)l+=a;if(n!=="paper"&&!s.autorange)l+=n;c.setClipUrl(e,l?"clip"+r._fullLayout._uid+l:null,r)}}function w(e,t){var r=t.type;var a=i.getRefType(t.xref);var n=i.getRefType(t.yref);var o=i.getFromId(e,t.xref);var s=i.getFromId(e,t.yref);var l=e._fullLayout._size;var u,c,f,h;var p,v,m,g;if(o){if(a==="domain"){c=function(e){return o._offset+o._length*e}}else{u=d.shapePositionToRange(o);c=function(e){return o._offset+o.r2p(u(e,true))}}}else{c=function(e){return l.l+l.w*e}}if(s){if(n==="domain"){h=function(e){return s._offset+s._length*(1-e)}}else{f=d.shapePositionToRange(s);h=function(e){return s._offset+s.r2p(f(e,true))}}}else{h=function(e){return l.t+l.h*(1-e)}}if(r==="path"){if(o&&o.type==="date")c=d.decodeDate(c);if(s&&s.type==="date")h=d.decodeDate(h);return T(t,c,h)}if(t.xsizemode==="pixel"){var y=c(t.xanchor);p=y+t.x0;v=y+t.x1}else{p=c(t.x0);v=c(t.x1)}if(t.ysizemode==="pixel"){var x=h(t.yanchor);m=x-t.y0;g=x-t.y1}else{m=h(t.y0);g=h(t.y1)}if(r==="line")return"M"+p+","+m+"L"+v+","+g;if(r==="rect")return"M"+p+","+m+"H"+v+"V"+g+"H"+p+"Z";var b=(p+v)/2;var _=(m+g)/2;var w=Math.abs(b-p);var k=Math.abs(_-m);var M="A"+w+","+k;var A=b+w+","+_;var S=b+","+(_-k);return"M"+A+M+" 0 1,1 "+S+M+" 0 0,1 "+A+"Z"}function T(e,t,r){var a=e.path;var i=e.xsizemode;var o=e.ysizemode;var s=e.xanchor;var l=e.yanchor;return a.replace(v.segmentRE,(function(e){var a=0;var u=e.charAt(0);var c=v.paramIsX[u];var f=v.paramIsY[u];var h=v.numParams[u];var p=e.substr(1).replace(v.paramRE,(function(e){if(c[a]){if(i==="pixel")e=t(s)+Number(e);else e=t(e)}else if(f[a]){if(o==="pixel")e=r(l)-Number(e);else e=r(e)}a++;if(a>h)e="X";return e}));if(a>h){p=p.replace(/[\s,]*X.*/,"");n.log("Ignoring extra params in segment "+e)}return u+p}))}function k(e,t,r){return e.replace(v.segmentRE,(function(e){var a=0;var n=e.charAt(0);var i=v.paramIsX[n];var o=v.paramIsY[n];var s=v.numParams[n];var l=e.substr(1).replace(v.paramRE,(function(e){if(a>=s)return e;if(i[a])e=t(e);else if(o[a])e=r(e);a++;return e}));return n+l}))}function M(e,t){if(!y(e))return;var r=t.node();var a=+r.getAttribute("data-index");if(a>=0){if(a===e._fullLayout._activeShapeIndex){A(e);return}e._fullLayout._activeShapeIndex=a;e._fullLayout._deactivateShape=A;m(e)}}function A(e){if(!y(e))return;var t=e._fullLayout._activeShapeIndex;if(t>=0){l(e);delete e._fullLayout._activeShapeIndex;m(e)}}function S(e){if(!y(e))return;l(e);var t=e._fullLayout._activeShapeIndex;var r=(e.layout||{}).shapes||[];if(t<r.length){var n=[];for(var i=0;i<r.length;i++){if(i!==t){n.push(r[i])}}delete e._fullLayout._activeShapeIndex;a.call("_guiRelayout",e,{shapes:n})}}},{"../../lib":787,"../../lib/setcursor":808,"../../plot_api/plot_template":827,"../../plots/cartesian/axes":838,"../../plots/cartesian/handle_outline":849,"../../registry":915,"../color":650,"../dragelement":669,"../drawing":672,"./constants":732,"./draw_newshape/display_outlines":738,"./draw_newshape/helpers":739,"./helpers":741}],735:[function(e,t,r){"use strict";var a=e("../../drawing/attributes").dash;var n=e("../../../lib/extend").extendFlat;t.exports={newshape:{line:{color:{valType:"color",editType:"none"},width:{valType:"number",min:0,dflt:4,editType:"none"},dash:n({},a,{dflt:"solid",editType:"none"}),editType:"none"},fillcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"none"},fillrule:{valType:"enumerated",values:["evenodd","nonzero"],dflt:"evenodd",editType:"none"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"none"},layer:{valType:"enumerated",values:["below","above"],dflt:"above",editType:"none"},drawdirection:{valType:"enumerated",values:["ortho","horizontal","vertical","diagonal"],dflt:"diagonal",editType:"none"},editType:"none"},activeshape:{fillcolor:{valType:"color",dflt:"rgb(255,0,255)",editType:"none"},opacity:{valType:"number",min:0,max:1,dflt:.5,editType:"none"},editType:"none"}}},{"../../../lib/extend":777,"../../drawing/attributes":671}],736:[function(e,t,r){"use strict";var a=32;t.exports={CIRCLE_SIDES:a,i000:0,i090:a/4,i180:a/2,i270:a/4*3,cos45:Math.cos(Math.PI/4),sin45:Math.sin(Math.PI/4),SQRT2:Math.sqrt(2)}},{}],737:[function(e,t,r){"use strict";var a=e("../../color");t.exports=function e(t,r,n){n("newshape.drawdirection");n("newshape.layer");n("newshape.fillcolor");n("newshape.fillrule");n("newshape.opacity");var i=n("newshape.line.width");if(i){var o=(t||{}).plot_bgcolor||"#FFF";n("newshape.line.color",a.contrast(o));n("newshape.line.dash")}n("activeshape.fillcolor");n("activeshape.opacity")}},{"../../color":650}],738:[function(e,t,r){"use strict";var a=e("../../dragelement");var n=e("../../dragelement/helpers");var i=n.drawMode;var o=e("../../../registry");var s=e("./constants");var l=s.i000;var u=s.i090;var c=s.i180;var f=s.i270;var h=e("../../../plots/cartesian/handle_outline");var p=h.clearOutlineControllers;var v=e("./helpers");var d=v.pointsShapeRectangle;var m=v.pointsShapeEllipse;var g=v.writePaths;var y=e("./newshapes");t.exports=function e(t,r,n,s){if(!s)s=0;var h=n.gd;function v(){e(t,r,n,s++);if(m(t[0])){b({redrawing:true})}}function b(e){n.isActiveShape=false;var t=y(r,n);if(Object.keys(t).length){o.call((e||{}).redrawing?"relayout":"_guiRelayout",h,t)}}var _=n.isActiveShape;var w=h._fullLayout;var T=w._zoomlayer;var k=n.dragmode;var M=i(k);if(M)h._fullLayout._drawing=true;else if(h._fullLayout._activeShapeIndex>=0)p(h);r.attr("d",g(t));var A;var S;var E;var L;var C;if(_&&!s){C=x([],t);var I=T.append("g").attr("class","outline-controllers");F(I);V()}function P(e){E=+e.srcElement.getAttribute("data-i");L=+e.srcElement.getAttribute("data-j");A[E][L].moveFn=O}function O(e,r){if(!t.length)return;var a=C[E][L][1];var n=C[E][L][2];var i=t[E];var o=i.length;if(d(i)){for(var s=0;s<o;s++){if(s===L)continue;var l=i[s];if(l[1]===i[L][1]){l[1]=a+e}if(l[2]===i[L][2]){l[2]=n+r}}i[L][1]=a+e;i[L][2]=n+r;if(!d(i)){for(var u=0;u<o;u++){for(var c=0;c<i[u].length;c++){i[u][c]=C[E][u][c]}}}}else{i[L][1]=a+e;i[L][2]=n+r}v()}function z(){b()}function D(){if(!t.length)return;if(!t[E])return;if(!t[E].length)return;var e=[];for(var r=0;r<t[E].length;r++){if(r!==L){e.push(t[E][r])}}if(e.length>1&&!(e.length===2&&e[1][0]==="Z")){if(L===0){e[0][0]="M"}t[E]=e;v();b()}}function R(e,r){if(e===2){E=+r.srcElement.getAttribute("data-i");L=+r.srcElement.getAttribute("data-j");var a=t[E];if(!d(a)&&!m(a)){D()}}}function F(e){A=[];for(var r=0;r<t.length;r++){var n=t[r];var i=d(n);var o=!i&&m(n);A[r]=[];for(var s=0;s<n.length;s++){if(n[s][0]==="Z")continue;if(o&&s!==l&&s!==u&&s!==c&&s!==f){continue}var p=n[s][1];var v=n[s][2];var g=e.append("circle").classed("cursor-grab",true).attr("data-i",r).attr("data-j",s).attr("cx",p).attr("cy",v).attr("r",4).style({"mix-blend-mode":"luminosity",fill:"black",stroke:"white","stroke-width":1});A[r][s]={element:g.node(),gd:h,prepFn:P,doneFn:z,clickFn:R};a.init(A[r][s])}}}function B(e,r){if(!t.length)return;for(var a=0;a<t.length;a++){for(var n=0;n<t[a].length;n++){for(var i=0;i+2<t[a][n].length;i+=2){t[a][n][i+1]=C[a][n][i+1]+e;t[a][n][i+2]=C[a][n][i+2]+r}}}}function N(e,t){B(e,t);v()}function j(e){E=+e.srcElement.getAttribute("data-i");if(!E)E=0;S[E].moveFn=N}function U(){b()}function V(){S=[];if(!t.length)return;var e=0;S[e]={element:r[0][0],gd:h,prepFn:j,doneFn:U};a.init(S[e])}};function x(e,t){for(var r=0;r<t.length;r++){var a=t[r];e[r]=[];for(var n=0;n<a.length;n++){e[r][n]=[];for(var i=0;i<a[n].length;i++){e[r][n][i]=a[n][i]}}}return e}},{"../../../plots/cartesian/handle_outline":849,"../../../registry":915,"../../dragelement":669,"../../dragelement/helpers":668,"./constants":736,"./helpers":739,"./newshapes":740}],739:[function(e,t,r){"use strict";var a=e("parse-svg-path");var n=e("./constants");var i=n.CIRCLE_SIDES;var o=n.SQRT2;var s=e("../../../plots/cartesian/helpers");var l=s.p2r;var u=s.r2p;var c=[0,3,4,5,6,1,2];var f=[0,3,4,1,2];r.writePaths=function(e){var t=e.length;if(!t)return"M0,0Z";var r="";for(var a=0;a<t;a++){var n=e[a].length;for(var i=0;i<n;i++){var o=e[a][i][0];if(o==="Z"){r+="Z"}else{var s=e[a][i].length;for(var l=0;l<s;l++){var u=l;if(o==="Q"||o==="S"){u=f[l]}else if(o==="C"){u=c[l]}r+=e[a][i][u];if(l>0&&l<s-1){r+=","}}}}}return r};r.readPaths=function(e,t,r,n){var o=a(e);var s=[];var c=-1;var f=function(){c++;s[c]=[]};var h;var p=0;var v=0;var d;var m;var g=function(){d=p;m=v};g();for(var y=0;y<o.length;y++){var x=[];var b,_,w,T;var k=o[y][0];var M=k;switch(k){case"M":f();p=+o[y][1];v=+o[y][2];x.push([M,p,v]);g();break;case"Q":case"S":b=+o[y][1];w=+o[y][2];p=+o[y][3];v=+o[y][4];x.push([M,p,v,b,w]);break;case"C":b=+o[y][1];w=+o[y][2];_=+o[y][3];T=+o[y][4];p=+o[y][5];v=+o[y][6];x.push([M,p,v,b,w,_,T]);break;case"T":case"L":p=+o[y][1];v=+o[y][2];x.push([M,p,v]);break;case"H":M="L";p=+o[y][1];x.push([M,p,v]);break;case"V":M="L";v=+o[y][1];x.push([M,p,v]);break;case"A":M="L";var A=+o[y][1];var S=+o[y][2];if(!+o[y][4]){A=-A;S=-S}var E=p-A;var L=v;for(h=1;h<=i/2;h++){var C=2*Math.PI*h/i;x.push([M,E+A*Math.cos(C),L+S*Math.sin(C)])}break;case"Z":if(p!==d||v!==m){p=d;v=m;x.push([M,p,v])}break}var I=(r||{}).domain;var P=t._fullLayout._size;var O=r&&r.xsizemode==="pixel";var z=r&&r.ysizemode==="pixel";var D=n===false;for(var R=0;R<x.length;R++){for(h=0;h+2<7;h+=2){var F=x[R][h+1];var B=x[R][h+2];if(F===undefined||B===undefined)continue;p=F;v=B;if(r){if(r.xaxis&&r.xaxis.p2r){if(D)F-=r.xaxis._offset;if(O){F=u(r.xaxis,r.xanchor)+F}else{F=l(r.xaxis,F)}}else{if(D)F-=P.l;if(I)F=I.x[0]+F/P.w;else F=F/P.w}if(r.yaxis&&r.yaxis.p2r){if(D)B-=r.yaxis._offset;if(z){B=u(r.yaxis,r.yanchor)-B}else{B=l(r.yaxis,B)}}else{if(D)B-=P.t;if(I)B=I.y[1]-B/P.h;else B=1-B/P.h}}x[R][h+1]=F;x[R][h+2]=B}s[c].push(x[R].slice())}}return s};function h(e,t){return Math.abs(e-t)<=1e-6}function p(e,t){var r=t[1]-e[1];var a=t[2]-e[2];return Math.sqrt(r*r+a*a)}r.pointsShapeRectangle=function(e){var t=e.length;if(t!==5)return false;for(var r=1;r<3;r++){var a=e[0][r]-e[1][r];var n=e[3][r]-e[2][r];if(!h(a,n))return false;var i=e[0][r]-e[3][r];var o=e[1][r]-e[2][r];if(!h(i,o))return false}if(!h(e[0][1],e[1][1])&&!h(e[0][1],e[3][1]))return false;return!!(p(e[0],e[1])*p(e[0],e[3]))};r.pointsShapeEllipse=function(e){var t=e.length;if(t!==i+1)return false;t=i;for(var r=0;r<t;r++){var a=(t*2-r)%t;var n=(t/2+a)%t;var o=(t/2+r)%t;if(!h(p(e[r],e[o]),p(e[a],e[n])))return false}return true};r.handleEllipse=function(e,t,a){if(!e)return[t,a];var n=r.ellipseOver({x0:t[0],y0:t[1],x1:a[0],y1:a[1]});var s=(n.x1+n.x0)/2;var l=(n.y1+n.y0)/2;var u=(n.x1-n.x0)/2;var c=(n.y1-n.y0)/2;if(!u)u=c=c/o;if(!c)c=u=u/o;var f=[];for(var h=0;h<i;h++){var p=h*2*Math.PI/i;f.push([s+u*Math.cos(p),l+c*Math.sin(p)])}return f};r.ellipseOver=function(e){var t=e.x0;var r=e.y0;var a=e.x1;var n=e.y1;var i=a-t;var s=n-r;t-=i;r-=s;var l=(t+a)/2;var u=(r+n)/2;var c=o;i*=c;s*=c;return{x0:l-i,y0:u-s,x1:l+i,y1:u+s}}},{"../../../plots/cartesian/helpers":850,"./constants":736,"parse-svg-path":482}],740:[function(e,t,r){"use strict";var a=e("../../dragelement/helpers");var n=a.drawMode;var i=a.openMode;var o=e("./constants");var s=o.i000;var l=o.i090;var u=o.i180;var c=o.i270;var f=o.cos45;var h=o.sin45;var p=e("../../../plots/cartesian/helpers");var v=p.p2r;var d=p.r2p;var m=e("../../../plots/cartesian/handle_outline");var g=m.clearSelect;var y=e("./helpers");var x=y.readPaths;var b=y.writePaths;var _=y.ellipseOver;t.exports=function e(t,r){if(!t.length)return;var a=t[0][0];if(!a)return;var o=a.getAttribute("d");var p=r.gd;var m=p._fullLayout.newshape;var y=r.plotinfo;var T=y.xaxis;var k=y.yaxis;var M=!!y.domain||!y.xaxis;var A=!!y.domain||!y.yaxis;var S=r.isActiveShape;var E=r.dragmode;var L=(p.layout||{}).shapes||[];if(!n(E)&&S!==undefined){var C=p._fullLayout._activeShapeIndex;if(C<L.length){switch(p._fullLayout.shapes[C].type){case"rect":E="drawrect";break;case"circle":E="drawcircle";break;case"line":E="drawline";break;case"path":var I=L[C].path||"";if(I[I.length-1]==="Z"){E="drawclosedpath"}else{E="drawopenpath"}break}}}var P=i(E);var O=x(o,p,y,S);var z={editable:true,xref:M?"paper":T._id,yref:A?"paper":k._id,layer:m.layer,opacity:m.opacity,line:{color:m.line.color,width:m.line.width,dash:m.line.dash}};if(!P){z.fillcolor=m.fillcolor;z.fillrule=m.fillrule}var D;if(O.length===1)D=O[0];if(D&&E==="drawrect"){z.type="rect";z.x0=D[0][1];z.y0=D[0][2];z.x1=D[2][1];z.y1=D[2][2]}else if(D&&E==="drawline"){z.type="line";z.x0=D[0][1];z.y0=D[0][2];z.x1=D[1][1];z.y1=D[1][2]}else if(D&&E==="drawcircle"){z.type="circle";var R=D[s][1];var F=D[l][1];var B=D[u][1];var N=D[c][1];var j=D[s][2];var U=D[l][2];var V=D[u][2];var H=D[c][2];var q=y.xaxis&&(y.xaxis.type==="date"||y.xaxis.type==="log");var G=y.yaxis&&(y.yaxis.type==="date"||y.yaxis.type==="log");if(q){R=d(y.xaxis,R);F=d(y.xaxis,F);B=d(y.xaxis,B);N=d(y.xaxis,N)}if(G){j=d(y.yaxis,j);U=d(y.yaxis,U);V=d(y.yaxis,V);H=d(y.yaxis,H)}var Y=(F+N)/2;var W=(j+V)/2;var X=(N-F+B-R)/2;var Z=(H-U+V-j)/2;var J=_({x0:Y,y0:W,x1:Y+X*f,y1:W+Z*h});if(q){J.x0=v(y.xaxis,J.x0);J.x1=v(y.xaxis,J.x1)}if(G){J.y0=v(y.yaxis,J.y0);J.y1=v(y.yaxis,J.y1)}z.x0=J.x0;z.y0=J.y0;z.x1=J.x1;z.y1=J.y1}else{z.type="path";if(T&&k)w(O,T,k);z.path=b(O);D=null}g(p);var K=r.editHelpers;var Q=(K||{}).modifyItem;var $=[];for(var ee=0;ee<L.length;ee++){var te=p._fullLayout.shapes[ee];$[ee]=te._input;if(S!==undefined&&ee===p._fullLayout._activeShapeIndex){var re=z;switch(te.type){case"line":case"rect":case"circle":Q("x0",re.x0);Q("x1",re.x1);Q("y0",re.y0);Q("y1",re.y1);break;case"path":Q("path",re.path);break}}}if(S===undefined){$.push(z);return $}return K?K.getUpdateObj():{}};function w(e,t,r){var a=t.type==="date";var n=r.type==="date";if(!a&&!n)return e;for(var i=0;i<e.length;i++){for(var o=0;o<e[i].length;o++){for(var s=0;s+2<e[i][o].length;s+=2){if(a)e[i][o][s+1]=e[i][o][s+1].replace(" ","_");if(n)e[i][o][s+2]=e[i][o][s+2].replace(" ","_")}}}return e}},{"../../../plots/cartesian/handle_outline":849,"../../../plots/cartesian/helpers":850,"../../dragelement/helpers":668,"./constants":736,"./helpers":739}],741:[function(e,t,r){"use strict";var a=e("./constants");var n=e("../../lib");r.rangeToShapePosition=function(e){return e.type==="log"?e.r2d:function(e){return e}};r.shapePositionToRange=function(e){return e.type==="log"?e.d2r:function(e){return e}};r.decodeDate=function(e){return function(t){if(t.replace)t=t.replace("_"," ");return e(t)}};r.encodeDate=function(e){return function(t){return e(t).replace(" ","_")}};r.extractPathCoords=function(e,t){var r=[];var i=e.match(a.segmentRE);i.forEach((function(e){var i=t[e.charAt(0)].drawn;if(i===undefined)return;var o=e.substr(1).match(a.paramRE);if(!o||o.length<i)return;r.push(n.cleanNumber(o[i]))}));return r};r.getDataToPixel=function(e,t,a,n){var i=e._fullLayout._size;var o;if(t){if(n==="domain"){o=function(e){return t._length*(a?1-e:e)+t._offset}}else{var s=r.shapePositionToRange(t);o=function(e){return t._offset+t.r2p(s(e,true))};if(t.type==="date")o=r.decodeDate(o)}}else if(a){o=function(e){return i.t+i.h*(1-e)}}else{o=function(e){return i.l+i.w*e}}return o};r.getPixelToData=function(e,t,a,n){var i=e._fullLayout._size;var o;if(t){if(n==="domain"){o=function(e){var r=(e-t._offset)/t._length;return a?1-r:r}}else{var s=r.rangeToShapePosition(t);o=function(e){return s(t.p2r(e-t._offset))}}}else if(a){o=function(e){return 1-(e-i.t)/i.h}}else{o=function(e){return(e-i.l)/i.w}}return o};r.roundPositionForSharpStrokeRendering=function(e,t){var r=Math.round(t%2)===1;var a=Math.round(e);return r?a+.5:a};r.makeOptionsAndPlotinfo=function(e,t){var r=e._fullLayout.shapes[t]||{};var a=e._fullLayout._plots[r.xref+r.yref];var n=!!a;if(n){a._hadPlotinfo=true}else{a={};if(r.xref&&r.xref!=="paper")a.xaxis=e._fullLayout[r.xref+"axis"];if(r.yref&&r.yref!=="paper")a.yaxis=e._fullLayout[r.yref+"axis"]}a.xsizemode=r.xsizemode;a.ysizemode=r.ysizemode;a.xanchor=r.xanchor;a.yanchor=r.yanchor;return{options:r,plotinfo:a}}},{"../../lib":787,"./constants":732}],742:[function(e,t,r){"use strict";var a=e("./draw");t.exports={moduleType:"component",name:"shapes",layoutAttributes:e("./attributes"),supplyLayoutDefaults:e("./defaults"),supplyDrawNewShapeDefaults:e("./draw_newshape/defaults"),includeBasePlot:e("../../plots/cartesian/include_components")("shapes"),calcAutorange:e("./calc_autorange"),draw:a.draw,drawOne:a.drawOne}},{"../../plots/cartesian/include_components":851,"./attributes":730,"./calc_autorange":731,"./defaults":733,"./draw":734,"./draw_newshape/defaults":737}],743:[function(e,t,r){"use strict";var a=e("../../plots/font_attributes");var n=e("../../plots/pad_attributes");var i=e("../../lib/extend").extendDeepAll;var o=e("../../plot_api/edit_types").overrideAll;var s=e("../../plots/animation_attributes");var l=e("../../plot_api/plot_template").templatedArray;var u=e("./constants");var c=l("step",{visible:{valType:"boolean",dflt:true},method:{valType:"enumerated",values:["restyle","relayout","animate","update","skip"],dflt:"restyle"},args:{valType:"info_array",freeLength:true,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},label:{valType:"string"},value:{valType:"string"},execute:{valType:"boolean",dflt:true}});t.exports=o(l("slider",{visible:{valType:"boolean",dflt:true},active:{valType:"number",min:0,dflt:0},steps:c,lenmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"fraction"},len:{valType:"number",min:0,dflt:1},x:{valType:"number",min:-2,max:3,dflt:0},pad:i(n({editType:"arraydraw"}),{},{t:{dflt:20}}),xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left"},y:{valType:"number",min:-2,max:3,dflt:0},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"top"},transition:{duration:{valType:"number",min:0,dflt:150},easing:{valType:"enumerated",values:s.transition.easing.values,dflt:"cubic-in-out"}},currentvalue:{visible:{valType:"boolean",dflt:true},xanchor:{valType:"enumerated",values:["left","center","right"],dflt:"left"},offset:{valType:"number",dflt:10},prefix:{valType:"string"},suffix:{valType:"string"},font:a({})},font:a({}),activebgcolor:{valType:"color",dflt:u.gripBgActiveColor},bgcolor:{valType:"color",dflt:u.railBgColor},bordercolor:{valType:"color",dflt:u.railBorderColor},borderwidth:{valType:"number",min:0,dflt:u.railBorderWidth},ticklen:{valType:"number",min:0,dflt:u.tickLength},tickcolor:{valType:"color",dflt:u.tickColor},tickwidth:{valType:"number",min:0,dflt:1},minorticklen:{valType:"number",min:0,dflt:u.minorTickLength}}),"arraydraw","from-root")},{"../../lib/extend":777,"../../plot_api/edit_types":820,"../../plot_api/plot_template":827,"../../plots/animation_attributes":832,"../../plots/font_attributes":867,"../../plots/pad_attributes":900,"./constants":744}],744:[function(e,t,r){"use strict";t.exports={name:"sliders",containerClassName:"slider-container",groupClassName:"slider-group",inputAreaClass:"slider-input-area",railRectClass:"slider-rail-rect",railTouchRectClass:"slider-rail-touch-rect",gripRectClass:"slider-grip-rect",tickRectClass:"slider-tick-rect",inputProxyClass:"slider-input-proxy",labelsClass:"slider-labels",labelGroupClass:"slider-label-group",labelClass:"slider-label",currentValueClass:"slider-current-value",railHeight:5,menuIndexAttrName:"slider-active-index",autoMarginIdRoot:"slider-",minWidth:30,minHeight:30,textPadX:40,arrowOffsetX:4,railRadius:2,railWidth:5,railBorder:4,railBorderWidth:1,railBorderColor:"#bec8d9",railBgColor:"#f8fafc",railInset:8,stepInset:10,gripRadius:10,gripWidth:20,gripHeight:20,gripBorder:20,gripBorderWidth:1,gripBorderColor:"#bec8d9",gripBgColor:"#f6f8fa",gripBgActiveColor:"#dbdde0",labelPadding:8,labelOffset:0,tickWidth:1,tickColor:"#333",tickOffset:25,tickLength:7,minorTickOffset:25,minorTickColor:"#333",minorTickLength:4,currentValuePadding:8,currentValueInset:0}},{}],745:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("../../plots/array_container_defaults");var i=e("./attributes");var o=e("./constants");var s=o.name;var l=i.steps;t.exports=function e(t,r){n(t,r,{name:s,handleItemDefaults:u})};function u(e,t,r){function o(r,n){return a.coerce(e,t,i,r,n)}var s=n(e,t,{name:"steps",handleItemDefaults:c});var l=0;for(var u=0;u<s.length;u++){if(s[u].visible)l++}var f;if(l<2)f=t.visible=false;else f=o("visible");if(!f)return;t._stepCount=l;var h=t._visibleSteps=a.filterVisible(s);var p=o("active");if(!(s[p]||{}).visible)t.active=h[0]._index;o("x");o("y");a.noneOrAll(e,t,["x","y"]);o("xanchor");o("yanchor");o("len");o("lenmode");o("pad.t");o("pad.r");o("pad.b");o("pad.l");a.coerceFont(o,"font",r.font);var v=o("currentvalue.visible");if(v){o("currentvalue.xanchor");o("currentvalue.prefix");o("currentvalue.suffix");o("currentvalue.offset");a.coerceFont(o,"currentvalue.font",t.font)}o("transition.duration");o("transition.easing");o("bgcolor");o("activebgcolor");o("bordercolor");o("borderwidth");o("ticklen");o("tickwidth");o("tickcolor");o("minorticklen")}function c(e,t){function r(r,n){return a.coerce(e,t,l,r,n)}var n;if(e.method!=="skip"&&!Array.isArray(e.args)){n=t.visible=false}else n=r("visible");if(n){r("method");r("args");var i=r("label","step-"+t._index);r("value",i);r("execute")}}},{"../../lib":787,"../../plots/array_container_defaults":833,"./attributes":743,"./constants":744}],746:[function(e,t,r){"use strict";var a=e("@plotly/d3");var n=e("../../plots/plots");var i=e("../color");var o=e("../drawing");var s=e("../../lib");var l=s.strTranslate;var u=e("../../lib/svg_text_utils");var c=e("../../plot_api/plot_template").arrayEditor;var f=e("./constants");var h=e("../../constants/alignment");var p=h.LINE_SPACING;var v=h.FROM_TL;var d=h.FROM_BR;t.exports=function e(t){var r=t._fullLayout;var i=g(r,t);var o=r._infolayer.selectAll("g."+f.containerClassName).data(i.length>0?[0]:[]);o.enter().append("g").classed(f.containerClassName,true).style("cursor","ew-resize");function s(e){if(e._commandObserver){e._commandObserver.remove();delete e._commandObserver}n.autoMargin(t,m(e))}o.exit().each((function(){a.select(this).selectAll("g."+f.groupClassName).each(s)})).remove();if(i.length===0)return;var l=o.selectAll("g."+f.groupClassName).data(i,y);l.enter().append("g").classed(f.groupClassName,true);l.exit().each(s).remove();for(var u=0;u<i.length;u++){var c=i[u];x(t,c)}l.each((function(e){var r=a.select(this);L(e);n.manageCommandObserver(t,e,e._visibleSteps,(function(e){var a=r.data()[0];if(a.active===e.index)return;if(a._dragging)return;A(t,r,a,e.index,false,true)}));b(t,a.select(this),e)}))};function m(e){return f.autoMarginIdRoot+e._index}function g(e,t){var r=e[f.name];var a=[];for(var n=0;n<r.length;n++){var i=r[n];if(!i.visible)continue;i._gd=t;a.push(i)}return a}function y(e){return e._index}function x(e,t){var r=o.tester.selectAll("g."+f.labelGroupClass).data(t._visibleSteps);r.enter().append("g").classed(f.labelGroupClass,true);var i=0;var l=0;r.each((function(e){var r=a.select(this);var n=T(r,{step:e},t);var s=n.node();if(s){var u=o.bBox(s);l=Math.max(l,u.height);i=Math.max(i,u.width)}}));r.remove();var c=t._dims={};c.inputAreaWidth=Math.max(f.railWidth,f.gripHeight);var h=e._fullLayout._size;c.lx=h.l+h.w*t.x;c.ly=h.t+h.h*(1-t.y);if(t.lenmode==="fraction"){c.outerLength=Math.round(h.w*t.len)}else{c.outerLength=t.len}c.inputAreaStart=0;c.inputAreaLength=Math.round(c.outerLength-t.pad.l-t.pad.r);var p=c.inputAreaLength-2*f.stepInset;var g=p/(t._stepCount-1);var y=i+f.labelPadding;c.labelStride=Math.max(1,Math.ceil(y/g));c.labelHeight=l;c.currentValueMaxWidth=0;c.currentValueHeight=0;c.currentValueTotalHeight=0;c.currentValueMaxLines=1;if(t.currentvalue.visible){var x=o.tester.append("g");r.each((function(e){var r=_(x,t,e.label);var a=r.node()&&o.bBox(r.node())||{width:0,height:0};var n=u.lineCount(r);c.currentValueMaxWidth=Math.max(c.currentValueMaxWidth,Math.ceil(a.width));c.currentValueHeight=Math.max(c.currentValueHeight,Math.ceil(a.height));c.currentValueMaxLines=Math.max(c.currentValueMaxLines,n)}));c.currentValueTotalHeight=c.currentValueHeight+t.currentvalue.offset;x.remove()}c.height=c.currentValueTotalHeight+f.tickOffset+t.ticklen+f.labelOffset+c.labelHeight+t.pad.t+t.pad.b;var b="left";if(s.isRightAnchor(t)){c.lx-=c.outerLength;b="right"}if(s.isCenterAnchor(t)){c.lx-=c.outerLength/2;b="center"}var w="top";if(s.isBottomAnchor(t)){c.ly-=c.height;w="bottom"}if(s.isMiddleAnchor(t)){c.ly-=c.height/2;w="middle"}c.outerLength=Math.ceil(c.outerLength);c.height=Math.ceil(c.height);c.lx=Math.round(c.lx);c.ly=Math.round(c.ly);var k={y:t.y,b:c.height*d[w],t:c.height*v[w]};if(t.lenmode==="fraction"){k.l=0;k.xl=t.x-t.len*v[b];k.r=0;k.xr=t.x+t.len*d[b]}else{k.x=t.x;k.l=c.outerLength*v[b];k.r=c.outerLength*d[b]}n.autoMargin(e,m(t),k)}function b(e,t,r){if(!(r.steps[r.active]||{}).visible){r.active=r._visibleSteps[0]._index}t.call(_,r).call(z,r).call(k,r).call(E,r).call(O,e,r).call(w,e,r);var a=r._dims;o.setTranslate(t,a.lx+r.pad.l,a.ly+r.pad.t);t.call(C,r,false);t.call(_,r)}function _(e,t,r){if(!t.currentvalue.visible)return;var a=t._dims;var n,i;switch(t.currentvalue.xanchor){case"right":n=a.inputAreaLength-f.currentValueInset-a.currentValueMaxWidth;i="left";break;case"center":n=a.inputAreaLength*.5;i="middle";break;default:n=f.currentValueInset;i="left"}var l=s.ensureSingle(e,"text",f.labelClass,(function(e){e.attr({"text-anchor":i,"data-notex":1})}));var c=t.currentvalue.prefix?t.currentvalue.prefix:"";if(typeof r==="string"){c+=r}else{var h=t.steps[t.active].label;var v=t._gd._fullLayout._meta;if(v)h=s.templateString(h,v);c+=h}if(t.currentvalue.suffix){c+=t.currentvalue.suffix}l.call(o.font,t.currentvalue.font).text(c).call(u.convertToTspans,t._gd);var d=u.lineCount(l);var m=(a.currentValueMaxLines+1-d)*t.currentvalue.font.size*p;u.positionText(l,n,m);return l}function w(e,t,r){var a=s.ensureSingle(e,"rect",f.gripRectClass,(function(a){a.call(S,t,e,r).style("pointer-events","all")}));a.attr({width:f.gripWidth,height:f.gripHeight,rx:f.gripRadius,ry:f.gripRadius}).call(i.stroke,r.bordercolor).call(i.fill,r.bgcolor).style("stroke-width",r.borderwidth+"px")}function T(e,t,r){var a=s.ensureSingle(e,"text",f.labelClass,(function(e){e.attr({"text-anchor":"middle","data-notex":1})}));var n=t.step.label;var i=r._gd._fullLayout._meta;if(i)n=s.templateString(n,i);a.call(o.font,r.font).text(n).call(u.convertToTspans,r._gd);return a}function k(e,t){var r=s.ensureSingle(e,"g",f.labelsClass);var n=t._dims;var i=r.selectAll("g."+f.labelGroupClass).data(n.labelSteps);i.enter().append("g").classed(f.labelGroupClass,true);i.exit().remove();i.each((function(e){var r=a.select(this);r.call(T,e,t);o.setTranslate(r,I(t,e.fraction),f.tickOffset+t.ticklen+t.font.size*p+f.labelOffset+n.currentValueTotalHeight)}))}function M(e,t,r,a,n){var i=Math.round(a*(r._stepCount-1));var o=r._visibleSteps[i]._index;if(o!==r.active){A(e,t,r,o,true,n)}}function A(e,t,r,a,i,o){var s=r.active;r.active=a;c(e.layout,f.name,r).applyUpdate("active",a);var l=r.steps[r.active];t.call(C,r,o);t.call(_,r);e.emit("plotly_sliderchange",{slider:r,step:r.steps[r.active],interaction:i,previousActive:s});if(l&&l.method&&i){if(t._nextMethod){t._nextMethod.step=l;t._nextMethod.doCallback=i;t._nextMethod.doTransition=o}else{t._nextMethod={step:l,doCallback:i,doTransition:o};t._nextMethodRaf=window.requestAnimationFrame((function(){var r=t._nextMethod.step;if(!r.method)return;if(r.execute){n.executeAPICommand(e,r.method,r.args)}t._nextMethod=null;t._nextMethodRaf=null}))}}}function S(e,t,r){var n=r.node();var o=a.select(t);function s(){return r.data()[0]}function l(){var e=s();t.emit("plotly_sliderstart",{slider:e});var l=r.select("."+f.gripRectClass);a.event.stopPropagation();a.event.preventDefault();l.call(i.fill,e.activebgcolor);var u=P(e,a.mouse(n)[0]);M(t,r,e,u,true);e._dragging=true;function c(){var e=s();var i=P(e,a.mouse(n)[0]);M(t,r,e,i,false)}o.on("mousemove",c);o.on("touchmove",c);function h(){var e=s();e._dragging=false;l.call(i.fill,e.bgcolor);o.on("mouseup",null);o.on("mousemove",null);o.on("touchend",null);o.on("touchmove",null);t.emit("plotly_sliderend",{slider:e,step:e.steps[e.active]})}o.on("mouseup",h);o.on("touchend",h)}e.on("mousedown",l);e.on("touchstart",l)}function E(e,t){var r=e.selectAll("rect."+f.tickRectClass).data(t._visibleSteps);var n=t._dims;r.enter().append("rect").classed(f.tickRectClass,true);r.exit().remove();r.attr({width:t.tickwidth+"px","shape-rendering":"crispEdges"});r.each((function(e,r){var s=r%n.labelStride===0;var l=a.select(this);l.attr({height:s?t.ticklen:t.minorticklen}).call(i.fill,s?t.tickcolor:t.tickcolor);o.setTranslate(l,I(t,r/(t._stepCount-1))-.5*t.tickwidth,(s?f.tickOffset:f.minorTickOffset)+n.currentValueTotalHeight)}))}function L(e){var t=e._dims;t.labelSteps=[];var r=e._stepCount;for(var a=0;a<r;a+=t.labelStride){t.labelSteps.push({fraction:a/(r-1),step:e._visibleSteps[a]})}}function C(e,t,r){var a=e.select("rect."+f.gripRectClass);var n=0;for(var i=0;i<t._stepCount;i++){if(t._visibleSteps[i]._index===t.active){n=i;break}}var o=I(t,n/(t._stepCount-1));if(t._invokingCommand)return;var s=a;if(r&&t.transition.duration>0){s=s.transition().duration(t.transition.duration).ease(t.transition.easing)}s.attr("transform",l(o-f.gripWidth*.5,t._dims.currentValueTotalHeight))}function I(e,t){var r=e._dims;return r.inputAreaStart+f.stepInset+(r.inputAreaLength-2*f.stepInset)*Math.min(1,Math.max(0,t))}function P(e,t){var r=e._dims;return Math.min(1,Math.max(0,(t-f.stepInset-r.inputAreaStart)/(r.inputAreaLength-2*f.stepInset-2*r.inputAreaStart)))}function O(e,t,r){var a=r._dims;var n=s.ensureSingle(e,"rect",f.railTouchRectClass,(function(a){a.call(S,t,e,r).style("pointer-events","all")}));n.attr({width:a.inputAreaLength,height:Math.max(a.inputAreaWidth,f.tickOffset+r.ticklen+a.labelHeight)}).call(i.fill,r.bgcolor).attr("opacity",0);o.setTranslate(n,0,a.currentValueTotalHeight)}function z(e,t){var r=t._dims;var a=r.inputAreaLength-f.railInset*2;var n=s.ensureSingle(e,"rect",f.railRectClass);n.attr({width:a,height:f.railWidth,rx:f.railRadius,ry:f.railRadius,"shape-rendering":"crispEdges"}).call(i.stroke,t.bordercolor).call(i.fill,t.bgcolor).style("stroke-width",t.borderwidth+"px");o.setTranslate(n,f.railInset,(r.inputAreaWidth-f.railWidth)*.5+r.currentValueTotalHeight)}},{"../../constants/alignment":755,"../../lib":787,"../../lib/svg_text_utils":813,"../../plot_api/plot_template":827,"../../plots/plots":901,"../color":650,"../drawing":672,"./constants":744,"@plotly/d3":58}],747:[function(e,t,r){"use strict";var a=e("./constants");t.exports={moduleType:"component",name:a.name,layoutAttributes:e("./attributes"),supplyLayoutDefaults:e("./defaults"),draw:e("./draw")}},{"./attributes":743,"./constants":744,"./defaults":745,"./draw":746}],748:[function(e,t,r){"use strict";var a=e("@plotly/d3");var n=e("fast-isnumeric");var i=e("../../plots/plots");var o=e("../../registry");var s=e("../../lib");var l=s.strTranslate;var u=e("../drawing");var c=e("../color");var f=e("../../lib/svg_text_utils");var h=e("../../constants/interactions");var p=e("../../constants/alignment").OPPOSITE_SIDE;var v=/ [XY][0-9]* /;function d(e,t,r){var d=r.propContainer;var m=r.propName;var g=r.placeholder;var y=r.traceIndex;var x=r.avoid||{};var b=r.attributes;var _=r.transform;var w=r.containerGroup;var T=e._fullLayout;var k=1;var M=false;var A=d.title;var S=(A&&A.text?A.text:"").trim();var E=A&&A.font?A.font:{};var L=E.family;var C=E.size;var I=E.color;var P;if(m==="title.text")P="titleText";else if(m.indexOf("axis")!==-1)P="axisTitleText";else if(m.indexOf("colorbar"!==-1))P="colorbarTitleText";var O=e._context.edits[P];if(S==="")k=0;else if(S.replace(v," % ")===g.replace(v," % ")){k=.2;M=true;if(!O)S=""}if(r._meta){S=s.templateString(S,r._meta)}else if(T._meta){S=s.templateString(S,T._meta)}var z=S||O;if(!w){w=s.ensureSingle(T._infolayer,"g","g-"+t)}var D=w.selectAll("text").data(z?[0]:[]);D.enter().append("text");D.text(S).attr("class",t);D.exit().remove();if(!z)return w;function R(e){s.syncOrAsync([F,B],e)}function F(t){var r;if(_){r="";if(_.rotate){r+="rotate("+[_.rotate,b.x,b.y]+")"}if(_.offset){r+=l(0,_.offset)}}else{r=null}t.attr("transform",r);t.style({"font-family":L,"font-size":a.round(C,2)+"px",fill:c.rgb(I),opacity:k*c.opacity(I),"font-weight":i.fontWeight}).attr(b).call(f.convertToTspans,e);return i.previousPromises(e)}function B(e){var t=a.select(e.node().parentNode);if(x&&x.selection&&x.side&&S){t.attr("transform",null);var r=p[x.side];var i=x.side==="left"||x.side==="top"?-1:1;var o=n(x.pad)?x.pad:2;var c=u.bBox(t.node());var f={left:0,top:0,right:T.width,bottom:T.height};var h=x.maxShift||i*(f[x.side]-c[x.side]);var v=0;if(h<0){v=h}else{var d=x.offsetLeft||0;var m=x.offsetTop||0;c.left-=d;c.right-=d;c.top-=m;c.bottom-=m;x.selection.each((function(){var e=u.bBox(this);if(s.bBoxIntersect(c,e,o)){v=Math.max(v,i*(e[x.side]-c[r])+o)}}));v=Math.min(h,v)}if(v>0||h<0){var g={left:[-v,0],right:[v,0],top:[0,-v],bottom:[0,v]}[x.side];t.attr("transform",l(g[0],g[1]))}}}D.call(R);function N(){k=0;M=true;D.text(g).on("mouseover.opacity",(function(){a.select(this).transition().duration(h.SHOW_PLACEHOLDER).style("opacity",1)})).on("mouseout.opacity",(function(){a.select(this).transition().duration(h.HIDE_PLACEHOLDER).style("opacity",0)}))}if(O){if(!S)N();else D.on(".opacity",null);D.call(f.makeEditable,{gd:e}).on("edit",(function(t){if(y!==undefined){o.call("_guiRestyle",e,m,t,y)}else{o.call("_guiRelayout",e,m,t)}})).on("cancel",(function(){this.text(this.attr("data-unformatted")).call(R)})).on("input",(function(e){this.text(e||" ").call(f.positionText,b.x,b.y)}))}D.classed("js-placeholder",M);return w}t.exports={draw:d}},{"../../constants/alignment":755,"../../constants/interactions":762,"../../lib":787,"../../lib/svg_text_utils":813,"../../plots/plots":901,"../../registry":915,"../color":650,"../drawing":672,"@plotly/d3":58,"fast-isnumeric":246}],749:[function(e,t,r){"use strict";var a=e("../../plots/font_attributes");var n=e("../color/attributes");var i=e("../../lib/extend").extendFlat;var o=e("../../plot_api/edit_types").overrideAll;var s=e("../../plots/pad_attributes");var l=e("../../plot_api/plot_template").templatedArray;var u=l("button",{visible:{valType:"boolean"},method:{valType:"enumerated",values:["restyle","relayout","animate","update","skip"],dflt:"restyle"},args:{valType:"info_array",freeLength:true,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},args2:{valType:"info_array",freeLength:true,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},label:{valType:"string",dflt:""},execute:{valType:"boolean",dflt:true}});t.exports=o(l("updatemenu",{_arrayAttrRegexps:[/^updatemenus\[(0|[1-9][0-9]+)\]\.buttons/],visible:{valType:"boolean"},type:{valType:"enumerated",values:["dropdown","buttons"],dflt:"dropdown"},direction:{valType:"enumerated",values:["left","right","up","down"],dflt:"down"},active:{valType:"integer",min:-1,dflt:0},showactive:{valType:"boolean",dflt:true},buttons:u,x:{valType:"number",min:-2,max:3,dflt:-.05},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"right"},y:{valType:"number",min:-2,max:3,dflt:1},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"top"},pad:i(s({editType:"arraydraw"}),{}),font:a({}),bgcolor:{valType:"color"},bordercolor:{valType:"color",dflt:n.borderLine},borderwidth:{valType:"number",min:0,dflt:1,editType:"arraydraw"}}),"arraydraw","from-root")},{"../../lib/extend":777,"../../plot_api/edit_types":820,"../../plot_api/plot_template":827,"../../plots/font_attributes":867,"../../plots/pad_attributes":900,"../color/attributes":649}],750:[function(e,t,r){"use strict";t.exports={name:"updatemenus",containerClassName:"updatemenu-container",headerGroupClassName:"updatemenu-header-group",headerClassName:"updatemenu-header",headerArrowClassName:"updatemenu-header-arrow",dropdownButtonGroupClassName:"updatemenu-dropdown-button-group",dropdownButtonClassName:"updatemenu-dropdown-button",buttonClassName:"updatemenu-button",itemRectClassName:"updatemenu-item-rect",itemTextClassName:"updatemenu-item-text",menuIndexAttrName:"updatemenu-active-index",autoMarginIdRoot:"updatemenu-",blankHeaderOpts:{label:"  "},minWidth:30,minHeight:30,textPadX:24,arrowPadX:16,rx:2,ry:2,textOffsetX:12,textOffsetY:3,arrowOffsetX:4,gapButtonHeader:5,gapButton:2,activeColor:"#F4FAFF",hoverColor:"#F4FAFF",arrowSymbol:{left:"◄",right:"►",up:"▲",down:"▼"}}},{}],751:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("../../plots/array_container_defaults");var i=e("./attributes");var o=e("./constants");var s=o.name;var l=i.buttons;t.exports=function e(t,r){var a={name:s,handleItemDefaults:u};n(t,r,a)};function u(e,t,r){function o(r,n){return a.coerce(e,t,i,r,n)}var s=n(e,t,{name:"buttons",handleItemDefaults:c});var l=o("visible",s.length>0);if(!l)return;o("active");o("direction");o("type");o("showactive");o("x");o("y");a.noneOrAll(e,t,["x","y"]);o("xanchor");o("yanchor");o("pad.t");o("pad.r");o("pad.b");o("pad.l");a.coerceFont(o,"font",r.font);o("bgcolor",r.paper_bgcolor);o("bordercolor");o("borderwidth")}function c(e,t){function r(r,n){return a.coerce(e,t,l,r,n)}var n=r("visible",e.method==="skip"||Array.isArray(e.args));if(n){r("method");r("args");r("args2");r("label");r("execute")}}},{"../../lib":787,"../../plots/array_container_defaults":833,"./attributes":749,"./constants":750}],752:[function(e,t,r){"use strict";var a=e("@plotly/d3");var n=e("../../plots/plots");var i=e("../color");var o=e("../drawing");var s=e("../../lib");var l=e("../../lib/svg_text_utils");var u=e("../../plot_api/plot_template").arrayEditor;var c=e("../../constants/alignment").LINE_SPACING;var f=e("./constants");var h=e("./scrollbox");t.exports=function e(t){var r=t._fullLayout;var i=s.filterVisible(r[f.name]);function o(e){n.autoMargin(t,E(e))}var l=r._menulayer.selectAll("g."+f.containerClassName).data(i.length>0?[0]:[]);l.enter().append("g").classed(f.containerClassName,true).style("cursor","pointer");l.exit().each((function(){a.select(this).selectAll("g."+f.headerGroupClassName).each(o)})).remove();if(i.length===0)return;var u=l.selectAll("g."+f.headerGroupClassName).data(i,p);u.enter().append("g").classed(f.headerGroupClassName,true);var c=s.ensureSingle(l,"g",f.dropdownButtonGroupClassName,(function(e){e.style("pointer-events","all")}));for(var v=0;v<i.length;v++){var x=i[v];S(t,x)}var b="updatemenus"+r._uid;var _=new h(t,c,b);if(u.enter().size()){c.node().parentNode.appendChild(c.node());c.call(C)}u.exit().each((function(e){c.call(C);o(e)})).remove();u.each((function(e){var r=a.select(this);var i=e.type==="dropdown"?c:null;n.manageCommandObserver(t,e,e.buttons,(function(a){m(t,e,e.buttons[a.index],r,i,_,a.index,true)}));if(e.type==="dropdown"){g(t,r,c,_,e);if(d(c,e)){y(t,r,c,_,e)}}else{y(t,r,null,null,e)}}))};function p(e){return e._index}function v(e){return+e.attr(f.menuIndexAttrName)===-1}function d(e,t){return+e.attr(f.menuIndexAttrName)===t._index}function m(e,t,r,a,n,i,o,s){t.active=o;u(e.layout,f.name,t).applyUpdate("active",o);if(t.type==="buttons"){y(e,a,null,null,t)}else if(t.type==="dropdown"){n.attr(f.menuIndexAttrName,"-1");g(e,a,n,i,t);if(!s){y(e,a,n,i,t)}}}function g(e,t,r,a,n){var i=s.ensureSingle(t,"g",f.headerClassName,(function(e){e.style("pointer-events","all")}));var l=n._dims;var u=n.active;var c=n.buttons[u]||f.blankHeaderOpts;var h={y:n.pad.t,yPad:0,x:n.pad.l,xPad:0,index:0};var p={width:l.headerWidth,height:l.headerHeight};i.call(_,n,c,e).call(L,n,h,p);var v=s.ensureSingle(t,"text",f.headerArrowClassName,(function(e){e.attr("text-anchor","end").call(o.font,n.font).text(f.arrowSymbol[n.direction])}));v.attr({x:l.headerWidth-f.arrowOffsetX+n.pad.l,y:l.headerHeight/2+f.textOffsetY+n.pad.t});i.on("click",(function(){r.call(C,String(d(r,n)?-1:n._index));y(e,t,r,a,n)}));i.on("mouseover",(function(){i.call(M)}));i.on("mouseout",(function(){i.call(A,n)}));o.setTranslate(t,l.lx,l.ly)}function y(e,t,r,i,o){if(!r){r=t;r.attr("pointer-events","all")}var l=!v(r)||o.type==="buttons"?o.buttons:[];var u=o.type==="dropdown"?f.dropdownButtonClassName:f.buttonClassName;var c=r.selectAll("g."+u).data(s.filterVisible(l));var h=c.enter().append("g").classed(u,true);var p=c.exit();if(o.type==="dropdown"){h.attr("opacity","0").transition().attr("opacity","1");p.transition().attr("opacity","0").remove()}else{p.remove()}var d=0;var g=0;var y=o._dims;var w=["up","down"].indexOf(o.direction)!==-1;if(o.type==="dropdown"){if(w){g=y.headerHeight+f.gapButtonHeader}else{d=y.headerWidth+f.gapButtonHeader}}if(o.type==="dropdown"&&o.direction==="up"){g=-f.gapButtonHeader+f.gapButton-y.openHeight}if(o.type==="dropdown"&&o.direction==="left"){d=-f.gapButtonHeader+f.gapButton-y.openWidth}var T={x:y.lx+d+o.pad.l,y:y.ly+g+o.pad.t,yPad:f.gapButton,xPad:f.gapButton,index:0};var S={l:T.x+o.borderwidth,t:T.y+o.borderwidth};c.each((function(s,l){var u=a.select(this);u.call(_,o,s,e).call(L,o,T);u.on("click",(function(){if(a.event.defaultPrevented)return;if(s.execute){if(s.args2&&o.active===l){m(e,o,s,t,r,i,-1);n.executeAPICommand(e,s.method,s.args2)}else{m(e,o,s,t,r,i,l);n.executeAPICommand(e,s.method,s.args)}}e.emit("plotly_buttonclicked",{menu:o,button:s,active:o.active})}));u.on("mouseover",(function(){u.call(M)}));u.on("mouseout",(function(){u.call(A,o);c.call(k,o)}))}));c.call(k,o);if(w){S.w=Math.max(y.openWidth,y.headerWidth);S.h=T.y-S.t}else{S.w=T.x-S.l;S.h=Math.max(y.openHeight,y.headerHeight)}S.direction=o.direction;if(i){if(c.size()){x(e,t,r,i,o,S)}else{b(i)}}}function x(e,t,r,a,n,i){var o=n.direction;var s=o==="up"||o==="down";var l=n._dims;var u=n.active;var c,h;var p;if(s){h=0;for(p=0;p<u;p++){h+=l.heights[p]+f.gapButton}}else{c=0;for(p=0;p<u;p++){c+=l.widths[p]+f.gapButton}}a.enable(i,c,h);if(a.hbar){a.hbar.attr("opacity","0").transition().attr("opacity","1")}if(a.vbar){a.vbar.attr("opacity","0").transition().attr("opacity","1")}}function b(e){var t=!!e.hbar;var r=!!e.vbar;if(t){e.hbar.transition().attr("opacity","0").each("end",(function(){t=false;if(!r)e.disable()}))}if(r){e.vbar.transition().attr("opacity","0").each("end",(function(){r=false;if(!t)e.disable()}))}}function _(e,t,r,a){e.call(w,t).call(T,t,r,a)}function w(e,t){var r=s.ensureSingle(e,"rect",f.itemRectClassName,(function(e){e.attr({rx:f.rx,ry:f.ry,"shape-rendering":"crispEdges"})}));r.call(i.stroke,t.bordercolor).call(i.fill,t.bgcolor).style("stroke-width",t.borderwidth+"px")}function T(e,t,r,a){var n=s.ensureSingle(e,"text",f.itemTextClassName,(function(e){e.attr({"text-anchor":"start","data-notex":1})}));var i=r.label;var u=a._fullLayout._meta;if(u)i=s.templateString(i,u);n.call(o.font,t.font).text(i).call(l.convertToTspans,a)}function k(e,t){var r=t.active;e.each((function(e,n){var o=a.select(this);if(n===r&&t.showactive){o.select("rect."+f.itemRectClassName).call(i.fill,f.activeColor)}}))}function M(e){e.select("rect."+f.itemRectClassName).call(i.fill,f.hoverColor)}function A(e,t){e.select("rect."+f.itemRectClassName).call(i.fill,t.bgcolor)}function S(e,t){var r=t._dims={width1:0,height1:0,heights:[],widths:[],totalWidth:0,totalHeight:0,openWidth:0,openHeight:0,lx:0,ly:0};var i=o.tester.selectAll("g."+f.dropdownButtonClassName).data(s.filterVisible(t.buttons));i.enter().append("g").classed(f.dropdownButtonClassName,true);var u=["up","down"].indexOf(t.direction)!==-1;i.each((function(n,i){var s=a.select(this);s.call(_,t,n,e);var h=s.select("."+f.itemTextClassName);var p=h.node()&&o.bBox(h.node()).width;var v=Math.max(p+f.textPadX,f.minWidth);var d=t.font.size*c;var m=l.lineCount(h);var g=Math.max(d*m,f.minHeight)+f.textOffsetY;g=Math.ceil(g);v=Math.ceil(v);r.widths[i]=v;r.heights[i]=g;r.height1=Math.max(r.height1,g);r.width1=Math.max(r.width1,v);if(u){r.totalWidth=Math.max(r.totalWidth,v);r.openWidth=r.totalWidth;r.totalHeight+=g+f.gapButton;r.openHeight+=g+f.gapButton}else{r.totalWidth+=v+f.gapButton;r.openWidth+=v+f.gapButton;r.totalHeight=Math.max(r.totalHeight,g);r.openHeight=r.totalHeight}}));if(u){r.totalHeight-=f.gapButton}else{r.totalWidth-=f.gapButton}r.headerWidth=r.width1+f.arrowPadX;r.headerHeight=r.height1;if(t.type==="dropdown"){if(u){r.width1+=f.arrowPadX;r.totalHeight=r.height1}else{r.totalWidth=r.width1}r.totalWidth+=f.arrowPadX}i.remove();var h=r.totalWidth+t.pad.l+t.pad.r;var p=r.totalHeight+t.pad.t+t.pad.b;var v=e._fullLayout._size;r.lx=v.l+v.w*t.x;r.ly=v.t+v.h*(1-t.y);var d="left";if(s.isRightAnchor(t)){r.lx-=h;d="right"}if(s.isCenterAnchor(t)){r.lx-=h/2;d="center"}var m="top";if(s.isBottomAnchor(t)){r.ly-=p;m="bottom"}if(s.isMiddleAnchor(t)){r.ly-=p/2;m="middle"}r.totalWidth=Math.ceil(r.totalWidth);r.totalHeight=Math.ceil(r.totalHeight);r.lx=Math.round(r.lx);r.ly=Math.round(r.ly);n.autoMargin(e,E(t),{x:t.x,y:t.y,l:h*({right:1,center:.5}[d]||0),r:h*({left:1,center:.5}[d]||0),b:p*({top:1,middle:.5}[m]||0),t:p*({bottom:1,middle:.5}[m]||0)})}function E(e){return f.autoMarginIdRoot+e._index}function L(e,t,r,a){a=a||{};var n=e.select("."+f.itemRectClassName);var i=e.select("."+f.itemTextClassName);var s=t.borderwidth;var u=r.index;var h=t._dims;o.setTranslate(e,s+r.x,s+r.y);var p=["up","down"].indexOf(t.direction)!==-1;var v=a.height||(p?h.heights[u]:h.height1);n.attr({x:0,y:0,width:a.width||(p?h.width1:h.widths[u]),height:v});var d=t.font.size*c;var m=l.lineCount(i);var g=(m-1)*d/2;l.positionText(i,f.textOffsetX,v/2-g+f.textOffsetY);if(p){r.y+=h.heights[u]+r.yPad}else{r.x+=h.widths[u]+r.xPad}r.index++}function C(e,t){e.attr(f.menuIndexAttrName,t||"-1").selectAll("g."+f.dropdownButtonClassName).remove()}},{"../../constants/alignment":755,"../../lib":787,"../../lib/svg_text_utils":813,"../../plot_api/plot_template":827,"../../plots/plots":901,"../color":650,"../drawing":672,"./constants":750,"./scrollbox":754,"@plotly/d3":58}],753:[function(e,t,r){arguments[4][747][0].apply(r,arguments)},{"./attributes":749,"./constants":750,"./defaults":751,"./draw":752,dup:747}],754:[function(e,t,r){"use strict";t.exports=s;var a=e("@plotly/d3");var n=e("../color");var i=e("../drawing");var o=e("../../lib");function s(e,t,r){this.gd=e;this.container=t;this.id=r;this.position=null;this.translateX=null;this.translateY=null;this.hbar=null;this.vbar=null;this.bg=this.container.selectAll("rect.scrollbox-bg").data([0]);this.bg.exit().on(".drag",null).on("wheel",null).remove();this.bg.enter().append("rect").classed("scrollbox-bg",true).style("pointer-events","all").attr({opacity:0,x:0,y:0,width:0,height:0})}s.barWidth=2;s.barLength=20;s.barRadius=2;s.barPad=1;s.barColor="#808BA4";s.prototype.enable=function e(t,r,o){var l=this.gd._fullLayout;var u=l.width;var c=l.height;this.position=t;var f=this.position.l;var h=this.position.w;var p=this.position.t;var v=this.position.h;var d=this.position.direction;var m=d==="down";var g=d==="left";var y=d==="right";var x=d==="up";var b=h;var _=v;var w,T;var k,M;if(!m&&!g&&!y&&!x){this.position.direction="down";m=true}var A=m||x;if(A){w=f;T=w+b;if(m){k=p;M=Math.min(k+_,c);_=M-k}else{M=p+_;k=Math.max(M-_,0);_=M-k}}else{k=p;M=k+_;if(g){T=f+b;w=Math.max(T-b,0);b=T-w}else{w=f;T=Math.min(w+b,u);b=T-w}}this._box={l:w,t:k,w:b,h:_};var S=h>b;var E=s.barLength+2*s.barPad;var L=s.barWidth+2*s.barPad;var C=f;var I=p+v;if(I+L>c)I=c-L;var P=this.container.selectAll("rect.scrollbar-horizontal").data(S?[0]:[]);P.exit().on(".drag",null).remove();P.enter().append("rect").classed("scrollbar-horizontal",true).call(n.fill,s.barColor);if(S){this.hbar=P.attr({rx:s.barRadius,ry:s.barRadius,x:C,y:I,width:E,height:L});this._hbarXMin=C+E/2;this._hbarTranslateMax=b-E}else{delete this.hbar;delete this._hbarXMin;delete this._hbarTranslateMax}var O=v>_;var z=s.barWidth+2*s.barPad;var D=s.barLength+2*s.barPad;var R=f+h;var F=p;if(R+z>u)R=u-z;var B=this.container.selectAll("rect.scrollbar-vertical").data(O?[0]:[]);B.exit().on(".drag",null).remove();B.enter().append("rect").classed("scrollbar-vertical",true).call(n.fill,s.barColor);if(O){this.vbar=B.attr({rx:s.barRadius,ry:s.barRadius,x:R,y:F,width:z,height:D});this._vbarYMin=F+D/2;this._vbarTranslateMax=_-D}else{delete this.vbar;delete this._vbarYMin;delete this._vbarTranslateMax}var N=this.id;var j=w-.5;var U=O?T+z+.5:T+.5;var V=k-.5;var H=S?M+L+.5:M+.5;var q=l._topdefs.selectAll("#"+N).data(S||O?[0]:[]);q.exit().remove();q.enter().append("clipPath").attr("id",N).append("rect");if(S||O){this._clipRect=q.select("rect").attr({x:Math.floor(j),y:Math.floor(V),width:Math.ceil(U)-Math.floor(j),height:Math.ceil(H)-Math.floor(V)});this.container.call(i.setClipUrl,N,this.gd);this.bg.attr({x:f,y:p,width:h,height:v})}else{this.bg.attr({width:0,height:0});this.container.on("wheel",null).on(".drag",null).call(i.setClipUrl,null);delete this._clipRect}if(S||O){var G=a.behavior.drag().on("dragstart",(function(){a.event.sourceEvent.preventDefault()})).on("drag",this._onBoxDrag.bind(this));this.container.on("wheel",null).on("wheel",this._onBoxWheel.bind(this)).on(".drag",null).call(G);var Y=a.behavior.drag().on("dragstart",(function(){a.event.sourceEvent.preventDefault();a.event.sourceEvent.stopPropagation()})).on("drag",this._onBarDrag.bind(this));if(S){this.hbar.on(".drag",null).call(Y)}if(O){this.vbar.on(".drag",null).call(Y)}}this.setTranslate(r,o)};s.prototype.disable=function e(){if(this.hbar||this.vbar){this.bg.attr({width:0,height:0});this.container.on("wheel",null).on(".drag",null).call(i.setClipUrl,null);delete this._clipRect}if(this.hbar){this.hbar.on(".drag",null);this.hbar.remove();delete this.hbar;delete this._hbarXMin;delete this._hbarTranslateMax}if(this.vbar){this.vbar.on(".drag",null);this.vbar.remove();delete this.vbar;delete this._vbarYMin;delete this._vbarTranslateMax}};s.prototype._onBoxDrag=function e(){var t=this.translateX;var r=this.translateY;if(this.hbar){t-=a.event.dx}if(this.vbar){r-=a.event.dy}this.setTranslate(t,r)};s.prototype._onBoxWheel=function e(){var t=this.translateX;var r=this.translateY;if(this.hbar){t+=a.event.deltaY}if(this.vbar){r+=a.event.deltaY}this.setTranslate(t,r)};s.prototype._onBarDrag=function e(){var t=this.translateX;var r=this.translateY;if(this.hbar){var n=t+this._hbarXMin;var i=n+this._hbarTranslateMax;var s=o.constrain(a.event.x,n,i);var l=(s-n)/(i-n);var u=this.position.w-this._box.w;t=l*u}if(this.vbar){var c=r+this._vbarYMin;var f=c+this._vbarTranslateMax;var h=o.constrain(a.event.y,c,f);var p=(h-c)/(f-c);var v=this.position.h-this._box.h;r=p*v}this.setTranslate(t,r)};s.prototype.setTranslate=function e(t,r){var a=this.position.w-this._box.w;var n=this.position.h-this._box.h;t=o.constrain(t||0,0,a);r=o.constrain(r||0,0,n);this.translateX=t;this.translateY=r;this.container.call(i.setTranslate,this._box.l-this.position.l-t,this._box.t-this.position.t-r);if(this._clipRect){this._clipRect.attr({x:Math.floor(this.position.l+t-.5),y:Math.floor(this.position.t+r-.5)})}if(this.hbar){var s=t/a;this.hbar.call(i.setTranslate,t+s*this._hbarTranslateMax,r)}if(this.vbar){var l=r/n;this.vbar.call(i.setTranslate,t,r+l*this._vbarTranslateMax)}}},{"../../lib":787,"../color":650,"../drawing":672,"@plotly/d3":58}],755:[function(e,t,r){"use strict";t.exports={FROM_BL:{left:0,center:.5,right:1,bottom:0,middle:.5,top:1},FROM_TL:{left:0,center:.5,right:1,bottom:1,middle:.5,top:0},FROM_BR:{left:1,center:.5,right:0,bottom:0,middle:.5,top:1},LINE_SPACING:1.3,CAP_SHIFT:.7,MID_SHIFT:.35,OPPOSITE_SIDE:{left:"right",right:"left",top:"bottom",bottom:"top"}}},{}],756:[function(e,t,r){"use strict";t.exports={axisRefDescription:function(e,t,r){return["If set to a",e,"axis id (e.g. *"+e+"* or","*"+e+"2*), the `"+e+"` position refers to a",e,"coordinate. If set to *paper*, the `"+e+"`","position refers to the distance from the",t,"of the plotting","area in normalized coordinates where *0* (*1*) corresponds to the",t,"("+r+"). If set to a",e,"axis ID followed by","*domain* (separated by a space), the position behaves like for","*paper*, but refers to the distance in fractions of the domain","length from the",t,"of the domain of that axis: e.g.,","*"+e+"2 domain* refers to the domain of the second",e," axis and a",e,"position of 0.5 refers to the","point between the",t,"and the",r,"of the domain of the","second",e,"axis."].join(" ")}}},{}],757:[function(e,t,r){"use strict";t.exports={INCREASING:{COLOR:"#3D9970",SYMBOL:"▲"},DECREASING:{COLOR:"#FF4136",SYMBOL:"▼"}}},{}],758:[function(e,t,r){"use strict";t.exports={FORMAT_LINK:"https://github.com/d3/d3-format/tree/v1.4.5#d3-format",DATE_FORMAT_LINK:"https://github.com/d3/d3-time-format/tree/v2.2.3#locale_format"}},{}],759:[function(e,t,r){"use strict";t.exports={COMPARISON_OPS:["=","!=","<",">=",">","<="],COMPARISON_OPS2:["=","<",">=",">","<="],INTERVAL_OPS:["[]","()","[)","(]","][",")(","](",")["],SET_OPS:["{}","}{"],CONSTRAINT_REDUCTION:{"=":"=","<":"<","<=":"<",">":">",">=":">","[]":"[]","()":"[]","[)":"[]","(]":"[]","][":"][",")(":"][","](":"][",")[":"]["}}},{}],760:[function(e,t,r){"use strict";t.exports={solid:[[],0],dot:[[.5,1],200],dash:[[.5,1],50],longdash:[[.5,1],10],dashdot:[[.5,.625,.875,1],50],longdashdot:[[.5,.7,.8,1],10]}},{}],761:[function(e,t,r){"use strict";t.exports={circle:"●","circle-open":"○",square:"■","square-open":"□",diamond:"◆","diamond-open":"◇",cross:"+",x:"❌"}},{}],762:[function(e,t,r){"use strict";t.exports={SHOW_PLACEHOLDER:100,HIDE_PLACEHOLDER:1e3,DESELECTDIM:.2}},{}],763:[function(e,t,r){"use strict";t.exports={BADNUM:undefined,FP_SAFE:Number.MAX_VALUE*1e-4,ONEMAXYEAR:316224e5,ONEAVGYEAR:315576e5,ONEMINYEAR:31536e6,ONEMAXQUARTER:79488e5,ONEAVGQUARTER:78894e5,ONEMINQUARTER:76896e5,ONEMAXMONTH:26784e5,ONEAVGMONTH:26298e5,ONEMINMONTH:24192e5,ONEWEEK:6048e5,ONEDAY:864e5,ONEHOUR:36e5,ONEMIN:6e4,ONESEC:1e3,EPOCHJD:2440587.5,ALMOST_EQUAL:1-1e-6,LOG_CLIP:10,MINUS_SIGN:"−"}},{}],764:[function(e,t,r){"use strict";r.xmlns="http://www.w3.org/2000/xmlns/";r.svg="http://www.w3.org/2000/svg";r.xlink="http://www.w3.org/1999/xlink";r.svgAttrs={xmlns:r.svg,"xmlns:xlink":r.xlink}},{}],765:[function(e,t,r){"use strict";r.version=e("./version").version;e("native-promise-only");e("../build/plotcss");var a=e("./registry");var n=r.register=a.register;var i=e("./plot_api");var o=Object.keys(i);for(var s=0;s<o.length;s++){var l=o[s];if(l.charAt(0)!=="_")r[l]=i[l];n({moduleType:"apiMethod",name:l,fn:i[l]})}n(e("./traces/scatter"));n([e("./components/legend"),e("./components/fx"),e("./components/annotations"),e("./components/annotations3d"),e("./components/shapes"),e("./components/images"),e("./components/updatemenus"),e("./components/sliders"),e("./components/rangeslider"),e("./components/rangeselector"),e("./components/grid"),e("./components/errorbars"),e("./components/colorscale"),e("./components/colorbar"),e("./components/modebar")]);n([e("./locale-en"),e("./locale-en-us")]);if(window.PlotlyLocales&&Array.isArray(window.PlotlyLocales)){n(window.PlotlyLocales);delete window.PlotlyLocales}r.Icons=e("./fonts/ploticon");var u=e("./components/fx");var c=e("./plots/plots");r.Plots={resize:c.resize,graphJson:c.graphJson,sendDataToCloud:c.sendDataToCloud};r.Fx={hover:u.hover,unhover:u.unhover,loneHover:u.loneHover,loneUnhover:u.loneUnhover};r.Snapshot=e("./snapshot");r.PlotSchema=e("./plot_api/plot_schema")},{"../build/plotcss":1,"./components/annotations":641,"./components/annotations3d":646,"./components/colorbar":656,"./components/colorscale":662,"./components/errorbars":678,"./components/fx":690,"./components/grid":694,"./components/images":699,"./components/legend":707,"./components/modebar":713,"./components/rangeselector":721,"./components/rangeslider":728,"./components/shapes":742,"./components/sliders":747,"./components/updatemenus":753,"./fonts/ploticon":766,"./locale-en":818,"./locale-en-us":817,"./plot_api":822,"./plot_api/plot_schema":826,"./plots/plots":901,"./registry":915,"./snapshot":920,"./traces/scatter":1214,"./version":1388,"native-promise-only":463}],766:[function(e,t,r){"use strict";t.exports={undo:{width:857.1,height:1e3,path:"m857 350q0-87-34-166t-91-137-137-92-166-34q-96 0-183 41t-147 114q-4 6-4 13t5 11l76 77q6 5 14 5 9-1 13-7 41-53 100-82t126-29q58 0 110 23t92 61 61 91 22 111-22 111-61 91-92 61-110 23q-55 0-105-20t-90-57l77-77q17-16 8-38-10-23-33-23h-250q-15 0-25 11t-11 25v250q0 24 22 33 22 10 39-8l72-72q60 57 137 88t159 31q87 0 166-34t137-92 91-137 34-166z",transform:"matrix(1 0 0 -1 0 850)"},home:{width:928.6,height:1e3,path:"m786 296v-267q0-15-11-26t-25-10h-214v214h-143v-214h-214q-15 0-25 10t-11 26v267q0 1 0 2t0 2l321 264 321-264q1-1 1-4z m124 39l-34-41q-5-5-12-6h-2q-7 0-12 3l-386 322-386-322q-7-4-13-4-7 2-12 7l-35 41q-4 5-3 13t6 12l401 334q18 15 42 15t43-15l136-114v109q0 8 5 13t13 5h107q8 0 13-5t5-13v-227l122-102q5-5 6-12t-4-13z",transform:"matrix(1 0 0 -1 0 850)"},"camera-retro":{width:1e3,height:1e3,path:"m518 386q0 8-5 13t-13 5q-37 0-63-27t-26-63q0-8 5-13t13-5 12 5 5 13q0 23 16 38t38 16q8 0 13 5t5 13z m125-73q0-59-42-101t-101-42-101 42-42 101 42 101 101 42 101-42 42-101z m-572-320h858v71h-858v-71z m643 320q0 89-62 152t-152 62-151-62-63-152 63-151 151-63 152 63 62 151z m-571 358h214v72h-214v-72z m-72-107h858v143h-462l-36-71h-360v-72z m929 143v-714q0-30-21-51t-50-21h-858q-29 0-50 21t-21 51v714q0 30 21 51t50 21h858q29 0 50-21t21-51z",transform:"matrix(1 0 0 -1 0 850)"},zoombox:{width:1e3,height:1e3,path:"m1000-25l-250 251c40 63 63 138 63 218 0 224-182 406-407 406-224 0-406-182-406-406s183-406 407-406c80 0 155 22 218 62l250-250 125 125z m-812 250l0 438 437 0 0-438-437 0z m62 375l313 0 0-312-313 0 0 312z",transform:"matrix(1 0 0 -1 0 850)"},pan:{width:1e3,height:1e3,path:"m1000 350l-187 188 0-125-250 0 0 250 125 0-188 187-187-187 125 0 0-250-250 0 0 125-188-188 186-187 0 125 252 0 0-250-125 0 187-188 188 188-125 0 0 250 250 0 0-126 187 188z",transform:"matrix(1 0 0 -1 0 850)"},zoom_plus:{width:875,height:1e3,path:"m1 787l0-875 875 0 0 875-875 0z m687-500l-187 0 0-187-125 0 0 187-188 0 0 125 188 0 0 187 125 0 0-187 187 0 0-125z",transform:"matrix(1 0 0 -1 0 850)"},zoom_minus:{width:875,height:1e3,path:"m0 788l0-876 875 0 0 876-875 0z m688-500l-500 0 0 125 500 0 0-125z",transform:"matrix(1 0 0 -1 0 850)"},autoscale:{width:1e3,height:1e3,path:"m250 850l-187 0-63 0 0-62 0-188 63 0 0 188 187 0 0 62z m688 0l-188 0 0-62 188 0 0-188 62 0 0 188 0 62-62 0z m-875-938l0 188-63 0 0-188 0-62 63 0 187 0 0 62-187 0z m875 188l0-188-188 0 0-62 188 0 62 0 0 62 0 188-62 0z m-125 188l-1 0-93-94-156 156 156 156 92-93 2 0 0 250-250 0 0-2 93-92-156-156-156 156 94 92 0 2-250 0 0-250 0 0 93 93 157-156-157-156-93 94 0 0 0-250 250 0 0 0-94 93 156 157 156-157-93-93 0 0 250 0 0 250z",transform:"matrix(1 0 0 -1 0 850)"},tooltip_basic:{width:1500,height:1e3,path:"m375 725l0 0-375-375 375-374 0-1 1125 0 0 750-1125 0z",transform:"matrix(1 0 0 -1 0 850)"},tooltip_compare:{width:1125,height:1e3,path:"m187 786l0 2-187-188 188-187 0 0 937 0 0 373-938 0z m0-499l0 1-187-188 188-188 0 0 937 0 0 376-938-1z",transform:"matrix(1 0 0 -1 0 850)"},plotlylogo:{width:1542,height:1e3,path:"m0-10h182v-140h-182v140z m228 146h183v-286h-183v286z m225 714h182v-1000h-182v1000z m225-285h182v-715h-182v715z m225 142h183v-857h-183v857z m231-428h182v-429h-182v429z m225-291h183v-138h-183v138z",transform:"matrix(1 0 0 -1 0 850)"},"z-axis":{width:1e3,height:1e3,path:"m833 5l-17 108v41l-130-65 130-66c0 0 0 38 0 39 0-1 36-14 39-25 4-15-6-22-16-30-15-12-39-16-56-20-90-22-187-23-279-23-261 0-341 34-353 59 3 60 228 110 228 110-140-8-351-35-351-116 0-120 293-142 474-142 155 0 477 22 477 142 0 50-74 79-163 96z m-374 94c-58-5-99-21-99-40 0-24 65-43 144-43 79 0 143 19 143 43 0 19-42 34-98 40v216h87l-132 135-133-135h88v-216z m167 515h-136v1c16 16 31 34 46 52l84 109v54h-230v-71h124v-1c-16-17-28-32-44-51l-89-114v-51h245v72z",transform:"matrix(1 0 0 -1 0 850)"},"3d_rotate":{width:1e3,height:1e3,path:"m922 660c-5 4-9 7-14 11-359 263-580-31-580-31l-102 28 58-400c0 1 1 1 2 2 118 108 351 249 351 249s-62 27-100 42c88 83 222 183 347 122 16-8 30-17 44-27-2 1-4 2-6 4z m36-329c0 0 64 229-88 296-62 27-124 14-175-11 157-78 225-208 249-266 8-19 11-31 11-31 2 5 6 15 11 32-5-13-8-20-8-20z m-775-239c70-31 117-50 198-32-121 80-199 346-199 346l-96-15-58-12c0 0 55-226 155-287z m603 133l-317-139c0 0 4-4 19-14 7-5 24-15 24-15s-177-147-389 4c235-287 536-112 536-112l31-22 100 299-4-1z m-298-153c6-4 14-9 24-15 0 0-17 10-24 15z",transform:"matrix(1 0 0 -1 0 850)"},camera:{width:1e3,height:1e3,path:"m500 450c-83 0-150-67-150-150 0-83 67-150 150-150 83 0 150 67 150 150 0 83-67 150-150 150z m400 150h-120c-16 0-34 13-39 29l-31 93c-6 15-23 28-40 28h-340c-16 0-34-13-39-28l-31-94c-6-15-23-28-40-28h-120c-55 0-100-45-100-100v-450c0-55 45-100 100-100h800c55 0 100 45 100 100v450c0 55-45 100-100 100z m-400-550c-138 0-250 112-250 250 0 138 112 250 250 250 138 0 250-112 250-250 0-138-112-250-250-250z m365 380c-19 0-35 16-35 35 0 19 16 35 35 35 19 0 35-16 35-35 0-19-16-35-35-35z",transform:"matrix(1 0 0 -1 0 850)"},movie:{width:1e3,height:1e3,path:"m938 413l-188-125c0 37-17 71-44 94 64 38 107 107 107 187 0 121-98 219-219 219-121 0-219-98-219-219 0-61 25-117 66-156h-115c30 33 49 76 49 125 0 103-84 187-187 187s-188-84-188-187c0-57 26-107 65-141-38-22-65-62-65-109v-250c0-70 56-126 125-126h500c69 0 125 56 125 126l188-126c34 0 62 28 62 63v375c0 35-28 63-62 63z m-750 0c-69 0-125 56-125 125s56 125 125 125 125-56 125-125-56-125-125-125z m406-1c-87 0-157 70-157 157 0 86 70 156 157 156s156-70 156-156-70-157-156-157z",transform:"matrix(1 0 0 -1 0 850)"},question:{width:857.1,height:1e3,path:"m500 82v107q0 8-5 13t-13 5h-107q-8 0-13-5t-5-13v-107q0-8 5-13t13-5h107q8 0 13 5t5 13z m143 375q0 49-31 91t-77 65-95 23q-136 0-207-119-9-14 4-24l74-55q4-4 10-4 9 0 14 7 30 38 48 51 19 14 48 14 27 0 48-15t21-33q0-21-11-34t-38-25q-35-16-65-48t-29-70v-20q0-8 5-13t13-5h107q8 0 13 5t5 13q0 10 12 27t30 28q18 10 28 16t25 19 25 27 16 34 7 45z m214-107q0-117-57-215t-156-156-215-58-216 58-155 156-58 215 58 215 155 156 216 58 215-58 156-156 57-215z",transform:"matrix(1 0 0 -1 0 850)"},disk:{width:857.1,height:1e3,path:"m214-7h429v214h-429v-214z m500 0h72v500q0 8-6 21t-11 20l-157 156q-5 6-19 12t-22 5v-232q0-22-15-38t-38-16h-322q-22 0-37 16t-16 38v232h-72v-714h72v232q0 22 16 38t37 16h465q22 0 38-16t15-38v-232z m-214 518v178q0 8-5 13t-13 5h-107q-7 0-13-5t-5-13v-178q0-8 5-13t13-5h107q7 0 13 5t5 13z m357-18v-518q0-22-15-38t-38-16h-750q-23 0-38 16t-16 38v750q0 22 16 38t38 16h517q23 0 50-12t42-26l156-157q16-15 27-42t11-49z",transform:"matrix(1 0 0 -1 0 850)"},drawopenpath:{width:70,height:70,path:"M33.21,85.65a7.31,7.31,0,0,1-2.59-.48c-8.16-3.11-9.27-19.8-9.88-41.3-.1-3.58-.19-6.68-.35-9-.15-2.1-.67-3.48-1.43-3.79-2.13-.88-7.91,2.32-12,5.86L3,32.38c1.87-1.64,11.55-9.66,18.27-6.9,2.13.87,4.75,3.14,5.17,9,.17,2.43.26,5.59.36,9.25a224.17,224.17,0,0,0,1.5,23.4c1.54,10.76,4,12.22,4.48,12.4.84.32,2.79-.46,5.76-3.59L43,80.07C41.53,81.57,37.68,85.64,33.21,85.65ZM74.81,69a11.34,11.34,0,0,0,6.09-6.72L87.26,44.5,74.72,32,56.9,38.35c-2.37.86-5.57,3.42-6.61,6L38.65,72.14l8.42,8.43ZM55,46.27a7.91,7.91,0,0,1,3.64-3.17l14.8-5.3,8,8L76.11,60.6l-.06.19a6.37,6.37,0,0,1-3,3.43L48.25,74.59,44.62,71Zm16.57,7.82A6.9,6.9,0,1,0,64.64,61,6.91,6.91,0,0,0,71.54,54.09Zm-4.05,0a2.85,2.85,0,1,1-2.85-2.85A2.86,2.86,0,0,1,67.49,54.09Zm-4.13,5.22L60.5,56.45,44.26,72.7l2.86,2.86ZM97.83,35.67,84.14,22l-8.57,8.57L89.26,44.24Zm-13.69-8,8,8-2.85,2.85-8-8Z",transform:"matrix(1 0 0 1 -15 -15)"},drawclosedpath:{width:90,height:90,path:"M88.41,21.12a26.56,26.56,0,0,0-36.18,0l-2.07,2-2.07-2a26.57,26.57,0,0,0-36.18,0,23.74,23.74,0,0,0,0,34.8L48,90.12a3.22,3.22,0,0,0,4.42,0l36-34.21a23.73,23.73,0,0,0,0-34.79ZM84,51.24,50.16,83.35,16.35,51.25a17.28,17.28,0,0,1,0-25.47,20,20,0,0,1,27.3,0l4.29,4.07a3.23,3.23,0,0,0,4.44,0l4.29-4.07a20,20,0,0,1,27.3,0,17.27,17.27,0,0,1,0,25.46ZM66.76,47.68h-33v6.91h33ZM53.35,35H46.44V68h6.91Z",transform:"matrix(1 0 0 1 -5 -5)"},lasso:{width:1031,height:1e3,path:"m1018 538c-36 207-290 336-568 286-277-48-473-256-436-463 10-57 36-108 76-151-13-66 11-137 68-183 34-28 75-41 114-42l-55-70 0 0c-2-1-3-2-4-3-10-14-8-34 5-45 14-11 34-8 45 4 1 1 2 3 2 5l0 0 113 140c16 11 31 24 45 40 4 3 6 7 8 11 48-3 100 0 151 9 278 48 473 255 436 462z m-624-379c-80 14-149 48-197 96 42 42 109 47 156 9 33-26 47-66 41-105z m-187-74c-19 16-33 37-39 60 50-32 109-55 174-68-42-25-95-24-135 8z m360 75c-34-7-69-9-102-8 8 62-16 128-68 170-73 59-175 54-244-5-9 20-16 40-20 61-28 159 121 317 333 354s407-60 434-217c28-159-121-318-333-355z",transform:"matrix(1 0 0 -1 0 850)"},selectbox:{width:1e3,height:1e3,path:"m0 850l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m285 0l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m-857-286l0-143 143 0 0 143-143 0z m857 0l0-143 143 0 0 143-143 0z m-857-285l0-143 143 0 0 143-143 0z m857 0l0-143 143 0 0 143-143 0z m-857-286l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m285 0l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z",transform:"matrix(1 0 0 -1 0 850)"},drawline:{width:70,height:70,path:"M60.64,62.3a11.29,11.29,0,0,0,6.09-6.72l6.35-17.72L60.54,25.31l-17.82,6.4c-2.36.86-5.57,3.41-6.6,6L24.48,65.5l8.42,8.42ZM40.79,39.63a7.89,7.89,0,0,1,3.65-3.17l14.79-5.31,8,8L61.94,54l-.06.19a6.44,6.44,0,0,1-3,3.43L34.07,68l-3.62-3.63Zm16.57,7.81a6.9,6.9,0,1,0-6.89,6.9A6.9,6.9,0,0,0,57.36,47.44Zm-4,0a2.86,2.86,0,1,1-2.85-2.85A2.86,2.86,0,0,1,53.32,47.44Zm-4.13,5.22L46.33,49.8,30.08,66.05l2.86,2.86ZM83.65,29,70,15.34,61.4,23.9,75.09,37.59ZM70,21.06l8,8-2.84,2.85-8-8ZM87,80.49H10.67V87H87Z",transform:"matrix(1 0 0 1 -15 -15)"},drawrect:{width:80,height:80,path:"M78,22V79H21V22H78m9-9H12V88H87V13ZM68,46.22H31V54H68ZM53,32H45.22V69H53Z",transform:"matrix(1 0 0 1 -10 -10)"},drawcircle:{width:80,height:80,path:"M50,84.72C26.84,84.72,8,69.28,8,50.3S26.84,15.87,50,15.87,92,31.31,92,50.3,73.16,84.72,50,84.72Zm0-60.59c-18.6,0-33.74,11.74-33.74,26.17S31.4,76.46,50,76.46,83.74,64.72,83.74,50.3,68.6,24.13,50,24.13Zm17.15,22h-34v7.11h34Zm-13.8-13H46.24v34h7.11Z",transform:"matrix(1 0 0 1 -10 -10)"},eraseshape:{width:80,height:80,path:"M82.77,78H31.85L6,49.57,31.85,21.14H82.77a8.72,8.72,0,0,1,8.65,8.77V69.24A8.72,8.72,0,0,1,82.77,78ZM35.46,69.84H82.77a.57.57,0,0,0,.49-.6V29.91a.57.57,0,0,0-.49-.61H35.46L17,49.57Zm32.68-34.7-24,24,5,5,24-24Zm-19,.53-5,5,24,24,5-5Z",transform:"matrix(1 0 0 1 -10 -10)"},spikeline:{width:1e3,height:1e3,path:"M512 409c0-57-46-104-103-104-57 0-104 47-104 104 0 57 47 103 104 103 57 0 103-46 103-103z m-327-39l92 0 0 92-92 0z m-185 0l92 0 0 92-92 0z m370-186l92 0 0 93-92 0z m0-184l92 0 0 92-92 0z",transform:"matrix(1.5 0 0 -1.5 0 850)"},pencil:{width:1792,height:1792,path:"M491 1536l91-91-235-235-91 91v107h128v128h107zm523-928q0-22-22-22-10 0-17 7l-542 542q-7 7-7 17 0 22 22 22 10 0 17-7l542-542q7-7 7-17zm-54-192l416 416-832 832h-416v-416zm683 96q0 53-37 90l-166 166-416-416 166-165q36-38 90-38 53 0 91 38l235 234q37 39 37 91z",transform:"matrix(1 0 0 1 0 1)"},newplotlylogo:{name:"newplotlylogo",svg:"<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 132 132'><defs><style>.cls-1 {fill: #3f4f75;} .cls-2 {fill: #80cfbe;} .cls-3 {fill: #fff;}</style></defs><title>plotly-logomark</title><g id='symbol'><rect class='cls-1' width='132' height='132' rx='6' ry='6'/><circle class='cls-2' cx='78' cy='54' r='6'/><circle class='cls-2' cx='102' cy='30' r='6'/><circle class='cls-2' cx='78' cy='30' r='6'/><circle class='cls-2' cx='54' cy='30' r='6'/><circle class='cls-2' cx='30' cy='30' r='6'/><circle class='cls-2' cx='30' cy='54' r='6'/><path class='cls-3' d='M30,72a6,6,0,0,0-6,6v24a6,6,0,0,0,12,0V78A6,6,0,0,0,30,72Z'/><path class='cls-3' d='M78,72a6,6,0,0,0-6,6v24a6,6,0,0,0,12,0V78A6,6,0,0,0,78,72Z'/><path class='cls-3' d='M54,48a6,6,0,0,0-6,6v48a6,6,0,0,0,12,0V54A6,6,0,0,0,54,48Z'/><path class='cls-3' d='M102,48a6,6,0,0,0-6,6v48a6,6,0,0,0,12,0V54A6,6,0,0,0,102,48Z'/></g></svg>"}}},{}],767:[function(e,t,r){"use strict";r.isLeftAnchor=function e(t){return t.xanchor==="left"||t.xanchor==="auto"&&t.x<=1/3};r.isCenterAnchor=function e(t){return t.xanchor==="center"||t.xanchor==="auto"&&t.x>1/3&&t.x<2/3};r.isRightAnchor=function e(t){return t.xanchor==="right"||t.xanchor==="auto"&&t.x>=2/3};r.isTopAnchor=function e(t){return t.yanchor==="top"||t.yanchor==="auto"&&t.y>=2/3};r.isMiddleAnchor=function e(t){return t.yanchor==="middle"||t.yanchor==="auto"&&t.y>1/3&&t.y<2/3};r.isBottomAnchor=function e(t){return t.yanchor==="bottom"||t.yanchor==="auto"&&t.y<=1/3}},{}],768:[function(e,t,r){"use strict";var a=e("./mod");var n=a.mod;var i=a.modHalf;var o=Math.PI;var s=2*o;function l(e){return e/180*o}function u(e){return e/o*180}function c(e){return Math.abs(e[1]-e[0])>s-1e-14}function f(e,t){return i(t-e,s)}function h(e,t){return Math.abs(f(e,t))}function p(e,t){if(c(t))return true;var r,a;if(t[0]<t[1]){r=t[0];a=t[1]}else{r=t[1];a=t[0]}r=n(r,s);a=n(a,s);if(r>a)a+=s;var i=n(e,s);var o=i+s;return i>=r&&i<=a||o>=r&&o<=a}function v(e,t,r,a){if(!p(t,a))return false;var n,i;if(r[0]<r[1]){n=r[0];i=r[1]}else{n=r[1];i=r[0]}return e>=n&&e<=i}function d(e,t,r,a,n,i,l){n=n||0;i=i||0;var u=c([r,a]);var f,h,p;var v,d;if(u){f=0;h=o;p=s}else{if(r<a){f=r;p=a}else{f=a;p=r}}if(e<t){v=e;d=t}else{v=t;d=e}function m(e,t){return[e*Math.cos(t)+n,i-e*Math.sin(t)]}var g=Math.abs(p-f)<=o?0:1;function y(e,t,r){return"A"+[e,e]+" "+[0,g,r]+" "+m(e,t)}var x;if(u){if(v===null){x="M"+m(d,f)+y(d,h,0)+y(d,p,0)+"Z"}else{x="M"+m(v,f)+y(v,h,0)+y(v,p,0)+"Z"+"M"+m(d,f)+y(d,h,1)+y(d,p,1)+"Z"}}else{if(v===null){x="M"+m(d,f)+y(d,p,0);if(l)x+="L0,0Z"}else{x="M"+m(v,f)+"L"+m(d,f)+y(d,p,0)+"L"+m(v,p)+y(v,f,1)+"Z"}}return x}function m(e,t,r,a,n){return d(null,e,t,r,a,n,0)}function g(e,t,r,a,n){return d(null,e,t,r,a,n,1)}function y(e,t,r,a,n,i){return d(e,t,r,a,n,i,1)}t.exports={deg2rad:l,rad2deg:u,angleDelta:f,angleDist:h,isFullCircle:c,isAngleInsideSector:p,isPtInsideSector:v,pathArc:m,pathSector:g,pathAnnulus:y}},{"./mod":794}],769:[function(e,t,r){"use strict";var a=Array.isArray;var n=ArrayBuffer;var i=DataView;function o(e){return n.isView(e)&&!(e instanceof i)}r.isTypedArray=o;function s(e){return a(e)||o(e)}r.isArrayOrTypedArray=s;function l(e){return!s(e[0])}r.isArray1D=l;r.ensureArray=function(e,t){if(!a(e))e=[];e.length=t;return e};r.concat=function(){var e=[];var t=true;var r=0;var n,i,o,s,l,u,c,f;for(o=0;o<arguments.length;o++){s=arguments[o];u=s.length;if(u){if(i)e.push(s);else{i=s;l=u}if(a(s)){n=false}else{t=false;if(!r){n=s.constructor}else if(n!==s.constructor){n=false}}r+=u}}if(!r)return[];if(!e.length)return i;if(t)return i.concat.apply(i,e);if(n){c=new n(r);c.set(i);for(o=0;o<e.length;o++){s=e[o];c.set(s,l);l+=s.length}return c}c=new Array(r);for(f=0;f<i.length;f++)c[f]=i[f];for(o=0;o<e.length;o++){s=e[o];for(f=0;f<s.length;f++)c[l+f]=s[f];l+=f}return c};r.maxRowLength=function(e){return u(e,Math.max,0)};r.minRowLength=function(e){return u(e,Math.min,Infinity)};function u(e,t,r){if(s(e)){if(s(e[0])){var a=r;for(var n=0;n<e.length;n++){a=t(a,e[n].length)}return a}else{return e.length}}return 0}},{}],770:[function(e,t,r){"use strict";var a=e("fast-isnumeric");var n=e("../constants/numerical").BADNUM;var i=/^['"%,$#\s']+|[, ]|['"%,$#\s']+$/g;t.exports=function e(t){if(typeof t==="string"){t=t.replace(i,"")}if(a(t))return Number(t);return n}},{"../constants/numerical":763,"fast-isnumeric":246}],771:[function(e,t,r){"use strict";t.exports=function e(t){var r=t._fullLayout;if(r._glcanvas&&r._glcanvas.size()){r._glcanvas.each((function(e){if(e.regl)e.regl.clear({color:true,depth:true})}))}}},{}],772:[function(e,t,r){"use strict";t.exports=function e(t){if(t._responsiveChartHandler){window.removeEventListener("resize",t._responsiveChartHandler);delete t._responsiveChartHandler}}},{}],773:[function(e,t,r){"use strict";var a=e("fast-isnumeric");var n=e("tinycolor2");var i=e("../plots/attributes");var o=e("../components/colorscale/scales");var s=e("../components/color");var l=e("../constants/interactions").DESELECTDIM;var u=e("./nested_property");var c=e("./regex").counter;var f=e("./mod").modHalf;var h=e("./array").isArrayOrTypedArray;r.valObjectMeta={data_array:{coerceFunction:function(e,t,r){if(h(e))t.set(e);else if(r!==undefined)t.set(r)}},enumerated:{coerceFunction:function(e,t,r,a){if(a.coerceNumber)e=+e;if(a.values.indexOf(e)===-1)t.set(r);else t.set(e)},validateFunction:function(e,t){if(t.coerceNumber)e=+e;var r=t.values;for(var a=0;a<r.length;a++){var n=String(r[a]);if(n.charAt(0)==="/"&&n.charAt(n.length-1)==="/"){var i=new RegExp(n.substr(1,n.length-2));if(i.test(e))return true}else if(e===r[a])return true}return false}},boolean:{coerceFunction:function(e,t,r){if(e===true||e===false)t.set(e);else t.set(r)}},number:{coerceFunction:function(e,t,r,n){if(!a(e)||n.min!==undefined&&e<n.min||n.max!==undefined&&e>n.max){t.set(r)}else t.set(+e)}},integer:{coerceFunction:function(e,t,r,n){if(e%1||!a(e)||n.min!==undefined&&e<n.min||n.max!==undefined&&e>n.max){t.set(r)}else t.set(+e)}},string:{coerceFunction:function(e,t,r,a){if(typeof e!=="string"){var n=typeof e==="number";if(a.strict===true||!n)t.set(r);else t.set(String(e))}else if(a.noBlank&&!e)t.set(r);else t.set(e)}},color:{coerceFunction:function(e,t,r){if(n(e).isValid())t.set(e);else t.set(r)}},colorlist:{coerceFunction:function(e,t,r){function a(e){return n(e).isValid()}if(!Array.isArray(e)||!e.length)t.set(r);else if(e.every(a))t.set(e);else t.set(r)}},colorscale:{coerceFunction:function(e,t,r){t.set(o.get(e,r))}},angle:{coerceFunction:function(e,t,r){if(e==="auto")t.set("auto");else if(!a(e))t.set(r);else t.set(f(+e,360))}},subplotid:{coerceFunction:function(e,t,r,a){var n=a.regex||c(r);if(typeof e==="string"&&n.test(e)){t.set(e);return}t.set(r)},validateFunction:function(e,t){var r=t.dflt;if(e===r)return true;if(typeof e!=="string")return false;if(c(r).test(e))return true;return false}},flaglist:{coerceFunction:function(e,t,r,a){if(typeof e!=="string"){t.set(r);return}if((a.extras||[]).indexOf(e)!==-1){t.set(e);return}var n=e.split("+");var i=0;while(i<n.length){var o=n[i];if(a.flags.indexOf(o)===-1||n.indexOf(o)<i){n.splice(i,1)}else i++}if(!n.length)t.set(r);else t.set(n.join("+"))}},any:{coerceFunction:function(e,t,r){if(e===undefined)t.set(r);else t.set(e)}},info_array:{coerceFunction:function(e,t,a,n){function i(e,t,a){var n;var i={set:function(e){n=e}};if(a===undefined)a=t.dflt;r.valObjectMeta[t.valType].coerceFunction(e,i,a,t);return n}var o=n.dimensions===2||n.dimensions==="1-2"&&Array.isArray(e)&&Array.isArray(e[0]);if(!Array.isArray(e)){t.set(a);return}var s=n.items;var l=[];var u=Array.isArray(s);var c=u&&o&&Array.isArray(s[0]);var f=o&&u&&!c;var h=u&&!f?s.length:e.length;var p,v,d,m,g,y;a=Array.isArray(a)?a:[];if(o){for(p=0;p<h;p++){l[p]=[];d=Array.isArray(e[p])?e[p]:[];if(f)g=s.length;else if(u)g=s[p].length;else g=d.length;for(v=0;v<g;v++){if(f)m=s[v];else if(u)m=s[p][v];else m=s;y=i(d[v],m,(a[p]||[])[v]);if(y!==undefined)l[p][v]=y}}}else{for(p=0;p<h;p++){y=i(e[p],u?s[p]:s,a[p]);if(y!==undefined)l[p]=y}}t.set(l)},validateFunction:function(e,t){if(!Array.isArray(e))return false;var r=t.items;var a=Array.isArray(r);var n=t.dimensions===2;if(!t.freeLength&&e.length!==r.length)return false;for(var i=0;i<e.length;i++){if(n){if(!Array.isArray(e[i])||!t.freeLength&&e[i].length!==r[i].length){return false}for(var o=0;o<e[i].length;o++){if(!p(e[i][o],a?r[i][o]:r)){return false}}}else if(!p(e[i],a?r[i]:r))return false}return true}}};r.coerce=function(e,t,a,n,i){var o=u(a,n).get();var s=u(e,n);var l=u(t,n);var c=s.get();var f=t._template;if(c===undefined&&f){c=u(f,n).get();f=0}if(i===undefined)i=o.dflt;if(o.arrayOk&&h(c)){l.set(c);return c}var v=r.valObjectMeta[o.valType].coerceFunction;v(c,l,i,o);var d=l.get();if(f&&d===i&&!p(c,o)){c=u(f,n).get();v(c,l,i,o);d=l.get()}return d};r.coerce2=function(e,t,a,n,i){var o=u(e,n);var s=r.coerce(e,t,a,n,i);var l=o.get();return l!==undefined&&l!==null?s:false};r.coerceFont=function(e,t,r){var a={};r=r||{};a.family=e(t+".family",r.family);a.size=e(t+".size",r.size);a.color=e(t+".color",r.color);return a};r.coercePattern=function(e,t,r,a){var n=e(t+".shape");if(n){e(t+".solidity");e(t+".size");var i=e(t+".fillmode");var o=i==="overlay";if(!a){var l=e(t+".bgcolor",o?r:undefined);e(t+".fgcolor",o?s.contrast(l):r)}e(t+".fgopacity",o?.5:1)}};r.coerceHoverinfo=function(e,t,a){var n=t._module.attributes;var o=n.hoverinfo?n:i;var s=o.hoverinfo;var l;if(a._dataLength===1){var u=s.dflt==="all"?s.flags.slice():s.dflt.split("+");u.splice(u.indexOf("name"),1);l=u.join("+")}return r.coerce(e,t,o,"hoverinfo",l)};r.coerceSelectionMarkerOpacity=function(e,t){if(!e.marker)return;var r=e.marker.opacity;if(r===undefined)return;var a;var n;if(!h(r)&&!e.selected&&!e.unselected){a=r;n=l*r}t("selected.marker.opacity",a);t("unselected.marker.opacity",n)};function p(e,t){var a=r.valObjectMeta[t.valType];if(t.arrayOk&&h(e))return true;if(a.validateFunction){return a.validateFunction(e,t)}var n={};var i=n;var o={set:function(e){i=e}};a.coerceFunction(e,o,n,t);return i!==n}r.validate=p},{"../components/color":650,"../components/colorscale/scales":665,"../constants/interactions":762,"../plots/attributes":834,"./array":769,"./mod":794,"./nested_property":795,"./regex":804,"fast-isnumeric":246,tinycolor2:583}],774:[function(e,t,r){"use strict";var a=e("d3-time-format").timeFormat;var n=e("fast-isnumeric");var i=e("./loggers");var o=e("./mod").mod;var s=e("../constants/numerical");var l=s.BADNUM;var u=s.ONEDAY;var c=s.ONEHOUR;var f=s.ONEMIN;var h=s.ONESEC;var p=s.EPOCHJD;var v=e("../registry");var d=e("d3-time-format").utcFormat;var m=/^\s*(-?\d\d\d\d|\d\d)(-(\d?\d)(-(\d?\d)([ Tt]([01]?\d|2[0-3])(:([0-5]\d)(:([0-5]\d(\.\d+)?))?(Z|z|[+\-]\d\d(:?\d\d)?)?)?)?)?)?\s*$/m;var g=/^\s*(-?\d\d\d\d|\d\d)(-(\d?\di?)(-(\d?\d)([ Tt]([01]?\d|2[0-3])(:([0-5]\d)(:([0-5]\d(\.\d+)?))?(Z|z|[+\-]\d\d(:?\d\d)?)?)?)?)?)?\s*$/m;var y=(new Date).getFullYear()-70;function x(e){return e&&v.componentsRegistry.calendars&&typeof e==="string"&&e!=="gregorian"}r.dateTick0=function(e,t){var a=b(e,!!t);if(t<2)return a;var n=r.dateTime2ms(a,e);n+=u*(t-1);return r.ms2DateTime(n,0,e)};function b(e,t){if(x(e)){return t?v.getComponentMethod("calendars","CANONICAL_SUNDAY")[e]:v.getComponentMethod("calendars","CANONICAL_TICK")[e]}else{return t?"2000-01-02":"2000-01-01"}}r.dfltRange=function(e){if(x(e)){return v.getComponentMethod("calendars","DFLTRANGE")[e]}else{return["2000-01-01","2001-01-01"]}};r.isJSDate=function(e){return typeof e==="object"&&e!==null&&typeof e.getTime==="function"};var _,w;r.dateTime2ms=function(e,t){if(r.isJSDate(e)){var a=e.getTimezoneOffset()*f;var n=(e.getUTCMinutes()-e.getMinutes())*f+(e.getUTCSeconds()-e.getSeconds())*h+(e.getUTCMilliseconds()-e.getMilliseconds());if(n){var i=3*f;a=a-i/2+o(n-a+i/2,i)}e=Number(e)-a;if(e>=_&&e<=w)return e;return l}if(typeof e!=="string"&&typeof e!=="number")return l;e=String(e);var s=x(t);var d=e.charAt(0);if(s&&(d==="G"||d==="g")){e=e.substr(1);t=""}var b=s&&t.substr(0,7)==="chinese";var T=e.match(b?g:m);if(!T)return l;var k=T[1];var M=T[3]||"1";var A=Number(T[5]||1);var S=Number(T[7]||0);var E=Number(T[9]||0);var L=Number(T[11]||0);if(s){if(k.length===2)return l;k=Number(k);var C;try{var I=v.getComponentMethod("calendars","getCal")(t);if(b){var P=M.charAt(M.length-1)==="i";M=parseInt(M,10);C=I.newDate(k,I.toMonthIndex(k,M,P),A)}else{C=I.newDate(k,Number(M),A)}}catch(z){return l}if(!C)return l;return(C.toJD()-p)*u+S*c+E*f+L*h}if(k.length===2){k=(Number(k)+2e3-y)%100+y}else k=Number(k);M-=1;var O=new Date(Date.UTC(2e3,M,A,S,E));O.setUTCFullYear(k);if(O.getUTCMonth()!==M)return l;if(O.getUTCDate()!==A)return l;return O.getTime()+L*h};_=r.MIN_MS=r.dateTime2ms("-9999");w=r.MAX_MS=r.dateTime2ms("9999-12-31 23:59:59.9999");r.isDateTime=function(e,t){return r.dateTime2ms(e,t)!==l};function T(e,t){return String(e+Math.pow(10,t)).substr(1)}var k=90*u;var M=3*c;var A=5*f;r.ms2DateTime=function(e,t,r){if(typeof e!=="number"||!(e>=_&&e<=w))return l;if(!t)t=0;var a=Math.floor(o(e+.05,1)*10);var n=Math.round(e-a/10);var i,s,m,g,y,b;if(x(r)){var T=Math.floor(n/u)+p;var E=Math.floor(o(e,u));try{i=v.getComponentMethod("calendars","getCal")(r).fromJD(T).formatDate("yyyy-mm-dd")}catch(L){i=d("G%Y-%m-%d")(new Date(n))}if(i.charAt(0)==="-"){while(i.length<11)i="-0"+i.substr(1)}else{while(i.length<10)i="0"+i}s=t<k?Math.floor(E/c):0;m=t<k?Math.floor(E%c/f):0;g=t<M?Math.floor(E%f/h):0;y=t<A?E%h*10+a:0}else{b=new Date(n);i=d("%Y-%m-%d")(b);s=t<k?b.getUTCHours():0;m=t<k?b.getUTCMinutes():0;g=t<M?b.getUTCSeconds():0;y=t<A?b.getUTCMilliseconds()*10+a:0}return S(i,s,m,g,y)};r.ms2DateTimeLocal=function(e){if(!(e>=_+u&&e<=w-u))return l;var t=Math.floor(o(e+.05,1)*10);var r=new Date(Math.round(e-t/10));var n=a("%Y-%m-%d")(r);var i=r.getHours();var s=r.getMinutes();var c=r.getSeconds();var f=r.getUTCMilliseconds()*10+t;return S(n,i,s,c,f)};function S(e,t,r,a,n){if(t||r||a||n){e+=" "+T(t,2)+":"+T(r,2);if(a||n){e+=":"+T(a,2);if(n){var i=4;while(n%10===0){i-=1;n/=10}e+="."+T(n,i)}}}return e}r.cleanDate=function(e,t,a){if(e===l)return t;if(r.isJSDate(e)||typeof e==="number"&&isFinite(e)){if(x(a)){i.error("JS Dates and milliseconds are incompatible with world calendars",e);return t}e=r.ms2DateTimeLocal(+e);if(!e&&t!==undefined)return t}else if(!r.isDateTime(e,a)){i.error("unrecognized date",e);return t}return e};var E=/%\d?f/g;var L=/%h/g;var C={1:"1",2:"1",3:"2",4:"2"};function I(e,t,r,a){e=e.replace(E,(function(e){var r=Math.min(+e.charAt(1)||6,6);var a=(t/1e3%1+2).toFixed(r).substr(2).replace(/0+$/,"")||"0";return a}));var n=new Date(Math.floor(t+.05));e=e.replace(L,(function(){return C[r("%q")(n)]}));if(x(a)){try{e=v.getComponentMethod("calendars","worldCalFmt")(e,t,a)}catch(i){return"Invalid"}}return r(e)(n)}var P=[59,59.9,59.99,59.999,59.9999];function O(e,t){var r=o(e+.05,u);var a=T(Math.floor(r/c),2)+":"+T(o(Math.floor(r/f),60),2);if(t!=="M"){if(!n(t))t=0;var i=Math.min(o(e/h,60),P[t]);var s=(100+i).toFixed(t).substr(1);if(t>0){s=s.replace(/0+$/,"").replace(/[\.]$/,"")}a+=":"+s}return a}r.formatDate=function(e,t,r,a,n,i){n=x(n)&&n;if(!t){if(r==="y")t=i.year;else if(r==="m")t=i.month;else if(r==="d"){t=i.dayMonth+"\n"+i.year}else{return O(e,r)+"\n"+I(i.dayMonthYear,e,a,n)}}return I(t,e,a,n)};var z=3*u;r.incrementMonth=function(e,t,r){r=x(r)&&r;var a=o(e,u);e=Math.round(e-a);if(r){try{var n=Math.round(e/u)+p;var s=v.getComponentMethod("calendars","getCal")(r);var l=s.fromJD(n);if(t%12)s.add(l,t,"m");else s.add(l,t/12,"y");return(l.toJD()-p)*u+a}catch(f){i.error("invalid ms "+e+" in calendar "+r)}}var c=new Date(e+z);return c.setUTCMonth(c.getUTCMonth()+t)+a-z};r.findExactDates=function(e,t){var r=0;var a=0;var i=0;var o=0;var s;var l;var c=x(t)&&v.getComponentMethod("calendars","getCal")(t);for(var f=0;f<e.length;f++){l=e[f];if(!n(l)){o++;continue}if(l%u)continue;if(c){try{s=c.fromJD(l/u+p);if(s.day()===1){if(s.month()===1)r++;else a++}else i++}catch(d){}}else{s=new Date(l);if(s.getUTCDate()===1){if(s.getUTCMonth()===0)r++;else a++}else i++}}a+=r;i+=a;var h=e.length-o;return{exactYears:r/h,exactMonths:a/h,exactDays:i/h}}},{"../constants/numerical":763,"../registry":915,"./loggers":791,"./mod":794,"d3-time-format":172,"fast-isnumeric":246}],775:[function(e,t,r){"use strict";var a=e("@plotly/d3");var n=e("./loggers");var i=e("./matrix");var o=e("gl-mat4");function s(e){var t;if(typeof e==="string"){t=document.getElementById(e);if(t===null){throw new Error("No DOM element with id '"+e+"' exists on the page.")}return t}else if(e===null||e===undefined){throw new Error("DOM element provided is null or undefined")}return e}function l(e){var t=a.select(e);return t.node()instanceof HTMLElement&&t.size()&&t.classed("js-plotly-plot")}function u(e){var t=e&&e.parentNode;if(t)t.removeChild(e)}function c(e,t){f("global",e,t)}function f(e,t,r){var a="plotly.js-style-"+e;var i=document.getElementById(a);if(!i){i=document.createElement("style");i.setAttribute("id",a);i.appendChild(document.createTextNode(""));document.head.appendChild(i)}var o=i.sheet;if(o.insertRule){o.insertRule(t+"{"+r+"}",0)}else if(o.addRule){o.addRule(t,r,0)}else n.warn("addStyleRule failed")}function h(e){var t="plotly.js-style-"+e;var r=document.getElementById(t);if(r)u(r)}function p(e){var t=d(e);var r=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];t.forEach((function(e){var t=v(e);if(t){var a=i.convertCssMatrix(t);r=o.multiply(r,r,a)}}));return r}function v(e){var t=window.getComputedStyle(e,null);var r=t.getPropertyValue("-webkit-transform")||t.getPropertyValue("-moz-transform")||t.getPropertyValue("-ms-transform")||t.getPropertyValue("-o-transform")||t.getPropertyValue("transform");if(r==="none")return null;return r.replace("matrix","").replace("3d","").slice(1,-1).split(",").map((function(e){return+e}))}function d(e){var t=[];while(m(e)){t.push(e);e=e.parentNode}return t}function m(e){return e&&(e instanceof Element||e instanceof HTMLElement)}function g(e,t){return e&&t&&e.x===t.x&&e.y===t.y&&e.top===t.top&&e.left===t.left&&e.right===t.right&&e.bottom===t.bottom}t.exports={getGraphDiv:s,isPlotDiv:l,removeElement:u,addStyleRule:c,addRelatedStyleRule:f,deleteRelatedStyleRule:h,getFullTransformMatrix:p,getElementTransformMatrix:v,getElementAndAncestors:d,equalDomRects:g}},{"./loggers":791,"./matrix":793,"@plotly/d3":58,"gl-mat4":292}],776:[function(e,t,r){"use strict";var a=e("events").EventEmitter;var n={init:function(e){if(e._ev instanceof a)return e;var t=new a;var r=new a;e._ev=t;e._internalEv=r;e.on=t.on.bind(t);e.once=t.once.bind(t);e.removeListener=t.removeListener.bind(t);e.removeAllListeners=t.removeAllListeners.bind(t);e._internalOn=r.on.bind(r);e._internalOnce=r.once.bind(r);e._removeInternalListener=r.removeListener.bind(r);e._removeAllInternalListeners=r.removeAllListeners.bind(r);e.emit=function(a,n){if(typeof jQuery!=="undefined"){jQuery(e).trigger(a,n)}t.emit(a,n);r.emit(a,n)};return e},triggerHandler:function(e,t,r){var a;var n;if(typeof jQuery!=="undefined"){a=jQuery(e).triggerHandler(t,r)}var i=e._ev;if(!i)return a;var o=i._events[t];if(!o)return a;function s(e){if(e.listener){i.removeListener(t,e.listener);if(!e.fired){e.fired=true;return e.listener.apply(i,[r])}}else{return e.apply(i,[r])}}o=Array.isArray(o)?o:[o];var l;for(l=0;l<o.length-1;l++){s(o[l])}n=s(o[l]);return a!==undefined?a:n},purge:function(e){delete e._ev;delete e.on;delete e.once;delete e.removeListener;delete e.removeAllListeners;delete e.emit;delete e._ev;delete e._internalEv;delete e._internalOn;delete e._internalOnce;delete e._removeInternalListener;delete e._removeAllInternalListeners;return e}};t.exports=n},{events:116}],777:[function(e,t,r){"use strict";var a=e("./is_plain_object.js");var n=Array.isArray;function i(e,t){var r,a;for(r=0;r<e.length;r++){a=e[r];if(a!==null&&typeof a==="object"){return false}if(a!==void 0){t[r]=a}}return true}r.extendFlat=function(){return o(arguments,false,false,false)};r.extendDeep=function(){return o(arguments,true,false,false)};r.extendDeepAll=function(){return o(arguments,true,true,false)};r.extendDeepNoArrays=function(){return o(arguments,true,false,true)};function o(e,t,r,s){var l=e[0];var u=e.length;var c,f,h,p,v,d,m;if(u===2&&n(l)&&n(e[1])&&l.length===0){m=i(e[1],l);if(m){return l}else{l.splice(0,l.length)}}for(var g=1;g<u;g++){c=e[g];for(f in c){h=l[f];p=c[f];if(s&&n(p)){l[f]=p}else if(t&&p&&(a(p)||(v=n(p)))){if(v){v=false;d=h&&n(h)?h:[]}else{d=h&&a(h)?h:{}}l[f]=o([d,p],t,r,s)}else if(typeof p!=="undefined"||r){l[f]=p}}}return l}},{"./is_plain_object.js":788}],778:[function(e,t,r){"use strict";t.exports=function e(t){var r={};var a=[];var n=0;for(var i=0;i<t.length;i++){var o=t[i];if(r[o]!==1){r[o]=1;a[n++]=o}}return a}},{}],779:[function(e,t,r){"use strict";t.exports=function e(t){var r=i(t)?n:a;var o=[];for(var s=0;s<t.length;s++){var l=t[s];if(r(l))o.push(l)}return o};function a(e){return e.visible===true}function n(e){var t=e[0].trace;return t.visible===true&&t._length!==0}function i(e){return Array.isArray(e)&&Array.isArray(e[0])&&e[0][0]&&e[0][0].trace}},{}],780:[function(e,t,r){"use strict";var a=e("@plotly/d3");var n=e("country-regex");var i=e("@turf/area");var o=e("@turf/centroid");var s=e("@turf/bbox");var l=e("./identity");var u=e("./loggers");var c=e("./is_plain_object");var f=e("./nested_property");var h=e("./polygon");var p=Object.keys(n);var v={"ISO-3":l,"USA-states":l,"country names":d};function d(e){for(var t=0;t<p.length;t++){var r=p[t];var a=new RegExp(n[r]);if(a.test(e.trim().toLowerCase()))return r}u.log("Unrecognized country name: "+e+".");return false}function m(e,t,r){if(!t||typeof t!=="string")return false;var a=v[e](t);var n;var i,o;if(a){if(e==="USA-states"){n=[];for(o=0;o<r.length;o++){i=r[o];if(i.properties&&i.properties.gu&&i.properties.gu==="USA"){n.push(i)}}}else{n=r}for(o=0;o<n.length;o++){i=n[o];if(i.id===a)return i}u.log(["Location with id",a,"does not have a matching topojson feature at this resolution."].join(" "))}return false}function g(e){var t=e.geometry;var r=t.coordinates;var a=e.id;var n=[];var i,o,s,l;function u(e){for(var t=0;t<e.length-1;t++){if(e[t][0]>0&&e[t+1][0]<0)return t}return null}if(a==="RUS"||a==="FJI"){i=function(e){var t;if(u(e)===null){t=e}else{t=new Array(e.length);for(l=0;l<e.length;l++){t[l]=[e[l][0]<0?e[l][0]+360:e[l][0],e[l][1]]}}n.push(h.tester(t))}}else if(a==="ATA"){i=function(e){var t=u(e);if(t===null){return n.push(h.tester(e))}var r=new Array(e.length+1);var a=0;for(l=0;l<e.length;l++){if(l>t){r[a++]=[e[l][0]+360,e[l][1]]}else if(l===t){r[a++]=e[l];r[a++]=[e[l][0],-90]}else{r[a++]=e[l]}}var i=h.tester(r);i.pts.pop();n.push(i)}}else{i=function(e){n.push(h.tester(e))}}switch(t.type){case"MultiPolygon":for(o=0;o<r.length;o++){for(s=0;s<r[o].length;s++){i(r[o][s])}}break;case"Polygon":for(o=0;o<r.length;o++){i(r[o])}break}return n}function y(e){var t=e.geojson;var r=window.PlotlyGeoAssets||{};var a=typeof t==="string"?r[t]:t;if(!c(a)){u.error("Oops ... something went wrong when fetching "+t);return false}return a}function x(e){var t=e[0].trace;var r=y(t);if(!r)return false;var a={};var n=[];var i;for(i=0;i<t._length;i++){var o=e[i];if(o.loc||o.loc===0){a[o.loc]=o}}function s(e){var r=f(e,t.featureidkey||"id").get();var i=a[r];if(i){var o=e.geometry;if(o.type==="Polygon"||o.type==="MultiPolygon"){var s={type:"Feature",id:r,geometry:o,properties:{}};s.properties.ct=b(s);i.fIn=e;i.fOut=s;n.push(s)}else{u.log(["Location",i.loc,"does not have a valid GeoJSON geometry.","Traces with locationmode *geojson-id* only support","*Polygon* and *MultiPolygon* geometries."].join(" "))}}delete a[r]}switch(r.type){case"FeatureCollection":var l=r.features;for(i=0;i<l.length;i++){s(l[i])}break;case"Feature":s(r);break;default:u.warn(["Invalid GeoJSON type",(r.type||"none")+".","Traces with locationmode *geojson-id* only support","*FeatureCollection* and *Feature* types."].join(" "));return false}for(var c in a){u.log(["Location *"+c+"*","does not have a matching feature with id-key","*"+t.featureidkey+"*."].join(" "))}return n}function b(e){var t=e.geometry;var r;if(t.type==="MultiPolygon"){var a=t.coordinates;var n=0;for(var s=0;s<a.length;s++){var l={type:"Polygon",coordinates:a[s]};var u=i.default(l);if(u>n){n=u;r=l}}}else{r=t}return o.default(r).geometry.coordinates}function _(e){var t=window.PlotlyGeoAssets||{};var r=[];function n(e){return new Promise((function(r,n){a.json(e,(function(a,i){if(a){delete t[e];var o=a.status===404?'GeoJSON at URL "'+e+'" does not exist.':"Unexpected error while fetching from "+e;return n(new Error(o))}t[e]=i;return r(i)}))}))}function i(e){return new Promise((function(r,a){var n=0;var i=setInterval((function(){if(t[e]&&t[e]!=="pending"){clearInterval(i);return r(t[e])}if(n>100){clearInterval(i);return a("Unexpected error while fetching from "+e)}n++}),50)}))}for(var o=0;o<e.length;o++){var s=e[o][0].trace;var l=s.geojson;if(typeof l==="string"){if(!t[l]){t[l]="pending";r.push(n(l))}else if(t[l]==="pending"){r.push(i(l))}}}return r}function w(e){return s.default(e)}t.exports={locationToFeature:m,feature2polygons:g,getTraceGeojson:y,extractTraceFeature:x,fetchTraceGeoData:_,computeBbox:w}},{"./identity":785,"./is_plain_object":788,"./loggers":791,"./nested_property":795,"./polygon":799,"@plotly/d3":58,"@turf/area":61,"@turf/bbox":64,"@turf/centroid":67,"country-regex":145}],781:[function(e,t,r){"use strict";var a=e("../constants/numerical").BADNUM;r.calcTraceToLineCoords=function(e){var t=e[0].trace;var r=t.connectgaps;var n=[];var i=[];for(var o=0;o<e.length;o++){var s=e[o];var l=s.lonlat;if(l[0]!==a){i.push(l)}else if(!r&&i.length>0){n.push(i);i=[]}}if(i.length>0){n.push(i)}return n};r.makeLine=function(e){if(e.length===1){return{type:"LineString",coordinates:e[0]}}else{return{type:"MultiLineString",coordinates:e}}};r.makePolygon=function(e){if(e.length===1){return{type:"Polygon",coordinates:e}}else{var t=new Array(e.length);for(var r=0;r<e.length;r++){t[r]=[e[r]]}return{type:"MultiPolygon",coordinates:t}}};r.makeBlank=function(){return{type:"Point",coordinates:[]}}},{"../constants/numerical":763}],782:[function(e,t,r){"use strict";var a=e("./mod").mod;r.segmentsIntersect=n;function n(e,t,r,a,n,i,o,s){var l=r-e;var u=n-e;var c=o-n;var f=a-t;var h=i-t;var p=s-i;var v=l*p-c*f;if(v===0)return null;var d=(u*p-c*h)/v;var m=(u*f-l*h)/v;if(m<0||m>1||d<0||d>1)return null;return{x:e+l*d,y:t+f*d}}r.segmentDistance=function e(t,r,a,o,s,l,u,c){if(n(t,r,a,o,s,l,u,c))return 0;var f=a-t;var h=o-r;var p=u-s;var v=c-l;var d=f*f+h*h;var m=p*p+v*v;var g=Math.min(i(f,h,d,s-t,l-r),i(f,h,d,u-t,c-r),i(p,v,m,t-s,r-l),i(p,v,m,a-s,o-l));return Math.sqrt(g)};function i(e,t,r,a,n){var i=a*e+n*t;if(i<0){return a*a+n*n}else if(i>r){var o=a-e;var s=n-t;return o*o+s*s}else{var l=a*t-n*e;return l*l/r}}var o,s,l;r.getTextLocation=function e(t,r,n,i){if(t!==s||i!==l){o={};s=t;l=i}if(o[n]){return o[n]}var u=t.getPointAtLength(a(n-i/2,r));var c=t.getPointAtLength(a(n+i/2,r));var f=Math.atan((c.y-u.y)/(c.x-u.x));var h=t.getPointAtLength(a(n,r));var p=(h.x*4+u.x+c.x)/6;var v=(h.y*4+u.y+c.y)/6;var d={x:p,y:v,theta:f};o[n]=d;return d};r.clearLocationCache=function(){s=null};r.getVisibleSegment=function e(t,r,a){var n=r.left;var i=r.right;var o=r.top;var s=r.bottom;var l=0;var u=t.getTotalLength();var c=u;var f,h;function p(e){var r=t.getPointAtLength(e);if(e===0)f=r;else if(e===u)h=r;var a=r.x<n?n-r.x:r.x>i?r.x-i:0;var l=r.y<o?o-r.y:r.y>s?r.y-s:0;return Math.sqrt(a*a+l*l)}var v=p(l);while(v){l+=v+a;if(l>c)return;v=p(l)}v=p(c);while(v){c-=v+a;if(l>c)return;v=p(c)}return{min:l,max:c,len:c-l,total:u,isClosed:l===0&&c===u&&Math.abs(f.x-h.x)<.1&&Math.abs(f.y-h.y)<.1}};r.findPointOnPath=function e(t,r,a,n){n=n||{};var i=n.pathLength||t.getTotalLength();var o=n.tolerance||.001;var s=n.iterationLimit||30;var l=t.getPointAtLength(0)[a]>t.getPointAtLength(i)[a]?-1:1;var u=0;var c=0;var f=i;var h;var p;var v;while(u<s){h=(c+f)/2;p=t.getPointAtLength(h);v=p[a]-r;if(Math.abs(v)<o){return p}else{if(l*v>0){f=h}else{c=h}u++}}return p}},{"./mod":794}],783:[function(e,t,r){"use strict";var a=e("fast-isnumeric");var n=e("tinycolor2");var i=e("color-normalize");var o=e("../components/colorscale");var s=e("../components/color/attributes").defaultLine;var l=e("./array").isArrayOrTypedArray;var u=i(s);var c=1;function f(e,t){var r=e;r[3]*=t;return r}function h(e){if(a(e))return u;var t=i(e);return t.length?t:u}function p(e){return a(e)?e:c}function v(e,t,r){var a=e.color;var n=l(a);var s=l(t);var v=o.extractOpts(e);var d=[];var m,g,y,x,b;if(v.colorscale!==undefined){m=o.makeColorScaleFuncFromTrace(e)}else{m=h}if(n){g=function(e,t){return e[t]===undefined?u:i(m(e[t]))}}else g=h;if(s){y=function(e,t){return e[t]===undefined?c:p(e[t])}}else y=p;if(n||s){for(var _=0;_<r;_++){x=g(a,_);b=y(t,_);d[_]=f(x,b)}}else d=f(i(a),t);return d}function d(e){var t=o.extractOpts(e);var r=t.colorscale;if(t.reversescale)r=o.flipScale(t.colorscale);return r.map((function(e){var t=e[0];var r=n(e[1]);var a=r.toRgb();return{index:t,rgb:[a.r,a.g,a.b,a.a]}}))}t.exports={formatColor:v,parseColorScale:d}},{"../components/color/attributes":649,"../components/colorscale":662,"./array":769,"color-normalize":131,"fast-isnumeric":246,tinycolor2:583}],784:[function(e,t,r){"use strict";var a=e("./identity");function n(e){return[e]}t.exports={keyFun:function(e){return e.key},repeat:n,descend:a,wrap:n,unwrap:function(e){return e[0]}}},{"./identity":785}],785:[function(e,t,r){"use strict";t.exports=function e(t){return t}},{}],786:[function(e,t,r){"use strict";t.exports=function e(t,r){if(!r)return t;var a=1/Math.abs(r);var n=a>1?(a*t+a*r)/a:t+r;var i=String(n).length;if(i>16){var o=String(r).length;var s=String(t).length;if(i>=s+o){var l=parseFloat(n).toPrecision(12);if(l.indexOf("e+")===-1)n=+l}}return n}},{}],787:[function(e,t,r){"use strict";var a=e("@plotly/d3");var n=e("d3-time-format").utcFormat;var i=e("d3-format").format;var o=e("fast-isnumeric");var s=e("../constants/numerical");var l=s.FP_SAFE;var u=-l;var c=s.BADNUM;var f=t.exports={};f.adjustFormat=function e(t){if(!t||/^\d[.]\df/.test(t)||/[.]\d%/.test(t))return t;if(t==="0.f")return"~f";if(/^\d%/.test(t))return"~%";if(/^\ds/.test(t))return"~s";if(!/^[~,.0$]/.test(t)&&/[&fps]/.test(t))return"~"+t;return t};var h={};f.warnBadFormat=function(e){var t=String(e);if(!h[t]){h[t]=1;f.warn('encountered bad format: "'+t+'"')}};f.noFormat=function(e){return String(e)};f.numberFormat=function(e){var t;try{t=i(f.adjustFormat(e))}catch(r){f.warnBadFormat(e);return f.noFormat}return t};f.nestedProperty=e("./nested_property");f.keyedContainer=e("./keyed_container");f.relativeAttr=e("./relative_attr");f.isPlainObject=e("./is_plain_object");f.toLogRange=e("./to_log_range");f.relinkPrivateKeys=e("./relink_private");var p=e("./array");f.isTypedArray=p.isTypedArray;f.isArrayOrTypedArray=p.isArrayOrTypedArray;f.isArray1D=p.isArray1D;f.ensureArray=p.ensureArray;f.concat=p.concat;f.maxRowLength=p.maxRowLength;f.minRowLength=p.minRowLength;var v=e("./mod");f.mod=v.mod;f.modHalf=v.modHalf;var d=e("./coerce");f.valObjectMeta=d.valObjectMeta;f.coerce=d.coerce;f.coerce2=d.coerce2;f.coerceFont=d.coerceFont;f.coercePattern=d.coercePattern;f.coerceHoverinfo=d.coerceHoverinfo;f.coerceSelectionMarkerOpacity=d.coerceSelectionMarkerOpacity;f.validate=d.validate;var m=e("./dates");f.dateTime2ms=m.dateTime2ms;f.isDateTime=m.isDateTime;f.ms2DateTime=m.ms2DateTime;f.ms2DateTimeLocal=m.ms2DateTimeLocal;f.cleanDate=m.cleanDate;f.isJSDate=m.isJSDate;f.formatDate=m.formatDate;f.incrementMonth=m.incrementMonth;f.dateTick0=m.dateTick0;f.dfltRange=m.dfltRange;f.findExactDates=m.findExactDates;f.MIN_MS=m.MIN_MS;f.MAX_MS=m.MAX_MS;var g=e("./search");f.findBin=g.findBin;f.sorterAsc=g.sorterAsc;f.sorterDes=g.sorterDes;f.distinctVals=g.distinctVals;f.roundUp=g.roundUp;f.sort=g.sort;f.findIndexOfMin=g.findIndexOfMin;f.sortObjectKeys=e("./sort_object_keys");var y=e("./stats");f.aggNums=y.aggNums;f.len=y.len;f.mean=y.mean;f.median=y.median;f.midRange=y.midRange;f.variance=y.variance;f.stdev=y.stdev;f.interp=y.interp;var x=e("./matrix");f.init2dArray=x.init2dArray;f.transposeRagged=x.transposeRagged;f.dot=x.dot;f.translationMatrix=x.translationMatrix;f.rotationMatrix=x.rotationMatrix;f.rotationXYMatrix=x.rotationXYMatrix;f.apply3DTransform=x.apply3DTransform;f.apply2DTransform=x.apply2DTransform;f.apply2DTransform2=x.apply2DTransform2;f.convertCssMatrix=x.convertCssMatrix;f.inverseTransformMatrix=x.inverseTransformMatrix;var b=e("./angles");f.deg2rad=b.deg2rad;f.rad2deg=b.rad2deg;f.angleDelta=b.angleDelta;f.angleDist=b.angleDist;f.isFullCircle=b.isFullCircle;f.isAngleInsideSector=b.isAngleInsideSector;f.isPtInsideSector=b.isPtInsideSector;f.pathArc=b.pathArc;f.pathSector=b.pathSector;f.pathAnnulus=b.pathAnnulus;var _=e("./anchor_utils");f.isLeftAnchor=_.isLeftAnchor;f.isCenterAnchor=_.isCenterAnchor;f.isRightAnchor=_.isRightAnchor;f.isTopAnchor=_.isTopAnchor;f.isMiddleAnchor=_.isMiddleAnchor;f.isBottomAnchor=_.isBottomAnchor;var w=e("./geometry2d");f.segmentsIntersect=w.segmentsIntersect;f.segmentDistance=w.segmentDistance;f.getTextLocation=w.getTextLocation;f.clearLocationCache=w.clearLocationCache;f.getVisibleSegment=w.getVisibleSegment;f.findPointOnPath=w.findPointOnPath;var T=e("./extend");f.extendFlat=T.extendFlat;f.extendDeep=T.extendDeep;f.extendDeepAll=T.extendDeepAll;f.extendDeepNoArrays=T.extendDeepNoArrays;var k=e("./loggers");f.log=k.log;f.warn=k.warn;f.error=k.error;var M=e("./regex");f.counterRegex=M.counter;var A=e("./throttle");f.throttle=A.throttle;f.throttleDone=A.done;f.clearThrottle=A.clear;var S=e("./dom");f.getGraphDiv=S.getGraphDiv;f.isPlotDiv=S.isPlotDiv;f.removeElement=S.removeElement;f.addStyleRule=S.addStyleRule;f.addRelatedStyleRule=S.addRelatedStyleRule;f.deleteRelatedStyleRule=S.deleteRelatedStyleRule;f.getFullTransformMatrix=S.getFullTransformMatrix;f.getElementTransformMatrix=S.getElementTransformMatrix;f.getElementAndAncestors=S.getElementAndAncestors;f.equalDomRects=S.equalDomRects;f.clearResponsive=e("./clear_responsive");f.preserveDrawingBuffer=e("./preserve_drawing_buffer");f.makeTraceGroups=e("./make_trace_groups");f._=e("./localize");f.notifier=e("./notifier");f.filterUnique=e("./filter_unique");f.filterVisible=e("./filter_visible");f.pushUnique=e("./push_unique");f.increment=e("./increment");f.cleanNumber=e("./clean_number");f.ensureNumber=function e(t){if(!o(t))return c;t=Number(t);return t>l||t<u?c:t};f.isIndex=function(e,t){if(t!==undefined&&e>=t)return false;return o(e)&&e>=0&&e%1===0};f.noop=e("./noop");f.identity=e("./identity");f.repeat=function(e,t){var r=new Array(t);for(var a=0;a<t;a++){r[a]=e}return r};f.swapAttrs=function(e,t,r,a){if(!r)r="x";if(!a)a="y";for(var n=0;n<t.length;n++){var i=t[n];var o=f.nestedProperty(e,i.replace("?",r));var s=f.nestedProperty(e,i.replace("?",a));var l=o.get();o.set(s.get());s.set(l)}};f.raiseToTop=function e(t){t.parentNode.appendChild(t)};f.cancelTransition=function(e){return e.transition().duration(0)};f.constrain=function(e,t,r){if(t>r)return Math.max(r,Math.min(t,e));return Math.max(t,Math.min(r,e))};f.bBoxIntersect=function(e,t,r){r=r||0;return e.left<=t.right+r&&t.left<=e.right+r&&e.top<=t.bottom+r&&t.top<=e.bottom+r};f.simpleMap=function(e,t,r,a,n){var i=e.length;var o=new Array(i);for(var s=0;s<i;s++)o[s]=t(e[s],r,a,n);return o};f.randstr=function e(t,r,a,n){if(!a)a=16;if(r===undefined)r=24;if(r<=0)return"0";var i=Math.log(Math.pow(2,r))/Math.log(a);var o="";var s,l,u;for(s=2;i===Infinity;s*=2){i=Math.log(Math.pow(2,r/s))/Math.log(a)*s}var c=i-Math.floor(i);for(s=0;s<Math.floor(i);s++){u=Math.floor(Math.random()*a).toString(a);o=u+o}if(c){l=Math.pow(a,c);u=Math.floor(Math.random()*l).toString(a);o=u+o}var h=parseInt(o,a);if(t&&t[o]||h!==Infinity&&h>=Math.pow(2,r)){if(n>10){f.warn("randstr failed uniqueness");return o}return e(t,r,a,(n||0)+1)}else return o};f.OptionControl=function(e,t){if(!e)e={};if(!t)t="opt";var r={};r.optionList=[];r._newoption=function(a){a[t]=e;r[a.name]=a;r.optionList.push(a)};r["_"+t]=e;return r};f.smooth=function(e,t){t=Math.round(t)||0;if(t<2)return e;var r=e.length;var a=2*r;var n=2*t-1;var i=new Array(n);var o=new Array(r);var s;var l;var u;var c;for(s=0;s<n;s++){i[s]=(1-Math.cos(Math.PI*(s+1)/t))/(2*t)}for(s=0;s<r;s++){c=0;for(l=0;l<n;l++){u=s+l+1-t;if(u<-r)u-=a*Math.round(u/a);else if(u>=a)u-=a*Math.floor(u/a);if(u<0)u=-1-u;else if(u>=r)u=a-1-u;c+=e[u]*i[l]}o[s]=c}return o};f.syncOrAsync=function(e,t,r){var a,n;function i(){return f.syncOrAsync(e,t,r)}while(e.length){n=e.splice(0,1)[0];a=n(t);if(a&&a.then){return a.then(i)}}return r&&r(t)};f.stripTrailingSlash=function(e){if(e.substr(-1)==="/")return e.substr(0,e.length-1);return e};f.noneOrAll=function(e,t,r){if(!e)return;var a=false;var n=true;var i;var o;for(i=0;i<r.length;i++){o=e[r[i]];if(o!==undefined&&o!==null)a=true;else n=false}if(a&&!n){for(i=0;i<r.length;i++){e[r[i]]=t[r[i]]}}};f.mergeArray=function(e,t,r,a){var n=typeof a==="function";if(f.isArrayOrTypedArray(e)){var i=Math.min(e.length,t.length);for(var o=0;o<i;o++){var s=e[o];t[o][r]=n?a(s):s}}};f.mergeArrayCastPositive=function(e,t,r){return f.mergeArray(e,t,r,(function(e){var t=+e;return!isFinite(t)?0:t>0?t:0}))};f.fillArray=function(e,t,r,a){a=a||f.identity;if(f.isArrayOrTypedArray(e)){for(var n=0;n<t.length;n++){t[n][r]=a(e[n])}}};f.castOption=function(e,t,r,a){a=a||f.identity;var n=f.nestedProperty(e,r).get();if(f.isArrayOrTypedArray(n)){if(Array.isArray(t)&&f.isArrayOrTypedArray(n[t[0]])){return a(n[t[0]][t[1]])}else{return a(n[t])}}else{return n}};f.extractOption=function(e,t,r,a){if(r in e)return e[r];var n=f.nestedProperty(t,a).get();if(!Array.isArray(n))return n};function E(e){var t={};for(var r in e){var a=e[r];for(var n=0;n<a.length;n++){t[a[n]]=+r}}return t}f.tagSelected=function(e,t,r){var a=t.selectedpoints;var n=t._indexToPoints;var i;if(n){i=E(n)}function o(t){return t!==undefined&&t<e.length}for(var s=0;s<a.length;s++){var l=a[s];if(f.isIndex(l)||f.isArrayOrTypedArray(l)&&f.isIndex(l[0])&&f.isIndex(l[1])){var u=i?i[l]:l;var c=r?r[u]:u;if(o(c)){e[c].selected=1}}}};f.selIndices2selPoints=function(e){var t=e.selectedpoints;var r=e._indexToPoints;if(r){var a=E(r);var n=[];for(var i=0;i<t.length;i++){var o=t[i];if(f.isIndex(o)){var s=a[o];if(f.isIndex(s)){n.push(s)}}}return n}else{return t}};f.getTargetArray=function(e,t){var r=t.target;if(typeof r==="string"&&r){var a=f.nestedProperty(e,r).get();return Array.isArray(a)?a:false}else if(Array.isArray(r)){return r}return false};f.minExtend=function(e,t){var r={};if(typeof t!=="object")t={};var a=3;var n=Object.keys(e);var i,o,s;for(i=0;i<n.length;i++){o=n[i];s=e[o];if(o.charAt(0)==="_"||typeof s==="function")continue;else if(o==="module")r[o]=s;else if(Array.isArray(s)){if(o==="colorscale"){r[o]=s.slice()}else{r[o]=s.slice(0,a)}}else if(f.isTypedArray(s)){r[o]=s.subarray(0,a)}else if(s&&typeof s==="object")r[o]=f.minExtend(e[o],t[o]);else r[o]=s}n=Object.keys(t);for(i=0;i<n.length;i++){o=n[i];s=t[o];if(typeof s!=="object"||!(o in r)||typeof r[o]!=="object"){r[o]=s}}return r};f.titleCase=function(e){return e.charAt(0).toUpperCase()+e.substr(1)};f.containsAny=function(e,t){for(var r=0;r<t.length;r++){if(e.indexOf(t[r])!==-1)return true}return false};f.isIE=function(){return typeof window.navigator.msSaveBlob!=="undefined"};var L=/Version\/[\d\.]+.*Safari/;f.isSafari=function(){return L.test(window.navigator.userAgent)};var C=/iPad|iPhone|iPod/;f.isIOS=function(){return C.test(window.navigator.userAgent)};var I=/Firefox\/(\d+)\.\d+/;f.getFirefoxVersion=function(){var e=I.exec(window.navigator.userAgent);if(e&&e.length===2){var t=parseInt(e[1]);if(!isNaN(t)){return t}}return null};f.isD3Selection=function(e){return e instanceof a.selection};f.ensureSingle=function(e,t,r,a){var n=e.select(t+(r?"."+r:""));if(n.size())return n;var i=e.append(t);if(r)i.classed(r,true);if(a)i.call(a);return i};f.ensureSingleById=function(e,t,r,a){var n=e.select(t+"#"+r);if(n.size())return n;var i=e.append(t).attr("id",r);if(a)i.call(a);return i};f.objectFromPath=function(e,t){var r=e.split(".");var a;var n=a={};for(var i=0;i<r.length;i++){var o=r[i];var s=null;var l=r[i].match(/(.*)\[([0-9]+)\]/);if(l){o=l[1];s=l[2];a=a[o]=[];if(i===r.length-1){a[s]=t}else{a[s]={}}a=a[s]}else{if(i===r.length-1){a[o]=t}else{a[o]={}}a=a[o]}}return n};var P=/^([^\[\.]+)\.(.+)?/;var O=/^([^\.]+)\[([0-9]+)\](\.)?(.+)?/;f.expandObjectPaths=function(e){var t,r,a,n,i,o,s;if(typeof e==="object"&&!Array.isArray(e)){for(r in e){if(e.hasOwnProperty(r)){if(t=r.match(P)){n=e[r];a=t[1];delete e[r];e[a]=f.extendDeepNoArrays(e[a]||{},f.objectFromPath(r,f.expandObjectPaths(n))[a])}else if(t=r.match(O)){n=e[r];a=t[1];i=parseInt(t[2]);delete e[r];e[a]=e[a]||[];if(t[3]==="."){s=t[4];o=e[a][i]=e[a][i]||{};f.extendDeepNoArrays(o,f.objectFromPath(s,f.expandObjectPaths(n)))}else{e[a][i]=f.expandObjectPaths(n)}}else{e[r]=f.expandObjectPaths(e[r])}}}}return e};f.numSeparate=function(e,t,r){if(!r)r=false;if(typeof t!=="string"||t.length===0){throw new Error("Separator string required for formatting!")}if(typeof e==="number"){e=String(e)}var a=/(\d+)(\d{3})/;var n=t.charAt(0);var i=t.charAt(1);var o=e.split(".");var s=o[0];var l=o.length>1?n+o[1]:"";if(i&&(o.length>1||s.length>4||r)){while(a.test(s)){s=s.replace(a,"$1"+i+"$2")}}return s+l};f.TEMPLATE_STRING_REGEX=/%{([^\s%{}:]*)([:|\|][^}]*)?}/g;var z=/^\w*$/;f.templateString=function(e,t){var r={};return e.replace(f.TEMPLATE_STRING_REGEX,(function(e,a){var n;if(z.test(a)){n=t[a]}else{r[a]=r[a]||f.nestedProperty(t,a).get;n=r[a]()}return f.isValidTextValue(n)?n:""}))};var D={max:10,count:0,name:"hovertemplate"};f.hovertemplateString=function(){return B.apply(D,arguments)};var R={max:10,count:0,name:"texttemplate"};f.texttemplateString=function(){return B.apply(R,arguments)};var F=/^[:|\|]/;function B(e,t,r){var a=this;var i=arguments;if(!t)t={};var o={};return e.replace(f.TEMPLATE_STRING_REGEX,(function(e,s,l){var u=s==="xother"||s==="yother";var c=s==="_xother"||s==="_yother";var h=s==="_xother_"||s==="_yother_";var p=s==="xother_"||s==="yother_";var v=u||c||p||h;var d=s;if(c||h)d=d.substring(1);if(p||h)d=d.substring(0,d.length-1);var m;if(v){m=t[d];if(m===undefined)return""}else{var g,y;for(y=3;y<i.length;y++){g=i[y];if(!g)continue;if(g.hasOwnProperty(d)){m=g[d];break}if(!z.test(d)){m=f.nestedProperty(g,d).get();m=o[d]||f.nestedProperty(g,d).get();if(m)o[d]=m}if(m!==undefined)break}}if(m===undefined&&a){if(a.count<a.max){f.warn("Variable '"+d+"' in "+a.name+" could not be found!");m=e}if(a.count===a.max){f.warn("Too many "+a.name+" warnings - additional warnings will be suppressed")}a.count++;return e}if(l){var x;if(l[0]===":"){x=r?r.numberFormat:f.numberFormat;m=x(l.replace(F,""))(m)}if(l[0]==="|"){x=r?r.timeFormat:n;var b=f.dateTime2ms(m);m=f.formatDate(b,l.replace(F,""),false,x)}}else{var _=d+"Label";if(t.hasOwnProperty(_))m=t[_]}if(v){m="("+m+")";if(c||h)m=" "+m;if(p||h)m=m+" "}return m}))}var N=48;var j=57;f.subplotSort=function(e,t){var r=Math.min(e.length,t.length)+1;var a=0;var n=0;for(var i=0;i<r;i++){var o=e.charCodeAt(i)||0;var s=t.charCodeAt(i)||0;var l=o>=N&&o<=j;var u=s>=N&&s<=j;if(l)a=10*a+o-N;if(u)n=10*n+s-N;if(!l||!u){if(a!==n)return a-n;if(o!==s)return o-s}}return n-a};var U=2e9;f.seedPseudoRandom=function(){U=2e9};f.pseudoRandom=function(){var e=U;U=(69069*U+1)%4294967296;if(Math.abs(U-e)<429496729)return f.pseudoRandom();return U/4294967296};f.fillText=function(e,t,r){var a=Array.isArray(r)?function(e){r.push(e)}:function(e){r.text=e};var n=f.extractOption(e,t,"htx","hovertext");if(f.isValidTextValue(n))return a(n);var i=f.extractOption(e,t,"tx","text");if(f.isValidTextValue(i))return a(i)};f.isValidTextValue=function(e){return e||e===0};f.formatPercent=function(e,t){t=t||0;var r=(Math.round(100*e*Math.pow(10,t))*Math.pow(.1,t)).toFixed(t)+"%";for(var a=0;a<t;a++){if(r.indexOf(".")!==-1){r=r.replace("0%","%");r=r.replace(".%","%")}}return r};f.isHidden=function(e){var t=window.getComputedStyle(e).display;return!t||t==="none"};f.strTranslate=function(e,t){return e||t?"translate("+e+","+t+")":""};f.strRotate=function(e){return e?"rotate("+e+")":""};f.strScale=function(e){return e!==1?"scale("+e+")":""};f.getTextTransform=function(e){var t=e.noCenter;var r=e.textX;var a=e.textY;var n=e.targetX;var i=e.targetY;var o=e.anchorX||0;var s=e.anchorY||0;var l=e.rotate;var u=e.scale;if(!u)u=0;else if(u>1)u=1;return f.strTranslate(n-u*(r+o),i-u*(a+s))+f.strScale(u)+(l?"rotate("+l+(t?"":" "+r+" "+a)+")":"")};f.ensureUniformFontSize=function(e,t){var r=f.extendFlat({},t);r.size=Math.max(t.size,e._fullLayout.uniformtext.minsize||0);return r};f.join2=function(e,t,r){var a=e.length;if(a>1){return e.slice(0,-1).join(t)+r+e[a-1]}return e.join(t)};f.bigFont=function(e){return Math.round(1.2*e)};var V=f.getFirefoxVersion();var H=V!==null&&V<86;f.getPositionFromD3Event=function(){if(H){return[a.event.layerX,a.event.layerY]}else{return[a.event.offsetX,a.event.offsetY]}}},{"../constants/numerical":763,"./anchor_utils":767,"./angles":768,"./array":769,"./clean_number":770,"./clear_responsive":772,"./coerce":773,"./dates":774,"./dom":775,"./extend":777,"./filter_unique":778,"./filter_visible":779,"./geometry2d":782,"./identity":785,"./increment":786,"./is_plain_object":788,"./keyed_container":789,"./localize":790,"./loggers":791,"./make_trace_groups":792,"./matrix":793,"./mod":794,"./nested_property":795,"./noop":796,"./notifier":797,"./preserve_drawing_buffer":801,"./push_unique":802,"./regex":804,"./relative_attr":805,"./relink_private":806,"./search":807,"./sort_object_keys":810,"./stats":811,"./throttle":814,"./to_log_range":815,"@plotly/d3":58,"d3-format":164,"d3-time-format":172,"fast-isnumeric":246}],788:[function(e,t,r){"use strict";t.exports=function e(t){if(window&&window.process&&window.process.versions){return Object.prototype.toString.call(t)==="[object Object]"}return Object.prototype.toString.call(t)==="[object Object]"&&Object.getPrototypeOf(t).hasOwnProperty("hasOwnProperty")}},{}],789:[function(e,t,r){"use strict";var a=e("./nested_property");var n=/^\w*$/;var i=0;var o=1;var s=2;var l=3;var u=4;t.exports=function e(t,r,c,f){c=c||"name";f=f||"value";var h,p,v;var d={};if(r&&r.length){v=a(t,r);p=v.get()}else{p=t}r=r||"";var m={};if(p){for(h=0;h<p.length;h++){m[p[h][c]]=h}}var g=n.test(f);var y={set:function(e,t){var r=t===null?u:i;if(!p){if(!v||r===u)return;p=[];v.set(p)}var n=m[e];if(n===undefined){if(r===u)return;r=r|l;n=p.length;m[e]=n}else if(t!==(g?p[n][f]:a(p[n],f).get())){r=r|s}var o=p[n]=p[n]||{};o[c]=e;if(g){o[f]=t}else{a(o,f).set(t)}if(t!==null){r=r&~u}d[n]=d[n]|r;return y},get:function(e){if(!p)return;var t=m[e];if(t===undefined){return undefined}else if(g){return p[t][f]}else{return a(p[t],f).get()}},rename:function(e,t){var r=m[e];if(r===undefined)return y;d[r]=d[r]|o;m[t]=r;delete m[e];p[r][c]=t;return y},remove:function(e){var t=m[e];if(t===undefined)return y;var r=p[t];if(Object.keys(r).length>2){d[t]=d[t]|s;return y.set(e,null)}if(g){for(h=t;h<p.length;h++){d[h]=d[h]|l}for(h=t;h<p.length;h++){m[p[h][c]]--}p.splice(t,1);delete m[e]}else{a(r,f).set(null);d[t]=d[t]|s|u}return y},constructUpdate:function(){var e,t;var n={};var i=Object.keys(d);for(var l=0;l<i.length;l++){t=i[l];e=r+"["+t+"]";if(p[t]){if(d[t]&o){n[e+"."+c]=p[t][c]}if(d[t]&s){if(g){n[e+"."+f]=d[t]&u?null:p[t][f]}else{n[e+"."+f]=d[t]&u?null:a(p[t],f).get()}}}else{n[e]=null}}return n}};return y}},{"./nested_property":795}],790:[function(e,t,r){"use strict";var a=e("../registry");t.exports=function e(t,r){var n=t._context.locale;for(var i=0;i<2;i++){var o=t._context.locales;for(var s=0;s<2;s++){var l=(o[n]||{}).dictionary;if(l){var u=l[r];if(u)return u}o=a.localeRegistry}var c=n.split("-")[0];if(c===n)break;n=c}return r}},{"../registry":915}],791:[function(e,t,r){"use strict";var a=e("../plot_api/plot_config").dfltConfig;var n=e("./notifier");var i=t.exports={};i.log=function(){var e;if(a.logging>1){var t=["LOG:"];for(e=0;e<arguments.length;e++){t.push(arguments[e])}console.trace.apply(console,t)}if(a.notifyOnLogging>1){var r=[];for(e=0;e<arguments.length;e++){r.push(arguments[e])}n(r.join("<br>"),"long")}};i.warn=function(){var e;if(a.logging>0){var t=["WARN:"];for(e=0;e<arguments.length;e++){t.push(arguments[e])}console.trace.apply(console,t)}if(a.notifyOnLogging>0){var r=[];for(e=0;e<arguments.length;e++){r.push(arguments[e])}n(r.join("<br>"),"stick")}};i.error=function(){var e;if(a.logging>0){var t=["ERROR:"];for(e=0;e<arguments.length;e++){t.push(arguments[e])}console.error.apply(console,t)}if(a.notifyOnLogging>0){var r=[];for(e=0;e<arguments.length;e++){r.push(arguments[e])}n(r.join("<br>"),"stick")}}},{"../plot_api/plot_config":825,"./notifier":797}],792:[function(e,t,r){"use strict";var a=e("@plotly/d3");t.exports=function e(t,r,n){var i=t.selectAll("g."+n.replace(/\s/g,".")).data(r,(function(e){return e[0].trace.uid}));i.exit().remove();i.enter().append("g").attr("class",n);i.order();var o=t.classed("rangeplot")?"nodeRangePlot3":"node3";i.each((function(e){e[0][o]=a.select(this)}));return i}},{"@plotly/d3":58}],793:[function(e,t,r){"use strict";var a=e("gl-mat4");r.init2dArray=function(e,t){var r=new Array(e);for(var a=0;a<e;a++)r[a]=new Array(t);return r};r.transposeRagged=function(e){var t=0;var r=e.length;var a,n;for(a=0;a<r;a++)t=Math.max(t,e[a].length);var i=new Array(t);for(a=0;a<t;a++){i[a]=new Array(r);for(n=0;n<r;n++)i[a][n]=e[n][a]}return i};r.dot=function(e,t){if(!(e.length&&t.length)||e.length!==t.length)return null;var a=e.length;var n;var i;if(e[0].length){n=new Array(a);for(i=0;i<a;i++)n[i]=r.dot(e[i],t)}else if(t[0].length){var o=r.transposeRagged(t);n=new Array(o.length);for(i=0;i<o.length;i++)n[i]=r.dot(e,o[i])}else{n=0;for(i=0;i<a;i++)n+=e[i]*t[i]}return n};r.translationMatrix=function(e,t){return[[1,0,e],[0,1,t],[0,0,1]]};r.rotationMatrix=function(e){var t=e*Math.PI/180;return[[Math.cos(t),-Math.sin(t),0],[Math.sin(t),Math.cos(t),0],[0,0,1]]};r.rotationXYMatrix=function(e,t,a){return r.dot(r.dot(r.translationMatrix(t,a),r.rotationMatrix(e)),r.translationMatrix(-t,-a))};r.apply3DTransform=function(e){return function(){var t=arguments;var a=arguments.length===1?t[0]:[t[0],t[1],t[2]||0];return r.dot(e,[a[0],a[1],a[2],1]).slice(0,3)}};r.apply2DTransform=function(e){return function(){var t=arguments;if(t.length===3){t=t[0]}var a=arguments.length===1?t[0]:[t[0],t[1]];return r.dot(e,[a[0],a[1],1]).slice(0,2)}};r.apply2DTransform2=function(e){var t=r.apply2DTransform(e);return function(e){return t(e.slice(0,2)).concat(t(e.slice(2,4)))}};r.convertCssMatrix=function(e){if(e){var t=e.length;if(t===16)return e;if(t===6){return[e[0],e[1],0,0,e[2],e[3],0,0,0,0,1,0,e[4],e[5],0,1]}}return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]};r.inverseTransformMatrix=function(e){var t=[];a.invert(t,e);return[[t[0],t[1],t[2],t[3]],[t[4],t[5],t[6],t[7]],[t[8],t[9],t[10],t[11]],[t[12],t[13],t[14],t[15]]]}},{"gl-mat4":292}],794:[function(e,t,r){"use strict";function a(e,t){var r=e%t;return r<0?r+t:r}function n(e,t){return Math.abs(e)>t/2?e-Math.round(e/t)*t:e}t.exports={mod:a,modHalf:n}},{}],795:[function(e,t,r){"use strict";var a=e("fast-isnumeric");var n=e("./array").isArrayOrTypedArray;t.exports=function e(t,r){if(a(r))r=String(r);else if(typeof r!=="string"||r.substr(r.length-4)==="[-1]"){throw"bad property string"}var n=0;var o=r.split(".");var s;var u;var c;while(n<o.length){s=String(o[n]).match(/^([^\[\]]*)((\[\-?[0-9]*\])+)$/);if(s){if(s[1])o[n]=s[1];else if(n===0)o.splice(0,1);else throw"bad property string";u=s[2].substr(1,s[2].length-2).split("][");for(c=0;c<u.length;c++){n++;o.splice(n,0,Number(u[c]))}}n++}if(typeof t!=="object"){return h(t,r,o)}return{set:l(t,o,r),get:i(t,o),astr:r,parts:o,obj:t}};function i(e,t){return function(){var r=e;var a;var o;var s;var l;var u;for(l=0;l<t.length-1;l++){a=t[l];if(a===-1){o=true;s=[];for(u=0;u<r.length;u++){s[u]=i(r[u],t.slice(l+1))();if(s[u]!==s[0])o=false}return o?s[0]:s}if(typeof a==="number"&&!n(r)){return undefined}r=r[a];if(typeof r!=="object"||r===null){return undefined}}if(typeof r!=="object"||r===null)return undefined;s=r[t[l]];if(s===null)return undefined;return s}}var o=/(^|\.)args\[/;function s(e,t){return e===undefined||e===null&&!t.match(o)}function l(e,t,r){return function(a){var i=e;var o="";var l=[[e,o]];var h=s(a,r);var p;var v;for(v=0;v<t.length-1;v++){p=t[v];if(typeof p==="number"&&!n(i)){throw"array index but container is not an array"}if(p===-1){h=!c(i,t.slice(v+1),a,r);if(h)break;else return}if(!f(i,p,t[v+1],h)){break}i=i[p];if(typeof i!=="object"||i===null){throw"container is not an object"}o=u(o,p);l.push([i,o])}if(h){if(v===t.length-1){delete i[t[v]];if(Array.isArray(i)&&+t[v]===i.length-1){while(i.length&&i[i.length-1]===undefined){i.pop()}}}}else i[t[v]]=a}}function u(e,t){var r=t;if(a(t))r="["+t+"]";else if(e)r="."+t;return e+r}function c(e,t,r,a){var i=n(r);var o=true;var u=r;var c=a.replace("-1",0);var h=i?false:s(r,c);var p=t[0];var v;for(v=0;v<e.length;v++){c=a.replace("-1",v);if(i){u=r[v%r.length];h=s(u,c)}if(h)o=false;if(!f(e,v,p,h)){continue}l(e[v],t,a.replace("-1",v))(u)}return o}function f(e,t,r,a){if(e[t]===undefined){if(a)return false;if(typeof r==="number")e[t]=[];else e[t]={}}return true}function h(e,t,r){return{set:function(){throw"bad container"},get:function(){},astr:t,parts:r,obj:e}}},{"./array":769,"fast-isnumeric":246}],796:[function(e,t,r){"use strict";t.exports=function e(){}},{}],797:[function(e,t,r){"use strict";var a=e("@plotly/d3");var n=e("fast-isnumeric");var i=[];t.exports=function(e,t){if(i.indexOf(e)!==-1)return;i.push(e);var r=1e3;if(n(t))r=t;else if(t==="long")r=3e3;var o=a.select("body").selectAll(".plotly-notifier").data([0]);o.enter().append("div").classed("plotly-notifier",true);var s=o.selectAll(".notifier-note").data(i);function l(e){e.duration(700).style("opacity",0).each("end",(function(e){var t=i.indexOf(e);if(t!==-1)i.splice(t,1);a.select(this).remove()}))}s.enter().append("div").classed("notifier-note",true).style("opacity",0).each((function(e){var n=a.select(this);n.append("button").classed("notifier-close",true).html("&times;").on("click",(function(){n.transition().call(l)}));var i=n.append("p");var o=e.split(/<br\s*\/?>/g);for(var s=0;s<o.length;s++){if(s)i.append("br");i.append("span").text(o[s])}if(t==="stick"){n.transition().duration(350).style("opacity",1)}else{n.transition().duration(700).style("opacity",1).transition().delay(r).call(l)}}))}},{"@plotly/d3":58,"fast-isnumeric":246}],798:[function(e,t,r){"use strict";var a=e("./setcursor");var n="data-savedcursor";var i="!!";t.exports=function e(t,r){var o=t.attr(n);if(r){if(!o){var s=(t.attr("class")||"").split(" ");for(var l=0;l<s.length;l++){var u=s[l];if(u.indexOf("cursor-")===0){t.attr(n,u.substr(7)).classed(u,false)}}if(!t.attr(n)){t.attr(n,i)}}a(t,r)}else if(o){t.attr(n,null);if(o===i)a(t);else a(t,o)}}},{"./setcursor":808}],799:[function(e,t,r){"use strict";var a=e("./matrix").dot;var n=e("../constants/numerical").BADNUM;var i=t.exports={};i.tester=function e(t){var r=t.slice();var a=r[0][0];var i=a;var o=r[0][1];var s=o;var l;r.push(r[0]);for(l=1;l<r.length;l++){a=Math.min(a,r[l][0]);i=Math.max(i,r[l][0]);o=Math.min(o,r[l][1]);s=Math.max(s,r[l][1])}var u=false;var c;if(r.length===5){if(r[0][0]===r[1][0]){if(r[2][0]===r[3][0]&&r[0][1]===r[3][1]&&r[1][1]===r[2][1]){u=true;c=function(e){return e[0]===r[0][0]}}}else if(r[0][1]===r[1][1]){if(r[2][1]===r[3][1]&&r[0][0]===r[3][0]&&r[1][0]===r[2][0]){u=true;c=function(e){return e[1]===r[0][1]}}}}function f(e,t){var r=e[0];var l=e[1];if(r===n||r<a||r>i||l===n||l<o||l>s){return false}if(t&&c(e))return false;return true}function h(e,t){var l=e[0];var u=e[1];if(l===n||l<a||l>i||u===n||u<o||u>s){return false}var c=r.length;var f=r[0][0];var h=r[0][1];var p=0;var v;var d;var m;var g;var y;for(v=1;v<c;v++){d=f;m=h;f=r[v][0];h=r[v][1];g=Math.min(d,f);if(l<g||l>Math.max(d,f)||u>Math.max(m,h)){continue}else if(u<Math.min(m,h)){if(l!==g)p++}else{if(f===d)y=u;else y=m+(l-d)*(h-m)/(f-d);if(u===y){if(v===1&&t)return false;return true}if(u<=y&&l!==g)p++}}return p%2===1}var p=true;var v=r[0];for(l=1;l<r.length;l++){if(v[0]!==r[l][0]||v[1]!==r[l][1]){p=false;break}}return{xmin:a,xmax:i,ymin:o,ymax:s,pts:r,contains:u?f:h,isRect:u,degenerate:p}};i.isSegmentBent=function e(t,r,n,i){var o=t[r];var s=[t[n][0]-o[0],t[n][1]-o[1]];var l=a(s,s);var u=Math.sqrt(l);var c=[-s[1]/u,s[0]/u];var f;var h;var p;for(f=r+1;f<n;f++){h=[t[f][0]-o[0],t[f][1]-o[1]];p=a(h,s);if(p<0||p>l||Math.abs(a(h,c))>i)return true}return false};i.filter=function e(t,r){var a=[t[0]];var n=0;var o=0;function s(e){t.push(e);var s=a.length;var l=n;a.splice(o+1);for(var u=l+1;u<t.length;u++){if(u===t.length-1||i.isSegmentBent(t,l,u+1,r)){a.push(t[u]);if(a.length<s-2){n=u;o=a.length-1}l=u}}}if(t.length>1){var l=t.pop();s(l)}return{addPt:s,raw:t,filtered:a}}},{"../constants/numerical":763,"./matrix":793}],800:[function(e,r,a){(function(t){(function(){"use strict";var a=e("./show_no_webgl_msg");var n=e("regl");r.exports=function e(r,i){var o=r._fullLayout;var s=true;o._glcanvas.each((function(e){if(e.regl)return;if(e.pick&&!o._has("parcoords"))return;try{e.regl=n({canvas:this,attributes:{antialias:!e.pick,preserveDrawingBuffer:true},pixelRatio:r._context.plotGlPixelRatio||t.devicePixelRatio,extensions:i||[]})}catch(a){s=false}if(!e.regl)s=false;if(s){this.addEventListener("webglcontextlost",(function(t){if(r&&r.emit){r.emit("plotly_webglcontextlost",{event:t,layer:e.key})}}),false)}}));if(!s){a({container:o._glcontainer.node()})}return s}}).call(this)}).call(this,typeof t!=="undefined"?t:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./show_no_webgl_msg":809,regl:526}],801:[function(e,t,r){"use strict";var a=e("fast-isnumeric");var n=e("is-mobile");t.exports=function e(t){var r;if(t&&t.hasOwnProperty("userAgent")){r=t.userAgent}else{r=i()}if(typeof r!=="string")return true;var o=n({ua:{headers:{"user-agent":r}},tablet:true,featureDetect:false});if(!o){var s=r.split(" ");for(var l=1;l<s.length;l++){var u=s[l];if(u.indexOf("Safari")!==-1){for(var c=l-1;c>-1;c--){var f=s[c];if(f.substr(0,8)==="Version/"){var h=f.substr(8).split(".")[0];if(a(h))h=+h;if(h>=13)return true}}}}}return o};function i(){var e;if(typeof navigator!=="undefined"){e=navigator.userAgent}if(e&&e.headers&&typeof e.headers["user-agent"]==="string"){e=e.headers["user-agent"]}return e}},{"fast-isnumeric":246,"is-mobile":445}],802:[function(e,t,r){"use strict";t.exports=function e(t,r){if(r instanceof RegExp){var a=r.toString();for(var n=0;n<t.length;n++){if(t[n]instanceof RegExp&&t[n].toString()===a){return t}}t.push(r)}else if((r||r===0)&&t.indexOf(r)===-1)t.push(r);return t}},{}],803:[function(e,t,r){"use strict";var a=e("../lib");var n=e("../plot_api/plot_config").dfltConfig;function i(e,t){var r=[];var n;for(var i=0;i<t.length;i++){n=t[i];if(n===e)r[i]=n;else if(typeof n==="object"){r[i]=Array.isArray(n)?a.extendDeep([],n):a.extendDeepAll({},n)}else r[i]=n}return r}var o={};o.add=function(e,t,r,a,i){var o,s;e.undoQueue=e.undoQueue||{index:0,queue:[],sequence:false};s=e.undoQueue.index;if(e.autoplay){if(!e.undoQueue.inSequence)e.autoplay=false;return}if(!e.undoQueue.sequence||e.undoQueue.beginSequence){o={undo:{calls:[],args:[]},redo:{calls:[],args:[]}};e.undoQueue.queue.splice(s,e.undoQueue.queue.length-s,o);e.undoQueue.index+=1}else{o=e.undoQueue.queue[s-1]}e.undoQueue.beginSequence=false;if(o){o.undo.calls.unshift(t);o.undo.args.unshift(r);o.redo.calls.push(a);o.redo.args.push(i)}if(e.undoQueue.queue.length>n.queueLength){e.undoQueue.queue.shift();e.undoQueue.index--}};o.startSequence=function(e){e.undoQueue=e.undoQueue||{index:0,queue:[],sequence:false};e.undoQueue.sequence=true;e.undoQueue.beginSequence=true};o.stopSequence=function(e){e.undoQueue=e.undoQueue||{index:0,queue:[],sequence:false};e.undoQueue.sequence=false;e.undoQueue.beginSequence=false};o.undo=function e(t){var r,a;if(t.undoQueue===undefined||isNaN(t.undoQueue.index)||t.undoQueue.index<=0){return}t.undoQueue.index--;r=t.undoQueue.queue[t.undoQueue.index];t.undoQueue.inSequence=true;for(a=0;a<r.undo.calls.length;a++){o.plotDo(t,r.undo.calls[a],r.undo.args[a])}t.undoQueue.inSequence=false;t.autoplay=false};o.redo=function e(t){var r,a;if(t.undoQueue===undefined||isNaN(t.undoQueue.index)||t.undoQueue.index>=t.undoQueue.queue.length){return}r=t.undoQueue.queue[t.undoQueue.index];t.undoQueue.inSequence=true;for(a=0;a<r.redo.calls.length;a++){o.plotDo(t,r.redo.calls[a],r.redo.args[a])}t.undoQueue.inSequence=false;t.autoplay=false;t.undoQueue.index++};o.plotDo=function(e,t,r){e.autoplay=true;r=i(e,r);t.apply(null,r)};t.exports=o},{"../lib":787,"../plot_api/plot_config":825}],804:[function(e,t,r){"use strict";r.counter=function(e,t,r,a){var n=(t||"")+(r?"":"$");var i=a===false?"":"^";if(e==="xy"){return new RegExp(i+"x([2-9]|[1-9][0-9]+)?y([2-9]|[1-9][0-9]+)?"+n)}return new RegExp(i+e+"([2-9]|[1-9][0-9]+)?"+n)}},{}],805:[function(e,t,r){"use strict";var a=/^(.*)(\.[^\.\[\]]+|\[\d\])$/;var n=/^[^\.\[\]]+$/;t.exports=function(e,t){while(t){var r=e.match(a);if(r)e=r[1];else if(e.match(n))e="";else throw new Error("bad relativeAttr call:"+[e,t]);if(t.charAt(0)==="^")t=t.slice(1);else break}if(e&&t.charAt(0)!=="["){return e+"."+t}return e+t}},{}],806:[function(e,t,r){"use strict";var a=e("./array").isArrayOrTypedArray;var n=e("./is_plain_object");t.exports=function e(t,r){for(var i in r){var o=r[i];var s=t[i];if(s===o)continue;if(i.charAt(0)==="_"||typeof o==="function"){if(i in t)continue;t[i]=o}else if(a(o)&&a(s)&&n(o[0])){if(i==="customdata"||i==="ids")continue;var l=Math.min(o.length,s.length);for(var u=0;u<l;u++){if(s[u]!==o[u]&&n(o[u])&&n(s[u])){e(s[u],o[u])}}}else if(n(o)&&n(s)){e(s,o);if(!Object.keys(s).length)delete t[i]}}}},{"./array":769,"./is_plain_object":788}],807:[function(e,t,r){"use strict";var a=e("fast-isnumeric");var n=e("./loggers");var i=e("./identity");var o=e("../constants/numerical").BADNUM;var s=1e-9;r.findBin=function(e,t,r){if(a(t.start)){return r?Math.ceil((e-t.start)/t.size-s)-1:Math.floor((e-t.start)/t.size+s)}else{var i=0;var o=t.length;var h=0;var p=o>1?(t[o-1]-t[0])/(o-1):1;var v,d;if(p>=0){d=r?l:u}else{d=r?f:c}e+=p*s*(r?-1:1)*(p>=0?1:-1);while(i<o&&h++<100){v=Math.floor((i+o)/2);if(d(t[v],e))i=v+1;else o=v}if(h>90)n.log("Long binary search...");return i-1}};function l(e,t){return e<t}function u(e,t){return e<=t}function c(e,t){return e>t}function f(e,t){return e>=t}r.sorterAsc=function(e,t){return e-t};r.sorterDes=function(e,t){return t-e};r.distinctVals=function(e){var t=e.slice();t.sort(r.sorterAsc);var a;for(a=t.length-1;a>-1;a--){if(t[a]!==o)break}var n=t[a]-t[0]||1;var i=n/(a||1)/1e4;var s=[];var l;for(var u=0;u<=a;u++){var c=t[u];var f=c-l;if(l===undefined){s.push(c);l=c}else if(f>i){n=Math.min(n,f);s.push(c);l=c}}return{vals:s,minDiff:n}};r.roundUp=function(e,t,r){var a=0;var n=t.length-1;var i;var o=0;var s=r?0:1;var l=r?1:0;var u=r?Math.ceil:Math.floor;while(a<n&&o++<100){i=u((a+n)/2);if(t[i]<=e)a=i+s;else n=i-l}return t[a]};r.sort=function(e,t){var r=0;var a=0;for(var n=1;n<e.length;n++){var i=t(e[n],e[n-1]);if(i<0)r=1;else if(i>0)a=1;if(r&&a)return e.sort(t)}return a?e:e.reverse()};r.findIndexOfMin=function(e,t){t=t||i;var r=Infinity;var a;for(var n=0;n<e.length;n++){var o=t(e[n]);if(o<r){r=o;a=n}}return a}},{"../constants/numerical":763,"./identity":785,"./loggers":791,"fast-isnumeric":246}],808:[function(e,t,r){"use strict";t.exports=function e(t,r){(t.attr("class")||"").split(" ").forEach((function(e){if(e.indexOf("cursor-")===0)t.classed(e,false)}));if(r)t.classed("cursor-"+r,true)}},{}],809:[function(e,t,r){"use strict";var a=e("../components/color");var n=function(){};t.exports=function e(t){for(var r in t){if(typeof t[r]==="function")t[r]=n}t.destroy=function(){t.container.parentNode.removeChild(t.container)};var i=document.createElement("div");i.className="no-webgl";i.style.cursor="pointer";i.style.fontSize="24px";i.style.color=a.defaults[0];i.style.position="absolute";i.style.left=i.style.top="0px";i.style.width=i.style.height="100%";i.style["background-color"]=a.lightLine;i.style["z-index"]=30;var o=document.createElement("p");o.textContent="WebGL is not supported by your browser - visit https://get.webgl.org for more info";o.style.position="relative";o.style.top="50%";o.style.left="50%";o.style.height="30%";o.style.width="50%";o.style.margin="-15% 0 0 -25%";i.appendChild(o);t.container.appendChild(i);t.container.style.background="#FFFFFF";t.container.onclick=function(){window.open("https://get.webgl.org")};return false}},{"../components/color":650}],810:[function(e,t,r){"use strict";t.exports=function e(t){return Object.keys(t).sort()}},{}],811:[function(e,t,r){"use strict";var a=e("fast-isnumeric");var n=e("./array").isArrayOrTypedArray;r.aggNums=function(e,t,i,o){var s,l;if(!o||o>i.length)o=i.length;if(!a(t))t=false;if(n(i[0])){l=new Array(o);for(s=0;s<o;s++)l[s]=r.aggNums(e,t,i[s]);i=l}for(s=0;s<o;s++){if(!a(t))t=i[s];else if(a(i[s]))t=e(+t,+i[s])}return t};r.len=function(e){return r.aggNums((function(e){return e+1}),0,e)};r.mean=function(e,t){if(!t)t=r.len(e);return r.aggNums((function(e,t){return e+t}),0,e)/t};r.midRange=function(e){if(e===undefined||e.length===0)return undefined;return(r.aggNums(Math.max,null,e)+r.aggNums(Math.min,null,e))/2};r.variance=function(e,t,n){if(!t)t=r.len(e);if(!a(n))n=r.mean(e,t);return r.aggNums((function(e,t){return e+Math.pow(t-n,2)}),0,e)/t};r.stdev=function(e,t,a){return Math.sqrt(r.variance(e,t,a))};r.median=function(e){var t=e.slice().sort();return r.interp(t,.5)};r.interp=function(e,t){if(!a(t))throw"n should be a finite number";t=t*e.length-.5;if(t<0)return e[0];if(t>e.length-1)return e[e.length-1];var r=t%1;return r*e[Math.ceil(t)]+(1-r)*e[Math.floor(t)]}},{"./array":769,"fast-isnumeric":246}],812:[function(e,t,r){"use strict";var a=e("color-normalize");function n(e){if(!e)return[0,0,0,1];return a(e)}t.exports=n},{"color-normalize":131}],813:[function(e,t,r){"use strict";var a=e("@plotly/d3");var n=e("../lib");var i=n.strTranslate;var o=e("../constants/xmlns_namespaces");var s=e("../constants/alignment").LINE_SPACING;function l(e,t){return e.node().getBoundingClientRect()[t]}var u=/([^$]*)([$]+[^$]*[$]+)([^$]*)/;r.convertToTspans=function(e,t,n){var o=e.text();var s=!e.attr("data-notex")&&typeof MathJax!=="undefined"&&o.match(u);var c=a.select(e.node().parentNode);if(c.empty())return;var f=e.attr("class")?e.attr("class").split(" ")[0]:"text";f+="-math";c.selectAll("svg."+f).remove();c.selectAll("g."+f+"-group").remove();e.style("display",null).attr({"data-unformatted":o,"data-math":"N"});function h(){if(!c.empty()){f=e.attr("class")+"-math";c.select("svg."+f).remove()}e.text("").style("white-space","pre");var t=O(e.node(),o);if(t){e.style("pointer-events","all")}r.positionText(e);if(n)n.call(e)}if(s){(t&&t._promises||[]).push(new Promise((function(t){e.style("display","none");var r=parseInt(e.node().style.fontSize,10);var a={fontSize:r};p(s[2],a,(function(a,s,u){c.selectAll("svg."+f).remove();c.selectAll("g."+f+"-group").remove();var p=a&&a.select("svg");if(!p||!p.node()){h();t();return}var v=c.append("g").classed(f+"-group",true).attr({"pointer-events":"none","data-unformatted":o,"data-math":"Y"});v.node().appendChild(p.node());if(s&&s.node()){p.node().insertBefore(s.node().cloneNode(true),p.node().firstChild)}p.attr({class:f,height:u.height,preserveAspectRatio:"xMinYMin meet"}).style({overflow:"visible","pointer-events":"none"});var d=e.node().style.fill||"black";var m=p.select("g");m.attr({fill:d,stroke:d});var g=l(m,"width");var y=l(m,"height");var x=+e.attr("x")-g*{start:0,middle:.5,end:1}[e.attr("text-anchor")||"start"];var b=r||l(e,"height");var _=-b/4;if(f[0]==="y"){v.attr({transform:"rotate("+[-90,+e.attr("x"),+e.attr("y")]+")"+i(-g/2,_-y/2)});p.attr({x:+e.attr("x"),y:+e.attr("y")})}else if(f[0]==="l"){p.attr({x:e.attr("x"),y:_-y/2})}else if(f[0]==="a"&&f.indexOf("atitle")!==0){p.attr({x:0,y:_})}else{p.attr({x,y:+e.attr("y")+_-y/2})}if(n)n.call(e,v);t(v)}))})))}else h();return e};var c=/(<|&lt;|&#60;)/g;var f=/(>|&gt;|&#62;)/g;function h(e){return e.replace(c,"\\lt ").replace(f,"\\gt ")}function p(e,t,r){var i,o,s,l;MathJax.Hub.Queue((function(){o=n.extendDeepAll({},MathJax.Hub.config);s=MathJax.Hub.processSectionDelay;if(MathJax.Hub.processSectionDelay!==undefined){MathJax.Hub.processSectionDelay=0}return MathJax.Hub.Config({messageStyle:"none",tex2jax:{inlineMath:[["$","$"],["\\(","\\)"]]},displayAlign:"left"})}),(function(){i=MathJax.Hub.config.menuSettings.renderer;if(i!=="SVG"){return MathJax.Hub.setRenderer("SVG")}}),(function(){var r="math-output-"+n.randstr({},64);l=a.select("body").append("div").attr({id:r}).style({visibility:"hidden",position:"absolute"}).style({"font-size":t.fontSize+"px"}).text(h(e));return MathJax.Hub.Typeset(l.node())}),(function(){var t=a.select("body").select("#MathJax_SVG_glyphs");if(l.select(".MathJax_SVG").empty()||!l.select("svg").node()){n.log("There was an error in the tex syntax.",e);r()}else{var o=l.select("svg").node().getBoundingClientRect();r(l.select(".MathJax_SVG"),t,o)}l.remove();if(i!=="SVG"){return MathJax.Hub.setRenderer(i)}}),(function(){if(s!==undefined){MathJax.Hub.processSectionDelay=s}return MathJax.Hub.Config(o)}))}var v={sup:"font-size:70%",sub:"font-size:70%",b:"font-weight:bold",i:"font-style:italic",a:"cursor:pointer",span:"",em:"font-style:italic;font-weight:bold"};var d={sub:"0.3em",sup:"-0.6em"};var m={sub:"-0.21em",sup:"0.42em"};var g="​";var y=["http:","https:","mailto:","",undefined,":"];var x=r.NEWLINES=/(\r\n?|\n)/g;var b=/(<[^<>]*>)/;var _=/<(\/?)([^ >]*)(\s+(.*))?>/i;var w=/<br(\s+.*)?>/i;r.BR_TAG_ALL=/<br(\s+.*)?>/gi;var T=/(^|[\s"'])style\s*=\s*("([^"]*);?"|'([^']*);?')/i;var k=/(^|[\s"'])href\s*=\s*("([^"]*)"|'([^']*)')/i;var M=/(^|[\s"'])target\s*=\s*("([^"\s]*)"|'([^'\s]*)')/i;var A=/(^|[\s"'])popup\s*=\s*("([\w=,]*)"|'([\w=,]*)')/i;function S(e,t){if(!e)return null;var r=e.match(t);var a=r&&(r[3]||r[4]);return a&&I(a)}var E=/(^|;)\s*color:/;r.plainText=function(e,t){t=t||{};var r=t.len!==undefined&&t.len!==-1?t.len:Infinity;var a=t.allowedTags!==undefined?t.allowedTags:["br"];var n="...";var i=n.length;var o=e.split(b);var s=[];var l="";var u=0;for(var c=0;c<o.length;c++){var f=o[c];var h=f.match(_);var p=h&&h[2].toLowerCase();if(p){if(a.indexOf(p)!==-1){s.push(f);l=p}}else{var v=f.length;if(u+v<r){s.push(f);u+=v}else if(u<r){var d=r-u;if(l&&(l!=="br"||d<=i||v<=i)){s.pop()}if(r>i){s.push(f.substr(0,d-i)+n)}else{s.push(f.substr(0,d))}break}l=""}}return s.join("")};var L={mu:"μ",amp:"&",lt:"<",gt:">",nbsp:" ",times:"×",plusmn:"±",deg:"°"};var C=/&(#\d+|#x[\da-fA-F]+|[a-z]+);/g;function I(e){return e.replace(C,(function(e,t){var r;if(t.charAt(0)==="#"){r=P(t.charAt(1)==="x"?parseInt(t.substr(2),16):parseInt(t.substr(1),10))}else r=L[t];return r||e}))}r.convertEntities=I;function P(e){if(e>1114111)return;var t=String.fromCodePoint;if(t)return t(e);var r=String.fromCharCode;if(e<=65535)return r(e);return r((e>>10)+55232,e%1024+56320)}function O(e,t){t=t.replace(x," ");var r=false;var i=[];var l;var u=-1;function c(){u++;var t=document.createElementNS(o.svg,"tspan");a.select(t).attr({class:"line",dy:u*s+"em"});e.appendChild(t);l=t;var r=i;i=[{node:t}];if(r.length>1){for(var n=1;n<r.length;n++){f(r[n])}}}function f(e){var t=e.type;var r={};var n;if(t==="a"){n="a";var s=e.target;var u=e.href;var c=e.popup;if(u){r={"xlink:xlink:show":s==="_blank"||s.charAt(0)!=="_"?"new":"replace",target:s,"xlink:xlink:href":u};if(c){r.onclick='window.open(this.href.baseVal,this.target.baseVal,"'+c+'");return false;'}}}else n="tspan";if(e.style)r.style=e.style;var f=document.createElementNS(o.svg,n);if(t==="sup"||t==="sub"){h(l,g);l.appendChild(f);var p=document.createElementNS(o.svg,"tspan");h(p,g);a.select(p).attr("dy",m[t]);r.dy=d[t];l.appendChild(f);l.appendChild(p)}else{l.appendChild(f)}a.select(f).attr(r);l=e.node=f;i.push(e)}function h(e,t){e.appendChild(document.createTextNode(t))}function p(e){if(i.length===1){n.log("Ignoring unexpected end tag </"+e+">.",t);return}var r=i.pop();if(e!==r.type){n.log("Start tag <"+r.type+"> doesnt match end tag <"+e+">. Pretending it did match.",t)}l=i[i.length-1].node}var y=w.test(t);if(y)c();else{l=e;i=[{node:e}]}var L=t.split(b);for(var C=0;C<L.length;C++){var P=L[C];var O=P.match(_);var D=O&&O[2].toLowerCase();var R=v[D];if(D==="br"){c()}else if(R===undefined){h(l,I(P))}else{if(O[1]){p(D)}else{var F=O[4];var B={type:D};var N=S(F,T);if(N){N=N.replace(E,"$1 fill:");if(R)N+=";"+R}else if(R)N=R;if(N)B.style=N;if(D==="a"){r=true;var j=S(F,k);if(j){var U=z(j);if(U){B.href=U;B.target=S(F,M)||"_blank";B.popup=S(F,A)}}}f(B)}}}return r}function z(e){var t=encodeURI(decodeURI(e));var r=document.createElement("a");var a=document.createElement("a");r.href=e;a.href=t;var n=r.protocol;var i=a.protocol;if(y.indexOf(n)!==-1&&y.indexOf(i)!==-1){return t}else{return""}}r.sanitizeHTML=function e(t){t=t.replace(x," ");var r=document.createElement("p");var n=r;var i=[];var o=t.split(b);for(var s=0;s<o.length;s++){var l=o[s];var u=l.match(_);var c=u&&u[2].toLowerCase();if(c in v){if(u[1]){if(i.length){n=i.pop()}}else{var f=u[4];var h=S(f,T);var p=h?{style:h}:{};if(c==="a"){var d=S(f,k);if(d){var m=z(d);if(m){p.href=m;var g=S(f,M);if(g){p.target=g}}}}var y=document.createElement(c);n.appendChild(y);a.select(y).attr(p);n=y;i.push(y)}}else{n.appendChild(document.createTextNode(I(l)))}}var w="innerHTML";return r[w]};r.lineCount=function e(t){return t.selectAll("tspan.line").size()||1};r.positionText=function e(t,r,n){return t.each((function(){var e=a.select(this);function t(t,r){if(r===undefined){r=e.attr(t);if(r===null){e.attr(t,0);r=0}}else e.attr(t,r);return r}var i=t("x",r);var o=t("y",n);if(this.nodeName==="text"){e.selectAll("tspan.line").attr({x:i,y:o})}}))};function D(e,t,r){var a=r.horizontalAlign;var i=r.verticalAlign||"top";var o=e.node().getBoundingClientRect();var s=t.node().getBoundingClientRect();var l;var u;var c;if(i==="bottom"){u=function(){return o.bottom-l.height}}else if(i==="middle"){u=function(){return o.top+(o.height-l.height)/2}}else{u=function(){return o.top}}if(a==="right"){c=function(){return o.right-l.width}}else if(a==="center"){c=function(){return o.left+(o.width-l.width)/2}}else{c=function(){return o.left}}return function(){l=this.node().getBoundingClientRect();var e=c()-s.left;var t=u()-s.top;var a=r.gd||{};if(r.gd){a._fullLayout._calcInverseTransform(a);var i=n.apply3DTransform(a._fullLayout._invTransform)(e,t);e=i[0];t=i[1]}this.style({top:t+"px",left:e+"px","z-index":1e3});return this}}var R="1px ";r.makeTextShadow=function(e){var t=R;var r=R;var a=R;return t+r+a+e+", "+"-"+t+"-"+r+a+e+", "+t+"-"+r+a+e+", "+"-"+t+r+a+e};r.makeEditable=function(e,t){var r=t.gd;var n=t.delegate;var i=a.dispatch("edit","input","cancel");var o=n||e;e.style({"pointer-events":n?"none":"all"});if(e.size()!==1)throw new Error("boo");function s(){u();e.style({opacity:0});var t=o.attr("class");var r;if(t)r="."+t.split(" ")[0]+"-math-group";else r="[class*=-math-group]";if(r){a.select(e.node().parentNode).select(r).style({opacity:0})}}function l(e){var t=e.node();var r=document.createRange();r.selectNodeContents(t);var a=window.getSelection();a.removeAllRanges();a.addRange(r);t.focus()}function u(){var n=a.select(r);var o=n.select(".svg-container");var s=o.append("div");var u=e.node().style;var c=parseFloat(u.fontSize||12);var f=t.text;if(f===undefined)f=e.attr("data-unformatted");s.classed("plugin-editable editable",true).style({position:"absolute","font-family":u.fontFamily||"Arial","font-size":c,color:t.fill||u.fill||"black",opacity:1,"background-color":t.background||"transparent",outline:"#ffffff33 1px solid",margin:[-c/8+1,0,0,-1].join("px ")+"px",padding:"0","box-sizing":"border-box"}).attr({contenteditable:true}).text(f).call(D(e,o,t)).on("blur",(function(){r._editing=false;e.text(this.textContent).style({opacity:1});var t=a.select(this).attr("class");var n;if(t)n="."+t.split(" ")[0]+"-math-group";else n="[class*=-math-group]";if(n){a.select(e.node().parentNode).select(n).style({opacity:0})}var o=this.textContent;a.select(this).transition().duration(0).remove();a.select(document).on("mouseup",null);i.edit.call(e,o)})).on("focus",(function(){var e=this;r._editing=true;a.select(document).on("mouseup",(function(){if(a.event.target===e)return false;if(document.activeElement===s.node())s.node().blur()}))})).on("keyup",(function(){if(a.event.which===27){r._editing=false;e.style({opacity:1});a.select(this).style({opacity:0}).on("blur",(function(){return false})).transition().remove();i.cancel.call(e,this.textContent)}else{i.input.call(e,this.textContent);a.select(this).call(D(e,o,t))}})).on("keydown",(function(){if(a.event.which===13)this.blur()})).call(l)}if(t.immediate)s();else o.on("click",s);return a.rebind(e,i,"on")}},{"../constants/alignment":755,"../constants/xmlns_namespaces":764,"../lib":787,"@plotly/d3":58}],814:[function(e,t,r){"use strict";var a={};r.throttle=function e(t,r,i){var o=a[t];var s=Date.now();if(!o){for(var l in a){if(a[l].ts<s-6e4){delete a[l]}}o=a[t]={ts:0,timer:null}}n(o);function u(){i();o.ts=Date.now();if(o.onDone){o.onDone();o.onDone=null}}if(s>o.ts+r){u();return}o.timer=setTimeout((function(){u();o.timer=null}),r)};r.done=function(e){var t=a[e];if(!t||!t.timer)return Promise.resolve();return new Promise((function(e){var r=t.onDone;t.onDone=function a(){if(r)r();e();t.onDone=null}}))};r.clear=function(e){if(e){n(a[e]);delete a[e]}else{for(var t in a)r.clear(t)}};function n(e){if(e&&e.timer!==null){clearTimeout(e.timer);e.timer=null}}},{}],815:[function(e,t,r){"use strict";var a=e("fast-isnumeric");t.exports=function e(t,r){if(t>0)return Math.log(t)/Math.LN10;var n=Math.log(Math.min(r[0],r[1]))/Math.LN10;if(!a(n))n=Math.log(Math.max(r[0],r[1]))/Math.LN10-6;return n}},{"fast-isnumeric":246}],816:[function(e,t,r){"use strict";var a=t.exports={};var n=e("../plots/geo/constants").locationmodeToLayer;var i=e("topojson-client").feature;a.getTopojsonName=function(e){return[e.scope.replace(/ /g,"-"),"_",e.resolution.toString(),"m"].join("")};a.getTopojsonPath=function(e,t){return e+t+".json"};a.getTopojsonFeatures=function(e,t){var r=n[e.locationmode];var a=t.objects[r];return i(t,a).features}},{"../plots/geo/constants":869,"topojson-client":586}],817:[function(e,t,r){"use strict";t.exports={moduleType:"locale",name:"en-US",dictionary:{"Click to enter Colorscale title":"Click to enter Colorscale title"},format:{date:"%m/%d/%Y"}}},{}],818:[function(e,t,r){"use strict";t.exports={moduleType:"locale",name:"en",dictionary:{"Click to enter Colorscale title":"Click to enter Colourscale title"},format:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],periods:["AM","PM"],dateTime:"%a %b %e %X %Y",date:"%d/%m/%Y",time:"%H:%M:%S",decimal:".",thousands:",",grouping:[3],currency:["$",""],year:"%Y",month:"%b %Y",dayMonth:"%b %-d",dayMonthYear:"%b %-d, %Y"}}},{}],819:[function(e,t,r){"use strict";var a=e("../registry");t.exports=function e(t){var r=a.layoutArrayContainers;var n=a.layoutArrayRegexes;var i=t.split("[")[0];var o;var s;for(var l=0;l<n.length;l++){s=t.match(n[l]);if(s&&s.index===0){o=s[0];break}}if(!o)o=r[r.indexOf(i)];if(!o)return false;var u=t.substr(o.length);if(!u)return{array:o,index:"",property:""};s=u.match(/^\[(0|[1-9][0-9]*)\](\.(.+))?$/);if(!s)return false;return{array:o,index:Number(s[1]),property:s[3]||""}}},{"../registry":915}],820:[function(e,t,r){"use strict";var a=e("../lib");var n=a.extendFlat;var i=a.isPlainObject;var o={valType:"flaglist",extras:["none"],flags:["calc","clearAxisTypes","plot","style","markerSize","colorbars"]};var s={valType:"flaglist",extras:["none"],flags:["calc","plot","legend","ticks","axrange","layoutstyle","modebar","camera","arraydraw","colorbars"]};var l=o.flags.slice().concat(["fullReplot"]);var u=s.flags.slice().concat("layoutReplot");t.exports={traces:o,layout:s,traceFlags:function(){return c(l)},layoutFlags:function(){return c(u)},update:function(e,t){var r=t.editType;if(r&&r!=="none"){var a=r.split("+");for(var n=0;n<a.length;n++){e[a[n]]=true}}},overrideAll:f};function c(e){var t={};for(var r=0;r<e.length;r++)t[e[r]]=false;return t}function f(e,t,r){var a=n({},e);for(var o in a){var s=a[o];if(i(s)){a[o]=h(s,t,r,o)}}if(r==="from-root")a.editType=t;return a}function h(e,t,r,a){if(e.valType){var i=n({},e);i.editType=t;if(Array.isArray(e.items)){i.items=new Array(e.items.length);for(var o=0;o<e.items.length;o++){i.items[o]=h(e.items[o],t,"from-root")}}return i}else{return f(e,t,a.charAt(0)==="_"?"nested":"from-root")}}},{"../lib":787}],821:[function(e,t,r){"use strict";var a=e("fast-isnumeric");var n=e("gl-mat4/fromQuat");var i=e("../registry");var o=e("../lib");var s=e("../plots/plots");var l=e("../plots/cartesian/axis_ids");var u=e("../components/color");var c=l.cleanId;var f=l.getFromTrace;var h=i.traceIs;r.clearPromiseQueue=function(e){if(Array.isArray(e._promises)&&e._promises.length>0){o.log("Clearing previous rejected promises from queue.")}e._promises=[]};r.cleanLayout=function(e){var t,a;if(!e)e={};if(e.xaxis1){if(!e.xaxis)e.xaxis=e.xaxis1;delete e.xaxis1}if(e.yaxis1){if(!e.yaxis)e.yaxis=e.yaxis1;delete e.yaxis1}if(e.scene1){if(!e.scene)e.scene=e.scene1;delete e.scene1}var i=(s.subplotsRegistry.cartesian||{}).attrRegex;var l=(s.subplotsRegistry.polar||{}).attrRegex;var f=(s.subplotsRegistry.ternary||{}).attrRegex;var h=(s.subplotsRegistry.gl3d||{}).attrRegex;var d=Object.keys(e);for(t=0;t<d.length;t++){var m=d[t];if(i&&i.test(m)){var g=e[m];if(g.anchor&&g.anchor!=="free"){g.anchor=c(g.anchor)}if(g.overlaying)g.overlaying=c(g.overlaying);if(!g.type){if(g.isdate)g.type="date";else if(g.islog)g.type="log";else if(g.isdate===false&&g.islog===false)g.type="linear"}if(g.autorange==="withzero"||g.autorange==="tozero"){g.autorange=true;g.rangemode="tozero"}delete g.islog;delete g.isdate;delete g.categories;if(y(g,"domain"))delete g.domain;if(g.autotick!==undefined){if(g.tickmode===undefined){g.tickmode=g.autotick?"auto":"linear"}delete g.autotick}v(g)}else if(l&&l.test(m)){var x=e[m];v(x.radialaxis)}else if(f&&f.test(m)){var b=e[m];v(b.aaxis);v(b.baxis);v(b.caxis)}else if(h&&h.test(m)){var _=e[m];var w=_.cameraposition;if(Array.isArray(w)&&w[0].length===4){var T=w[0];var k=w[1];var M=w[2];var A=n([],T);var S=[];for(a=0;a<3;++a){S[a]=k[a]+M*A[2+4*a]}_.camera={eye:{x:S[0],y:S[1],z:S[2]},center:{x:k[0],y:k[1],z:k[2]},up:{x:0,y:0,z:1}};delete _.cameraposition}v(_.xaxis);v(_.yaxis);v(_.zaxis)}}var E=Array.isArray(e.annotations)?e.annotations.length:0;for(t=0;t<E;t++){var L=e.annotations[t];if(!o.isPlainObject(L))continue;if(L.ref){if(L.ref==="paper"){L.xref="paper";L.yref="paper"}else if(L.ref==="data"){L.xref="x";L.yref="y"}delete L.ref}p(L,"xref");p(L,"yref")}var C=Array.isArray(e.shapes)?e.shapes.length:0;for(t=0;t<C;t++){var I=e.shapes[t];if(!o.isPlainObject(I))continue;p(I,"xref");p(I,"yref")}var P=Array.isArray(e.images)?e.images.length:0;for(t=0;t<P;t++){var O=e.images[t];if(!o.isPlainObject(O))continue;p(O,"xref");p(O,"yref")}var z=e.legend;if(z){if(z.x>3){z.x=1.02;z.xanchor="left"}else if(z.x<-2){z.x=-.02;z.xanchor="right"}if(z.y>3){z.y=1.02;z.yanchor="bottom"}else if(z.y<-2){z.y=-.02;z.yanchor="top"}}v(e);if(e.dragmode==="rotate")e.dragmode="orbit";u.clean(e);if(e.template&&e.template.layout){r.cleanLayout(e.template.layout)}return e};function p(e,t){var r=e[t];var a=t.charAt(0);if(r&&r!=="paper"){e[t]=c(r,a,true)}}function v(e){if(e){if(typeof e.title==="string"||typeof e.title==="number"){e.title={text:e.title}}t("titlefont","font");t("titleposition","position");t("titleside","side");t("titleoffset","offset")}function t(t,r){var a=e[t];var n=e.title&&e.title[r];if(a&&!n){if(!e.title){e.title={}}e.title[r]=e[t];delete e[t]}}}r.cleanData=function(e){for(var t=0;t<e.length;t++){var a=e[t];var n;if(a.type==="histogramy"&&"xbins"in a&&!("ybins"in a)){a.ybins=a.xbins;delete a.xbins}if(a.error_y&&"opacity"in a.error_y){var l=u.defaults;var f=a.error_y.color||(h(a,"bar")?u.defaultLine:l[t%l.length]);a.error_y.color=u.addOpacity(u.rgb(f),u.opacity(f)*a.error_y.opacity);delete a.error_y.opacity}if("bardir"in a){if(a.bardir==="h"&&(h(a,"bar")||a.type.substr(0,9)==="histogram")){a.orientation="h";r.swapXYData(a)}delete a.bardir}if(a.type==="histogramy")r.swapXYData(a);if(a.type==="histogramx"||a.type==="histogramy"){a.type="histogram"}if("scl"in a&&!("colorscale"in a)){a.colorscale=a.scl;delete a.scl}if("reversescl"in a&&!("reversescale"in a)){a.reversescale=a.reversescl;delete a.reversescl}if(a.xaxis)a.xaxis=c(a.xaxis,"x");if(a.yaxis)a.yaxis=c(a.yaxis,"y");if(h(a,"gl3d")&&a.scene){a.scene=s.subplotsRegistry.gl3d.cleanId(a.scene)}if(!h(a,"pie-like")&&!h(a,"bar-like")){if(Array.isArray(a.textposition)){for(n=0;n<a.textposition.length;n++){a.textposition[n]=g(a.textposition[n])}}else if(a.textposition){a.textposition=g(a.textposition)}}var p=i.getModule(a);if(p&&p.colorbar){var x=p.colorbar.container;var b=x?a[x]:a;if(b&&b.colorscale){if(b.colorscale==="YIGnBu")b.colorscale="YlGnBu";if(b.colorscale==="YIOrRd")b.colorscale="YlOrRd"}}if(a.type==="surface"&&o.isPlainObject(a.contours)){var _=["x","y","z"];for(n=0;n<_.length;n++){var w=a.contours[_[n]];if(!o.isPlainObject(w))continue;if(w.highlightColor){w.highlightcolor=w.highlightColor;delete w.highlightColor}if(w.highlightWidth){w.highlightwidth=w.highlightWidth;delete w.highlightWidth}}}if(a.type==="candlestick"||a.type==="ohlc"){var T=(a.increasing||{}).showlegend!==false;var k=(a.decreasing||{}).showlegend!==false;var M=d(a.increasing);var A=d(a.decreasing);if(M!==false&&A!==false){var S=m(M,A,T,k);if(S)a.name=S}else if((M||A)&&!a.name){a.name=M||A}}if(Array.isArray(a.transforms)){var E=a.transforms;for(n=0;n<E.length;n++){var L=E[n];if(!o.isPlainObject(L))continue;switch(L.type){case"filter":if(L.filtersrc){L.target=L.filtersrc;delete L.filtersrc}if(L.calendar){if(!L.valuecalendar){L.valuecalendar=L.calendar}delete L.calendar}break;case"groupby":L.styles=L.styles||L.style;if(L.styles&&!Array.isArray(L.styles)){var C=L.styles;var I=Object.keys(C);L.styles=[];for(var P=0;P<I.length;P++){L.styles.push({target:I[P],value:C[I[P]]})}}break}}}if(y(a,"line"))delete a.line;if("marker"in a){if(y(a.marker,"line"))delete a.marker.line;if(y(a,"marker"))delete a.marker}u.clean(a);if(a.autobinx){delete a.autobinx;delete a.xbins}if(a.autobiny){delete a.autobiny;delete a.ybins}v(a);if(a.colorbar)v(a.colorbar);if(a.marker&&a.marker.colorbar)v(a.marker.colorbar);if(a.line&&a.line.colorbar)v(a.line.colorbar);if(a.aaxis)v(a.aaxis);if(a.baxis)v(a.baxis)}};function d(e){if(!o.isPlainObject(e))return false;var t=e.name;delete e.name;delete e.showlegend;return(typeof t==="string"||typeof t==="number")&&String(t)}function m(e,t,r,a){if(r&&!a)return e;if(a&&!r)return t;if(!e.trim())return t;if(!t.trim())return e;var n=Math.min(e.length,t.length);var i;for(i=0;i<n;i++){if(e.charAt(i)!==t.charAt(i))break}var o=e.substr(0,i);return o.trim()}function g(e){var t="middle";var r="center";if(typeof e==="string"){if(e.indexOf("top")!==-1)t="top";else if(e.indexOf("bottom")!==-1)t="bottom";if(e.indexOf("left")!==-1)r="left";else if(e.indexOf("right")!==-1)r="right"}return t+" "+r}function y(e,t){return t in e&&typeof e[t]==="object"&&Object.keys(e[t]).length===0}r.swapXYData=function(e){var t;o.swapAttrs(e,["?","?0","d?","?bins","nbins?","autobin?","?src","error_?"]);if(Array.isArray(e.z)&&Array.isArray(e.z[0])){if(e.transpose)delete e.transpose;else e.transpose=true}if(e.error_x&&e.error_y){var r=e.error_y;var a="copy_ystyle"in r?r.copy_ystyle:!(r.color||r.thickness||r.width);o.swapAttrs(e,["error_?.copy_ystyle"]);if(a){o.swapAttrs(e,["error_?.color","error_?.thickness","error_?.width"])}}if(typeof e.hoverinfo==="string"){var n=e.hoverinfo.split("+");for(t=0;t<n.length;t++){if(n[t]==="x")n[t]="y";else if(n[t]==="y")n[t]="x"}e.hoverinfo=n.join("+")}};r.coerceTraceIndices=function(e,t){if(a(t)){return[t]}else if(!Array.isArray(t)||!t.length){return e.data.map((function(e,t){return t}))}else if(Array.isArray(t)){var r=[];for(var n=0;n<t.length;n++){if(o.isIndex(t[n],e.data.length)){r.push(t[n])}else{o.warn("trace index (",t[n],") is not a number or is out of bounds")}}return r}return t};r.manageArrayContainers=function(e,t,r){var n=e.obj;var i=e.parts;var s=i.length;var l=i[s-1];var u=a(l);if(u&&t===null){var c=i.slice(0,s-1).join(".");var f=o.nestedProperty(n,c).get();f.splice(l,1)}else if(u&&e.get()===undefined){if(e.get()===undefined)r[e.astr]=null;e.set(t)}else{e.set(t)}};var x=/(\.[^\[\]\.]+|\[[^\[\]\.]+\])$/;function b(e){var t=e.search(x);if(t>0)return e.substr(0,t)}r.hasParent=function(e,t){var r=b(t);while(r){if(r in e)return true;r=b(r)}return false};var _=["x","y","z"];r.clearAxisTypes=function(e,t,r){for(var a=0;a<t.length;a++){var n=e._fullData[a];for(var i=0;i<3;i++){var s=f(e,n,_[i]);if(s&&s.type!=="log"){var l=s._name;var u=s._id.substr(1);if(u.substr(0,5)==="scene"){if(r[u]!==undefined)continue;l=u+"."+l}var c=l+".type";if(r[l]===undefined&&r[c]===undefined){o.nestedProperty(e.layout,c).set(null)}}}}}},{"../components/color":650,"../lib":787,"../plots/cartesian/axis_ids":842,"../plots/plots":901,"../registry":915,"fast-isnumeric":246,"gl-mat4/fromQuat":282}],822:[function(e,t,r){"use strict";var a=e("./plot_api");r._doPlot=a._doPlot;r.newPlot=a.newPlot;r.restyle=a.restyle;r.relayout=a.relayout;r.redraw=a.redraw;r.update=a.update;r._guiRestyle=a._guiRestyle;r._guiRelayout=a._guiRelayout;r._guiUpdate=a._guiUpdate;r._storeDirectGUIEdit=a._storeDirectGUIEdit;r.react=a.react;r.extendTraces=a.extendTraces;r.prependTraces=a.prependTraces;r.addTraces=a.addTraces;r.deleteTraces=a.deleteTraces;r.moveTraces=a.moveTraces;r.purge=a.purge;r.addFrames=a.addFrames;r.deleteFrames=a.deleteFrames;r.animate=a.animate;r.setPlotConfig=a.setPlotConfig;r.toImage=e("./to_image");r.validate=e("./validate");r.downloadImage=e("../snapshot/download");var n=e("./template_api");r.makeTemplate=n.makeTemplate;r.validateTemplate=n.validateTemplate},{"../snapshot/download":917,"./plot_api":824,"./template_api":829,"./to_image":830,"./validate":831}],823:[function(e,t,r){"use strict";var a=e("../lib/is_plain_object");var n=e("../lib/noop");var i=e("../lib/loggers");var o=e("../lib/search").sorterAsc;var s=e("../registry");r.containerArrayMatch=e("./container_array_match");var l=r.isAddVal=function e(t){return t==="add"||a(t)};var u=r.isRemoveVal=function e(t){return t===null||t==="remove"};r.applyContainerArrayChanges=function e(t,r,a,c,f){var h=r.astr;var p=s.getComponentMethod(h,"supplyLayoutDefaults");var v=s.getComponentMethod(h,"draw");var d=s.getComponentMethod(h,"drawOne");var m=c.replot||c.recalc||p===n||v===n;var g=t.layout;var y=t._fullLayout;if(a[""]){if(Object.keys(a).length>1){i.warn("Full array edits are incompatible with other edits",h)}var x=a[""][""];if(u(x))r.set(null);else if(Array.isArray(x))r.set(x);else{i.warn("Unrecognized full array edit value",h,x);return true}if(m)return false;p(g,y);v(t);return true}var b=Object.keys(a).map(Number).sort(o);var _=r.get();var w=_||[];var T=f(y,h).get();var k=[];var M=-1;var A=w.length;var S;var E;var L;var C;var I;var P;var O,z;for(S=0;S<b.length;S++){L=b[S];C=a[L];I=Object.keys(C);P=C[""],O=l(P);if(L<0||L>w.length-(O?0:1)){i.warn("index out of range",h,L);continue}if(P!==undefined){if(I.length>1){i.warn("Insertion & removal are incompatible with edits to the same index.",h,L)}if(u(P)){k.push(L)}else if(O){if(P==="add")P={};w.splice(L,0,P);if(T)T.splice(L,0,{})}else{i.warn("Unrecognized full object edit value",h,L,P)}if(M===-1)M=L}else{for(E=0;E<I.length;E++){z=h+"["+L+"].";f(w[L],I[E],z).set(C[I[E]])}}}for(S=k.length-1;S>=0;S--){w.splice(k[S],1);if(T)T.splice(k[S],1)}if(!w.length)r.set(null);else if(!_)r.set(w);if(m)return false;p(g,y);if(d!==n){var D;if(M===-1){D=b}else{A=Math.max(w.length,A);D=[];for(S=0;S<b.length;S++){L=b[S];if(L>=M)break;D.push(L)}for(S=M;S<A;S++){D.push(S)}}for(S=0;S<D.length;S++){d(t,D[S])}}else v(t);return true}},{"../lib/is_plain_object":788,"../lib/loggers":791,"../lib/noop":796,"../lib/search":807,"../registry":915,"./container_array_match":819}],824:[function(e,t,r){"use strict";var a=e("@plotly/d3");var n=e("fast-isnumeric");var i=e("has-hover");var o=e("../lib");var s=o.nestedProperty;var l=e("../lib/events");var u=e("../lib/queue");var c=e("../registry");var f=e("./plot_schema");var h=e("../plots/plots");var p=e("../plots/cartesian/axes");var v=e("../components/drawing");var d=e("../components/color");var m=e("../plots/cartesian/graph_interact").initInteractions;var g=e("../constants/xmlns_namespaces");var y=e("../plots/cartesian/select").clearSelect;var x=e("./plot_config").dfltConfig;var b=e("./manage_arrays");var _=e("./helpers");var w=e("./subroutines");var T=e("./edit_types");var k=e("../plots/cartesian/constants").AX_NAME_PATTERN;var M=0;var A=5;function S(e,t,n,i){var s;e=o.getGraphDiv(e);l.init(e);if(o.isPlainObject(t)){var u=t;t=u.data;n=u.layout;i=u.config;s=u.frames}var f=l.triggerHandler(e,"plotly_beforeplot",[t,n,i]);if(f===false)return Promise.reject();if(!t&&!n&&!o.isPlotDiv(e)){o.warn("Calling _doPlot as if redrawing "+"but this container doesn't yet have a plot.",e)}function d(){if(s){return r.addFrames(e,s)}}P(e,i);if(!n)n={};a.select(e).classed("js-plotly-plot",true);v.makeTester();if(!Array.isArray(e._promises))e._promises=[];var g=(e.data||[]).length===0&&Array.isArray(t);if(Array.isArray(t)){_.cleanData(t);if(g)e.data=t;else e.data.push.apply(e.data,t);e.empty=false}if(!e.layout||g){e.layout=_.cleanLayout(n)}h.supplyDefaults(e);var y=e._fullLayout;var x=y._has("cartesian");y._replotting=true;if(g||y._shouldCreateBgLayer){Le(e);if(y._shouldCreateBgLayer){delete y._shouldCreateBgLayer}}v.initGradients(e);v.initPatterns(e);if(g)p.saveShowSpikeInitial(e);var b=!e.calcdata||e.calcdata.length!==(e._fullData||[]).length;if(b)h.doCalcdata(e);for(var T=0;T<e.calcdata.length;T++){e.calcdata[T][0].trace=e._fullData[T]}if(e._context.responsive){if(!e._responsiveChartHandler){e._responsiveChartHandler=function(){if(!o.isHidden(e))h.resize(e)};window.addEventListener("resize",e._responsiveChartHandler)}}else{o.clearResponsive(e)}var k=o.extendFlat({},y._size);var M=0;function A(){var t=y._basePlotModules;for(var r=0;r<t.length;r++){if(t[r].drawFramework){t[r].drawFramework(e)}}if(!y._glcanvas&&y._has("gl")){y._glcanvas=y._glcontainer.selectAll(".gl-canvas").data([{key:"contextLayer",context:true,pick:false},{key:"focusLayer",context:false,pick:false},{key:"pickLayer",context:false,pick:true}],(function(e){return e.key}));y._glcanvas.enter().append("canvas").attr("class",(function(e){return"gl-canvas gl-canvas-"+e.key.replace("Layer","")})).style({position:"absolute",top:0,left:0,overflow:"visible","pointer-events":"none"})}var a=e._context.plotGlPixelRatio;if(y._glcanvas){y._glcanvas.attr("width",y.width*a).attr("height",y.height*a).style("width",y.width+"px").style("height",y.height+"px");var n=y._glcanvas.data()[0].regl;if(n){if(Math.floor(y.width*a)!==n._gl.drawingBufferWidth||Math.floor(y.height*a)!==n._gl.drawingBufferHeight){var i="WebGL context buffer and canvas dimensions do not match due to browser/WebGL bug.";if(M){o.error(i)}else{o.log(i+" Clearing graph and plotting again.");h.cleanPlot([],{},e._fullData,y);h.supplyDefaults(e);y=e._fullLayout;h.doCalcdata(e);M++;return A()}}}}if(y.modebar.orientation==="h"){y._modebardiv.style("height",null).style("width","100%")}else{y._modebardiv.style("width",null).style("height",y.height+"px")}return h.previousPromises(e)}function S(){h.clearAutoMarginIds(e);w.drawMarginPushers(e);p.allowAutoMargin(e);if(y._has("pie")){var t=e._fullData;for(var r=0;r<t.length;r++){var a=t[r];if(a.type==="pie"&&a.automargin){h.allowAutoMargin(e,"pie."+a.uid+".automargin")}}}h.doAutoMargin(e);return h.previousPromises(e)}function L(){if(!h.didMarginChange(k,y._size))return;return o.syncOrAsync([S,w.layoutStyles],e)}function C(){if(!b){I();return}return o.syncOrAsync([c.getComponentMethod("shapes","calcAutorange"),c.getComponentMethod("annotations","calcAutorange"),I],e)}function I(){if(e._transitioning)return;w.doAutoRangeAndConstraints(e);if(g)p.saveRangeInitial(e);c.getComponentMethod("rangeslider","calcAutorange")(e)}function O(){return p.draw(e,g?"":"redraw")}var z=[h.previousPromises,d,A,S,L];if(x)z.push(C);z.push(w.layoutStyles);if(x){z.push(O,(function e(t){if(t._fullLayout._insideTickLabelsAutorange){te(t,t._fullLayout._insideTickLabelsAutorange).then((function(){t._fullLayout._insideTickLabelsAutorange=undefined}))}}))}z.push(w.drawData,w.finalDraw,m,h.addLinks,h.rehover,h.redrag,h.doAutoMargin,D,h.previousPromises);function D(e){if(e._fullLayout._insideTickLabelsAutorange){if(g)p.saveRangeInitial(e,true)}}var R=o.syncOrAsync(z,e);if(!R||!R.then)R=Promise.resolve();return R.then((function(){E(e);return e}))}function E(e){var t=e._fullLayout;if(t._redrawFromAutoMarginCount){t._redrawFromAutoMarginCount--}else{e.emit("plotly_afterplot")}}function L(e){return o.extendFlat(x,e)}function C(e,t){try{e._fullLayout._paper.style("background",t)}catch(r){o.error(r)}}function I(e,t){var r=d.combine(t,"white");C(e,r)}function P(e,t){if(!e._context){e._context=o.extendDeep({},x);var r=a.select("base");e._context._baseUrl=r.size()&&r.attr("href")?window.location.href.split("#")[0]:""}var n=e._context;var s,l,u;if(t){l=Object.keys(t);for(s=0;s<l.length;s++){u=l[s];if(u==="editable"||u==="edits")continue;if(u in n){if(u==="setBackground"&&t[u]==="opaque"){n[u]=I}else{n[u]=t[u]}}}if(t.plot3dPixelRatio&&!n.plotGlPixelRatio){n.plotGlPixelRatio=n.plot3dPixelRatio}var c=t.editable;if(c!==undefined){n.editable=c;l=Object.keys(n.edits);for(s=0;s<l.length;s++){n.edits[l[s]]=c}}if(t.edits){l=Object.keys(t.edits);for(s=0;s<l.length;s++){u=l[s];if(u in n.edits){n.edits[u]=t.edits[u]}}}n._exportedPlot=t._exportedPlot}if(n.staticPlot){n.editable=false;n.edits={};n.autosizable=false;n.scrollZoom=false;n.doubleClick=false;n.showTips=false;n.showLink=false;n.displayModeBar=false}if(n.displayModeBar==="hover"&&!i){n.displayModeBar=true}if(n.setBackground==="transparent"||typeof n.setBackground!=="function"){n.setBackground=C}n._hasZeroHeight=n._hasZeroHeight||e.clientHeight===0;n._hasZeroWidth=n._hasZeroWidth||e.clientWidth===0;var f=n.scrollZoom;var h=n._scrollZoom={};if(f===true){h.cartesian=1;h.gl3d=1;h.geo=1;h.mapbox=1}else if(typeof f==="string"){var p=f.split("+");for(s=0;s<p.length;s++){h[p[s]]=1}}else if(f!==false){h.gl3d=1;h.geo=1;h.mapbox=1}}function O(e){e=o.getGraphDiv(e);if(!o.isPlotDiv(e)){throw new Error("This element is not a Plotly plot: "+e)}_.cleanData(e.data);_.cleanLayout(e.layout);e.calcdata=undefined;return r._doPlot(e).then((function(){e.emit("plotly_redraw");return e}))}function z(e,t,a,n){e=o.getGraphDiv(e);h.cleanPlot([],{},e._fullData||[],e._fullLayout||{});h.purge(e);return r._doPlot(e,t,a,n)}function D(e,t){var r=t+1;var a=[];var n;var i;for(n=0;n<e.length;n++){i=e[n];if(i<0){a.push(r+i)}else{a.push(i)}}return a}function R(e,t,r){var a,n;for(a=0;a<t.length;a++){n=t[a];if(n!==parseInt(n,10)){throw new Error("all values in "+r+" must be integers")}if(n>=e.data.length||n<-e.data.length){throw new Error(r+" must be valid indices for gd.data.")}if(t.indexOf(n,a+1)>-1||n>=0&&t.indexOf(-e.data.length+n)>-1||n<0&&t.indexOf(e.data.length+n)>-1){throw new Error("each index in "+r+" must be unique.")}}}function F(e,t,r){if(!Array.isArray(e.data)){throw new Error("gd.data must be an array.")}if(typeof t==="undefined"){throw new Error("currentIndices is a required argument.")}else if(!Array.isArray(t)){t=[t]}R(e,t,"currentIndices");if(typeof r!=="undefined"&&!Array.isArray(r)){r=[r]}if(typeof r!=="undefined"){R(e,r,"newIndices")}if(typeof r!=="undefined"&&t.length!==r.length){throw new Error("current and new indices must be of equal length.")}}function B(e,t,r){var a,n;if(!Array.isArray(e.data)){throw new Error("gd.data must be an array.")}if(typeof t==="undefined"){throw new Error("traces must be defined.")}if(!Array.isArray(t)){t=[t]}for(a=0;a<t.length;a++){n=t[a];if(typeof n!=="object"||(Array.isArray(n)||n===null)){throw new Error("all values in traces array must be non-array objects")}}if(typeof r!=="undefined"&&!Array.isArray(r)){r=[r]}if(typeof r!=="undefined"&&r.length!==t.length){throw new Error("if indices is specified, traces.length must equal indices.length")}}function N(e,t,r,a){var n=o.isPlainObject(a);if(!Array.isArray(e.data)){throw new Error("gd.data must be an array")}if(!o.isPlainObject(t)){throw new Error("update must be a key:value object")}if(typeof r==="undefined"){throw new Error("indices must be an integer or array of integers")}R(e,r,"indices");for(var i in t){if(!Array.isArray(t[i])||t[i].length!==r.length){throw new Error("attribute "+i+" must be an array of length equal to indices array length")}if(n&&(!(i in a)||!Array.isArray(a[i])||a[i].length!==t[i].length)){throw new Error("when maxPoints is set as a key:value object it must contain a 1:1 "+"corrispondence with the keys and number of traces in the update object")}}}function j(e,t,r,a){var i=o.isPlainObject(a);var l=[];var u,c,f,h,p;if(!Array.isArray(r))r=[r];r=D(r,e.data.length-1);for(var v in t){for(var d=0;d<r.length;d++){u=e.data[r[d]];f=s(u,v);c=f.get();h=t[v][d];if(!o.isArrayOrTypedArray(h)){throw new Error("attribute: "+v+" index: "+d+" must be an array")}if(!o.isArrayOrTypedArray(c)){throw new Error("cannot extend missing or non-array attribute: "+v)}if(c.constructor!==h.constructor){throw new Error("cannot extend array with an array of a different type: "+v)}p=i?a[v][d]:a;if(!n(p))p=-1;l.push({prop:f,target:c,insert:h,maxp:Math.floor(p)})}}return l}function U(e,t,r,a,n){N(e,t,r,a);var i=j(e,t,r,a);var o={};var s={};for(var l=0;l<i.length;l++){var u=i[l].prop;var c=i[l].maxp;var f=n(i[l].target,i[l].insert,c);u.set(f[0]);if(!Array.isArray(o[u.astr]))o[u.astr]=[];o[u.astr].push(f[1]);if(!Array.isArray(s[u.astr]))s[u.astr]=[];s[u.astr].push(i[l].target.length)}return{update:o,maxPoints:s}}function V(e,t){var r=new e.constructor(e.length+t.length);r.set(e);r.set(t,e.length);return r}function H(e,t,a,n){e=o.getGraphDiv(e);function i(e,t,r){var a,n;if(o.isTypedArray(e)){if(r<0){var i=new e.constructor(0);var s=V(e,t);if(r<0){a=s;n=i}else{a=i;n=s}}else{a=new e.constructor(r);n=new e.constructor(e.length+t.length-r);if(r===t.length){a.set(t);n.set(e)}else if(r<t.length){var l=t.length-r;a.set(t.subarray(l));n.set(e);n.set(t.subarray(0,l),e.length)}else{var u=r-t.length;var c=e.length-u;a.set(e.subarray(c));a.set(t,u);n.set(e.subarray(0,c))}}}else{a=e.concat(t);n=r>=0&&r<a.length?a.splice(0,a.length-r):[]}return[a,n]}var s=U(e,t,a,n,i);var l=r.redraw(e);var c=[e,s.update,a,s.maxPoints];u.add(e,r.prependTraces,c,H,arguments);return l}function q(e,t,a,n){e=o.getGraphDiv(e);function i(e,t,r){var a,n;if(o.isTypedArray(e)){if(r<=0){var i=new e.constructor(0);var s=V(t,e);if(r<0){a=s;n=i}else{a=i;n=s}}else{a=new e.constructor(r);n=new e.constructor(e.length+t.length-r);if(r===t.length){a.set(t);n.set(e)}else if(r<t.length){var l=t.length-r;a.set(t.subarray(0,l));n.set(t.subarray(l));n.set(e,l)}else{var u=r-t.length;a.set(t);a.set(e.subarray(0,u),t.length);n.set(e.subarray(u))}}}else{a=t.concat(e);n=r>=0&&r<a.length?a.splice(r,a.length):[]}return[a,n]}var s=U(e,t,a,n,i);var l=r.redraw(e);var c=[e,s.update,a,s.maxPoints];u.add(e,r.extendTraces,c,q,arguments);return l}function G(e,t,a){e=o.getGraphDiv(e);var n=[];var i=r.deleteTraces;var s=G;var l=[e,n];var c=[e,t];var f;var h;B(e,t,a);if(!Array.isArray(t)){t=[t]}t=t.map((function(e){return o.extendFlat({},e)}));_.cleanData(t);for(f=0;f<t.length;f++){e.data.push(t[f])}for(f=0;f<t.length;f++){n.push(-t.length+f)}if(typeof a==="undefined"){h=r.redraw(e);u.add(e,i,l,s,c);return h}if(!Array.isArray(a)){a=[a]}try{F(e,n,a)}catch(p){e.data.splice(e.data.length-t.length,t.length);throw p}u.startSequence(e);u.add(e,i,l,s,c);h=r.moveTraces(e,n,a);u.stopSequence(e);return h}function Y(e,t){e=o.getGraphDiv(e);var a=[];var n=r.addTraces;var i=Y;var s=[e,a,t];var l=[e,t];var c;var f;if(typeof t==="undefined"){throw new Error("indices must be an integer or array of integers.")}else if(!Array.isArray(t)){t=[t]}R(e,t,"indices");t=D(t,e.data.length-1);t.sort(o.sorterDes);for(c=0;c<t.length;c+=1){f=e.data.splice(t[c],1)[0];a.push(f)}var h=r.redraw(e);u.add(e,n,s,i,l);return h}function W(e,t,a){e=o.getGraphDiv(e);var n=[];var i=[];var s=W;var l=W;var c=[e,a,t];var f=[e,t,a];var h;F(e,t,a);t=Array.isArray(t)?t:[t];if(typeof a==="undefined"){a=[];for(h=0;h<t.length;h++){a.push(-t.length+h)}}a=Array.isArray(a)?a:[a];t=D(t,e.data.length-1);a=D(a,e.data.length-1);for(h=0;h<e.data.length;h++){if(t.indexOf(h)===-1){n.push(e.data[h])}}for(h=0;h<t.length;h++){i.push({newIndex:a[h],trace:e.data[t[h]]})}i.sort((function(e,t){return e.newIndex-t.newIndex}));for(h=0;h<i.length;h+=1){n.splice(i[h].newIndex,0,i[h].trace)}e.data=n;var p=r.redraw(e);u.add(e,s,c,l,f);return p}function X(e,t,a,n){e=o.getGraphDiv(e);_.clearPromiseQueue(e);var i={};if(typeof t==="string")i[t]=a;else if(o.isPlainObject(t)){i=o.extendFlat({},t);if(n===undefined)n=a}else{o.warn("Restyle fail.",t,a,n);return Promise.reject()}if(Object.keys(i).length)e.changed=true;var s=_.coerceTraceIndices(e,n);var l=$(e,i,s);var c=l.flags;if(c.calc)e.calcdata=undefined;if(c.clearAxisTypes)_.clearAxisTypes(e,s,{});var f=[];if(c.fullReplot){f.push(r._doPlot)}else{f.push(h.previousPromises);h.supplyDefaults(e);if(c.markerSize){h.doCalcdata(e);ae(f)}if(c.style)f.push(w.doTraceStyle);if(c.colorbars)f.push(w.doColorBars);f.push(E)}f.push(h.rehover,h.redrag);u.add(e,X,[e,l.undoit,l.traces],X,[e,l.redoit,l.traces]);var p=o.syncOrAsync(f,e);if(!p||!p.then)p=Promise.resolve();return p.then((function(){e.emit("plotly_restyle",l.eventData);return e}))}function Z(e){if(e===undefined)return null;return e}function J(e,t){if(!t)return s;return function(t,r,a){var n=s(t,r);var i=n.set;n.set=function(t){var o=(a||"")+r;K(o,n.get(),t,e);i(t)};return n}}function K(e,t,r,a){if(Array.isArray(t)||Array.isArray(r)){var n=Array.isArray(t)?t:[];var i=Array.isArray(r)?r:[];var s=Math.max(n.length,i.length);for(var l=0;l<s;l++){K(e+"["+l+"]",n[l],i[l],a)}}else if(o.isPlainObject(t)||o.isPlainObject(r)){var u=o.isPlainObject(t)?t:{};var c=o.isPlainObject(r)?r:{};var f=o.extendFlat({},u,c);for(var h in f){K(e+"."+h,u[h],c[h],a)}}else if(a[e]===undefined){a[e]=Z(t)}}function Q(e,t,r){for(var a in r){var n=s(e,a);K(a,n.get(),r[a],t)}}function $(e,t,r){var a=e._fullLayout;var n=e._fullData;var i=e.data;var l=a._guiEditing;var u=J(a._preGUI,l);var v=o.extendDeepAll({},t);var d;ee(t);var m=T.traceFlags();var g={};var y={};var x;function b(){return r.map((function(){return undefined}))}function w(e){var t=p.id2name(e);if(x.indexOf(t)===-1)x.push(t)}function k(e){return"LAYOUT"+e+".autorange"}function M(e){return"LAYOUT"+e+".range"}function A(e){for(var t=e;t<n.length;t++){if(n[t]._input===i[e])return n[t]}}function S(n,o,s){if(Array.isArray(n)){n.forEach((function(e){S(e,o,s)}));return}if(n in t||_.hasParent(t,n))return;var c;if(n.substr(0,6)==="LAYOUT"){c=u(e.layout,n.replace("LAYOUT",""))}else{var f=r[s];var h=a._tracePreGUI[A(f)._fullInput.uid];c=J(h,l)(i[f],n)}if(!(n in y)){y[n]=b()}if(y[n][s]===undefined){y[n][s]=Z(c.get())}if(o!==undefined){c.set(o)}}function E(e){return function(t){return n[t][e]}}function L(e){return function(t,a){return t===false?n[r[a]][e]:null}}for(var C in t){if(_.hasParent(t,C)){throw new Error("cannot set "+C+" and a parent attribute simultaneously")}var I=t[C];var P;var O;var z;var D;var R;var F;if(C==="autobinx"||C==="autobiny"){C=C.charAt(C.length-1)+"bins";if(Array.isArray(I))I=I.map(L(C));else if(I===false)I=r.map(E(C));else I=null}g[C]=I;if(C.substr(0,6)==="LAYOUT"){z=u(e.layout,C.replace("LAYOUT",""));y[C]=[Z(z.get())];z.set(Array.isArray(I)?I[0]:I);m.calc=true;continue}y[C]=b();for(d=0;d<r.length;d++){P=i[r[d]];O=A(r[d]);var B=a._tracePreGUI[O._fullInput.uid];z=J(B,l)(P,C);D=z.get();R=Array.isArray(I)?I[d%I.length]:I;if(R===undefined)continue;var N=z.parts[z.parts.length-1];var j=C.substr(0,C.length-N.length-1);var U=j?j+".":"";var V=j?s(O,j).get():O;F=f.getTraceValObject(O,z.parts);if(F&&F.impliedEdits&&R!==null){for(var H in F.impliedEdits){S(o.relativeAttr(C,H),F.impliedEdits[H],d)}}else if((N==="thicknessmode"||N==="lenmode")&&D!==R&&(R==="fraction"||R==="pixels")&&V){var q=a._size;var G=V.orient;var Y=G==="top"||G==="bottom";if(N==="thicknessmode"){var W=Y?q.h:q.w;S(U+"thickness",V.thickness*(R==="fraction"?1/W:W),d)}else{var X=Y?q.w:q.h;S(U+"len",V.len*(R==="fraction"?1/X:X),d)}}else if(C==="type"&&(R==="pie"!==(D==="pie")||R==="funnelarea"!==(D==="funnelarea"))){var K="x";var Q="y";if((R==="bar"||D==="bar")&&P.orientation==="h"){K="y";Q="x"}o.swapAttrs(P,["?","?src"],"labels",K);o.swapAttrs(P,["d?","?0"],"label",K);o.swapAttrs(P,["?","?src"],"values",Q);if(D==="pie"||D==="funnelarea"){s(P,"marker.color").set(s(P,"marker.colors").get());a._pielayer.selectAll("g.trace").remove()}else if(c.traceIs(P,"cartesian")){s(P,"marker.colors").set(s(P,"marker.color").get())}}y[C][d]=Z(D);var $=["swapxy","swapxyaxes","orientation","orientationaxes"];if($.indexOf(C)!==-1){if(C==="orientation"){z.set(R);var te=P.x&&!P.y?"h":"v";if((z.get()||te)===O.orientation){continue}}else if(C==="orientationaxes"){P.orientation={v:"h",h:"v"}[O.orientation]}_.swapXYData(P);m.calc=m.clearAxisTypes=true}else if(h.dataArrayContainers.indexOf(z.parts[0])!==-1){_.manageArrayContainers(z,R,y);m.calc=true}else{if(F){if(F.arrayOk&&!c.traceIs(O,"regl")&&(o.isArrayOrTypedArray(R)||o.isArrayOrTypedArray(D))){m.calc=true}else T.update(m,F)}else{m.calc=true}z.set(R)}}if(["swapxyaxes","orientationaxes"].indexOf(C)!==-1){p.swap(e,r)}if(C==="orientationaxes"){var re=s(e.layout,"hovermode");var ae=re.get();if(ae==="x"){re.set("y")}else if(ae==="y"){re.set("x")}else if(ae==="x unified"){re.set("y unified")}else if(ae==="y unified"){re.set("x unified")}}if(["orientation","type"].indexOf(C)!==-1){x=[];for(d=0;d<r.length;d++){var ne=i[r[d]];if(c.traceIs(ne,"cartesian")){w(ne.xaxis||"x");w(ne.yaxis||"y")}}S(x.map(k),true,0);S(x.map(M),[0,1],0)}}if(m.calc||m.plot){m.fullReplot=true}return{flags:m,undoit:y,redoit:g,traces:r,eventData:o.extendDeepNoArrays([],[v,r])}}function ee(e){var t=o.counterRegex("axis",".title",false,false);var r=/colorbar\.title$/;var a=Object.keys(e);var n,i,s;for(n=0;n<a.length;n++){i=a[n];s=e[i];if((i==="title"||t.test(i)||r.test(i))&&(typeof s==="string"||typeof s==="number")){l(i,i.replace("title","title.text"))}else if(i.indexOf("titlefont")>-1){l(i,i.replace("titlefont","title.font"))}else if(i.indexOf("titleposition")>-1){l(i,i.replace("titleposition","title.position"))}else if(i.indexOf("titleside")>-1){l(i,i.replace("titleside","title.side"))}else if(i.indexOf("titleoffset")>-1){l(i,i.replace("titleoffset","title.offset"))}}function l(t,r){e[r]=e[t];delete e[t]}}function te(e,t,r){e=o.getGraphDiv(e);_.clearPromiseQueue(e);var a={};if(typeof t==="string"){a[t]=r}else if(o.isPlainObject(t)){a=o.extendFlat({},t)}else{o.warn("Relayout fail.",t,r);return Promise.reject()}if(Object.keys(a).length)e.changed=true;var n=se(e,a);var i=n.flags;if(i.calc)e.calcdata=undefined;var s=[h.previousPromises];if(i.layoutReplot){s.push(w.layoutReplot)}else if(Object.keys(a).length){re(e,i,n)||h.supplyDefaults(e);if(i.legend)s.push(w.doLegend);if(i.layoutstyle)s.push(w.layoutStyles);if(i.axrange)ae(s,n.rangesAltered);if(i.ticks)s.push(w.doTicksRelayout);if(i.modebar)s.push(w.doModeBar);if(i.camera)s.push(w.doCamera);if(i.colorbars)s.push(w.doColorBars);s.push(E)}s.push(h.rehover,h.redrag);u.add(e,te,[e,n.undoit],te,[e,n.redoit]);var l=o.syncOrAsync(s,e);if(!l||!l.then)l=Promise.resolve(e);return l.then((function(){e.emit("plotly_relayout",n.eventData);return e}))}function re(e,t,r){var a=e._fullLayout;if(!t.axrange)return false;for(var n in t){if(n!=="axrange"&&t[n])return false}for(var i in r.rangesAltered){var o=p.id2name(i);var s=e.layout[o];var l=a[o];l.autorange=s.autorange;if(s.range){l.range=s.range.slice()}l.cleanRange();if(l._matchGroup){for(var u in l._matchGroup){if(u!==i){var c=a[p.id2name(u)];c.autorange=l.autorange;c.range=l.range.slice();c._input.range=l.range.slice()}}}}return true}function ae(e,t){var r=t?function(e){var r=[];var a=true;for(var n in t){var i=p.getFromId(e,n);r.push(n);if((i.ticklabelposition||"").indexOf("inside")!==-1){if(i._anchorAxis){r.push(i._anchorAxis._id)}}if(i._matchGroup){for(var o in i._matchGroup){if(!t[o]){r.push(o)}}}if(i.automargin)a=false}return p.draw(e,r,{skipTitle:a})}:function(e){return p.draw(e,"redraw")};e.push(y,w.doAutoRangeAndConstraints,r,w.drawData,w.finalDraw)}var ne=/^[xyz]axis[0-9]*\.range(\[[0|1]\])?$/;var ie=/^[xyz]axis[0-9]*\.autorange$/;var oe=/^[xyz]axis[0-9]*\.domain(\[[0|1]\])?$/;function se(e,t){var r=e.layout;var a=e._fullLayout;var n=a._guiEditing;var i=J(a._preGUI,n);var l=Object.keys(t);var u=p.list(e);var h=o.extendDeepAll({},t);var v={};var d,m,g;ee(t);l=Object.keys(t);for(m=0;m<l.length;m++){if(l[m].indexOf("allaxes")===0){for(g=0;g<u.length;g++){var y=u[g]._id.substr(1);var x=y.indexOf("scene")!==-1?y+".":"";var w=l[m].replace("allaxes",x+u[g]._name);if(!t[w])t[w]=t[l[m]]}delete t[l[m]]}}var M=T.layoutFlags();var A={};var S={};function E(e,a){if(Array.isArray(e)){e.forEach((function(e){E(e,a)}));return}if(e in t||_.hasParent(t,e))return;var n=i(r,e);if(!(e in S)){S[e]=Z(n.get())}if(a!==undefined)n.set(a)}var L={};var C;function I(e){var t=p.name2id(e.split(".")[0]);L[t]=1;return t}for(var P in t){if(_.hasParent(t,P)){throw new Error("cannot set "+P+" and a parent attribute simultaneously")}var O=i(r,P);var z=t[P];var D=O.parts.length;var R=D-1;while(R>0&&typeof O.parts[R]!=="string")R--;var F=O.parts[R];var B=O.parts[R-1]+"."+F;var N=O.parts.slice(0,R).join(".");var j=s(e.layout,N).get();var U=s(a,N).get();var V=O.get();if(z===undefined)continue;A[P]=z;S[P]=F==="reverse"?z:Z(V);var H=f.getLayoutValObject(a,O.parts);if(H&&H.impliedEdits&&z!==null){for(var q in H.impliedEdits){E(o.relativeAttr(P,q),H.impliedEdits[q])}}if(["width","height"].indexOf(P)!==-1){if(z){E("autosize",null);var G=P==="height"?"width":"height";E(G,a[G])}else{a[P]=e._initialAutoSize[P]}}else if(P==="autosize"){E("width",z?null:a.width);E("height",z?null:a.height)}else if(B.match(ne)){I(B);s(a,N+"._inputRange").set(null)}else if(B.match(ie)){I(B);s(a,N+"._inputRange").set(null);var Y=s(a,N).get();if(Y._inputDomain){Y._input.domain=Y._inputDomain.slice()}}else if(B.match(oe)){s(a,N+"._inputDomain").set(null)}if(F==="type"){C=j;var W=U.type==="linear"&&z==="log";var X=U.type==="log"&&z==="linear";if(W||X){if(!C||!C.range){E(N+".autorange",true)}else if(!U.autorange){var K=C.range[0];var Q=C.range[1];if(W){if(K<=0&&Q<=0){E(N+".autorange",true)}if(K<=0)K=Q/1e6;else if(Q<=0)Q=K/1e6;E(N+".range[0]",Math.log(K)/Math.LN10);E(N+".range[1]",Math.log(Q)/Math.LN10)}else{E(N+".range[0]",Math.pow(10,K));E(N+".range[1]",Math.pow(10,Q))}}else if(W){C.range=C.range[1]>C.range[0]?[1,2]:[2,1]}if(Array.isArray(a._subplots.polar)&&a._subplots.polar.length&&a[O.parts[0]]&&O.parts[1]==="radialaxis"){delete a[O.parts[0]]._subplot.viewInitial["radialaxis.range"]}c.getComponentMethod("annotations","convertCoords")(e,U,z,E);c.getComponentMethod("images","convertCoords")(e,U,z,E)}else{E(N+".autorange",true);E(N+".range",null)}s(a,N+"._inputRange").set(null)}else if(F.match(k)){var $=s(a,P).get();var te=(z||{}).type;if(!te||te==="-")te="linear";c.getComponentMethod("annotations","convertCoords")(e,$,te,E);c.getComponentMethod("images","convertCoords")(e,$,te,E)}var re=b.containerArrayMatch(P);if(re){d=re.array;m=re.index;var ae=re.property;var se=H||{editType:"calc"};if(m!==""&&ae===""){if(b.isAddVal(z)){S[P]=null}else if(b.isRemoveVal(z)){S[P]=(s(r,d).get()||[])[m]}else{o.warn("unrecognized full object value",t)}}T.update(M,se);if(!v[d])v[d]={};var ue=v[d][m];if(!ue)ue=v[d][m]={};ue[ae]=z;delete t[P]}else if(F==="reverse"){if(j.range)j.range.reverse();else{E(N+".autorange",true);j.range=[1,0]}if(U.autorange)M.calc=true;else M.plot=true}else{if(a._has("scatter-like")&&a._has("regl")&&(P==="dragmode"&&(z==="lasso"||z==="select")&&!(V==="lasso"||V==="select"))){M.plot=true}else if(a._has("gl2d")){M.plot=true}else if(H)T.update(M,H);else M.calc=true;O.set(z)}}for(d in v){var ce=b.applyContainerArrayChanges(e,i(r,d),v[d],M,i);if(!ce)M.plot=true}for(var fe in L){C=p.getFromId(e,fe);var he=C&&C._constraintGroup;if(he){M.calc=true;for(var pe in he){if(!L[pe]){p.getFromId(e,pe)._constraintShrinkable=true}}}}if(le(e)||t.height||t.width)M.plot=true;if(M.plot||M.calc){M.layoutReplot=true}return{flags:M,rangesAltered:L,undoit:S,redoit:A,eventData:h}}function le(e){var t=e._fullLayout;var r=t.width;var a=t.height;if(e.layout.autosize)h.plotAutoSize(e,e.layout,t);return t.width!==r||t.height!==a}function ue(e,t,a,n){e=o.getGraphDiv(e);_.clearPromiseQueue(e);if(!o.isPlainObject(t))t={};if(!o.isPlainObject(a))a={};if(Object.keys(t).length)e.changed=true;if(Object.keys(a).length)e.changed=true;var i=_.coerceTraceIndices(e,n);var s=$(e,o.extendFlat({},t),i);var l=s.flags;var c=se(e,o.extendFlat({},a));var f=c.flags;if(l.calc||f.calc)e.calcdata=undefined;if(l.clearAxisTypes)_.clearAxisTypes(e,i,a);var p=[];if(f.layoutReplot){p.push(w.layoutReplot)}else if(l.fullReplot){p.push(r._doPlot)}else{p.push(h.previousPromises);re(e,f,c)||h.supplyDefaults(e);if(l.style)p.push(w.doTraceStyle);if(l.colorbars||f.colorbars)p.push(w.doColorBars);if(f.legend)p.push(w.doLegend);if(f.layoutstyle)p.push(w.layoutStyles);if(f.axrange)ae(p,c.rangesAltered);if(f.ticks)p.push(w.doTicksRelayout);if(f.modebar)p.push(w.doModeBar);if(f.camera)p.push(w.doCamera);p.push(E)}p.push(h.rehover,h.redrag);u.add(e,ue,[e,s.undoit,c.undoit,s.traces],ue,[e,s.redoit,c.redoit,s.traces]);var v=o.syncOrAsync(p,e);if(!v||!v.then)v=Promise.resolve(e);return v.then((function(){e.emit("plotly_update",{data:s.eventData,layout:c.eventData});return e}))}function ce(e){return function t(r){r._fullLayout._guiEditing=true;var a=e.apply(null,arguments);r._fullLayout._guiEditing=false;return a}}var fe=[{pattern:/^hiddenlabels/,attr:"legend.uirevision"},{pattern:/^((x|y)axis\d*)\.((auto)?range|title\.text)/},{pattern:/axis\d*\.showspikes$/,attr:"modebar.uirevision"},{pattern:/(hover|drag)mode$/,attr:"modebar.uirevision"},{pattern:/^(scene\d*)\.camera/},{pattern:/^(geo\d*)\.(projection|center|fitbounds)/},{pattern:/^(ternary\d*\.[abc]axis)\.(min|title\.text)$/},{pattern:/^(polar\d*\.radialaxis)\.((auto)?range|angle|title\.text)/},{pattern:/^(polar\d*\.angularaxis)\.rotation/},{pattern:/^(mapbox\d*)\.(center|zoom|bearing|pitch)/},{pattern:/^legend\.(x|y)$/,attr:"editrevision"},{pattern:/^(shapes|annotations)/,attr:"editrevision"},{pattern:/^title\.text$/,attr:"editrevision"}];var he=[{pattern:/^selectedpoints$/,attr:"selectionrevision"},{pattern:/(^|value\.)visible$/,attr:"legend.uirevision"},{pattern:/^dimensions\[\d+\]\.constraintrange/},{pattern:/^node\.(x|y|groups)/},{pattern:/^level$/},{pattern:/(^|value\.)name$/},{pattern:/colorbar\.title\.text$/},{pattern:/colorbar\.(x|y)$/,attr:"editrevision"}];function pe(e,t){for(var r=0;r<t.length;r++){var a=t[r];var n=e.match(a.pattern);if(n){return{head:n[1],attr:a.attr}}}}function ve(e,t){var r=s(t,e).get();if(r!==undefined)return r;var a=e.split(".");a.pop();while(a.length>1){a.pop();r=s(t,a.join(".")+".uirevision").get();if(r!==undefined)return r}return t.uirevision}function de(e,t){for(var r=0;r<t.length;r++){if(t[r]._fullInput.uid===e)return r}return-1}function me(e,t,r){for(var a=0;a<t.length;a++){if(t[a].uid===e)return a}return!t[r]||t[r].uid?-1:r}function ge(e,t){var r=o.isPlainObject(e);var a=Array.isArray(e);if(r||a){return(r&&o.isPlainObject(t)||a&&Array.isArray(t))&&JSON.stringify(e)===JSON.stringify(t)}return e===t}function ye(e,t,r,a){var n=a._preGUI;var i,l,u,c,f,h,p,v;var d=[];var m={};for(i in n){f=pe(i,fe);if(f){l=f.attr||f.head+".uirevision";u=s(a,l).get();c=u&&ve(l,t);if(c&&c===u){h=n[i];if(h===null)h=undefined;p=s(t,i);v=p.get();if(ge(v,h)){if(v===undefined&&i.substr(i.length-9)==="autorange"){d.push(i.substr(0,i.length-10))}p.set(Z(s(a,i).get()));continue}}}else{o.warn("unrecognized GUI edit: "+i)}delete n[i];if(i.substr(i.length-8,6)==="range["){m[i.substr(0,i.length-9)]=1}}for(var g=0;g<d.length;g++){var y=d[g];if(m[y]){var x=s(t,y).get();if(x)delete x.autorange}}var b=a._tracePreGUI;for(var _ in b){var w=b[_];var T=null;var k;for(i in w){if(!T){var M=de(_,r);if(M<0){delete b[_];break}var A=r[M];k=A._fullInput;var S=me(_,e,k.index);if(S<0){delete b[_];break}T=e[S]}f=pe(i,he);if(f){if(f.attr){u=s(a,f.attr).get();c=u&&ve(f.attr,t)}else{u=k.uirevision;c=T.uirevision;if(c===undefined)c=t.uirevision}if(c&&c===u){h=w[i];if(h===null)h=undefined;p=s(T,i);v=p.get();if(ge(v,h)){p.set(Z(s(k,i).get()));continue}}}else{o.warn("unrecognized GUI edit: "+i+" in trace uid "+_)}delete w[i]}}}function xe(e,t,a,n){var i,s;function l(){return r.addFrames(e,i)}e=o.getGraphDiv(e);_.clearPromiseQueue(e);var u=e._fullData;var f=e._fullLayout;if(!o.isPlotDiv(e)||!u||!f){s=r.newPlot(e,t,a,n)}else{if(o.isPlainObject(t)){var p=t;t=p.data;a=p.layout;n=p.config;i=p.frames}var v=false;if(n){var d=o.extendDeep({},e._context);e._context=undefined;P(e,n);v=Te(d,e._context)}e.data=t||[];_.cleanData(e.data);e.layout=a||{};_.cleanLayout(e.layout);ye(e.data,e.layout,u,f);h.supplyDefaults(e,{skipUpdateCalc:true});var m=e._fullData;var g=e._fullLayout;var y=g.datarevision===undefined;var x=g.transition;var b=_e(e,f,g,y,x);var T=b.newDataRevision;var k=be(e,u,m,y,x,T);if(le(e))b.layoutReplot=true;if(k.calc||b.calc){e.calcdata=undefined;var M=Object.getOwnPropertyNames(g);for(var A=0;A<M.length;A++){var S=M[A];var L=S.substring(0,5);if(L==="xaxis"||L==="yaxis"){var C=g[S]._emptyCategories;if(C)C()}}}else{h.supplyDefaultsUpdateCalc(e.calcdata,m)}var I=[];if(i){e._transitionData={};h.createTransitionData(e);I.push(l)}if(g.transition&&!v&&(k.anim||b.anim)){if(b.ticks)I.push(w.doTicksRelayout);h.doCalcdata(e);w.doAutoRangeAndConstraints(e);I.push((function(){return h.transitionFromReact(e,k,b,f)}))}else if(k.fullReplot||b.layoutReplot||v){e._fullLayout._skipDefaults=true;I.push(r._doPlot)}else{for(var O in b.arrays){var z=b.arrays[O];if(z.length){var D=c.getComponentMethod(O,"drawOne");if(D!==o.noop){for(var R=0;R<z.length;R++){D(e,z[R])}}else{var F=c.getComponentMethod(O,"draw");if(F===o.noop){throw new Error("cannot draw components: "+O)}F(e)}}}I.push(h.previousPromises);if(k.style)I.push(w.doTraceStyle);if(k.colorbars||b.colorbars)I.push(w.doColorBars);if(b.legend)I.push(w.doLegend);if(b.layoutstyle)I.push(w.layoutStyles);if(b.axrange)ae(I);if(b.ticks)I.push(w.doTicksRelayout);if(b.modebar)I.push(w.doModeBar);if(b.camera)I.push(w.doCamera);I.push(E)}I.push(h.rehover,h.redrag);s=o.syncOrAsync(I,e);if(!s||!s.then)s=Promise.resolve(e)}return s.then((function(){e.emit("plotly_react",{data:t,layout:a});return e}))}function be(e,t,r,a,n,i){var o=t.length===r.length;if(!n&&!o){return{fullReplot:true,calc:true}}var s=T.traceFlags();s.arrays={};s.nChanges=0;s.nChangesAnim=0;var l,u;function c(e){var t=f.getTraceValObject(u,e);if(!u._module.animatable&&t.anim){t.anim=false}return t}var p={getValObject:c,flags:s,immutable:a,transition:n,newDataRevision:i,gd:e};var v={};for(l=0;l<t.length;l++){if(r[l]){u=r[l]._fullInput;if(h.hasMakesDataTransform(u))u=r[l];if(v[u.uid])continue;v[u.uid]=1;we(t[l]._fullInput,u,[],p)}}if(s.calc||s.plot){s.fullReplot=true}if(n&&s.nChanges&&s.nChangesAnim){s.anim=s.nChanges===s.nChangesAnim&&o?"all":"some"}return s}function _e(e,t,r,a,n){var i=T.layoutFlags();i.arrays={};i.rangesAltered={};i.nChanges=0;i.nChangesAnim=0;function o(e){return f.getLayoutValObject(r,e)}var s={getValObject:o,flags:i,immutable:a,transition:n,gd:e};we(t,r,[],s);if(i.plot||i.calc){i.layoutReplot=true}if(n&&i.nChanges&&i.nChangesAnim){i.anim=i.nChanges===i.nChangesAnim?"all":"some"}return i}function we(e,t,r,a){var n,i,l;var u=a.getValObject;var c=a.flags;var f=a.immutable;var h=a.inArray;var p=a.arrayIndex;function v(){var e=n.editType;if(h&&e.indexOf("arraydraw")!==-1){o.pushUnique(c.arrays[h],p);return}T.update(c,n);if(e!=="none"){c.nChanges++}if(a.transition&&n.anim){c.nChangesAnim++}if(ne.test(l)||ie.test(l)){c.rangesAltered[r[0]]=1}if(oe.test(l)){s(t,"_inputDomain").set(null)}if(i==="datarevision"){c.newDataRevision=1}}function d(e){return e.valType==="data_array"||e.arrayOk}for(i in e){if(c.calc&&!a.transition)return;var m=e[i];var g=t[i];var y=r.concat(i);l=y.join(".");if(i.charAt(0)==="_"||typeof m==="function"||m===g)continue;if((i==="tick0"||i==="dtick")&&r[0]!=="geo"){var x=t.tickmode;if(x==="auto"||x==="array"||!x)continue}if(i==="range"&&t.autorange)continue;if((i==="zmin"||i==="zmax")&&t.type==="contourcarpet")continue;n=u(y);if(!n)continue;if(n._compareAsJSON&&JSON.stringify(m)===JSON.stringify(g))continue;var b=n.valType;var _;var w=d(n);var k=Array.isArray(m);var M=Array.isArray(g);if(k&&M){var A="_input_"+i;var S=e[A];var E=t[A];if(Array.isArray(S)&&S===E)continue}if(g===undefined){if(w&&k)c.calc=true;else v()}else if(n._isLinkedToArray){var L=[];var C=false;if(!h)c.arrays[i]=L;var I=Math.min(m.length,g.length);var P=Math.max(m.length,g.length);if(I!==P){if(n.editType==="arraydraw"){C=true}else{v();continue}}for(_=0;_<I;_++){we(m[_],g[_],y.concat(_),o.extendFlat({inArray:i,arrayIndex:_},a))}if(C){for(_=I;_<P;_++){L.push(_)}}}else if(!b&&o.isPlainObject(m)){we(m,g,y,a)}else if(w){if(k&&M){if(f){c.calc=true}if(f||a.newDataRevision){v()}}else if(k!==M){c.calc=true}else v()}else if(k&&M){if(m.length!==g.length||String(m)!==String(g)){v()}}else{v()}}for(i in t){if(!(i in e||i.charAt(0)==="_"||typeof t[i]==="function")){n=u(r.concat(i));if(d(n)&&Array.isArray(t[i])){c.calc=true;return}else v()}}}function Te(e,t){var r;for(r in e){if(r.charAt(0)==="_")continue;var a=e[r];var n=t[r];if(a!==n){if(o.isPlainObject(a)&&o.isPlainObject(n)){if(Te(a,n)){return true}}else if(Array.isArray(a)&&Array.isArray(n)){if(a.length!==n.length){return true}for(var i=0;i<a.length;i++){if(a[i]!==n[i]){if(o.isPlainObject(a[i])&&o.isPlainObject(n[i])){if(Te(a[i],n[i])){return true}}else{return true}}}}else{return true}}}}function ke(e,t,r){e=o.getGraphDiv(e);if(!o.isPlotDiv(e)){throw new Error("This element is not a Plotly plot: "+e+". It's likely that you've failed "+"to create a plot before animating it. For more details, see "+"https://plotly.com/javascript/animations/")}var a=e._transitionData;if(!a._frameQueue){a._frameQueue=[]}r=h.supplyAnimationDefaults(r);var n=r.transition;var i=r.frame;if(a._frameWaitingCnt===undefined){a._frameWaitingCnt=0}function s(e){if(Array.isArray(n)){if(e>=n.length){return n[0]}else{return n[e]}}else{return n}}function l(e){if(Array.isArray(i)){if(e>=i.length){return i[0]}else{return i[e]}}else{return i}}function u(e,t){var r=0;return function(){if(e&&++r===t){return e()}}}return new Promise((function(i,c){function f(){if(a._frameQueue.length===0){return}while(a._frameQueue.length){var t=a._frameQueue.pop();if(t.onInterrupt){t.onInterrupt()}}e.emit("plotly_animationinterrupted",[])}function p(t){if(t.length===0)return;for(var n=0;n<t.length;n++){var o;if(t[n].type==="byname"){o=h.computeFrame(e,t[n].name)}else{o=t[n].data}var f=l(n);var p=s(n);p.duration=Math.min(p.duration,f.duration);var v={frame:o,name:t[n].name,frameOpts:f,transitionOpts:p};if(n===t.length-1){v.onComplete=u(i,2);v.onInterrupt=c}a._frameQueue.push(v)}if(r.mode==="immediate"){a._lastFrameAt=-Infinity}if(!a._animationRaf){m()}}function v(){e.emit("plotly_animated");window.cancelAnimationFrame(a._animationRaf);a._animationRaf=null}function d(){if(a._currentFrame&&a._currentFrame.onComplete){a._currentFrame.onComplete()}var t=a._currentFrame=a._frameQueue.shift();if(t){var r=t.name?t.name.toString():null;e._fullLayout._currentFrame=r;a._lastFrameAt=Date.now();a._timeToNext=t.frameOpts.duration;h.transition(e,t.frame.data,t.frame.layout,_.coerceTraceIndices(e,t.frame.traces),t.frameOpts,t.transitionOpts).then((function(){if(t.onComplete){t.onComplete()}}));e.emit("plotly_animatingframe",{name:r,frame:t.frame,animation:{frame:t.frameOpts,transition:t.transitionOpts}})}else{v()}}function m(){e.emit("plotly_animating");a._lastFrameAt=-Infinity;a._timeToNext=0;a._runningTransitions=0;a._currentFrame=null;var t=function(){a._animationRaf=window.requestAnimationFrame(t);if(Date.now()-a._lastFrameAt>a._timeToNext){d()}};t()}var g=0;function y(e){if(Array.isArray(n)){if(g>=n.length){e.transitionOpts=n[g]}else{e.transitionOpts=n[0]}}else{e.transitionOpts=n}g++;return e}var x,b;var w=[];var T=t===undefined||t===null;var k=Array.isArray(t);var M=!T&&!k&&o.isPlainObject(t);if(M){w.push({type:"object",data:y(o.extendFlat({},t))})}else if(T||["string","number"].indexOf(typeof t)!==-1){for(x=0;x<a._frames.length;x++){b=a._frames[x];if(!b)continue;if(T||String(b.group)===String(t)){w.push({type:"byname",name:String(b.name),data:y({name:b.name})})}}}else if(k){for(x=0;x<t.length;x++){var A=t[x];if(["number","string"].indexOf(typeof A)!==-1){A=String(A);w.push({type:"byname",name:A,data:y({name:A})})}else if(o.isPlainObject(A)){w.push({type:"object",data:y(o.extendFlat({},A))})}}}for(x=0;x<w.length;x++){b=w[x];if(b.type==="byname"&&!a._frameHash[b.data.name]){o.warn('animate failure: frame not found: "'+b.data.name+'"');c();return}}if(["next","immediate"].indexOf(r.mode)!==-1){f()}if(r.direction==="reverse"){w.reverse()}var S=e._fullLayout._currentFrame;if(S&&r.fromcurrent){var E=-1;for(x=0;x<w.length;x++){b=w[x];if(b.type==="byname"&&b.name===S){E=x;break}}if(E>0&&E<w.length-1){var L=[];for(x=0;x<w.length;x++){b=w[x];if(w[x].type!=="byname"||x>E){L.push(b)}}w=L}}if(w.length>0){p(w)}else{e.emit("plotly_animated");i()}}))}function Me(e,t,r){e=o.getGraphDiv(e);if(t===null||t===undefined){return Promise.resolve()}if(!o.isPlotDiv(e)){throw new Error("This element is not a Plotly plot: "+e+". It's likely that you've failed "+"to create a plot before adding frames. For more details, see "+"https://plotly.com/javascript/animations/")}var a,n,i,s;var l=e._transitionData._frames;var c=e._transitionData._frameHash;if(!Array.isArray(t)){throw new Error("addFrames failure: frameList must be an Array of frame definitions"+t)}var f=l.length+t.length*2;var p=[];var v={};for(a=t.length-1;a>=0;a--){if(!o.isPlainObject(t[a]))continue;var d=t[a].name;var m=(c[d]||v[d]||{}).name;var g=t[a].name;var y=c[m]||v[m];if(m&&g&&typeof g==="number"&&y&&M<A){M++;o.warn('addFrames: overwriting frame "'+(c[m]||v[m]).name+'" with a frame whose name of type "number" also equates to "'+m+'". This is valid but may potentially lead to unexpected '+"behavior since all plotly.js frame names are stored internally "+"as strings.");if(M===A){o.warn("addFrames: This API call has yielded too many of these warnings. "+"For the rest of this call, further warnings about numeric frame "+"names will be suppressed.")}}v[d]={name:d};p.push({frame:h.supplyFrameDefaults(t[a]),index:r&&r[a]!==undefined&&r[a]!==null?r[a]:f+a})}p.sort((function(e,t){if(e.index>t.index)return-1;if(e.index<t.index)return 1;return 0}));var x=[];var b=[];var _=l.length;for(a=p.length-1;a>=0;a--){n=p[a].frame;if(typeof n.name==="number"){o.warn("Warning: addFrames accepts frames with numeric names, but the numbers are"+"implicitly cast to strings")}if(!n.name){while(c[n.name="frame "+e._transitionData._counter++]);}if(c[n.name]){for(i=0;i<l.length;i++){if((l[i]||{}).name===n.name)break}x.push({type:"replace",index:i,value:n});b.unshift({type:"replace",index:i,value:l[i]})}else{s=Math.max(0,Math.min(p[a].index,_));x.push({type:"insert",index:s,value:n});b.unshift({type:"delete",index:s});_++}}var w=h.modifyFrames;var T=h.modifyFrames;var k=[e,b];var S=[e,x];if(u)u.add(e,w,k,T,S);return h.modifyFrames(e,x)}function Ae(e,t){e=o.getGraphDiv(e);if(!o.isPlotDiv(e)){throw new Error("This element is not a Plotly plot: "+e)}var r,a;var n=e._transitionData._frames;var i=[];var s=[];if(!t){t=[];for(r=0;r<n.length;r++){t.push(r)}}t=t.slice();t.sort();for(r=t.length-1;r>=0;r--){a=t[r];i.push({type:"delete",index:a});s.unshift({type:"insert",index:a,value:n[a]})}var l=h.modifyFrames;var c=h.modifyFrames;var f=[e,s];var p=[e,i];if(u)u.add(e,l,f,c,p);return h.modifyFrames(e,i)}function Se(e){e=o.getGraphDiv(e);var t=e._fullLayout||{};var r=e._fullData||[];h.cleanPlot([],{},r,t);h.purge(e);l.purge(e);if(t._container)t._container.remove();delete e._context;return e}function Ee(e){var t=e._fullLayout;var r=e.getBoundingClientRect();if(o.equalDomRects(r,t._lastBBox))return;var a=t._invTransform=o.inverseTransformMatrix(o.getFullTransformMatrix(e));t._invScaleX=Math.sqrt(a[0][0]*a[0][0]+a[0][1]*a[0][1]+a[0][2]*a[0][2]);t._invScaleY=Math.sqrt(a[1][0]*a[1][0]+a[1][1]*a[1][1]+a[1][2]*a[1][2]);t._lastBBox=r}function Le(e){var t=a.select(e);var r=e._fullLayout;r._calcInverseTransform=Ee;r._calcInverseTransform(e);r._container=t.selectAll(".plot-container").data([0]);r._container.enter().insert("div",":first-child").classed("plot-container",true).classed("plotly",true);r._paperdiv=r._container.selectAll(".svg-container").data([0]);r._paperdiv.enter().append("div").classed("user-select-none",true).classed("svg-container",true).style("position","relative");r._glcontainer=r._paperdiv.selectAll(".gl-container").data([{}]);r._glcontainer.enter().append("div").classed("gl-container",true);r._paperdiv.selectAll(".main-svg").remove();r._paperdiv.select(".modebar-container").remove();r._paper=r._paperdiv.insert("svg",":first-child").classed("main-svg",true);r._toppaper=r._paperdiv.append("svg").classed("main-svg",true);r._modebardiv=r._paperdiv.append("div");delete r._modeBar;r._hoverpaper=r._paperdiv.append("svg").classed("main-svg",true);if(!r._uid){var n={};a.selectAll("defs").each((function(){if(this.id)n[this.id.split("-")[1]]=1}));r._uid=o.randstr(n)}r._paperdiv.selectAll(".main-svg").attr(g.svgAttrs);r._defs=r._paper.append("defs").attr("id","defs-"+r._uid);r._clips=r._defs.append("g").classed("clips",true);r._topdefs=r._toppaper.append("defs").attr("id","topdefs-"+r._uid);r._topclips=r._topdefs.append("g").classed("clips",true);r._bgLayer=r._paper.append("g").classed("bglayer",true);r._draggers=r._paper.append("g").classed("draglayer",true);var i=r._paper.append("g").classed("layer-below",true);r._imageLowerLayer=i.append("g").classed("imagelayer",true);r._shapeLowerLayer=i.append("g").classed("shapelayer",true);r._cartesianlayer=r._paper.append("g").classed("cartesianlayer",true);r._polarlayer=r._paper.append("g").classed("polarlayer",true);r._ternarylayer=r._paper.append("g").classed("ternarylayer",true);r._geolayer=r._paper.append("g").classed("geolayer",true);r._funnelarealayer=r._paper.append("g").classed("funnelarealayer",true);r._pielayer=r._paper.append("g").classed("pielayer",true);r._iciclelayer=r._paper.append("g").classed("iciclelayer",true);r._treemaplayer=r._paper.append("g").classed("treemaplayer",true);r._sunburstlayer=r._paper.append("g").classed("sunburstlayer",true);r._indicatorlayer=r._toppaper.append("g").classed("indicatorlayer",true);r._glimages=r._paper.append("g").classed("glimages",true);var s=r._toppaper.append("g").classed("layer-above",true);r._imageUpperLayer=s.append("g").classed("imagelayer",true);r._shapeUpperLayer=s.append("g").classed("shapelayer",true);r._infolayer=r._toppaper.append("g").classed("infolayer",true);r._menulayer=r._toppaper.append("g").classed("menulayer",true);r._zoomlayer=r._toppaper.append("g").classed("zoomlayer",true);r._hoverlayer=r._hoverpaper.append("g").classed("hoverlayer",true);r._modebardiv.classed("modebar-container",true).style("position","absolute").style("top","0px").style("right","0px");e.emit("plotly_framework")}r.animate=ke;r.addFrames=Me;r.deleteFrames=Ae;r.addTraces=G;r.deleteTraces=Y;r.extendTraces=H;r.moveTraces=W;r.prependTraces=q;r.newPlot=z;r._doPlot=S;r.purge=Se;r.react=xe;r.redraw=O;r.relayout=te;r.restyle=X;r.setPlotConfig=L;r.update=ue;r._guiRelayout=ce(te);r._guiRestyle=ce(X);r._guiUpdate=ce(ue);r._storeDirectGUIEdit=Q},{"../components/color":650,"../components/drawing":672,"../constants/xmlns_namespaces":764,"../lib":787,"../lib/events":776,"../lib/queue":803,"../plots/cartesian/axes":838,"../plots/cartesian/constants":845,"../plots/cartesian/graph_interact":848,"../plots/cartesian/select":858,"../plots/plots":901,"../registry":915,"./edit_types":820,"./helpers":821,"./manage_arrays":823,"./plot_config":825,"./plot_schema":826,"./subroutines":828,"@plotly/d3":58,"fast-isnumeric":246,"has-hover":435}],825:[function(e,t,r){"use strict";var a={staticPlot:{valType:"boolean",dflt:false},plotlyServerURL:{valType:"string",dflt:""},editable:{valType:"boolean",dflt:false},edits:{annotationPosition:{valType:"boolean",dflt:false},annotationTail:{valType:"boolean",dflt:false},annotationText:{valType:"boolean",dflt:false},axisTitleText:{valType:"boolean",dflt:false},colorbarPosition:{valType:"boolean",dflt:false},colorbarTitleText:{valType:"boolean",dflt:false},legendPosition:{valType:"boolean",dflt:false},legendText:{valType:"boolean",dflt:false},shapePosition:{valType:"boolean",dflt:false},titleText:{valType:"boolean",dflt:false}},autosizable:{valType:"boolean",dflt:false},responsive:{valType:"boolean",dflt:false},fillFrame:{valType:"boolean",dflt:false},frameMargins:{valType:"number",dflt:0,min:0,max:.5},scrollZoom:{valType:"flaglist",flags:["cartesian","gl3d","geo","mapbox"],extras:[true,false],dflt:"gl3d+geo+mapbox"},doubleClick:{valType:"enumerated",values:[false,"reset","autosize","reset+autosize"],dflt:"reset+autosize"},doubleClickDelay:{valType:"number",dflt:300,min:0},showAxisDragHandles:{valType:"boolean",dflt:true},showAxisRangeEntryBoxes:{valType:"boolean",dflt:true},showTips:{valType:"boolean",dflt:true},showLink:{valType:"boolean",dflt:false},linkText:{valType:"string",dflt:"Edit chart",noBlank:true},sendData:{valType:"boolean",dflt:true},showSources:{valType:"any",dflt:false},displayModeBar:{valType:"enumerated",values:["hover",true,false],dflt:"hover"},showSendToCloud:{valType:"boolean",dflt:false},showEditInChartStudio:{valType:"boolean",dflt:false},modeBarButtonsToRemove:{valType:"any",dflt:[]},modeBarButtonsToAdd:{valType:"any",dflt:[]},modeBarButtons:{valType:"any",dflt:false},toImageButtonOptions:{valType:"any",dflt:{}},displaylogo:{valType:"boolean",dflt:true},watermark:{valType:"boolean",dflt:false},plotGlPixelRatio:{valType:"number",dflt:2,min:1,max:4},setBackground:{valType:"any",dflt:"transparent"},topojsonURL:{valType:"string",noBlank:true,dflt:"https://cdn.plot.ly/"},mapboxAccessToken:{valType:"string",dflt:null},logging:{valType:"integer",min:0,max:2,dflt:1},notifyOnLogging:{valType:"integer",min:0,max:2,dflt:0},queueLength:{valType:"integer",min:0,dflt:0},globalTransforms:{valType:"any",dflt:[]},locale:{valType:"string",dflt:"en-US"},locales:{valType:"any",dflt:{}}};var n={};function i(e,t){for(var r in e){var a=e[r];if(a.valType){t[r]=a.dflt}else{if(!t[r]){t[r]={}}i(a,t[r])}}}i(a,n);t.exports={configAttributes:a,dfltConfig:n}},{}],826:[function(e,t,r){"use strict";var a=e("../registry");var n=e("../lib");var i=e("../plots/attributes");var o=e("../plots/layout_attributes");var s=e("../plots/frame_attributes");var l=e("../plots/animation_attributes");var u=e("./plot_config").configAttributes;var c=e("./edit_types");var f=n.extendDeepAll;var h=n.isPlainObject;var p=n.isArrayOrTypedArray;var v=n.nestedProperty;var d=n.valObjectMeta;var m="_isSubplotObj";var g="_isLinkedToArray";var y="_arrayAttrRegexps";var x="_deprecated";var b=[m,g,y,x];r.IS_SUBPLOT_OBJ=m;r.IS_LINKED_TO_ARRAY=g;r.DEPRECATED=x;r.UNDERSCORE_ATTRS=b;r.get=function(){var e={};a.allTypes.forEach((function(t){e[t]=k(t)}));var t={};Object.keys(a.transformsRegistry).forEach((function(e){t[e]=A(e)}));return{defs:{valObjects:d,metaKeys:b.concat(["description","role","editType","impliedEdits"]),editType:{traces:c.traces,layout:c.layout},impliedEdits:{}},traces:e,layout:M(),transforms:t,frames:S(),animation:E(l),config:E(u)}};r.crawl=function(e,t,a,n){var i=a||0;n=n||"";Object.keys(e).forEach((function(a){var o=e[a];if(b.indexOf(a)!==-1)return;var s=(n?n+".":"")+a;t(o,a,e,i,s);if(r.isValObject(o))return;if(h(o)&&a!=="impliedEdits"){r.crawl(o,t,i+1,s)}}))};r.isValObject=function(e){return e&&e.valType!==undefined};r.findArrayAttributes=function(e){var t=[];var a=[];var n=[];var o,s;function l(e,t,r,i){a=a.slice(0,i).concat([t]);n=n.slice(0,i).concat([e&&e._isLinkedToArray]);var s=e&&(e.valType==="data_array"||e.arrayOk===true)&&!(a[i-1]==="colorbar"&&(t==="ticktext"||t==="tickvals"));if(!s)return;u(o,0,"")}function u(e,r,i){var o=e[a[r]];var l=i+a[r];if(r===a.length-1){if(p(o)){t.push(s+l)}}else{if(n[r]){if(Array.isArray(o)){for(var c=0;c<o.length;c++){if(h(o[c])){u(o[c],r+1,l+"["+c+"].")}}}}else if(h(o)){u(o,r+1,l+".")}}}o=e;s="";r.crawl(i,l);if(e._module&&e._module.attributes){r.crawl(e._module.attributes,l)}var c=e.transforms;if(c){for(var f=0;f<c.length;f++){var v=c[f];var d=v._module;if(d){s="transforms["+f+"].";o=v;r.crawl(d.attributes,l)}}}return t};r.getTraceValObject=function(e,t){var r=t[0];var n=1;var o,s;if(r==="transforms"){if(t.length===1){return i.transforms}var l=e.transforms;if(!Array.isArray(l)||!l.length)return false;var u=t[1];if(!T(u)||u>=l.length){return false}o=(a.transformsRegistry[l[u].type]||{}).attributes;s=o&&o[t[2]];n=3}else{var c=e._module;if(!c)c=(a.modules[e.type||i.type.dflt]||{})._module;if(!c)return false;o=c.attributes;s=o&&o[r];if(!s){var f=c.basePlotModule;if(f&&f.attributes){s=f.attributes[r]}}if(!s)s=i[r]}return w(s,t,n)};r.getLayoutValObject=function(e,t){var r=_(e,t[0]);return w(r,t,1)};function _(e,t){var r,n,i,s;var l=e._basePlotModules;if(l){var u;for(r=0;r<l.length;r++){i=l[r];if(i.attrRegex&&i.attrRegex.test(t)){if(i.layoutAttrOverrides)return i.layoutAttrOverrides;if(!u&&i.layoutAttributes)u=i.layoutAttributes}var c=i.baseLayoutAttrOverrides;if(c&&t in c)return c[t]}if(u)return u}var f=e._modules;if(f){for(r=0;r<f.length;r++){s=f[r].layoutAttributes;if(s&&t in s){return s[t]}}}for(n in a.componentsRegistry){i=a.componentsRegistry[n];if(i.name==="colorscale"&&t.indexOf("coloraxis")===0){return i.layoutAttributes[t]}else if(!i.schema&&t===i.name){return i.layoutAttributes}}if(t in o)return o[t];return false}function w(e,t,r){if(!e)return false;if(e._isLinkedToArray){if(T(t[r]))r++;else if(r<t.length)return false}for(;r<t.length;r++){var a=e[t[r]];if(h(a))e=a;else break;if(r===t.length-1)break;if(e._isLinkedToArray){r++;if(!T(t[r]))return false}else if(e.valType==="info_array"){r++;var n=t[r];if(!T(n))return false;var i=e.items;if(Array.isArray(i)){if(n>=i.length)return false;if(e.dimensions===2){r++;if(t.length===r)return e;var o=t[r];if(!T(o))return false;e=i[n][o]}else e=i[n]}else{e=i}}}return e}function T(e){return e===Math.round(e)&&e>=0}function k(e){var t,n;t=a.modules[e]._module,n=t.basePlotModule;var o={};o.type=null;var s=f({},i);var l=f({},t.attributes);r.crawl(l,(function(e,t,r,a,n){v(s,n).set(undefined);if(e===undefined)v(l,n).set(undefined)}));f(o,s);if(a.traceIs(e,"noOpacity")){delete o.opacity}if(!a.traceIs(e,"showLegend")){delete o.showlegend;delete o.legendgroup}if(a.traceIs(e,"noHover")){delete o.hoverinfo;delete o.hoverlabel}if(!t.selectPoints){delete o.selectedpoints}f(o,l);if(n.attributes){f(o,n.attributes)}o.type=e;var u={meta:t.meta||{},categories:t.categories||{},animatable:Boolean(t.animatable),type:e,attributes:E(o)};if(t.layoutAttributes){var c={};f(c,t.layoutAttributes);u.layoutAttributes=E(c)}if(!t.animatable){r.crawl(u,(function(e){if(r.isValObject(e)&&"anim"in e){delete e.anim}}))}return u}function M(){var e={};var t,r;f(e,o);for(t in a.subplotsRegistry){r=a.subplotsRegistry[t];if(!r.layoutAttributes)continue;if(Array.isArray(r.attr)){for(var n=0;n<r.attr.length;n++){P(e,r,r.attr[n])}}else{var i=r.attr==="subplot"?r.name:r.attr;P(e,r,i)}}for(t in a.componentsRegistry){r=a.componentsRegistry[t];var s=r.schema;if(s&&(s.subplots||s.layout)){var l=s.subplots;if(l&&l.xaxis&&!l.yaxis){for(var u in l.xaxis){delete e.yaxis[u]}}}else if(r.name==="colorscale"){f(e,r.layoutAttributes)}else if(r.layoutAttributes){O(e,r.layoutAttributes,r.name)}}return{layoutAttributes:E(e)}}function A(e){var t=a.transformsRegistry[e];var r=f({},t.attributes);Object.keys(a.componentsRegistry).forEach((function(t){var n=a.componentsRegistry[t];if(n.schema&&n.schema.transforms&&n.schema.transforms[e]){Object.keys(n.schema.transforms[e]).forEach((function(t){O(r,n.schema.transforms[e][t],t)}))}}));return{attributes:E(r)}}function S(){var e={frames:f({},s)};E(e);return e.frames}function E(e){L(e);C(e);I(e);return e}function L(e){function t(e){return{valType:"string",editType:"none"}}function a(e,a,n){if(r.isValObject(e)){if(e.arrayOk===true||e.valType==="data_array"){n[a+"src"]=t(a)}}else if(h(e)){e.role="object"}}r.crawl(e,a)}function C(e){function t(e,t,r){if(!e)return;var a=e[g];if(!a)return;delete e[g];r[t]={items:{}};r[t].items[a]=e;r[t].role="object"}r.crawl(e,t)}function I(e){function t(e){for(var r in e){if(h(e[r])){t(e[r])}else if(Array.isArray(e[r])){for(var a=0;a<e[r].length;a++){t(e[r][a])}}else{if(e[r]instanceof RegExp){e[r]=e[r].toString()}}}}t(e)}function P(e,t,r){var a=v(e,r);var n=f({},t.layoutAttributes);n[m]=true;a.set(n)}function O(e,t,r){var a=v(e,r);a.set(f(a.get()||{},t))}},{"../lib":787,"../plots/animation_attributes":832,"../plots/attributes":834,"../plots/frame_attributes":868,"../plots/layout_attributes":892,"../registry":915,"./edit_types":820,"./plot_config":825}],827:[function(e,t,r){"use strict";var a=e("../lib");var n=e("../plots/attributes");var i="templateitemname";var o={name:{valType:"string",editType:"none"}};o[i]={valType:"string",editType:"calc"};r.templatedArray=function(e,t){t._isLinkedToArray=e;t.name=o.name;t[i]=o[i];return t};r.traceTemplater=function(e){var t={};var r,i;for(r in e){i=e[r];if(Array.isArray(i)&&i.length){t[r]=0}}function o(o){r=a.coerce(o,{},n,"type");var s={type:r,_template:null};if(r in t){i=e[r];var l=t[r]%i.length;t[r]++;s._template=i[l]}else{}return s}return{newTrace:o}};r.newContainer=function(e,t,r){var n=e._template;var i=n&&(n[t]||r&&n[r]);if(!a.isPlainObject(i))i=null;var o=e[t]={_template:i};return o};r.arrayTemplater=function(e,t,r){var a=e._template;var n=a&&a[l(t)];var o=a&&a[t];if(!Array.isArray(o)||!o.length){o=[]}var u={};function c(e){var t={name:e.name,_input:e};var a=t[i]=e[i];if(!s(a)){t._template=n;return t}for(var l=0;l<o.length;l++){var c=o[l];if(c.name===a){u[a]=1;t._template=c;return t}}t[r]=e[r]||false;t._template=false;return t}function f(){var e=[];for(var t=0;t<o.length;t++){var r=o[t];var a=r.name;if(s(a)&&!u[a]){var n={_template:r,name:a,_input:{_templateitemname:a}};n[i]=r[i];e.push(n);u[a]=1}}return e}return{newItem:c,defaultItems:f}};function s(e){return e&&typeof e==="string"}function l(e){var t=e.length-1;if(e.charAt(t)!=="s"){a.warn("bad argument to arrayDefaultKey: "+e)}return e.substr(0,e.length-1)+"defaults"}r.arrayDefaultKey=l;r.arrayEditor=function(e,t,r){var n=(a.nestedProperty(e,t).get()||[]).length;var o=r._index;var s=o>=n&&(r._input||{})._templateitemname;if(s)o=n;var l=t+"["+o+"]";var u;function c(){u={};if(s){u[l]={};u[l][i]=s}}c();function f(e,t){u[e]=t}function h(e,t){if(s){a.nestedProperty(u[l],e).set(t)}else{u[l+"."+e]=t}}function p(){var e=u;c();return e}function v(t,r){if(t)h(t,r);var n=p();for(var i in n){a.nestedProperty(e,i).set(n[i])}}return{modifyBase:f,modifyItem:h,getUpdateObj:p,applyUpdate:v}}},{"../lib":787,"../plots/attributes":834}],828:[function(e,t,r){"use strict";var a=e("@plotly/d3");var n=e("../registry");var i=e("../plots/plots");var o=e("../lib");var s=e("../lib/clear_gl_canvases");var l=e("../components/color");var u=e("../components/drawing");var c=e("../components/titles");var f=e("../components/modebar");var h=e("../plots/cartesian/axes");var p=e("../constants/alignment");var v=e("../plots/cartesian/constraints");var d=v.enforce;var m=v.clean;var g=e("../plots/cartesian/autorange").doAutoRange;var y="start";var x="middle";var b="end";r.layoutStyles=function(e){return o.syncOrAsync([i.doAutoMargin,w],e)};function _(e,t,r){for(var a=0;a<r.length;a++){var n=r[a][0];var i=r[a][1];if(n[0]>=e[1]||n[1]<=e[0]){continue}if(i[0]<t[1]&&i[1]>t[0]){return true}}return false}function w(e){var t=e._fullLayout;var n=t._size;var s=n.p;var c=h.list(e,"",true);var v,d,m,g,y,x;t._paperdiv.style({width:e._context.responsive&&t.autosize&&!e._context._hasZeroWidth&&!e.layout.width?"100%":t.width+"px",height:e._context.responsive&&t.autosize&&!e._context._hasZeroHeight&&!e.layout.height?"100%":t.height+"px"}).selectAll(".main-svg").call(u.setSize,t.width,t.height);e._context.setBackground(e,t.paper_bgcolor);r.drawMainTitle(e);f.manage(e);if(!t._has("cartesian")){return i.previousPromises(e)}function b(e,t,r){var a=e._lw/2;if(e._id.charAt(0)==="x"){if(!t)return n.t+n.h*(1-(e.position||0))+a%1;else if(r==="top")return t._offset-s-a;return t._offset+t._length+s+a}if(!t)return n.l+n.w*(e.position||0)+a%1;else if(r==="right")return t._offset+t._length+s+a;return t._offset-s-a}for(v=0;v<c.length;v++){g=c[v];var w=g._anchorAxis;g._linepositions={};g._lw=u.crispRound(e,g.linewidth,1);g._mainLinePosition=b(g,w,g.side);g._mainMirrorPosition=g.mirror&&w?b(g,w,p.OPPOSITE_SIDE[g.side]):null}var k=[];var A=[];var S=[];var E=l.opacity(t.paper_bgcolor)===1&&l.opacity(t.plot_bgcolor)===1&&t.paper_bgcolor===t.plot_bgcolor;for(d in t._plots){m=t._plots[d];if(m.mainplot){if(m.bg){m.bg.remove()}m.bg=undefined}else{var L=m.xaxis.domain;var C=m.yaxis.domain;var I=m.plotgroup;if(_(L,C,S)){var P=I.node();var O=m.bg=o.ensureSingle(I,"rect","bg");P.insertBefore(O.node(),P.childNodes[0]);A.push(d)}else{I.select("rect.bg").remove();S.push([L,C]);if(!E){k.push(d);A.push(d)}}}}var z=t._bgLayer.selectAll(".bg").data(k);z.enter().append("rect").classed("bg",true);z.exit().remove();z.each((function(e){t._plots[e].bg=a.select(this)}));for(v=0;v<A.length;v++){m=t._plots[A[v]];y=m.xaxis;x=m.yaxis;if(m.bg&&y._offset!==undefined&&x._offset!==undefined){m.bg.call(u.setRect,y._offset-s,x._offset-s,y._length+2*s,x._length+2*s).call(l.fill,t.plot_bgcolor).style("stroke-width",0)}}if(!t._hasOnlyLargeSploms){for(d in t._plots){m=t._plots[d];y=m.xaxis;x=m.yaxis;var D=m.clipId="clip"+t._uid+d+"plot";var R=o.ensureSingleById(t._clips,"clipPath",D,(function(e){e.classed("plotclip",true).append("rect")}));m.clipRect=R.select("rect").attr({width:y._length,height:x._length});u.setTranslate(m.plot,y._offset,x._offset);var F;var B;if(m._hasClipOnAxisFalse){F=null;B=D}else{F=D;B=null}u.setClipUrl(m.plot,F,e);m.layerClipId=B}}var N,j,U,V,H,q;var G,Y,W,X,Z,J;var K;function Q(e){return"M"+N+","+e+"H"+j}function $(e){return"M"+y._offset+","+e+"h"+y._length}function ee(e){return"M"+e+","+Y+"V"+G}function te(e){return"M"+e+","+x._offset+"v"+x._length}function re(e,t,r){if(!e.showline||d!==e._mainSubplot)return"";if(!e._anchorAxis)return r(e._mainLinePosition);var a=t(e._mainLinePosition);if(e.mirror)a+=t(e._mainMirrorPosition);return a}for(d in t._plots){m=t._plots[d];y=m.xaxis;x=m.yaxis;var ae="M0,0";if(T(y,d)){H=M(y,"left",x,c);N=y._offset-(H?s+H:0);q=M(y,"right",x,c);j=y._offset+y._length+(q?s+q:0);U=b(y,x,"bottom");V=b(y,x,"top");K=!y._anchorAxis||d!==y._mainSubplot;if(K&&(y.mirror==="allticks"||y.mirror==="all")){y._linepositions[d]=[U,V]}ae=re(y,Q,$);if(K&&y.showline&&(y.mirror==="all"||y.mirror==="allticks")){ae+=Q(U)+Q(V)}m.xlines.style("stroke-width",y._lw+"px").call(l.stroke,y.showline?y.linecolor:"rgba(0,0,0,0)")}m.xlines.attr("d",ae);var ne="M0,0";if(T(x,d)){Z=M(x,"bottom",y,c);G=x._offset+x._length+(Z?s:0);J=M(x,"top",y,c);Y=x._offset-(J?s:0);W=b(x,y,"left");X=b(x,y,"right");K=!x._anchorAxis||d!==x._mainSubplot;if(K&&(x.mirror==="allticks"||x.mirror==="all")){x._linepositions[d]=[W,X]}ne=re(x,ee,te);if(K&&x.showline&&(x.mirror==="all"||x.mirror==="allticks")){ne+=ee(W)+ee(X)}m.ylines.style("stroke-width",x._lw+"px").call(l.stroke,x.showline?x.linecolor:"rgba(0,0,0,0)")}m.ylines.attr("d",ne)}h.makeClipPaths(e);return i.previousPromises(e)}function T(e,t){return(e.ticks||e.showline)&&(t===e._mainSubplot||e.mirror==="all"||e.mirror==="allticks")}function k(e,t,r){if(!r.showline||!r._lw)return false;if(r.mirror==="all"||r.mirror==="allticks")return true;var a=r._anchorAxis;if(!a)return false;var n=p.FROM_BL[t];if(r.side===t){return a.domain[n]===e.domain[n]}return r.mirror&&a.domain[1-n]===e.domain[1-n]}function M(e,t,r,a){if(k(e,t,r)){return r._lw}for(var n=0;n<a.length;n++){var i=a[n];if(i._mainAxis===r._mainAxis&&k(e,t,i)){return i._lw}}return 0}r.drawMainTitle=function(e){var t=e._fullLayout;var r=E(t);var a=L(t);c.draw(e,"gtitle",{propContainer:t,propName:"title.text",placeholder:t._dfltTitle.plot,attributes:{x:A(t,r),y:S(t,a),"text-anchor":r,dy:a}})};function A(e,t){var r=e.title;var a=e._size;var n=0;if(t===y){n=r.pad.l}else if(t===b){n=-r.pad.r}switch(r.xref){case"paper":return a.l+a.w*r.x+n;case"container":default:return e.width*r.x+n}}function S(e,t){var r=e.title;var a=e._size;var n=0;if(t==="0em"||!t){n=-r.pad.b}else if(t===p.CAP_SHIFT+"em"){n=r.pad.t}if(r.y==="auto"){return a.t/2}else{switch(r.yref){case"paper":return a.t+a.h-a.h*r.y+n;case"container":default:return e.height-e.height*r.y+n}}}function E(e){var t=e.title;var r=x;if(o.isRightAnchor(t)){r=b}else if(o.isLeftAnchor(t)){r=y}return r}function L(e){var t=e.title;var r="0em";if(o.isTopAnchor(t)){r=p.CAP_SHIFT+"em"}else if(o.isMiddleAnchor(t)){r=p.MID_SHIFT+"em"}return r}r.doTraceStyle=function(e){var t=e.calcdata;var a=[];var o;for(o=0;o<t.length;o++){var l=t[o];var u=l[0]||{};var c=u.trace||{};var f=c._module||{};var h=f.arraysToCalcdata;if(h)h(l,c);var p=f.editStyle;if(p)a.push({fn:p,cd0:u})}if(a.length){for(o=0;o<a.length;o++){var v=a[o];v.fn(e,v.cd0)}s(e);r.redrawReglTraces(e)}i.style(e);n.getComponentMethod("legend","draw")(e);return i.previousPromises(e)};r.doColorBars=function(e){n.getComponentMethod("colorbar","draw")(e);return i.previousPromises(e)};r.layoutReplot=function(e){var t=e.layout;e.layout=undefined;return n.call("_doPlot",e,"",t)};r.doLegend=function(e){n.getComponentMethod("legend","draw")(e);return i.previousPromises(e)};r.doTicksRelayout=function(e){h.draw(e,"redraw");if(e._fullLayout._hasOnlyLargeSploms){n.subplotsRegistry.splom.updateGrid(e);s(e);r.redrawReglTraces(e)}r.drawMainTitle(e);return i.previousPromises(e)};r.doModeBar=function(e){var t=e._fullLayout;f.manage(e);for(var r=0;r<t._basePlotModules.length;r++){var a=t._basePlotModules[r].updateFx;if(a)a(e)}return i.previousPromises(e)};r.doCamera=function(e){var t=e._fullLayout;var r=t._subplots.gl3d;for(var a=0;a<r.length;a++){var n=t[r[a]];var i=n._scene;i.setViewport(n)}};r.drawData=function(e){var t=e._fullLayout;s(e);var a=t._basePlotModules;for(var o=0;o<a.length;o++){a[o].plot(e)}r.redrawReglTraces(e);i.style(e);n.getComponentMethod("shapes","draw")(e);n.getComponentMethod("annotations","draw")(e);n.getComponentMethod("images","draw")(e);t._replotting=false;return i.previousPromises(e)};r.redrawReglTraces=function(e){var t=e._fullLayout;if(t._has("regl")){var r=e._fullData;var a=[];var n=[];var i,s;if(t._hasOnlyLargeSploms){t._splomGrid.draw()}for(i=0;i<r.length;i++){var l=r[i];if(l.visible===true&&l._length!==0){if(l.type==="splom"){t._splomScenes[l.uid].draw()}else if(l.type==="scattergl"){o.pushUnique(a,l.xaxis+l.yaxis)}else if(l.type==="scatterpolargl"){o.pushUnique(n,l.subplot)}}}for(i=0;i<a.length;i++){s=t._plots[a[i]];if(s._scene)s._scene.draw()}for(i=0;i<n.length;i++){s=t[n[i]]._subplot;if(s._scene)s._scene.draw()}}};r.doAutoRangeAndConstraints=function(e){var t=h.list(e,"",true);var r;var a={};for(var n=0;n<t.length;n++){r=t[n];if(!a[r._id]){a[r._id]=1;m(e,r);g(e,r);var i=r._matchGroup;if(i){for(var o in i){var s=h.getFromId(e,o);g(e,s,r.range);a[o]=1}}}}d(e)};r.finalDraw=function(e){n.getComponentMethod("rangeslider","draw")(e);n.getComponentMethod("rangeselector","draw")(e)};r.drawMarginPushers=function(e){n.getComponentMethod("legend","draw")(e);n.getComponentMethod("rangeselector","draw")(e);n.getComponentMethod("sliders","draw")(e);n.getComponentMethod("updatemenus","draw")(e);n.getComponentMethod("colorbar","draw")(e)}},{"../components/color":650,"../components/drawing":672,"../components/modebar":713,"../components/titles":748,"../constants/alignment":755,"../lib":787,"../lib/clear_gl_canvases":771,"../plots/cartesian/autorange":837,"../plots/cartesian/axes":838,"../plots/cartesian/constraints":846,"../plots/plots":901,"../registry":915,"@plotly/d3":58}],829:[function(e,t,r){"use strict";var a=e("../lib");var n=a.isPlainObject;var i=e("./plot_schema");var o=e("../plots/plots");var s=e("../plots/attributes");var l=e("./plot_template");var u=e("./plot_config").dfltConfig;r.makeTemplate=function(e){e=a.isPlainObject(e)?e:a.getGraphDiv(e);e=a.extendDeep({_context:u},{data:e.data,layout:e.layout});o.supplyDefaults(e);var t=e.data||[];var r=e.layout||{};r._basePlotModules=e._fullLayout._basePlotModules;r._modules=e._fullLayout._modules;var i={data:{},layout:{}};t.forEach((function(e){var t={};h(e,t,v.bind(null,e));var r=a.coerce(e,{},s,"type");var n=i.data[r];if(!n)n=i.data[r]=[];n.push(t)}));h(r,i.layout,p.bind(null,r));delete i.layout.template;var l=r.template;if(n(l)){var f=l.layout;var d,m,g,y,x,b;if(n(f)){c(f,i.layout)}var _=l.data;if(n(_)){for(m in i.data){g=_[m];if(Array.isArray(g)){x=i.data[m];b=x.length;y=g.length;for(d=0;d<b;d++){c(g[d%y],x[d])}for(d=b;d<y;d++){x.push(a.extendDeep({},g[d]))}}}for(m in _){if(!(m in i.data)){i.data[m]=a.extendDeep([],_[m])}}}}return i};function c(e,t){e=a.extendDeep({},e);var r=Object.keys(e).sort();var i,o;function s(t,r,a){if(n(r)&&n(t)){c(t,r)}else if(Array.isArray(r)&&Array.isArray(t)){var i=l.arrayTemplater({_template:e},a);for(o=0;o<r.length;o++){var s=r[o];var u=i.newItem(s)._template;if(u)c(u,s)}var f=i.defaultItems();for(o=0;o<f.length;o++)r.push(f[o]._template);for(o=0;o<r.length;o++)delete r[o].templateitemname}}for(i=0;i<r.length;i++){var u=r[i];var h=e[u];if(u in t){s(h,t[u],u)}else t[u]=h;if(f(u)===u){for(var p in t){var v=f(p);if(p!==v&&v===u&&!(p in e)){s(h,t[p],u)}}}}}function f(e){return e.replace(/[0-9]+$/,"")}function h(e,t,r,i,o){var s=o&&r(o);for(var u in e){var c=e[u];var p=d(e,u,i);var v=d(e,u,o);var m=r(v);if(!m){var g=f(u);if(g!==u){v=d(e,g,o);m=r(v)}}if(s&&s===m)continue;if(!m||m._noTemplating||m.valType==="data_array"||m.arrayOk&&Array.isArray(c)){continue}if(!m.valType&&n(c)){h(c,t,r,p,v)}else if(m._isLinkedToArray&&Array.isArray(c)){var y=false;var x=0;var b={};for(var _=0;_<c.length;_++){var w=c[_];if(n(w)){var T=w.name;if(T){if(!b[T]){h(w,t,r,d(c,x,p),d(c,x,v));x++;b[T]=1}}else if(!y){var k=l.arrayDefaultKey(u);var M=d(e,k,i);var A=d(c,x,p);h(w,t,r,A,d(c,x,v));var S=a.nestedProperty(t,A);var E=a.nestedProperty(t,M);E.set(S.get());S.set(null);y=true}}}}else{var L=a.nestedProperty(t,p);L.set(c)}}}function p(e,t){return i.getLayoutValObject(e,a.nestedProperty({},t).parts)}function v(e,t){return i.getTraceValObject(e,a.nestedProperty({},t).parts)}function d(e,t,r){var a;if(!r)a=t;else if(Array.isArray(e))a=r+"["+t+"]";else a=r+"."+t;return a}r.validateTemplate=function(e,t){var r=a.extendDeep({},{_context:u,data:e.data,layout:e.layout});var i=r.layout||{};if(!n(t))t=i.template||{};var s=t.layout;var l=t.data;var c=[];r.layout=i;r.layout.template=t;o.supplyDefaults(r);var h=r._fullLayout;var p=r._fullData;var v={};function y(e,t){for(var r in e){if(r.charAt(0)!=="_"&&n(e[r])){var a=f(r);var i=[];var o;for(o=0;o<t.length;o++){i.push(d(e,r,t[o]));if(a!==r)i.push(d(e,a,t[o]))}for(o=0;o<i.length;o++){v[i[o]]=1}y(e[r],i)}}}function x(e,t){for(var r in e){if(r.indexOf("defaults")===-1&&n(e[r])){var a=d(e,r,t);if(v[a]){x(e[r],a)}else{c.push({code:"unused",path:a})}}}}if(!n(s)){c.push({code:"layout"})}else{y(h,["layout"]);x(s,"layout")}if(!n(l)){c.push({code:"data"})}else{var b={};var _;for(var w=0;w<p.length;w++){var T=p[w];_=T.type;b[_]=(b[_]||0)+1;if(!T._fullInput._template){c.push({code:"missing",index:T._fullInput.index,traceType:_})}}for(_ in l){var k=l[_].length;var M=b[_]||0;if(k>M){c.push({code:"unused",traceType:_,templateCount:k,dataCount:M})}else if(M>k){c.push({code:"reused",traceType:_,templateCount:k,dataCount:M})}}}function A(e,t){for(var r in e){if(r.charAt(0)==="_")continue;var a=e[r];var i=d(e,r,t);if(n(a)){if(Array.isArray(e)&&a._template===false&&a.templateitemname){c.push({code:"missing",path:i,templateitemname:a.templateitemname})}A(a,i)}else if(Array.isArray(a)&&m(a)){A(a,i)}}}A({data:p,layout:h},"");if(c.length)return c.map(g)};function m(e){for(var t=0;t<e.length;t++){if(n(e[t]))return true}}function g(e){var t;switch(e.code){case"data":t="The template has no key data.";break;case"layout":t="The template has no key layout.";break;case"missing":if(e.path){t="There are no templates for item "+e.path+" with name "+e.templateitemname}else{t="There are no templates for trace "+e.index+", of type "+e.traceType+"."}break;case"unused":if(e.path){t="The template item at "+e.path+" was not used in constructing the plot."}else if(e.dataCount){t="Some of the templates of type "+e.traceType+" were not used. The template has "+e.templateCount+" traces, the data only has "+e.dataCount+" of this type."}else{t="The template has "+e.templateCount+" traces of type "+e.traceType+" but there are none in the data."}break;case"reused":t="Some of the templates of type "+e.traceType+" were used more than once. The template has "+e.templateCount+" traces, the data has "+e.dataCount+" of this type.";break}e.msg=t;return e}},{"../lib":787,"../plots/attributes":834,"../plots/plots":901,"./plot_config":825,"./plot_schema":826,"./plot_template":827}],830:[function(e,t,r){"use strict";var a=e("fast-isnumeric");var n=e("./plot_api");var i=e("../plots/plots");var o=e("../lib");var s=e("../snapshot/helpers");var l=e("../snapshot/tosvg");var u=e("../snapshot/svgtoimg");var c=e("../version").version;var f={format:{valType:"enumerated",values:["png","jpeg","webp","svg","full-json"],dflt:"png"},width:{valType:"number",min:1},height:{valType:"number",min:1},scale:{valType:"number",min:0,dflt:1},setBackground:{valType:"any",dflt:false},imageDataOnly:{valType:"boolean",dflt:false}};function h(e,t){t=t||{};var r;var h;var p;var v;if(o.isPlainObject(e)){r=e.data||[];h=e.layout||{};p=e.config||{};v={}}else{e=o.getGraphDiv(e);r=o.extendDeep([],e.data);h=o.extendDeep({},e.layout);p=e._context;v=e._fullLayout||{}}function d(e){return!(e in t)||o.validate(t[e],f[e])}if(!d("width")&&t.width!==null||!d("height")&&t.height!==null){throw new Error("Height and width should be pixel values.")}if(!d("format")){throw new Error("Export format is not "+o.join2(f.format.values,", "," or ")+".")}var m={};function g(e,r){return o.coerce(t,m,f,e,r)}var y=g("format");var x=g("width");var b=g("height");var _=g("scale");var w=g("setBackground");var T=g("imageDataOnly");var k=document.createElement("div");k.style.position="absolute";k.style.left="-5000px";document.body.appendChild(k);var M=o.extendFlat({},h);if(x){M.width=x}else if(t.width===null&&a(v.width)){M.width=v.width}if(b){M.height=b}else if(t.height===null&&a(v.height)){M.height=v.height}var A=o.extendFlat({},p,{_exportedPlot:true,staticPlot:true,setBackground:w});var S=s.getRedrawFunc(k);function E(){return new Promise((function(e){setTimeout(e,s.getDelay(k._fullLayout))}))}function L(){return new Promise((function(e,t){var r=l(k,y,_);var a=k._fullLayout.width;var f=k._fullLayout.height;function h(){n.purge(k);document.body.removeChild(k)}if(y==="full-json"){var p=i.graphJson(k,false,"keepdata","object",true,true);p.version=c;p=JSON.stringify(p);h();if(T){return e(p)}else{return e(s.encodeJSON(p))}}h();if(y==="svg"){if(T){return e(r)}else{return e(s.encodeSVG(r))}}var v=document.createElement("canvas");v.id=o.randstr();u({format:y,width:a,height:f,scale:_,canvas:v,svg:r,promise:true}).then(e).catch(t)}))}function C(e){if(T){return e.replace(s.IMAGE_URL_PREFIX,"")}else{return e}}return new Promise((function(e,t){n.newPlot(k,r,M,A).then(S).then(E).then(L).then((function(t){e(C(t))})).catch((function(e){t(e)}))}))}t.exports=h},{"../lib":787,"../plots/plots":901,"../snapshot/helpers":919,"../snapshot/svgtoimg":921,"../snapshot/tosvg":923,"../version":1388,"./plot_api":824,"fast-isnumeric":246}],831:[function(e,t,r){"use strict";var a=e("../lib");var n=e("../plots/plots");var i=e("./plot_schema");var o=e("./plot_config").dfltConfig;var s=a.isPlainObject;var l=Array.isArray;var u=a.isArrayOrTypedArray;t.exports=function e(t,r){if(t===undefined)t=[];if(r===undefined)r={};var u=i.get();var h=[];var p={_context:a.extendFlat({},o)};var d,m;if(l(t)){p.data=a.extendDeep([],t);d=t}else{p.data=[];d=[];h.push(v("array","data"))}if(s(r)){p.layout=a.extendDeep({},r);m=r}else{p.layout={};m={};if(arguments.length>1){h.push(v("object","layout"))}}n.supplyDefaults(p);var g=p._fullData;var y=d.length;for(var x=0;x<y;x++){var b=d[x];var _=["data",x];if(!s(b)){h.push(v("object",_));continue}var w=g[x];var T=w.type;var k=u.traces[T].attributes;k.type={valType:"enumerated",values:[T]};if(w.visible===false&&b.visible!==false){h.push(v("invisible",_))}c(b,w,k,h,_);var M=b.transforms;var A=w.transforms;if(M){if(!l(M)){h.push(v("array",_,["transforms"]))}_.push("transforms");for(var S=0;S<M.length;S++){var E=["transforms",S];var L=M[S].type;if(!s(M[S])){h.push(v("object",_,E));continue}var C=u.transforms[L]?u.transforms[L].attributes:{};C.type={valType:"enumerated",values:Object.keys(u.transforms)};c(M[S],A[S],C,h,_,E)}}}var I=p._fullLayout;var P=f(u,g);c(m,I,P,h,"layout");return h.length===0?void 0:h};function c(e,t,r,n,i,o){o=o||[];var f=Object.keys(e);for(var h=0;h<f.length;h++){var p=f[h];if(p==="transforms")continue;var g=o.slice();g.push(p);var y=e[p];var x=t[p];var b=m(r,p);var _=(b||{}).valType;var w=_==="info_array";var T=_==="colorscale";var k=(b||{}).items;if(!d(r,p)){n.push(v("schema",i,g))}else if(s(y)&&s(x)&&_!=="any"){c(y,x,b,n,i,g)}else if(w&&l(y)){if(y.length>x.length){n.push(v("unused",i,g.concat(x.length)))}var M=x.length;var A=Array.isArray(k);if(A)M=Math.min(M,k.length);var S,E,L,C,I;if(b.dimensions===2){for(E=0;E<M;E++){if(l(y[E])){if(y[E].length>x[E].length){n.push(v("unused",i,g.concat(E,x[E].length)))}var P=x[E].length;for(S=0;S<(A?Math.min(P,k[E].length):P);S++){L=A?k[E][S]:k;C=y[E][S];I=x[E][S];if(!a.validate(C,L)){n.push(v("value",i,g.concat(E,S),C))}else if(I!==C&&I!==+C){n.push(v("dynamic",i,g.concat(E,S),C,I))}}}else{n.push(v("array",i,g.concat(E),y[E]))}}}else{for(E=0;E<M;E++){L=A?k[E]:k;C=y[E];I=x[E];if(!a.validate(C,L)){n.push(v("value",i,g.concat(E),C))}else if(I!==C&&I!==+C){n.push(v("dynamic",i,g.concat(E),C,I))}}}}else if(b.items&&!w&&l(y)){var O=k[Object.keys(k)[0]];var z=[];var D,R;for(D=0;D<x.length;D++){var F=x[D]._index||D;R=g.slice();R.push(F);if(s(y[F])&&s(x[D])){z.push(F);var B=y[F];var N=x[D];if(s(B)&&B.visible!==false&&N.visible===false){n.push(v("invisible",i,R))}else c(B,N,O,n,i,R)}}for(D=0;D<y.length;D++){R=g.slice();R.push(D);if(!s(y[D])){n.push(v("object",i,R,y[D]))}else if(z.indexOf(D)===-1){n.push(v("unused",i,R))}}}else if(!s(y)&&s(x)){n.push(v("object",i,g,y))}else if(!u(y)&&u(x)&&!w&&!T){n.push(v("array",i,g,y))}else if(!(p in t)){n.push(v("unused",i,g,y))}else if(!a.validate(y,b)){n.push(v("value",i,g,y))}else if(b.valType==="enumerated"&&(b.coerceNumber&&y!==+x||y!==x)){n.push(v("dynamic",i,g,y,x))}}return n}function f(e,t){var r=e.layout.layoutAttributes;for(var n=0;n<t.length;n++){var i=t[n];var o=e.traces[i.type];var s=o.layoutAttributes;if(s){if(i.subplot){a.extendFlat(r[o.attributes.subplot.dflt],s)}else{a.extendFlat(r,s)}}}return r}var h={object:function(e,t){var r;if(e==="layout"&&t==="")r="The layout argument";else if(e[0]==="data"&&t===""){r="Trace "+e[1]+" in the data argument"}else r=p(e)+"key "+t;return r+" must be linked to an object container"},array:function(e,t){var r;if(e==="data")r="The data argument";else r=p(e)+"key "+t;return r+" must be linked to an array container"},schema:function(e,t){return p(e)+"key "+t+" is not part of the schema"},unused:function(e,t,r){var a=s(r)?"container":"key";return p(e)+a+" "+t+" did not get coerced"},dynamic:function(e,t,r,a){return[p(e)+"key",t,"(set to '"+r+"')","got reset to","'"+a+"'","during defaults."].join(" ")},invisible:function(e,t){return(t?p(e)+"item "+t:"Trace "+e[1])+" got defaulted to be not visible"},value:function(e,t,r){return[p(e)+"key "+t,"is set to an invalid value ("+r+")"].join(" ")}};function p(e){if(l(e))return"In data trace "+e[1]+", ";return"In "+e+", "}function v(e,t,r,n,i){r=r||"";var o,s;if(l(t)){o=t[0];s=t[1]}else{o=t;s=null}var u=x(r);var c=h[e](t,u,n,i);a.log(c);return{code:e,container:o,trace:s,path:r,astr:u,msg:c}}function d(e,t){var r=y(t);var a=r.keyMinusId;var n=r.id;if(a in e&&e[a]._isSubplotObj&&n){return true}return t in e}function m(e,t){if(t in e)return e[t];var r=y(t);return e[r.keyMinusId]}var g=a.counterRegex("([a-z]+)");function y(e){var t=e.match(g);return{keyMinusId:t&&t[1],id:t&&t[2]}}function x(e){if(!l(e))return String(e);var t="";for(var r=0;r<e.length;r++){var a=e[r];if(typeof a==="number"){t=t.substr(0,t.length-1)+"["+a+"]"}else{t+=a}if(r<e.length-1)t+="."}return t}},{"../lib":787,"../plots/plots":901,"./plot_config":825,"./plot_schema":826}],832:[function(e,t,r){"use strict";t.exports={mode:{valType:"enumerated",dflt:"afterall",values:["immediate","next","afterall"]},direction:{valType:"enumerated",values:["forward","reverse"],dflt:"forward"},fromcurrent:{valType:"boolean",dflt:false},frame:{duration:{valType:"number",min:0,dflt:500},redraw:{valType:"boolean",dflt:true}},transition:{duration:{valType:"number",min:0,dflt:500,editType:"none"},easing:{valType:"enumerated",dflt:"cubic-in-out",values:["linear","quad","cubic","sin","exp","circle","elastic","back","bounce","linear-in","quad-in","cubic-in","sin-in","exp-in","circle-in","elastic-in","back-in","bounce-in","linear-out","quad-out","cubic-out","sin-out","exp-out","circle-out","elastic-out","back-out","bounce-out","linear-in-out","quad-in-out","cubic-in-out","sin-in-out","exp-in-out","circle-in-out","elastic-in-out","back-in-out","bounce-in-out"],editType:"none"},ordering:{valType:"enumerated",values:["layout first","traces first"],dflt:"layout first",editType:"none"}}}},{}],833:[function(e,t,r){"use strict";var a=e("../lib");var n=e("../plot_api/plot_template");t.exports=function e(t,r,i){var o=i.name;var s=i.inclusionAttr||"visible";var l=r[o];var u=a.isArrayOrTypedArray(t[o])?t[o]:[];var c=r[o]=[];var f=n.arrayTemplater(r,o,s);var h,p;for(h=0;h<u.length;h++){var v=u[h];if(!a.isPlainObject(v)){p=f.newItem({});p[s]=false}else{p=f.newItem(v)}p._index=h;if(p[s]!==false){i.handleItemDefaults(v,p,r,i)}c.push(p)}var d=f.defaultItems();for(h=0;h<d.length;h++){p=d[h];p._index=c.length;i.handleItemDefaults({},p,r,i,{});c.push(p)}if(a.isArrayOrTypedArray(l)){var m=Math.min(l.length,c.length);for(h=0;h<m;h++){a.relinkPrivateKeys(c[h],l[h])}}return c}},{"../lib":787,"../plot_api/plot_template":827}],834:[function(e,t,r){"use strict";var a=e("./font_attributes");var n=e("../components/fx/attributes");t.exports={type:{valType:"enumerated",values:[],dflt:"scatter",editType:"calc+clearAxisTypes",_noTemplating:true},visible:{valType:"enumerated",values:[true,false,"legendonly"],dflt:true,editType:"calc"},showlegend:{valType:"boolean",dflt:true,editType:"style"},legendgroup:{valType:"string",dflt:"",editType:"style"},legendgrouptitle:{text:{valType:"string",dflt:"",editType:"style"},font:a({editType:"style"}),editType:"style"},legendrank:{valType:"number",dflt:1e3,editType:"style"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"style"},name:{valType:"string",editType:"style"},uid:{valType:"string",editType:"plot",anim:true},ids:{valType:"data_array",editType:"calc",anim:true},customdata:{valType:"data_array",editType:"calc"},meta:{valType:"any",arrayOk:true,editType:"plot"},selectedpoints:{valType:"any",editType:"calc"},hoverinfo:{valType:"flaglist",flags:["x","y","z","text","name"],extras:["all","none","skip"],arrayOk:true,dflt:"all",editType:"none"},hoverlabel:n.hoverlabel,stream:{token:{valType:"string",noBlank:true,strict:true,editType:"calc"},maxpoints:{valType:"number",min:0,max:1e4,dflt:500,editType:"calc"},editType:"calc"},transforms:{_isLinkedToArray:"transform",editType:"calc"},uirevision:{valType:"any",editType:"none"}}},{"../components/fx/attributes":681,"./font_attributes":867}],835:[function(e,t,r){"use strict";var a=e("fast-isnumeric");var n=e("../../lib");var i=n.dateTime2ms;var o=n.incrementMonth;var s=e("../../constants/numerical");var l=s.ONEAVGMONTH;t.exports=function e(t,r,n,s){if(r.type!=="date")return{vals:s};var u=t[n+"periodalignment"];if(!u)return{vals:s};var c=t[n+"period"];var f;if(a(c)){c=+c;if(c<=0)return{vals:s}}else if(typeof c==="string"&&c.charAt(0)==="M"){var h=+c.substring(1);if(h>0&&Math.round(h)===h){f=h}else return{vals:s}}var p=r.calendar;var v="start"===u;var d="end"===u;var m=t[n+"period0"];var g=i(m,p)||0;var y=[];var x=[];var b=[];var _=s.length;for(var w=0;w<_;w++){var T=s[w];var k,M,A;if(f){k=Math.round((T-g)/(f*l));A=o(g,f*k,p);while(A>T){A=o(A,-f,p)}while(A<=T){A=o(A,f,p)}M=o(A,-f,p)}else{k=Math.round((T-g)/c);A=g+k*c;while(A>T){A-=c}while(A<=T){A+=c}M=A-c}y[w]=v?M:d?A:(M+A)/2;x[w]=M;b[w]=A}return{vals:y,starts:x,ends:b}}},{"../../constants/numerical":763,"../../lib":787,"fast-isnumeric":246}],836:[function(e,t,r){"use strict";t.exports={xaxis:{valType:"subplotid",dflt:"x",editType:"calc+clearAxisTypes"},yaxis:{valType:"subplotid",dflt:"y",editType:"calc+clearAxisTypes"}}},{}],837:[function(e,t,r){"use strict";var a=e("@plotly/d3");var n=e("fast-isnumeric");var i=e("../../lib");var o=e("../../constants/numerical").FP_SAFE;var s=e("../../registry");var l=e("../../components/drawing");var u=e("./axis_ids");var c=u.getFromId;var f=u.isLinked;t.exports={getAutoRange:h,makePadFn:v,doAutoRange:y,findExtremes:x,concatExtremes:g};function h(e,t){var r,a;var n=[];var o=e._fullLayout;var s=v(o,t,0);var l=v(o,t,1);var u=g(e,t);var c=u.min;var f=u.max;if(c.length===0||f.length===0){return i.simpleMap(t.range,t.r2l)}var h=c[0].val;var d=f[0].val;for(r=1;r<c.length;r++){if(h!==d)break;h=Math.min(h,c[r].val)}for(r=1;r<f.length;r++){if(h!==d)break;d=Math.max(d,f[r].val)}var m=false;if(t.range){var y=i.simpleMap(t.range,t.r2l);m=y[1]<y[0]}if(t.autorange==="reversed"){m=true;t.autorange=true}var x=t.rangemode;var b=x==="tozero";var _=x==="nonnegative";var w=t._length;var T=w/10;var k=0;var M,A,S,E,L,C;for(r=0;r<c.length;r++){M=c[r];for(a=0;a<f.length;a++){A=f[a];C=A.val-M.val-p(t,M.val,A.val);if(C>0){L=w-s(M)-l(A);if(L>T){if(C/L>k){S=M;E=A;k=C/L}}else if(C/w>k){S={val:M.val,nopad:1};E={val:A.val,nopad:1};k=C/w}}}}function I(e,t){return Math.max(e,l(t))}if(h===d){var P=h-1;var O=h+1;if(b){if(h===0){n=[0,1]}else{var z=(h>0?f:c).reduce(I,0);var D=h/(1-Math.min(.5,z/w));n=h>0?[0,D]:[D,0]}}else if(_){n=[Math.max(0,P),Math.max(1,O)]}else{n=[P,O]}}else{if(b){if(S.val>=0){S={val:0,nopad:1}}if(E.val<=0){E={val:0,nopad:1}}}else if(_){if(S.val-k*s(S)<0){S={val:0,nopad:1}}if(E.val<=0){E={val:1,nopad:1}}}k=(E.val-S.val-p(t,M.val,A.val))/(w-s(S)-l(E));n=[S.val-k*s(S),E.val+k*l(E)]}if(m)n.reverse();return i.simpleMap(n,t.l2r||Number)}function p(e,t,r){var a=0;if(e.rangebreaks){var n=e.locateBreaks(t,r);for(var i=0;i<n.length;i++){var o=n[i];a+=o.max-o.min}}return a}function v(e,t,r){var a=.05*t._length;var n=t._anchorAxis||{};if((t.ticklabelposition||"").indexOf("inside")!==-1||(n.ticklabelposition||"").indexOf("inside")!==-1){var o=t.autorange==="reversed";if(!o){var s=i.simpleMap(t.range,t.r2l);o=s[1]<s[0]}if(o)r=!r}var l=0;if(!f(e,t._id)){l=m(e,t,r)}a=Math.max(l,a);if(t.constrain==="domain"&&t._inputDomain){a*=(t._inputDomain[1]-t._inputDomain[0])/(t.domain[1]-t.domain[0])}return function e(t){if(t.nopad)return 0;return t.pad+(t.extrapad?a:l)}}var d=3;function m(e,t,r){var n=0;var o=t._id.charAt(0)==="x";for(var s in e._plots){var u=e._plots[s];if(t._id!==u.xaxis._id&&t._id!==u.yaxis._id)continue;var c=(o?u.yaxis:u.xaxis)||{};if((c.ticklabelposition||"").indexOf("inside")!==-1){if(!r&&(c.side==="left"||c.side==="bottom")||r&&(c.side==="top"||c.side==="right")){if(c._vals){var f=i.deg2rad(c._tickAngles[c._id+"tick"]||0);var h=Math.abs(Math.cos(f));var p=Math.abs(Math.sin(f));if(!c._vals[0].bb){var v=c._id+"tick";var m=c._selections[v];m.each((function(e){var t=a.select(this);var r=t.select(".text-math-group");if(r.empty()){e.bb=l.bBox(t.node())}}))}for(var g=0;g<c._vals.length;g++){var y=c._vals[g];var x=y.bb;if(x){var b=2*d+x.width;var _=2*d+x.height;n=Math.max(n,o?Math.max(b*h,_*p):Math.max(_*h,b*p))}}}if(c.ticks==="inside"&&c.ticklabelposition==="inside"){n+=c.ticklen||0}}}}return n}function g(e,t,r){var a=t._id;var n=e._fullData;var i=e._fullLayout;var o=[];var s=[];var l,u,f;function h(e,t){for(l=0;l<t.length;l++){var r=e[t[l]];var n=(r._extremes||{})[a];if(r.visible===true&&n){for(u=0;u<n.min.length;u++){f=n.min[u];b(o,f.val,f.pad,{extrapad:f.extrapad})}for(u=0;u<n.max.length;u++){f=n.max[u];_(s,f.val,f.pad,{extrapad:f.extrapad})}}}}h(n,t._traceIndices);h(i.annotations||[],t._annIndices||[]);h(i.shapes||[],t._shapeIndices||[]);if(t._matchGroup&&!r){for(var p in t._matchGroup){if(p!==t._id){var v=c(e,p);var d=g(e,v,true);var m=t._length/v._length;for(u=0;u<d.min.length;u++){f=d.min[u];b(o,f.val,f.pad*m,{extrapad:f.extrapad})}for(u=0;u<d.max.length;u++){f=d.max[u];_(s,f.val,f.pad*m,{extrapad:f.extrapad})}}}}return{min:o,max:s}}function y(e,t,r){t.setScale();if(t.autorange){t.range=r?r.slice():h(e,t);t._r=t.range.slice();t._rl=i.simpleMap(t._r,t.r2l);var a=t._input;var n={};n[t._attr+".range"]=t.range;n[t._attr+".autorange"]=t.autorange;s.call("_storeDirectGUIEdit",e.layout,e._fullLayout._preGUI,n);a.range=t.range.slice();a.autorange=t.autorange}var o=t._anchorAxis;if(o&&o.rangeslider){var l=o.rangeslider[t._name];if(l){if(l.rangemode==="auto"){l.range=h(e,t)}}o._input.rangeslider[t._name]=i.extendFlat({},l)}}function x(e,t,r){if(!r)r={};if(!e._m)e.setScale();var a=[];var i=[];var s=t.length;var l=r.padded||false;var u=r.tozero&&(e.type==="linear"||e.type==="-");var c=e.type==="log";var f=false;var h=r.vpadLinearized||false;var p,v,d,m,g,y,x,w,k;function M(e){if(Array.isArray(e)){f=true;return function(t){return Math.max(Number(e[t]||0),0)}}else{var t=Math.max(Number(e||0),0);return function(){return t}}}var A=M((e._m>0?r.ppadplus:r.ppadminus)||r.ppad||0);var S=M((e._m>0?r.ppadminus:r.ppadplus)||r.ppad||0);var E=M(r.vpadplus||r.vpad);var L=M(r.vpadminus||r.vpad);if(!f){w=Infinity;k=-Infinity;if(c){for(p=0;p<s;p++){v=t[p];if(v<w&&v>0)w=v;if(v>k&&v<o)k=v}}else{for(p=0;p<s;p++){v=t[p];if(v<w&&v>-o)w=v;if(v>k&&v<o)k=v}}t=[w,k];s=2}var C={tozero:u,extrapad:l};function I(r){d=t[r];if(!n(d))return;y=A(r);x=S(r);if(h){m=e.c2l(d)-L(r);g=e.c2l(d)+E(r)}else{w=d-L(r);k=d+E(r);if(c&&w<k/10)w=k/10;m=e.c2l(w);g=e.c2l(k)}if(u){m=Math.min(0,m);g=Math.max(0,g)}if(T(m)){b(a,m,x,C)}if(T(g)){_(i,g,y,C)}}var P=Math.min(6,s);for(p=0;p<P;p++)I(p);for(p=s-1;p>=P;p--)I(p);return{min:a,max:i,opts:r}}function b(e,t,r,a){w(e,t,r,a,k)}function _(e,t,r,a){w(e,t,r,a,M)}function w(e,t,r,a,n){var i=a.tozero;var o=a.extrapad;var s=true;for(var l=0;l<e.length&&s;l++){var u=e[l];if(n(u.val,t)&&u.pad>=r&&(u.extrapad||!o)){s=false;break}else if(n(t,u.val)&&u.pad<=r&&(o||!u.extrapad)){e.splice(l,1);l--}}if(s){var c=i&&t===0;e.push({val:t,pad:c?0:r,extrapad:c?false:o})}}function T(e){return n(e)&&Math.abs(e)<o}function k(e,t){return e<=t}function M(e,t){return e>=t}},{"../../components/drawing":672,"../../constants/numerical":763,"../../lib":787,"../../registry":915,"./axis_ids":842,"@plotly/d3":58,"fast-isnumeric":246}],838:[function(e,t,r){"use strict";var a=e("@plotly/d3");var n=e("fast-isnumeric");var i=e("../../plots/plots");var o=e("../../registry");var s=e("../../lib");var l=s.strTranslate;var u=e("../../lib/svg_text_utils");var c=e("../../components/titles");var f=e("../../components/color");var h=e("../../components/drawing");var p=e("./layout_attributes");var v=e("./clean_ticks");var d=e("../../constants/numerical");var m=d.ONEMAXYEAR;var g=d.ONEAVGYEAR;var y=d.ONEMINYEAR;var x=d.ONEMAXQUARTER;var b=d.ONEAVGQUARTER;var _=d.ONEMINQUARTER;var w=d.ONEMAXMONTH;var T=d.ONEAVGMONTH;var k=d.ONEMINMONTH;var M=d.ONEWEEK;var A=d.ONEDAY;var S=A/2;var E=d.ONEHOUR;var L=d.ONEMIN;var C=d.ONESEC;var I=d.MINUS_SIGN;var P=d.BADNUM;var O={K:"zeroline"};var z={K:"gridline",L:"path"};var D={K:"tick",L:"path"};var R={K:"tick",L:"text"};var F=e("../../constants/alignment");var B=F.MID_SHIFT;var N=F.CAP_SHIFT;var j=F.LINE_SPACING;var U=F.OPPOSITE_SIDE;var V=3;var H=t.exports={};H.setConvert=e("./set_convert");var q=e("./axis_autotype");var G=e("./axis_ids");var Y=G.idSort;var W=G.isLinked;H.id2name=G.id2name;H.name2id=G.name2id;H.cleanId=G.cleanId;H.list=G.list;H.listIds=G.listIds;H.getFromId=G.getFromId;H.getFromTrace=G.getFromTrace;var X=e("./autorange");H.getAutoRange=X.getAutoRange;H.findExtremes=X.findExtremes;var Z=1e-4;function J(e){var t=(e[1]-e[0])*Z;return[e[0]-t,e[1]+t]}H.coerceRef=function(e,t,r,a,n,i){var o=a.charAt(a.length-1);var l=r._fullLayout._subplots[o+"axis"];var u=a+"ref";var c={};if(!n)n=l[0]||(typeof i==="string"?i:i[0]);if(!i)i=n;l=l.concat(l.map((function(e){return e+" domain"})));c[u]={valType:"enumerated",values:l.concat(i?typeof i==="string"?[i]:i:[]),dflt:n};return s.coerce(e,t,c,u)};H.getRefType=function(e){if(e===undefined){return e}if(e==="paper"){return"paper"}if(e==="pixel"){return"pixel"}if(/( domain)$/.test(e)){return"domain"}else{return"range"}};H.coercePosition=function(e,t,r,a,n,i){var o,l;var u=H.getRefType(a);if(u!=="range"){o=s.ensureNumber;l=r(n,i)}else{var c=H.getFromId(t,a);i=c.fraction2r(i);l=r(n,i);o=c.cleanPos}e[n]=o(l)};H.cleanPosition=function(e,t,r){var a=r==="paper"||r==="pixel"?s.ensureNumber:H.getFromId(t,r).cleanPos;return a(e)};H.redrawComponents=function(e,t){t=t?t:H.listIds(e);var r=e._fullLayout;function a(a,n,i,s){var l=o.getComponentMethod(a,n);var u={};for(var c=0;c<t.length;c++){var f=r[H.id2name(t[c])];var h=f[i];for(var p=0;p<h.length;p++){var v=h[p];if(!u[v]){l(e,v);u[v]=1;if(s)return}}}}a("annotations","drawOne","_annIndices");a("shapes","drawOne","_shapeIndices");a("images","draw","_imgIndices",true)};var K=H.getDataConversions=function(e,t,r,a){var n;var i=r==="x"||r==="y"||r==="z"?r:a;if(Array.isArray(i)){n={type:q(a,undefined,{autotypenumbers:e._fullLayout.autotypenumbers}),_categories:[]};H.setConvert(n);if(n.type==="category"){for(var o=0;o<a.length;o++){n.d2c(a[o])}}}else{n=H.getFromTrace(e,t,i)}if(n)return{d2c:n.d2c,c2d:n.c2d};if(i==="ids")return{d2c:$,c2d:$};return{d2c:Q,c2d:Q}};function Q(e){return+e}function $(e){return String(e)}H.getDataToCoordFunc=function(e,t,r,a){return K(e,t,r,a).d2c};H.counterLetter=function(e){var t=e.charAt(0);if(t==="x")return"y";if(t==="y")return"x"};H.minDtick=function(e,t,r,a){if(["log","category","multicategory"].indexOf(e.type)!==-1||!a){e._minDtick=0}else if(e._minDtick===undefined){e._minDtick=t;e._forceTick0=r}else if(e._minDtick){if((e._minDtick/t+1e-6)%1<2e-6&&((r-e._forceTick0)/t%1+1.000001)%1<2e-6){e._minDtick=t;e._forceTick0=r}else if((t/e._minDtick+1e-6)%1>2e-6||((r-e._forceTick0)/e._minDtick%1+1.000001)%1>2e-6){e._minDtick=0}}};H.saveRangeInitial=function(e,t){var r=H.list(e,"",true);var a=false;for(var n=0;n<r.length;n++){var i=r[n];var o=i._rangeInitial===undefined;var s=o||!(i.range[0]===i._rangeInitial[0]&&i.range[1]===i._rangeInitial[1]);if(o&&i.autorange===false||t&&s){i._rangeInitial=i.range.slice();a=true}}return a};H.saveShowSpikeInitial=function(e,t){var r=H.list(e,"",true);var a=false;var n="on";for(var i=0;i<r.length;i++){var o=r[i];var s=o._showSpikeInitial===undefined;var l=s||!(o.showspikes===o._showspikes);if(s||t&&l){o._showSpikeInitial=o.showspikes;a=true}if(n==="on"&&!o.showspikes){n="off"}}e._fullLayout._cartesianSpikesEnabled=n;return a};H.autoBin=function(e,t,r,a,i,o){var l=s.aggNums(Math.min,null,e);var u=s.aggNums(Math.max,null,e);if(t.type==="category"||t.type==="multicategory"){return{start:l-.5,end:u+.5,size:Math.max(1,Math.round(o)||1),_dataSpan:u-l}}if(!i)i=t.calendar;var c;if(t.type==="log"){c={type:"linear",range:[l,u]}}else{c={type:t.type,range:s.simpleMap([l,u],t.c2r,0,i),calendar:i}}H.setConvert(c);o=o&&v.dtick(o,c.type);if(o){c.dtick=o;c.tick0=v.tick0(undefined,c.type,i)}else{var f;if(r)f=(u-l)/r;else{var h=s.distinctVals(e);var p=Math.pow(10,Math.floor(Math.log(h.minDiff)/Math.LN10));var d=p*s.roundUp(h.minDiff/p,[.9,1.9,4.9,9.9],true);f=Math.max(d,2*s.stdev(e)/Math.pow(e.length,a?.25:.4));if(!n(f))f=1}H.autoTicks(c,f)}var m=c.dtick;var g=H.tickIncrement(H.tickFirst(c),m,"reverse",i);var y,x;if(typeof m==="number"){g=ee(g,e,c,l,u);x=1+Math.floor((u-g)/m);y=g+x*m}else{if(c.dtick.charAt(0)==="M"){g=te(g,e,m,l,i)}y=g;x=0;while(y<=u){y=H.tickIncrement(y,m,false,i);x++}}return{start:t.c2r(g,0,i),end:t.c2r(y,0,i),size:m,_dataSpan:u-l}};function ee(e,t,r,a,i){var o=0;var s=0;var l=0;var u=0;function c(t){return(1+(t-e)*100/r.dtick)%100<2}for(var f=0;f<t.length;f++){if(t[f]%1===0)l++;else if(!n(t[f]))u++;if(c(t[f]))o++;if(c(t[f]+r.dtick/2))s++}var h=t.length-u;if(l===h&&r.type!=="date"){if(r.dtick<1){e=a-.5*r.dtick}else{e-=.5;if(e+r.dtick<a)e+=r.dtick}}else if(s<h*.1){if(o>h*.3||c(a)||c(i)){var p=r.dtick/2;e+=e+p<a?p:-p}}return e}function te(e,t,r,a,n){var i=s.findExactDates(t,n);var o=.8;if(i.exactDays>o){var l=Number(r.substr(1));if(i.exactYears>o&&l%12===0){e=H.tickIncrement(e,"M6","reverse")+A*1.5}else if(i.exactMonths>o){e=H.tickIncrement(e,"M1","reverse")+A*15.5}else{e-=S}var u=H.tickIncrement(e,r);if(u<=a)return u}return e}H.prepTicks=function(e,t){var r=s.simpleMap(e.range,e.r2l,undefined,undefined,t);e._dtickInit=e.dtick;e._tick0Init=e.tick0;if(e.tickmode==="auto"||!e.dtick){var a=e.nticks;var n;if(!a){if(e.type==="category"||e.type==="multicategory"){n=e.tickfont?s.bigFont(e.tickfont.size||12):15;a=e._length/n}else{n=e._id.charAt(0)==="y"?40:80;a=s.constrain(e._length/n,4,9)+1}if(e._name==="radialaxis")a*=2}if(e.tickmode==="array")a*=100;e._roughDTick=Math.abs(r[1]-r[0])/a;H.autoTicks(e,e._roughDTick);if(e._minDtick>0&&e.dtick<e._minDtick*2){e.dtick=e._minDtick;e.tick0=e.l2r(e._forceTick0)}}if(e.ticklabelmode==="period"){ae(e)}if(!e.tick0){e.tick0=e.type==="date"?"2000-01-01":0}if(e.type==="date"&&e.dtick<.1)e.dtick=.1;ve(e)};function re(e){return+e.substring(1)}function ae(e){var t;function r(){return!(n(e.dtick)||e.dtick.charAt(0)!=="M")}var a=r();var i=H.getTickFormat(e);if(i){var o=e._dtickInit!==e.dtick;if(!/%[fLQsSMX]/.test(i)){if(/%[HI]/.test(i)){t=E;if(o&&!a&&e.dtick<E)e.dtick=E}else if(/%p/.test(i)){t=S;if(o&&!a&&e.dtick<S)e.dtick=S}else if(/%[Aadejuwx]/.test(i)){t=A;if(o&&!a&&e.dtick<A)e.dtick=A}else if(/%[UVW]/.test(i)){t=M;if(o&&!a&&e.dtick<M)e.dtick=M}else if(/%[Bbm]/.test(i)){t=T;if(o&&(a?re(e.dtick)<1:e.dtick<k))e.dtick="M1"}else if(/%[q]/.test(i)){t=b;if(o&&(a?re(e.dtick)<3:e.dtick<_))e.dtick="M3"}else if(/%[Yy]/.test(i)){t=g;if(o&&(a?re(e.dtick)<12:e.dtick<y))e.dtick="M12"}}}a=r();if(a&&e.tick0===e._dowTick0){e.tick0=e._rawTick0}e._definedDelta=t}function ne(e,t,r){for(var a=0;a<e.length;a++){var n=e[a].value;var i=a;var o=a+1;if(a<e.length-1){i=a;o=a+1}else if(a>0){i=a-1;o=a}else{i=a;o=a}var s=e[i].value;var l=e[o].value;var u=Math.abs(l-s);var c=r||u;var f=0;if(c>=y){if(u>=y&&u<=m){f=u}else{f=g}}else if(r===b&&c>=_){if(u>=_&&u<=x){f=u}else{f=b}}else if(c>=k){if(u>=k&&u<=w){f=u}else{f=T}}else if(r===M&&c>=M){f=M}else if(c>=A){f=A}else if(r===S&&c>=S){f=S}else if(r===E&&c>=E){f=E}var h;if(f>=u){f=u;h=true}var p=n+f;if(t.rangebreaks&&f>0){var v=84;var d=0;for(var L=0;L<v;L++){var C=(L+.5)/v;if(t.maskBreaks(n*(1-C)+C*p)!==P)d++}f*=d/v;if(!f){e[a].drop=true}if(h&&u>M)f=u}if(f>0||a===0){e[a].periodX=n+f/2}}}H.calcTicks=function e(t,r){H.prepTicks(t,r);var a=s.simpleMap(t.range,t.r2l,undefined,undefined,r);if(t.tickmode==="array")return ie(t);var i=J(a);var o=i[0];var l=i[1];var u=a[1]<a[0];var c=Math.min(a[0],a[1]);var f=Math.max(a[0],a[1]);var h=t.type==="log"&&!(n(t.dtick)||t.dtick.charAt(0)==="L");var p=t.ticklabelmode==="period";t._tmin=H.tickFirst(t,r);if(t._tmin<o!==u)return[];if(t.type==="category"||t.type==="multicategory"){l=u?Math.max(-.5,l):Math.min(t._categories.length-.5,l)}var v=t._tmin;if(t.rangebreaks&&t._tick0Init!==t.tick0){v=Ze(v,t);if(!u){v=H.tickIncrement(v,t.dtick,!u,t.calendar)}}if(p){v=H.tickIncrement(v,t.dtick,!u,t.calendar)}var d=Math.max(1e3,t._length||0);var m=[];var g=null;for(;u?v>=l:v<=l;v=H.tickIncrement(v,t.dtick,u,t.calendar)){if(t.rangebreaks){if(!u){if(v<o)continue;if(t.maskBreaks(v)===P&&Ze(v,t)>=f)break}}if(m.length>d||v===g)break;g=v;var y=false;if(h&&v!==(v|0)){y=true}m.push({minor:y,value:v})}if(p)ne(m,t,t._definedDelta);var x;if(t.rangebreaks){var b=t._id.charAt(0)==="y";var _=1;if(t.tickmode==="auto"){_=t.tickfont?t.tickfont.size:12}var w=NaN;for(x=m.length-1;x>-1;x--){if(m[x].drop){m.splice(x,1);continue}m[x].value=Ze(m[x].value,t);var T=t.c2p(m[x].value);if(b?w>T-_:w<T+_){m.splice(u?x+1:x,1)}else{w=T}}}if(Xe(t)&&Math.abs(a[1]-a[0])===360){m.pop()}t._tmax=(m[m.length-1]||{}).value;t._prevDateHead="";t._inCalcTicks=true;var k=[];var M,A;for(x=0;x<m.length;x++){var S=m[x].minor;var E=m[x].value;M=H.tickText(t,E,false,S);A=m[x].periodX;if(A!==undefined){M.periodX=A;if(A>f||A<c){if(A>f)M.periodX=f;if(A<c)M.periodX=c;M.text=" ";t._prevDateHead=""}}k.push(M)}t._inCalcTicks=false;return k};function ie(e){var t=e.tickvals;var r=e.ticktext;var a=new Array(t.length);var n=s.simpleMap(e.range,e.r2l);var i=J(n);var o=Math.min(i[0],i[1]);var l=Math.max(i[0],i[1]);var u=0;if(!Array.isArray(r))r=[];var c=e.type==="category"?e.d2l_noadd:e.d2l;if(e.type==="log"&&String(e.dtick).charAt(0)!=="L"){e.dtick="L"+Math.pow(10,Math.floor(Math.min(e.range[0],e.range[1]))-1)}for(var f=0;f<t.length;f++){var h=c(t[f]);if(h>o&&h<l){if(r[f]===undefined)a[u]=H.tickText(e,h);else a[u]=de(e,h,String(r[f]));u++}}if(u<t.length)a.splice(u,t.length-u);if(e.rangebreaks){a=a.filter((function(t){return e.maskBreaks(t.x)!==P}))}return a}var oe=[2,5,10];var se=[1,2,3,6,12];var le=[1,2,5,10,15,30];var ue=[1,2,3,7,14];var ce=[-.046,0,.301,.477,.602,.699,.778,.845,.903,.954,1];var fe=[-.301,0,.301,.699,1];var he=[15,30,45,90,180];function pe(e,t,r){return t*s.roundUp(e/t,r)}H.autoTicks=function(e,t){var r;function a(e){return Math.pow(e,Math.floor(Math.log(t)/Math.LN10))}if(e.type==="date"){e.tick0=s.dateTick0(e.calendar,0);var i=2*t;if(i>g){t/=g;r=a(10);e.dtick="M"+12*pe(t,r,oe)}else if(i>T){t/=T;e.dtick="M"+pe(t,1,se)}else if(i>A){e.dtick=pe(t,A,e._hasDayOfWeekBreaks?[1,2,7,14]:ue);var o=H.getTickFormat(e);var l=e.ticklabelmode==="period";if(l)e._rawTick0=e.tick0;if(/%[uVW]/.test(o)){e.tick0=s.dateTick0(e.calendar,2)}else{e.tick0=s.dateTick0(e.calendar,1)}if(l)e._dowTick0=e.tick0}else if(i>E){e.dtick=pe(t,E,se)}else if(i>L){e.dtick=pe(t,L,le)}else if(i>C){e.dtick=pe(t,C,le)}else{r=a(10);e.dtick=pe(t,r,oe)}}else if(e.type==="log"){e.tick0=0;var u=s.simpleMap(e.range,e.r2l);if(t>.7){e.dtick=Math.ceil(t)}else if(Math.abs(u[1]-u[0])<1){var c=1.5*Math.abs((u[1]-u[0])/t);t=Math.abs(Math.pow(10,u[1])-Math.pow(10,u[0]))/c;r=a(10);e.dtick="L"+pe(t,r,oe)}else{e.dtick=t>.3?"D2":"D1"}}else if(e.type==="category"||e.type==="multicategory"){e.tick0=0;e.dtick=Math.ceil(Math.max(t,1))}else if(Xe(e)){e.tick0=0;r=1;e.dtick=pe(t,r,he)}else{e.tick0=0;r=a(10);e.dtick=pe(t,r,oe)}if(e.dtick===0)e.dtick=1;if(!n(e.dtick)&&typeof e.dtick!=="string"){var f=e.dtick;e.dtick=1;throw"ax.dtick error: "+String(f)}};function ve(e){var t=e.dtick;e._tickexponent=0;if(!n(t)&&typeof t!=="string"){t=1}if(e.type==="category"||e.type==="multicategory"){e._tickround=null}if(e.type==="date"){var r=e.r2l(e.tick0);var a=e.l2r(r).replace(/(^-|i)/g,"");var i=a.length;if(String(t).charAt(0)==="M"){if(i>10||a.substr(5)!=="01-01")e._tickround="d";else e._tickround=+t.substr(1)%12===0?"y":"m"}else if(t>=A&&i<=10||t>=A*15)e._tickround="d";else if(t>=L&&i<=16||t>=E)e._tickround="M";else if(t>=C&&i<=19||t>=L)e._tickround="S";else{var o=e.l2r(r+t).replace(/^-/,"").length;e._tickround=Math.max(i,o)-20;if(e._tickround<0)e._tickround=4}}else if(n(t)||t.charAt(0)==="L"){var s=e.range.map(e.r2d||Number);if(!n(t))t=Number(t.substr(1));e._tickround=2-Math.floor(Math.log(t)/Math.LN10+.01);var l=Math.max(Math.abs(s[0]),Math.abs(s[1]));var u=Math.floor(Math.log(l)/Math.LN10+.01);var c=e.minexponent===undefined?3:e.minexponent;if(Math.abs(u)>c){if(ke(e.exponentformat)&&!Me(u)){e._tickexponent=3*Math.round((u-1)/3)}else e._tickexponent=u}}else{e._tickround=null}}H.tickIncrement=function(e,t,r,i){var o=r?-1:1;if(n(t))return s.increment(e,o*t);var l=t.charAt(0);var u=o*Number(t.substr(1));if(l==="M")return s.incrementMonth(e,u,i);if(l==="L")return Math.log(Math.pow(10,e)+u)/Math.LN10;if(l==="D"){var c=t==="D2"?fe:ce;var f=e+o*.01;var h=s.roundUp(s.mod(f,1),c,r);return Math.floor(f)+Math.log(a.round(Math.pow(10,h),1))/Math.LN10}throw"unrecognized dtick "+String(t)};H.tickFirst=function(e,t){var r=e.r2l||Number;var i=s.simpleMap(e.range,r,undefined,undefined,t);var o=i[1]<i[0];var l=o?Math.floor:Math.ceil;var u=J(i)[0];var c=e.dtick;var f=r(e.tick0);if(n(c)){var h=l((u-f)/c)*c+f;if(e.type==="category"||e.type==="multicategory"){h=s.constrain(h,0,e._categories.length-1)}return h}var p=c.charAt(0);var v=Number(c.substr(1));if(p==="M"){var d=0;var m=f;var g,y,x;while(d<10){g=H.tickIncrement(m,c,o,e.calendar);if((g-u)*(m-u)<=0){if(o)return Math.min(m,g);return Math.max(m,g)}y=(u-(m+g)/2)/(g-m);x=p+(Math.abs(Math.round(y))||1)*v;m=H.tickIncrement(m,x,y<0?!o:o,e.calendar);d++}s.error("tickFirst did not converge",e);return m}else if(p==="L"){return Math.log(l((Math.pow(10,u)-f)/v)*v+f)/Math.LN10}else if(p==="D"){var b=c==="D2"?fe:ce;var _=s.roundUp(s.mod(u,1),b,o);return Math.floor(u)+Math.log(a.round(Math.pow(10,_),1))/Math.LN10}else throw"unrecognized dtick "+String(c)};H.tickText=function(e,t,r,a){var n=de(e,t);var i=e.tickmode==="array";var o=r||i;var l=e.type;var u=l==="category"?e.d2l_noadd:e.d2l;var c;if(i&&Array.isArray(e.ticktext)){var f=s.simpleMap(e.range,e.r2l);var h=(Math.abs(f[1]-f[0])-(e._lBreaks||0))/1e4;for(c=0;c<e.ticktext.length;c++){if(Math.abs(t-u(e.tickvals[c]))<h)break}if(c<e.ticktext.length){n.text=String(e.ticktext[c]);return n}}function p(a){if(a===undefined)return true;if(r)return a==="none";var n={first:e._tmin,last:e._tmax}[a];return a!=="all"&&t!==n}var v=r?"never":e.exponentformat!=="none"&&p(e.showexponent)?"hide":"";if(l==="date")me(e,n,r,o);else if(l==="log")ge(e,n,r,o,v);else if(l==="category")ye(e,n);else if(l==="multicategory")xe(e,n,r);else if(Xe(e))_e(e,n,r,o,v);else be(e,n,r,o,v);if(!a){if(e.tickprefix&&!p(e.showtickprefix))n.text=e.tickprefix+n.text;if(e.ticksuffix&&!p(e.showticksuffix))n.text+=e.ticksuffix}if(e.tickson==="boundaries"||e.showdividers){var d=function(t){var r=e.l2p(t);return r>=0&&r<=e._length?t:null};n.xbnd=[d(n.x-.5),d(n.x+e.dtick-.5)]}return n};H.hoverLabelText=function(e,t,r){if(r)e=s.extendFlat({},e,{hoverformat:r});var a=Array.isArray(t)?t[0]:t;var n=Array.isArray(t)?t[1]:undefined;if(n!==undefined&&n!==a){return H.hoverLabelText(e,a,r)+" - "+H.hoverLabelText(e,n,r)}var i=e.type==="log"&&a<=0;var o=H.tickText(e,e.c2l(i?-a:a),"hover").text;if(i){return a===0?"0":I+o}return o};function de(e,t,r){var a=e.tickfont||{};return{x:t,dx:0,dy:0,text:r||"",fontSize:a.size,font:a.family,fontColor:a.color}}function me(e,t,r,a){var i=e._tickround;var o=r&&e.hoverformat||H.getTickFormat(e);if(a){if(n(i))i=4;else i={y:"m",m:"d",d:"M",M:"S",S:4}[i]}var l=s.formatDate(t.x,o,i,e._dateFormat,e.calendar,e._extraFormat);var u;var c=l.indexOf("\n");if(c!==-1){u=l.substr(c+1);l=l.substr(0,c)}if(a){if(l==="00:00:00"||l==="00:00"){l=u;u=""}else if(l.length===8){l=l.replace(/:00$/,"")}}if(u){if(r){if(i==="d")l+=", "+u;else l=u+(l?", "+l:"")}else{if(!e._inCalcTicks||e._prevDateHead!==u){e._prevDateHead=u;l+="<br>"+u}else{var f=Je(e);var h=e._realSide||e.side;if(!f&&h==="top"||f&&h==="bottom"){l+="<br> "}}}}t.text=l}function ge(e,t,r,a,i){var o=e.dtick;var l=t.x;var u=e.tickformat;var c=typeof o==="string"&&o.charAt(0);if(i==="never"){i=""}if(a&&c!=="L"){o="L3";c="L"}if(u||c==="L"){t.text=Ae(Math.pow(10,l),e,i,a)}else if(n(o)||c==="D"&&s.mod(l+.01,1)<.1){var f=Math.round(l);var h=Math.abs(f);var p=e.exponentformat;if(p==="power"||ke(p)&&Me(f)){if(f===0)t.text=1;else if(f===1)t.text="10";else t.text="10<sup>"+(f>1?"":I)+h+"</sup>";t.fontSize*=1.25}else if((p==="e"||p==="E")&&h>2){t.text="1"+p+(f>0?"+":I)+h}else{t.text=Ae(Math.pow(10,l),e,"","fakehover");if(o==="D1"&&e._id.charAt(0)==="y"){t.dy-=t.fontSize/6}}}else if(c==="D"){t.text=String(Math.round(Math.pow(10,s.mod(l,1))));t.fontSize*=.75}else throw"unrecognized dtick "+String(o);if(e.dtick==="D1"){var v=String(t.text).charAt(0);if(v==="0"||v==="1"){if(e._id.charAt(0)==="y"){t.dx-=t.fontSize/4}else{t.dy+=t.fontSize/2;t.dx+=(e.range[1]>e.range[0]?1:-1)*t.fontSize*(l<0?.5:.25)}}}}function ye(e,t){var r=e._categories[Math.round(t.x)];if(r===undefined)r="";t.text=String(r)}function xe(e,t,r){var a=Math.round(t.x);var n=e._categories[a]||[];var i=n[1]===undefined?"":String(n[1]);var o=n[0]===undefined?"":String(n[0]);if(r){t.text=o+" - "+i}else{t.text=i;t.text2=o}}function be(e,t,r,a,n){if(n==="never"){n=""}else if(e.showexponent==="all"&&Math.abs(t.x/e.dtick)<1e-6){n="hide"}t.text=Ae(t.x,e,n,a)}function _e(e,t,r,a,n){if(e.thetaunit==="radians"&&!r){var i=t.x/180;if(i===0){t.text="0"}else{var o=we(i);if(o[1]>=100){t.text=Ae(s.deg2rad(t.x),e,n,a)}else{var l=t.x<0;if(o[1]===1){if(o[0]===1)t.text="π";else t.text=o[0]+"π"}else{t.text=["<sup>",o[0],"</sup>","⁄","<sub>",o[1],"</sub>","π"].join("")}if(l)t.text=I+t.text}}}else{t.text=Ae(t.x,e,n,a)}}function we(e){function t(e,t){return Math.abs(e-t)<=1e-6}function r(e,a){return t(a,0)?e:r(a,e%a)}function a(e){var r=1;while(!t(Math.round(e*r)/r,e)){r*=10}return r}var n=a(e);var i=e*n;var o=Math.abs(r(i,n));return[Math.round(i/o),Math.round(n/o)]}var Te=["f","p","n","μ","m","","k","M","G","T"];function ke(e){return e==="SI"||e==="B"}function Me(e){return e>14||e<-15}function Ae(e,t,r,a){var i=e<0;var o=t._tickround;var l=r||t.exponentformat||"B";var u=t._tickexponent;var c=H.getTickFormat(t);var f=t.separatethousands;if(a){var h={exponentformat:l,minexponent:t.minexponent,dtick:t.showexponent==="none"?t.dtick:n(e)?Math.abs(e)||1:1,range:t.showexponent==="none"?t.range.map(t.r2d):[0,e||1]};ve(h);o=(Number(h._tickround)||0)+4;u=h._tickexponent;if(t.hoverformat)c=t.hoverformat}if(c)return t._numFormat(c)(e).replace(/-/g,I);var p=Math.pow(10,-o)/2;if(l==="none")u=0;e=Math.abs(e);if(e<p){e="0";i=false}else{e+=p;if(u){e*=Math.pow(10,-u);o+=u}if(o===0)e=String(Math.floor(e));else if(o<0){e=String(Math.round(e));e=e.substr(0,e.length+o);for(var v=o;v<0;v++)e+="0"}else{e=String(e);var d=e.indexOf(".")+1;if(d)e=e.substr(0,d+o).replace(/\.?0+$/,"")}e=s.numSeparate(e,t._separators,f)}if(u&&l!=="hide"){if(ke(l)&&Me(u))l="power";var m;if(u<0)m=I+-u;else if(l!=="power")m="+"+u;else m=String(u);if(l==="e"||l==="E"){e+=l+m}else if(l==="power"){e+="×10<sup>"+m+"</sup>"}else if(l==="B"&&u===9){e+="B"}else if(ke(l)){e+=Te[u/3+5]}}if(i)return I+e;return e}H.getTickFormat=function(e){var t;function r(e){return typeof e!=="string"?e:Number(e.replace("M",""))*T}function a(e,t){var r=["L","D"];if(typeof e===typeof t){if(typeof e==="number"){return e-t}else{var a=r.indexOf(e.charAt(0));var n=r.indexOf(t.charAt(0));if(a===n){return Number(e.replace(/(L|D)/g,""))-Number(t.replace(/(L|D)/g,""))}else{return a-n}}}else{return typeof e==="number"?1:-1}}function n(e,t,r){var a=r||function(e){return e};var n=t[0];var i=t[1];return(!n&&typeof n!=="number"||a(n)<=a(e))&&(!i&&typeof i!=="number"||a(i)>=a(e))}function i(e,t){var r=t[0]===null;var n=t[1]===null;var i=a(e,t[0])>=0;var o=a(e,t[1])<=0;return(r||i)&&(n||o)}var o,s;if(e.tickformatstops&&e.tickformatstops.length>0){switch(e.type){case"date":case"linear":{for(t=0;t<e.tickformatstops.length;t++){s=e.tickformatstops[t];if(s.enabled&&n(e.dtick,s.dtickrange,r)){o=s;break}}break}case"log":{for(t=0;t<e.tickformatstops.length;t++){s=e.tickformatstops[t];if(s.enabled&&i(e.dtick,s.dtickrange)){o=s;break}}break}default:}}return o?o.value:e.tickformat};H.getSubplots=function(e,t){var r=e._fullLayout._subplots;var a=r.cartesian.concat(r.gl2d||[]);var n=t?H.findSubplotsWithAxis(a,t):a;n.sort((function(e,t){var r=e.substr(1).split("y");var a=t.substr(1).split("y");if(r[0]===a[0])return+r[1]-+a[1];return+r[0]-+a[0]}));return n};H.findSubplotsWithAxis=function(e,t){var r=new RegExp(t._id.charAt(0)==="x"?"^"+t._id+"y":t._id+"$");var a=[];for(var n=0;n<e.length;n++){var i=e[n];if(r.test(i))a.push(i)}return a};H.makeClipPaths=function(e){var t=e._fullLayout;if(t._hasOnlyLargeSploms)return;var r={_offset:0,_length:t.width,_id:""};var n={_offset:0,_length:t.height,_id:""};var i=H.list(e,"x",true);var o=H.list(e,"y",true);var s=[];var l,u;for(l=0;l<i.length;l++){s.push({x:i[l],y:n});for(u=0;u<o.length;u++){if(l===0)s.push({x:r,y:o[u]});s.push({x:i[l],y:o[u]})}}var c=t._clips.selectAll(".axesclip").data(s,(function(e){return e.x._id+e.y._id}));c.enter().append("clipPath").classed("axesclip",true).attr("id",(function(e){return"clip"+t._uid+e.x._id+e.y._id})).append("rect");c.exit().remove();c.each((function(e){a.select(this).select("rect").attr({x:e.x._offset||0,y:e.y._offset||0,width:e.x._length||1,height:e.y._length||1})}))};H.draw=function(e,t,r){var a=e._fullLayout;if(t==="redraw"){a._paper.selectAll("g.subplot").each((function(e){var t=e[0];var r=a._plots[t];if(r){var n=r.xaxis;var i=r.yaxis;r.xaxislayer.selectAll("."+n._id+"tick").remove();r.yaxislayer.selectAll("."+i._id+"tick").remove();r.xaxislayer.selectAll("."+n._id+"tick2").remove();r.yaxislayer.selectAll("."+i._id+"tick2").remove();r.xaxislayer.selectAll("."+n._id+"divider").remove();r.yaxislayer.selectAll("."+i._id+"divider").remove();if(r.gridlayer)r.gridlayer.selectAll("path").remove();if(r.zerolinelayer)r.zerolinelayer.selectAll("path").remove();a._infolayer.select(".g-"+n._id+"title").remove();a._infolayer.select(".g-"+i._id+"title").remove()}}))}var n=!t||t==="redraw"?H.listIds(e):t;return s.syncOrAsync(n.map((function(t){return function(){if(!t)return;var a=H.getFromId(e,t);var n=H.drawOne(e,a,r);a._r=a.range.slice();a._rl=s.simpleMap(a._r,a.r2l);return n}})))};H.drawOne=function(e,t,r){r=r||{};var a,n,l;t.setScale();var u=e._fullLayout;var c=t._id;var f=c.charAt(0);var h=H.counterLetter(c);var p=u._plots[t._mainSubplot];if(!p)return;var v=p[f+"axislayer"];var d=t._mainLinePosition;var m=t._mainMirrorPosition;var g=t._vals=H.calcTicks(t);var y=[t.mirror,d,m].join("_");for(a=0;a<g.length;a++){g[a].axInfo=y}t._selections={};if(t._tickAngles)t._prevTickAngles=t._tickAngles;t._tickAngles={};t._depth=null;var x={};function b(e){var r=c+(e||"tick");if(!x[r])x[r]=Ce(t,r);return x[r]}if(!t.visible)return;var _=H.makeTransTickFn(t);var w=H.makeTransTickLabelFn(t);var T;var k;var M=t.ticks==="inside";var A=t.ticks==="outside";if(t.tickson==="boundaries"){var S=Se(t,g);k=H.clipEnds(t,S);T=M?k:S}else{k=H.clipEnds(t,g);T=M&&t.ticklabelmode!=="period"?k:g}var E=t._gridVals=k;var L=Le(t,g);if(!u._hasOnlyLargeSploms){var C=t._subplotsWith;var I={};for(a=0;a<C.length;a++){n=C[a];l=u._plots[n];var P=l[h+"axis"];var O=P._mainAxis._id;if(I[O])continue;I[O]=1;var z=f==="x"?"M0,"+P._offset+"v"+P._length:"M"+P._offset+",0h"+P._length;H.drawGrid(e,t,{vals:E,counterAxis:P,layer:l.gridlayer.select("."+c),path:z,transFn:_});H.drawZeroLine(e,t,{counterAxis:P,layer:l.zerolinelayer,path:z,transFn:_})}}var D=H.getTickSigns(t);var R=[];if(t.ticks){var F=H.makeTickPath(t,d,D[2]);var B;var N;if(t._anchorAxis&&t.mirror&&t.mirror!==true){B=H.makeTickPath(t,m,D[3]);N=F+B}else{B="";N=F}var V;if(t.showdividers&&A&&t.tickson==="boundaries"){var q={};for(a=0;a<L.length;a++){q[L[a].x]=1}V=function(e){return q[e.x]?B:N}}else{V=N}H.drawTicks(e,t,{vals:T,layer:v,path:V,transFn:_});if(t.mirror==="allticks"){R=Object.keys(t._linepositions||{})}}for(a=0;a<R.length;a++){n=R[a];l=u._plots[n];var G=t._linepositions[n]||[];var Y=H.makeTickPath(t,G[0],D[0])+H.makeTickPath(t,G[1],D[1]);H.drawTicks(e,t,{vals:T,layer:l[f+"axislayer"],path:Y,transFn:_})}var W=[];W.push((function(){return H.drawLabels(e,t,{vals:g,layer:v,plotinfo:l,transFn:w,labelFns:H.makeLabelFns(t,d)})}));if(t.type==="multicategory"){var X={x:2,y:10}[f];W.push((function(){var r={x:"height",y:"width"}[f];var a=b()[r]+X+(t._tickAngles[c+"tick"]?t.tickfont.size*j:0);return H.drawLabels(e,t,{vals:Ee(t,g),layer:v,cls:c+"tick2",repositionOnUpdate:true,secondary:true,transFn:_,labelFns:H.makeLabelFns(t,d+a*D[4])})}));W.push((function(){t._depth=D[4]*(b("tick2")[t.side]-d);return ze(e,t,{vals:L,layer:v,path:H.makeTickPath(t,d,D[4],t._depth),transFn:_})}))}else if(t.title.hasOwnProperty("standoff")){W.push((function(){t._depth=D[4]*(b()[t.side]-d)}))}var Z=o.getComponentMethod("rangeslider","isVisible")(t);W.push((function(){var r=t.side.charAt(0);var a=U[t.side].charAt(0);var n=H.getPxPosition(e,t);var s=A?t.ticklen:0;var l;var c;var p;var v;if(t.automargin||Z){if(t.type==="multicategory"){l=b("tick2")}else{l=b();if(f==="x"&&r==="b"){t._depth=Math.max(l.width>0?l.bottom-n:0,s)}}}if(t.automargin){c={x:0,y:0,r:0,l:0,t:0,b:0};var d=[0,1];if(f==="x"){if(r==="b"){c[r]=t._depth}else{c[r]=t._depth=Math.max(l.width>0?n-l.top:0,s);d.reverse()}if(l.width>0){var m=l.right-(t._offset+t._length);if(m>0){c.xr=1;c.r=m}var g=t._offset-l.left;if(g>0){c.xl=0;c.l=g}}}else{if(r==="l"){c[r]=t._depth=Math.max(l.height>0?n-l.left:0,s)}else{c[r]=t._depth=Math.max(l.height>0?l.right-n:0,s);d.reverse()}if(l.height>0){var y=l.bottom-(t._offset+t._length);if(y>0){c.yb=0;c.b=y}var x=t._offset-l.top;if(x>0){c.yt=1;c.t=x}}}c[h]=t.anchor==="free"?t.position:t._anchorAxis.domain[d[0]];if(t.title.text!==u._dfltTitle[f]){c[r]+=De(t)+(t.title.standoff||0)}if(t.mirror&&t.anchor!=="free"){p={x:0,y:0,r:0,l:0,t:0,b:0};p[a]=t.linewidth;if(t.mirror&&t.mirror!==true)p[a]+=s;if(t.mirror===true||t.mirror==="ticks"){p[h]=t._anchorAxis.domain[d[1]]}else if(t.mirror==="all"||t.mirror==="allticks"){p[h]=[t._counterDomainMin,t._counterDomainMax][d[1]]}}}if(Z){v=o.getComponentMethod("rangeslider","autoMarginOpts")(e,t)}i.autoMargin(e,Ue(t),c);i.autoMargin(e,Ve(t),p);i.autoMargin(e,He(t),v)}));if(!r.skipTitle&&!(Z&&t.side==="bottom")){W.push((function(){return Re(e,t)}))}return s.syncOrAsync(W)};function Se(e,t){var r=[];var a;var n=function(e,t){var a=e.xbnd[t];if(a!==null){r.push(s.extendFlat({},e,{x:a}))}};if(t.length){for(a=0;a<t.length;a++){n(t[a],0)}n(t[a-1],1)}return r}function Ee(e,t){var r=[];var a={};for(var n=0;n<t.length;n++){var i=t[n];if(a[i.text2]){a[i.text2].push(i.x)}else{a[i.text2]=[i.x]}}for(var o in a){r.push(de(e,s.interp(a[o],.5),o))}return r}function Le(e,t){var r=[];var a,n;var i=t.length&&t[t.length-1].x<t[0].x;var o=function(e,t){var a=e.xbnd[t];if(a!==null){r.push(s.extendFlat({},e,{x:a}))}};if(e.showdividers&&t.length){for(a=0;a<t.length;a++){var l=t[a];if(l.text2!==n){o(l,i?1:0)}n=l.text2}o(t[a-1],i?0:1)}return r}function Ce(e,t){var r,a;var n,i;if(e._selections[t].size()){r=Infinity;a=-Infinity;n=Infinity;i=-Infinity;e._selections[t].each((function(){var e=je(this);var t=h.bBox(e.node().parentNode);r=Math.min(r,t.top);a=Math.max(a,t.bottom);n=Math.min(n,t.left);i=Math.max(i,t.right)}))}else{r=0;a=0;n=0;i=0}return{top:r,bottom:a,left:n,right:i,height:a-r,width:i-n}}H.getTickSigns=function(e){var t=e._id.charAt(0);var r={x:"top",y:"right"}[t];var a=e.side===r?1:-1;var n=[-1,1,a,-a];if(e.ticks!=="inside"===(t==="x")){n=n.map((function(e){return-e}))}if(e.side){n.push({l:-1,t:-1,r:1,b:1}[e.side.charAt(0)])}return n};H.makeTransTickFn=function(e){return e._id.charAt(0)==="x"?function(t){return l(e._offset+e.l2p(t.x),0)}:function(t){return l(0,e._offset+e.l2p(t.x))}};H.makeTransTickLabelFn=function(e){var t=Pe(e);var r=t[0];var a=t[1];return e._id.charAt(0)==="x"?function(t){return l(r+e._offset+e.l2p(Ie(t)),a)}:function(t){return l(a,r+e._offset+e.l2p(Ie(t)))}};function Ie(e){return e.periodX!==undefined?e.periodX:e.x}function Pe(e){var t=e.ticklabelposition||"";var r=function(e){return t.indexOf(e)!==-1};var a=r("top");var n=r("left");var i=r("right");var o=r("bottom");var s=r("inside");var l=o||n||a||i;if(!l&&!s)return[0,0];var u=e.side;var c=l?(e.tickwidth||0)/2:0;var f=V;var h=e.tickfont?e.tickfont.size:12;if(o||a){c+=h*N;f+=(e.linewidth||0)/2}if(n||i){c+=(e.linewidth||0)/2;f+=V}if(s&&u==="top"){f-=h*(1-N)}if(n||a)c=-c;if(u==="bottom"||u==="right")f=-f;return[l?c:0,s?f:0]}H.makeTickPath=function(e,t,r,a){a=a!==undefined?a:e.ticklen;var n=e._id.charAt(0);var i=(e.linewidth||1)/2;return n==="x"?"M0,"+(t+i*r)+"v"+a*r:"M"+(t+i*r)+",0h"+a*r};H.makeLabelFns=function(e,t,r){var a=e.ticklabelposition||"";var i=function(e){return a.indexOf(e)!==-1};var o=i("top");var l=i("left");var u=i("right");var c=i("bottom");var f=c||l||o||u;var h=i("inside");var p=a==="inside"&&e.ticks==="inside"||!h&&e.ticks==="outside"&&e.tickson!=="boundaries";var v=0;var d=0;var m=p?e.ticklen:0;if(h){m*=-1}else if(f){m=0}if(p){v+=m;if(r){var g=s.deg2rad(r);v=m*Math.cos(g)+1;d=m*Math.sin(g)}}if(e.showticklabels&&(p||e.showline)){v+=.2*e.tickfont.size}v+=(e.linewidth||1)/2*(h?-1:1);var y={labelStandoff:v,labelShift:d};var x,b,_,w;var T=0;var k=e.side;var M=e._id.charAt(0);var A=e.tickangle;var S;if(M==="x"){S=!h&&k==="bottom"||h&&k==="top";w=S?1:-1;if(h)w*=-1;x=d*w;b=t+v*w;_=S?1:-.2;if(Math.abs(A)===90){if(h){_+=B}else{if(A===-90&&k==="bottom"){_=N}else if(A===90&&k==="top"){_=B}else{_=.5}}T=B/2*(A/90)}y.xFn=function(e){return e.dx+x+T*e.fontSize};y.yFn=function(e){return e.dy+b+e.fontSize*_};y.anchorFn=function(e,t){if(f){if(l)return"end";if(u)return"start"}if(!n(t)||t===0||t===180){return"middle"}return t*w<0!==h?"end":"start"};y.heightFn=function(t,r,a){return r<-60||r>60?-.5*a:e.side==="top"!==h?-a:0}}else if(M==="y"){S=!h&&k==="left"||h&&k==="right";w=S?1:-1;if(h)w*=-1;x=v;b=d*w;_=0;if(!h&&Math.abs(A)===90){if(A===-90&&k==="left"||A===90&&k==="right"){_=N}else{_=.5}}if(h){var E=n(A)?+A:0;if(E!==0){var L=s.deg2rad(E);T=Math.abs(Math.sin(L))*N*w;_=0}}y.xFn=function(e){return e.dx+t-(x+e.fontSize*_)*w+T*e.fontSize};y.yFn=function(e){return e.dy+b+e.fontSize*B};y.anchorFn=function(e,t){if(n(t)&&Math.abs(t)===90){return"middle"}return S?"end":"start"};y.heightFn=function(t,r,a){if(e.side==="right")r*=-1;return r<-30?-a:r<30?-.5*a:0}}return y};function Oe(e){return[e.text,e.x,e.axInfo,e.font,e.fontSize,e.fontColor].join("_")}H.drawTicks=function(e,t,r){r=r||{};var a=t._id+"tick";var n=r.vals;if(t.ticklabelmode==="period"){n=n.slice();n.shift()}var i=r.layer.selectAll("path."+a).data(t.ticks?n:[],Oe);i.exit().remove();i.enter().append("path").classed(a,1).classed("ticks",1).classed("crisp",r.crisp!==false).call(f.stroke,t.tickcolor).style("stroke-width",h.crispRound(e,t.tickwidth,1)+"px").attr("d",r.path).style("display",null);Ke(t,[D]);i.attr("transform",r.transFn)};H.drawGrid=function(e,t,r){r=r||{};var a=t._id+"grid";var n=r.vals;var i=r.counterAxis;if(t.showgrid===false){n=[]}else if(i&&H.shouldShowZeroLine(e,t,i)){var o=t.tickmode==="array";for(var s=0;s<n.length;s++){var l=n[s].x;if(o?!l:Math.abs(l)<t.dtick/100){n=n.slice(0,s).concat(n.slice(s+1));if(o)s--;else break}}}var u=r.layer.selectAll("path."+a).data(n,Oe);u.exit().remove();u.enter().append("path").classed(a,1).classed("crisp",r.crisp!==false);t._gw=h.crispRound(e,t.gridwidth,1);u.attr("transform",r.transFn).attr("d",r.path).call(f.stroke,t.gridcolor||"#ddd").style("stroke-width",t._gw+"px").style("display",null);Ke(t,[z]);if(typeof r.path==="function")u.attr("d",r.path)};H.drawZeroLine=function(e,t,r){r=r||r;var a=t._id+"zl";var n=H.shouldShowZeroLine(e,t,r.counterAxis);var i=r.layer.selectAll("path."+a).data(n?[{x:0,id:t._id}]:[]);i.exit().remove();i.enter().append("path").classed(a,1).classed("zl",1).classed("crisp",r.crisp!==false).each((function(){r.layer.selectAll("path").sort((function(e,t){return Y(e.id,t.id)}))}));i.attr("transform",r.transFn).attr("d",r.path).call(f.stroke,t.zerolinecolor||f.defaultLine).style("stroke-width",h.crispRound(e,t.zerolinewidth,t._gw||1)+"px").style("display",null);Ke(t,[O])};H.drawLabels=function(e,t,r){r=r||{};var i=e._fullLayout;var o=t._id;var c=o.charAt(0);var f=r.cls||o+"tick";var p=r.vals;var v=r.labelFns;var d=r.secondary?0:t.tickangle;var m=(t._prevTickAngles||{})[f];var g=r.layer.selectAll("g."+f).data(t.showticklabels?p:[],Oe);var y=[];g.enter().append("g").classed(f,1).append("text").attr("text-anchor","middle").each((function(t){var r=a.select(this);var n=e._promises.length;r.call(u.positionText,v.xFn(t),v.yFn(t)).call(h.font,t.font,t.fontSize,t.fontColor).text(t.text).call(u.convertToTspans,e);if(e._promises[n]){y.push(e._promises.pop().then((function(){x(r,d)})))}else{x(r,d)}}));Ke(t,[R]);g.exit().remove();if(r.repositionOnUpdate){g.each((function(e){a.select(this).select("text").call(u.positionText,v.xFn(e),v.yFn(e))}))}function x(e,i){e.each((function(e){var o=a.select(this);var s=o.select(".text-math-group");var c=v.anchorFn(e,i);var f=r.transFn.call(o.node(),e)+(n(i)&&+i!==0?" rotate("+i+","+v.xFn(e)+","+(v.yFn(e)-e.fontSize/2)+")":"");var p=u.lineCount(o);var d=j*e.fontSize;var m=v.heightFn(e,n(i)?+i:0,(p-1)*d);if(m){f+=l(0,m)}if(s.empty()){var g=o.select("text");g.attr({transform:f,"text-anchor":c});g.style("opacity",1);if(t._adjustTickLabelsOverflow){t._adjustTickLabelsOverflow()}}else{var y=h.bBox(s.node()).width;var x=y*{end:-.5,start:.5}[c];s.attr("transform",f+l(x,0))}}))}t._adjustTickLabelsOverflow=function(){var r=t.ticklabeloverflow;if(!r||r==="allow")return;var n=r.indexOf("hide")!==-1;var o=t._id.charAt(0)==="x";var l=0;var u=o?e._fullLayout.width:e._fullLayout.height;if(r.indexOf("domain")!==-1){var c=s.simpleMap(t.range,t.r2l);l=t.l2p(c[0])+t._offset;u=t.l2p(c[1])+t._offset}var f=Math.min(l,u);var p=Math.max(l,u);var v=t.side;var d=Infinity;var m=-Infinity;g.each((function(e){var r=a.select(this);var i=r.select(".text-math-group");if(i.empty()){var s=h.bBox(r.node());var l=0;if(o){if(s.right>p)l=1;else if(s.left<f)l=1}else{if(s.bottom>p)l=1;else if(s.top+(t.tickangle?0:e.fontSize/4)<f)l=1}var u=r.select("text");if(l){if(n)u.style("opacity",0)}else{u.style("opacity",1);if(v==="bottom"||v==="right"){d=Math.min(d,o?s.top:s.left)}else{d=-Infinity}if(v==="top"||v==="left"){m=Math.max(m,o?s.bottom:s.right)}else{m=Infinity}}}}));for(var y in i._plots){var x=i._plots[y];if(t._id!==x.xaxis._id&&t._id!==x.yaxis._id)continue;var b=o?x.yaxis:x.xaxis;if(b){b["_visibleLabelMin_"+t._id]=d;b["_visibleLabelMax_"+t._id]=m}}};t._hideCounterAxisInsideTickLabels=function(e){var r=t._id.charAt(0)==="x";var n=[];for(var o in i._plots){var s=i._plots[o];if(t._id!==s.xaxis._id&&t._id!==s.yaxis._id)continue;n.push(r?s.yaxis:s.xaxis)}n.forEach((function(r,n){if(r&&Je(r)){(e||[O,z,D,R]).forEach((function(e){var o=e.K==="tick"&&e.L==="text"&&t.ticklabelmode==="period";var s=i._plots[t._mainSubplot];var l;if(e.K===O.K)l=s.zerolinelayer.selectAll("."+t._id+"zl");else if(e.K===z.K)l=s.gridlayer.selectAll("."+t._id);else l=s[t._id.charAt(0)+"axislayer"];l.each((function(){var i=a.select(this);if(e.L)i=i.selectAll(e.L);i.each((function(i){var s=t.l2p(o?Ie(i):i.x)+t._offset;var l=a.select(this);if(s<t["_visibleLabelMax_"+r._id]&&s>t["_visibleLabelMin_"+r._id]){l.style("display","none")}else if(e.K==="tick"&&!n){l.style("display",null)}}))}))}))}}))};x(g,m+1?m:d);function b(){return y.length&&Promise.all(y)}var _=null;function w(){x(g,d);if(p.length&&c==="x"&&!n(d)&&(t.type!=="log"||String(t.dtick).charAt(0)!=="D")){_=0;var e=0;var a=[];var i;g.each((function(r){e=Math.max(e,r.fontSize);var n=t.l2p(r.x);var i=je(this);var o=h.bBox(i.node());a.push({top:0,bottom:10,height:10,left:n-o.width/2,right:n+o.width/2+2,width:o.width+2})}));if((t.tickson==="boundaries"||t.showdividers)&&!r.secondary){var o=2;if(t.ticks)o+=t.tickwidth/2;for(i=0;i<a.length;i++){var l=p[i].xbnd;var u=a[i];if(l[0]!==null&&u.left-t.l2p(l[0])<o||l[1]!==null&&t.l2p(l[1])-u.right<o){_=90;break}}}else{var f=p.length;var v=Math.abs((p[f-1].x-p[0].x)*t._m)/(f-1);var m=t.ticklabelposition||"";var y=function(e){return m.indexOf(e)!==-1};var b=y("top");var w=y("left");var T=y("right");var k=y("bottom");var M=k||w||b||T;var A=!M?0:(t.tickwidth||0)+2*V;var S=v<e*2.5||t.type==="multicategory";for(i=0;i<a.length-1;i++){if(s.bBoxIntersect(a[i],a[i+1],A)){_=S?90:30;break}}}if(_){x(g,_)}}}if(t._selections){t._selections[f]=g}var T=[b];if(t.automargin&&i._redrawFromAutoMarginCount&&m===90){_=90;T.push((function(){x(g,m)}))}else{T.push(w)}if(t._tickAngles){T.push((function(){t._tickAngles[f]=_===null?n(d)?d:0:_}))}var k=t._anchorAxis;if(k&&k.autorange&&Je(t)&&!W(i,t._id)){if(!i._insideTickLabelsAutorange){i._insideTickLabelsAutorange={}}i._insideTickLabelsAutorange[k._name+".autorange"]=k.autorange;T.push((function e(){g.each((function(e,r){var a=je(this);var n=a.select(".text-math-group");if(n.empty()){t._vals[r].bb=h.bBox(a.node())}}))}))}var M=s.syncOrAsync(T);if(M&&M.then)e._promises.push(M);return M};function ze(e,t,r){var a=t._id+"divider";var n=r.vals;var i=r.layer.selectAll("path."+a).data(n,Oe);i.exit().remove();i.enter().insert("path",":first-child").classed(a,1).classed("crisp",1).call(f.stroke,t.dividercolor).style("stroke-width",h.crispRound(e,t.dividerwidth,1)+"px");i.attr("transform",r.transFn).attr("d",r.path)}H.getPxPosition=function(e,t){var r=e._fullLayout._size;var a=t._id.charAt(0);var n=t.side;var i;if(t.anchor!=="free"){i=t._anchorAxis}else if(a==="x"){i={_offset:r.t+(1-(t.position||0))*r.h,_length:0}}else if(a==="y"){i={_offset:r.l+(t.position||0)*r.w,_length:0}}if(n==="top"||n==="left"){return i._offset}else if(n==="bottom"||n==="right"){return i._offset+i._length}};function De(e){var t=e.title.font.size;var r=(e.title.text.match(u.BR_TAG_ALL)||[]).length;if(e.title.hasOwnProperty("standoff")){return r?t*(N+r*j):t*N}else{return r?t*(r+1)*j:t}}function Re(e,t){var r=e._fullLayout;var a=t._id;var n=a.charAt(0);var i=t.title.font.size;var o;if(t.title.hasOwnProperty("standoff")){o=t._depth+t.title.standoff+De(t)}else{var s=Je(t);if(t.type==="multicategory"){o=t._depth}else{var l=1.5*i;if(s){l=.5*i;if(t.ticks==="outside"){l+=t.ticklen}}o=10+l+(t.linewidth?t.linewidth-1:0)}if(!s){if(n==="x"){o+=t.side==="top"?i*(t.showticklabels?1:0):i*(t.showticklabels?1.5:.5)}else{o+=t.side==="right"?i*(t.showticklabels?1:.5):i*(t.showticklabels?.5:0)}}}var u=H.getPxPosition(e,t);var f,p,v;if(n==="x"){p=t._offset+t._length/2;v=t.side==="top"?u-o:u+o}else{v=t._offset+t._length/2;p=t.side==="right"?u+o:u-o;f={rotate:"-90",offset:0}}var d;if(t.type!=="multicategory"){var m=t._selections[t._id+"tick"];d={selection:m,side:t.side};if(m&&m.node()&&m.node().parentNode){var g=h.getTranslate(m.node().parentNode);d.offsetLeft=g.x;d.offsetTop=g.y}if(t.title.hasOwnProperty("standoff")){d.pad=0}}return c.draw(e,a+"title",{propContainer:t,propName:t._name+".title.text",placeholder:r._dfltTitle[n],avoid:d,transform:f,attributes:{x:p,y:v,"text-anchor":"middle"}})}H.shouldShowZeroLine=function(e,t,r){var a=s.simpleMap(t.range,t.r2l);return a[0]*a[1]<=0&&t.zeroline&&(t.type==="linear"||t.type==="-")&&!(t.rangebreaks&&t.maskBreaks(0)===P)&&(Fe(t,0)||!Be(e,t,r,a)||Ne(e,t))};H.clipEnds=function(e,t){return t.filter((function(t){return Fe(e,t.x)}))};function Fe(e,t){var r=e.l2p(t);return r>1&&r<e._length-1}function Be(e,t,r,a){var n=r._mainAxis;if(!n)return;var i=e._fullLayout;var o=t._id.charAt(0);var s=H.counterLetter(t._id);var l=t._offset+(Math.abs(a[0])<Math.abs(a[1])===(o==="x")?0:t._length);function u(e){if(!e.showline||!e.linewidth)return false;var r=Math.max((e.linewidth+t.zerolinewidth)/2,1);function a(e){return typeof e==="number"&&Math.abs(e-l)<r}if(a(e._mainLinePosition)||a(e._mainMirrorPosition)){return true}var n=e._linepositions||{};for(var i in n){if(a(n[i][0])||a(n[i][1])){return true}}}var c=i._plots[r._mainSubplot];if(!(c.mainplotinfo||c).overlays.length){return u(r,l)}var f=H.list(e,s);for(var h=0;h<f.length;h++){var p=f[h];if(p._mainAxis===n&&u(p,l)){return true}}}function Ne(e,t){var r=e._fullData;var a=t._mainSubplot;var n=t._id.charAt(0);for(var i=0;i<r.length;i++){var s=r[i];if(s.visible===true&&s.xaxis+s.yaxis===a){if(o.traceIs(s,"bar-like")&&s.orientation==={x:"h",y:"v"}[n])return true;if(s.fill&&s.fill.charAt(s.fill.length-1)===n)return true}}return false}function je(e){var t=a.select(e);var r=t.select(".text-math-group");return r.empty()?t.select("text"):r}H.allowAutoMargin=function(e){var t=H.list(e,"",true);for(var r=0;r<t.length;r++){var a=t[r];if(a.automargin){i.allowAutoMargin(e,Ue(a));if(a.mirror){i.allowAutoMargin(e,Ve(a))}}if(o.getComponentMethod("rangeslider","isVisible")(a)){i.allowAutoMargin(e,He(a))}}};function Ue(e){return e._id+".automargin"}function Ve(e){return Ue(e)+".mirror"}function He(e){return e._id+".rangeslider"}H.swap=function(e,t){var r=qe(e,t);for(var a=0;a<r.length;a++){Ye(e,r[a].x,r[a].y)}};function qe(e,t){var r=[];var a,n;for(a=0;a<t.length;a++){var i=[];var o=e._fullData[t[a]].xaxis;var s=e._fullData[t[a]].yaxis;if(!o||!s)continue;for(n=0;n<r.length;n++){if(r[n].x.indexOf(o)!==-1||r[n].y.indexOf(s)!==-1){i.push(n)}}if(!i.length){r.push({x:[o],y:[s]});continue}var l=r[i[0]];var u;if(i.length>1){for(n=1;n<i.length;n++){u=r[i[n]];Ge(l.x,u.x);Ge(l.y,u.y)}}Ge(l.x,[o]);Ge(l.y,[s])}return r}function Ge(e,t){for(var r=0;r<t.length;r++){if(e.indexOf(t[r])===-1)e.push(t[r])}}function Ye(e,t,r){var a=[];var n=[];var i=e.layout;var o,l;for(o=0;o<t.length;o++)a.push(H.getFromId(e,t[o]));for(o=0;o<r.length;o++)n.push(H.getFromId(e,r[o]));var u=Object.keys(p);var c=["anchor","domain","overlaying","position","side","tickangle","editType"];var f=["linear","log"];for(o=0;o<u.length;o++){var h=u[o];var v=a[0][h];var d=n[0][h];var m=true;var g=false;var y=false;if(h.charAt(0)==="_"||typeof v==="function"||c.indexOf(h)!==-1){continue}for(l=1;l<a.length&&m;l++){var x=a[l][h];if(h==="type"&&f.indexOf(v)!==-1&&f.indexOf(x)!==-1&&v!==x){g=true}else if(x!==v)m=false}for(l=1;l<n.length&&m;l++){var b=n[l][h];if(h==="type"&&f.indexOf(d)!==-1&&f.indexOf(b)!==-1&&d!==b){y=true}else if(n[l][h]!==d)m=false}if(m){if(g)i[a[0]._name].type="linear";if(y)i[n[0]._name].type="linear";We(i,h,a,n,e._fullLayout._dfltTitle)}}for(o=0;o<e._fullLayout.annotations.length;o++){var _=e._fullLayout.annotations[o];if(t.indexOf(_.xref)!==-1&&r.indexOf(_.yref)!==-1){s.swapAttrs(i.annotations[o],["?"])}}}function We(e,t,r,a,n){var i=s.nestedProperty;var o=i(e[r[0]._name],t).get();var l=i(e[a[0]._name],t).get();var u;if(t==="title"){if(o&&o.text===n.x){o.text=n.y}if(l&&l.text===n.y){l.text=n.x}}for(u=0;u<r.length;u++){i(e,r[u]._name+"."+t).set(l)}for(u=0;u<a.length;u++){i(e,a[u]._name+"."+t).set(o)}}function Xe(e){return e._id==="angularaxis"}function Ze(e,t){var r=t._rangebreaks.length;for(var a=0;a<r;a++){var n=t._rangebreaks[a];if(e>=n.min&&e<n.max){return n.max}}return e}function Je(e){return(e.ticklabelposition||"").indexOf("inside")!==-1}function Ke(e,t){if(Je(e._anchorAxis||{})){if(e._hideCounterAxisInsideTickLabels){e._hideCounterAxisInsideTickLabels(t)}}}},{"../../components/color":650,"../../components/drawing":672,"../../components/titles":748,"../../constants/alignment":755,"../../constants/numerical":763,"../../lib":787,"../../lib/svg_text_utils":813,"../../plots/plots":901,"../../registry":915,"./autorange":837,"./axis_autotype":839,"./axis_ids":842,"./clean_ticks":844,"./layout_attributes":853,"./set_convert":859,"@plotly/d3":58,"fast-isnumeric":246}],839:[function(e,t,r){"use strict";var a=e("fast-isnumeric");var n=e("../../lib");var i=e("../../constants/numerical").BADNUM;var o=n.isArrayOrTypedArray;var s=n.isDateTime;var l=n.cleanNumber;var u=Math.round;t.exports=function e(t,r,a){var n=t;var i=a.noMultiCategory;if(o(n)&&!n.length)return"-";if(!i&&d(n))return"multicategory";if(i&&Array.isArray(n[0])){var s=[];for(var l=0;l<n.length;l++){if(o(n[l])){for(var u=0;u<n[l].length;u++){s.push(n[l][u])}}}n=s}if(h(n,r))return"date";var c=a.autotypenumbers!=="strict";if(v(n,c))return"category";if(f(n,c))return"linear";return"-"};function c(e,t){return t?a(e):typeof e==="number"}function f(e,t){var r=e.length;for(var a=0;a<r;a++){if(c(e[a],t))return true}return false}function h(e,t){var r=e.length;var n=p(r);var i=0;var o=0;var l={};for(var c=0;c<r;c+=n){var f=u(c);var h=e[f];var v=String(h);if(l[v])continue;l[v]=1;if(s(h,t))i++;if(a(h))o++}return i>o*2}function p(e){return Math.max(1,(e-1)/1e3)}function v(e,t){var r=e.length;var a=p(r);var n=0;var o=0;var s={};for(var c=0;c<r;c+=a){var f=u(c);var h=e[f];var v=String(h);if(s[v])continue;s[v]=1;var d=typeof h;if(d==="boolean")o++;else if(t?l(h)!==i:d==="number")n++;else if(d==="string")o++}return o>n*2}function d(e){return o(e[0])&&o(e[1])}},{"../../constants/numerical":763,"../../lib":787,"fast-isnumeric":246}],840:[function(e,t,r){"use strict";var a=e("fast-isnumeric");var n=e("../../registry");var i=e("../../lib");var o=e("../array_container_defaults");var s=e("./layout_attributes");var l=e("./tick_value_defaults");var u=e("./tick_mark_defaults");var c=e("./tick_label_defaults");var f=e("./category_order_defaults");var h=e("./line_grid_defaults");var p=e("./set_convert");var v=e("./constants").WEEKDAY_PATTERN;var d=e("./constants").HOUR_PATTERN;t.exports=function e(t,r,a,d,g){var y=d.letter;var x=d.font||{};var b=d.splomStash||{};var _=a("visible",!d.visibleDflt);var w=r._template||{};var T=r.type||w.type||"-";var k;if(T==="date"){var M=n.getComponentMethod("calendars","handleDefaults");M(t,r,"calendar",d.calendar);if(!d.noTicklabelmode){k=a("ticklabelmode")}}var A="";if(!d.noTicklabelposition||T==="multicategory"){A=i.coerce(t,r,{ticklabelposition:{valType:"enumerated",dflt:"outside",values:k==="period"?["outside","inside"]:y==="x"?["outside","inside","outside left","inside left","outside right","inside right"]:["outside","inside","outside top","inside top","outside bottom","inside bottom"]}},"ticklabelposition")}if(!d.noTicklabeloverflow){a("ticklabeloverflow",A.indexOf("inside")!==-1?"hide past domain":T==="category"||T==="multicategory"?"allow":"hide past div")}p(r,g);var S=!r.isValidRange(t.range);if(S&&d.reverseDflt)S="reversed";var E=a("autorange",S);if(E&&(T==="linear"||T==="-"))a("rangemode");a("range");r.cleanRange();f(t,r,a,d);if(T!=="category"&&!d.noHover)a("hoverformat");var L=a("color");var C=L!==s.color.dflt?L:x.color;var I=b.label||g._dfltTitle[y];c(t,r,a,T,d,{pass:1});if(!_)return r;a("title.text",I);i.coerceFont(a,"title.font",{family:x.family,size:i.bigFont(x.size),color:C});l(t,r,a,T);c(t,r,a,T,d,{pass:2});u(t,r,a,d);h(t,r,a,{dfltColor:L,bgColor:d.bgColor,showGrid:d.showGrid,attributes:s});if(r.showline||r.ticks)a("mirror");if(d.automargin)a("automargin");var P=T==="multicategory";if(!d.noTickson&&(T==="category"||P)&&(r.ticks||r.showgrid)){var O;if(P)O="boundaries";var z=a("tickson",O);if(z==="boundaries"){delete r.ticklabelposition}}if(P){var D=a("showdividers");if(D){a("dividercolor");a("dividerwidth")}}if(T==="date"){o(t,r,{name:"rangebreaks",inclusionAttr:"enabled",handleItemDefaults:m});if(!r.rangebreaks.length){delete r.rangebreaks}else{for(var R=0;R<r.rangebreaks.length;R++){if(r.rangebreaks[R].pattern===v){r._hasDayOfWeekBreaks=true;break}}p(r,g);if(g._has("scattergl")||g._has("splom")){for(var F=0;F<d.data.length;F++){var B=d.data[F];if(B.type==="scattergl"||B.type==="splom"){B.visible=false;i.warn(B.type+" traces do not work on axes with rangebreaks."+" Setting trace "+B.index+" to `visible: false`.")}}}}}return r};function m(e,t,r){function n(r,a){return i.coerce(e,t,s.rangebreaks,r,a)}var o=n("enabled");if(o){var l=n("bounds");if(l&&l.length>=2){var u="";var c,f;if(l.length===2){for(c=0;c<2;c++){f=y(l[c]);if(f){u=v;break}}}var h=n("pattern",u);if(h===v){for(c=0;c<2;c++){f=y(l[c]);if(f){t.bounds[c]=l[c]=f-1}}}if(h){for(c=0;c<2;c++){f=l[c];switch(h){case v:if(!a(f)){t.enabled=false;return}f=+f;if(f!==Math.floor(f)||f<0||f>=7){t.enabled=false;return}t.bounds[c]=l[c]=f;break;case d:if(!a(f)){t.enabled=false;return}f=+f;if(f<0||f>24){t.enabled=false;return}t.bounds[c]=l[c]=f;break}}}if(r.autorange===false){var p=r.range;if(p[0]<p[1]){if(l[0]<p[0]&&l[1]>p[1]){t.enabled=false;return}}else if(l[0]>p[0]&&l[1]<p[1]){t.enabled=false;return}}}else{var m=n("values");if(m&&m.length){n("dvalue")}else{t.enabled=false;return}}}}var g={sun:1,mon:2,tue:3,wed:4,thu:5,fri:6,sat:7};function y(e){if(typeof e!=="string")return;return g[e.substr(0,3).toLowerCase()]}},{"../../lib":787,"../../registry":915,"../array_container_defaults":833,"./category_order_defaults":843,"./constants":845,"./layout_attributes":853,"./line_grid_defaults":855,"./set_convert":859,"./tick_label_defaults":860,"./tick_mark_defaults":861,"./tick_value_defaults":862,"fast-isnumeric":246}],841:[function(e,t,r){"use strict";var a=e("../../constants/docs");var n=a.FORMAT_LINK;var i=a.DATE_FORMAT_LINK;function o(e,t){return{valType:"string",dflt:"",editType:"none",description:(t?s:l)("hover text",e)+["By default the values are formatted using "+(t?"generic number format":"`"+e+"axis.hoverformat`")+"."].join(" ")}}function s(e,t){return["Sets the "+e+" formatting rule"+(t?"for `"+t+"` ":""),"using d3 formatting mini-languages","which are very similar to those in Python. For numbers, see: "+n+"."].join(" ")}function l(e,t){return s(e,t)+[" And for dates see: "+i+".","We add two items to d3's date formatter:","*%h* for half of the year as a decimal number as well as","*%{n}f* for fractional seconds","with n digits. For example, *2016-10-13 09:15:23.456* with tickformat","*%H~%M~%S.%2f* would display *09~15~23.46*"].join(" ")}t.exports={axisHoverFormat:o,descriptionOnlyNumbers:s,descriptionWithDates:l}},{"../../constants/docs":758}],842:[function(e,t,r){"use strict";var a=e("../../registry");var n=e("./constants");r.id2name=function e(t){if(typeof t!=="string"||!t.match(n.AX_ID_PATTERN))return;var r=t.split(" ")[0].substr(1);if(r==="1")r="";return t.charAt(0)+"axis"+r};r.name2id=function e(t){if(!t.match(n.AX_NAME_PATTERN))return;var r=t.substr(5);if(r==="1")r="";return t.charAt(0)+r};r.cleanId=function e(t,r,a){var i=/( domain)$/.test(t);if(typeof t!=="string"||!t.match(n.AX_ID_PATTERN))return;if(r&&t.charAt(0)!==r)return;if(i&&!a)return;var o=t.split(" ")[0].substr(1).replace(/^0+/,"");if(o==="1")o="";return t.charAt(0)+o+(i&&a?" domain":"")};r.list=function(e,t,a){var n=e._fullLayout;if(!n)return[];var i=r.listIds(e,t);var o=new Array(i.length);var s;for(s=0;s<i.length;s++){var l=i[s];o[s]=n[l.charAt(0)+"axis"+l.substr(1)]}if(!a){var u=n._subplots.gl3d||[];for(s=0;s<u.length;s++){var c=n[u[s]];if(t)o.push(c[t+"axis"]);else o.push(c.xaxis,c.yaxis,c.zaxis)}}return o};r.listIds=function(e,t){var r=e._fullLayout;if(!r)return[];var a=r._subplots;if(t)return a[t+"axis"];return a.xaxis.concat(a.yaxis)};r.getFromId=function(e,t,a){var n=e._fullLayout;t=t===undefined||typeof t!=="string"?t:t.replace(" domain","");if(a==="x")t=t.replace(/y[0-9]*/,"");else if(a==="y")t=t.replace(/x[0-9]*/,"");return n[r.id2name(t)]};r.getFromTrace=function(e,t,n){var i=e._fullLayout;var o=null;if(a.traceIs(t,"gl3d")){var s=t.scene;if(s.substr(0,5)==="scene"){o=i[s][n+"axis"]}}else{o=r.getFromId(e,t[n+"axis"]||n)}return o};r.idSort=function(e,t){var r=e.charAt(0);var a=t.charAt(0);if(r!==a)return r>a?1:-1;return+(e.substr(1)||1)-+(t.substr(1)||1)};r.ref2id=function(e){return/^[xyz]/.test(e)?e.split(" ")[0]:false};function i(e,t){if(t&&t.length){for(var r=0;r<t.length;r++){if(t[r][e])return true}}return false}r.isLinked=function(e,t){return i(t,e._axisMatchGroups)||i(t,e._axisConstraintGroups)}},{"../../registry":915,"./constants":845}],843:[function(e,t,r){"use strict";function a(e,t){var r=t.dataAttr||e._id.charAt(0);var a={};var n;var i,o;if(t.axData){n=t.axData}else{n=[];for(i=0;i<t.data.length;i++){var s=t.data[i];if(s[r+"axis"]===e._id){n.push(s)}}}for(i=0;i<n.length;i++){var l=n[i][r];for(o=0;o<l.length;o++){var u=l[o];if(u!==null&&u!==undefined){a[u]=1}}}return Object.keys(a)}t.exports=function e(t,r,n,i){if(r.type!=="category")return;var o=t.categoryarray;var s=Array.isArray(o)&&o.length>0;var l;if(s)l="array";var u=n("categoryorder",l);var c;if(u==="array"){c=n("categoryarray")}if(!s&&u==="array"){u=r.categoryorder="trace"}if(u==="trace"){r._initialCategories=[]}else if(u==="array"){r._initialCategories=c.slice()}else{c=a(r,i).sort();if(u==="category ascending"){r._initialCategories=c}else if(u==="category descending"){r._initialCategories=c.reverse()}}}},{}],844:[function(e,t,r){"use strict";var a=e("fast-isnumeric");var n=e("../../lib");var i=e("../../constants/numerical");var o=i.ONEDAY;var s=i.ONEWEEK;r.dtick=function(e,t){var r=t==="log";var n=t==="date";var i=t==="category";var s=n?o:1;if(!e)return s;if(a(e)){e=Number(e);if(e<=0)return s;if(i){return Math.max(1,Math.round(e))}if(n){return Math.max(.1,e)}return e}if(typeof e!=="string"||!(n||r)){return s}var l=e.charAt(0);var u=e.substr(1);u=a(u)?Number(u):0;if(u<=0||!(n&&l==="M"&&u===Math.round(u)||r&&l==="L"||r&&l==="D"&&(u===1||u===2))){return s}return e};r.tick0=function(e,t,r,i){if(t==="date"){return n.cleanDate(e,n.dateTick0(r,i%s===0?1:0))}if(i==="D1"||i==="D2"){return undefined}return a(e)?Number(e):0}},{"../../constants/numerical":763,"../../lib":787,"fast-isnumeric":246}],845:[function(e,t,r){"use strict";var a=e("../../lib/regex").counter;t.exports={idRegex:{x:a("x","( domain)?"),y:a("y","( domain)?")},attrRegex:a("[xy]axis"),xAxisMatch:a("xaxis"),yAxisMatch:a("yaxis"),AX_ID_PATTERN:/^[xyz][0-9]*( domain)?$/,AX_NAME_PATTERN:/^[xyz]axis[0-9]*$/,SUBPLOT_PATTERN:/^x([0-9]*)y([0-9]*)$/,HOUR_PATTERN:"hour",WEEKDAY_PATTERN:"day of week",MINDRAG:8,MINSELECT:12,MINZOOM:20,DRAGGERSIZE:20,BENDPX:1.5,REDRAWDELAY:50,SELECTDELAY:100,SELECTID:"-select",DFLTRANGEX:[-1,6],DFLTRANGEY:[-1,4],traceLayerClasses:["imagelayer","heatmaplayer","contourcarpetlayer","contourlayer","funnellayer","waterfalllayer","barlayer","carpetlayer","violinlayer","boxlayer","ohlclayer","scattercarpetlayer","scatterlayer"],clipOnAxisFalseQuery:[".scatterlayer",".barlayer",".funnellayer",".waterfalllayer"],layerValue2layerClass:{"above traces":"above","below traces":"below"}}},{"../../lib/regex":804}],846:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("./autorange");var i=e("./axis_ids").id2name;var o=e("./layout_attributes");var s=e("./scale_zoom");var l=e("./set_convert");var u=e("../../constants/numerical").ALMOST_EQUAL;var c=e("../../constants/alignment").FROM_BL;r.handleDefaults=function(e,t,r){var n=r.axIds;var o=r.axHasImage;var s=t._axisConstraintGroups=[];var u=t._axisMatchGroups=[];var c,h,p,v,d,m,g,y;for(c=0;c<n.length;c++){v=i(n[c]);d=e[v];m=t[v];f(d,m,{axIds:n,layoutOut:t,hasImage:o[v]})}function x(e,r){for(c=0;c<e.length;c++){h=e[c];for(p in h){t[i(p)][r]=h}}}x(u,"_matchGroup");for(c=0;c<s.length;c++){h=s[c];for(p in h){m=t[i(p)];if(m.fixedrange){for(var b in h){var _=i(b);if((e[_]||{}).fixedrange===false){a.warn("fixedrange was specified as false for axis "+_+" but was overridden because another "+"axis in its constraint group has fixedrange true")}t[_].fixedrange=true}break}}}c=0;while(c<s.length){h=s[c];for(p in h){m=t[i(p)];if(m._matchGroup&&Object.keys(m._matchGroup).length===Object.keys(h).length){s.splice(c,1);c--}break}c++}x(s,"_constraintGroup");var w=["constrain","range","autorange","rangemode","rangebreaks","categoryorder","categoryarray"];var T=false;var k=false;function M(){y=m[g];if(g==="rangebreaks"){k=m._hasDayOfWeekBreaks}}for(c=0;c<u.length;c++){h=u[c];for(var A=0;A<w.length;A++){g=w[A];y=null;var S;for(p in h){v=i(p);d=e[v];m=t[v];if(!(g in m)){continue}if(!m.matches){S=m;if(g in d){M();break}}if(y===null&&g in d){M()}}if(g==="range"&&y){T=true}if(g==="autorange"&&y===null&&T){y=false}if(y===null&&g in S){y=S[g]}if(y!==null){for(p in h){m=t[i(p)];m[g]=g==="range"?y.slice():y;if(g==="rangebreaks"){m._hasDayOfWeekBreaks=k;l(m,t)}}}}}};function f(e,t,r){var n=r.axIds;var s=r.layoutOut;var l=r.hasImage;var u=s._axisConstraintGroups;var c=s._axisMatchGroups;var f=t._id;var d=f.charAt(0);var m=((s._splomAxes||{})[d]||{})[f]||{};var g=t._id;var y=g.charAt(0)==="x";t._matchGroup=null;t._constraintGroup=null;function x(r,n){return a.coerce(e,t,o,r,n)}x("constrain",l?"domain":"range");a.coerce(e,t,{constraintoward:{valType:"enumerated",values:y?["left","center","right"]:["bottom","middle","top"],dflt:y?"center":"middle"}},"constraintoward");var b=t.type;var _,w;var T=[];for(_=0;_<n.length;_++){w=n[_];if(w===g)continue;var k=s[i(w)];if(k.type===b){T.push(w)}}var M=p(u,g);if(M){var A=[];for(_=0;_<T.length;_++){w=T[_];if(!M[w])A.push(w)}T=A}var S=T.length;var E,L;if(S&&(e.matches||m.matches)){E=a.coerce(e,t,{matches:{valType:"enumerated",values:T,dflt:T.indexOf(m.matches)!==-1?m.matches:undefined}},"matches")}var C=l&&!y?t.anchor:undefined;if(S&&!E&&(e.scaleanchor||C)){L=a.coerce(e,t,{scaleanchor:{valType:"enumerated",values:T}},"scaleanchor",C)}if(E){t._matchGroup=v(c,g,E,1);var I=s[i(E)];var P=h(s,t)/h(s,I);if(y!==(E.charAt(0)==="x")){P=(y?"x":"y")+P}v(u,g,E,P)}else if(e.matches&&n.indexOf(e.matches)!==-1){a.warn("ignored "+t._name+'.matches: "'+e.matches+'" to avoid an infinite loop')}if(L){var O=x("scaleratio");if(!O)O=t.scaleratio=1;v(u,g,L,O)}else if(e.scaleanchor&&n.indexOf(e.scaleanchor)!==-1){a.warn("ignored "+t._name+'.scaleanchor: "'+e.scaleanchor+'" to avoid either an infinite loop '+"and possibly inconsistent scaleratios, or because this axis "+"declares a *matches* constraint.")}}function h(e,t){var r=t.domain;if(!r){r=e[i(t.overlaying)].domain}return r[1]-r[0]}function p(e,t){for(var r=0;r<e.length;r++){if(e[r][t]){return e[r]}}return null}function v(e,t,r,a){var n,i,o,s,l;var u=p(e,t);if(u===null){u={};u[t]=1;l=e.length;e.push(u)}else{l=e.indexOf(u)}var c=Object.keys(u);for(n=0;n<e.length;n++){o=e[n];if(n!==l&&o[r]){var f=o[r];for(i=0;i<c.length;i++){s=c[i];o[s]=d(f,d(a,u[s]))}e.splice(l,1);return}}if(a!==1){for(i=0;i<c.length;i++){var h=c[i];u[h]=d(a,u[h])}}u[r]=1}function d(e,t){var r="";var a="";var n,i;if(typeof e==="string"){r=e.match(/^[xy]*/)[0];n=r.length;e=+e.substr(n)}if(typeof t==="string"){a=t.match(/^[xy]*/)[0];i=a.length;t=+t.substr(i)}var o=e*t;if(!n&&!i){return o}if(!n||!i||r.charAt(0)===a.charAt(0)){return r+a+e*t}if(n===i){return o}return(n>i?r.substr(i):a.substr(n))+o}function m(e,t){var r=t._size;var a=r.h/r.w;var n={};var i=Object.keys(e);for(var o=0;o<i.length;o++){var s=i[o];var l=e[s];if(typeof l==="string"){var u=l.match(/^[xy]*/)[0];var c=u.length;l=+l.substr(c);var f=u.charAt(0)==="y"?a:1/a;for(var h=0;h<c;h++){l*=f}}n[s]=l}return n}r.enforce=function e(t){var r=t._fullLayout;var a=r._axisConstraintGroups||[];var o,l,c,f,h,p,v,d;for(o=0;o<a.length;o++){c=m(a[o],r);var y=Object.keys(c);var x=Infinity;var b=0;var _=Infinity;var w={};var T={};var k=false;for(l=0;l<y.length;l++){f=y[l];T[f]=h=r[i(f)];if(h._inputDomain)h.domain=h._inputDomain.slice();else h._inputDomain=h.domain.slice();if(!h._inputRange)h._inputRange=h.range.slice();h.setScale();w[f]=p=Math.abs(h._m)/c[f];x=Math.min(x,p);if(h.constrain==="domain"||!h._constraintShrinkable){_=Math.min(_,p)}delete h._constraintShrinkable;b=Math.max(b,p);if(h.constrain==="domain")k=true}if(x>u*b&&!k)continue;for(l=0;l<y.length;l++){f=y[l];p=w[f];h=T[f];v=h.constrain;if(p!==_||v==="domain"){d=p/_;if(v==="range"){s(h,d)}else{var M=h._inputDomain;var A=(h.domain[1]-h.domain[0])/(M[1]-M[0]);var S=(h.r2l(h.range[1])-h.r2l(h.range[0]))/(h.r2l(h._inputRange[1])-h.r2l(h._inputRange[0]));d/=A;if(d*S<1){h.domain=h._input.domain=M.slice();s(h,d);continue}if(S<1){h.range=h._input.range=h._inputRange.slice();d*=S}if(h.autorange){var E=h.r2l(h.range[0]);var L=h.r2l(h.range[1]);var C=(E+L)/2;var I=C;var P=C;var O=Math.abs(L-C);var z=C-O*d*1.0001;var D=C+O*d*1.0001;var R=n.makePadFn(r,h,0);var F=n.makePadFn(r,h,1);g(h,d);var B=Math.abs(h._m);var N=n.concatExtremes(t,h);var j=N.min;var U=N.max;var V;var H;for(H=0;H<j.length;H++){V=j[H].val-R(j[H])/B;if(V>z&&V<I){I=V}}for(H=0;H<U.length;H++){V=U[H].val+F(U[H])/B;if(V<D&&V>P){P=V}}var q=(P-I)/(2*O);d/=q;I=h.l2r(I);P=h.l2r(P);h.range=h._input.range=E<L?[I,P]:[P,I]}g(h,d)}}}}};r.getAxisGroup=function e(t,r){var a=t._axisMatchGroups;for(var n=0;n<a.length;n++){var i=a[n];if(i[r])return"g"+n}return r};r.clean=function e(t,r){if(r._inputDomain){var a=false;var n=r._id;var i=t._fullLayout._axisConstraintGroups;for(var o=0;o<i.length;o++){if(i[o][n]){a=true;break}}if(!a||r.constrain!=="domain"){r._input.domain=r.domain=r._inputDomain;delete r._inputDomain}}};function g(e,t){var r=e._inputDomain;var a=c[e.constraintoward];var n=r[0]+(r[1]-r[0])*a;e.domain=e._input.domain=[n+(r[0]-n)/t,n+(r[1]-n)/t];e.setScale()}},{"../../constants/alignment":755,"../../constants/numerical":763,"../../lib":787,"./autorange":837,"./axis_ids":842,"./layout_attributes":853,"./scale_zoom":857,"./set_convert":859}],847:[function(e,t,r){"use strict";var a=e("@plotly/d3");var n=e("../../lib");var i=n.numberFormat;var o=e("tinycolor2");var s=e("has-passive-events");var l=e("../../registry");var u=n.strTranslate;var c=e("../../lib/svg_text_utils");var f=e("../../components/color");var h=e("../../components/drawing");var p=e("../../components/fx");var v=e("./axes");var d=e("../../lib/setcursor");var m=e("../../components/dragelement");var g=e("../../components/dragelement/helpers");var y=g.selectingOrDrawing;var x=g.freeMode;var b=e("../../constants/alignment").FROM_TL;var _=e("../../lib/clear_gl_canvases");var w=e("../../plot_api/subroutines").redrawReglTraces;var T=e("../plots");var k=e("./axis_ids").getFromId;var M=e("./select").prepSelect;var A=e("./select").clearSelect;var S=e("./select").selectOnClick;var E=e("./scale_zoom");var L=e("./constants");var C=L.MINDRAG;var I=L.MINZOOM;var P=true;function O(e,t,r,i,s,u,f,d){var g=e._fullLayout._zoomlayer;var P=f+d==="nsew";var O=(f+d).length===1;var z,G;var ee,te;var re,ae;var ne,ie;var oe,se;var le;var ue;var ce,fe;var he;var pe,ve;var de,me,ge;var ye;var xe;var be;function _e(){z=t.xaxis;G=t.yaxis;oe=z._length;se=G._length;ne=z._offset;ie=G._offset;ee={};ee[z._id]=z;te={};te[G._id]=G;if(f&&d){var r=t.overlays;for(var a=0;a<r.length;a++){var n=r[a].xaxis;ee[n._id]=n;var i=r[a].yaxis;te[i._id]=i}}re=$(ee);ae=$(te);ce=R(re,d);fe=R(ae,f);he=!fe&&!ce;ue=K(e,e._fullLayout._axisMatchGroups,ee,te);le=K(e,e._fullLayout._axisConstraintGroups,ee,te,ue);var o=le.isSubplotConstrained||ue.isSubplotConstrained;pe=d||o;ve=f||o;var s=e._fullLayout;de=s._has("scattergl");me=s._has("splom");ge=s._has("svg")}_e();var we=U(fe+ce,e._fullLayout.dragmode,P);var Te=D(t,f+d+"drag",we,r,i,s,u);if(he&&!P){Te.onmousedown=null;Te.style.pointerEvents="none";return Te}var ke={element:Te,gd:e,plotinfo:t};ke.prepFn=function(t,r,a){var n=ke.dragmode;var i=e._fullLayout.dragmode;if(i!==n){ke.dragmode=i}_e();xe=e._fullLayout._invScaleX;be=e._fullLayout._invScaleY;if(!he){if(P){if(t.shiftKey){if(i==="pan")i="zoom";else if(!y(i))i="pan"}else if(t.ctrlKey){i="pan"}}else{i="pan"}}if(x(i))ke.minDrag=1;else ke.minDrag=undefined;if(y(i)){ke.xaxes=re;ke.yaxes=ae;M(t,r,a,ke,i)}else{ke.clickFn=Ae;if(y(n)){Me()}if(!he){if(i==="zoom"){ke.moveFn=Be;ke.doneFn=je;ke.minDrag=1;Fe(t,r,a)}else if(i==="pan"){ke.moveFn=Ye;ke.doneFn=Je}}}e._fullLayout._redrag=function(){var t=e._dragdata;if(t&&t.element===Te){var r=e._fullLayout.dragmode;if(!y(r)){_e();Ke([0,0,oe,se]);ke.moveFn(t.dx,t.dy)}}}};function Me(){ke.plotinfo.selection=false;A(e)}function Ae(e,r){var n=ke.gd;if(n._fullLayout._activeShapeIndex>=0){n._fullLayout._deactivateShape(n);return}var i=n._fullLayout.clickmode;Y(n);if(e===2&&!O)Ze();if(P){if(i.indexOf("select")>-1){S(r,n,re,ae,t.id,ke)}if(i.indexOf("event")>-1){p.click(n,r,t.id)}}else if(e===1&&O){var o=f?G:z;var s=f==="s"||d==="w"?0:1;var u=o._name+".range["+s+"]";var h=F(o,s);var v="left";var m="middle";if(o.fixedrange)return;if(f){m=f==="n"?"top":"bottom";if(o.side==="right")v="right"}else if(d==="e")v="right";if(n._context.showAxisRangeEntryBoxes){a.select(Te).call(c.makeEditable,{gd:n,immediate:true,background:n._fullLayout.paper_bgcolor,text:String(h),fill:o.tickfont?o.tickfont.color:"#444",horizontalAlign:v,verticalAlign:m}).on("edit",(function(e){var t=o.d2r(e);if(t!==undefined){l.call("_guiRelayout",n,u,t)}}))}}}m.init(ke);var Se,Ee;var Le;var Ce;var Ie;var Pe;var Oe;var ze;var De;var Re;function Fe(t,r,a){var i=Te.getBoundingClientRect();Se=r-i.left;Ee=a-i.top;e._fullLayout._calcInverseTransform(e);var s=n.apply3DTransform(e._fullLayout._invTransform)(Se,Ee);Se=s[0];Ee=s[1];Le={l:Se,r:Se,w:0,t:Ee,b:Ee,h:0};Ce=e._hmpixcount?e._hmlumcount/e._hmpixcount:o(e._fullLayout.plot_bgcolor).getLuminance();Ie="M0,0H"+oe+"V"+se+"H0V0";Pe=false;Oe="xy";Re=false;ze=V(g,Ce,ne,ie,Ie);De=H(g,ne,ie)}function Be(t,r){if(e._transitioningWithDuration){return false}var a=Math.max(0,Math.min(oe,xe*t+Se));var n=Math.max(0,Math.min(se,be*r+Ee));var i=Math.abs(a-Se);var o=Math.abs(n-Ee);Le.l=Math.min(Se,a);Le.r=Math.max(Se,a);Le.t=Math.min(Ee,n);Le.b=Math.max(Ee,n);function s(){Oe="";Le.r=Le.l;Le.t=Le.b;De.attr("d","M0,0Z")}if(le.isSubplotConstrained){if(i>I||o>I){Oe="xy";if(i/oe>o/se){o=i*se/oe;if(Ee>n)Le.t=Ee-o;else Le.b=Ee+o}else{i=o*oe/se;if(Se>a)Le.l=Se-i;else Le.r=Se+i}De.attr("d",J(Le))}else{s()}}else if(ue.isSubplotConstrained){if(i>I||o>I){Oe="xy";var l=Math.min(Le.l/oe,(se-Le.b)/se);var u=Math.max(Le.r/oe,(se-Le.t)/se);Le.l=l*oe;Le.r=u*oe;Le.b=(1-l)*se;Le.t=(1-u)*se;De.attr("d",J(Le))}else{s()}}else if(!fe||o<Math.min(Math.max(i*.6,C),I)){if(i<C||!ce){s()}else{Le.t=0;Le.b=se;Oe="x";De.attr("d",X(Le,Ee))}}else if(!ce||i<Math.min(o*.6,I)){Le.l=0;Le.r=oe;Oe="y";De.attr("d",Z(Le,Se))}else{Oe="xy";De.attr("d",J(Le))}Le.w=Le.r-Le.l;Le.h=Le.b-Le.t;if(Oe)Re=true;e._dragged=Re;q(ze,De,Le,Ie,Pe,Ce);Ne();e.emit("plotly_relayouting",ye);Pe=true}function Ne(){ye={};if(Oe==="xy"||Oe==="x"){B(re,Le.l/oe,Le.r/oe,ye,le.xaxes);We("x",ye)}if(Oe==="xy"||Oe==="y"){B(ae,(se-Le.b)/se,(se-Le.t)/se,ye,le.yaxes);We("y",ye)}}function je(){Ne();Y(e);Je();W(e)}var Ue=[0,0,oe,se];var Ve=null;var He=L.REDRAWDELAY;var qe=t.mainplot?e._fullLayout._plots[t.mainplot]:t;function Ge(t){if(!e._context._scrollZoom.cartesian&&!e._fullLayout._enablescrollzoom){return}Me();if(e._transitioningWithDuration){t.preventDefault();t.stopPropagation();return}_e();clearTimeout(Ve);var r=-t.deltaY;if(!isFinite(r))r=t.wheelDelta/10;if(!isFinite(r)){n.log("Did not find wheel motion attributes: ",t);return}var a=Math.exp(-Math.min(Math.max(r,-20),20)/200);var i=qe.draglayer.select(".nsewdrag").node().getBoundingClientRect();var o=(t.clientX-i.left)/i.width;var s=(i.bottom-t.clientY)/i.height;var l;function u(e,t,r){if(e.fixedrange)return;var a=n.simpleMap(e.range,e.r2l);var i=a[0]+(a[1]-a[0])*t;function o(t){return e.l2r(i+(t-i)*r)}e.range=a.map(o)}if(pe){if(!d)o=.5;for(l=0;l<re.length;l++){u(re[l],o,a)}We("x");Ue[2]*=a;Ue[0]+=Ue[2]*o*(1/a-1)}if(ve){if(!f)s=.5;for(l=0;l<ae.length;l++){u(ae[l],s,a)}We("y");Ue[3]*=a;Ue[1]+=Ue[3]*(1-s)*(1/a-1)}Ke(Ue);Xe();e.emit("plotly_relayouting",ye);Ve=setTimeout((function(){if(!e._fullLayout)return;Ue=[0,0,oe,se];Je()}),He);t.preventDefault();return}if(f.length*d.length!==1){Q(Te,Ge)}function Ye(t,r){t=t*xe;r=r*be;if(e._transitioningWithDuration){return}e._fullLayout._replotting=true;if(ce==="ew"||fe==="ns"){var a=ce?-t:0;var n=fe?-r:0;if(ue.isSubplotConstrained){if(ce&&fe){var i=(t/oe-r/se)/2;t=i*oe;r=-i*se;a=-t;n=-r}if(fe){a=-n*oe/se}else{n=-a*se/oe}}if(ce){N(re,t);We("x")}if(fe){N(ae,r);We("y")}Ke([a,n,oe,se]);Xe();e.emit("plotly_relayouting",ye);return}function o(e,t,r){var a=1-t;var n;var i;for(var o=0;o<e.length;o++){var s=e[o];if(s.fixedrange)continue;n=s;i=s._rl[a]+(s._rl[t]-s._rl[a])/j(r/s._length);var l=s.l2r(i);if(l!==false&&l!==undefined)s.range[t]=l}return n._length*(n._rl[t]-i)/(n._rl[t]-n._rl[a])}var s=ce==="w"===(fe==="n")?1:-1;if(ce&&fe&&(le.isSubplotConstrained||ue.isSubplotConstrained)){var l=(t/oe+s*r/se)/2;t=l*oe;r=s*l*se}var u,c;if(ce==="w")t=o(re,0,t);else if(ce==="e")t=o(re,1,-t);else if(!ce)t=0;if(fe==="n")r=o(ae,1,r);else if(fe==="s")r=o(ae,0,-r);else if(!fe)r=0;u=ce==="w"?t:0;c=fe==="n"?r:0;if(le.isSubplotConstrained&&!ue.isSubplotConstrained||ue.isSubplotConstrained&&ce&&fe&&s>0){var f;if(ue.isSubplotConstrained||!ce&&fe.length===1){for(f=0;f<re.length;f++){re[f].range=re[f]._r.slice();E(re[f],1-r/se)}t=r*oe/se;u=t/2}if(ue.isSubplotConstrained||!fe&&ce.length===1){for(f=0;f<ae.length;f++){ae[f].range=ae[f]._r.slice();E(ae[f],1-t/oe)}r=t*se/oe;c=r/2}}if(!ue.isSubplotConstrained||!fe){We("x")}if(!ue.isSubplotConstrained||!ce){We("y")}var h=oe-t;var p=se-r;if(ue.isSubplotConstrained&&!(ce&&fe)){if(ce){c=u?0:t*se/oe;p=h*se/oe}else{u=c?0:r*oe/se;h=p*oe/se}}Ke([u,c,h,p]);Xe();e.emit("plotly_relayouting",ye)}function We(e,t){var r=ue.isSubplotConstrained?{x:ae,y:re}[e]:ue[e+"axes"];var a=ue.isSubplotConstrained?{x:re,y:ae}[e]:[];for(var n=0;n<r.length;n++){var i=r[n];var o=i._id;var s=ue.xLinks[o]||ue.yLinks[o];var l=a[0]||ee[s]||te[s];if(l){if(t){t[i._name+".range[0]"]=t[l._name+".range[0]"];t[i._name+".range[1]"]=t[l._name+".range[1]"]}else{i.range=l.range.slice()}}}}function Xe(){var t=[];var r;function a(e){for(r=0;r<e.length;r++){if(!e[r].fixedrange)t.push(e[r]._id)}}if(pe){a(re);a(le.xaxes);a(ue.xaxes)}if(ve){a(ae);a(le.yaxes);a(ue.yaxes)}ye={};for(r=0;r<t.length;r++){var n=t[r];var i=k(e,n);v.drawOne(e,i,{skipTitle:true});ye[i._name+".range[0]"]=i.range[0];ye[i._name+".range[1]"]=i.range[1]}v.redrawComponents(e,t)}function Ze(){if(e._transitioningWithDuration)return;var t=e._context.doubleClick;var r=[];if(ce)r=r.concat(re);if(fe)r=r.concat(ae);if(ue.xaxes)r=r.concat(ue.xaxes);if(ue.yaxes)r=r.concat(ue.yaxes);var a={};var n,i,o;if(t==="reset+autosize"){t="autosize";for(i=0;i<r.length;i++){n=r[i];if(n._rangeInitial&&(n.range[0]!==n._rangeInitial[0]||n.range[1]!==n._rangeInitial[1])||!n._rangeInitial&&!n.autorange){t="reset";break}}}if(t==="autosize"){for(i=0;i<r.length;i++){n=r[i];if(!n.fixedrange)a[n._name+".autorange"]=true}}else if(t==="reset"){if(ce||le.isSubplotConstrained)r=r.concat(le.xaxes);if(fe&&!le.isSubplotConstrained)r=r.concat(le.yaxes);if(le.isSubplotConstrained){if(!ce)r=r.concat(re);else if(!fe)r=r.concat(ae)}for(i=0;i<r.length;i++){n=r[i];if(!n.fixedrange){if(!n._rangeInitial){a[n._name+".autorange"]=true}else{o=n._rangeInitial;a[n._name+".range[0]"]=o[0];a[n._name+".range[1]"]=o[1]}}}}e.emit("plotly_doubleclick",null);l.call("_guiRelayout",e,a)}function Je(){Ke([0,0,oe,se]);n.syncOrAsync([T.previousPromises,function(){e._fullLayout._replotting=false;l.call("_guiRelayout",e,ye)}],e)}function Ke(t){var r=e._fullLayout;var a=r._plots;var i=r._subplots.cartesian;var o,s,u,c;if(me){l.subplotsRegistry.splom.drag(e)}if(de){for(o=0;o<i.length;o++){s=a[i[o]];u=s.xaxis;c=s.yaxis;if(s._scene){var p=n.simpleMap(u.range,u.r2l);var v=n.simpleMap(c.range,c.r2l);s._scene.update({range:[p[0],v[0],p[1],v[1]]})}}}if(me||de){_(e);w(e)}if(ge){var m=t[2]/z._length;var g=t[3]/G._length;for(o=0;o<i.length;o++){s=a[i[o]];u=s.xaxis;c=s.yaxis;var y=(pe||ue.isSubplotConstrained)&&!u.fixedrange&&ee[u._id];var x=(ve||ue.isSubplotConstrained)&&!c.fixedrange&&te[c._id];var b,T;var k,M;if(y){b=m;k=d||ue.isSubplotConstrained?t[0]:et(u,b)}else if(ue.xaHash[u._id]){b=m;k=t[0]*u._length/z._length}else if(ue.yaHash[u._id]){b=g;k=fe==="ns"?-t[1]*u._length/G._length:et(u,b,{n:"top",s:"bottom"}[fe])}else{b=Qe(u,m,g);k=$e(u,b)}if(x){T=g;M=f||ue.isSubplotConstrained?t[1]:et(c,T)}else if(ue.yaHash[c._id]){T=g;M=t[1]*c._length/G._length}else if(ue.xaHash[c._id]){T=m;M=ce==="ew"?-t[0]*c._length/z._length:et(c,T,{e:"right",w:"left"}[ce])}else{T=Qe(c,m,g);M=$e(c,T)}if(!b&&!T){continue}if(!b)b=1;if(!T)T=1;var A=u._offset-k/b;var S=c._offset-M/T;s.clipRect.call(h.setTranslate,k,M).call(h.setScale,b,T);s.plot.call(h.setTranslate,A,S).call(h.setScale,1/b,1/T);if(b!==s.xScaleFactor||T!==s.yScaleFactor){h.setPointGroupScale(s.zoomScalePts,b,T);h.setTextPointsScale(s.zoomScaleTxt,b,T)}h.hideOutsideRangePoints(s.clipOnAxisFalseTraces,s);s.xScaleFactor=b;s.yScaleFactor=T}}}function Qe(e,t,r){if(e.fixedrange)return 0;if(pe&&le.xaHash[e._id]){return t}if(ve&&(le.isSubplotConstrained?le.xaHash:le.yaHash)[e._id]){return r}return 0}function $e(e,t){if(t){e.range=e._r.slice();E(e,t);return et(e,t)}return 0}function et(e,t,r){return e._length*(1-t)*b[r||e.constraintoward||"middle"]}return Te}function z(e,t,r,a){var i=n.ensureSingle(e.draglayer,t,r,(function(t){t.classed("drag",true).style({fill:"transparent","stroke-width":0}).attr("data-subplot",e.id)}));i.call(d,a);return i.node()}function D(e,t,r,n,i,o,s){var l=z(e,"rect",t,r);a.select(l).call(h.setRect,n,i,o,s);return l}function R(e,t){for(var r=0;r<e.length;r++){if(!e[r].fixedrange)return t}return""}function F(e,t){var r=e.range[t];var a=Math.abs(r-e.range[1-t]);var n;if(e.type==="date"){return r}else if(e.type==="log"){n=Math.ceil(Math.max(0,-Math.log(a)/Math.LN10))+3;return i("."+n+"g")(Math.pow(10,r))}else{n=Math.floor(Math.log(Math.abs(r))/Math.LN10)-Math.floor(Math.log(a)/Math.LN10)+4;return i("."+String(n)+"g")(r)}}function B(e,t,r,a,n){for(var i=0;i<e.length;i++){var o=e[i];if(o.fixedrange)continue;if(o.rangebreaks){var s=o._id.charAt(0)==="y";var l=s?1-t:t;var u=s?1-r:r;a[o._name+".range[0]"]=o.l2r(o.p2l(l*o._length));a[o._name+".range[1]"]=o.l2r(o.p2l(u*o._length))}else{var c=o._rl[0];var f=o._rl[1]-c;a[o._name+".range[0]"]=o.l2r(c+f*t);a[o._name+".range[1]"]=o.l2r(c+f*r)}}if(n&&n.length){var h=(t+(1-r))/2;B(n,h,1-h,a,[])}}function N(e,t){for(var r=0;r<e.length;r++){var a=e[r];if(!a.fixedrange){if(a.rangebreaks){var n=0;var i=a._length;var o=a.p2l(n+t)-a.p2l(n);var s=a.p2l(i+t)-a.p2l(i);var l=(o+s)/2;a.range=[a.l2r(a._rl[0]-l),a.l2r(a._rl[1]-l)]}else{a.range=[a.l2r(a._rl[0]-t/a._m),a.l2r(a._rl[1]-t/a._m)]}}}}function j(e){return 1-(e>=0?Math.min(e,.9):1/(1/Math.max(e,-.3)+3.222))}function U(e,t,r){if(!e)return"pointer";if(e==="nsew"){if(r)return"";if(t==="pan")return"move";return"crosshair"}return e.toLowerCase()+"-resize"}function V(e,t,r,a,n){return e.append("path").attr("class","zoombox").style({fill:t>.2?"rgba(0,0,0,0)":"rgba(255,255,255,0)","stroke-width":0}).attr("transform",u(r,a)).attr("d",n+"Z")}function H(e,t,r){return e.append("path").attr("class","zoombox-corners").style({fill:f.background,stroke:f.defaultLine,"stroke-width":1,opacity:0}).attr("transform",u(t,r)).attr("d","M0,0Z")}function q(e,t,r,a,n,i){e.attr("d",a+"M"+r.l+","+r.t+"v"+r.h+"h"+r.w+"v-"+r.h+"h-"+r.w+"Z");G(e,t,n,i)}function G(e,t,r,a){if(!r){e.transition().style("fill",a>.2?"rgba(0,0,0,0.4)":"rgba(255,255,255,0.3)").duration(200);t.transition().style("opacity",1).duration(200)}}function Y(e){a.select(e).selectAll(".zoombox,.js-zoombox-backdrop,.js-zoombox-menu,.zoombox-corners").remove()}function W(e){if(P&&e.data&&e._context.showTips){n.notifier(n._(e,"Double-click to zoom back out"),"long");P=false}}function X(e,t){return"M"+(e.l-.5)+","+(t-I-.5)+"h-3v"+(2*I+1)+"h3ZM"+(e.r+.5)+","+(t-I-.5)+"h3v"+(2*I+1)+"h-3Z"}function Z(e,t){return"M"+(t-I-.5)+","+(e.t-.5)+"v-3h"+(2*I+1)+"v3ZM"+(t-I-.5)+","+(e.b+.5)+"v3h"+(2*I+1)+"v-3Z"}function J(e){var t=Math.floor(Math.min(e.b-e.t,e.r-e.l,I)/2);return"M"+(e.l-3.5)+","+(e.t-.5+t)+"h3v"+-t+"h"+t+"v-3h-"+(t+3)+"ZM"+(e.r+3.5)+","+(e.t-.5+t)+"h-3v"+-t+"h"+-t+"v-3h"+(t+3)+"ZM"+(e.r+3.5)+","+(e.b+.5-t)+"h-3v"+t+"h"+-t+"v3h"+(t+3)+"ZM"+(e.l-3.5)+","+(e.b+.5-t)+"h3v"+t+"h"+t+"v3h-"+(t+3)+"Z"}function K(e,t,r,a,i){var o=false;var s={};var l={};var u,c,f,h;var p=(i||{}).xaHash;var v=(i||{}).yaHash;for(var d=0;d<t.length;d++){var m=t[d];for(u in r){if(m[u]){for(f in m){if(!(i&&(p[f]||v[f]))&&!(f.charAt(0)==="x"?r:a)[f]){s[f]=u}}for(c in a){if(!(i&&(p[c]||v[c]))&&m[c]){o=true}}}}for(c in a){if(m[c]){for(h in m){if(!(i&&(p[h]||v[h]))&&!(h.charAt(0)==="x"?r:a)[h]){l[h]=c}}}}}if(o){n.extendFlat(s,l);l={}}var g={};var y=[];for(f in s){var x=k(e,f);y.push(x);g[x._id]=x}var b={};var _=[];for(h in l){var w=k(e,h);_.push(w);b[w._id]=w}return{xaHash:g,yaHash:b,xaxes:y,yaxes:_,xLinks:s,yLinks:l,isSubplotConstrained:o}}function Q(e,t){if(!s){if(e.onwheel!==undefined)e.onwheel=t;else if(e.onmousewheel!==undefined)e.onmousewheel=t;else if(!e.isAddedWheelEvent){e.isAddedWheelEvent=true;e.addEventListener("wheel",t,{passive:false})}}else{var r=e.onwheel!==undefined?"wheel":"mousewheel";if(e._onwheel){e.removeEventListener(r,e._onwheel)}e._onwheel=t;e.addEventListener(r,t,{passive:false})}}function $(e){var t=[];for(var r in e)t.push(e[r]);return t}t.exports={makeDragBox:O,makeDragger:z,makeRectDragger:D,makeZoombox:V,makeCorners:H,updateZoombox:q,xyCorners:J,transitionZoombox:G,removeZoombox:Y,showDoubleClickNotifier:W,attachWheelEventHandler:Q}},{"../../components/color":650,"../../components/dragelement":669,"../../components/dragelement/helpers":668,"../../components/drawing":672,"../../components/fx":690,"../../constants/alignment":755,"../../lib":787,"../../lib/clear_gl_canvases":771,"../../lib/setcursor":808,"../../lib/svg_text_utils":813,"../../plot_api/subroutines":828,"../../registry":915,"../plots":901,"./axes":838,"./axis_ids":842,"./constants":845,"./scale_zoom":857,"./select":858,"@plotly/d3":58,"has-passive-events":436,tinycolor2:583}],848:[function(e,t,r){"use strict";var a=e("@plotly/d3");var n=e("../../components/fx");var i=e("../../components/dragelement");var o=e("../../lib/setcursor");var s=e("./dragbox").makeDragBox;var l=e("./constants").DRAGGERSIZE;r.initInteractions=function e(t){var o=t._fullLayout;if(t._context.staticPlot){a.select(t).selectAll(".drag").remove();return}if(!o._has("cartesian")&&!o._has("splom"))return;var u=Object.keys(o._plots||{}).sort((function(e,t){if((o._plots[e].mainplot&&true)===(o._plots[t].mainplot&&true)){var r=e.split("y");var a=t.split("y");return r[0]===a[0]?Number(r[1]||1)-Number(a[1]||1):Number(r[0]||1)-Number(a[0]||1)}return o._plots[e].mainplot?1:-1}));u.forEach((function(e){var r=o._plots[e];var a=r.xaxis;var u=r.yaxis;if(!r.mainplot){var c=s(t,r,a._offset,u._offset,a._length,u._length,"ns","ew");c.onmousemove=function(r){t._fullLayout._rehover=function(){if(t._fullLayout._hoversubplot===e&&t._fullLayout._plots[e]){n.hover(t,r,e)}};n.hover(t,r,e);t._fullLayout._lasthover=c;t._fullLayout._hoversubplot=e};c.onmouseout=function(e){if(t._dragging)return;t._fullLayout._hoversubplot=null;i.unhover(t,e)};if(t._context.showAxisDragHandles){s(t,r,a._offset-l,u._offset-l,l,l,"n","w");s(t,r,a._offset+a._length,u._offset-l,l,l,"n","e");s(t,r,a._offset-l,u._offset+u._length,l,l,"s","w");s(t,r,a._offset+a._length,u._offset+u._length,l,l,"s","e")}}if(t._context.showAxisDragHandles){if(e===a._mainSubplot){var f=a._mainLinePosition;if(a.side==="top")f-=l;s(t,r,a._offset+a._length*.1,f,a._length*.8,l,"","ew");s(t,r,a._offset,f,a._length*.1,l,"","w");s(t,r,a._offset+a._length*.9,f,a._length*.1,l,"","e")}if(e===u._mainSubplot){var h=u._mainLinePosition;if(u.side!=="right")h-=l;s(t,r,h,u._offset+u._length*.1,l,u._length*.8,"ns","");s(t,r,h,u._offset+u._length*.9,l,u._length*.1,"s","");s(t,r,h,u._offset,l,u._length*.1,"n","")}}}));var c=o._hoverlayer.node();c.onmousemove=function(e){e.target=t._fullLayout._lasthover;n.hover(t,e,o._hoversubplot)};c.onclick=function(e){e.target=t._fullLayout._lasthover;n.click(t,e)};c.onmousedown=function(e){t._fullLayout._lasthover.onmousedown(e)};r.updateFx(t)};r.updateFx=function(e){var t=e._fullLayout;var r=t.dragmode==="pan"?"move":"crosshair";o(t._draggers,r)}},{"../../components/dragelement":669,"../../components/fx":690,"../../lib/setcursor":808,"./constants":845,"./dragbox":847,"@plotly/d3":58}],849:[function(e,t,r){"use strict";function a(e){var t=e._fullLayout._zoomlayer;if(t){t.selectAll(".outline-controllers").remove()}}function n(e){var t=e._fullLayout._zoomlayer;if(t){t.selectAll(".select-outline").remove()}e._fullLayout._drawing=false}t.exports={clearOutlineControllers:a,clearSelect:n}},{}],850:[function(e,t,r){"use strict";var a=e("../../lib").strTranslate;function n(e,t){switch(e.type){case"log":return e.p2d(t);case"date":return e.p2r(t,0,e.calendar);default:return e.p2r(t)}}function i(e,t){switch(e.type){case"log":return e.d2p(t);case"date":return e.r2p(t,0,e.calendar);default:return e.r2p(t)}}function o(e){var t=e._id.charAt(0)==="y"?1:0;return function(r){return n(e,r[t])}}function s(e){return a(e.xaxis._offset,e.yaxis._offset)}t.exports={p2r:n,r2p:i,axValue:o,getTransform:s}},{"../../lib":787}],851:[function(e,t,r){"use strict";var a=e("../../registry");var n=e("../../lib");var i=e("./axis_ids");t.exports=function e(t){return function e(r,o){var s=r[t];if(!Array.isArray(s))return;var l=a.subplotsRegistry.cartesian;var u=l.idRegex;var c=o._subplots;var f=c.xaxis;var h=c.yaxis;var p=c.cartesian;var v=o._has("cartesian")||o._has("gl2d");for(var d=0;d<s.length;d++){var m=s[d];if(!n.isPlainObject(m))continue;var g=i.cleanId(m.xref,"x",false);var y=i.cleanId(m.yref,"y",false);var x=u.x.test(g);var b=u.y.test(y);if(x||b){if(!v)n.pushUnique(o._basePlotModules,l);var _=false;if(x&&f.indexOf(g)===-1){f.push(g);_=true}if(b&&h.indexOf(y)===-1){h.push(y);_=true}if(_&&x&&b){p.push(g+y)}}}}}},{"../../lib":787,"../../registry":915,"./axis_ids":842}],852:[function(e,t,r){"use strict";var a=e("@plotly/d3");var n=e("../../registry");var i=e("../../lib");var o=e("../plots");var s=e("../../components/drawing");var l=e("../get_data").getModuleCalcData;var u=e("./axis_ids");var c=e("./constants");var f=e("../../constants/xmlns_namespaces");var h=i.ensureSingle;function p(e,t,r){return i.ensureSingle(e,t,r,(function(e){e.datum(r)}))}r.name="cartesian";r.attr=["xaxis","yaxis"];r.idRoot=["x","y"];r.idRegex=c.idRegex;r.attrRegex=c.attrRegex;r.attributes=e("./attributes");r.layoutAttributes=e("./layout_attributes");r.supplyLayoutDefaults=e("./layout_defaults");r.transitionAxes=e("./transition_axes");r.finalizeSubplots=function(e,t){var r=t._subplots;var a=r.xaxis;var n=r.yaxis;var o=r.cartesian;var s=o.concat(r.gl2d||[]);var l={};var f={};var h,p,v;for(h=0;h<s.length;h++){var d=s[h].split("y");l[d[0]]=1;f["y"+d[1]]=1}for(h=0;h<a.length;h++){p=a[h];if(!l[p]){v=(e[u.id2name(p)]||{}).anchor;if(!c.idRegex.y.test(v))v="y";o.push(p+v);s.push(p+v);if(!f[v]){f[v]=1;i.pushUnique(n,v)}}}for(h=0;h<n.length;h++){v=n[h];if(!f[v]){p=(e[u.id2name(v)]||{}).anchor;if(!c.idRegex.x.test(p))p="x";o.push(p+v);s.push(p+v);if(!l[p]){l[p]=1;i.pushUnique(a,p)}}}if(!s.length){p="";v="";for(var m in e){if(c.attrRegex.test(m)){var g=m.charAt(0);if(g==="x"){if(!p||+m.substr(5)<+p.substr(5)){p=m}}else if(!v||+m.substr(5)<+v.substr(5)){v=m}}}p=p?u.name2id(p):"x";v=v?u.name2id(v):"y";a.push(p);n.push(v);o.push(p+v)}};r.plot=function(e,t,r,a){var n=e._fullLayout;var i=n._subplots.cartesian;var o=e.calcdata;var s;if(!Array.isArray(t)){t=[];for(s=0;s<o.length;s++)t.push(s)}for(s=0;s<i.length;s++){var l=i[s];var u=n._plots[l];var c=[];var f;for(var h=0;h<o.length;h++){var p=o[h];var d=p[0].trace;if(d.xaxis+d.yaxis===l){if(t.indexOf(d.index)!==-1||d.carpet){if(f&&f[0].trace.xaxis+f[0].trace.yaxis===l&&["tonextx","tonexty","tonext"].indexOf(d.fill)!==-1&&c.indexOf(f)===-1){c.push(f)}c.push(p)}f=p}}v(e,u,c,r,a)}};function v(e,t,r,i,o){var u=c.traceLayerClasses;var f=e._fullLayout;var h=f._modules;var p,v,d;var m=[];var g=[];for(var y=0;y<h.length;y++){p=h[y];var x=p.name;var b=n.modules[x].categories;if(b.svg){var _=p.layerName||x+"layer";var w=p.plot;v=l(r,w);d=v[0];r=v[1];if(d.length){m.push({i:u.indexOf(_),className:_,plotMethod:w,cdModule:d})}if(b.zoomScale){g.push("."+_)}}}m.sort((function(e,t){return e.i-t.i}));var T=t.plot.selectAll("g.mlayer").data(m,(function(e){return e.className}));T.enter().append("g").attr("class",(function(e){return e.className})).classed("mlayer",true).classed("rangeplot",t.isRangePlot);T.exit().remove();T.order();T.each((function(r){var n=a.select(this);var l=r.className;r.plotMethod(e,t,r.cdModule,n,i,o);if(c.clipOnAxisFalseQuery.indexOf("."+l)===-1){s.setClipUrl(n,t.layerClipId,e)}}));if(f._has("scattergl")){p=n.getModule("scattergl");d=l(r,p)[0];p.plot(e,t,d)}if(!e._context.staticPlot){if(t._hasClipOnAxisFalse){t.clipOnAxisFalseTraces=t.plot.selectAll(c.clipOnAxisFalseQuery.join(",")).selectAll(".trace")}if(g.length){var k=t.plot.selectAll(g.join(",")).selectAll(".trace");t.zoomScalePts=k.selectAll("path.point");t.zoomScaleTxt=k.selectAll(".textpoint")}}}r.clean=function(e,t,r,a){var n=a._plots||{};var i=t._plots||{};var o=a._subplots||{};var s;var l,c;if(a._hasOnlyLargeSploms&&!t._hasOnlyLargeSploms){for(c in n){s=n[c];if(s.plotgroup)s.plotgroup.remove()}}var f=a._has&&a._has("gl");var h=t._has&&t._has("gl");if(f&&!h){for(c in n){s=n[c];if(s._scene)s._scene.destroy()}}if(o.xaxis&&o.yaxis){var p=u.listIds({_fullLayout:a});for(l=0;l<p.length;l++){var v=p[l];if(!t[u.id2name(v)]){a._infolayer.selectAll(".g-"+v+"title").remove()}}}var d=a._has&&a._has("cartesian");var m=t._has&&t._has("cartesian");if(d&&!m){g(a._cartesianlayer.selectAll(".subplot"),a);a._defs.selectAll(".axesclip").remove();delete a._axisConstraintGroups;delete a._axisMatchGroups}else if(o.cartesian){for(l=0;l<o.cartesian.length;l++){var x=o.cartesian[l];if(!i[x]){var b="."+x+",."+x+"-x,."+x+"-y";a._cartesianlayer.selectAll(b).remove();y(x,a)}}}};r.drawFramework=function(e){var t=e._fullLayout;var r=d(e);var n=t._cartesianlayer.selectAll(".subplot").data(r,String);n.enter().append("g").attr("class",(function(e){return"subplot "+e[0]}));n.order();n.exit().call(g,t);n.each((function(r){var n=r[0];var i=t._plots[n];i.plotgroup=a.select(this);m(e,i);i.draglayer=h(t._draggers,"g",n)}))};r.rangePlot=function(e,t,r){m(e,t);v(e,t,r);o.style(e)};function d(e){var t=e._fullLayout;var r=t._subplots.cartesian;var a=r.length;var n,i,o,s,l,u;var c=[];var f=[];for(n=0;n<a;n++){o=r[n];s=t._plots[o];l=s.xaxis;u=s.yaxis;var h=l._mainAxis;var p=u._mainAxis;var v=h._id+p._id;var d=t._plots[v];s.overlays=[];if(v!==o&&d){s.mainplot=v;s.mainplotinfo=d;f.push(o)}else{s.mainplot=undefined;s.mainplotinfo=undefined;c.push(o)}}for(n=0;n<f.length;n++){o=f[n];s=t._plots[o];s.mainplotinfo.overlays.push(s)}var m=c.concat(f);var g=new Array(a);for(n=0;n<a;n++){o=m[n];s=t._plots[o];l=s.xaxis;u=s.yaxis;var y=[o,l.layer,u.layer,l.overlaying||"",u.overlaying||""];for(i=0;i<s.overlays.length;i++){y.push(s.overlays[i].id)}g[n]=y}return g}function m(e,t){var r=t.plotgroup;var a=t.id;var n=c.layerValue2layerClass[t.xaxis.layer];var i=c.layerValue2layerClass[t.yaxis.layer];var o=e._fullLayout._hasOnlyLargeSploms;if(!t.mainplot){if(o){t.xlines=h(r,"path","xlines-above");t.ylines=h(r,"path","ylines-above");t.xaxislayer=h(r,"g","xaxislayer-above");t.yaxislayer=h(r,"g","yaxislayer-above")}else{var s=h(r,"g","layer-subplot");t.shapelayer=h(s,"g","shapelayer");t.imagelayer=h(s,"g","imagelayer");t.gridlayer=h(r,"g","gridlayer");t.zerolinelayer=h(r,"g","zerolinelayer");h(r,"path","xlines-below");h(r,"path","ylines-below");t.overlinesBelow=h(r,"g","overlines-below");h(r,"g","xaxislayer-below");h(r,"g","yaxislayer-below");t.overaxesBelow=h(r,"g","overaxes-below");t.plot=h(r,"g","plot");t.overplot=h(r,"g","overplot");t.xlines=h(r,"path","xlines-above");t.ylines=h(r,"path","ylines-above");t.overlinesAbove=h(r,"g","overlines-above");h(r,"g","xaxislayer-above");h(r,"g","yaxislayer-above");t.overaxesAbove=h(r,"g","overaxes-above");t.xlines=r.select(".xlines-"+n);t.ylines=r.select(".ylines-"+i);t.xaxislayer=r.select(".xaxislayer-"+n);t.yaxislayer=r.select(".yaxislayer-"+i)}}else{var l=t.mainplotinfo;var f=l.plotgroup;var v=a+"-x";var d=a+"-y";t.gridlayer=l.gridlayer;t.zerolinelayer=l.zerolinelayer;h(l.overlinesBelow,"path",v);h(l.overlinesBelow,"path",d);h(l.overaxesBelow,"g",v);h(l.overaxesBelow,"g",d);t.plot=h(l.overplot,"g",a);h(l.overlinesAbove,"path",v);h(l.overlinesAbove,"path",d);h(l.overaxesAbove,"g",v);h(l.overaxesAbove,"g",d);t.xlines=f.select(".overlines-"+n).select("."+v);t.ylines=f.select(".overlines-"+i).select("."+d);t.xaxislayer=f.select(".overaxes-"+n).select("."+v);t.yaxislayer=f.select(".overaxes-"+i).select("."+d)}if(!o){p(t.gridlayer,"g",t.xaxis._id);p(t.gridlayer,"g",t.yaxis._id);t.gridlayer.selectAll("g").map((function(e){return e[0]})).sort(u.idSort)}t.xlines.style("fill","none").classed("crisp",true);t.ylines.style("fill","none").classed("crisp",true)}function g(e,t){if(!e)return;var r={};e.each((function(e){var n=e[0];var i=a.select(this);i.remove();y(n,t);r[n]=true}));for(var n in t._plots){var i=t._plots[n];var o=i.overlays||[];for(var s=0;s<o.length;s++){var l=o[s];if(r[l.id]){l.plot.selectAll(".trace").remove()}}}}function y(e,t){t._draggers.selectAll("g."+e).remove();t._defs.select("#clip"+t._uid+e+"plot").remove()}r.toSVG=function(e){var t=e._fullLayout._glimages;var r=a.select(e).selectAll(".svg-container");var n=r.filter((function(e,t){return t===r.size()-1})).selectAll(".gl-canvas-context, .gl-canvas-focus");function i(){var e=this;var r=e.toDataURL("image/png");var a=t.append("svg:image");a.attr({xmlns:f.svg,"xlink:href":r,preserveAspectRatio:"none",x:0,y:0,width:e.style.width,height:e.style.height})}n.each(i)};r.updateFx=e("./graph_interact").updateFx},{"../../components/drawing":672,"../../constants/xmlns_namespaces":764,"../../lib":787,"../../registry":915,"../get_data":875,"../plots":901,"./attributes":836,"./axis_ids":842,"./constants":845,"./graph_interact":848,"./layout_attributes":853,"./layout_defaults":854,"./transition_axes":863,"@plotly/d3":58}],853:[function(e,t,r){"use strict";var a=e("../font_attributes");var n=e("../../components/color/attributes");var i=e("../../components/drawing/attributes").dash;var o=e("../../lib/extend").extendFlat;var s=e("../../plot_api/plot_template").templatedArray;var l=e("../../plots/cartesian/axis_format_attributes").descriptionWithDates;var u=e("../../constants/numerical").ONEDAY;var c=e("./constants");var f=c.HOUR_PATTERN;var h=c.WEEKDAY_PATTERN;t.exports={visible:{valType:"boolean",editType:"plot"},color:{valType:"color",dflt:n.defaultLine,editType:"ticks"},title:{text:{valType:"string",editType:"ticks"},font:a({editType:"ticks"}),standoff:{valType:"number",min:0,editType:"ticks"},editType:"ticks"},type:{valType:"enumerated",values:["-","linear","log","date","category","multicategory"],dflt:"-",editType:"calc",_noTemplating:true},autotypenumbers:{valType:"enumerated",values:["convert types","strict"],dflt:"convert types",editType:"calc"},autorange:{valType:"enumerated",values:[true,false,"reversed"],dflt:true,editType:"axrange",impliedEdits:{"range[0]":undefined,"range[1]":undefined}},rangemode:{valType:"enumerated",values:["normal","tozero","nonnegative"],dflt:"normal",editType:"plot"},range:{valType:"info_array",items:[{valType:"any",editType:"axrange",impliedEdits:{"^autorange":false},anim:true},{valType:"any",editType:"axrange",impliedEdits:{"^autorange":false},anim:true}],editType:"axrange",impliedEdits:{autorange:false},anim:true},fixedrange:{valType:"boolean",dflt:false,editType:"calc"},scaleanchor:{valType:"enumerated",values:[c.idRegex.x.toString(),c.idRegex.y.toString()],editType:"plot"},scaleratio:{valType:"number",min:0,dflt:1,editType:"plot"},constrain:{valType:"enumerated",values:["range","domain"],editType:"plot"},constraintoward:{valType:"enumerated",values:["left","center","right","top","middle","bottom"],editType:"plot"},matches:{valType:"enumerated",values:[c.idRegex.x.toString(),c.idRegex.y.toString()],editType:"calc"},rangebreaks:s("rangebreak",{enabled:{valType:"boolean",dflt:true,editType:"calc"},bounds:{valType:"info_array",items:[{valType:"any",editType:"calc"},{valType:"any",editType:"calc"}],editType:"calc"},pattern:{valType:"enumerated",values:[h,f,""],editType:"calc"},values:{valType:"info_array",freeLength:true,editType:"calc",items:{valType:"any",editType:"calc"}},dvalue:{valType:"number",editType:"calc",min:0,dflt:u},editType:"calc"}),tickmode:{valType:"enumerated",values:["auto","linear","array"],editType:"ticks",impliedEdits:{tick0:undefined,dtick:undefined}},nticks:{valType:"integer",min:0,dflt:0,editType:"ticks"},tick0:{valType:"any",editType:"ticks",impliedEdits:{tickmode:"linear"}},dtick:{valType:"any",editType:"ticks",impliedEdits:{tickmode:"linear"}},tickvals:{valType:"data_array",editType:"ticks"},ticktext:{valType:"data_array",editType:"ticks"},ticks:{valType:"enumerated",values:["outside","inside",""],editType:"ticks"},tickson:{valType:"enumerated",values:["labels","boundaries"],dflt:"labels",editType:"ticks"},ticklabelmode:{valType:"enumerated",values:["instant","period"],dflt:"instant",editType:"ticks"},ticklabelposition:{valType:"enumerated",values:["outside","inside","outside top","inside top","outside left","inside left","outside right","inside right","outside bottom","inside bottom"],dflt:"outside",editType:"calc"},ticklabeloverflow:{valType:"enumerated",values:["allow","hide past div","hide past domain"],editType:"calc"},mirror:{valType:"enumerated",values:[true,"ticks",false,"all","allticks"],dflt:false,editType:"ticks+layoutstyle"},ticklen:{valType:"number",min:0,dflt:5,editType:"ticks"},tickwidth:{valType:"number",min:0,dflt:1,editType:"ticks"},tickcolor:{valType:"color",dflt:n.defaultLine,editType:"ticks"},showticklabels:{valType:"boolean",dflt:true,editType:"ticks"},automargin:{valType:"boolean",dflt:false,editType:"ticks"},showspikes:{valType:"boolean",dflt:false,editType:"modebar"},spikecolor:{valType:"color",dflt:null,editType:"none"},spikethickness:{valType:"number",dflt:3,editType:"none"},spikedash:o({},i,{dflt:"dash",editType:"none"}),spikemode:{valType:"flaglist",flags:["toaxis","across","marker"],dflt:"toaxis",editType:"none"},spikesnap:{valType:"enumerated",values:["data","cursor","hovered data"],dflt:"hovered data",editType:"none"},tickfont:a({editType:"ticks"}),tickangle:{valType:"angle",dflt:"auto",editType:"ticks"},tickprefix:{valType:"string",dflt:"",editType:"ticks"},showtickprefix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},ticksuffix:{valType:"string",dflt:"",editType:"ticks"},showticksuffix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},showexponent:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},exponentformat:{valType:"enumerated",values:["none","e","E","power","SI","B"],dflt:"B",editType:"ticks"},minexponent:{valType:"number",dflt:3,min:0,editType:"ticks"},separatethousands:{valType:"boolean",dflt:false,editType:"ticks"},tickformat:{valType:"string",dflt:"",editType:"ticks",description:l("tick label")},tickformatstops:s("tickformatstop",{enabled:{valType:"boolean",dflt:true,editType:"ticks"},dtickrange:{valType:"info_array",items:[{valType:"any",editType:"ticks"},{valType:"any",editType:"ticks"}],editType:"ticks"},value:{valType:"string",dflt:"",editType:"ticks"},editType:"ticks"}),hoverformat:{valType:"string",dflt:"",editType:"none",description:l("hover text")},showline:{valType:"boolean",dflt:false,editType:"ticks+layoutstyle"},linecolor:{valType:"color",dflt:n.defaultLine,editType:"layoutstyle"},linewidth:{valType:"number",min:0,dflt:1,editType:"ticks+layoutstyle"},showgrid:{valType:"boolean",editType:"ticks"},gridcolor:{valType:"color",dflt:n.lightLine,editType:"ticks"},gridwidth:{valType:"number",min:0,dflt:1,editType:"ticks"},zeroline:{valType:"boolean",editType:"ticks"},zerolinecolor:{valType:"color",dflt:n.defaultLine,editType:"ticks"},zerolinewidth:{valType:"number",dflt:1,editType:"ticks"},showdividers:{valType:"boolean",dflt:true,editType:"ticks"},dividercolor:{valType:"color",dflt:n.defaultLine,editType:"ticks"},dividerwidth:{valType:"number",dflt:1,editType:"ticks"},anchor:{valType:"enumerated",values:["free",c.idRegex.x.toString(),c.idRegex.y.toString()],editType:"plot"},side:{valType:"enumerated",values:["top","bottom","left","right"],editType:"plot"},overlaying:{valType:"enumerated",values:["free",c.idRegex.x.toString(),c.idRegex.y.toString()],editType:"plot"},layer:{valType:"enumerated",values:["above traces","below traces"],dflt:"above traces",editType:"plot"},domain:{valType:"info_array",items:[{valType:"number",min:0,max:1,editType:"plot"},{valType:"number",min:0,max:1,editType:"plot"}],dflt:[0,1],editType:"plot"},position:{valType:"number",min:0,max:1,dflt:0,editType:"plot"},categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array","total ascending","total descending","min ascending","min descending","max ascending","max descending","sum ascending","sum descending","mean ascending","mean descending","median ascending","median descending"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},uirevision:{valType:"any",editType:"none"},editType:"calc",_deprecated:{autotick:{valType:"boolean",editType:"ticks"},title:{valType:"string",editType:"ticks"},titlefont:a({editType:"ticks"})}}},{"../../components/color/attributes":649,"../../components/drawing/attributes":671,"../../constants/numerical":763,"../../lib/extend":777,"../../plot_api/plot_template":827,"../../plots/cartesian/axis_format_attributes":841,"../font_attributes":867,"./constants":845}],854:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("../../components/color");var i=e("../../components/fx/helpers").isUnifiedHover;var o=e("../../components/fx/hovermode_defaults");var s=e("../../plot_api/plot_template");var l=e("../layout_attributes");var u=e("./layout_attributes");var c=e("./type_defaults");var f=e("./axis_defaults");var h=e("./constraints");var p=e("./position_defaults");var v=e("./axis_ids");var d=v.id2name;var m=v.name2id;var g=e("./constants").AX_ID_PATTERN;var y=e("../../registry");var x=y.traceIs;var b=y.getComponentMethod;function _(e,t,r){if(Array.isArray(e[t]))e[t].push(r);else e[t]=[r]}t.exports=function e(t,r,y){var w=r.autotypenumbers;var T={};var k={};var M={};var A={};var S={};var E={};var L={};var C={};var I={};var P={};var O,z;for(O=0;O<y.length;O++){var D=y[O];if(!x(D,"cartesian")&&!x(D,"gl2d"))continue;var R;if(D.xaxis){R=d(D.xaxis);_(T,R,D)}else if(D.xaxes){for(z=0;z<D.xaxes.length;z++){_(T,d(D.xaxes[z]),D)}}var F;if(D.yaxis){F=d(D.yaxis);_(T,F,D)}else if(D.yaxes){for(z=0;z<D.yaxes.length;z++){_(T,d(D.yaxes[z]),D)}}if(D.type==="funnel"){if(D.orientation==="h"){if(R)k[R]=true;if(F)L[F]=true}else{if(F)M[F]=true}}else if(D.type==="image"){if(F)C[F]=true;if(R)C[R]=true}else{if(F){S[F]=true;E[F]=true}if(!x(D,"carpet")||D.type==="carpet"&&!D._cheater){if(R)A[R]=true}}if(D.type==="carpet"&&D._cheater){if(R)k[R]=true}if(x(D,"2dMap")){I[R]=true;I[F]=true}if(x(D,"oriented")){var B=D.orientation==="h"?F:R;P[B]=true}}var N=r._subplots;var j=N.xaxis;var U=N.yaxis;var V=a.simpleMap(j,d);var H=a.simpleMap(U,d);var q=V.concat(H);var G=n.background;if(j.length&&U.length){G=a.coerce(t,r,l,"plot_bgcolor")}var Y=n.combine(G,r.paper_bgcolor);var W;var X;var Z;var J;var K;function Q(){var e=T[W]||[];K._traceIndices=e.map((function(e){return e._expandedIndex}));K._annIndices=[];K._shapeIndices=[];K._imgIndices=[];K._subplotsWith=[];K._counterAxes=[];K._name=K._attr=W;K._id=X}function $(e,t){return a.coerce(J,K,u,e,t)}function ee(e,t){return a.coerce2(J,K,u,e,t)}function te(e){return e==="x"?U:j}function re(e,r){var a=e==="x"?V:H;var n=[];for(var i=0;i<a.length;i++){var o=a[i];if(o!==r&&!(t[o]||{}).overlaying){n.push(m(o))}}return n}var ae={x:te("x"),y:te("y")};var ne=ae.x.concat(ae.y);var ie={};var oe=[];function se(){var e=J.matches;if(g.test(e)&&ne.indexOf(e)===-1){ie[e]=J.type;oe=Object.keys(ie)}}var le=o(t,r);var ue=i(le);for(O=0;O<q.length;O++){W=q[O];X=m(W);Z=W.charAt(0);if(!a.isPlainObject(t[W])){t[W]={}}J=t[W];K=s.newContainer(r,W,Z+"axis");Q();var ce=Z==="x"&&!A[W]&&k[W]||Z==="y"&&!S[W]&&M[W];var fe=Z==="y"&&(!E[W]&&L[W]||C[W]);var he={letter:Z,font:r.font,outerTicks:I[W],showGrid:!P[W],data:T[W]||[],bgColor:Y,calendar:r.calendar,automargin:true,visibleDflt:ce,reverseDflt:fe,autotypenumbersDflt:w,splomStash:((r._splomAxes||{})[Z]||{})[X]};$("uirevision",r.uirevision);c(J,K,$,he);f(J,K,$,he,r);var pe=ue&&Z===le.charAt(0);var ve=ee("spikecolor",ue?K.color:undefined);var de=ee("spikethickness",ue?1.5:undefined);var me=ee("spikedash",ue?"dot":undefined);var ge=ee("spikemode",ue?"across":undefined);var ye=ee("spikesnap");var xe=$("showspikes",!!pe||!!ve||!!de||!!me||!!ge||!!ye);if(!xe){delete K.spikecolor;delete K.spikethickness;delete K.spikedash;delete K.spikemode;delete K.spikesnap}p(J,K,$,{letter:Z,counterAxes:ae[Z],overlayableAxes:re(Z,W),grid:r.grid});$("title.standoff");se();K._input=J}O=0;while(O<oe.length){X=oe[O++];W=d(X);Z=W.charAt(0);if(!a.isPlainObject(t[W])){t[W]={}}J=t[W];K=s.newContainer(r,W,Z+"axis");Q();var be={letter:Z,font:r.font,outerTicks:I[W],showGrid:!P[W],data:[],bgColor:Y,calendar:r.calendar,automargin:true,visibleDflt:false,reverseDflt:false,autotypenumbersDflt:w,splomStash:((r._splomAxes||{})[Z]||{})[X]};$("uirevision",r.uirevision);K.type=ie[X]||"linear";f(J,K,$,be,r);p(J,K,$,{letter:Z,counterAxes:ae[Z],overlayableAxes:re(Z,W),grid:r.grid});$("fixedrange");se();K._input=J}var _e=b("rangeslider","handleDefaults");var we=b("rangeselector","handleDefaults");for(O=0;O<V.length;O++){W=V[O];J=t[W];K=r[W];_e(t,r,W);if(K.type==="date"){we(J,K,r,H,K.calendar)}$("fixedrange")}for(O=0;O<H.length;O++){W=H[O];J=t[W];K=r[W];var Te=r[d(K.anchor)];var ke=b("rangeslider","isVisible")(Te);$("fixedrange",ke)}h.handleDefaults(t,r,{axIds:ne.concat(oe).sort(v.idSort),axHasImage:C})}},{"../../components/color":650,"../../components/fx/helpers":686,"../../components/fx/hovermode_defaults":689,"../../lib":787,"../../plot_api/plot_template":827,"../../registry":915,"../layout_attributes":892,"./axis_defaults":840,"./axis_ids":842,"./constants":845,"./constraints":846,"./layout_attributes":853,"./position_defaults":856,"./type_defaults":864}],855:[function(e,t,r){"use strict";var a=e("tinycolor2").mix;var n=e("../../components/color/attributes").lightFraction;var i=e("../../lib");t.exports=function e(t,r,o,s){s=s||{};var l=s.dfltColor;function u(e,a){return i.coerce2(t,r,s.attributes,e,a)}var c=u("linecolor",l);var f=u("linewidth");var h=o("showline",s.showLine||!!c||!!f);if(!h){delete r.linecolor;delete r.linewidth}var p=a(l,s.bgColor,s.blend||n).toRgbString();var v=u("gridcolor",p);var d=u("gridwidth");var m=o("showgrid",s.showGrid||!!v||!!d);if(!m){delete r.gridcolor;delete r.gridwidth}if(!s.noZeroLine){var g=u("zerolinecolor",l);var y=u("zerolinewidth");var x=o("zeroline",s.showGrid||!!g||!!y);if(!x){delete r.zerolinecolor;delete r.zerolinewidth}}}},{"../../components/color/attributes":649,"../../lib":787,tinycolor2:583}],856:[function(e,t,r){"use strict";var a=e("fast-isnumeric");var n=e("../../lib");t.exports=function e(t,r,i,o){var s=o.counterAxes||[];var l=o.overlayableAxes||[];var u=o.letter;var c=o.grid;var f,h,p,v;if(c){h=c._domains[u][c._axisMap[r._id]];f=c._anchors[r._id];if(h){p=c[u+"side"].split(" ")[0];v=c.domain[u][p==="right"||p==="top"?1:0]}}h=h||[0,1];f=f||(a(t.position)?"free":s[0]||"free");p=p||(u==="x"?"bottom":"left");v=v||0;var d=n.coerce(t,r,{anchor:{valType:"enumerated",values:["free"].concat(s),dflt:f}},"anchor");if(d==="free")i("position",v);n.coerce(t,r,{side:{valType:"enumerated",values:u==="x"?["bottom","top"]:["left","right"],dflt:p}},"side");var m=false;if(l.length){m=n.coerce(t,r,{overlaying:{valType:"enumerated",values:[false].concat(l),dflt:false}},"overlaying")}if(!m){var g=i("domain",h);if(g[0]>g[1]-1/4096)r.domain=h;n.noneOrAll(t.domain,r.domain,h)}i("layer");return r}},{"../../lib":787,"fast-isnumeric":246}],857:[function(e,t,r){"use strict";var a=e("../../constants/alignment").FROM_BL;t.exports=function e(t,r,n){if(n===undefined){n=a[t.constraintoward||"center"]}var i=[t.r2l(t.range[0]),t.r2l(t.range[1])];var o=i[0]+(i[1]-i[0])*n;t.range=t._input.range=[t.l2r(o+(i[0]-o)*r),t.l2r(o+(i[1]-o)*r)];t.setScale()}},{"../../constants/alignment":755}],858:[function(e,t,r){"use strict";var a=e("polybooljs");var n=e("../../registry");var i=e("../../components/drawing").dashStyle;var o=e("../../components/color");var s=e("../../components/fx");var l=e("../../components/fx/helpers").makeEventData;var u=e("../../components/dragelement/helpers");var c=u.freeMode;var f=u.rectMode;var h=u.drawMode;var p=u.openMode;var v=u.selectMode;var d=e("../../components/shapes/draw_newshape/display_outlines");var m=e("../../components/shapes/draw_newshape/helpers").handleEllipse;var g=e("../../components/shapes/draw_newshape/newshapes");var y=e("../../lib");var x=e("../../lib/polygon");var b=e("../../lib/throttle");var _=e("./axis_ids").getFromId;var w=e("../../lib/clear_gl_canvases");var T=e("../../plot_api/subroutines").redrawReglTraces;var k=e("./constants");var M=k.MINSELECT;var A=x.filter;var S=x.tester;var E=e("./handle_outline").clearSelect;var L=e("./helpers");var C=L.p2r;var I=L.axValue;var P=L.getTransform;function O(e,t,r,a,n){var l=c(n);var u=f(n);var g=p(n);var x=h(n);var _=v(n);var w=n==="drawline";var T=n==="drawcircle";var E=w||T;var L=a.gd;var O=L._fullLayout;var D=O._zoomlayer;var R=a.element.getBoundingClientRect();var F=a.plotinfo;var V=P(F);var H=t-R.left;var q=r-R.top;O._calcInverseTransform(L);var G=y.apply3DTransform(O._invTransform)(H,q);H=G[0];q=G[1];var Y=O._invScaleX;var K=O._invScaleY;var Q=H;var $=q;var ee="M"+H+","+q;var te=a.xaxes[0]._length;var re=a.yaxes[0]._length;var ae=a.xaxes.concat(a.yaxes);var ne=e.altKey&&!(h(n)&&g);var ie,oe,se,le;var ue,ce,fe;N(e,L,a);if(l){ie=A([[H,q]],k.BENDPX)}var he=D.selectAll("path.select-outline-"+F.id).data(x?[0]:[1,2]);var pe=O.newshape;he.enter().append("path").attr("class",(function(e){return"select-outline select-outline-"+e+" select-outline-"+F.id})).style(x?{opacity:pe.opacity/2,fill:g?undefined:pe.fillcolor,stroke:pe.line.color,"stroke-dasharray":i(pe.line.dash,pe.line.width),"stroke-width":pe.line.width+"px"}:{}).attr("fill-rule",pe.fillrule).classed("cursor-move",x?true:false).attr("transform",V).attr("d",ee+"Z");var ve=D.append("path").attr("class","zoombox-corners").style({fill:o.background,stroke:o.defaultLine,"stroke-width":1}).attr("transform",V).attr("d","M0,0Z");var de=O._uid+k.SELECTID;var me=[];var ge=U(L,a.xaxes,a.yaxes,a.subplot);function ye(e,t){return e-t}var xe;if(F.fillRangeItems){xe=F.fillRangeItems}else{if(u){xe=function(e,t){var r=e.range={};for(ue=0;ue<ae.length;ue++){var a=ae[ue];var n=a._id.charAt(0);r[a._id]=[C(a,t[n+"min"]),C(a,t[n+"max"])].sort(ye)}}}else{xe=function(e,t,r){var a=e.lassoPoints={};for(ue=0;ue<ae.length;ue++){var n=ae[ue];a[n._id]=r.filtered.map(I(n))}}}}a.moveFn=function(e,t){Q=Math.max(0,Math.min(te,Y*e+H));$=Math.max(0,Math.min(re,K*t+q));var r=Math.abs(Q-H);var n=Math.abs($-q);if(u){var i;var o,s;if(_){var c=O.selectdirection;if(c==="any"){if(n<Math.min(r*.6,M)){i="h"}else if(r<Math.min(n*.6,M)){i="v"}else{i="d"}}else{i=c}switch(i){case"h":o=T?re/2:0;s=re;break;case"v":o=T?te/2:0;s=te;break}}if(x){switch(O.newshape.drawdirection){case"vertical":i="h";o=T?re/2:0;s=re;break;case"horizontal":i="v";o=T?te/2:0;s=te;break;case"ortho":if(r<n){i="h";o=q;s=$}else{i="v";o=H;s=Q}break;default:i="d"}}if(i==="h"){le=E?m(T,[Q,o],[Q,s]):[[H,o],[H,s],[Q,s],[Q,o]];le.xmin=E?Q:Math.min(H,Q);le.xmax=E?Q:Math.max(H,Q);le.ymin=Math.min(o,s);le.ymax=Math.max(o,s);ve.attr("d","M"+le.xmin+","+(q-M)+"h-4v"+2*M+"h4Z"+"M"+(le.xmax-1)+","+(q-M)+"h4v"+2*M+"h-4Z")}else if(i==="v"){le=E?m(T,[o,$],[s,$]):[[o,q],[o,$],[s,$],[s,q]];le.xmin=Math.min(o,s);le.xmax=Math.max(o,s);le.ymin=E?$:Math.min(q,$);le.ymax=E?$:Math.max(q,$);ve.attr("d","M"+(H-M)+","+le.ymin+"v-4h"+2*M+"v4Z"+"M"+(H-M)+","+(le.ymax-1)+"v4h"+2*M+"v-4Z")}else if(i==="d"){le=E?m(T,[H,q],[Q,$]):[[H,q],[H,$],[Q,$],[Q,q]];le.xmin=Math.min(H,Q);le.xmax=Math.max(H,Q);le.ymin=Math.min(q,$);le.ymax=Math.max(q,$);ve.attr("d","M0,0Z")}}else if(l){ie.addPt([Q,$]);le=ie.filtered}if(a.selectionDefs&&a.selectionDefs.length){se=X(a.mergedPolygons,le,ne);le.subtract=ne;oe=B(a.selectionDefs.concat([le]))}else{se=[le];oe=S(le)}d(J(se,g),he,a);if(_){b.throttle(de,k.SELECTDELAY,(function(){me=[];var e;var t=[];var r;for(ue=0;ue<ge.length;ue++){ce=ge[ue];r=ce._module.selectPoints(ce,oe);t.push(r);e=Z(r,ce);if(me.length){for(var n=0;n<e.length;n++){me.push(e[n])}}else me=e}fe={points:me};W(L,ge,fe);xe(fe,le,ie);a.gd.emit("plotly_selecting",fe)}))}};a.clickFn=function(e,t){ve.remove();if(L._fullLayout._activeShapeIndex>=0){L._fullLayout._deactivateShape(L);return}if(x)return;var r=O.clickmode;b.done(de).then((function(){b.clear(de);if(e===2){he.remove();for(ue=0;ue<ge.length;ue++){ce=ge[ue];ce._module.selectPoints(ce,false)}W(L,ge);j(a);L.emit("plotly_deselect",null)}else{if(r.indexOf("select")>-1){z(t,L,a.xaxes,a.yaxes,a.subplot,a,he)}if(r==="event"){L.emit("plotly_selected",undefined)}}s.click(L,t)})).catch(y.error)};a.doneFn=function(){ve.remove();b.done(de).then((function(){b.clear(de);a.gd.emit("plotly_selected",fe);if(le&&a.selectionDefs){le.subtract=ne;a.selectionDefs.push(le);a.mergedPolygons.length=0;[].push.apply(a.mergedPolygons,se)}if(a.doneFnCompleted){a.doneFnCompleted(me)}})).catch(y.error);if(x){j(a)}}}function z(e,t,r,a,n,i,o){var s=t._hoverdata;var l=t._fullLayout;var u=l.clickmode;var c=u.indexOf("event")>-1;var f=[];var h,v,m,g,y;var x,b,_,w,T;if(V(s)){N(e,t,i);h=U(t,r,a,n);var k=H(s,h);var M=k.pointNumbers.length>0;if(M?G(h,k):Y(h)&&(b=q(k))){if(o)o.remove();for(T=0;T<h.length;T++){v=h[T];v._module.selectPoints(v,false)}W(t,h);j(i);if(c){t.emit("plotly_deselect",null)}}else{_=e.shiftKey&&(b!==undefined?b:q(k));m=D(k.pointNumber,k.searchInfo,_);var A=i.selectionDefs.concat([m]);g=B(A);for(T=0;T<h.length;T++){y=h[T]._module.selectPoints(h[T],g);x=Z(y,h[T]);if(f.length){for(var S=0;S<x.length;S++){f.push(x[S])}}else f=x}w={points:f};W(t,h,w);if(m&&i){i.selectionDefs.push(m)}if(o){var E=i.mergedPolygons;var L=p(i.dragmode);d(J(E,L),o,i)}if(c){t.emit("plotly_selected",w)}}}}function D(e,t,r){return{pointNumber:e,searchInfo:t,subtract:r}}function R(e){return"pointNumber"in e&&"searchInfo"in e}function F(e){return{xmin:0,xmax:0,ymin:0,ymax:0,pts:[],contains:function(t,r,a,n){var i=e.searchInfo.cd[0].trace._expandedIndex;var o=n.cd[0].trace._expandedIndex;return o===i&&a===e.pointNumber},isRect:false,degenerate:false,subtract:e.subtract}}function B(e){var t=[];var r=R(e[0])?0:e[0][0][0];var a=r;var n=R(e[0])?0:e[0][0][1];var i=n;for(var o=0;o<e.length;o++){if(R(e[o])){t.push(F(e[o]))}else{var s=x.tester(e[o]);s.subtract=e[o].subtract;t.push(s);r=Math.min(r,s.xmin);a=Math.max(a,s.xmax);n=Math.min(n,s.ymin);i=Math.max(i,s.ymax)}}function l(e,r,a,n){var i=false;for(var o=0;o<t.length;o++){if(t[o].contains(e,r,a,n)){i=t[o].subtract===false}}return i}return{xmin:r,xmax:a,ymin:n,ymax:i,pts:[],contains:l,isRect:false,degenerate:false}}function N(e,t,r){t._fullLayout._drawing=false;var a=t._fullLayout;var n=r.plotinfo;var i=r.dragmode;var o=a._lastSelectedSubplot&&a._lastSelectedSubplot===n.id;var s=(e.shiftKey||e.altKey)&&!(h(i)&&p(i));if(o&&s&&(n.selection&&n.selection.selectionDefs)&&!r.selectionDefs){r.selectionDefs=n.selection.selectionDefs;r.mergedPolygons=n.selection.mergedPolygons}else if(!s||!n.selection){j(r)}if(!o){E(t);a._lastSelectedSubplot=n.id}}function j(e){var t=e.dragmode;var r=e.plotinfo;var a=e.gd;if(a._fullLayout._activeShapeIndex>=0){a._fullLayout._deactivateShape(a)}if(h(t)){var i=a._fullLayout;var o=i._zoomlayer;var s=o.selectAll(".select-outline-"+r.id);if(s&&a._fullLayout._drawing){var l=g(s,e);if(l){n.call("_guiRelayout",a,{shapes:l})}a._fullLayout._drawing=false}}r.selection={};r.selection.selectionDefs=e.selectionDefs=[];r.selection.mergedPolygons=e.mergedPolygons=[]}function U(e,t,r,a){var n=[];var i=t.map((function(e){return e._id}));var o=r.map((function(e){return e._id}));var s,l,u;for(u=0;u<e.calcdata.length;u++){s=e.calcdata[u];l=s[0].trace;if(l.visible!==true||!l._module||!l._module.selectPoints)continue;if(a&&(l.subplot===a||l.geo===a)){n.push(h(l._module,s,t[0],r[0]))}else if(l.type==="splom"&&l._xaxes[i[0]]&&l._yaxes[o[0]]){var c=h(l._module,s,t[0],r[0]);c.scene=e._fullLayout._splomScenes[l.uid];n.push(c)}else if(l.type==="sankey"){var f=h(l._module,s,t[0],r[0]);n.push(f)}else{if(i.indexOf(l.xaxis)===-1)continue;if(o.indexOf(l.yaxis)===-1)continue;n.push(h(l._module,s,_(e,l.xaxis),_(e,l.yaxis)))}}return n;function h(e,t,r,a){return{_module:e,cd:t,xaxis:r,yaxis:a}}}function V(e){return e&&Array.isArray(e)&&e[0].hoverOnBox!==true}function H(e,t){var r=e[0];var a=-1;var n=[];var i,o;for(o=0;o<t.length;o++){i=t[o];if(r.fullData._expandedIndex===i.cd[0].trace._expandedIndex){if(r.hoverOnBox===true){break}if(r.pointNumber!==undefined){a=r.pointNumber}else if(r.binNumber!==undefined){a=r.binNumber;n=r.pointNumbers}break}}return{pointNumber:a,pointNumbers:n,searchInfo:i}}function q(e){var t=e.searchInfo.cd[0].trace;var r=e.pointNumber;var a=e.pointNumbers;var n=a.length>0;var i=n?a[0]:r;return t.selectedpoints?t.selectedpoints.indexOf(i)>-1:false}function G(e,t){var r=[];var a,n,i,o;for(o=0;o<e.length;o++){a=e[o];if(a.cd[0].trace.selectedpoints&&a.cd[0].trace.selectedpoints.length>0){r.push(a)}}if(r.length===1){i=r[0]===t.searchInfo;if(i){n=t.searchInfo.cd[0].trace;if(n.selectedpoints.length===t.pointNumbers.length){for(o=0;o<t.pointNumbers.length;o++){if(n.selectedpoints.indexOf(t.pointNumbers[o])<0){return false}}return true}}}return false}function Y(e){var t=0;var r,a,n;for(n=0;n<e.length;n++){r=e[n];a=r.cd[0].trace;if(a.selectedpoints){if(a.selectedpoints.length>1)return false;t+=a.selectedpoints.length;if(t>1)return false}}return t===1}function W(e,t,r){var a,i,o,s;for(a=0;a<t.length;a++){var l=t[a].cd[0].trace._fullInput;var u=e._fullLayout._tracePreGUI[l.uid]||{};if(u.selectedpoints===undefined){u.selectedpoints=l._input.selectedpoints||null}}if(r){var c=r.points||[];for(a=0;a<t.length;a++){s=t[a].cd[0].trace;s._input.selectedpoints=s._fullInput.selectedpoints=[];if(s._fullInput!==s)s.selectedpoints=[]}for(a=0;a<c.length;a++){var f=c[a];var h=f.data;var p=f.fullData;if(f.pointIndices){[].push.apply(h.selectedpoints,f.pointIndices);if(s._fullInput!==s){[].push.apply(p.selectedpoints,f.pointIndices)}}else{h.selectedpoints.push(f.pointIndex);if(s._fullInput!==s){p.selectedpoints.push(f.pointIndex)}}}}else{for(a=0;a<t.length;a++){s=t[a].cd[0].trace;delete s.selectedpoints;delete s._input.selectedpoints;if(s._fullInput!==s){delete s._fullInput.selectedpoints}}}var v=false;for(a=0;a<t.length;a++){i=t[a];o=i.cd;s=o[0].trace;if(n.traceIs(s,"regl")){v=true}var d=i._module;var m=d.styleOnSelect||d.style;if(m){m(e,o,o[0].node3);if(o[0].nodeRangePlot3)m(e,o,o[0].nodeRangePlot3)}}if(v){w(e);T(e)}}function X(e,t,r){var n;if(r){n=a.difference({regions:e,inverted:false},{regions:[t],inverted:false});return n.regions}n=a.union({regions:e,inverted:false},{regions:[t],inverted:false});return n.regions}function Z(e,t){if(Array.isArray(e)){var r=t.cd;var a=t.cd[0].trace;for(var n=0;n<e.length;n++){e[n]=l(e[n],a,r)}}return e}function J(e,t){var r=[];for(var a=0;a<e.length;a++){r[a]=[];for(var n=0;n<e[a].length;n++){r[a][n]=[];r[a][n][0]=n?"L":"M";for(var i=0;i<e[a][n].length;i++){r[a][n].push(e[a][n][i])}}if(!t){r[a].push(["Z",r[a][0][1],r[a][0][2]])}}return r}t.exports={prepSelect:O,clearSelect:E,clearSelectionsCache:j,selectOnClick:z}},{"../../components/color":650,"../../components/dragelement/helpers":668,"../../components/drawing":672,"../../components/fx":690,"../../components/fx/helpers":686,"../../components/shapes/draw_newshape/display_outlines":738,"../../components/shapes/draw_newshape/helpers":739,"../../components/shapes/draw_newshape/newshapes":740,"../../lib":787,"../../lib/clear_gl_canvases":771,"../../lib/polygon":799,"../../lib/throttle":814,"../../plot_api/subroutines":828,"../../registry":915,"./axis_ids":842,"./constants":845,"./handle_outline":849,"./helpers":850,polybooljs:490}],859:[function(e,t,r){"use strict";var a=e("@plotly/d3");var n=e("d3-time-format").utcFormat;var i=e("../../lib");var o=i.numberFormat;var s=e("fast-isnumeric");var l=i.cleanNumber;var u=i.ms2DateTime;var c=i.dateTime2ms;var f=i.ensureNumber;var h=i.isArrayOrTypedArray;var p=e("../../constants/numerical");var v=p.FP_SAFE;var d=p.BADNUM;var m=p.LOG_CLIP;var g=p.ONEWEEK;var y=p.ONEDAY;var x=p.ONEHOUR;var b=p.ONEMIN;var _=p.ONESEC;var w=e("./axis_ids");var T=e("./constants");var k=T.HOUR_PATTERN;var M=T.WEEKDAY_PATTERN;function A(e){return Math.pow(10,e)}function S(e){return e!==null&&e!==undefined}t.exports=function e(t,r){r=r||{};var p=t._id||"x";var E=p.charAt(0);function L(e,r){if(e>0)return Math.log(e)/Math.LN10;else if(e<=0&&r&&t.range&&t.range.length===2){var a=t.range[0];var n=t.range[1];return.5*(a+n-2*m*Math.abs(a-n))}else return d}function C(e,r,a,n){if((n||{}).msUTC&&s(e)){return+e}var o=c(e,a||t.calendar);if(o===d){if(s(e)){e=+e;var l=Math.floor(i.mod(e+.05,1)*10);var u=Math.round(e-l/10);o=c(new Date(u))+l/10}else return d}return o}function I(e,r,a){return u(e,r,a||t.calendar)}function P(e){return t._categories[Math.round(e)]}function O(e){if(S(e)){if(t._categoriesMap===undefined){t._categoriesMap={}}if(t._categoriesMap[e]!==undefined){return t._categoriesMap[e]}else{t._categories.push(typeof e==="number"?String(e):e);var r=t._categories.length-1;t._categoriesMap[e]=r;return r}}return d}function z(e,t){var r=new Array(t);for(var a=0;a<t;a++){var n=(e[0]||[])[a];var i=(e[1]||[])[a];r[a]=D([n,i])}return r}function D(e){if(t._categoriesMap){return t._categoriesMap[e]}}function R(e){var t=D(e);if(t!==undefined)return t;if(s(e))return+e}function F(e){return s(e)?+e:D(e)}function B(e,t,r){return a.round(r+t*e,2)}function N(e,t,r){return(e-r)/t}var j=function e(r){if(!s(r))return d;return B(r,t._m,t._b)};var U=function(e){return N(e,t._m,t._b)};if(t.rangebreaks){var V=E==="y";j=function(e){if(!s(e))return d;var r=t._rangebreaks.length;if(!r)return B(e,t._m,t._b);var a=V;if(t.range[0]>t.range[1])a=!a;var n=a?-1:1;var i=n*e;var o=0;for(var l=0;l<r;l++){var u=n*t._rangebreaks[l].min;var c=n*t._rangebreaks[l].max;if(i<u)break;if(i>c)o=l+1;else{o=i<(u+c)/2?l:l+1;break}}var f=t._B[o]||0;if(!isFinite(f))return 0;return B(e,t._m2,f)};U=function(e){var r=t._rangebreaks.length;if(!r)return N(e,t._m,t._b);var a=0;for(var n=0;n<r;n++){if(e<t._rangebreaks[n].pmin)break;if(e>t._rangebreaks[n].pmax)a=n+1}return N(e,t._m2,t._B[a])}}t.c2l=t.type==="log"?L:f;t.l2c=t.type==="log"?A:f;t.l2p=j;t.p2l=U;t.c2p=t.type==="log"?function(e,t){return j(L(e,t))}:j;t.p2c=t.type==="log"?function(e){return A(U(e))}:U;if(["linear","-"].indexOf(t.type)!==-1){t.d2r=t.r2d=t.d2c=t.r2c=t.d2l=t.r2l=l;t.c2d=t.c2r=t.l2d=t.l2r=f;t.d2p=t.r2p=function(e){return t.l2p(l(e))};t.p2d=t.p2r=U;t.cleanPos=f}else if(t.type==="log"){t.d2r=t.d2l=function(e,t){return L(l(e),t)};t.r2d=t.r2c=function(e){return A(l(e))};t.d2c=t.r2l=l;t.c2d=t.l2r=f;t.c2r=L;t.l2d=A;t.d2p=function(e,r){return t.l2p(t.d2r(e,r))};t.p2d=function(e){return A(U(e))};t.r2p=function(e){return t.l2p(l(e))};t.p2r=U;t.cleanPos=f}else if(t.type==="date"){t.d2r=t.r2d=i.identity;t.d2c=t.r2c=t.d2l=t.r2l=C;t.c2d=t.c2r=t.l2d=t.l2r=I;t.d2p=t.r2p=function(e,r,a){return t.l2p(C(e,0,a))};t.p2d=t.p2r=function(e,t,r){return I(U(e),t,r)};t.cleanPos=function(e){return i.cleanDate(e,d,t.calendar)}}else if(t.type==="category"){t.d2c=t.d2l=O;t.r2d=t.c2d=t.l2d=P;t.d2r=t.d2l_noadd=R;t.r2c=function(e){var r=F(e);return r!==undefined?r:t.fraction2r(.5)};t.l2r=t.c2r=f;t.r2l=F;t.d2p=function(e){return t.l2p(t.r2c(e))};t.p2d=function(e){return P(U(e))};t.r2p=t.d2p;t.p2r=U;t.cleanPos=function(e){if(typeof e==="string"&&e!=="")return e;return f(e)}}else if(t.type==="multicategory"){t.r2d=t.c2d=t.l2d=P;t.d2r=t.d2l_noadd=R;t.r2c=function(e){var r=R(e);return r!==undefined?r:t.fraction2r(.5)};t.r2c_just_indices=D;t.l2r=t.c2r=f;t.r2l=R;t.d2p=function(e){return t.l2p(t.r2c(e))};t.p2d=function(e){return P(U(e))};t.r2p=t.d2p;t.p2r=U;t.cleanPos=function(e){if(Array.isArray(e)||typeof e==="string"&&e!=="")return e;return f(e)};t.setupMultiCategory=function(e){var a=t._traceIndices;var n,o;var s=t._matchGroup;if(s&&t._categories.length===0){for(var l in s){if(l!==p){var u=r[w.id2name(l)];a=a.concat(u._traceIndices)}}}var c=[[0,{}],[0,{}]];var f=[];for(n=0;n<a.length;n++){var v=e[a[n]];if(E in v){var d=v[E];var m=v._length||i.minRowLength(d);if(h(d[0])&&h(d[1])){for(o=0;o<m;o++){var g=d[0][o];var y=d[1][o];if(S(g)&&S(y)){f.push([g,y]);if(!(g in c[0][1])){c[0][1][g]=c[0][0]++}if(!(y in c[1][1])){c[1][1][y]=c[1][0]++}}}}}}f.sort((function(e,t){var r=c[0][1];var a=r[e[0]]-r[t[0]];if(a)return a;var n=c[1][1];return n[e[1]]-n[t[1]]}));for(n=0;n<f.length;n++){O(f[n])}}}t.fraction2r=function(e){var r=t.r2l(t.range[0]);var a=t.r2l(t.range[1]);return t.l2r(r+e*(a-r))};t.r2fraction=function(e){var r=t.r2l(t.range[0]);var a=t.r2l(t.range[1]);return(t.r2l(e)-r)/(a-r)};t.cleanRange=function(e,r){if(!r)r={};if(!e)e="range";var a=i.nestedProperty(t,e).get();var n,o;if(t.type==="date")o=i.dfltRange(t.calendar);else if(E==="y")o=T.DFLTRANGEY;else o=r.dfltRange||T.DFLTRANGEX;o=o.slice();if(t.rangemode==="tozero"||t.rangemode==="nonnegative"){o[0]=0}if(!a||a.length!==2){i.nestedProperty(t,e).set(o);return}if(t.type==="date"&&!t.autorange){a[0]=i.cleanDate(a[0],d,t.calendar);a[1]=i.cleanDate(a[1],d,t.calendar)}for(n=0;n<2;n++){if(t.type==="date"){if(!i.isDateTime(a[n],t.calendar)){t[e]=o;break}if(t.r2l(a[0])===t.r2l(a[1])){var l=i.constrain(t.r2l(a[0]),i.MIN_MS+1e3,i.MAX_MS-1e3);a[0]=t.l2r(l-1e3);a[1]=t.l2r(l+1e3);break}}else{if(!s(a[n])){if(s(a[1-n])){a[n]=a[1-n]*(n?10:.1)}else{t[e]=o;break}}if(a[n]<-v)a[n]=-v;else if(a[n]>v)a[n]=v;if(a[0]===a[1]){var u=Math.max(1,Math.abs(a[0]*1e-6));a[0]-=u;a[1]+=u}}}};t.setScale=function(e){var a=r._size;if(t.overlaying){var n=w.getFromId({_fullLayout:r},t.overlaying);t.domain=n.domain}var i=e&&t._r?"_r":"range";var o=t.calendar;t.cleanRange(i);var s=t.r2l(t[i][0],o);var l=t.r2l(t[i][1],o);var u=E==="y";if(u){t._offset=a.t+(1-t.domain[1])*a.h;t._length=a.h*(t.domain[1]-t.domain[0]);t._m=t._length/(s-l);t._b=-t._m*l}else{t._offset=a.l+t.domain[0]*a.w;t._length=a.w*(t.domain[1]-t.domain[0]);t._m=t._length/(l-s);t._b=-t._m*s}t._rangebreaks=[];t._lBreaks=0;t._m2=0;t._B=[];if(t.rangebreaks){var c,f;t._rangebreaks=t.locateBreaks(Math.min(s,l),Math.max(s,l));if(t._rangebreaks.length){for(c=0;c<t._rangebreaks.length;c++){f=t._rangebreaks[c];t._lBreaks+=Math.abs(f.max-f.min)}var h=u;if(s>l)h=!h;if(h)t._rangebreaks.reverse();var p=h?-1:1;t._m2=p*t._length/(Math.abs(l-s)-t._lBreaks);t._B.push(-t._m2*(u?l:s));for(c=0;c<t._rangebreaks.length;c++){f=t._rangebreaks[c];t._B.push(t._B[t._B.length-1]-p*t._m2*(f.max-f.min))}for(c=0;c<t._rangebreaks.length;c++){f=t._rangebreaks[c];f.pmin=j(f.min);f.pmax=j(f.max)}}}if(!isFinite(t._m)||!isFinite(t._b)||t._length<0){r._replotting=false;throw new Error("Something went wrong with axis scaling")}};t.maskBreaks=function(e){var r=t.rangebreaks||[];var a,n,o,s,u;if(!r._cachedPatterns){r._cachedPatterns=r.map((function(e){return e.enabled&&e.bounds?i.simpleMap(e.bounds,e.pattern?l:t.d2c):null}))}if(!r._cachedValues){r._cachedValues=r.map((function(e){return e.enabled&&e.values?i.simpleMap(e.values,t.d2c).sort(i.sorterAsc):null}))}for(var c=0;c<r.length;c++){var f=r[c];if(f.enabled){if(f.bounds){var h=f.pattern;a=r._cachedPatterns[c];n=a[0];o=a[1];switch(h){case M:u=new Date(e);s=u.getUTCDay();if(n>o){o+=7;if(s<n)s+=7}break;case k:u=new Date(e);var p=u.getUTCHours();var v=u.getUTCMinutes();var m=u.getUTCSeconds();var g=u.getUTCMilliseconds();s=p+(v/60+m/3600+g/36e5);if(n>o){o+=24;if(s<n)s+=24}break;case"":s=e;break}if(s>=n&&s<o)return d}else{var y=r._cachedValues[c];for(var x=0;x<y.length;x++){n=y[x];o=n+f.dvalue;if(e>=n&&e<o)return d}}}}return e};t.locateBreaks=function(e,r){var a,n,o,s;var u=[];if(!t.rangebreaks)return u;var c=t.rangebreaks.slice().sort((function(e,t){if(e.pattern===M&&t.pattern===k)return-1;if(t.pattern===M&&e.pattern===k)return 1;return 0}));var f=function(t,a){t=i.constrain(t,e,r);a=i.constrain(a,e,r);if(t===a)return;var n=true;for(var o=0;o<u.length;o++){var s=u[o];if(t<s.max&&a>=s.min){if(t<s.min){s.min=t}if(a>s.max){s.max=a}n=false}}if(n){u.push({min:t,max:a})}};for(a=0;a<c.length;a++){var h=c[a];if(h.enabled){if(h.bounds){var p=e;var v=r;if(h.pattern){p=Math.floor(p)}n=i.simpleMap(h.bounds,h.pattern?l:t.r2l);o=n[0];s=n[1];var d=new Date(p);var m;var w;switch(h.pattern){case M:w=g;m=((s<o?7:0)+(s-o))*y;p+=o*y-(d.getUTCDay()*y+d.getUTCHours()*x+d.getUTCMinutes()*b+d.getUTCSeconds()*_+d.getUTCMilliseconds());break;case k:w=y;m=((s<o?24:0)+(s-o))*x;p+=o*x-(d.getUTCHours()*x+d.getUTCMinutes()*b+d.getUTCSeconds()*_+d.getUTCMilliseconds());break;default:p=Math.min(n[0],n[1]);v=Math.max(n[0],n[1]);w=v-p;m=w}for(var T=p;T<v;T+=w){f(T,T+m)}}else{var A=i.simpleMap(h.values,t.d2c);for(var S=0;S<A.length;S++){o=A[S];s=o+h.dvalue;f(o,s)}}}}u.sort((function(e,t){return e.min-t.min}));return u};t.makeCalcdata=function(e,r,a){var n,o,s,l;var u=t.type;var c=u==="date"&&e[r+"calendar"];if(r in e){n=e[r];l=e._length||i.minRowLength(n);if(i.isTypedArray(n)&&(u==="linear"||u==="log")){if(l===n.length){return n}else if(n.subarray){return n.subarray(0,l)}}if(u==="multicategory"){return z(n,l)}o=new Array(l);for(s=0;s<l;s++){o[s]=t.d2c(n[s],0,c,a)}}else{var f=r+"0"in e?t.d2c(e[r+"0"],0,c):0;var h=e["d"+r]?Number(e["d"+r]):1;n=e[{x:"y",y:"x"}[r]];l=e._length||n.length;o=new Array(l);for(s=0;s<l;s++){o[s]=f+s*h}}if(t.rangebreaks){for(s=0;s<l;s++){o[s]=t.maskBreaks(o[s])}}return o};t.isValidRange=function(e){return Array.isArray(e)&&e.length===2&&s(t.r2l(e[0]))&&s(t.r2l(e[1]))};t.isPtWithinRange=function(e,r){var a=t.c2l(e[E],null,r);var n=t.r2l(t.range[0]);var i=t.r2l(t.range[1]);if(n<i){return n<=a&&a<=i}else{return i<=a&&a<=n}};t._emptyCategories=function(){t._categories=[];t._categoriesMap={}};t.clearCalc=function(){var e=t._matchGroup;if(e){var a=null;var n=null;for(var i in e){var o=r[w.id2name(i)];if(o._categories){a=o._categories;n=o._categoriesMap;break}}if(a&&n){t._categories=a;t._categoriesMap=n}else{t._emptyCategories()}}else{t._emptyCategories()}if(t._initialCategories){for(var s=0;s<t._initialCategories.length;s++){O(t._initialCategories[s])}}};t.sortByInitialCategories=function(){var e=[];t._emptyCategories();if(t._initialCategories){for(var a=0;a<t._initialCategories.length;a++){O(t._initialCategories[a])}}e=e.concat(t._traceIndices);var n=t._matchGroup;for(var i in n){if(p===i)continue;var o=r[w.id2name(i)];o._categories=t._categories;o._categoriesMap=t._categoriesMap;e=e.concat(o._traceIndices)}return e};var H=r._d3locale;if(t.type==="date"){t._dateFormat=H?H.timeFormat:n;t._extraFormat=r._extraFormat}t._separators=r.separators;t._numFormat=H?H.numberFormat:o;delete t._minDtick;delete t._forceTick0}},{"../../constants/numerical":763,"../../lib":787,"./axis_ids":842,"./constants":845,"@plotly/d3":58,"d3-time-format":172,"fast-isnumeric":246}],860:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("../../components/color").contrast;var i=e("./layout_attributes");var o=e("../array_container_defaults");t.exports=function e(t,r,a,n,i,o){if(!o||o.pass===1){s(t,r,a,n,i)}if(!o||o.pass===2){l(t,r,a,n,i)}};function s(e,t,r,a,n){var i=u(e);var o=r("tickprefix");if(o)r("showtickprefix",i);var s=r("ticksuffix",n.tickSuffixDflt);if(s)r("showticksuffix",i)}function l(e,t,r,s,l){var f=u(e);var h=r("tickprefix");if(h)r("showtickprefix",f);var p=r("ticksuffix",l.tickSuffixDflt);if(p)r("showticksuffix",f);var v=r("showticklabels");if(v){var d=l.font||{};var m=t.color;var g=t.ticklabelposition||"";var y=g.indexOf("inside")!==-1?n(l.bgColor):m&&m!==i.color.dflt?m:d.color;a.coerceFont(r,"tickfont",{family:d.family,size:d.size,color:y});r("tickangle");if(s!=="category"){var x=r("tickformat");o(e,t,{name:"tickformatstops",inclusionAttr:"enabled",handleItemDefaults:c});if(!t.tickformatstops.length){delete t.tickformatstops}if(!x&&s!=="date"){r("showexponent",f);r("exponentformat");r("minexponent");r("separatethousands")}}}}function u(e){var t=["showexponent","showtickprefix","showticksuffix"];var r=t.filter((function(t){return e[t]!==undefined}));var a=function(t){return e[t]===e[r[0]]};if(r.every(a)||r.length===1){return e[r[0]]}}function c(e,t){function r(r,n){return a.coerce(e,t,i.tickformatstops,r,n)}var n=r("enabled");if(n){r("dtickrange");r("value")}}},{"../../components/color":650,"../../lib":787,"../array_container_defaults":833,"./layout_attributes":853}],861:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("./layout_attributes");t.exports=function e(t,r,i,o){var s=a.coerce2(t,r,n,"ticklen");var l=a.coerce2(t,r,n,"tickwidth");var u=a.coerce2(t,r,n,"tickcolor",r.color);var c=i("ticks",o.outerTicks||s||l||u?"outside":"");if(!c){delete r.ticklen;delete r.tickwidth;delete r.tickcolor}}},{"../../lib":787,"./layout_attributes":853}],862:[function(e,t,r){"use strict";var a=e("./clean_ticks");var n=e("../../lib").isArrayOrTypedArray;t.exports=function e(t,r,i,o){function s(e){var a=t[e];return a!==undefined?a:(r._template||{})[e]}var l=s("tick0");var u=s("dtick");var c=s("tickvals");var f=n(c)?"array":u?"linear":"auto";var h=i("tickmode",f);if(h==="auto")i("nticks");else if(h==="linear"){var p=r.dtick=a.dtick(u,o);r.tick0=a.tick0(l,o,r.calendar,p)}else if(o!=="multicategory"){var v=i("tickvals");if(v===undefined)r.tickmode="auto";else i("ticktext")}}},{"../../lib":787,"./clean_ticks":844}],863:[function(e,t,r){"use strict";var a=e("@plotly/d3");var n=e("../../registry");var i=e("../../lib");var o=e("../../components/drawing");var s=e("./axes");t.exports=function e(t,r,l,u){var c=t._fullLayout;if(r.length===0){s.redrawComponents(t);return}function f(e){var t=e.xaxis;var r=e.yaxis;c._defs.select("#"+e.clipId+"> rect").call(o.setTranslate,0,0).call(o.setScale,1,1);e.plot.call(o.setTranslate,t._offset,r._offset).call(o.setScale,1,1);var a=e.plot.selectAll(".scatterlayer .trace");a.selectAll(".point").call(o.setPointGroupScale,1,1);a.selectAll(".textpoint").call(o.setTextPointsScale,1,1);a.call(o.hideOutsideRangePoints,e)}function h(e,r){var a=e.plotinfo;var n=a.xaxis;var l=a.yaxis;var u=n._length;var c=l._length;var f=!!e.xr1;var h=!!e.yr1;var p=[];if(f){var v=i.simpleMap(e.xr0,n.r2l);var d=i.simpleMap(e.xr1,n.r2l);var m=v[1]-v[0];var g=d[1]-d[0];p[0]=(v[0]*(1-r)+r*d[0]-v[0])/(v[1]-v[0])*u;p[2]=u*(1-r+r*g/m);n.range[0]=n.l2r(v[0]*(1-r)+r*d[0]);n.range[1]=n.l2r(v[1]*(1-r)+r*d[1])}else{p[0]=0;p[2]=u}if(h){var y=i.simpleMap(e.yr0,l.r2l);var x=i.simpleMap(e.yr1,l.r2l);var b=y[1]-y[0];var _=x[1]-x[0];p[1]=(y[1]*(1-r)+r*x[1]-y[1])/(y[0]-y[1])*c;p[3]=c*(1-r+r*_/b);l.range[0]=n.l2r(y[0]*(1-r)+r*x[0]);l.range[1]=l.l2r(y[1]*(1-r)+r*x[1])}else{p[1]=0;p[3]=c}s.drawOne(t,n,{skipTitle:true});s.drawOne(t,l,{skipTitle:true});s.redrawComponents(t,[n._id,l._id]);var w=f?u/p[2]:1;var T=h?c/p[3]:1;var k=f?p[0]:0;var M=h?p[1]:0;var A=f?p[0]/p[2]*u:0;var S=h?p[1]/p[3]*c:0;var E=n._offset-A;var L=l._offset-S;a.clipRect.call(o.setTranslate,k,M).call(o.setScale,1/w,1/T);a.plot.call(o.setTranslate,E,L).call(o.setScale,w,T);o.setPointGroupScale(a.zoomScalePts,1/w,1/T);o.setTextPointsScale(a.zoomScaleTxt,1/w,1/T)}var p;if(u){p=u()}function v(){var e={};for(var a=0;a<r.length;a++){var i=r[a];var o=i.plotinfo.xaxis;var s=i.plotinfo.yaxis;if(i.xr1)e[o._name+".range"]=i.xr1.slice();if(i.yr1)e[s._name+".range"]=i.yr1.slice()}p&&p();return n.call("relayout",t,e).then((function(){for(var e=0;e<r.length;e++){f(r[e].plotinfo)}}))}function d(){var e={};for(var a=0;a<r.length;a++){var i=r[a];var o=i.plotinfo.xaxis;var s=i.plotinfo.yaxis;if(i.xr0)e[o._name+".range"]=i.xr0.slice();if(i.yr0)e[s._name+".range"]=i.yr0.slice()}return n.call("relayout",t,e).then((function(){for(var e=0;e<r.length;e++){f(r[e].plotinfo)}}))}var m,g,y;var x=a.ease(l.easing);t._transitionData._interruptCallbacks.push((function(){window.cancelAnimationFrame(y);y=null;return d()}));function b(){g=Date.now();var e=Math.min(1,(g-m)/l.duration);var t=x(e);for(var a=0;a<r.length;a++){h(r[a],t)}if(g-m>l.duration){v();y=window.cancelAnimationFrame(b)}else{y=window.requestAnimationFrame(b)}}m=Date.now();y=window.requestAnimationFrame(b);return Promise.resolve()}},{"../../components/drawing":672,"../../lib":787,"../../registry":915,"./axes":838,"@plotly/d3":58}],864:[function(e,t,r){"use strict";var a=e("../../registry").traceIs;var n=e("./axis_autotype");t.exports=function e(t,r,a,n){a("autotypenumbers",n.autotypenumbersDflt);var o=a("type",(n.splomStash||{}).type);if(o==="-"){i(r,n.data);if(r.type==="-"){r.type="linear"}else{t.type=r.type}}};function i(e,t){if(e.type!=="-")return;var r=e._id;var i=r.charAt(0);var u;if(r.indexOf("scene")!==-1)r=i;var c=o(t,r,i);if(!c)return;if(c.type==="histogram"&&i==={v:"y",h:"x"}[c.orientation||"v"]){e.type="linear";return}var f=i+"calendar";var h=c[f];var p={noMultiCategory:!a(c,"cartesian")||a(c,"noMultiCategory")};if(c.type==="box"&&c._hasPreCompStats&&i==={h:"x",v:"y"}[c.orientation||"v"]){p.noMultiCategory=true}p.autotypenumbers=e.autotypenumbers;if(l(c,i)){var v=s(c);var d=[];for(u=0;u<t.length;u++){var m=t[u];if(!a(m,"box-violin")||(m[i+"axis"]||i)!==r)continue;if(m[v]!==undefined)d.push(m[v][0]);else if(m.name!==undefined)d.push(m.name);else d.push("text");if(m[f]!==h)h=undefined}e.type=n(d,h,p)}else if(c.type==="splom"){var g=c.dimensions;var y=g[c._axesDim[r]];if(y.visible)e.type=n(y.values,h,p)}else{e.type=n(c[i]||[c[i+"0"]],h,p)}}function o(e,t,r){for(var a=0;a<e.length;a++){var n=e[a];if(n.type==="splom"&&n._length>0&&(n["_"+r+"axes"]||{})[t]){return n}if((n[r+"axis"]||r)===t){if(l(n,r)){return n}else if((n[r]||[]).length||n[r+"0"]){return n}}}}function s(e){return{v:"x",h:"y"}[e.orientation||"v"]}function l(e,t){var r=s(e);var n=a(e,"box-violin");var i=a(e._fullInput||{},"candlestick");return n&&!i&&t===r&&e[r]===undefined&&e[r+"0"]===undefined}},{"../../registry":915,"./axis_autotype":839}],865:[function(e,t,r){"use strict";var a=e("../registry");var n=e("../lib");r.manageCommandObserver=function(e,t,a,o){var s={};var l=true;if(t&&t._commandObserver){s=t._commandObserver}if(!s.cache){s.cache={}}s.lookupTable={};var u=r.hasSimpleAPICommandBindings(e,a,s.lookupTable);if(t&&t._commandObserver){if(!u){if(t._commandObserver.remove){t._commandObserver.remove();t._commandObserver=null;return s}}else{return s}}if(u){i(e,u,s.cache);s.check=function t(){if(!l)return;var r=i(e,u,s.cache);if(r.changed&&o){if(s.lookupTable[r.value]!==undefined){s.disable();Promise.resolve(o({value:r.value,type:u.type,prop:u.prop,traces:u.traces,index:s.lookupTable[r.value]})).then(s.enable,s.enable)}}return r.changed};var c=["plotly_relayout","plotly_redraw","plotly_restyle","plotly_update","plotly_animatingframe","plotly_afterplot"];for(var f=0;f<c.length;f++){e._internalOn(c[f],s.check)}s.remove=function(){for(var t=0;t<c.length;t++){e._removeInternalListener(c[t],s.check)}}}else{n.log("Unable to automatically bind plot updates to API command");s.lookupTable={};s.remove=function(){}}s.disable=function e(){l=false};s.enable=function e(){l=true};if(t){t._commandObserver=s}return s};r.hasSimpleAPICommandBindings=function(e,t,a){var n;var i=t.length;var o;for(n=0;n<i;n++){var s;var l=t[n];var u=l.method;var c=l.args;if(!Array.isArray(c))c=[];if(!u){return false}var f=r.computeAPICommandBindings(e,u,c);if(f.length!==1){return false}if(!o){o=f[0];if(Array.isArray(o.traces)){o.traces.sort()}}else{s=f[0];if(s.type!==o.type){return false}if(s.prop!==o.prop){return false}if(Array.isArray(o.traces)){if(Array.isArray(s.traces)){s.traces.sort();for(var h=0;h<o.traces.length;h++){if(o.traces[h]!==s.traces[h]){return false}}}else{return false}}else{if(s.prop!==o.prop){return false}}}s=f[0];var p=s.value;if(Array.isArray(p)){if(p.length===1){p=p[0]}else{return false}}if(a){a[p]=n}}return o};function i(e,t,r){var a,i,o;var s=false;if(t.type==="data"){a=e._fullData[t.traces!==null?t.traces[0]:0]}else if(t.type==="layout"){a=e._fullLayout}else{return false}i=n.nestedProperty(a,t.prop).get();o=r[t.type]=r[t.type]||{};if(o.hasOwnProperty(t.prop)){if(o[t.prop]!==i){s=true}}o[t.prop]=i;return{changed:s,value:i}}r.executeAPICommand=function(e,t,r){if(t==="skip")return Promise.resolve();var i=a.apiMethodRegistry[t];var o=[e];if(!Array.isArray(r))r=[];for(var s=0;s<r.length;s++){o.push(r[s])}return i.apply(null,o).catch((function(e){n.warn("API call to Plotly."+t+" rejected.",e);return Promise.reject(e)}))};r.computeAPICommandBindings=function(e,t,r){var a;if(!Array.isArray(r))r=[];switch(t){case"restyle":a=l(e,r);break;case"relayout":a=s(e,r);break;case"update":a=l(e,[r[0],r[2]]).concat(s(e,[r[1]]));break;case"animate":a=o(e,r);break;default:a=[]}return a};function o(e,t){if(Array.isArray(t[0])&&t[0].length===1&&["string","number"].indexOf(typeof t[0][0])!==-1){return[{type:"layout",prop:"_currentFrame",value:t[0][0].toString()}]}else{return[]}}function s(e,t){var r=[];var a=t[0];var i={};if(typeof a==="string"){i[a]=t[1]}else if(n.isPlainObject(a)){i=a}else{return r}u(i,(function(e,t,a){r.push({type:"layout",prop:e,value:a})}),"",0);return r}function l(e,t){var r,a,i,o;var s=[];a=t[0];i=t[1];r=t[2];o={};if(typeof a==="string"){o[a]=i}else if(n.isPlainObject(a)){o=a;if(r===undefined){r=i}}else{return s}if(r===undefined){r=null}u(o,(function(t,a,n){var i;var o;if(Array.isArray(n)){o=n.slice();var l=Math.min(o.length,e.data.length);if(r){l=Math.min(l,r.length)}i=[];for(var u=0;u<l;u++){i[u]=r?r[u]:u}}else{o=n;i=r?r.slice():null}if(i===null){if(Array.isArray(o)){o=o[0]}}else if(Array.isArray(i)){if(!Array.isArray(o)){var c=o;o=[];for(var f=0;f<i.length;f++){o[f]=c}}o.length=Math.min(i.length,o.length)}s.push({type:"data",prop:t,traces:i,value:o})}),"",0);return s}function u(e,t,r,a){Object.keys(e).forEach((function(i){var o=e[i];if(i[0]==="_")return;var s=r+(a>0?".":"")+i;if(n.isPlainObject(o)){u(o,t,s,a+1)}else{t(s,i,o)}}))}},{"../lib":787,"../registry":915}],866:[function(e,t,r){"use strict";var a=e("../lib/extend").extendFlat;r.attributes=function(e,t){e=e||{};t=t||{};var r={valType:"info_array",editType:e.editType,items:[{valType:"number",min:0,max:1,editType:e.editType},{valType:"number",min:0,max:1,editType:e.editType}],dflt:[0,1]};var n=e.name?e.name+" ":"";var i=e.trace?"trace ":"subplot ";var o=t.description?" "+t.description:"";var s={x:a({},r,{}),y:a({},r,{}),editType:e.editType};if(!e.noGridCell){s.row={valType:"integer",min:0,dflt:0,editType:e.editType};s.column={valType:"integer",min:0,dflt:0,editType:e.editType}}return s};r.defaults=function(e,t,r,a){var n=a&&a.x||[0,1];var i=a&&a.y||[0,1];var o=t.grid;if(o){var s=r("domain.column");if(s!==undefined){if(s<o.columns)n=o._domains.x[s];else delete e.domain.column}var l=r("domain.row");if(l!==undefined){if(l<o.rows)i=o._domains.y[l];else delete e.domain.row}}var u=r("domain.x",n);var c=r("domain.y",i);if(!(u[0]<u[1]))e.domain.x=n.slice();if(!(c[0]<c[1]))e.domain.y=i.slice()}},{"../lib/extend":777}],867:[function(e,t,r){"use strict";t.exports=function(e){var t=e.editType;var r=e.colorEditType;if(r===undefined)r=t;var a={family:{valType:"string",noBlank:true,strict:true,editType:t},size:{valType:"number",min:1,editType:t},color:{valType:"color",editType:r},editType:t};if(e.arrayOk){a.family.arrayOk=true;a.size.arrayOk=true;a.color.arrayOk=true}return a}},{}],868:[function(e,t,r){"use strict";t.exports={_isLinkedToArray:"frames_entry",group:{valType:"string"},name:{valType:"string"},traces:{valType:"any"},baseframe:{valType:"string"},data:{valType:"any"},layout:{valType:"any"}}},{}],869:[function(e,t,r){"use strict";r.projNames={airy:"airy",aitoff:"aitoff","albers usa":"albersUsa",albers:"albers",august:"august","azimuthal equal area":"azimuthalEqualArea","azimuthal equidistant":"azimuthalEquidistant",baker:"baker",bertin1953:"bertin1953",boggs:"boggs",bonne:"bonne",bottomley:"bottomley",bromley:"bromley",collignon:"collignon","conic conformal":"conicConformal","conic equal area":"conicEqualArea","conic equidistant":"conicEquidistant",craig:"craig",craster:"craster","cylindrical equal area":"cylindricalEqualArea","cylindrical stereographic":"cylindricalStereographic",eckert1:"eckert1",eckert2:"eckert2",eckert3:"eckert3",eckert4:"eckert4",eckert5:"eckert5",eckert6:"eckert6",eisenlohr:"eisenlohr",equirectangular:"equirectangular",fahey:"fahey","foucaut sinusoidal":"foucautSinusoidal",foucaut:"foucaut",ginzburg4:"ginzburg4",ginzburg5:"ginzburg5",ginzburg6:"ginzburg6",ginzburg8:"ginzburg8",ginzburg9:"ginzburg9",gnomonic:"gnomonic","gringorten quincuncial":"gringortenQuincuncial",gringorten:"gringorten",guyou:"guyou",hammer:"hammer",hill:"hill",homolosine:"homolosine",hufnagel:"hufnagel",hyperelliptical:"hyperelliptical",kavrayskiy7:"kavrayskiy7",lagrange:"lagrange",larrivee:"larrivee",laskowski:"laskowski",loximuthal:"loximuthal",mercator:"mercator",miller:"miller",mollweide:"mollweide","mt flat polar parabolic":"mtFlatPolarParabolic","mt flat polar quartic":"mtFlatPolarQuartic","mt flat polar sinusoidal":"mtFlatPolarSinusoidal","natural earth":"naturalEarth","natural earth1":"naturalEarth1","natural earth2":"naturalEarth2","nell hammer":"nellHammer",nicolosi:"nicolosi",orthographic:"orthographic",patterson:"patterson","peirce quincuncial":"peirceQuincuncial",polyconic:"polyconic","rectangular polyconic":"rectangularPolyconic",robinson:"robinson",satellite:"satellite","sinu mollweide":"sinuMollweide",sinusoidal:"sinusoidal",stereographic:"stereographic",times:"times","transverse mercator":"transverseMercator","van der grinten":"vanDerGrinten","van der grinten2":"vanDerGrinten2","van der grinten3":"vanDerGrinten3","van der grinten4":"vanDerGrinten4",wagner4:"wagner4",wagner6:"wagner6",wiechel:"wiechel","winkel tripel":"winkel3",winkel3:"winkel3"};r.axesNames=["lonaxis","lataxis"];r.lonaxisSpan={orthographic:180,"azimuthal equal area":360,"azimuthal equidistant":360,"conic conformal":180,gnomonic:160,stereographic:180,"transverse mercator":180,"*":360};r.lataxisSpan={"conic conformal":150,stereographic:179.5,"*":180};r.scopeDefaults={world:{lonaxisRange:[-180,180],lataxisRange:[-90,90],projType:"equirectangular",projRotate:[0,0,0]},usa:{lonaxisRange:[-180,-50],lataxisRange:[15,80],projType:"albers usa"},europe:{lonaxisRange:[-30,60],lataxisRange:[30,85],projType:"conic conformal",projRotate:[15,0,0],projParallels:[0,60]},asia:{lonaxisRange:[22,160],lataxisRange:[-15,55],projType:"mercator",projRotate:[0,0,0]},africa:{lonaxisRange:[-30,60],lataxisRange:[-40,40],projType:"mercator",projRotate:[0,0,0]},"north america":{lonaxisRange:[-180,-45],lataxisRange:[5,85],projType:"conic conformal",projRotate:[-100,0,0],projParallels:[29.5,45.5]},"south america":{lonaxisRange:[-100,-30],lataxisRange:[-60,15],projType:"mercator",projRotate:[0,0,0]}};r.clipPad=.001;r.precision=.1;r.landColor="#F0DC82";r.waterColor="#3399FF";r.locationmodeToLayer={"ISO-3":"countries","USA-states":"subunits","country names":"countries"};r.sphereSVG={type:"Sphere"};r.fillLayers={ocean:1,land:1,lakes:1};r.lineLayers={subunits:1,countries:1,coastlines:1,rivers:1,frame:1};r.layers=["bg","ocean","land","lakes","subunits","countries","coastlines","rivers","lataxis","lonaxis","frame","backplot","frontplot"];r.layersForChoropleth=["bg","ocean","land","subunits","countries","coastlines","lataxis","lonaxis","frame","backplot","rivers","lakes","frontplot"];r.layerNameToAdjective={ocean:"ocean",land:"land",lakes:"lake",subunits:"subunit",countries:"country",coastlines:"coastline",rivers:"river",frame:"frame"}},{}],870:[function(e,t,r){"use strict";var a=e("@plotly/d3");var n=e("d3-geo");var i=n.geoPath;var o=n.geoDistance;var s=e("d3-geo-projection");var l=e("../../registry");var u=e("../../lib");var c=u.strTranslate;var f=e("../../components/color");var h=e("../../components/drawing");var p=e("../../components/fx");var v=e("../plots");var d=e("../cartesian/axes");var m=e("../cartesian/autorange").getAutoRange;var g=e("../../components/dragelement");var y=e("../cartesian/select").prepSelect;var x=e("../cartesian/select").clearSelect;var b=e("../cartesian/select").selectOnClick;var _=e("./zoom");var w=e("./constants");var T=e("../../lib/geo_location_utils");var k=e("../../lib/topojson_utils");var M=e("topojson-client").feature;function A(e){this.id=e.id;this.graphDiv=e.graphDiv;this.container=e.container;this.topojsonURL=e.topojsonURL;this.isStatic=e.staticPlot;this.topojsonName=null;this.topojson=null;this.projection=null;this.scope=null;this.viewInitial=null;this.fitScale=null;this.bounds=null;this.midPt=null;this.hasChoropleth=false;this.traceHash={};this.layers={};this.basePaths={};this.dataPaths={};this.dataPoints={};this.clipDef=null;this.clipRect=null;this.bgRect=null;this.makeFramework()}var S=A.prototype;t.exports=function e(t){return new A(t)};S.plot=function(e,t,r){var a=this;var n=t[this.id];var i=[];var o=false;for(var s in w.layerNameToAdjective){if(s!=="frame"&&n["show"+s]){o=true;break}}for(var l=0;l<e.length;l++){if(e[0][0].trace.locationmode){o=true;break}}if(o){var u=k.getTopojsonName(n);if(a.topojson===null||u!==a.topojsonName){a.topojsonName=u;if(PlotlyGeoAssets.topojson[a.topojsonName]===undefined){i.push(a.fetchTopojson())}}}i=i.concat(T.fetchTraceGeoData(e));r.push(new Promise((function(r,n){Promise.all(i).then((function(){a.topojson=PlotlyGeoAssets.topojson[a.topojsonName];a.update(e,t);r()})).catch(n)})))};S.fetchTopojson=function(){var e=this;var t=k.getTopojsonPath(e.topojsonURL,e.topojsonName);return new Promise((function(r,n){a.json(t,(function(a,i){if(a){if(a.status===404){return n(new Error(["plotly.js could not find topojson file at",t,".","Make sure the *topojsonURL* plot config option","is set properly."].join(" ")))}else{return n(new Error(["unexpected error while fetching topojson file at",t].join(" ")))}}PlotlyGeoAssets.topojson[e.topojsonName]=i;r()}))}))};S.update=function(e,t){var r=t[this.id];this.hasChoropleth=false;for(var a=0;a<e.length;a++){var n=e[a];var i=n[0].trace;if(i.type==="choropleth"){this.hasChoropleth=true}if(i.visible===true&&i._length>0){i._module.calcGeoJSON(n,t)}}var o=this.updateProjection(e,t);if(o)return;if(!this.viewInitial||this.scope!==r.scope){this.saveViewInitial(r)}this.scope=r.scope;this.updateBaseLayers(t,r);this.updateDims(t,r);this.updateFx(t,r);v.generalUpdatePerTraceModule(this.graphDiv,this,e,r);var s=this.layers.frontplot.select(".scatterlayer");this.dataPoints.point=s.selectAll(".point");this.dataPoints.text=s.selectAll("text");this.dataPaths.line=s.selectAll(".js-line");var l=this.layers.backplot.select(".choroplethlayer");this.dataPaths.choropleth=l.selectAll("path");this.render()};S.updateProjection=function(e,t){var r=this.graphDiv;var a=t[this.id];var n=t._size;var i=a.domain;var o=a.projection;var s=a.lonaxis;var l=a.lataxis;var c=s._ax;var f=l._ax;var h=this.projection=E(a);var p=[[n.l+n.w*i.x[0],n.t+n.h*(1-i.y[1])],[n.l+n.w*i.x[1],n.t+n.h*(1-i.y[0])]];var v=a.center||{};var d=o.rotation||{};var g=s.range||[];var y=l.range||[];if(a.fitbounds){c._length=p[1][0]-p[0][0];f._length=p[1][1]-p[0][1];c.range=m(r,c);f.range=m(r,f);var x=(c.range[0]+c.range[1])/2;var b=(f.range[0]+f.range[1])/2;if(a._isScoped){v={lon:x,lat:b}}else if(a._isClipped){v={lon:x,lat:b};d={lon:x,lat:b,roll:d.roll};var _=o.type;var T=w.lonaxisSpan[_]/2||180;var k=w.lataxisSpan[_]/2||90;g=[x-T,x+T];y=[b-k,b+k]}else{v={lon:x,lat:b};d={lon:x,lat:d.lat,roll:d.roll}}}h.center([v.lon-d.lon,v.lat-d.lat]).rotate([-d.lon,-d.lat,d.roll]).parallels(o.parallels);var M=C(g,y);h.fitExtent(p,M);var A=this.bounds=h.getBounds(M);var S=this.fitScale=h.scale();var L=h.translate();if(a.fitbounds){var I=h.getBounds(C(c.range,f.range));var P=Math.min((A[1][0]-A[0][0])/(I[1][0]-I[0][0]),(A[1][1]-A[0][1])/(I[1][1]-I[0][1]));if(isFinite(P)){h.scale(P*S)}else{u.warn("Something went wrong during"+this.id+"fitbounds computations.")}}else{h.scale(o.scale*S)}var O=this.midPt=[(A[0][0]+A[1][0])/2,(A[0][1]+A[1][1])/2];h.translate([L[0]+(O[0]-L[0]),L[1]+(O[1]-L[1])]).clipExtent(A);if(a._isAlbersUsa){var z=h([v.lon,v.lat]);var D=h.translate();h.translate([D[0]-(z[0]-D[0]),D[1]-(z[1]-D[1])])}};S.updateBaseLayers=function(e,t){var r=this;var n=r.topojson;var i=r.layers;var o=r.basePaths;function s(e){return e==="lonaxis"||e==="lataxis"}function l(e){return Boolean(w.lineLayers[e])}function u(e){return Boolean(w.fillLayers[e])}var c=this.hasChoropleth?w.layersForChoropleth:w.layers;var p=c.filter((function(e){return l(e)||u(e)?t["show"+e]:s(e)?t[e].showgrid:true}));var v=r.framework.selectAll(".layer").data(p,String);v.exit().each((function(e){delete i[e];delete o[e];a.select(this).remove()}));v.enter().append("g").attr("class",(function(e){return"layer "+e})).each((function(e){var t=i[e]=a.select(this);if(e==="bg"){r.bgRect=t.append("rect").style("pointer-events","all")}else if(s(e)){o[e]=t.append("path").style("fill","none")}else if(e==="backplot"){t.append("g").classed("choroplethlayer",true)}else if(e==="frontplot"){t.append("g").classed("scatterlayer",true)}else if(l(e)){o[e]=t.append("path").style("fill","none").style("stroke-miterlimit",2)}else if(u(e)){o[e]=t.append("path").style("stroke","none")}}));v.order();v.each((function(r){var a=o[r];var i=w.layerNameToAdjective[r];if(r==="frame"){a.datum(w.sphereSVG)}else if(l(r)||u(r)){a.datum(M(n,n.objects[r]))}else if(s(r)){a.datum(L(r,t,e)).call(f.stroke,t[r].gridcolor).call(h.dashLine,"",t[r].gridwidth)}if(l(r)){a.call(f.stroke,t[i+"color"]).call(h.dashLine,"",t[i+"width"])}else if(u(r)){a.call(f.fill,t[i+"color"])}}))};S.updateDims=function(e,t){var r=this.bounds;var a=(t.framewidth||0)/2;var n=r[0][0]-a;var i=r[0][1]-a;var o=r[1][0]-n+a;var s=r[1][1]-i+a;h.setRect(this.clipRect,n,i,o,s);this.bgRect.call(h.setRect,n,i,o,s).call(f.fill,t.bgcolor);this.xaxis._offset=n;this.xaxis._length=o;this.yaxis._offset=i;this.yaxis._length=s};S.updateFx=function(e,t){var r=this;var n=r.graphDiv;var i=r.bgRect;var o=e.dragmode;var s=e.clickmode;if(r.isStatic)return;function c(){var e=r.viewInitial;var t={};for(var a in e){t[r.id+"."+a]=e[a]}l.call("_guiRelayout",n,t);n.emit("plotly_doubleclick",null)}function f(e){return r.projection.invert([e[0]+r.xaxis._offset,e[1]+r.yaxis._offset])}var h;if(o==="select"){h=function(e,t){var a=e.range={};a[r.id]=[f([t.xmin,t.ymin]),f([t.xmax,t.ymax])]}}else if(o==="lasso"){h=function(e,t,a){var n=e.lassoPoints={};n[r.id]=a.filtered.map(f)}}var v={element:r.bgRect.node(),gd:n,plotinfo:{id:r.id,xaxis:r.xaxis,yaxis:r.yaxis,fillRangeItems:h},xaxes:[r.xaxis],yaxes:[r.yaxis],subplot:r.id,clickFn:function(e){if(e===2){x(n)}}};if(o==="pan"){i.node().onmousedown=null;i.call(_(r,t));i.on("dblclick.zoom",c);if(!n._context._scrollZoom.geo){i.on("wheel.zoom",null)}}else if(o==="select"||o==="lasso"){i.on(".zoom",null);v.prepFn=function(e,t,r){y(e,t,r,v,o)};g.init(v)}i.on("mousemove",(function(){var e=r.projection.invert(u.getPositionFromD3Event());if(!e){return g.unhover(n,a.event)}r.xaxis.p2c=function(){return e[0]};r.yaxis.p2c=function(){return e[1]};p.hover(n,a.event,r.id)}));i.on("mouseout",(function(){if(n._dragging)return;g.unhover(n,a.event)}));i.on("click",(function(){if(o!=="select"&&o!=="lasso"){if(s.indexOf("select")>-1){b(a.event,n,[r.xaxis],[r.yaxis],r.id,v)}if(s.indexOf("event")>-1){p.click(n,a.event)}}}))};S.makeFramework=function(){var e=this;var t=e.graphDiv;var r=t._fullLayout;var n="clip"+r._uid+e.id;e.clipDef=r._clips.append("clipPath").attr("id",n);e.clipRect=e.clipDef.append("rect");e.framework=a.select(e.container).append("g").attr("class","geo "+e.id).call(h.setClipUrl,n,t);e.project=function(t){var r=e.projection(t);return r?[r[0]-e.xaxis._offset,r[1]-e.yaxis._offset]:[null,null]};e.xaxis={_id:"x",c2p:function(t){return e.project(t)[0]}};e.yaxis={_id:"y",c2p:function(t){return e.project(t)[1]}};e.mockAxis={type:"linear",showexponent:"all",exponentformat:"B"};d.setConvert(e.mockAxis,r)};S.saveViewInitial=function(e){var t=e.center||{};var r=e.projection;var a=r.rotation||{};this.viewInitial={fitbounds:e.fitbounds,"projection.scale":r.scale};var n;if(e._isScoped){n={"center.lon":t.lon,"center.lat":t.lat}}else if(e._isClipped){n={"projection.rotation.lon":a.lon,"projection.rotation.lat":a.lat}}else{n={"center.lon":t.lon,"center.lat":t.lat,"projection.rotation.lon":a.lon}}u.extendFlat(this.viewInitial,n)};S.render=function(){var e=this.projection;var t=e.getPath();var r;function a(t){var r=e(t.lonlat);return r?c(r[0],r[1]):null}function n(t){return e.isLonLatOverEdges(t.lonlat)?"none":null}for(r in this.basePaths){this.basePaths[r].attr("d",t)}for(r in this.dataPaths){this.dataPaths[r].attr("d",(function(e){return t(e.geojson)}))}for(r in this.dataPoints){this.dataPoints[r].attr("display",n).attr("transform",a)}};function E(e){var t=e.projection;var r=t.type;var a=w.projNames[r];a="geo"+u.titleCase(a);var l=n[a]||s[a];var c=l();var f=e._isSatellite?Math.acos(1/t.distance)*180/Math.PI:e._isClipped?w.lonaxisSpan[r]/2:null;var h=["center","rotate","parallels","clipExtent"];var p=function(e){return e?c:[]};for(var v=0;v<h.length;v++){var d=h[v];if(typeof c[d]!=="function"){c[d]=p}}c.isLonLatOverEdges=function(e){if(c(e)===null){return true}if(f){var t=c.rotate();var r=o(e,[-t[0],-t[1]]);var a=f*Math.PI/180;return r>a}else{return false}};c.getPath=function(){return i().projection(c)};c.getBounds=function(e){return c.getPath().bounds(e)};c.precision(w.precision);if(e._isSatellite){c.tilt(t.tilt).distance(t.distance)}if(f){c.clipAngle(f-w.clipPad)}return c}function L(e,t,r){var a=1e-6;var n=2.5;var i=t[e];var o=w.scopeDefaults[t.scope];var s;var l;var u;if(e==="lonaxis"){s=o.lonaxisRange;l=o.lataxisRange;u=function(e,t){return[e,t]}}else if(e==="lataxis"){s=o.lataxisRange;l=o.lonaxisRange;u=function(e,t){return[t,e]}}var c={type:"linear",range:[s[0],s[1]-a],tick0:i.tick0,dtick:i.dtick};d.setConvert(c,r);var f=d.calcTicks(c);if(!t.isScoped&&e==="lonaxis"){f.pop()}var h=f.length;var p=new Array(h);for(var v=0;v<h;v++){var m=f[v].x;var g=p[v]=[];for(var y=l[0];y<l[1]+n;y+=n){g.push(u(m,y))}}return{type:"MultiLineString",coordinates:p}}function C(e,t){var r=w.clipPad;var a=e[0]+r;var n=e[1]-r;var i=t[0]+r;var o=t[1]-r;if(a>0&&n<0)n+=360;var s=(n-a)/4;return{type:"Polygon",coordinates:[[[a,i],[a,o],[a+s,o],[a+2*s,o],[a+3*s,o],[n,o],[n,i],[n-s,i],[n-2*s,i],[n-3*s,i],[a,i]]]}}},{"../../components/color":650,"../../components/dragelement":669,"../../components/drawing":672,"../../components/fx":690,"../../lib":787,"../../lib/geo_location_utils":780,"../../lib/topojson_utils":816,"../../registry":915,"../cartesian/autorange":837,"../cartesian/axes":838,"../cartesian/select":858,"../plots":901,"./constants":869,"./zoom":874,"@plotly/d3":58,"d3-geo":166,"d3-geo-projection":165,"topojson-client":586}],871:[function(e,t,r){"use strict";var a=e("../../plots/get_data").getSubplotCalcData;var n=e("../../lib").counterRegex;var i=e("./geo");var o="geo";var s=n(o);var l={};l[o]={valType:"subplotid",dflt:o,editType:"calc"};function u(e){var t=e._fullLayout;var r=e.calcdata;var n=t._subplots[o];for(var s=0;s<n.length;s++){var l=n[s];var u=a(r,o,l);var c=t[l];var f=c._subplot;if(!f){f=i({id:l,graphDiv:e,container:t._geolayer.node(),topojsonURL:e._context.topojsonURL,staticPlot:e._context.staticPlot});t[l]._subplot=f}f.plot(u,t,e._promises)}}function c(e,t,r,a){var n=a._subplots[o]||[];for(var i=0;i<n.length;i++){var s=n[i];var l=a[s]._subplot;if(!t[s]&&!!l){l.framework.remove();l.clipDef.remove()}}}function f(e){var t=e._fullLayout;var r=t._subplots[o];for(var a=0;a<r.length;a++){var n=t[r[a]];var i=n._subplot;i.updateFx(t,n)}}t.exports={attr:o,name:o,idRoot:o,idRegex:s,attrRegex:s,attributes:l,layoutAttributes:e("./layout_attributes"),supplyLayoutDefaults:e("./layout_defaults"),plot:u,updateFx:f,clean:c}},{"../../lib":787,"../../plots/get_data":875,"./geo":870,"./layout_attributes":872,"./layout_defaults":873}],872:[function(e,t,r){"use strict";var a=e("../../components/color/attributes");var n=e("../domain").attributes;var i=e("./constants");var o=e("../../plot_api/edit_types").overrideAll;var s=e("../../lib/sort_object_keys");var l={range:{valType:"info_array",items:[{valType:"number"},{valType:"number"}]},showgrid:{valType:"boolean",dflt:false},tick0:{valType:"number",dflt:0},dtick:{valType:"number"},gridcolor:{valType:"color",dflt:a.lightLine},gridwidth:{valType:"number",min:0,dflt:1}};var u=t.exports=o({domain:n({name:"geo"},{}),fitbounds:{valType:"enumerated",values:[false,"locations","geojson"],dflt:false,editType:"plot"},resolution:{valType:"enumerated",values:[110,50],dflt:110,coerceNumber:true},scope:{valType:"enumerated",values:s(i.scopeDefaults),dflt:"world"},projection:{type:{valType:"enumerated",values:s(i.projNames)},rotation:{lon:{valType:"number"},lat:{valType:"number"},roll:{valType:"number"}},tilt:{valType:"number",dflt:0},distance:{valType:"number",min:1.001,dflt:2},parallels:{valType:"info_array",items:[{valType:"number"},{valType:"number"}]},scale:{valType:"number",min:0,dflt:1}},center:{lon:{valType:"number"},lat:{valType:"number"}},visible:{valType:"boolean",dflt:true},showcoastlines:{valType:"boolean"},coastlinecolor:{valType:"color",dflt:a.defaultLine},coastlinewidth:{valType:"number",min:0,dflt:1},showland:{valType:"boolean",dflt:false},landcolor:{valType:"color",dflt:i.landColor},showocean:{valType:"boolean",dflt:false},oceancolor:{valType:"color",dflt:i.waterColor},showlakes:{valType:"boolean",dflt:false},lakecolor:{valType:"color",dflt:i.waterColor},showrivers:{valType:"boolean",dflt:false},rivercolor:{valType:"color",dflt:i.waterColor},riverwidth:{valType:"number",min:0,dflt:1},showcountries:{valType:"boolean"},countrycolor:{valType:"color",dflt:a.defaultLine},countrywidth:{valType:"number",min:0,dflt:1},showsubunits:{valType:"boolean"},subunitcolor:{valType:"color",dflt:a.defaultLine},subunitwidth:{valType:"number",min:0,dflt:1},showframe:{valType:"boolean"},framecolor:{valType:"color",dflt:a.defaultLine},framewidth:{valType:"number",min:0,dflt:1},bgcolor:{valType:"color",dflt:a.background},lonaxis:l,lataxis:l},"plot","from-root");u.uirevision={valType:"any",editType:"none"}},{"../../components/color/attributes":649,"../../lib/sort_object_keys":810,"../../plot_api/edit_types":820,"../domain":866,"./constants":869}],873:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("../subplot_defaults");var i=e("../get_data").getSubplotData;var o=e("./constants");var s=e("./layout_attributes");var l=o.axesNames;t.exports=function e(t,r,a){n(t,r,a,{type:"geo",attributes:s,handleDefaults:u,fullData:a,partition:"y"})};function u(e,t,r,n){var s=i(n.fullData,"geo",n.id);var u=s.map((function(e){return e._expandedIndex}));var c=r("resolution");var f=r("scope");var h=o.scopeDefaults[f];var p=r("projection.type",h.projType);var v=t._isAlbersUsa=p==="albers usa";if(v)f=t.scope="usa";var d=t._isScoped=f!=="world";var m=t._isSatellite=p==="satellite";var g=t._isConic=p.indexOf("conic")!==-1||p==="albers";var y=t._isClipped=!!o.lonaxisSpan[p];if(e.visible===false){var x=a.extendDeep({},t._template);x.showcoastlines=false;x.showcountries=false;x.showframe=false;x.showlakes=false;x.showland=false;x.showocean=false;x.showrivers=false;x.showsubunits=false;if(x.lonaxis)x.lonaxis.showgrid=false;if(x.lataxis)x.lataxis.showgrid=false;t._template=x}var b=r("visible");var _;for(var w=0;w<l.length;w++){var T=l[w];var k=[30,10][w];var M;if(d){M=h[T+"Range"]}else{var A=o[T+"Span"];var S=(A[p]||A["*"])/2;var E=r("projection.rotation."+T.substr(0,3),h.projRotate[w]);M=[E-S,E+S]}var L=r(T+".range",M);r(T+".tick0");r(T+".dtick",k);_=r(T+".showgrid",!b?false:undefined);if(_){r(T+".gridcolor");r(T+".gridwidth")}t[T]._ax={type:"linear",_id:T.slice(0,3),_traceIndices:u,setScale:a.identity,c2l:a.identity,r2l:a.identity,autorange:true,range:L.slice(),_m:1,_input:{}}}var C=t.lonaxis.range;var I=t.lataxis.range;var P=C[0];var O=C[1];if(P>0&&O<0)O+=360;var z=(P+O)/2;var D;if(!v){var R=d?h.projRotate:[z,0,0];D=r("projection.rotation.lon",R[0]);r("projection.rotation.lat",R[1]);r("projection.rotation.roll",R[2]);_=r("showcoastlines",!d&&b);if(_){r("coastlinecolor");r("coastlinewidth")}_=r("showocean",!b?false:undefined);if(_)r("oceancolor")}var F;var B;if(v){F=-96.6;B=38.7}else{F=d?z:D;B=(I[0]+I[1])/2}r("center.lon",F);r("center.lat",B);if(m){r("projection.tilt");r("projection.distance")}if(g){var N=h.projParallels||[0,60];r("projection.parallels",N)}r("projection.scale");_=r("showland",!b?false:undefined);if(_)r("landcolor");_=r("showlakes",!b?false:undefined);if(_)r("lakecolor");_=r("showrivers",!b?false:undefined);if(_){r("rivercolor");r("riverwidth")}_=r("showcountries",d&&f!=="usa"&&b);if(_){r("countrycolor");r("countrywidth")}if(f==="usa"||f==="north america"&&c===50){r("showsubunits",b);r("subunitcolor");r("subunitwidth")}if(!d){_=r("showframe",b);if(_){r("framecolor");r("framewidth")}}r("bgcolor");var j=r("fitbounds");if(j){delete t.projection.scale;if(d){delete t.center.lon;delete t.center.lat}else if(y){delete t.center.lon;delete t.center.lat;delete t.projection.rotation.lon;delete t.projection.rotation.lat;delete t.lonaxis.range;delete t.lataxis.range}else{delete t.center.lon;delete t.center.lat;delete t.projection.rotation.lon}}}},{"../../lib":787,"../get_data":875,"../subplot_defaults":909,"./constants":869,"./layout_attributes":872}],874:[function(e,t,r){"use strict";var a=e("@plotly/d3");var n=e("../../lib");var i=e("../../registry");var o=Math.PI/180;var s=180/Math.PI;var l={cursor:"pointer"};var u={cursor:"auto"};function c(e,t){var r=e.projection;var a;if(t._isScoped){a=p}else if(t._isClipped){a=d}else{a=v}return a(e,r)}t.exports=c;function f(e,t){return a.behavior.zoom().translate(t.translate()).scale(t.scale())}function h(e,t,r){var a=e.id;var o=e.graphDiv;var s=o.layout;var l=s[a];var u=o._fullLayout;var c=u[a];var f={};var h={};function p(e,t){f[a+"."+e]=n.nestedProperty(l,e).get();i.call("_storeDirectGUIEdit",s,u._preGUI,f);var r=n.nestedProperty(c,e);if(r.get()!==t){r.set(t);n.nestedProperty(l,e).set(t);h[a+"."+e]=t}}r(p);p("projection.scale",t.scale()/e.fitScale);p("fitbounds",false);o.emit("plotly_relayout",h)}function p(e,t){var r=f(e,t);function n(){a.select(this).style(l)}function i(){t.scale(a.event.scale).translate(a.event.translate);e.render();var r=t.invert(e.midPt);e.graphDiv.emit("plotly_relayouting",{"geo.projection.scale":t.scale()/e.fitScale,"geo.center.lon":r[0],"geo.center.lat":r[1]})}function o(r){var a=t.invert(e.midPt);r("center.lon",a[0]);r("center.lat",a[1])}function s(){a.select(this).style(u);h(e,t,o)}r.on("zoomstart",n).on("zoom",i).on("zoomend",s);return r}function v(e,t){var r=f(e,t);var n=2;var i,o,s,c,p,v,d,m,g;function y(e){return t.invert(e)}function x(e){var r=y(e);if(!r)return true;var a=t(r);return Math.abs(a[0]-e[0])>n||Math.abs(a[1]-e[1])>n}function b(){a.select(this).style(l);i=a.mouse(this);o=t.rotate();s=t.translate();c=o;p=y(i)}function _(){v=a.mouse(this);if(x(i)){r.scale(t.scale());r.translate(t.translate());return}t.scale(a.event.scale);t.translate([s[0],a.event.translate[1]]);if(!p){i=v;p=y(i)}else if(y(v)){m=y(v);d=[c[0]+(m[0]-p[0]),o[1],o[2]];t.rotate(d);c=d}g=true;e.render();var n=t.rotate();var l=t.invert(e.midPt);e.graphDiv.emit("plotly_relayouting",{"geo.projection.scale":t.scale()/e.fitScale,"geo.center.lon":l[0],"geo.center.lat":l[1],"geo.projection.rotation.lon":-n[0]})}function w(){a.select(this).style(u);if(g)h(e,t,T)}function T(r){var a=t.rotate();var n=t.invert(e.midPt);r("projection.rotation.lon",-a[0]);r("center.lon",n[0]);r("center.lat",n[1])}r.on("zoomstart",b).on("zoom",_).on("zoomend",w);return r}function d(e,t){var r={r:t.rotate(),k:t.scale()};var n=f(e,t);var i=E(n,"zoomstart","zoom","zoomend");var o=0;var s=n.on;var c;n.on("zoomstart",(function(){a.select(this).style(l);var e=a.mouse(this);var o=t.rotate();var u=o;var f=t.translate();var h=g(o);c=m(t,e);s.call(n,"zoom",(function(){var n=a.mouse(this);t.scale(r.k=a.event.scale);if(!c){e=n;c=m(t,e)}else if(m(t,n)){t.rotate(o).translate(f);var s=m(t,n);var l=x(c,s);var p=k(y(h,l));var d=r.r=b(p,c,u);if(!isFinite(d[0])||!isFinite(d[1])||!isFinite(d[2])){d=u}t.rotate(d);u=d}v(i.of(this,arguments))}));p(i.of(this,arguments))})).on("zoomend",(function(){a.select(this).style(u);s.call(n,"zoom",null);d(i.of(this,arguments));h(e,t,_)})).on("zoom.redraw",(function(){e.render();var r=t.rotate();e.graphDiv.emit("plotly_relayouting",{"geo.projection.scale":t.scale()/e.fitScale,"geo.projection.rotation.lon":-r[0],"geo.projection.rotation.lat":-r[1]})}));function p(e){if(!o++)e({type:"zoomstart"})}function v(e){e({type:"zoom"})}function d(e){if(!--o)e({type:"zoomend"})}function _(e){var r=t.rotate();e("projection.rotation.lon",-r[0]);e("projection.rotation.lat",-r[1])}return a.rebind(n,i,"on")}function m(e,t){var r=e.invert(t);return r&&isFinite(r[0])&&isFinite(r[1])&&M(r)}function g(e){var t=.5*e[0]*o;var r=.5*e[1]*o;var a=.5*e[2]*o;var n=Math.sin(t);var i=Math.cos(t);var s=Math.sin(r);var l=Math.cos(r);var u=Math.sin(a);var c=Math.cos(a);return[i*l*c+n*s*u,n*l*c-i*s*u,i*s*c+n*l*u,i*l*u-n*s*c]}function y(e,t){var r=e[0];var a=e[1];var n=e[2];var i=e[3];var o=t[0];var s=t[1];var l=t[2];var u=t[3];return[r*o-a*s-n*l-i*u,r*s+a*o+n*u-i*l,r*l-a*u+n*o+i*s,r*u+a*l-n*s+i*o]}function x(e,t){if(!e||!t)return;var r=S(e,t);var a=Math.sqrt(A(r,r));var n=.5*Math.acos(Math.max(-1,Math.min(1,A(e,t))));var i=Math.sin(n)/a;return a&&[Math.cos(n),r[2]*i,-r[1]*i,r[0]*i]}function b(e,t,r){var a=T(t,2,e[0]);a=T(a,1,e[1]);a=T(a,0,e[2]-r[2]);var n=t[0];var i=t[1];var o=t[2];var l=a[0];var u=a[1];var c=a[2];var f=Math.atan2(i,n)*s;var h=Math.sqrt(n*n+i*i);var p;var v;if(Math.abs(u)>h){v=(u>0?90:-90)-f;p=0}else{v=Math.asin(u/h)*s-f;p=Math.sqrt(h*h-u*u)}var d=180-v-2*f;var m=(Math.atan2(c,l)-Math.atan2(o,p))*s;var g=(Math.atan2(c,l)-Math.atan2(o,-p))*s;var y=_(r[0],r[1],v,m);var x=_(r[0],r[1],d,g);if(y<=x)return[v,m,r[2]];else return[d,g,r[2]]}function _(e,t,r,a){var n=w(r-e);var i=w(a-t);return Math.sqrt(n*n+i*i)}function w(e){return(e%360+540)%360-180}function T(e,t,r){var a=r*o;var n=e.slice();var i=t===0?1:0;var s=t===2?1:2;var l=Math.cos(a);var u=Math.sin(a);n[i]=e[i]*l-e[s]*u;n[s]=e[s]*l+e[i]*u;return n}function k(e){return[Math.atan2(2*(e[0]*e[1]+e[2]*e[3]),1-2*(e[1]*e[1]+e[2]*e[2]))*s,Math.asin(Math.max(-1,Math.min(1,2*(e[0]*e[2]-e[3]*e[1]))))*s,Math.atan2(2*(e[0]*e[3]+e[1]*e[2]),1-2*(e[2]*e[2]+e[3]*e[3]))*s]}function M(e){var t=e[0]*o;var r=e[1]*o;var a=Math.cos(r);return[a*Math.cos(t),a*Math.sin(t),Math.sin(r)]}function A(e,t){var r=0;for(var a=0,n=e.length;a<n;++a)r+=e[a]*t[a];return r}function S(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function E(e){var t=0;var r=arguments.length;var n=[];while(++t<r)n.push(arguments[t]);var i=a.dispatch.apply(null,n);i.of=function(t,r){return function(n){var o;try{o=n.sourceEvent=a.event;n.target=e;a.event=n;i[n.type].apply(t,r)}finally{a.event=o}}};return i}},{"../../lib":787,"../../registry":915,"@plotly/d3":58}],875:[function(e,t,r){"use strict";var a=e("../registry");var n=e("./cartesian/constants").SUBPLOT_PATTERN;r.getSubplotCalcData=function(e,t,r){var n=a.subplotsRegistry[t];if(!n)return[];var i=n.attr;var o=[];for(var s=0;s<e.length;s++){var l=e[s];var u=l[0].trace;if(u[i]===r)o.push(l)}return o};r.getModuleCalcData=function(e,t){var r=[];var n=[];var i;if(typeof t==="string"){i=a.getModule(t).plot}else if(typeof t==="function"){i=t}else{i=t.plot}if(!i){return[r,e]}for(var o=0;o<e.length;o++){var s=e[o];var l=s[0].trace;if(l.visible!==true||l._length===0)continue;if(l._module.plot===i){r.push(s)}else{n.push(s)}}return[r,n]};r.getSubplotData=function e(t,r,i){if(!a.subplotsRegistry[r])return[];var o=a.subplotsRegistry[r].attr;var s=[];var l,u,c;if(r==="gl2d"){var f=i.match(n);u="x"+f[1];c="y"+f[2]}for(var h=0;h<t.length;h++){l=t[h];if(r==="gl2d"&&a.traceIs(l,"gl2d")){if(l[o[0]]===u&&l[o[1]]===c){s.push(l)}}else{if(l[o]===i)s.push(l)}}return s}},{"../registry":915,"./cartesian/constants":845}],876:[function(e,t,r){"use strict";var a=e("mouse-change");var n=e("mouse-wheel");var i=e("mouse-event-offset");var o=e("../cartesian/constants");var s=e("has-passive-events");t.exports=u;function l(e,t){this.element=e;this.plot=t;this.mouseListener=null;this.wheelListener=null;this.lastInputTime=Date.now();this.lastPos=[0,0];this.boxEnabled=false;this.boxInited=false;this.boxStart=[0,0];this.boxEnd=[0,0];this.dragStart=[0,0]}function u(e){var t=e.mouseContainer;var r=e.glplot;var u=new l(t,r);function c(){e.xaxis.autorange=false;e.yaxis.autorange=false}function f(){var t=e.graphDiv._fullLayout._axisConstraintGroups;var r=e.xaxis._id;var a=e.yaxis._id;for(var n=0;n<t.length;n++){if(t[n][r]!==-1){if(t[n][a]!==-1)return true;break}}return false}u.mouseListener=a(t,h);t.addEventListener("touchstart",(function(e){var r=i(e.changedTouches[0],t);h(0,r[0],r[1]);h(1,r[0],r[1]);e.preventDefault()}),s?{passive:false}:false);t.addEventListener("touchmove",(function(e){e.preventDefault();var r=i(e.changedTouches[0],t);h(1,r[0],r[1]);e.preventDefault()}),s?{passive:false}:false);t.addEventListener("touchend",(function(e){h(0,u.lastPos[0],u.lastPos[1]);e.preventDefault()}),s?{passive:false}:false);function h(t,a,n){var i=e.calcDataBox();var s=r.viewBox;var l=u.lastPos[0];var h=u.lastPos[1];var p=o.MINDRAG*r.pixelRatio;var v=o.MINZOOM*r.pixelRatio;var d,m;a*=r.pixelRatio;n*=r.pixelRatio;n=s[3]-s[1]-n;function g(t,r,a){var n=Math.min(r,a);var o=Math.max(r,a);if(n!==o){i[t]=n;i[t+2]=o;u.dataBox=i;e.setRanges(i)}else{e.selectBox.selectBox=[0,0,1,1];e.glplot.setDirty()}}switch(e.fullLayout.dragmode){case"zoom":if(t){var y=a/(s[2]-s[0])*(i[2]-i[0])+i[0];var x=n/(s[3]-s[1])*(i[3]-i[1])+i[1];if(!u.boxInited){u.boxStart[0]=y;u.boxStart[1]=x;u.dragStart[0]=a;u.dragStart[1]=n}u.boxEnd[0]=y;u.boxEnd[1]=x;u.boxInited=true;if(!u.boxEnabled&&(u.boxStart[0]!==u.boxEnd[0]||u.boxStart[1]!==u.boxEnd[1])){u.boxEnabled=true}var b=Math.abs(u.dragStart[0]-a)<v;var _=Math.abs(u.dragStart[1]-n)<v;if(f()&&!(b&&_)){d=u.boxEnd[0]-u.boxStart[0];m=u.boxEnd[1]-u.boxStart[1];var w=(i[3]-i[1])/(i[2]-i[0]);if(Math.abs(d*w)>Math.abs(m)){u.boxEnd[1]=u.boxStart[1]+Math.abs(d)*w*(m>=0?1:-1);if(u.boxEnd[1]<i[1]){u.boxEnd[1]=i[1];u.boxEnd[0]=u.boxStart[0]+(i[1]-u.boxStart[1])/Math.abs(w)}else if(u.boxEnd[1]>i[3]){u.boxEnd[1]=i[3];u.boxEnd[0]=u.boxStart[0]+(i[3]-u.boxStart[1])/Math.abs(w)}}else{u.boxEnd[0]=u.boxStart[0]+Math.abs(m)/w*(d>=0?1:-1);if(u.boxEnd[0]<i[0]){u.boxEnd[0]=i[0];u.boxEnd[1]=u.boxStart[1]+(i[0]-u.boxStart[0])*Math.abs(w)}else if(u.boxEnd[0]>i[2]){u.boxEnd[0]=i[2];u.boxEnd[1]=u.boxStart[1]+(i[2]-u.boxStart[0])*Math.abs(w)}}}else{if(b)u.boxEnd[0]=u.boxStart[0];if(_)u.boxEnd[1]=u.boxStart[1]}}else if(u.boxEnabled){d=u.boxStart[0]!==u.boxEnd[0];m=u.boxStart[1]!==u.boxEnd[1];if(d||m){if(d){g(0,u.boxStart[0],u.boxEnd[0]);e.xaxis.autorange=false}if(m){g(1,u.boxStart[1],u.boxEnd[1]);e.yaxis.autorange=false}e.relayoutCallback()}else{e.glplot.setDirty()}u.boxEnabled=false;u.boxInited=false}else if(u.boxInited){u.boxInited=false}break;case"pan":u.boxEnabled=false;u.boxInited=false;if(t){if(!u.panning){u.dragStart[0]=a;u.dragStart[1]=n}if(Math.abs(u.dragStart[0]-a)<p)a=u.dragStart[0];if(Math.abs(u.dragStart[1]-n)<p)n=u.dragStart[1];d=(l-a)*(i[2]-i[0])/(r.viewBox[2]-r.viewBox[0]);m=(h-n)*(i[3]-i[1])/(r.viewBox[3]-r.viewBox[1]);i[0]+=d;i[2]+=d;i[1]+=m;i[3]+=m;e.setRanges(i);u.panning=true;u.lastInputTime=Date.now();c();e.cameraChanged();e.handleAnnotations()}else if(u.panning){u.panning=false;e.relayoutCallback()}break}u.lastPos[0]=a;u.lastPos[1]=n}u.wheelListener=n(t,(function(t,a){if(!e.scrollZoom)return false;var n=e.calcDataBox();var i=r.viewBox;var o=u.lastPos[0];var s=u.lastPos[1];var l=Math.exp(5*a/(i[3]-i[1]));var f=o/(i[2]-i[0])*(n[2]-n[0])+n[0];var h=s/(i[3]-i[1])*(n[3]-n[1])+n[1];n[0]=(n[0]-f)*l+f;n[2]=(n[2]-f)*l+f;n[1]=(n[1]-h)*l+h;n[3]=(n[3]-h)*l+h;e.setRanges(n);u.lastInputTime=Date.now();c();e.cameraChanged();e.handleAnnotations();e.relayoutCallback();return true}),true);return u}},{"../cartesian/constants":845,"has-passive-events":436,"mouse-change":459,"mouse-event-offset":460,"mouse-wheel":462}],877:[function(e,t,r){"use strict";var a=e("../cartesian/axes");var n=e("../../lib/str2rgbarray");function i(e){this.scene=e;this.gl=e.gl;this.pixelRatio=e.pixelRatio;this.screenBox=[0,0,1,1];this.viewBox=[0,0,1,1];this.dataBox=[-1,-1,1,1];this.borderLineEnable=[false,false,false,false];this.borderLineWidth=[1,1,1,1];this.borderLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.ticks=[[],[]];this.tickEnable=[true,true,false,false];this.tickPad=[15,15,15,15];this.tickAngle=[0,0,0,0];this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.tickMarkLength=[0,0,0,0];this.tickMarkWidth=[0,0,0,0];this.tickMarkColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.labels=["x","y"];this.labelEnable=[true,true,false,false];this.labelAngle=[0,Math.PI/2,0,3*Math.PI/2];this.labelPad=[15,15,15,15];this.labelSize=[12,12];this.labelFont=["sans-serif","sans-serif"];this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.title="";this.titleEnable=true;this.titleCenter=[0,0,0,0];this.titleAngle=0;this.titleColor=[0,0,0,1];this.titleFont="sans-serif";this.titleSize=18;this.gridLineEnable=[true,true];this.gridLineColor=[[0,0,0,.5],[0,0,0,.5]];this.gridLineWidth=[1,1];this.zeroLineEnable=[true,true];this.zeroLineWidth=[1,1];this.zeroLineColor=[[0,0,0,1],[0,0,0,1]];this.borderColor=[0,0,0,0];this.backgroundColor=[0,0,0,0];this.static=this.scene.staticPlot}var o=i.prototype;var s=["xaxis","yaxis"];o.merge=function(e){this.titleEnable=false;this.backgroundColor=n(e.plot_bgcolor);var t,r,a,i;var o,l,u,c,f;var h,p;for(h=0;h<2;++h){t=s[h];var v=t.charAt(0);r=e[this.scene[t]._name];a=r.title.text===this.scene.fullLayout._dfltTitle[v]?"":r.title.text;for(p=0;p<=2;p+=2){this.labelEnable[h+p]=false;this.labels[h+p]=a;this.labelColor[h+p]=n(r.title.font.color);this.labelFont[h+p]=r.title.font.family;this.labelSize[h+p]=r.title.font.size;this.labelPad[h+p]=this.getLabelPad(t,r);this.tickEnable[h+p]=false;this.tickColor[h+p]=n((r.tickfont||{}).color);this.tickAngle[h+p]=r.tickangle==="auto"?0:Math.PI*-r.tickangle/180;this.tickPad[h+p]=this.getTickPad(r);this.tickMarkLength[h+p]=0;this.tickMarkWidth[h+p]=r.tickwidth||0;this.tickMarkColor[h+p]=n(r.tickcolor);this.borderLineEnable[h+p]=false;this.borderLineColor[h+p]=n(r.linecolor);this.borderLineWidth[h+p]=r.linewidth||0}u=this.hasSharedAxis(r);o=this.hasAxisInDfltPos(t,r)&&!u;l=this.hasAxisInAltrPos(t,r)&&!u;i=r.mirror||false;c=u?String(i).indexOf("all")!==-1:!!i;f=u?i==="allticks":String(i).indexOf("ticks")!==-1;if(o)this.labelEnable[h]=true;else if(l)this.labelEnable[h+2]=true;if(o)this.tickEnable[h]=r.showticklabels;else if(l)this.tickEnable[h+2]=r.showticklabels;if(o||c)this.borderLineEnable[h]=r.showline;if(l||c)this.borderLineEnable[h+2]=r.showline;if(o||f)this.tickMarkLength[h]=this.getTickMarkLength(r);if(l||f)this.tickMarkLength[h+2]=this.getTickMarkLength(r);this.gridLineEnable[h]=r.showgrid;this.gridLineColor[h]=n(r.gridcolor);this.gridLineWidth[h]=r.gridwidth;this.zeroLineEnable[h]=r.zeroline;this.zeroLineColor[h]=n(r.zerolinecolor);this.zeroLineWidth[h]=r.zerolinewidth}};o.hasSharedAxis=function(e){var t=this.scene;var r=t.fullLayout._subplots.gl2d;var n=a.findSubplotsWithAxis(r,e);return n.indexOf(t.id)!==0};o.hasAxisInDfltPos=function(e,t){var r=t.side;if(e==="xaxis")return r==="bottom";else if(e==="yaxis")return r==="left"};o.hasAxisInAltrPos=function(e,t){var r=t.side;if(e==="xaxis")return r==="top";else if(e==="yaxis")return r==="right"};o.getLabelPad=function(e,t){var r=1.5;var a=t.title.font.size;var n=t.showticklabels;if(e==="xaxis"){return t.side==="top"?-10+a*(r+(n?1:0)):-10+a*(r+(n?.5:0))}else if(e==="yaxis"){return t.side==="right"?10+a*(r+(n?1:.5)):10+a*(r+(n?.5:0))}};o.getTickPad=function(e){return e.ticks==="outside"?10+e.ticklen:15};o.getTickMarkLength=function(e){if(!e.ticks)return 0;var t=e.ticklen;return e.ticks==="inside"?-t:t};function l(e){return new i(e)}t.exports=l},{"../../lib/str2rgbarray":812,"../cartesian/axes":838}],878:[function(e,t,r){"use strict";var a=e("../../plot_api/edit_types").overrideAll;var n=e("./scene2d");var i=e("../layout_attributes");var o=e("../../constants/xmlns_namespaces");var s=e("../cartesian/constants");var l=e("../cartesian");var u=e("../../components/fx/layout_attributes");var c=e("../get_data").getSubplotData;r.name="gl2d";r.attr=["xaxis","yaxis"];r.idRoot=["x","y"];r.idRegex=s.idRegex;r.attrRegex=s.attrRegex;r.attributes=e("../cartesian/attributes");r.supplyLayoutDefaults=function(e,t,r){if(!t._has("cartesian")){l.supplyLayoutDefaults(e,t,r)}};r.layoutAttrOverrides=a(l.layoutAttributes,"plot","from-root");r.baseLayoutAttrOverrides=a({plot_bgcolor:i.plot_bgcolor,hoverlabel:u.hoverlabel},"plot","nested");r.plot=function e(t){var r=t._fullLayout;var a=t._fullData;var i=r._subplots.gl2d;for(var o=0;o<i.length;o++){var s=i[o];var l=r._plots[s];var u=c(a,"gl2d",s);var f=l._scene2d;if(f===undefined){f=new n({id:s,graphDiv:t,container:t.querySelector(".gl-container"),staticPlot:t._context.staticPlot,plotGlPixelRatio:t._context.plotGlPixelRatio},r);l._scene2d=f}f.plot(u,t.calcdata,r,t.layout)}};r.clean=function(e,t,r,a){var n=a._subplots.gl2d||[];for(var i=0;i<n.length;i++){var o=n[i];var s=a._plots[o];if(!s._scene2d)continue;var u=c(e,"gl2d",o);if(u.length===0){s._scene2d.destroy();delete a._plots[o]}}l.clean.apply(this,arguments)};r.drawFramework=function(e){if(!e._context.staticPlot){l.drawFramework(e)}};r.toSVG=function(e){var t=e._fullLayout;var r=t._subplots.gl2d;for(var a=0;a<r.length;a++){var n=t._plots[r[a]];var i=n._scene2d;var s=i.toImage("png");var l=t._glimages.append("svg:image");l.attr({xmlns:o.svg,"xlink:href":s,x:0,y:0,width:"100%",height:"100%",preserveAspectRatio:"none"});i.destroy()}};r.updateFx=function(e){var t=e._fullLayout;var r=t._subplots.gl2d;for(var a=0;a<r.length;a++){var n=t._plots[r[a]]._scene2d;n.updateFx(t.dragmode)}}},{"../../components/fx/layout_attributes":691,"../../constants/xmlns_namespaces":764,"../../plot_api/edit_types":820,"../cartesian":852,"../cartesian/attributes":836,"../cartesian/constants":845,"../get_data":875,"../layout_attributes":892,"./scene2d":879}],879:[function(e,t,r){"use strict";var a=e("../../registry");var n=e("../../plots/cartesian/axes");var i=e("../../components/fx");var o=e("gl-plot2d");var s=e("gl-spikes2d");var l=e("gl-select-box");var u=e("webgl-context");var c=e("./convert");var f=e("./camera");var h=e("../../lib/show_no_webgl_msg");var p=e("../cartesian/constraints");var v=p.enforce;var d=p.clean;var m=e("../cartesian/autorange").doAutoRange;var g=e("../../components/dragelement/helpers");var y=g.drawMode;var x=g.selectMode;var b=["xaxis","yaxis"];var _,w;var T=e("../cartesian/constants").SUBPLOT_PATTERN;function k(e,t){this.container=e.container;this.graphDiv=e.graphDiv;this.pixelRatio=e.plotGlPixelRatio||window.devicePixelRatio;this.id=e.id;this.staticPlot=!!e.staticPlot;this.scrollZoom=this.graphDiv._context._scrollZoom.cartesian;this.fullData=null;this.updateRefs(t);this.makeFramework();if(this.stopped)return;this.glplotOptions=c(this);this.glplotOptions.merge(t);this.glplot=o(this.glplotOptions);this.camera=f(this);this.traces={};this.spikes=s(this.glplot);this.selectBox=l(this.glplot,{innerFill:false,outerFill:true});this.lastButtonState=0;this.pickResult=null;this.isMouseOver=true;this.stopped=false;this.redraw=this.draw.bind(this);this.redraw()}t.exports=k;var M=k.prototype;M.makeFramework=function(){if(this.staticPlot){if(!w){_=document.createElement("canvas");w=u({canvas:_,preserveDrawingBuffer:false,premultipliedAlpha:true,antialias:true});if(!w){throw new Error("Error creating static canvas/context for image server")}}this.canvas=_;this.gl=w}else{var e=this.container.querySelector(".gl-canvas-focus");var t=u({canvas:e,preserveDrawingBuffer:true,premultipliedAlpha:true});if(!t){h(this);this.stopped=true;return}this.canvas=e;this.gl=t}var r=this.canvas;r.style.width="100%";r.style.height="100%";r.style.position="absolute";r.style.top="0px";r.style.left="0px";r.style["pointer-events"]="none";this.updateSize(r);var a=this.svgContainer=document.createElementNS("http://www.w3.org/2000/svg","svg");a.style.position="absolute";a.style.top=a.style.left="0px";a.style.width=a.style.height="100%";a.style["z-index"]=20;a.style["pointer-events"]="none";var n=this.mouseContainer=document.createElement("div");n.style.position="absolute";n.style["pointer-events"]="auto";this.pickCanvas=this.container.querySelector(".gl-canvas-pick");var i=this.container;i.appendChild(a);i.appendChild(n);var o=this;n.addEventListener("mouseout",(function(){o.isMouseOver=false;o.unhover()}));n.addEventListener("mouseover",(function(){o.isMouseOver=true}))};M.toImage=function(e){if(!e)e="png";this.stopped=true;if(this.staticPlot)this.container.appendChild(_);this.updateSize(this.canvas);var t=this.glplot.gl;var r=t.drawingBufferWidth;var a=t.drawingBufferHeight;t.clearColor(1,1,1,0);t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT);this.glplot.setDirty();this.glplot.draw();t.bindFramebuffer(t.FRAMEBUFFER,null);var n=new Uint8Array(r*a*4);t.readPixels(0,0,r,a,t.RGBA,t.UNSIGNED_BYTE,n);for(var i=0,o=a-1;i<o;++i,--o){for(var s=0;s<r;++s){for(var l=0;l<4;++l){var u=n[4*(r*i+s)+l];n[4*(r*i+s)+l]=n[4*(r*o+s)+l];n[4*(r*o+s)+l]=u}}}var c=document.createElement("canvas");c.width=r;c.height=a;var f=c.getContext("2d");var h=f.createImageData(r,a);h.data.set(n);f.putImageData(h,0,0);var p;switch(e){case"jpeg":p=c.toDataURL("image/jpeg");break;case"webp":p=c.toDataURL("image/webp");break;default:p=c.toDataURL("image/png")}if(this.staticPlot)this.container.removeChild(_);return p};M.updateSize=function(e){if(!e)e=this.canvas;var t=this.pixelRatio;var r=this.fullLayout;var a=r.width;var n=r.height;var i=Math.ceil(t*a)|0;var o=Math.ceil(t*n)|0;if(e.width!==i||e.height!==o){e.width=i;e.height=o}return e};M.computeTickMarks=function(){this.xaxis.setScale();this.yaxis.setScale();var e=[n.calcTicks(this.xaxis),n.calcTicks(this.yaxis)];for(var t=0;t<2;++t){for(var r=0;r<e[t].length;++r){e[t][r].text=e[t][r].text+""}}return e};function A(e,t){for(var r=0;r<2;++r){var a=e[r];var n=t[r];if(a.length!==n.length)return true;for(var i=0;i<a.length;++i){if(a[i].x!==n[i].x)return true}}return false}M.updateRefs=function(e){this.fullLayout=e;var t=this.id.match(T);var r="xaxis"+t[1];var a="yaxis"+t[2];this.xaxis=this.fullLayout[r];this.yaxis=this.fullLayout[a]};M.relayoutCallback=function(){var e=this.graphDiv;var t=this.xaxis;var r=this.yaxis;var n=e.layout;var i={};var o=i[t._name+".range"]=t.range.slice();var s=i[r._name+".range"]=r.range.slice();i[t._name+".autorange"]=t.autorange;i[r._name+".autorange"]=r.autorange;a.call("_storeDirectGUIEdit",e.layout,e._fullLayout._preGUI,i);var l=n[t._name];l.range=o;l.autorange=t.autorange;var u=n[r._name];u.range=s;u.autorange=r.autorange;i.lastInputTime=this.camera.lastInputTime;e.emit("plotly_relayout",i)};M.cameraChanged=function(){var e=this.camera;this.glplot.setDataBox(this.calcDataBox());var t=this.computeTickMarks();var r=this.glplotOptions.ticks;if(A(t,r)){this.glplotOptions.ticks=t;this.glplotOptions.dataBox=e.dataBox;this.glplot.update(this.glplotOptions);this.handleAnnotations()}};M.handleAnnotations=function(){var e=this.graphDiv;var t=this.fullLayout.annotations;for(var r=0;r<t.length;r++){var n=t[r];if(n.xref===this.xaxis._id&&n.yref===this.yaxis._id){a.getComponentMethod("annotations","drawOne")(e,r)}}};M.destroy=function(){if(!this.glplot)return;var e=this.traces;if(e){Object.keys(e).map((function(t){e[t].dispose();delete e[t]}))}this.glplot.dispose();this.container.removeChild(this.svgContainer);this.container.removeChild(this.mouseContainer);this.fullData=null;this.glplot=null;this.stopped=true;this.camera.mouseListener.enabled=false;this.mouseContainer.removeEventListener("wheel",this.camera.wheelListener);this.camera=null};M.plot=function(e,t,r){var a=this.glplot;this.updateRefs(r);this.xaxis.clearCalc();this.yaxis.clearCalc();this.updateTraces(e,t);this.updateFx(r.dragmode);var n=r.width;var i=r.height;this.updateSize(this.canvas);var o=this.glplotOptions;o.merge(r);o.screenBox=[0,0,n,i];var s={_fullLayout:{_axisConstraintGroups:r._axisConstraintGroups,xaxis:this.xaxis,yaxis:this.yaxis,_size:r._size}};d(s,this.xaxis);d(s,this.yaxis);var l=r._size;var u=this.xaxis.domain;var c=this.yaxis.domain;o.viewBox=[l.l+u[0]*l.w,l.b+c[0]*l.h,n-l.r-(1-u[1])*l.w,i-l.t-(1-c[1])*l.h];this.mouseContainer.style.width=l.w*(u[1]-u[0])+"px";this.mouseContainer.style.height=l.h*(c[1]-c[0])+"px";this.mouseContainer.height=l.h*(c[1]-c[0]);this.mouseContainer.style.left=l.l+u[0]*l.w+"px";this.mouseContainer.style.top=l.t+(1-c[1])*l.h+"px";var f,h;for(h=0;h<2;++h){f=this[b[h]];f._length=o.viewBox[h+2]-o.viewBox[h];m(this.graphDiv,f);f.setScale()}v(s);o.ticks=this.computeTickMarks();o.dataBox=this.calcDataBox();o.merge(r);a.update(o);this.glplot.draw()};M.calcDataBox=function(){var e=this.xaxis;var t=this.yaxis;var r=e.range;var a=t.range;var n=e.r2l;var i=t.r2l;return[n(r[0]),i(a[0]),n(r[1]),i(a[1])]};M.setRanges=function(e){var t=this.xaxis;var r=this.yaxis;var a=t.l2r;var n=r.l2r;t.range=[a(e[0]),a(e[2])];r.range=[n(e[1]),n(e[3])]};M.updateTraces=function(e,t){var r=Object.keys(this.traces);var a,n,i;this.fullData=e;e:for(a=0;a<r.length;a++){var o=r[a];var s=this.traces[o];for(n=0;n<e.length;n++){i=e[n];if(i.uid===o&&i.type===s.type){continue e}}s.dispose();delete this.traces[o]}for(a=0;a<e.length;a++){i=e[a];var l=t[a];var u=this.traces[i.uid];if(u)u.update(i,l);else{u=i._module.plot(this,i,l);this.traces[i.uid]=u}}this.glplot.objects.sort((function(e,t){return e._trace.index-t._trace.index}))};M.updateFx=function(e){if(x(e)||y(e)){this.pickCanvas.style["pointer-events"]="none";this.mouseContainer.style["pointer-events"]="none"}else{this.pickCanvas.style["pointer-events"]="auto";this.mouseContainer.style["pointer-events"]="auto"}if(e==="pan"){this.mouseContainer.style.cursor="move"}else if(e==="zoom"){this.mouseContainer.style.cursor="crosshair"}else{this.mouseContainer.style.cursor=null}};M.emitPointAction=function(e,t){var r=e.trace.uid;var a=e.pointIndex;var n;for(var o=0;o<this.fullData.length;o++){if(this.fullData[o].uid===r){n=this.fullData[o]}}var s={x:e.traceCoord[0],y:e.traceCoord[1],curveNumber:n.index,pointNumber:a,data:n._input,fullData:this.fullData,xaxis:this.xaxis,yaxis:this.yaxis};i.appendArrayPointValue(s,n,a);this.graphDiv.emit(t,{points:[s]})};M.draw=function(){if(this.stopped)return;requestAnimationFrame(this.redraw);var e=this.glplot;var t=this.camera;var r=t.mouseListener;var a=this.lastButtonState===1&&r.buttons===0;var n=this.fullLayout;this.lastButtonState=r.buttons;this.cameraChanged();var o=r.x*e.pixelRatio;var s=this.canvas.height-e.pixelRatio*r.y;var l;if(t.boxEnabled&&n.dragmode==="zoom"){this.selectBox.enabled=true;var u=this.selectBox.selectBox=[Math.min(t.boxStart[0],t.boxEnd[0]),Math.min(t.boxStart[1],t.boxEnd[1]),Math.max(t.boxStart[0],t.boxEnd[0]),Math.max(t.boxStart[1],t.boxEnd[1])];for(var c=0;c<2;c++){if(t.boxStart[c]===t.boxEnd[c]){u[c]=e.dataBox[c];u[c+2]=e.dataBox[c+2]}}e.setDirty()}else if(!t.panning&&this.isMouseOver){this.selectBox.enabled=false;var f=n._size;var h=this.xaxis.domain;var p=this.yaxis.domain;l=e.pick(o/e.pixelRatio+f.l+h[0]*f.w,s/e.pixelRatio-(f.t+(1-p[1])*f.h));var v=l&&l.object._trace.handlePick(l);if(v&&a){this.emitPointAction(v,"plotly_click")}if(l&&l.object._trace.hoverinfo!=="skip"&&n.hovermode){if(v&&(!this.lastPickResult||this.lastPickResult.traceUid!==v.trace.uid||this.lastPickResult.dataCoord[0]!==v.dataCoord[0]||this.lastPickResult.dataCoord[1]!==v.dataCoord[1])){var d=v;this.lastPickResult={traceUid:v.trace?v.trace.uid:null,dataCoord:v.dataCoord.slice()};this.spikes.update({center:l.dataCoord});d.screenCoord=[((e.viewBox[2]-e.viewBox[0])*(l.dataCoord[0]-e.dataBox[0])/(e.dataBox[2]-e.dataBox[0])+e.viewBox[0])/e.pixelRatio,(this.canvas.height-(e.viewBox[3]-e.viewBox[1])*(l.dataCoord[1]-e.dataBox[1])/(e.dataBox[3]-e.dataBox[1])-e.viewBox[1])/e.pixelRatio];this.emitPointAction(v,"plotly_hover");var m=this.fullData[d.trace.index]||{};var g=d.pointIndex;var y=i.castHoverinfo(m,n,g);if(y&&y!=="all"){var x=y.split("+");if(x.indexOf("x")===-1)d.traceCoord[0]=undefined;if(x.indexOf("y")===-1)d.traceCoord[1]=undefined;if(x.indexOf("z")===-1)d.traceCoord[2]=undefined;if(x.indexOf("text")===-1)d.textLabel=undefined;if(x.indexOf("name")===-1)d.name=undefined}i.loneHover({x:d.screenCoord[0],y:d.screenCoord[1],xLabel:this.hoverFormatter("xaxis",d.traceCoord[0]),yLabel:this.hoverFormatter("yaxis",d.traceCoord[1]),zLabel:d.traceCoord[2],text:d.textLabel,name:d.name,color:i.castHoverOption(m,g,"bgcolor")||d.color,borderColor:i.castHoverOption(m,g,"bordercolor"),fontFamily:i.castHoverOption(m,g,"font.family"),fontSize:i.castHoverOption(m,g,"font.size"),fontColor:i.castHoverOption(m,g,"font.color"),nameLength:i.castHoverOption(m,g,"namelength"),textAlign:i.castHoverOption(m,g,"align")},{container:this.svgContainer,gd:this.graphDiv})}}}if(!l){this.unhover()}e.draw()};M.unhover=function(){if(this.lastPickResult){this.spikes.update({});this.lastPickResult=null;this.graphDiv.emit("plotly_unhover");i.loneUnhover(this.svgContainer)}};M.hoverFormatter=function(e,t){if(t===undefined)return undefined;var r=this[e];return n.tickText(r,r.c2l(t),"hover").text}},{"../../components/dragelement/helpers":668,"../../components/fx":690,"../../lib/show_no_webgl_msg":809,"../../plots/cartesian/axes":838,"../../registry":915,"../cartesian/autorange":837,"../cartesian/constants":845,"../cartesian/constraints":846,"./camera":876,"./convert":877,"gl-plot2d":316,"gl-select-box":330,"gl-spikes2d":339,"webgl-context":613}],880:[function(e,t,r){"use strict";var a=e("../../plot_api/edit_types").overrideAll;var n=e("../../components/fx/layout_attributes");var i=e("./scene");var o=e("../get_data").getSubplotData;var s=e("../../lib");var l=e("../../constants/xmlns_namespaces");var u="gl3d";var c="scene";r.name=u;r.attr=c;r.idRoot=c;r.idRegex=r.attrRegex=s.counterRegex("scene");r.attributes=e("./layout/attributes");r.layoutAttributes=e("./layout/layout_attributes");r.baseLayoutAttrOverrides=a({hoverlabel:n.hoverlabel},"plot","nested");r.supplyLayoutDefaults=e("./layout/defaults");r.plot=function e(t){var r=t._fullLayout;var a=t._fullData;var n=r._subplots[u];for(var s=0;s<n.length;s++){var l=n[s];var c=o(a,u,l);var f=r[l];var h=f.camera;var p=f._scene;if(!p){p=new i({id:l,graphDiv:t,container:t.querySelector(".gl-container"),staticPlot:t._context.staticPlot,plotGlPixelRatio:t._context.plotGlPixelRatio,camera:h},r);f._scene=p}if(!p.viewInitial){p.viewInitial={up:{x:h.up.x,y:h.up.y,z:h.up.z},eye:{x:h.eye.x,y:h.eye.y,z:h.eye.z},center:{x:h.center.x,y:h.center.y,z:h.center.z}}}p.plot(c,r,t.layout)}};r.clean=function(e,t,r,a){var n=a._subplots[u]||[];for(var i=0;i<n.length;i++){var o=n[i];if(!t[o]&&!!a[o]._scene){a[o]._scene.destroy();if(a._infolayer){a._infolayer.selectAll(".annotation-"+o).remove()}}}};r.toSVG=function(e){var t=e._fullLayout;var r=t._subplots[u];var a=t._size;for(var n=0;n<r.length;n++){var i=t[r[n]];var o=i.domain;var s=i._scene;var c=s.toImage("png");var f=t._glimages.append("svg:image");f.attr({xmlns:l.svg,"xlink:href":c,x:a.l+a.w*o.x[0],y:a.t+a.h*(1-o.y[1]),width:a.w*(o.x[1]-o.x[0]),height:a.h*(o.y[1]-o.y[0]),preserveAspectRatio:"none"});s.destroy()}};r.cleanId=function e(t){if(!t.match(/^scene[0-9]*$/))return;var r=t.substr(5);if(r==="1")r="";return c+r};r.updateFx=function(e){var t=e._fullLayout;var r=t._subplots[u];for(var a=0;a<r.length;a++){var n=t[r[a]]._scene;n.updateFx(t.dragmode,t.hovermode)}}},{"../../components/fx/layout_attributes":691,"../../constants/xmlns_namespaces":764,"../../lib":787,"../../plot_api/edit_types":820,"../get_data":875,"./layout/attributes":881,"./layout/defaults":885,"./layout/layout_attributes":886,"./scene":890}],881:[function(e,t,r){"use strict";t.exports={scene:{valType:"subplotid",dflt:"scene",editType:"calc+clearAxisTypes"}}},{}],882:[function(e,t,r){"use strict";var a=e("../../../components/color");var n=e("../../cartesian/layout_attributes");var i=e("../../../lib/extend").extendFlat;var o=e("../../../plot_api/edit_types").overrideAll;t.exports=o({visible:n.visible,showspikes:{valType:"boolean",dflt:true},spikesides:{valType:"boolean",dflt:true},spikethickness:{valType:"number",min:0,dflt:2},spikecolor:{valType:"color",dflt:a.defaultLine},showbackground:{valType:"boolean",dflt:false},backgroundcolor:{valType:"color",dflt:"rgba(204, 204, 204, 0.5)"},showaxeslabels:{valType:"boolean",dflt:true},color:n.color,categoryorder:n.categoryorder,categoryarray:n.categoryarray,title:{text:n.title.text,font:n.title.font},type:i({},n.type,{values:["-","linear","log","date","category"]}),autotypenumbers:n.autotypenumbers,autorange:n.autorange,rangemode:n.rangemode,range:i({},n.range,{items:[{valType:"any",editType:"plot",impliedEdits:{"^autorange":false}},{valType:"any",editType:"plot",impliedEdits:{"^autorange":false}}],anim:false}),tickmode:n.tickmode,nticks:n.nticks,tick0:n.tick0,dtick:n.dtick,tickvals:n.tickvals,ticktext:n.ticktext,ticks:n.ticks,mirror:n.mirror,ticklen:n.ticklen,tickwidth:n.tickwidth,tickcolor:n.tickcolor,showticklabels:n.showticklabels,tickfont:n.tickfont,tickangle:n.tickangle,tickprefix:n.tickprefix,showtickprefix:n.showtickprefix,ticksuffix:n.ticksuffix,showticksuffix:n.showticksuffix,showexponent:n.showexponent,exponentformat:n.exponentformat,minexponent:n.minexponent,separatethousands:n.separatethousands,tickformat:n.tickformat,tickformatstops:n.tickformatstops,hoverformat:n.hoverformat,showline:n.showline,linecolor:n.linecolor,linewidth:n.linewidth,showgrid:n.showgrid,gridcolor:i({},n.gridcolor,{dflt:"rgb(204, 204, 204)"}),gridwidth:n.gridwidth,zeroline:n.zeroline,zerolinecolor:n.zerolinecolor,zerolinewidth:n.zerolinewidth,_deprecated:{title:n._deprecated.title,titlefont:n._deprecated.titlefont}},"plot","from-root")},{"../../../components/color":650,"../../../lib/extend":777,"../../../plot_api/edit_types":820,"../../cartesian/layout_attributes":853}],883:[function(e,t,r){"use strict";var a=e("tinycolor2").mix;var n=e("../../../lib");var i=e("../../../plot_api/plot_template");var o=e("./axis_attributes");var s=e("../../cartesian/type_defaults");var l=e("../../cartesian/axis_defaults");var u=["xaxis","yaxis","zaxis"];var c=100*(204-68)/(255-68);t.exports=function e(t,r,f){var h,p;function v(e,t){return n.coerce(h,p,o,e,t)}for(var d=0;d<u.length;d++){var m=u[d];h=t[m]||{};p=i.newContainer(r,m);p._id=m[0]+f.scene;p._name=m;s(h,p,v,f);l(h,p,v,{font:f.font,letter:m[0],data:f.data,showGrid:true,noTickson:true,noTicklabelmode:true,noTicklabelposition:true,noTicklabeloverflow:true,bgColor:f.bgColor,calendar:f.calendar},f.fullLayout);v("gridcolor",a(p.color,f.bgColor,c).toRgbString());v("title.text",m[0]);p.setScale=n.noop;if(v("showspikes")){v("spikesides");v("spikethickness");v("spikecolor",p.color)}v("showaxeslabels");if(v("showbackground"))v("backgroundcolor")}}},{"../../../lib":787,"../../../plot_api/plot_template":827,"../../cartesian/axis_defaults":840,"../../cartesian/type_defaults":864,"./axis_attributes":882,tinycolor2:583}],884:[function(e,t,r){"use strict";var a=e("../../../lib/str2rgbarray");var n=e("../../../lib");var i=["xaxis","yaxis","zaxis"];function o(){this.bounds=[[-10,-10,-10],[10,10,10]];this.ticks=[[],[],[]];this.tickEnable=[true,true,true];this.tickFont=["sans-serif","sans-serif","sans-serif"];this.tickSize=[12,12,12];this.tickAngle=[0,0,0];this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.tickPad=[18,18,18];this.labels=["x","y","z"];this.labelEnable=[true,true,true];this.labelFont=["Open Sans","Open Sans","Open Sans"];this.labelSize=[20,20,20];this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.labelPad=[30,30,30];this.lineEnable=[true,true,true];this.lineMirror=[false,false,false];this.lineWidth=[1,1,1];this.lineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.lineTickEnable=[true,true,true];this.lineTickMirror=[false,false,false];this.lineTickLength=[10,10,10];this.lineTickWidth=[1,1,1];this.lineTickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.gridEnable=[true,true,true];this.gridWidth=[1,1,1];this.gridColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.zeroEnable=[true,true,true];this.zeroLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.zeroLineWidth=[2,2,2];this.backgroundEnable=[true,true,true];this.backgroundColor=[[.8,.8,.8,.5],[.8,.8,.8,.5],[.8,.8,.8,.5]];this._defaultTickPad=this.tickPad.slice();this._defaultLabelPad=this.labelPad.slice();this._defaultLineTickLength=this.lineTickLength.slice()}var s=o.prototype;s.merge=function(e,t){var r=this;for(var o=0;o<3;++o){var s=t[i[o]];if(!s.visible){r.tickEnable[o]=false;r.labelEnable[o]=false;r.lineEnable[o]=false;r.lineTickEnable[o]=false;r.gridEnable[o]=false;r.zeroEnable[o]=false;r.backgroundEnable[o]=false;continue}r.labels[o]=e._meta?n.templateString(s.title.text,e._meta):s.title.text;if("font"in s.title){if(s.title.font.color)r.labelColor[o]=a(s.title.font.color);if(s.title.font.family)r.labelFont[o]=s.title.font.family;if(s.title.font.size)r.labelSize[o]=s.title.font.size}if("showline"in s)r.lineEnable[o]=s.showline;if("linecolor"in s)r.lineColor[o]=a(s.linecolor);if("linewidth"in s)r.lineWidth[o]=s.linewidth;if("showgrid"in s)r.gridEnable[o]=s.showgrid;if("gridcolor"in s)r.gridColor[o]=a(s.gridcolor);if("gridwidth"in s)r.gridWidth[o]=s.gridwidth;if(s.type==="log")r.zeroEnable[o]=false;else if("zeroline"in s)r.zeroEnable[o]=s.zeroline;if("zerolinecolor"in s)r.zeroLineColor[o]=a(s.zerolinecolor);if("zerolinewidth"in s)r.zeroLineWidth[o]=s.zerolinewidth;if("ticks"in s&&!!s.ticks)r.lineTickEnable[o]=true;else r.lineTickEnable[o]=false;if("ticklen"in s){r.lineTickLength[o]=r._defaultLineTickLength[o]=s.ticklen}if("tickcolor"in s)r.lineTickColor[o]=a(s.tickcolor);if("tickwidth"in s)r.lineTickWidth[o]=s.tickwidth;if("tickangle"in s){r.tickAngle[o]=s.tickangle==="auto"?-3600:Math.PI*-s.tickangle/180}if("showticklabels"in s)r.tickEnable[o]=s.showticklabels;if("tickfont"in s){if(s.tickfont.color)r.tickColor[o]=a(s.tickfont.color);if(s.tickfont.family)r.tickFont[o]=s.tickfont.family;if(s.tickfont.size)r.tickSize[o]=s.tickfont.size}if("mirror"in s){if(["ticks","all","allticks"].indexOf(s.mirror)!==-1){r.lineTickMirror[o]=true;r.lineMirror[o]=true}else if(s.mirror===true){r.lineTickMirror[o]=false;r.lineMirror[o]=true}else{r.lineTickMirror[o]=false;r.lineMirror[o]=false}}else r.lineMirror[o]=false;if("showbackground"in s&&s.showbackground!==false){r.backgroundEnable[o]=true;r.backgroundColor[o]=a(s.backgroundcolor)}else r.backgroundEnable[o]=false}};function l(e,t){var r=new o;r.merge(e,t);return r}t.exports=l},{"../../../lib":787,"../../../lib/str2rgbarray":812}],885:[function(e,t,r){"use strict";var a=e("../../../lib");var n=e("../../../components/color");var i=e("../../../registry");var o=e("../../subplot_defaults");var s=e("./axis_defaults");var l=e("./layout_attributes");var u=e("../../get_data").getSubplotData;var c="gl3d";t.exports=function e(t,r,n){var i=r._basePlotModules.length>1;function s(e){if(i)return;var r=a.validate(t[e],l[e]);if(r)return t[e]}o(t,r,n,{type:c,attributes:l,handleDefaults:f,fullLayout:r,font:r.font,fullData:n,getDfltFromLayout:s,autotypenumbersDflt:r.autotypenumbers,paper_bgcolor:r.paper_bgcolor,calendar:r.calendar})};function f(e,t,r,a){var o=r("bgcolor");var l=n.combine(o,a.paper_bgcolor);var f=["up","center","eye"];for(var h=0;h<f.length;h++){r("camera."+f[h]+".x");r("camera."+f[h]+".y");r("camera."+f[h]+".z")}r("camera.projection.type");var p=!!r("aspectratio.x")&&!!r("aspectratio.y")&&!!r("aspectratio.z");var v=p?"manual":"auto";var d=r("aspectmode",v);if(!p){e.aspectratio=t.aspectratio={x:1,y:1,z:1};if(d==="manual")t.aspectmode="auto";e.aspectmode=t.aspectmode}var m=u(a.fullData,c,a.id);s(e,t,{font:a.font,scene:a.id,data:m,bgColor:l,calendar:a.calendar,autotypenumbersDflt:a.autotypenumbersDflt,fullLayout:a.fullLayout});i.getComponentMethod("annotations3d","handleDefaults")(e,t,a);var g=a.getDfltFromLayout("dragmode");if(g!==false){if(!g){g="orbit";if(e.camera&&e.camera.up){var y=e.camera.up.x;var x=e.camera.up.y;var b=e.camera.up.z;if(b!==0){if(!y||!x||!b){g="turntable"}else if(b/Math.sqrt(y*y+x*x+b*b)>.999){g="turntable"}}}else{g="turntable"}}}r("dragmode",g);r("hovermode",a.getDfltFromLayout("hovermode"))}},{"../../../components/color":650,"../../../lib":787,"../../../registry":915,"../../get_data":875,"../../subplot_defaults":909,"./axis_defaults":883,"./layout_attributes":886}],886:[function(e,t,r){"use strict";var a=e("./axis_attributes");var n=e("../../domain").attributes;var i=e("../../../lib/extend").extendFlat;var o=e("../../../lib").counterRegex;function s(e,t,r){return{x:{valType:"number",dflt:e,editType:"camera"},y:{valType:"number",dflt:t,editType:"camera"},z:{valType:"number",dflt:r,editType:"camera"},editType:"camera"}}t.exports={_arrayAttrRegexps:[o("scene",".annotations",true)],bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"plot"},camera:{up:i(s(0,0,1),{}),center:i(s(0,0,0),{}),eye:i(s(1.25,1.25,1.25),{}),projection:{type:{valType:"enumerated",values:["perspective","orthographic"],dflt:"perspective",editType:"calc"},editType:"calc"},editType:"camera"},domain:n({name:"scene",editType:"plot"}),aspectmode:{valType:"enumerated",values:["auto","cube","data","manual"],dflt:"auto",editType:"plot",impliedEdits:{"aspectratio.x":undefined,"aspectratio.y":undefined,"aspectratio.z":undefined}},aspectratio:{x:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},y:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},z:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},editType:"plot",impliedEdits:{aspectmode:"manual"}},xaxis:a,yaxis:a,zaxis:a,dragmode:{valType:"enumerated",values:["orbit","turntable","zoom","pan",false],editType:"plot"},hovermode:{valType:"enumerated",values:["closest",false],dflt:"closest",editType:"modebar"},uirevision:{valType:"any",editType:"none"},editType:"plot",_deprecated:{cameraposition:{valType:"info_array",editType:"camera"}}}},{"../../../lib":787,"../../../lib/extend":777,"../../domain":866,"./axis_attributes":882}],887:[function(e,t,r){"use strict";var a=e("../../../lib/str2rgbarray");var n=["xaxis","yaxis","zaxis"];function i(){this.enabled=[true,true,true];this.colors=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.drawSides=[true,true,true];this.lineWidth=[1,1,1]}var o=i.prototype;o.merge=function(e){for(var t=0;t<3;++t){var r=e[n[t]];if(!r.visible){this.enabled[t]=false;this.drawSides[t]=false;continue}this.enabled[t]=r.showspikes;this.colors[t]=a(r.spikecolor);this.drawSides[t]=r.spikesides;this.lineWidth[t]=r.spikethickness}};function s(e){var t=new i;t.merge(e);return t}t.exports=s},{"../../../lib/str2rgbarray":812}],888:[function(e,t,r){"use strict";t.exports=l;var a=e("../../cartesian/axes");var n=e("../../../lib");var i=["xaxis","yaxis","zaxis"];var o=[0,0,0];function s(e){var t=new Array(3);for(var r=0;r<3;++r){var a=e[r];var n=new Array(a.length);for(var i=0;i<a.length;++i){n[i]=a[i].x}t[r]=n}return t}function l(e){var t=e.axesOptions;var r=e.glplot.axesPixels;var l=e.fullSceneLayout;var u=[[],[],[]];for(var c=0;c<3;++c){var f=l[i[c]];f._length=(r[c].hi-r[c].lo)*r[c].pixelsPerDataUnit/e.dataScale[c];if(Math.abs(f._length)===Infinity||isNaN(f._length)){u[c]=[]}else{f._input_range=f.range.slice();f.range[0]=r[c].lo/e.dataScale[c];f.range[1]=r[c].hi/e.dataScale[c];f._m=1/(e.dataScale[c]*r[c].pixelsPerDataUnit);if(f.range[0]===f.range[1]){f.range[0]-=1;f.range[1]+=1}var h=f.tickmode;if(f.tickmode==="auto"){f.tickmode="linear";var p=f.nticks||n.constrain(f._length/40,4,9);a.autoTicks(f,Math.abs(f.range[1]-f.range[0])/p)}var v=a.calcTicks(f,{msUTC:true});for(var d=0;d<v.length;++d){v[d].x=v[d].x*e.dataScale[c];if(f.type==="date"){v[d].text=v[d].text.replace(/\<br\>/g," ")}}u[c]=v;f.tickmode=h}}t.ticks=u;for(var c=0;c<3;++c){o[c]=.5*(e.glplot.bounds[0][c]+e.glplot.bounds[1][c]);for(var d=0;d<2;++d){t.bounds[d][c]=e.glplot.bounds[d][c]}}e.contourLevels=s(u)}},{"../../../lib":787,"../../cartesian/axes":838}],889:[function(e,t,r){"use strict";function a(e,t){var r=[0,0,0,0];var a,n;for(a=0;a<4;++a){for(n=0;n<4;++n){r[n]+=e[4*a+n]*t[a]}}return r}function n(e,t){var r=a(e.projection,a(e.view,a(e.model,[t[0],t[1],t[2],1])));return r}t.exports=n},{}],890:[function(e,t,r){"use strict";var a=e("gl-plot3d");var n=a.createCamera;var i=a.createScene;var o=e("webgl-context");var s=e("has-passive-events");var l=e("../../registry");var u=e("../../lib");var c=u.preserveDrawingBuffer();var f=e("../../plots/cartesian/axes");var h=e("../../components/fx");var p=e("../../lib/str2rgbarray");var v=e("../../lib/show_no_webgl_msg");var d=e("./project");var m=e("./layout/convert");var g=e("./layout/spikes");var y=e("./layout/tick_marks");var x,b;function _(e,t){var r=document.createElement("div");var a=e.container;this.graphDiv=e.graphDiv;var n=document.createElementNS("http://www.w3.org/2000/svg","svg");n.style.position="absolute";n.style.top=n.style.left="0px";n.style.width=n.style.height="100%";n.style["z-index"]=20;n.style["pointer-events"]="none";r.appendChild(n);this.svgContainer=n;r.id=e.id;r.style.position="absolute";r.style.top=r.style.left="0px";r.style.width=r.style.height="100%";a.appendChild(r);this.fullLayout=t;this.id=e.id||"scene";this.fullSceneLayout=t[this.id];this.plotArgs=[[],{},{}];this.axesOptions=m(t,t[this.id]);this.spikeOptions=g(t[this.id]);this.container=r;this.staticMode=!!e.staticPlot;this.pixelRatio=this.pixelRatio||e.plotGlPixelRatio||2;this.dataScale=[1,1,1];this.contourLevels=[[],[],[]];this.convertAnnotations=l.getComponentMethod("annotations3d","convert");this.drawAnnotations=l.getComponentMethod("annotations3d","draw");this.initializeGLPlot()}var w=_.prototype;w.prepareOptions=function(){var e=this;var t={canvas:e.canvas,gl:e.gl,glOptions:{preserveDrawingBuffer:c,premultipliedAlpha:true,antialias:true},container:e.container,axes:e.axesOptions,spikes:e.spikeOptions,pickRadius:10,snapToData:true,autoScale:true,autoBounds:false,cameraObject:e.camera,pixelRatio:e.pixelRatio};if(e.staticMode){if(!b){x=document.createElement("canvas");b=o({canvas:x,preserveDrawingBuffer:true,premultipliedAlpha:true,antialias:true});if(!b){throw new Error("error creating static canvas/context for image server")}}t.gl=b;t.canvas=x}return t};var T=true;w.tryCreatePlot=function(){var e=this;var t=e.prepareOptions();var r=true;try{e.glplot=i(t)}catch(a){if(e.staticMode||!T||c){r=false}else{u.warn(["webgl setup failed possibly due to","false preserveDrawingBuffer config.","The mobile/tablet device may not be detected by is-mobile module.","Enabling preserveDrawingBuffer in second attempt to create webgl scene..."].join(" "));try{c=t.glOptions.preserveDrawingBuffer=true;e.glplot=i(t)}catch(a){c=t.glOptions.preserveDrawingBuffer=false;r=false}}}T=false;return r};w.initializeGLCamera=function(){var e=this;var t=e.fullSceneLayout.camera;var r=t.projection.type==="orthographic";e.camera=n(e.container,{center:[t.center.x,t.center.y,t.center.z],eye:[t.eye.x,t.eye.y,t.eye.z],up:[t.up.x,t.up.y,t.up.z],_ortho:r,zoomMin:.01,zoomMax:100,mode:"orbit"})};w.initializeGLPlot=function(){var e=this;e.initializeGLCamera();var t=e.tryCreatePlot();if(!t)return v(e);e.traces={};e.make4thDimension();var r=e.graphDiv;var a=r.layout;var n=function(){var t={};if(e.isCameraChanged(a)){t[e.id+".camera"]=e.getCamera()}if(e.isAspectChanged(a)){t[e.id+".aspectratio"]=e.glplot.getAspectratio();if(a[e.id].aspectmode!=="manual"){e.fullSceneLayout.aspectmode=a[e.id].aspectmode=t[e.id+".aspectmode"]="manual"}}return t};var i=function(e){if(e.fullSceneLayout.dragmode===false)return;var t=n();e.saveLayout(a);e.graphDiv.emit("plotly_relayout",t)};if(e.glplot.canvas){e.glplot.canvas.addEventListener("mouseup",(function(){i(e)}));e.glplot.canvas.addEventListener("wheel",(function(t){if(r._context._scrollZoom.gl3d){if(e.camera._ortho){var a=t.deltaX>t.deltaY?1.1:1/1.1;var n=e.glplot.getAspectratio();e.glplot.setAspectratio({x:a*n.x,y:a*n.y,z:a*n.z})}i(e)}}),s?{passive:false}:false);e.glplot.canvas.addEventListener("mousemove",(function(){if(e.fullSceneLayout.dragmode===false)return;if(e.camera.mouseListener.buttons===0)return;var t=n();e.graphDiv.emit("plotly_relayouting",t)}));if(!e.staticMode){e.glplot.canvas.addEventListener("webglcontextlost",(function(t){if(r&&r.emit){r.emit("plotly_webglcontextlost",{event:t,layer:e.id})}}),false)}}e.glplot.oncontextloss=function(){e.recoverContext()};e.glplot.onrender=function(){e.render()};return true};w.render=function(){var e=this;var t=e.graphDiv;var r;var a=e.svgContainer;var n=e.container.getBoundingClientRect();t._fullLayout._calcInverseTransform(t);var i=t._fullLayout._invScaleX;var o=t._fullLayout._invScaleY;var s=n.width*i;var l=n.height*o;a.setAttributeNS(null,"viewBox","0 0 "+s+" "+l);a.setAttributeNS(null,"width",s);a.setAttributeNS(null,"height",l);y(e);e.glplot.axes.update(e.axesOptions);var c=Object.keys(e.traces);var p=null;var v=e.glplot.selection;for(var m=0;m<c.length;++m){r=e.traces[c[m]];if(r.data.hoverinfo!=="skip"&&r.handlePick(v)){p=r}if(r.setContourLevels)r.setContourLevels()}function g(t,r,a){var n=e.fullSceneLayout[t+"axis"];if(n.type!=="log"){r=n.d2l(r)}return f.hoverLabelText(n,r,a)}var x;if(p!==null){var b=d(e.glplot.cameraParams,v.dataCoordinate);r=p.data;var _=t._fullData[r.index];var w=v.index;var T={xLabel:g("x",v.traceCoordinate[0],r.xhoverformat),yLabel:g("y",v.traceCoordinate[1],r.yhoverformat),zLabel:g("z",v.traceCoordinate[2],r.zhoverformat)};var k=h.castHoverinfo(_,e.fullLayout,w);var M=(k||"").split("+");var A=k&&k==="all";if(!_.hovertemplate&&!A){if(M.indexOf("x")===-1)T.xLabel=undefined;if(M.indexOf("y")===-1)T.yLabel=undefined;if(M.indexOf("z")===-1)T.zLabel=undefined;if(M.indexOf("text")===-1)v.textLabel=undefined;if(M.indexOf("name")===-1)p.name=undefined}var S;var E=[];if(r.type==="cone"||r.type==="streamtube"){T.uLabel=g("x",v.traceCoordinate[3],r.uhoverformat);if(A||M.indexOf("u")!==-1){E.push("u: "+T.uLabel)}T.vLabel=g("y",v.traceCoordinate[4],r.vhoverformat);if(A||M.indexOf("v")!==-1){E.push("v: "+T.vLabel)}T.wLabel=g("z",v.traceCoordinate[5],r.whoverformat);if(A||M.indexOf("w")!==-1){E.push("w: "+T.wLabel)}T.normLabel=v.traceCoordinate[6].toPrecision(3);if(A||M.indexOf("norm")!==-1){E.push("norm: "+T.normLabel)}if(r.type==="streamtube"){T.divergenceLabel=v.traceCoordinate[7].toPrecision(3);if(A||M.indexOf("divergence")!==-1){E.push("divergence: "+T.divergenceLabel)}}if(v.textLabel){E.push(v.textLabel)}S=E.join("<br>")}else if(r.type==="isosurface"||r.type==="volume"){T.valueLabel=f.hoverLabelText(e._mockAxis,e._mockAxis.d2l(v.traceCoordinate[3]),r.valuehoverformat);E.push("value: "+T.valueLabel);if(v.textLabel){E.push(v.textLabel)}S=E.join("<br>")}else{S=v.textLabel}var L={x:v.traceCoordinate[0],y:v.traceCoordinate[1],z:v.traceCoordinate[2],data:_._input,fullData:_,curveNumber:_.index,pointNumber:w};h.appendArrayPointValue(L,_,w);if(r._module.eventData){L=_._module.eventData(L,v,_,{},w)}var C={points:[L]};if(e.fullSceneLayout.hovermode){var I=[];h.loneHover({trace:_,x:(.5+.5*b[0]/b[3])*s,y:(.5-.5*b[1]/b[3])*l,xLabel:T.xLabel,yLabel:T.yLabel,zLabel:T.zLabel,text:S,name:p.name,color:h.castHoverOption(_,w,"bgcolor")||p.color,borderColor:h.castHoverOption(_,w,"bordercolor"),fontFamily:h.castHoverOption(_,w,"font.family"),fontSize:h.castHoverOption(_,w,"font.size"),fontColor:h.castHoverOption(_,w,"font.color"),nameLength:h.castHoverOption(_,w,"namelength"),textAlign:h.castHoverOption(_,w,"align"),hovertemplate:u.castOption(_,w,"hovertemplate"),hovertemplateLabels:u.extendFlat({},L,T),eventData:[L]},{container:a,gd:t,inOut_bbox:I});L.bbox=I[0]}if(v.buttons&&v.distance<5){t.emit("plotly_click",C)}else{t.emit("plotly_hover",C)}x=C}else{h.loneUnhover(a);t.emit("plotly_unhover",x)}e.drawAnnotations(e)};w.recoverContext=function(){var e=this;e.glplot.dispose();var t=function(){if(e.glplot.gl.isContextLost()){requestAnimationFrame(t);return}if(!e.initializeGLPlot()){u.error("Catastrophic and unrecoverable WebGL error. Context lost.");return}e.plot.apply(e,e.plotArgs)};requestAnimationFrame(t)};var k=["xaxis","yaxis","zaxis"];function M(e,t,r){var a=e.fullSceneLayout;for(var n=0;n<3;n++){var i=k[n];var o=i.charAt(0);var s=a[i];var l=t[o];var c=t[o+"calendar"];var f=t["_"+o+"length"];if(!u.isArrayOrTypedArray(l)){r[0][n]=Math.min(r[0][n],0);r[1][n]=Math.max(r[1][n],f-1)}else{var h;for(var p=0;p<(f||l.length);p++){if(u.isArrayOrTypedArray(l[p])){for(var v=0;v<l[p].length;++v){h=s.d2l(l[p][v],0,c);if(!isNaN(h)&&isFinite(h)){r[0][n]=Math.min(r[0][n],h);r[1][n]=Math.max(r[1][n],h)}}}else{h=s.d2l(l[p],0,c);if(!isNaN(h)&&isFinite(h)){r[0][n]=Math.min(r[0][n],h);r[1][n]=Math.max(r[1][n],h)}}}}}}function A(e,t){var r=e.fullSceneLayout;var a=r.annotations||[];for(var n=0;n<3;n++){var i=k[n];var o=i.charAt(0);var s=r[i];for(var l=0;l<a.length;l++){var u=a[l];if(u.visible){var c=s.r2l(u[o]);if(!isNaN(c)&&isFinite(c)){t[0][n]=Math.min(t[0][n],c);t[1][n]=Math.max(t[1][n],c)}}}}}w.plot=function(e,t,r){var a=this;a.plotArgs=[e,t,r];if(a.glplot.contextLost)return;var n,i;var o,s,l,u;var c=t[a.id];var f=r[a.id];a.fullLayout=t;a.fullSceneLayout=c;a.axesOptions.merge(t,c);a.spikeOptions.merge(c);a.setViewport(c);a.updateFx(c.dragmode,c.hovermode);a.camera.enableWheel=a.graphDiv._context._scrollZoom.gl3d;a.glplot.setClearColor(p(c.bgcolor));a.setConvert(l);if(!e)e=[];else if(!Array.isArray(e))e=[e];var h=[[Infinity,Infinity,Infinity],[-Infinity,-Infinity,-Infinity]];for(o=0;o<e.length;++o){n=e[o];if(n.visible!==true||n._length===0)continue;M(this,n,h)}A(this,h);var v=[1,1,1];for(s=0;s<3;++s){if(h[1][s]===h[0][s]){v[s]=1}else{v[s]=1/(h[1][s]-h[0][s])}}a.dataScale=v;a.convertAnnotations(this);for(o=0;o<e.length;++o){n=e[o];if(n.visible!==true||n._length===0){continue}i=a.traces[n.uid];if(i){if(i.data.type===n.type){i.update(n)}else{i.dispose();i=n._module.plot(this,n);a.traces[n.uid]=i}}else{i=n._module.plot(this,n);a.traces[n.uid]=i}i.name=n.name}var d=Object.keys(a.traces);e:for(o=0;o<d.length;++o){for(s=0;s<e.length;++s){if(e[s].uid===d[o]&&(e[s].visible===true&&e[s]._length!==0)){continue e}}i=a.traces[d[o]];i.dispose();delete a.traces[d[o]]}a.glplot.objects.sort((function(e,t){return e._trace.data.index-t._trace.data.index}));var m=[[0,0,0],[0,0,0]];var g=[];var y={};for(o=0;o<3;++o){l=c[k[o]];u=l.type;if(u in y){y[u].acc*=v[o];y[u].count+=1}else{y[u]={acc:v[o],count:1}}if(l.autorange){m[0][o]=Infinity;m[1][o]=-Infinity;var x=a.glplot.objects;var b=a.fullSceneLayout.annotations||[];var _=l._name.charAt(0);for(s=0;s<x.length;s++){var w=x[s];var T=w.bounds;var S=w._trace.data._pad||0;if(w.constructor.name==="ErrorBars"&&l._lowerLogErrorBound){m[0][o]=Math.min(m[0][o],l._lowerLogErrorBound)}else{m[0][o]=Math.min(m[0][o],T[0][o]/v[o]-S)}m[1][o]=Math.max(m[1][o],T[1][o]/v[o]+S)}for(s=0;s<b.length;s++){var E=b[s];if(E.visible){var L=l.r2l(E[_]);m[0][o]=Math.min(m[0][o],L);m[1][o]=Math.max(m[1][o],L)}}if("rangemode"in l&&l.rangemode==="tozero"){m[0][o]=Math.min(m[0][o],0);m[1][o]=Math.max(m[1][o],0)}if(m[0][o]>m[1][o]){m[0][o]=-1;m[1][o]=1}else{var C=m[1][o]-m[0][o];m[0][o]-=C/32;m[1][o]+=C/32}if(l.autorange==="reversed"){var I=m[0][o];m[0][o]=m[1][o];m[1][o]=I}}else{var P=l.range;m[0][o]=l.r2l(P[0]);m[1][o]=l.r2l(P[1])}if(m[0][o]===m[1][o]){m[0][o]-=1;m[1][o]+=1}g[o]=m[1][o]-m[0][o];a.glplot.setBounds(o,{min:m[0][o]*v[o],max:m[1][o]*v[o]})}var O;var z=c.aspectmode;if(z==="cube"){O=[1,1,1]}else if(z==="manual"){var D=c.aspectratio;O=[D.x,D.y,D.z]}else if(z==="auto"||z==="data"){var R=[1,1,1];for(o=0;o<3;++o){l=c[k[o]];u=l.type;var F=y[u];R[o]=Math.pow(F.acc,1/F.count)/v[o]}if(z==="data"){O=R}else{if(Math.max.apply(null,R)/Math.min.apply(null,R)<=4){O=R}else{O=[1,1,1]}}}else{throw new Error("scene.js aspectRatio was not one of the enumerated types")}c.aspectratio.x=f.aspectratio.x=O[0];c.aspectratio.y=f.aspectratio.y=O[1];c.aspectratio.z=f.aspectratio.z=O[2];a.glplot.setAspectratio(c.aspectratio);if(!a.viewInitial.aspectratio){a.viewInitial.aspectratio={x:c.aspectratio.x,y:c.aspectratio.y,z:c.aspectratio.z}}if(!a.viewInitial.aspectmode){a.viewInitial.aspectmode=c.aspectmode}var B=c.domain||null;var N=t._size||null;if(B&&N){var j=a.container.style;j.position="absolute";j.left=N.l+B.x[0]*N.w+"px";j.top=N.t+(1-B.y[1])*N.h+"px";j.width=N.w*(B.x[1]-B.x[0])+"px";j.height=N.h*(B.y[1]-B.y[0])+"px"}a.glplot.redraw()};w.destroy=function(){var e=this;if(!e.glplot)return;e.camera.mouseListener.enabled=false;e.container.removeEventListener("wheel",e.camera.wheelListener);e.camera=null;e.glplot.dispose();e.container.parentNode.removeChild(e.container);e.glplot=null};function S(e){return[[e.eye.x,e.eye.y,e.eye.z],[e.center.x,e.center.y,e.center.z],[e.up.x,e.up.y,e.up.z]]}function E(e){return{up:{x:e.up[0],y:e.up[1],z:e.up[2]},center:{x:e.center[0],y:e.center[1],z:e.center[2]},eye:{x:e.eye[0],y:e.eye[1],z:e.eye[2]},projection:{type:e._ortho===true?"orthographic":"perspective"}}}w.getCamera=function(){var e=this;e.camera.view.recalcMatrix(e.camera.view.lastT());return E(e.camera)};w.setViewport=function(e){var t=this;var r=e.camera;t.camera.lookAt.apply(this,S(r));t.glplot.setAspectratio(e.aspectratio);var a=r.projection.type==="orthographic";var n=t.camera._ortho;if(a!==n){t.glplot.redraw();t.glplot.clearRGBA();t.glplot.dispose();t.initializeGLPlot()}};w.isCameraChanged=function(e){var t=this;var r=t.getCamera();var a=u.nestedProperty(e,t.id+".camera");var n=a.get();function i(e,t,r,a){var n=["up","center","eye"];var i=["x","y","z"];return t[n[r]]&&e[n[r]][i[a]]===t[n[r]][i[a]]}var o=false;if(n===undefined){o=true}else{for(var s=0;s<3;s++){for(var l=0;l<3;l++){if(!i(r,n,s,l)){o=true;break}}}if(!n.projection||r.projection&&r.projection.type!==n.projection.type){o=true}}return o};w.isAspectChanged=function(e){var t=this;var r=t.glplot.getAspectratio();var a=u.nestedProperty(e,t.id+".aspectratio");var n=a.get();return n===undefined||(n.x!==r.x||n.y!==r.y||n.z!==r.z)};w.saveLayout=function(e){var t=this;var r=t.fullLayout;var a;var n;var i;var o;var s;var c;var f=t.isCameraChanged(e);var h=t.isAspectChanged(e);var p=f||h;if(p){var v={};if(f){a=t.getCamera();n=u.nestedProperty(e,t.id+".camera");i=n.get();v[t.id+".camera"]=i}if(h){o=t.glplot.getAspectratio();s=u.nestedProperty(e,t.id+".aspectratio");c=s.get();v[t.id+".aspectratio"]=c}l.call("_storeDirectGUIEdit",e,r._preGUI,v);if(f){n.set(a);var d=u.nestedProperty(r,t.id+".camera");d.set(a)}if(h){s.set(o);var m=u.nestedProperty(r,t.id+".aspectratio");m.set(o);t.glplot.redraw()}}return p};w.updateFx=function(e,t){var r=this;var a=r.camera;if(a){if(e==="orbit"){a.mode="orbit";a.keyBindingMode="rotate"}else if(e==="turntable"){a.up=[0,0,1];a.mode="turntable";a.keyBindingMode="rotate";var n=r.graphDiv;var i=n._fullLayout;var o=r.fullSceneLayout.camera;var s=o.up.x;var c=o.up.y;var f=o.up.z;if(f/Math.sqrt(s*s+c*c+f*f)<.999){var h=r.id+".camera.up";var p={x:0,y:0,z:1};var v={};v[h]=p;var d=n.layout;l.call("_storeDirectGUIEdit",d,i._preGUI,v);o.up=p;u.nestedProperty(d,h).set(p)}}else{a.keyBindingMode=e}}r.fullSceneLayout.hovermode=t};function L(e,t,r){for(var a=0,n=r-1;a<n;++a,--n){for(var i=0;i<t;++i){for(var o=0;o<4;++o){var s=4*(t*a+i)+o;var l=4*(t*n+i)+o;var u=e[s];e[s]=e[l];e[l]=u}}}}function C(e,t,r){for(var a=0;a<r;++a){for(var n=0;n<t;++n){var i=4*(t*a+n);var o=e[i+3];if(o>0){var s=255/o;for(var l=0;l<3;++l){e[i+l]=Math.min(s*e[i+l],255)}}}}}w.toImage=function(e){var t=this;if(!e)e="png";if(t.staticMode)t.container.appendChild(x);t.glplot.redraw();var r=t.glplot.gl;var a=r.drawingBufferWidth;var n=r.drawingBufferHeight;r.bindFramebuffer(r.FRAMEBUFFER,null);var i=new Uint8Array(a*n*4);r.readPixels(0,0,a,n,r.RGBA,r.UNSIGNED_BYTE,i);L(i,a,n);C(i,a,n);var o=document.createElement("canvas");o.width=a;o.height=n;var s=o.getContext("2d");var l=s.createImageData(a,n);l.data.set(i);s.putImageData(l,0,0);var u;switch(e){case"jpeg":u=o.toDataURL("image/jpeg");break;case"webp":u=o.toDataURL("image/webp");break;default:u=o.toDataURL("image/png")}if(t.staticMode)t.container.removeChild(x);return u};w.setConvert=function(){var e=this;for(var t=0;t<3;t++){var r=e.fullSceneLayout[k[t]];f.setConvert(r,e.fullLayout);r.setScale=u.noop}};w.make4thDimension=function(){var e=this;var t=e.graphDiv;var r=t._fullLayout;e._mockAxis={type:"linear",showexponent:"all",exponentformat:"B"};f.setConvert(e._mockAxis,r)};t.exports=_},{"../../components/fx":690,"../../lib":787,"../../lib/show_no_webgl_msg":809,"../../lib/str2rgbarray":812,"../../plots/cartesian/axes":838,"../../registry":915,"./layout/convert":884,"./layout/spikes":887,"./layout/tick_marks":888,"./project":889,"gl-plot3d":319,"has-passive-events":436,"webgl-context":613}],891:[function(e,t,r){"use strict";t.exports=function e(t,r,a,n){n=n||t.length;var i=new Array(n);for(var o=0;o<n;o++){i[o]=[t[o],r[o],a[o]]}return i}},{}],892:[function(e,t,r){"use strict";var a=e("./font_attributes");var n=e("./animation_attributes");var i=e("../components/color/attributes");var o=e("../components/shapes/draw_newshape/attributes");var s=e("./pad_attributes");var l=e("../lib/extend").extendFlat;var u=a({editType:"calc"});u.family.dflt='"Open Sans", verdana, arial, sans-serif';u.size.dflt=12;u.color.dflt=i.defaultLine;t.exports={font:u,title:{text:{valType:"string",editType:"layoutstyle"},font:a({editType:"layoutstyle"}),xref:{valType:"enumerated",dflt:"container",values:["container","paper"],editType:"layoutstyle"},yref:{valType:"enumerated",dflt:"container",values:["container","paper"],editType:"layoutstyle"},x:{valType:"number",min:0,max:1,dflt:.5,editType:"layoutstyle"},y:{valType:"number",min:0,max:1,dflt:"auto",editType:"layoutstyle"},xanchor:{valType:"enumerated",dflt:"auto",values:["auto","left","center","right"],editType:"layoutstyle"},yanchor:{valType:"enumerated",dflt:"auto",values:["auto","top","middle","bottom"],editType:"layoutstyle"},pad:l(s({editType:"layoutstyle"}),{}),editType:"layoutstyle"},uniformtext:{mode:{valType:"enumerated",values:[false,"hide","show"],dflt:false,editType:"plot"},minsize:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"plot"},autosize:{valType:"boolean",dflt:false,editType:"none"},width:{valType:"number",min:10,dflt:700,editType:"plot"},height:{valType:"number",min:10,dflt:450,editType:"plot"},margin:{l:{valType:"number",min:0,dflt:80,editType:"plot"},r:{valType:"number",min:0,dflt:80,editType:"plot"},t:{valType:"number",min:0,dflt:100,editType:"plot"},b:{valType:"number",min:0,dflt:80,editType:"plot"},pad:{valType:"number",min:0,dflt:0,editType:"plot"},autoexpand:{valType:"boolean",dflt:true,editType:"plot"},editType:"plot"},computed:{valType:"any",editType:"none"},paper_bgcolor:{valType:"color",dflt:i.background,editType:"plot"},plot_bgcolor:{valType:"color",dflt:i.background,editType:"layoutstyle"},autotypenumbers:{valType:"enumerated",values:["convert types","strict"],dflt:"convert types",editType:"calc"},separators:{valType:"string",editType:"plot"},hidesources:{valType:"boolean",dflt:false,editType:"plot"},showlegend:{valType:"boolean",editType:"legend"},colorway:{valType:"colorlist",dflt:i.defaults,editType:"calc"},datarevision:{valType:"any",editType:"calc"},uirevision:{valType:"any",editType:"none"},editrevision:{valType:"any",editType:"none"},selectionrevision:{valType:"any",editType:"none"},template:{valType:"any",editType:"calc"},newshape:o.newshape,activeshape:o.activeshape,meta:{valType:"any",arrayOk:true,editType:"plot"},transition:l({},n.transition,{editType:"none"}),_deprecated:{title:{valType:"string",editType:"layoutstyle"},titlefont:a({editType:"layoutstyle"})}}},{"../components/color/attributes":649,"../components/shapes/draw_newshape/attributes":735,"../lib/extend":777,"./animation_attributes":832,"./font_attributes":867,"./pad_attributes":900}],893:[function(e,t,r){"use strict";var a=e("../../lib/sort_object_keys");var n="1.10.1";var i='© <a target="_blank" href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors';var o=['© <a target="_blank" href="https://carto.com/">Carto</a>',i].join(" ");var s=['Map tiles by <a target="_blank" href="https://stamen.com">Stamen Design</a>','under <a target="_blank" href="https://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>',"|",'Data by <a target="_blank" href="https://openstreetmap.org">OpenStreetMap</a> contributors','under <a target="_blank" href="https://www.openstreetmap.org/copyright">ODbL</a>'].join(" ");var l=['Map tiles by <a target="_blank" href="https://stamen.com">Stamen Design</a>','under <a target="_blank" href="https://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>',"|",'Data by <a target="_blank" href="https://openstreetmap.org">OpenStreetMap</a> contributors','under <a target="_blank" href="https://creativecommons.org/licenses/by-sa/3.0">CC BY SA</a>'].join(" ");var u={"open-street-map":{id:"osm",version:8,sources:{"plotly-osm-tiles":{type:"raster",attribution:i,tiles:["https://a.tile.openstreetmap.org/{z}/{x}/{y}.png","https://b.tile.openstreetmap.org/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-osm-tiles",type:"raster",source:"plotly-osm-tiles",minzoom:0,maxzoom:22}]},"white-bg":{id:"white-bg",version:8,sources:{},layers:[{id:"white-bg",type:"background",paint:{"background-color":"#FFFFFF"},minzoom:0,maxzoom:22}]},"carto-positron":{id:"carto-positron",version:8,sources:{"plotly-carto-positron":{type:"raster",attribution:o,tiles:["https://cartodb-basemaps-c.global.ssl.fastly.net/light_all/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-carto-positron",type:"raster",source:"plotly-carto-positron",minzoom:0,maxzoom:22}]},"carto-darkmatter":{id:"carto-darkmatter",version:8,sources:{"plotly-carto-darkmatter":{type:"raster",attribution:o,tiles:["https://cartodb-basemaps-c.global.ssl.fastly.net/dark_all/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-carto-darkmatter",type:"raster",source:"plotly-carto-darkmatter",minzoom:0,maxzoom:22}]},"stamen-terrain":{id:"stamen-terrain",version:8,sources:{"plotly-stamen-terrain":{type:"raster",attribution:s,tiles:["https://stamen-tiles.a.ssl.fastly.net/terrain/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-stamen-terrain",type:"raster",source:"plotly-stamen-terrain",minzoom:0,maxzoom:22}]},"stamen-toner":{id:"stamen-toner",version:8,sources:{"plotly-stamen-toner":{type:"raster",attribution:s,tiles:["https://stamen-tiles.a.ssl.fastly.net/toner/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-stamen-toner",type:"raster",source:"plotly-stamen-toner",minzoom:0,maxzoom:22}]},"stamen-watercolor":{id:"stamen-watercolor",version:8,sources:{"plotly-stamen-watercolor":{type:"raster",attribution:l,tiles:["https://stamen-tiles.a.ssl.fastly.net/watercolor/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-stamen-watercolor",type:"raster",source:"plotly-stamen-watercolor",minzoom:0,maxzoom:22}]}};var c=a(u);t.exports={requiredVersion:n,styleUrlPrefix:"mapbox://styles/mapbox/",styleUrlSuffix:"v9",styleValuesMapbox:["basic","streets","outdoors","light","dark","satellite","satellite-streets"],styleValueDflt:"basic",stylesNonMapbox:u,styleValuesNonMapbox:c,traceLayerPrefix:"plotly-trace-layer-",layoutLayerPrefix:"plotly-layout-layer-",wrongVersionErrorMsg:["Your custom plotly.js bundle is not using the correct mapbox-gl version","Please install mapbox-gl@"+n+"."].join("\n"),noAccessTokenErrorMsg:["Missing Mapbox access token.","Mapbox trace type require a Mapbox access token to be registered.","For example:","  Plotly.newPlot(gd, data, layout, { mapboxAccessToken: 'my-access-token' });","More info here: https://www.mapbox.com/help/define-access-token/"].join("\n"),missingStyleErrorMsg:["No valid mapbox style found, please set `mapbox.style` to one of:",c.join(", "),"or register a Mapbox access token to use a Mapbox-served style."].join("\n"),multipleTokensErrorMsg:["Set multiple mapbox access token across different mapbox subplot,","using first token found as mapbox-gl does not allow multiple"+"access tokens on the same page."].join("\n"),mapOnErrorMsg:"Mapbox error.",mapboxLogo:{path0:"m 10.5,1.24 c -5.11,0 -9.25,4.15 -9.25,9.25 0,5.1 4.15,9.25 9.25,9.25 5.1,0 9.25,-4.15 9.25,-9.25 0,-5.11 -4.14,-9.25 -9.25,-9.25 z m 4.39,11.53 c -1.93,1.93 -4.78,2.31 -6.7,2.31 -0.7,0 -1.41,-0.05 -2.1,-0.16 0,0 -1.02,-5.64 2.14,-8.81 0.83,-0.83 1.95,-1.28 3.13,-1.28 1.27,0 2.49,0.51 3.39,1.42 1.84,1.84 1.89,4.75 0.14,6.52 z",path1:"M 10.5,-0.01 C 4.7,-0.01 0,4.7 0,10.49 c 0,5.79 4.7,10.5 10.5,10.5 5.8,0 10.5,-4.7 10.5,-10.5 C 20.99,4.7 16.3,-0.01 10.5,-0.01 Z m 0,19.75 c -5.11,0 -9.25,-4.15 -9.25,-9.25 0,-5.1 4.14,-9.26 9.25,-9.26 5.11,0 9.25,4.15 9.25,9.25 0,5.13 -4.14,9.26 -9.25,9.26 z",path2:"M 14.74,6.25 C 12.9,4.41 9.98,4.35 8.23,6.1 5.07,9.27 6.09,14.91 6.09,14.91 c 0,0 5.64,1.02 8.81,-2.14 C 16.64,11 16.59,8.09 14.74,6.25 Z m -2.27,4.09 -0.91,1.87 -0.9,-1.87 -1.86,-0.91 1.86,-0.9 0.9,-1.87 0.91,1.87 1.86,0.9 z",polygon:"11.56,12.21 10.66,10.34 8.8,9.43 10.66,8.53 11.56,6.66 12.47,8.53 14.33,9.43 12.47,10.34"},styleRules:{map:"overflow:hidden;position:relative;","missing-css":"display:none;",canary:"background-color:salmon;","ctrl-bottom-left":"position: absolute; pointer-events: none; z-index: 2; bottom: 0; left: 0;","ctrl-bottom-right":"position: absolute; pointer-events: none; z-index: 2; right: 0; bottom: 0;",ctrl:"clear: both; pointer-events: auto; transform: translate(0, 0);","ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-inner":"display: none;","ctrl-attrib.mapboxgl-compact:hover .mapboxgl-ctrl-attrib-inner":"display: block; margin-top:2px","ctrl-attrib.mapboxgl-compact:hover":"padding: 2px 24px 2px 4px; visibility: visible; margin-top: 6px;","ctrl-attrib.mapboxgl-compact::after":'content: ""; cursor: pointer; position: absolute; background-image: url(\'data:image/svg+xml;charset=utf-8,%3Csvg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"%3E %3Cpath fill="%23333333" fill-rule="evenodd" d="M4,10a6,6 0 1,0 12,0a6,6 0 1,0 -12,0 M9,7a1,1 0 1,0 2,0a1,1 0 1,0 -2,0 M9,10a1,1 0 1,1 2,0l0,3a1,1 0 1,1 -2,0"/%3E %3C/svg%3E\'); background-color: rgba(255, 255, 255, 0.5); width: 24px; height: 24px; box-sizing: border-box; border-radius: 12px;',"ctrl-attrib.mapboxgl-compact":"min-height: 20px; padding: 0; margin: 10px; position: relative; background-color: #fff; border-radius: 3px 12px 12px 3px;","ctrl-bottom-right > .mapboxgl-ctrl-attrib.mapboxgl-compact::after":"bottom: 0; right: 0","ctrl-bottom-left > .mapboxgl-ctrl-attrib.mapboxgl-compact::after":"bottom: 0; left: 0","ctrl-bottom-left .mapboxgl-ctrl":"margin: 0 0 10px 10px; float: left;","ctrl-bottom-right .mapboxgl-ctrl":"margin: 0 10px 10px 0; float: right;","ctrl-attrib":"color: rgba(0, 0, 0, 0.75); text-decoration: none; font-size: 12px","ctrl-attrib a":"color: rgba(0, 0, 0, 0.75); text-decoration: none; font-size: 12px","ctrl-attrib a:hover":"color: inherit; text-decoration: underline;","ctrl-attrib .mapbox-improve-map":"font-weight: bold; margin-left: 2px;","attrib-empty":"display: none;","ctrl-logo":'display:block; width: 21px; height: 21px; background-image: url(\'data:image/svg+xml;charset=utf-8,%3C?xml version="1.0" encoding="utf-8"?%3E %3Csvg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 21 21" style="enable-background:new 0 0 21 21;" xml:space="preserve"%3E%3Cg transform="translate(0,0.01)"%3E%3Cpath d="m 10.5,1.24 c -5.11,0 -9.25,4.15 -9.25,9.25 0,5.1 4.15,9.25 9.25,9.25 5.1,0 9.25,-4.15 9.25,-9.25 0,-5.11 -4.14,-9.25 -9.25,-9.25 z m 4.39,11.53 c -1.93,1.93 -4.78,2.31 -6.7,2.31 -0.7,0 -1.41,-0.05 -2.1,-0.16 0,0 -1.02,-5.64 2.14,-8.81 0.83,-0.83 1.95,-1.28 3.13,-1.28 1.27,0 2.49,0.51 3.39,1.42 1.84,1.84 1.89,4.75 0.14,6.52 z" style="opacity:0.9;fill:%23ffffff;enable-background:new" class="st0"/%3E%3Cpath d="M 10.5,-0.01 C 4.7,-0.01 0,4.7 0,10.49 c 0,5.79 4.7,10.5 10.5,10.5 5.8,0 10.5,-4.7 10.5,-10.5 C 20.99,4.7 16.3,-0.01 10.5,-0.01 Z m 0,19.75 c -5.11,0 -9.25,-4.15 -9.25,-9.25 0,-5.1 4.14,-9.26 9.25,-9.26 5.11,0 9.25,4.15 9.25,9.25 0,5.13 -4.14,9.26 -9.25,9.26 z" style="opacity:0.35;enable-background:new" class="st1"/%3E%3Cpath d="M 14.74,6.25 C 12.9,4.41 9.98,4.35 8.23,6.1 5.07,9.27 6.09,14.91 6.09,14.91 c 0,0 5.64,1.02 8.81,-2.14 C 16.64,11 16.59,8.09 14.74,6.25 Z m -2.27,4.09 -0.91,1.87 -0.9,-1.87 -1.86,-0.91 1.86,-0.9 0.9,-1.87 0.91,1.87 1.86,0.9 z" style="opacity:0.35;enable-background:new" class="st1"/%3E%3Cpolygon points="11.56,12.21 10.66,10.34 8.8,9.43 10.66,8.53 11.56,6.66 12.47,8.53 14.33,9.43 12.47,10.34 " style="opacity:0.9;fill:%23ffffff;enable-background:new" class="st0"/%3E%3C/g%3E%3C/svg%3E\')'}}},{"../../lib/sort_object_keys":810}],894:[function(e,t,r){"use strict";var a=e("../../lib");t.exports=function e(t,r){var n=t.split(" ");var i=n[0];var o=n[1];var s=a.isArrayOrTypedArray(r)?a.mean(r):r;var l=.5+s/100;var u=1.5+s/100;var c=["",""];var f=[0,0];switch(i){case"top":c[0]="top";f[1]=-u;break;case"bottom":c[0]="bottom";f[1]=u;break}switch(o){case"left":c[1]="right";f[0]=-l;break;case"right":c[1]="left";f[0]=l;break}var h;if(c[0]&&c[1])h=c.join("-");else if(c[0])h=c[0];else if(c[1])h=c[1];else h="center";return{anchor:h,offset:f}}},{"../../lib":787}],895:[function(e,t,r){"use strict";var a=e("mapbox-gl/dist/mapbox-gl-unminified");var n=e("../../lib");var i=n.strTranslate;var o=n.strScale;var s=e("../../plots/get_data").getSubplotCalcData;var l=e("../../constants/xmlns_namespaces");var u=e("@plotly/d3");var c=e("../../components/drawing");var f=e("../../lib/svg_text_utils");var h=e("./mapbox");var p="mapbox";var v=r.constants=e("./constants");r.name=p;r.attr="subplot";r.idRoot=p;r.idRegex=r.attrRegex=n.counterRegex(p);r.attributes={subplot:{valType:"subplotid",dflt:"mapbox",editType:"calc"}};r.layoutAttributes=e("./layout_attributes");r.supplyLayoutDefaults=e("./layout_defaults");r.plot=function e(t){var r=t._fullLayout;var i=t.calcdata;var o=r._subplots[p];if(a.version!==v.requiredVersion){throw new Error(v.wrongVersionErrorMsg)}var l=d(t,o);a.accessToken=l;for(var u=0;u<o.length;u++){var c=o[u];var f=s(i,p,c);var m=r[c];var g=m._subplot;if(!g){g=new h(t,c);r[c]._subplot=g}if(!g.viewInitial){g.viewInitial={center:n.extendFlat({},m.center),zoom:m.zoom,bearing:m.bearing,pitch:m.pitch}}g.plot(f,r,t._promises)}};r.clean=function(e,t,r,a){var n=a._subplots[p]||[];for(var i=0;i<n.length;i++){var o=n[i];if(!t[o]&&!!a[o]._subplot){a[o]._subplot.destroy()}}};r.toSVG=function(e){var t=e._fullLayout;var r=t._subplots[p];var a=t._size;for(var n=0;n<r.length;n++){var s=t[r[n]];var h=s.domain;var d=s._subplot;var m=d.toImage("png");var g=t._glimages.append("svg:image");g.attr({xmlns:l.svg,"xlink:href":m,x:a.l+a.w*h.x[0],y:a.t+a.h*(1-h.y[1]),width:a.w*(h.x[1]-h.x[0]),height:a.h*(h.y[1]-h.y[0]),preserveAspectRatio:"none"});var y=u.select(s._subplot.div);var x=y.select(".mapboxgl-ctrl-logo").node().offsetParent===null;if(!x){var b=t._glimages.append("g");b.attr("transform",i(a.l+a.w*h.x[0]+10,a.t+a.h*(1-h.y[0])-31));b.append("path").attr("d",v.mapboxLogo.path0).style({opacity:.9,fill:"#ffffff","enable-background":"new"});b.append("path").attr("d",v.mapboxLogo.path1).style("opacity",.35).style("enable-background","new");b.append("path").attr("d",v.mapboxLogo.path2).style("opacity",.35).style("enable-background","new");b.append("polygon").attr("points",v.mapboxLogo.polygon).style({opacity:.9,fill:"#ffffff","enable-background":"new"})}var _=y.select(".mapboxgl-ctrl-attrib").text().replace("Improve this map","");var w=t._glimages.append("g");var T=w.append("text");T.text(_).classed("static-attribution",true).attr({"font-size":12,"font-family":"Arial",color:"rgba(0, 0, 0, 0.75)","text-anchor":"end","data-unformatted":_});var k=c.bBox(T.node());var M=a.w*(h.x[1]-h.x[0]);if(k.width>M/2){var A=_.split("|").join("<br>");T.text(A).attr("data-unformatted",A).call(f.convertToTspans,e);k=c.bBox(T.node())}T.attr("transform",i(-3,-k.height+8));w.insert("rect",".static-attribution").attr({x:-k.width-6,y:-k.height-3,width:k.width+6,height:k.height+3,fill:"rgba(255, 255, 255, 0.75)"});var S=1;if(k.width+6>M)S=M/(k.width+6);var E=[a.l+a.w*h.x[1],a.t+a.h*(1-h.y[0])];w.attr("transform",i(E[0],E[1])+o(S))}};function d(e,t){var r=e._fullLayout;var a=e._context;if(a.mapboxAccessToken==="")return"";var i=[];var o=[];var s=false;var l=false;for(var u=0;u<t.length;u++){var c=r[t[u]];var f=c.accesstoken;if(m(c.style)){if(f){n.pushUnique(i,f)}else{if(m(c._input.style)){n.error("Uses Mapbox map style, but did not set an access token.");s=true}l=true}}if(f){n.pushUnique(o,f)}}if(l){var h=s?v.noAccessTokenErrorMsg:v.missingStyleErrorMsg;n.error(h);throw new Error(h)}if(i.length){if(i.length>1){n.warn(v.multipleTokensErrorMsg)}return i[0]}else{if(o.length){n.log(["Listed mapbox access token(s)",o.join(","),"but did not use a Mapbox map style, ignoring token(s)."].join(" "))}return""}}function m(e){return typeof e==="string"&&(v.styleValuesMapbox.indexOf(e)!==-1||e.indexOf("mapbox://")===0)}r.updateFx=function(e){var t=e._fullLayout;var r=t._subplots[p];for(var a=0;a<r.length;a++){var n=t[r[a]]._subplot;n.updateFx(t)}}},{"../../components/drawing":672,"../../constants/xmlns_namespaces":764,"../../lib":787,"../../lib/svg_text_utils":813,"../../plots/get_data":875,"./constants":893,"./layout_attributes":897,"./layout_defaults":898,"./mapbox":899,"@plotly/d3":58,"mapbox-gl/dist/mapbox-gl-unminified":451}],896:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("../../lib/svg_text_utils").sanitizeHTML;var i=e("./convert_text_opts");var o=e("./constants");function s(e,t){this.subplot=e;this.uid=e.uid+"-"+t;this.index=t;this.idSource="source-"+this.uid;this.idLayer=o.layoutLayerPrefix+this.uid;this.sourceType=null;this.source=null;this.layerType=null;this.below=null;this.visible=false}var l=s.prototype;l.update=function e(t){if(!this.visible){this.updateSource(t);this.updateLayer(t)}else if(this.needsNewImage(t)){this.updateImage(t)}else if(this.needsNewSource(t)){this.removeLayer();this.updateSource(t);this.updateLayer(t)}else if(this.needsNewLayer(t)){this.updateLayer(t)}else{this.updateStyle(t)}this.visible=u(t)};l.needsNewImage=function(e){var t=this.subplot.map;return t.getSource(this.idSource)&&this.sourceType==="image"&&e.sourcetype==="image"&&(this.source!==e.source||JSON.stringify(this.coordinates)!==JSON.stringify(e.coordinates))};l.needsNewSource=function(e){return this.sourceType!==e.sourcetype||JSON.stringify(this.source)!==JSON.stringify(e.source)||this.layerType!==e.type};l.needsNewLayer=function(e){return this.layerType!==e.type||this.below!==this.subplot.belowLookup["layout-"+this.index]};l.lookupBelow=function(){return this.subplot.belowLookup["layout-"+this.index]};l.updateImage=function(e){var t=this.subplot.map;t.getSource(this.idSource).updateImage({url:e.source,coordinates:e.coordinates});var r=this.findFollowingMapboxLayerId(this.lookupBelow());if(r!==null){this.subplot.map.moveLayer(this.idLayer,r)}};l.updateSource=function(e){var t=this.subplot.map;if(t.getSource(this.idSource))t.removeSource(this.idSource);this.sourceType=e.sourcetype;this.source=e.source;if(!u(e))return;var r=f(e);t.addSource(this.idSource,r)};l.findFollowingMapboxLayerId=function(e){if(e==="traces"){var t=this.subplot.getMapLayers();for(var r=0;r<t.length;r++){var a=t[r].id;if(typeof a==="string"&&a.indexOf(o.traceLayerPrefix)===0){e=a;break}}}return e};l.updateLayer=function(e){var t=this.subplot;var r=c(e);var a=this.lookupBelow();var n=this.findFollowingMapboxLayerId(a);this.removeLayer();if(u(e)){t.addLayer({id:this.idLayer,source:this.idSource,"source-layer":e.sourcelayer||"",type:e.type,minzoom:e.minzoom,maxzoom:e.maxzoom,layout:r.layout,paint:r.paint},n)}this.layerType=e.type;this.below=a};l.updateStyle=function(e){if(u(e)){var t=c(e);this.subplot.setOptions(this.idLayer,"setLayoutProperty",t.layout);this.subplot.setOptions(this.idLayer,"setPaintProperty",t.paint)}};l.removeLayer=function(){var e=this.subplot.map;if(e.getLayer(this.idLayer)){e.removeLayer(this.idLayer)}};l.dispose=function(){var e=this.subplot.map;if(e.getLayer(this.idLayer))e.removeLayer(this.idLayer);if(e.getSource(this.idSource))e.removeSource(this.idSource)};function u(e){if(!e.visible)return false;var t=e.source;if(Array.isArray(t)&&t.length>0){for(var r=0;r<t.length;r++){if(typeof t[r]!=="string"||t[r].length===0){return false}}return true}return a.isPlainObject(t)||typeof t==="string"&&t.length>0}function c(e){var t={};var r={};switch(e.type){case"circle":a.extendFlat(r,{"circle-radius":e.circle.radius,"circle-color":e.color,"circle-opacity":e.opacity});break;case"line":a.extendFlat(r,{"line-width":e.line.width,"line-color":e.color,"line-opacity":e.opacity,"line-dasharray":e.line.dash});break;case"fill":a.extendFlat(r,{"fill-color":e.color,"fill-outline-color":e.fill.outlinecolor,"fill-opacity":e.opacity});break;case"symbol":var n=e.symbol;var o=i(n.textposition,n.iconsize);a.extendFlat(t,{"icon-image":n.icon+"-15","icon-size":n.iconsize/10,"text-field":n.text,"text-size":n.textfont.size,"text-anchor":o.anchor,"text-offset":o.offset,"symbol-placement":n.placement});a.extendFlat(r,{"icon-color":e.color,"text-color":n.textfont.color,"text-opacity":e.opacity});break;case"raster":a.extendFlat(r,{"raster-fade-duration":0,"raster-opacity":e.opacity});break}return{layout:t,paint:r}}function f(e){var t=e.sourcetype;var r=e.source;var a={type:t};var i;if(t==="geojson"){i="data"}else if(t==="vector"){i=typeof r==="string"?"url":"tiles"}else if(t==="raster"){i="tiles";a.tileSize=256}else if(t==="image"){i="url";a.coordinates=e.coordinates}a[i]=r;if(e.sourceattribution){a.attribution=n(e.sourceattribution)}return a}t.exports=function e(t,r,a){var n=new s(t,r);n.update(a);return n}},{"../../lib":787,"../../lib/svg_text_utils":813,"./constants":893,"./convert_text_opts":894}],897:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("../../components/color").defaultLine;var i=e("../domain").attributes;var o=e("../font_attributes");var s=e("../../traces/scatter/attributes").textposition;var l=e("../../plot_api/edit_types").overrideAll;var u=e("../../plot_api/plot_template").templatedArray;var c=e("./constants");var f=o({});f.family.dflt="Open Sans Regular, Arial Unicode MS Regular";var h=t.exports=l({_arrayAttrRegexps:[a.counterRegex("mapbox",".layers",true)],domain:i({name:"mapbox"}),accesstoken:{valType:"string",noBlank:true,strict:true},style:{valType:"any",values:c.styleValuesMapbox.concat(c.styleValuesNonMapbox),dflt:c.styleValueDflt},center:{lon:{valType:"number",dflt:0},lat:{valType:"number",dflt:0}},zoom:{valType:"number",dflt:1},bearing:{valType:"number",dflt:0},pitch:{valType:"number",dflt:0},layers:u("layer",{visible:{valType:"boolean",dflt:true},sourcetype:{valType:"enumerated",values:["geojson","vector","raster","image"],dflt:"geojson"},source:{valType:"any"},sourcelayer:{valType:"string",dflt:""},sourceattribution:{valType:"string"},type:{valType:"enumerated",values:["circle","line","fill","symbol","raster"],dflt:"circle"},coordinates:{valType:"any"},below:{valType:"string"},color:{valType:"color",dflt:n},opacity:{valType:"number",min:0,max:1,dflt:1},minzoom:{valType:"number",min:0,max:24,dflt:0},maxzoom:{valType:"number",min:0,max:24,dflt:24},circle:{radius:{valType:"number",dflt:15}},line:{width:{valType:"number",dflt:2},dash:{valType:"data_array"}},fill:{outlinecolor:{valType:"color",dflt:n}},symbol:{icon:{valType:"string",dflt:"marker"},iconsize:{valType:"number",dflt:10},text:{valType:"string",dflt:""},placement:{valType:"enumerated",values:["point","line","line-center"],dflt:"point"},textfont:f,textposition:a.extendFlat({},s,{arrayOk:false})}})},"plot","from-root");h.uirevision={valType:"any",editType:"none"}},{"../../components/color":650,"../../lib":787,"../../plot_api/edit_types":820,"../../plot_api/plot_template":827,"../../traces/scatter/attributes":1202,"../domain":866,"../font_attributes":867,"./constants":893}],898:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("../subplot_defaults");var i=e("../array_container_defaults");var o=e("./layout_attributes");t.exports=function e(t,r,a){n(t,r,a,{type:"mapbox",attributes:o,handleDefaults:s,partition:"y",accessToken:r._mapboxAccessToken})};function s(e,t,r,a){r("accesstoken",a.accessToken);r("style");r("center.lon");r("center.lat");r("zoom");r("bearing");r("pitch");i(e,t,{name:"layers",handleItemDefaults:l});t._input=e}function l(e,t){function r(r,n){return a.coerce(e,t,o.layers,r,n)}var n=r("visible");if(n){var i=r("sourcetype");var s=i==="raster"||i==="image";r("source");r("sourceattribution");if(i==="vector"){r("sourcelayer")}if(i==="image"){r("coordinates")}var l;if(s)l="raster";var u=r("type",l);if(s&&u!=="raster"){u=t.type="raster";a.log("Source types *raster* and *image* must drawn *raster* layer type.")}r("below");r("color");r("opacity");r("minzoom");r("maxzoom");if(u==="circle"){r("circle.radius")}if(u==="line"){r("line.width");r("line.dash")}if(u==="fill"){r("fill.outlinecolor")}if(u==="symbol"){r("symbol.icon");r("symbol.iconsize");r("symbol.text");a.coerceFont(r,"symbol.textfont");r("symbol.textposition");r("symbol.placement")}}}},{"../../lib":787,"../array_container_defaults":833,"../subplot_defaults":909,"./layout_attributes":897}],899:[function(e,t,r){"use strict";var a=e("mapbox-gl/dist/mapbox-gl-unminified");var n=e("../../lib");var i=e("../../lib/geo_location_utils");var o=e("../../registry");var s=e("../cartesian/axes");var l=e("../../components/dragelement");var u=e("../../components/fx");var c=e("../../components/dragelement/helpers");var f=c.rectMode;var h=c.drawMode;var p=c.selectMode;var v=e("../cartesian/select").prepSelect;var d=e("../cartesian/select").clearSelect;var m=e("../cartesian/select").clearSelectionsCache;var g=e("../cartesian/select").selectOnClick;var y=e("./constants");var x=e("./layers");function b(e,t){this.id=t;this.gd=e;var r=e._fullLayout;var a=e._context;this.container=r._glcontainer.node();this.isStatic=a.staticPlot;this.uid=r._uid+"-"+this.id;this.div=null;this.xaxis=null;this.yaxis=null;this.createFramework(r);this.map=null;this.accessToken=null;this.styleObj=null;this.traceHash={};this.layerList=[];this.belowLookup={};this.dragging=false;this.wheeling=false}var _=b.prototype;_.plot=function(e,t,r){var a=this;var n=t[a.id];if(a.map&&n.accesstoken!==a.accessToken){a.map.remove();a.map=null;a.styleObj=null;a.traceHash={};a.layerList=[]}var i;if(!a.map){i=new Promise((function(r,n){a.createMap(e,t,r,n)}))}else{i=new Promise((function(r,n){a.updateMap(e,t,r,n)}))}r.push(i)};_.createMap=function(e,t,r,n){var o=this;var s=t[o.id];var l=o.styleObj=T(s.style);o.accessToken=s.accesstoken;var u=o.map=new a.Map({container:o.div,style:l.style,center:M(s.center),zoom:s.zoom,bearing:s.bearing,pitch:s.pitch,interactive:!o.isStatic,preserveDrawingBuffer:o.isStatic,doubleClickZoom:false,boxZoom:false,attributionControl:false}).addControl(new a.AttributionControl({compact:true}));u._canvas.style.left="0px";u._canvas.style.top="0px";o.rejectOnError(n);if(!o.isStatic){o.initFx(e,t)}var c=[];c.push(new Promise((function(e){u.once("load",e)})));c=c.concat(i.fetchTraceGeoData(e));Promise.all(c).then((function(){o.fillBelowLookup(e,t);o.updateData(e);o.updateLayout(t);o.resolveOnRender(r)})).catch(n)};_.updateMap=function(e,t,r,a){var n=this;var o=n.map;var s=t[this.id];n.rejectOnError(a);var l=[];var u=T(s.style);if(JSON.stringify(n.styleObj)!==JSON.stringify(u)){n.styleObj=u;o.setStyle(u.style);n.traceHash={};l.push(new Promise((function(e){o.once("styledata",e)})))}l=l.concat(i.fetchTraceGeoData(e));Promise.all(l).then((function(){n.fillBelowLookup(e,t);n.updateData(e);n.updateLayout(t);n.resolveOnRender(r)})).catch(a)};_.fillBelowLookup=function(e,t){var r=t[this.id];var a=r.layers;var n,i;var o=this.belowLookup={};var s=false;for(n=0;n<e.length;n++){var l=e[n][0].trace;var u=l._module;if(typeof l.below==="string"){i=l.below}else if(u.getBelow){i=u.getBelow(l,this)}if(i===""){s=true}o["trace-"+l.uid]=i||""}for(n=0;n<a.length;n++){var c=a[n];if(typeof c.below==="string"){i=c.below}else if(s){i="traces"}else{i=""}o["layout-"+n]=i}var f={};var h,p;for(h in o){i=o[h];if(f[i]){f[i].push(h)}else{f[i]=[h]}}for(i in f){var v=f[i];if(v.length>1){for(n=0;n<v.length;n++){h=v[n];if(h.indexOf("trace-")===0){p=h.split("trace-")[1];if(this.traceHash[p]){this.traceHash[p].below=null}}else if(h.indexOf("layout-")===0){p=h.split("layout-")[1];if(this.layerList[p]){this.layerList[p].below=null}}}}}};var w={choroplethmapbox:0,densitymapbox:1,scattermapbox:2};_.updateData=function(e){var t=this.traceHash;var r,a,n,i;var o=e.slice().sort((function(e,t){return w[e[0].trace.type]-w[t[0].trace.type]}));for(n=0;n<o.length;n++){var s=o[n];a=s[0].trace;r=t[a.uid];var l=false;if(r){if(r.type===a.type){r.update(s);l=true}else{r.dispose()}}if(!l&&a._module){t[a.uid]=a._module.plot(this,s)}}var u=Object.keys(t);e:for(n=0;n<u.length;n++){var c=u[n];for(i=0;i<e.length;i++){a=e[i][0].trace;if(c===a.uid)continue e}r=t[c];r.dispose();delete t[c]}};_.updateLayout=function(e){var t=this.map;var r=e[this.id];if(!this.dragging&&!this.wheeling){t.setCenter(M(r.center));t.setZoom(r.zoom);t.setBearing(r.bearing);t.setPitch(r.pitch)}this.updateLayers(e);this.updateFramework(e);this.updateFx(e);this.map.resize();if(this.gd._context._scrollZoom.mapbox){t.scrollZoom.enable()}else{t.scrollZoom.disable()}};_.resolveOnRender=function(e){var t=this.map;t.on("render",(function r(){if(t.loaded()){t.off("render",r);setTimeout(e,10)}}))};_.rejectOnError=function(e){var t=this.map;function r(){e(new Error(y.mapOnErrorMsg))}t.once("error",r);t.once("style.error",r);t.once("source.error",r);t.once("tile.error",r);t.once("layer.error",r)};_.createFramework=function(e){var t=this;var r=t.div=document.createElement("div");r.id=t.uid;r.style.position="absolute";t.container.appendChild(r);t.xaxis={_id:"x",c2p:function(e){return t.project(e).x}};t.yaxis={_id:"y",c2p:function(e){return t.project(e).y}};t.updateFramework(e);t.mockAxis={type:"linear",showexponent:"all",exponentformat:"B"};s.setConvert(t.mockAxis,e)};_.initFx=function(e,t){var r=this;var a=r.gd;var n=r.map;n.on("moveend",(function(e){if(!r.map)return;var t=a._fullLayout;if(e.originalEvent||r.wheeling){var n=t[r.id];o.call("_storeDirectGUIEdit",a.layout,t._preGUI,r.getViewEdits(n));var i=r.getView();n._input.center=n.center=i.center;n._input.zoom=n.zoom=i.zoom;n._input.bearing=n.bearing=i.bearing;n._input.pitch=n.pitch=i.pitch;a.emit("plotly_relayout",r.getViewEditsWithDerived(i))}if(e.originalEvent&&e.originalEvent.type==="mouseup"){r.dragging=false}else if(r.wheeling){r.wheeling=false}if(t._rehover){t._rehover()}}));n.on("wheel",(function(){r.wheeling=true}));n.on("mousemove",(function(e){var t=r.div.getBoundingClientRect();var i=[e.originalEvent.offsetX,e.originalEvent.offsetY];e.target.getBoundingClientRect=function(){return t};r.xaxis.p2c=function(){return n.unproject(i).lng};r.yaxis.p2c=function(){return n.unproject(i).lat};a._fullLayout._rehover=function(){if(a._fullLayout._hoversubplot===r.id&&a._fullLayout[r.id]){u.hover(a,e,r.id)}};u.hover(a,e,r.id);a._fullLayout._hoversubplot=r.id}));function i(){u.loneUnhover(t._hoverlayer)}n.on("dragstart",(function(){r.dragging=true;i()}));n.on("zoomstart",i);n.on("mouseout",(function(){a._fullLayout._hoversubplot=null}));function s(){var e=r.getView();a.emit("plotly_relayouting",r.getViewEditsWithDerived(e))}n.on("drag",s);n.on("zoom",s);n.on("dblclick",(function(){var e=a._fullLayout[r.id];o.call("_storeDirectGUIEdit",a.layout,a._fullLayout._preGUI,r.getViewEdits(e));var t=r.viewInitial;n.setCenter(M(t.center));n.setZoom(t.zoom);n.setBearing(t.bearing);n.setPitch(t.pitch);var i=r.getView();e._input.center=e.center=i.center;e._input.zoom=e.zoom=i.zoom;e._input.bearing=e.bearing=i.bearing;e._input.pitch=e.pitch=i.pitch;a.emit("plotly_doubleclick",null);a.emit("plotly_relayout",r.getViewEditsWithDerived(i))}));r.clearSelect=function(){m(r.dragOptions);d(r.dragOptions.gd)};r.onClickInPanFn=function(e){return function(t){var n=a._fullLayout.clickmode;if(n.indexOf("select")>-1){g(t.originalEvent,a,[r.xaxis],[r.yaxis],r.id,e)}if(n.indexOf("event")>-1){u.click(a,t.originalEvent)}}}};_.updateFx=function(e){var t=this;var r=t.map;var a=t.gd;if(t.isStatic)return;function i(e){var r=t.map.unproject(e);return[r.lng,r.lat]}var o=e.dragmode;var s;if(f(o)){s=function(e,r){var a=e.range={};a[t.id]=[i([r.xmin,r.ymin]),i([r.xmax,r.ymax])]}}else{s=function(e,r,a){var n=e.lassoPoints={};n[t.id]=a.filtered.map(i)}}var u=t.dragOptions;t.dragOptions=n.extendDeep(u||{},{dragmode:e.dragmode,element:t.div,gd:a,plotinfo:{id:t.id,domain:e[t.id].domain,xaxis:t.xaxis,yaxis:t.yaxis,fillRangeItems:s},xaxes:[t.xaxis],yaxes:[t.yaxis],subplot:t.id});r.off("click",t.onClickInPanHandler);if(p(o)||h(o)){r.dragPan.disable();r.on("zoomstart",t.clearSelect);t.dragOptions.prepFn=function(e,r,a){v(e,r,a,t.dragOptions,o)};l.init(t.dragOptions)}else{r.dragPan.enable();r.off("zoomstart",t.clearSelect);t.div.onmousedown=null;t.onClickInPanHandler=t.onClickInPanFn(t.dragOptions);r.on("click",t.onClickInPanHandler)}};_.updateFramework=function(e){var t=e[this.id].domain;var r=e._size;var a=this.div.style;a.width=r.w*(t.x[1]-t.x[0])+"px";a.height=r.h*(t.y[1]-t.y[0])+"px";a.left=r.l+t.x[0]*r.w+"px";a.top=r.t+(1-t.y[1])*r.h+"px";this.xaxis._offset=r.l+t.x[0]*r.w;this.xaxis._length=r.w*(t.x[1]-t.x[0]);this.yaxis._offset=r.t+(1-t.y[1])*r.h;this.yaxis._length=r.h*(t.y[1]-t.y[0])};_.updateLayers=function(e){var t=e[this.id];var r=t.layers;var a=this.layerList;var n;if(r.length!==a.length){for(n=0;n<a.length;n++){a[n].dispose()}a=this.layerList=[];for(n=0;n<r.length;n++){a.push(x(this,n,r[n]))}}else{for(n=0;n<r.length;n++){a[n].update(r[n])}}};_.destroy=function(){if(this.map){this.map.remove();this.map=null;this.container.removeChild(this.div)}};_.toImage=function(){this.map.stop();return this.map.getCanvas().toDataURL()};_.setOptions=function(e,t,r){for(var a in r){this.map[t](e,a,r[a])}};_.getMapLayers=function(){return this.map.getStyle().layers};_.addLayer=function(e,t){var r=this.map;if(typeof t==="string"){if(t===""){r.addLayer(e,t);return}var a=this.getMapLayers();for(var i=0;i<a.length;i++){if(t===a[i].id){r.addLayer(e,t);return}}n.warn(["Trying to add layer with *below* value",t,"referencing a layer that does not exist","or that does not yet exist."].join(" "))}r.addLayer(e)};_.project=function(e){return this.map.project(new a.LngLat(e[0],e[1]))};_.getView=function(){var e=this.map;var t=e.getCenter();var r={lon:t.lng,lat:t.lat};var a=e.getCanvas();var n=a.width;var i=a.height;return{center:r,zoom:e.getZoom(),bearing:e.getBearing(),pitch:e.getPitch(),_derived:{coordinates:[e.unproject([0,0]).toArray(),e.unproject([n,0]).toArray(),e.unproject([n,i]).toArray(),e.unproject([0,i]).toArray()]}}};_.getViewEdits=function(e){var t=this.id;var r=["center","zoom","bearing","pitch"];var a={};for(var n=0;n<r.length;n++){var i=r[n];a[t+"."+i]=e[i]}return a};_.getViewEditsWithDerived=function(e){var t=this.id;var r=this.getViewEdits(e);r[t+"._derived"]=e._derived;return r};function T(e){var t={};if(n.isPlainObject(e)){t.id=e.id;t.style=e}else if(typeof e==="string"){t.id=e;if(y.styleValuesMapbox.indexOf(e)!==-1){t.style=k(e)}else if(y.stylesNonMapbox[e]){t.style=y.stylesNonMapbox[e]}else{t.style=e}}else{t.id=y.styleValueDflt;t.style=k(y.styleValueDflt)}t.transition={duration:0,delay:0};return t}function k(e){return y.styleUrlPrefix+e+"-"+y.styleUrlSuffix}function M(e){return[e.lon,e.lat]}t.exports=b},{"../../components/dragelement":669,"../../components/dragelement/helpers":668,"../../components/fx":690,"../../lib":787,"../../lib/geo_location_utils":780,"../../registry":915,"../cartesian/axes":838,"../cartesian/select":858,"./constants":893,"./layers":896,"mapbox-gl/dist/mapbox-gl-unminified":451}],900:[function(e,t,r){"use strict";t.exports=function(e){var t=e.editType;return{t:{valType:"number",dflt:0,editType:t},r:{valType:"number",dflt:0,editType:t},b:{valType:"number",dflt:0,editType:t},l:{valType:"number",dflt:0,editType:t},editType:t}}},{}],901:[function(e,t,r){"use strict";var a=e("@plotly/d3");var n=e("d3-time-format").timeFormatLocale;var i=e("d3-format").formatLocale;var o=e("fast-isnumeric");var s=e("../registry");var l=e("../plot_api/plot_schema");var u=e("../plot_api/plot_template");var c=e("../lib");var f=e("../components/color");var h=e("../constants/numerical").BADNUM;var p=e("./cartesian/axis_ids");var v=e("./cartesian/handle_outline").clearSelect;var d=e("./animation_attributes");var m=e("./frame_attributes");var g=e("../plots/get_data").getModuleCalcData;var y=c.relinkPrivateKeys;var x=c._;var b=t.exports={};c.extendFlat(b,s);b.attributes=e("./attributes");b.attributes.type.values=b.allTypes;b.fontAttrs=e("./font_attributes");b.layoutAttributes=e("./layout_attributes");b.fontWeight="normal";var _=b.transformsRegistry;var w=e("./command");b.executeAPICommand=w.executeAPICommand;b.computeAPICommandBindings=w.computeAPICommandBindings;b.manageCommandObserver=w.manageCommandObserver;b.hasSimpleAPICommandBindings=w.hasSimpleAPICommandBindings;b.redrawText=function(e){e=c.getGraphDiv(e);return new Promise((function(t){setTimeout((function(){if(!e._fullLayout)return;s.getComponentMethod("annotations","draw")(e);s.getComponentMethod("legend","draw")(e);s.getComponentMethod("colorbar","draw")(e);t(b.previousPromises(e))}),300)}))};b.resize=function(e){e=c.getGraphDiv(e);var t;var r=new Promise((function(r,a){if(!e||c.isHidden(e)){a(new Error("Resize must be passed a displayed plot div element."))}if(e._redrawTimer)clearTimeout(e._redrawTimer);if(e._resolveResize)t=e._resolveResize;e._resolveResize=r;e._redrawTimer=setTimeout((function(){if(!e.layout||e.layout.width&&e.layout.height||c.isHidden(e)){r(e);return}delete e.layout.width;delete e.layout.height;var t=e.changed;e.autoplay=true;s.call("relayout",e,{autosize:true}).then((function(){e.changed=t;if(e._resolveResize===r){delete e._resolveResize;r(e)}}))}),100)}));if(t)t(r);return r};b.previousPromises=function(e){if((e._promises||[]).length){return Promise.all(e._promises).then((function(){e._promises=[]}))}};b.addLinks=function(e){if(!e._context.showLink&&!e._context.showSources)return;var t=e._fullLayout;var r=c.ensureSingle(t._paper,"text","js-plot-link-container",(function(e){e.style({"font-family":'"Open Sans", Arial, sans-serif',"font-size":"12px",fill:f.defaultLine,"pointer-events":"all"}).each((function(){var e=a.select(this);e.append("tspan").classed("js-link-to-tool",true);e.append("tspan").classed("js-link-spacer",true);e.append("tspan").classed("js-sourcelinks",true)}))}));var n=r.node();var i={y:t._paper.attr("height")-9};if(document.body.contains(n)&&n.getComputedTextLength()>=t.width-20){i["text-anchor"]="start";i.x=5}else{i["text-anchor"]="end";i.x=t._paper.attr("width")-7}r.attr(i);var o=r.select(".js-link-to-tool");var s=r.select(".js-link-spacer");var l=r.select(".js-sourcelinks");if(e._context.showSources)e._context.showSources(e);if(e._context.showLink)T(e,o);s.text(o.text()&&l.text()?" - ":"")};function T(e,t){t.text("");var r=t.append("a").attr({"xlink:xlink:href":"#",class:"link--impt link--embedview","font-weight":"bold"}).text(e._context.linkText+" "+String.fromCharCode(187));if(e._context.sendData){r.on("click",(function(){b.sendDataToCloud(e)}))}else{var a=window.location.pathname.split("/");var n=window.location.search;r.attr({"xlink:xlink:show":"new","xlink:xlink:href":"/"+a[2].split(".")[0]+"/"+a[1]+n})}}b.sendDataToCloud=function(e){var t=(window.PLOTLYENV||{}).BASE_URL||e._context.plotlyServerURL;if(!t)return;e.emit("plotly_beforeexport");var r=a.select(e).append("div").attr("id","hiddenform").style("display","none");var n=r.append("form").attr({action:t+"/external",method:"post",target:"_blank"});var i=n.append("input").attr({type:"text",name:"data"});i.node().value=b.graphJson(e,false,"keepdata");n.node().submit();r.remove();e.emit("plotly_afterexport");return false};var k=["days","shortDays","months","shortMonths","periods","dateTime","date","time","decimal","thousands","grouping","currency"];var M=["year","month","dayMonth","dayMonthYear"];b.supplyDefaults=function(e,t){var r=t&&t.skipUpdateCalc;var a=e._fullLayout||{};if(a._skipDefaults){delete a._skipDefaults;return}var n=e._fullLayout={};var i=e.layout||{};var o=e._fullData||[];var l=e._fullData=[];var u=e.data||[];var f=e.calcdata||[];var h=e._context||{};var p;if(!e._transitionData)b.createTransitionData(e);n._dfltTitle={plot:x(e,"Click to enter Plot title"),x:x(e,"Click to enter X axis title"),y:x(e,"Click to enter Y axis title"),colorbar:x(e,"Click to enter Colorscale title"),annotation:x(e,"new text")};n._traceWord=x(e,"trace");var d=E(e,k);n._mapboxAccessToken=h.mapboxAccessToken;if(a._initialAutoSizeIsDone){var m=a.width;var g=a.height;b.supplyLayoutGlobalDefaults(i,n,d);if(!i.width)n.width=m;if(!i.height)n.height=g;b.sanitizeMargins(n)}else{b.supplyLayoutGlobalDefaults(i,n,d);var _=!i.width||!i.height;var w=n.autosize;var T=h.autosizable;var I=_&&(w||T);if(I)b.plotAutoSize(e,i,n);else if(_)b.sanitizeMargins(n);if(!w&&_){i.width=n.width;i.height=n.height}}n._d3locale=L(d,n.separators);n._extraFormat=E(e,M);n._initialAutoSizeIsDone=true;n._dataLength=u.length;n._modules=[];n._visibleModules=[];n._basePlotModules=[];var P=n._subplots=S();var O=n._splomAxes={x:{},y:{}};var z=n._splomSubplots={};n._splomGridDflt={};n._scatterStackOpts={};n._firstScatter={};n._alignmentOpts={};n._colorAxes={};n._requestRangeslider={};n._traceUids=A(o,u);n._globalTransforms=(e._context||{}).globalTransforms;b.supplyDataDefaults(u,l,i,n);var R=Object.keys(O.x);var F=Object.keys(O.y);if(R.length>1&&F.length>1){s.getComponentMethod("grid","sizeDefaults")(i,n);for(p=0;p<R.length;p++){c.pushUnique(P.xaxis,R[p])}for(p=0;p<F.length;p++){c.pushUnique(P.yaxis,F[p])}for(var B in z){c.pushUnique(P.cartesian,B)}}n._has=b._hasPlotType.bind(n);if(o.length===l.length){for(p=0;p<l.length;p++){y(l[p],o[p])}}b.supplyLayoutModuleDefaults(i,n,l,e._transitionData);var N=n._visibleModules;var j=[];for(p=0;p<N.length;p++){var U=N[p].crossTraceDefaults;if(U)c.pushUnique(j,U)}for(p=0;p<j.length;p++){j[p](l,n)}n._hasOnlyLargeSploms=n._basePlotModules.length===1&&n._basePlotModules[0].name==="splom"&&R.length>15&&F.length>15&&n.shapes.length===0&&n.images.length===0;b.linkSubplots(l,n,o,a);b.cleanPlot(l,n,o,a);var V=!!(a._has&&a._has("gl2d"));var H=!!(n._has&&n._has("gl2d"));var q=!!(a._has&&a._has("cartesian"));var G=!!(n._has&&n._has("cartesian"));var Y=q||V;var W=G||H;if(Y&&!W){a._bgLayer.remove()}else if(W&&!Y){n._shouldCreateBgLayer=true}if(a._zoomlayer&&!e._dragging){v({_fullLayout:a})}C(l,n);y(n,a);s.getComponentMethod("colorscale","crossTraceDefaults")(l,n);if(!n._preGUI)n._preGUI={};if(!n._tracePreGUI)n._tracePreGUI={};var X=n._tracePreGUI;var Z={};var J;for(J in X)Z[J]="old";for(p=0;p<l.length;p++){J=l[p]._fullInput.uid;if(!Z[J])X[J]={};Z[J]="new"}for(J in Z){if(Z[J]==="old")delete X[J]}D(n);s.getComponentMethod("rangeslider","makeData")(n);if(!r&&f.length===l.length){b.supplyDefaultsUpdateCalc(f,l)}};b.supplyDefaultsUpdateCalc=function(e,t){for(var r=0;r<t.length;r++){var a=t[r];var n=(e[r]||[])[0];if(n&&n.trace){var i=n.trace;if(i._hasCalcTransform){var o=i._arrayAttrs;var s,l,u;for(s=0;s<o.length;s++){l=o[s];u=c.nestedProperty(i,l).get().slice();c.nestedProperty(a,l).set(u)}}n.trace=a}}};function A(e,t){var r=t.length;var a=[];var n,i;for(n=0;n<e.length;n++){var o=e[n]._fullInput;if(o!==i)a.push(o);i=o}var s=a.length;var l=new Array(r);var u={};function f(e,t){l[t]=e;u[e]=1}function h(e,t){if(e&&typeof e==="string"&&!u[e]){f(e,t);return true}}for(n=0;n<r;n++){var p=t[n].uid;if(typeof p==="number")p=String(p);if(h(p,n))continue;if(n<s&&h(a[n].uid,n))continue;f(c.randstr(u),n)}return l}function S(){var e=s.collectableSubplotTypes;var t={};var r,a;if(!e){e=[];var n=s.subplotsRegistry;for(var i in n){var o=n[i];var l=o.attr;if(l){e.push(i);if(Array.isArray(l)){for(a=0;a<l.length;a++){c.pushUnique(e,l[a])}}}}}for(r=0;r<e.length;r++){t[e[r]]=[]}return t}function E(e,t){var r=e._context.locale;if(!r)r="en-US";var a=false;var n={};function i(e){var r=true;for(var i=0;i<t.length;i++){var o=t[i];if(!n[o]){if(e[o]){n[o]=e[o]}else r=false}}if(r)a=true}for(var o=0;o<2;o++){var l=e._context.locales;for(var u=0;u<2;u++){var c=(l[r]||{}).format;if(c){i(c);if(a)break}l=s.localeRegistry}var f=r.split("-")[0];if(a||f===r)break;r=f}if(!a)i(s.localeRegistry.en.format);return n}function L(e,t){e.decimal=t.charAt(0);e.thousands=t.charAt(1);return{numberFormat:function(t){try{t=i(e).format(c.adjustFormat(t))}catch(r){c.warnBadFormat(t);return c.noFormat}return t},timeFormat:n(e).utcFormat}}function C(e,t){var r;var a=[];if(t.meta){r=t._meta={meta:t.meta,layout:{meta:t.meta}}}for(var n=0;n<e.length;n++){var i=e[n];if(i.meta){a[i.index]=i._meta={meta:i.meta}}else if(t.meta){i._meta={meta:t.meta}}if(t.meta){i._meta.layout={meta:t.meta}}}if(a.length){if(!r){r=t._meta={}}r.data=a}}b.createTransitionData=function(e){if(!e._transitionData){e._transitionData={}}if(!e._transitionData._frames){e._transitionData._frames=[]}if(!e._transitionData._frameHash){e._transitionData._frameHash={}}if(!e._transitionData._counter){e._transitionData._counter=0}if(!e._transitionData._interruptCallbacks){e._transitionData._interruptCallbacks=[]}};b._hasPlotType=function(e){var t;var r=this._basePlotModules||[];for(t=0;t<r.length;t++){if(r[t].name===e)return true}var a=this._modules||[];for(t=0;t<a.length;t++){var n=a[t].name;if(n===e)return true;var i=s.modules[n];if(i&&i.categories[e])return true}return false};b.cleanPlot=function(e,t,r,a){var n,i;var o=a._basePlotModules||[];for(n=0;n<o.length;n++){var s=o[n];if(s.clean){s.clean(e,t,r,a)}}var l=a._has&&a._has("gl");var u=t._has&&t._has("gl");if(l&&!u){if(a._glcontainer!==undefined){a._glcontainer.selectAll(".gl-canvas").remove();a._glcontainer.selectAll(".no-webgl").remove();a._glcanvas=null}}var c=!!a._infolayer;e:for(n=0;n<r.length;n++){var f=r[n];var h=f.uid;for(i=0;i<e.length;i++){var p=e[i];if(h===p.uid)continue e}if(c){a._infolayer.select(".cb"+h).remove()}}};b.linkSubplots=function(e,t,r,a){var n,i;var o=a._plots||{};var l=t._plots={};var u=t._subplots;var f={_fullData:e,_fullLayout:t};var h=u.cartesian.concat(u.gl2d||[]);for(n=0;n<h.length;n++){var v=h[n];var d=o[v];var m=p.getFromId(f,v,"x");var g=p.getFromId(f,v,"y");var y;if(d){y=l[v]=d}else{y=l[v]={};y.id=v}m._counterAxes.push(g._id);g._counterAxes.push(m._id);m._subplotsWith.push(v);g._subplotsWith.push(v);y.xaxis=m;y.yaxis=g;y._hasClipOnAxisFalse=false;for(i=0;i<e.length;i++){var x=e[i];if(x.xaxis===y.xaxis._id&&x.yaxis===y.yaxis._id&&x.cliponaxis===false){y._hasClipOnAxisFalse=true;break}}}var b=p.list(f,null,true);var _;for(n=0;n<b.length;n++){_=b[n];var w=null;if(_.overlaying){w=p.getFromId(f,_.overlaying);if(w&&w.overlaying){_.overlaying=false;w=null}}_._mainAxis=w||_;if(w)_.domain=w.domain.slice();_._anchorAxis=_.anchor==="free"?null:p.getFromId(f,_.anchor)}for(n=0;n<b.length;n++){_=b[n];_._counterAxes.sort(p.idSort);_._subplotsWith.sort(c.subplotSort);_._mainSubplot=I(_,t);if(_._counterAxes.length&&(_.spikemode&&_.spikemode.indexOf("across")!==-1||_.automargin&&_.mirror&&_.anchor!=="free"||s.getComponentMethod("rangeslider","isVisible")(_))){var T=1;var k=0;for(i=0;i<_._counterAxes.length;i++){var M=p.getFromId(f,_._counterAxes[i]);T=Math.min(T,M.domain[0]);k=Math.max(k,M.domain[1])}if(T<k){_._counterDomainMin=T;_._counterDomainMax=k}}}};function I(e,t){var r={_fullLayout:t};var a=e._id.charAt(0)==="x";var n=e._mainAxis._anchorAxis;var i="";var o="";var s="";if(n){s=n._mainAxis._id;i=a?e._id+s:s+e._id}if(!i||!t._plots[i]){i="";var l=e._counterAxes;for(var u=0;u<l.length;u++){var c=l[u];var f=a?e._id+c:c+e._id;if(!o)o=f;var h=p.getFromId(r,c);if(s&&h.overlaying===s){i=f;break}}}return i||o}b.clearExpandedTraceDefaultColors=function(e){var t,r,a;function n(e,a,n,i){r[i]=a;r.length=i+1;if(e.valType==="color"&&e.dflt===undefined){t.push(r.join("."))}}r=[];t=e._module._colorAttrs;if(!t){e._module._colorAttrs=t=[];l.crawl(e._module.attributes,n)}for(a=0;a<t.length;a++){var i=c.nestedProperty(e,"_input."+t[a]);if(!i.get()){c.nestedProperty(e,t[a]).set(null)}}};b.supplyDataDefaults=function(e,t,r,a){var n=a._modules;var i=a._visibleModules;var o=a._basePlotModules;var l=0;var f=0;var h,p,v;a._transformModules=[];function d(e){t.push(e);var r=e._module;if(!r)return;c.pushUnique(n,r);if(e.visible===true)c.pushUnique(i,r);c.pushUnique(o,e._module.basePlotModule);l++;if(e._input.visible!==false)f++}var m={};var g=[];var x=(r.template||{}).data||{};var _=u.traceTemplater(x);for(h=0;h<e.length;h++){v=e[h];p=_.newTrace(v);p.uid=a._traceUids[h];b.supplyTraceDefaults(v,p,f,a,h);p.index=h;p._input=v;p._expandedIndex=l;if(p.transforms&&p.transforms.length){var w=v.visible!==false&&p.visible===false;var T=O(p,t,r,a);for(var k=0;k<T.length;k++){var M=T[k];var A={_template:p._template,type:p.type,uid:p.uid+k};if(w&&M.visible===false){delete M.visible}b.supplyTraceDefaults(M,A,l,a,h);y(A,M);A.index=h;A._input=v;A._fullInput=p;A._expandedIndex=l;A._expandedInput=M;d(A)}}else{p._fullInput=p;p._expandedInput=p;d(p)}if(s.traceIs(p,"carpetAxis")){m[p.carpet]=p}if(s.traceIs(p,"carpetDependent")){g.push(h)}}for(h=0;h<g.length;h++){p=t[g[h]];if(!p.visible)continue;var S=m[p.carpet];p._carpet=S;if(!S||!S.visible){p.visible=false;continue}p.xaxis=S.xaxis;p.yaxis=S.yaxis}};b.supplyAnimationDefaults=function(e){e=e||{};var t;var r={};function a(t,a){return c.coerce(e||{},r,d,t,a)}a("mode");a("direction");a("fromcurrent");if(Array.isArray(e.frame)){r.frame=[];for(t=0;t<e.frame.length;t++){r.frame[t]=b.supplyAnimationFrameDefaults(e.frame[t]||{})}}else{r.frame=b.supplyAnimationFrameDefaults(e.frame||{})}if(Array.isArray(e.transition)){r.transition=[];for(t=0;t<e.transition.length;t++){r.transition[t]=b.supplyAnimationTransitionDefaults(e.transition[t]||{})}}else{r.transition=b.supplyAnimationTransitionDefaults(e.transition||{})}return r};b.supplyAnimationFrameDefaults=function(e){var t={};function r(r,a){return c.coerce(e||{},t,d.frame,r,a)}r("duration");r("redraw");return t};b.supplyAnimationTransitionDefaults=function(e){var t={};function r(r,a){return c.coerce(e||{},t,d.transition,r,a)}r("duration");r("easing");return t};b.supplyFrameDefaults=function(e){var t={};function r(r,a){return c.coerce(e,t,m,r,a)}r("group");r("name");r("traces");r("baseframe");r("data");r("layout");return t};b.supplyTraceDefaults=function(e,t,r,a,n){var i=a.colorway||f.defaults;var o=i[r%i.length];var l;function u(r,a){return c.coerce(e,t,b.attributes,r,a)}var h=u("visible");u("type");u("name",a._traceWord+" "+n);u("uirevision",a.uirevision);var p=b.getModule(t);t._module=p;if(p){var v=p.basePlotModule;var d=v.attr;var m=v.attributes;if(d&&m){var g=a._subplots;var y="";if(h||v.name!=="gl2d"){if(Array.isArray(d)){for(l=0;l<d.length;l++){var x=d[l];var _=c.coerce(e,t,m,x);if(g[x])c.pushUnique(g[x],_);y+=_}}else{y=c.coerce(e,t,m,d)}if(g[v.name]){c.pushUnique(g[v.name],y)}}}}if(h){u("customdata");u("ids");u("meta");if(s.traceIs(t,"showLegend")){c.coerce(e,t,p.attributes.showlegend?p.attributes:b.attributes,"showlegend");u("legendgroup");var w=u("legendgrouptitle.text");if(w){c.coerceFont(u,"legendgrouptitle.font",c.extendFlat({},a.font,{size:Math.round(a.font.size*1.1)}))}u("legendrank");t._dfltShowLegend=true}else{t._dfltShowLegend=false}if(p){p.supplyDefaults(e,t,o,a)}if(!s.traceIs(t,"noOpacity")){u("opacity")}if(s.traceIs(t,"notLegendIsolatable")){t.visible=!!t.visible}if(!s.traceIs(t,"noHover")){if(!t.hovertemplate)c.coerceHoverinfo(e,t,a);if(t.type!=="parcats"){s.getComponentMethod("fx","supplyDefaults")(e,t,o,a)}}if(p&&p.selectPoints){u("selectedpoints")}b.supplyTransformDefaults(e,t,a)}return t};function P(e){var t=e.transforms;if(Array.isArray(t)&&t.length){for(var r=0;r<t.length;r++){var a=t[r];var n=a._module||_[a.type];if(n&&n.makesData)return true}}return false}b.hasMakesDataTransform=P;b.supplyTransformDefaults=function(e,t,r){if(!(t._length||P(e)))return;var a=r._globalTransforms||[];var n=r._transformModules||[];if(!Array.isArray(e.transforms)&&a.length===0)return;var i=e.transforms||[];var o=a.concat(i);var s=t.transforms=[];for(var l=0;l<o.length;l++){var u=o[l];var f=u.type;var h=_[f];var p;var v=!(u._module&&u._module===h);var d=h&&typeof h.transform==="function";if(!h)c.warn("Unrecognized transform type "+f+".");if(h&&h.supplyDefaults&&(v||d)){p=h.supplyDefaults(u,t,r,e);p.type=f;p._module=h;c.pushUnique(n,h)}else{p=c.extendFlat({},u)}s.push(p)}};function O(e,t,r,a){var n=e.transforms;var i=[e];for(var o=0;o<n.length;o++){var s=n[o];var l=_[s.type];if(l&&l.transform){i=l.transform(i,{transform:s,fullTrace:e,fullData:t,layout:r,fullLayout:a,transformIndex:o})}}return i}b.supplyLayoutGlobalDefaults=function(e,t,r){function a(r,a){return c.coerce(e,t,b.layoutAttributes,r,a)}var n=e.template;if(c.isPlainObject(n)){t.template=n;t._template=n.layout;t._dataTemplate=n.data}a("autotypenumbers");var i=c.coerceFont(a,"font");a("title.text",t._dfltTitle.plot);c.coerceFont(a,"title.font",{family:i.family,size:Math.round(i.size*1.4),color:i.color});a("title.xref");a("title.yref");a("title.x");a("title.y");a("title.xanchor");a("title.yanchor");a("title.pad.t");a("title.pad.r");a("title.pad.b");a("title.pad.l");var o=a("uniformtext.mode");if(o){a("uniformtext.minsize")}a("autosize",!(e.width&&e.height));a("width");a("height");a("margin.l");a("margin.r");a("margin.t");a("margin.b");a("margin.pad");a("margin.autoexpand");if(e.width&&e.height)b.sanitizeMargins(t);s.getComponentMethod("grid","sizeDefaults")(e,t);a("paper_bgcolor");a("separators",r.decimal+r.thousands);a("hidesources");a("colorway");a("datarevision");var l=a("uirevision");a("editrevision",l);a("selectionrevision",l);s.getComponentMethod("modebar","supplyLayoutDefaults")(e,t);s.getComponentMethod("shapes","supplyDrawNewShapeDefaults")(e,t,a);a("meta");if(c.isPlainObject(e.transition)){a("transition.duration");a("transition.easing");a("transition.ordering")}s.getComponentMethod("calendars","handleDefaults")(e,t,"calendar");s.getComponentMethod("fx","supplyLayoutGlobalDefaults")(e,t,a)};function z(e){return typeof e==="string"&&e.substr(e.length-2)==="px"&&parseFloat(e)}b.plotAutoSize=function e(t,r,a){var n=t._context||{};var i=n.frameMargins;var s;var l;var u=c.isPlotDiv(t);if(u)t.emit("plotly_autosize");if(n.fillFrame){s=window.innerWidth;l=window.innerHeight;document.body.style.overflow="hidden"}else{var f=u?window.getComputedStyle(t):{};s=z(f.width)||z(f.maxWidth)||a.width;l=z(f.height)||z(f.maxHeight)||a.height;if(o(i)&&i>0){var h=1-2*i;s=Math.round(h*s);l=Math.round(h*l)}}var p=b.layoutAttributes.width.min;var v=b.layoutAttributes.height.min;if(s<p)s=p;if(l<v)l=v;var d=!r.width&&Math.abs(a.width-s)>1;var m=!r.height&&Math.abs(a.height-l)>1;if(m||d){if(d)a.width=s;if(m)a.height=l}if(!t._initialAutoSize){t._initialAutoSize={width:s,height:l}}b.sanitizeMargins(a)};b.supplyLayoutModuleDefaults=function(e,t,r,a){var n=s.componentsRegistry;var i=t._basePlotModules;var o,l,u;var f=s.subplotsRegistry.cartesian;for(o in n){u=n[o];if(u.includeBasePlot){u.includeBasePlot(e,t)}}if(!i.length){i.push(f)}if(t._has("cartesian")){s.getComponentMethod("grid","contentDefaults")(e,t);f.finalizeSubplots(e,t)}for(var h in t._subplots){t._subplots[h].sort(c.subplotSort)}for(l=0;l<i.length;l++){u=i[l];if(u.supplyLayoutDefaults){u.supplyLayoutDefaults(e,t,r)}}var p=t._modules;for(l=0;l<p.length;l++){u=p[l];if(u.supplyLayoutDefaults){u.supplyLayoutDefaults(e,t,r)}}var v=t._transformModules;for(l=0;l<v.length;l++){u=v[l];if(u.supplyLayoutDefaults){u.supplyLayoutDefaults(e,t,r,a)}}for(o in n){u=n[o];if(u.supplyLayoutDefaults){u.supplyLayoutDefaults(e,t,r)}}};b.purge=function(e){var t=e._fullLayout||{};if(t._glcontainer!==undefined){t._glcontainer.selectAll(".gl-canvas").remove();t._glcontainer.remove();t._glcanvas=null}if(t._modeBar)t._modeBar.destroy();if(e._transitionData){if(e._transitionData._interruptCallbacks){e._transitionData._interruptCallbacks.length=0}if(e._transitionData._animationRaf){window.cancelAnimationFrame(e._transitionData._animationRaf)}}c.clearThrottle();c.clearResponsive(e);delete e.data;delete e.layout;delete e._fullData;delete e._fullLayout;delete e.calcdata;delete e.empty;delete e.fid;delete e.undoqueue;delete e.undonum;delete e.autoplay;delete e.changed;delete e._promises;delete e._redrawTimer;delete e._hmlumcount;delete e._hmpixcount;delete e._transitionData;delete e._transitioning;delete e._initialAutoSize;delete e._transitioningWithDuration;delete e._dragging;delete e._dragged;delete e._dragdata;delete e._hoverdata;delete e._snapshotInProgress;delete e._editing;delete e._mouseDownTime;delete e._legendMouseDownTime;if(e.removeAllListeners)e.removeAllListeners()};b.style=function(e){var t=e._fullLayout._visibleModules;var r=[];var a;for(a=0;a<t.length;a++){var n=t[a];if(n.style){c.pushUnique(r,n.style)}}for(a=0;a<r.length;a++){r[a](e)}};b.sanitizeMargins=function(e){if(!e||!e.margin)return;var t=e.width;var r=e.height;var a=e.margin;var n=t-(a.l+a.r);var i=r-(a.t+a.b);var o;if(n<0){o=(t-1)/(a.l+a.r);a.l=Math.floor(o*a.l);a.r=Math.floor(o*a.r)}if(i<0){o=(r-1)/(a.t+a.b);a.t=Math.floor(o*a.t);a.b=Math.floor(o*a.b)}};b.clearAutoMarginIds=function(e){e._fullLayout._pushmarginIds={}};b.allowAutoMargin=function(e,t){e._fullLayout._pushmarginIds[t]=1};function D(e){var t=e.margin;if(!e._size){var r=e._size={l:Math.round(t.l),r:Math.round(t.r),t:Math.round(t.t),b:Math.round(t.b),p:Math.round(t.pad)};r.w=Math.round(e.width)-r.l-r.r;r.h=Math.round(e.height)-r.t-r.b}if(!e._pushmargin)e._pushmargin={};if(!e._pushmarginIds)e._pushmarginIds={}}var R=2;var F=2;var B=64;var N=64;b.autoMargin=function(e,t,r){var a=e._fullLayout;var n=a.width;var i=a.height;var o=a.margin;var s=c.constrain(n-o.l-o.r,R,B);var l=c.constrain(i-o.t-o.b,F,N);var u=Math.max(0,n-s);var f=Math.max(0,i-l);var h=a._pushmargin;var p=a._pushmarginIds;if(o.autoexpand!==false){if(!r){delete h[t];delete p[t]}else{var v=r.pad;if(v===undefined){v=Math.min(12,o.l,o.r,o.t,o.b)}if(u){var d=(r.l+r.r)/u;if(d>1){r.l/=d;r.r/=d}}if(f){var m=(r.t+r.b)/f;if(m>1){r.t/=m;r.b/=m}}var g=r.xl!==undefined?r.xl:r.x;var y=r.xr!==undefined?r.xr:r.x;var x=r.yt!==undefined?r.yt:r.y;var _=r.yb!==undefined?r.yb:r.y;h[t]={l:{val:g,size:r.l+v},r:{val:y,size:r.r+v},b:{val:_,size:r.b+v},t:{val:x,size:r.t+v}};p[t]=1}if(!a._replotting){return b.doAutoMargin(e)}}};b.doAutoMargin=function(e){var t=e._fullLayout;var r=t.width;var a=t.height;if(!t._size)t._size={};D(t);var n=t._size;var i=t.margin;var l=c.extendFlat({},n);var u=i.l;var f=i.r;var h=i.t;var p=i.b;var v=t._pushmargin;var d=t._pushmarginIds;if(t.margin.autoexpand!==false){for(var m in v){if(!d[m])delete v[m]}v.base={l:{val:0,size:u},r:{val:1,size:f},t:{val:1,size:h},b:{val:0,size:p}};for(var g in v){var y=v[g].l||{};var x=v[g].b||{};var _=y.val;var w=y.size;var T=x.val;var k=x.size;for(var M in v){if(o(w)&&v[M].r){var A=v[M].r.val;var S=v[M].r.size;if(A>_){var E=(w*A+(S-r)*_)/(A-_);var L=(S*(1-_)+(w-r)*(1-A))/(A-_);if(E+L>u+f){u=E;f=L}}}if(o(k)&&v[M].t){var C=v[M].t.val;var I=v[M].t.size;if(C>T){var P=(k*C+(I-a)*T)/(C-T);var O=(I*(1-T)+(k-a)*(1-C))/(C-T);if(P+O>p+h){p=P;h=O}}}}}}var z=c.constrain(r-i.l-i.r,R,B);var U=c.constrain(a-i.t-i.b,F,N);var V=Math.max(0,r-z);var H=Math.max(0,a-U);if(V){var q=(u+f)/V;if(q>1){u/=q;f/=q}}if(H){var G=(p+h)/H;if(G>1){p/=G;h/=G}}n.l=Math.round(u);n.r=Math.round(f);n.t=Math.round(h);n.b=Math.round(p);n.p=Math.round(i.pad);n.w=Math.round(r)-n.l-n.r;n.h=Math.round(a)-n.t-n.b;if(!t._replotting&&b.didMarginChange(l,n)){if("_redrawFromAutoMarginCount"in t){t._redrawFromAutoMarginCount++}else{t._redrawFromAutoMarginCount=1}var Y=3*(1+Object.keys(d).length);if(t._redrawFromAutoMarginCount<Y){return s.call("_doPlot",e)}else{t._size=l;c.warn("Too many auto-margin redraws.")}}j(e)};function j(e){var t=p.list(e,"",true);["_adjustTickLabelsOverflow","_hideCounterAxisInsideTickLabels"].forEach((function(e){for(var r=0;r<t.length;r++){var a=t[r][e];if(a)a()}}))}var U=["l","r","t","b","p","w","h"];b.didMarginChange=function(e,t){for(var r=0;r<U.length;r++){var a=U[r];var n=e[a];var i=t[a];if(!o(n)||Math.abs(i-n)>1){return true}}return false};b.graphJson=function(e,t,r,a,n,i){if(n&&t&&!e._fullData||n&&!t&&!e._fullLayout){b.supplyDefaults(e)}var o=n?e._fullData:e.data;var s=n?e._fullLayout:e.layout;var l=(e._transitionData||{})._frames;function u(e,t){if(typeof e==="function"){return t?"_function_":null}if(c.isPlainObject(e)){var a={};var n;Object.keys(e).sort().forEach((function(i){if(["_","["].indexOf(i.charAt(0))!==-1)return;if(typeof e[i]==="function"){if(t)a[i]="_function";return}if(r==="keepdata"){if(i.substr(i.length-3)==="src"){return}}else if(r==="keepstream"){n=e[i+"src"];if(typeof n==="string"&&n.indexOf(":")>0){if(!c.isPlainObject(e.stream)){return}}}else if(r!=="keepall"){n=e[i+"src"];if(typeof n==="string"&&n.indexOf(":")>0){return}}a[i]=u(e[i],t)}));return a}if(Array.isArray(e)){return e.map((function(e){return u(e,t)}))}if(c.isTypedArray(e)){return c.simpleMap(e,c.identity)}if(c.isJSDate(e))return c.ms2DateTimeLocal(+e);return e}var f={data:(o||[]).map((function(e){var r=u(e);if(t){delete r.fit}return r}))};if(!t){f.layout=u(s);if(n){var h=s._size;f.layout.computed={margin:{b:h.b,l:h.l,r:h.r,t:h.t}}}}if(l)f.frames=u(l);if(i)f.config=u(e._context,true);return a==="object"?f:JSON.stringify(f)};b.modifyFrames=function(e,t){var r,a,n;var i=e._transitionData._frames;var o=e._transitionData._frameHash;for(r=0;r<t.length;r++){a=t[r];switch(a.type){case"replace":n=a.value;var s=(i[a.index]||{}).name;var l=n.name;i[a.index]=o[l]=n;if(l!==s){delete o[s];o[l]=n}break;case"insert":n=a.value;o[n.name]=n;i.splice(a.index,0,n);break;case"delete":n=i[a.index];delete o[n.name];i.splice(a.index,1);break}}return Promise.resolve()};b.computeFrame=function(e,t){var r=e._transitionData._frameHash;var a,n,i,o;if(!t){throw new Error("computeFrame must be given a string frame name")}var s=r[t.toString()];if(!s){return false}var l=[s];var u=[s.name];while(s.baseframe&&(s=r[s.baseframe.toString()])){if(u.indexOf(s.name)!==-1)break;l.push(s);u.push(s.name)}var c={};while(s=l.pop()){if(s.layout){c.layout=b.extendLayout(c.layout,s.layout)}if(s.data){if(!c.data){c.data=[]}n=s.traces;if(!n){n=[];for(a=0;a<s.data.length;a++){n[a]=a}}if(!c.traces){c.traces=[]}for(a=0;a<s.data.length;a++){i=n[a];if(i===undefined||i===null){continue}o=c.traces.indexOf(i);if(o===-1){o=c.data.length;c.traces[o]=i}c.data[o]=b.extendTrace(c.data[o],s.data[a])}}}return c};b.recomputeFrameHash=function(e){var t=e._transitionData._frameHash={};var r=e._transitionData._frames;for(var a=0;a<r.length;a++){var n=r[a];if(n&&n.name){t[n.name]=n}}};b.extendObjectWithContainers=function(e,t,r){var a,n,i,o,s,l,u,f;var h=c.extendDeepNoArrays({},t||{});var p=c.expandObjectPaths(h);var v={};if(r&&r.length){for(i=0;i<r.length;i++){a=c.nestedProperty(p,r[i]);n=a.get();if(n===undefined){c.nestedProperty(v,r[i]).set(null)}else{a.set(null);c.nestedProperty(v,r[i]).set(n)}}}e=c.extendDeepNoArrays(e||{},p);if(r&&r.length){for(i=0;i<r.length;i++){s=c.nestedProperty(v,r[i]);u=s.get();if(!u)continue;l=c.nestedProperty(e,r[i]);f=l.get();if(!Array.isArray(f)){f=[];l.set(f)}for(o=0;o<u.length;o++){var d=u[o];if(d===null)f[o]=null;else{f[o]=b.extendObjectWithContainers(f[o],d)}}l.set(f)}}return e};b.dataArrayContainers=["transforms","dimensions"];b.layoutArrayContainers=s.layoutArrayContainers;b.extendTrace=function(e,t){return b.extendObjectWithContainers(e,t,b.dataArrayContainers)};b.extendLayout=function(e,t){return b.extendObjectWithContainers(e,t,b.layoutArrayContainers)};b.transition=function(e,t,r,a,n,i){var o={redraw:n.redraw};var s={};var l=[];o.prepareFn=function(){var n=Array.isArray(t)?t.length:0;var i=a.slice(0,n);for(var o=0;o<i.length;o++){var u=i[o];var f=e._fullData[u];var h=f._module;if(!h)continue;if(h.animatable){var p=h.basePlotModule.name;if(!s[p])s[p]=[];s[p].push(u)}e.data[i[o]]=b.extendTrace(e.data[i[o]],t[o])}var v=c.expandObjectPaths(c.extendDeepNoArrays({},r));var d=/^[xy]axis[0-9]*$/;for(var m in v){if(!d.test(m))continue;delete v[m].range}b.extendLayout(e.layout,v);delete e.calcdata;b.supplyDefaults(e);b.doCalcdata(e);var g=c.expandObjectPaths(r);if(g){var y=e._fullLayout._plots;for(var x in y){var _=y[x];var w=_.xaxis;var T=_.yaxis;var k=w.range.slice();var M=T.range.slice();var A=null;var S=null;var E=null;var L=null;if(Array.isArray(g[w._name+".range"])){A=g[w._name+".range"].slice()}else if(Array.isArray((g[w._name]||{}).range)){A=g[w._name].range.slice()}if(Array.isArray(g[T._name+".range"])){S=g[T._name+".range"].slice()}else if(Array.isArray((g[T._name]||{}).range)){S=g[T._name].range.slice()}if(k&&A&&(w.r2l(k[0])!==w.r2l(A[0])||w.r2l(k[1])!==w.r2l(A[1]))){E={xr0:k,xr1:A}}if(M&&S&&(T.r2l(M[0])!==T.r2l(S[0])||T.r2l(M[1])!==T.r2l(S[1]))){L={yr0:M,yr1:S}}if(E||L){l.push(c.extendFlat({plotinfo:_},E,L))}}}return Promise.resolve()};o.runFn=function(t){var a;var n=e._fullLayout._basePlotModules;var o=l.length;var u;if(r){for(u=0;u<n.length;u++){if(n[u].transitionAxes){n[u].transitionAxes(e,l,i,t)}}}if(o){a=c.extendFlat({},i);a.duration=0;delete s.cartesian}else{a=i}for(var f in s){var h=s[f];var p=e._fullData[h[0]]._module;p.basePlotModule.plot(e,h,a,t)}};return V(e,i,o)};b.transitionFromReact=function(e,t,r,a){var n=e._fullLayout;var i=n.transition;var o={};var s=[];o.prepareFn=function(){var e=n._plots;o.redraw=false;if(t.anim==="some")o.redraw=true;if(r.anim==="some")o.redraw=true;for(var i in e){var l=e[i];var u=l.xaxis;var f=l.yaxis;var h=a[u._name].range.slice();var p=a[f._name].range.slice();var v=u.range.slice();var d=f.range.slice();u.setScale();f.setScale();var m=null;var g=null;if(u.r2l(h[0])!==u.r2l(v[0])||u.r2l(h[1])!==u.r2l(v[1])){m={xr0:h,xr1:v}}if(f.r2l(p[0])!==f.r2l(d[0])||f.r2l(p[1])!==f.r2l(d[1])){g={yr0:p,yr1:d}}if(m||g){s.push(c.extendFlat({plotinfo:l},m,g))}}return Promise.resolve()};o.runFn=function(r){var a=e._fullData;var n=e._fullLayout;var o=n._basePlotModules;var l;var u;var f;var h=[];for(var p=0;p<a.length;p++){h.push(p)}function v(){if(!e._fullLayout)return;for(var t=0;t<o.length;t++){if(o[t].transitionAxes){o[t].transitionAxes(e,s,l,r)}}}function d(){if(!e._fullLayout)return;for(var t=0;t<o.length;t++){o[t].plot(e,f,u,r)}}if(s.length&&t.anim){if(i.ordering==="traces first"){l=c.extendFlat({},i,{duration:0});f=h;u=i;setTimeout(v,i.duration);d()}else{l=i;f=null;u=c.extendFlat({},i,{duration:0});setTimeout(d,l.duration);v()}}else if(s.length){l=i;v()}else if(t.anim){f=h;u=i;d()}};return V(e,i,o)};function V(e,t,r){var a=false;function n(e){var t=Promise.resolve();if(!e)return t;while(e.length){t=t.then(e.shift())}return t}function i(e){if(!e)return;while(e.length){e.shift()}}function o(){e.emit("plotly_transitioning",[]);return new Promise((function(n){e._transitioning=true;if(t.duration>0){e._transitioningWithDuration=true}e._transitionData._interruptCallbacks.push((function(){a=true}));if(r.redraw){e._transitionData._interruptCallbacks.push((function(){return s.call("redraw",e)}))}e._transitionData._interruptCallbacks.push((function(){e.emit("plotly_transitioninterrupted",[])}));var i=0;var o=0;function u(){i++;return function(){o++;if(!a&&o===i){l(n)}}}r.runFn(u);setTimeout(u())}))}function l(t){if(!e._transitionData)return;i(e._transitionData._interruptCallbacks);return Promise.resolve().then((function(){if(r.redraw){return s.call("redraw",e)}})).then((function(){e._transitioning=false;e._transitioningWithDuration=false;e.emit("plotly_transitioned",[])})).then(t)}function u(){if(!e._transitionData)return;e._transitioning=false;return n(e._transitionData._interruptCallbacks)}var f=[b.previousPromises,u,r.prepareFn,b.rehover,o];var h=c.syncOrAsync(f,e);if(!h||!h.then){h=Promise.resolve()}return h.then((function(){return e}))}b.doCalcdata=function(e,t){var r=p.list(e);var a=e._fullData;var n=e._fullLayout;var i,o,u,c;var f=new Array(a.length);var v=(e.calcdata||[]).slice();e.calcdata=f;n._numBoxes=0;n._numViolins=0;n._violinScaleGroupStats={};e._hmpixcount=0;e._hmlumcount=0;n._piecolormap={};n._sunburstcolormap={};n._treemapcolormap={};n._iciclecolormap={};n._funnelareacolormap={};for(u=0;u<a.length;u++){if(Array.isArray(t)&&t.indexOf(u)===-1){f[u]=v[u];continue}}for(u=0;u<a.length;u++){i=a[u];i._arrayAttrs=l.findArrayAttributes(i);i._extremes={}}var d=n._subplots.polar||[];for(u=0;u<d.length;u++){r.push(n[d[u]].radialaxis,n[d[u]].angularaxis)}for(var m in n._colorAxes){var g=n[m];if(g.cauto!==false){delete g.cmin;delete g.cmax}}var y=false;function x(t){i=a[t];o=i._module;if(i.visible===true&&i.transforms){if(o&&o.calc){var r=o.calc(e,i);if(r[0]&&r[0].t&&r[0].t._scene){delete r[0].t._scene.dirty}}for(c=0;c<i.transforms.length;c++){var n=i.transforms[c];o=_[n.type];if(o&&o.calcTransform){i._hasCalcTransform=true;y=true;o.calcTransform(e,i,n)}}}}function b(t,r){i=a[t];o=i._module;if(!!o.isContainer!==r)return;var n=[];if(i.visible===true&&i._length!==0){delete i._indexToPoints;var s=i.transforms||[];for(c=s.length-1;c>=0;c--){if(s[c].enabled){i._indexToPoints=s[c]._indexToPoints;break}}if(o&&o.calc){n=o.calc(e,i)}}if(!Array.isArray(n)||!n[0]){n=[{x:h,y:h}]}if(!n[0].t)n[0].t={};n[0].trace=i;f[t]=n}G(r,a,n);for(u=0;u<a.length;u++)b(u,true);for(u=0;u<a.length;u++)x(u);if(y)G(r,a,n);for(u=0;u<a.length;u++)b(u,true);for(u=0;u<a.length;u++)b(u,false);Y(e);var w=q(r,e);if(w.length){n._numBoxes=0;n._numViolins=0;for(u=0;u<w.length;u++)b(w[u],true);for(u=0;u<w.length;u++)b(w[u],false);Y(e)}s.getComponentMethod("fx","calc")(e);s.getComponentMethod("errorbars","calc")(e)};var H=/(total|sum|min|max|mean|median) (ascending|descending)/;function q(e,t){var r=[];var a,n,i,o,l;function u(e,r,a){var n=r._id.charAt(0);if(e==="histogram2dcontour"){var i=r._counterAxes[0];var o=p.getFromId(t,i);var s=n==="x"||i==="x"&&o.type==="category";var l=n==="y"||i==="y"&&o.type==="category";return function(e,t){if(e===0||t===0)return-1;if(s&&e===a[t].length-1)return-1;if(l&&t===a.length-1)return-1;return(n==="y"?t:e)-1}}else{return function(e,t){return n==="y"?t:e}}}var f={min:function(e){return c.aggNums(Math.min,null,e)},max:function(e){return c.aggNums(Math.max,null,e)},sum:function(e){return c.aggNums((function(e,t){return e+t}),null,e)},total:function(e){return c.aggNums((function(e,t){return e+t}),null,e)},mean:function(e){return c.mean(e)},median:function(e){return c.median(e)}};for(a=0;a<e.length;a++){var h=e[a];if(h.type!=="category")continue;var v=h.categoryorder.match(H);if(v){var d=v[1];var m=v[2];var g=h._id.charAt(0);var y=g==="x";var x=[];for(n=0;n<h._categories.length;n++){x.push([h._categories[n],[]])}for(n=0;n<h._traceIndices.length;n++){var b=h._traceIndices[n];var _=t._fullData[b];if(_.visible!==true)continue;var w=_.type;if(s.traceIs(_,"histogram")){delete _._xautoBinFinished;delete _._yautoBinFinished}var T=w==="splom";var k=w==="scattergl";var M=t.calcdata[b];for(i=0;i<M.length;i++){var A=M[i];var S,E;if(T){var L=_._axesDim[h._id];if(!y){var C=_._diag[L][0];if(C)h=t._fullLayout[p.id2name(C)]}var I=A.trace.dimensions[L].values;for(o=0;o<I.length;o++){S=h._categoriesMap[I[o]];for(l=0;l<A.trace.dimensions.length;l++){if(l===L)continue;var P=A.trace.dimensions[l];x[S][1].push(P.values[o])}}}else if(k){for(o=0;o<A.t.x.length;o++){if(y){S=A.t.x[o];E=A.t.y[o]}else{S=A.t.y[o];E=A.t.x[o]}x[S][1].push(E)}if(A.t&&A.t._scene){delete A.t._scene.dirty}}else if(A.hasOwnProperty("z")){E=A.z;var O=u(_.type,h,E);for(o=0;o<E.length;o++){for(l=0;l<E[o].length;l++){S=O(l,o);if(S+1)x[S][1].push(E[o][l])}}}else{S=A.p;if(S===undefined)S=A[g];E=A.s;if(E===undefined)E=A.v;if(E===undefined)E=y?A.y:A.x;if(!Array.isArray(E)){if(E===undefined)E=[];else E=[E]}for(o=0;o<E.length;o++){x[S][1].push(E[o])}}}}h._categoriesValue=x;var z=[];for(n=0;n<x.length;n++){z.push([x[n][0],f[d](x[n][1])])}z.sort((function(e,t){return e[1]-t[1]}));h._categoriesAggregatedValue=z;h._initialCategories=z.map((function(e){return e[0]}));if(m==="descending"){h._initialCategories.reverse()}r=r.concat(h.sortByInitialCategories())}}return r}function G(e,t,r){var a={};function n(e){e.clearCalc();if(e.type==="multicategory"){e.setupMultiCategory(t)}a[e._id]=1}c.simpleMap(e,n);var i=r._axisMatchGroups||[];for(var o=0;o<i.length;o++){for(var s in i[o]){if(!a[s]){n(r[p.id2name(s)])}}}}function Y(e){var t=e._fullLayout;var r=t._visibleModules;var a={};var n,i,o;for(i=0;i<r.length;i++){var s=r[i];var l=s.crossTraceCalc;if(l){var u=s.basePlotModule.name;if(a[u]){c.pushUnique(a[u],l)}else{a[u]=[l]}}}for(o in a){var f=a[o];var h=t._subplots[o];if(Array.isArray(h)){for(n=0;n<h.length;n++){var p=h[n];var v=o==="cartesian"?t._plots[p]:t[p];for(i=0;i<f.length;i++){f[i](e,v,p)}}}else{for(i=0;i<f.length;i++){f[i](e)}}}}b.rehover=function(e){if(e._fullLayout._rehover){e._fullLayout._rehover()}};b.redrag=function(e){if(e._fullLayout._redrag){e._fullLayout._redrag()}};b.generalUpdatePerTraceModule=function(e,t,r,a){var n=t.traceHash;var i={};var o;for(o=0;o<r.length;o++){var s=r[o];var l=s[0].trace;if(l.visible){i[l.type]=i[l.type]||[];i[l.type].push(s)}}for(var u in n){if(!i[u]){var f=n[u][0];var h=f[0].trace;h.visible=false;i[u]=[f]}}for(var p in i){var v=i[p];var d=v[0][0].trace._module;d.plot(e,t,c.filterVisible(v),a)}t.traceHash=i};b.plotBasePlot=function(e,t,r,a,n){var i=s.getModule(e);var o=g(t.calcdata,i)[0];i.plot(t,o,a,n)};b.cleanBasePlot=function(e,t,r,a,n){var i=n._has&&n._has(e);var o=r._has&&r._has(e);if(i&&!o){n["_"+e+"layer"].selectAll("g.trace").remove()}}},{"../components/color":650,"../constants/numerical":763,"../lib":787,"../plot_api/plot_schema":826,"../plot_api/plot_template":827,"../plots/get_data":875,"../registry":915,"./animation_attributes":832,"./attributes":834,"./cartesian/axis_ids":842,"./cartesian/handle_outline":849,"./command":865,"./font_attributes":867,"./frame_attributes":868,"./layout_attributes":892,"@plotly/d3":58,"d3-format":164,"d3-time-format":172,"fast-isnumeric":246}],902:[function(e,t,r){"use strict";t.exports={attr:"subplot",name:"polar",axisNames:["angularaxis","radialaxis"],axisName2dataArray:{angularaxis:"theta",radialaxis:"r"},layerNames:["draglayer","plotbg","backplot","angular-grid","radial-grid","frontplot","angular-line","radial-line","angular-axis","radial-axis"],radialDragBoxSize:50,angularDragBoxSize:30,cornerLen:25,cornerHalfWidth:2,MINDRAG:8,MINZOOM:20,OFFEDGE:20}},{}],903:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("../../lib/polygon").tester;var i=a.findIndexOfMin;var o=a.isAngleInsideSector;var s=a.angleDelta;var l=a.angleDist;function u(e,t,r,a,i){if(!o(t,a))return false;var s,l;if(r[0]<r[1]){s=r[0];l=r[1]}else{s=r[1];l=r[0]}var u=n(v(s,a[0],a[1],i));var c=n(v(l,a[0],a[1],i));var f=[e*Math.cos(t),e*Math.sin(t)];return c.contains(f)&&!u.contains(f)}function c(e,t,r,a){var n,i;var o=a[0];var s=a[1];var l=g(Math.sin(t)-Math.sin(e));var u=g(Math.cos(t)-Math.cos(e));var c=Math.tan(r);var f=g(1/c);var h=l/u;var p=s-h*o;if(f){if(l&&u){n=p/(c-h);i=c*n}else if(u){n=s*f;i=s}else{n=o;i=o*c}}else{if(l&&u){n=0;i=p}else if(u){n=0;i=s}else{n=i=NaN}}return[n,i]}function f(e,t,r,a){var n=-t*r;var i=t*t+1;var o=2*(t*n-r);var s=n*n+r*r-e*e;var l=Math.sqrt(o*o-4*i*s);var u=(-o+l)/(2*i);var c=(-o-l)/(2*i);return[[u,t*u+n+a],[c,t*c+n+a]]}function h(e,t){var r=t.length;var a=new Array(r+1);var n;for(n=0;n<r;n++){var i=t[n];a[n]=[e*Math.cos(i),e*Math.sin(i)]}a[n]=a[0].slice();return a}function p(e,t,r,n){var s=n.length;var u=[];var f,h;function p(t){return[e*Math.cos(t),e*Math.sin(t)]}function v(e,t,r){return c(e,t,r,p(e))}function d(e){return a.mod(e,s)}function m(e){return o(e,[t,r])}var g=i(n,(function(e){return m(e)?l(e,t):Infinity}));var y=v(n[g],n[d(g-1)],t);u.push(y);for(f=g,h=0;h<s;f++,h++){var x=n[d(f)];if(!m(x))break;u.push(p(x))}var b=i(n,(function(e){return m(e)?l(e,r):Infinity}));var _=v(n[b],n[d(b+1)],r);u.push(_);u.push([0,0]);u.push(u[0].slice());return u}function v(e,t,r,n){return a.isFullCircle([t,r])?h(e,n):p(e,t,r,n)}function d(e,t,r,a){var n=Infinity;var i=Infinity;var o=v(e,t,r,a);for(var s=0;s<o.length;s++){var l=o[s];n=Math.min(n,l[0]);i=Math.min(i,-l[1])}return[n,i]}function m(e,t){var r=function(t){var r=s(t,e);return r>0?r:Infinity};var n=i(t,r);var o=a.mod(n+1,t.length);return[t[n],t[o]]}function g(e){return Math.abs(e)>1e-10?e:0}function y(e,t,r){t=t||0;r=r||0;var a=e.length;var n=new Array(a);for(var i=0;i<a;i++){var o=e[i];n[i]=[t+o[0],r-o[1]]}return n}function x(e,t,r,a,n,i){var o=v(e,t,r,a);return"M"+y(o,n,i).join("L")}function b(e,t,r,a,n,i,o){var s,l;if(e<t){s=e;l=t}else{s=t;l=e}var u=y(v(s,r,a,n),i,o);var c=y(v(l,r,a,n),i,o);return"M"+c.reverse().join("L")+"M"+u.join("L")}t.exports={isPtInsidePolygon:u,findPolygonOffset:d,findEnclosingVertexAngles:m,findIntersectionXY:c,findXYatLength:f,clampTiny:g,pathPolygon:x,pathPolygonAnnulus:b}},{"../../lib":787,"../../lib/polygon":799}],904:[function(e,t,r){"use strict";var a=e("../get_data").getSubplotCalcData;var n=e("../../lib").counterRegex;var i=e("./polar");var o=e("./constants");var s=o.attr;var l=o.name;var u=n(l);var c={};c[s]={valType:"subplotid",dflt:l,editType:"calc"};function f(e){var t=e._fullLayout;var r=e.calcdata;var n=t._subplots[l];for(var o=0;o<n.length;o++){var s=n[o];var u=a(r,l,s);var c=t[s]._subplot;if(!c){c=i(e,s);t[s]._subplot=c}c.plot(u,t,e._promises)}}function h(e,t,r,a){var n=a._subplots[l]||[];var i=a._has&&a._has("gl");var o=t._has&&t._has("gl");var s=i&&!o;for(var u=0;u<n.length;u++){var c=n[u];var f=a[c]._subplot;if(!t[c]&&!!f){f.framework.remove();f.layers["radial-axis-title"].remove();for(var h in f.clipPaths){f.clipPaths[h].remove()}}if(s&&f._scene){f._scene.destroy();f._scene=null}}}t.exports={attr:s,name:l,idRoot:l,idRegex:u,attrRegex:u,attributes:c,layoutAttributes:e("./layout_attributes"),supplyLayoutDefaults:e("./layout_defaults"),plot:f,clean:h,toSVG:e("../cartesian").toSVG}},{"../../lib":787,"../cartesian":852,"../get_data":875,"./constants":902,"./layout_attributes":905,"./layout_defaults":906,"./polar":907}],905:[function(e,t,r){"use strict";var a=e("../../components/color/attributes");var n=e("../cartesian/layout_attributes");var i=e("../domain").attributes;var o=e("../../lib").extendFlat;var s=e("../../plot_api/edit_types").overrideAll;var l=s({color:n.color,showline:o({},n.showline,{dflt:true}),linecolor:n.linecolor,linewidth:n.linewidth,showgrid:o({},n.showgrid,{dflt:true}),gridcolor:n.gridcolor,gridwidth:n.gridwidth},"plot","from-root");var u=s({tickmode:n.tickmode,nticks:n.nticks,tick0:n.tick0,dtick:n.dtick,tickvals:n.tickvals,ticktext:n.ticktext,ticks:n.ticks,ticklen:n.ticklen,tickwidth:n.tickwidth,tickcolor:n.tickcolor,showticklabels:n.showticklabels,showtickprefix:n.showtickprefix,tickprefix:n.tickprefix,showticksuffix:n.showticksuffix,ticksuffix:n.ticksuffix,showexponent:n.showexponent,exponentformat:n.exponentformat,minexponent:n.minexponent,separatethousands:n.separatethousands,tickfont:n.tickfont,tickangle:n.tickangle,tickformat:n.tickformat,tickformatstops:n.tickformatstops,layer:n.layer},"plot","from-root");var c={visible:o({},n.visible,{dflt:true}),type:o({},n.type,{values:["-","linear","log","date","category"]}),autotypenumbers:n.autotypenumbers,autorange:o({},n.autorange,{editType:"plot"}),rangemode:{valType:"enumerated",values:["tozero","nonnegative","normal"],dflt:"tozero",editType:"calc"},range:o({},n.range,{items:[{valType:"any",editType:"plot",impliedEdits:{"^autorange":false}},{valType:"any",editType:"plot",impliedEdits:{"^autorange":false}}],editType:"plot"}),categoryorder:n.categoryorder,categoryarray:n.categoryarray,angle:{valType:"angle",editType:"plot"},side:{valType:"enumerated",values:["clockwise","counterclockwise"],dflt:"clockwise",editType:"plot"},title:{text:o({},n.title.text,{editType:"plot",dflt:""}),font:o({},n.title.font,{editType:"plot"}),editType:"plot"},hoverformat:n.hoverformat,uirevision:{valType:"any",editType:"none"},editType:"calc",_deprecated:{title:n._deprecated.title,titlefont:n._deprecated.titlefont}};o(c,l,u);var f={visible:o({},n.visible,{dflt:true}),type:{valType:"enumerated",values:["-","linear","category"],dflt:"-",editType:"calc",_noTemplating:true},autotypenumbers:n.autotypenumbers,categoryorder:n.categoryorder,categoryarray:n.categoryarray,thetaunit:{valType:"enumerated",values:["radians","degrees"],dflt:"degrees",editType:"calc"},period:{valType:"number",editType:"calc",min:0},direction:{valType:"enumerated",values:["counterclockwise","clockwise"],dflt:"counterclockwise",editType:"calc"},rotation:{valType:"angle",editType:"calc"},hoverformat:n.hoverformat,uirevision:{valType:"any",editType:"none"},editType:"calc"};o(f,l,u);t.exports={domain:i({name:"polar",editType:"plot"}),sector:{valType:"info_array",items:[{valType:"number",editType:"plot"},{valType:"number",editType:"plot"}],dflt:[0,360],editType:"plot"},hole:{valType:"number",min:0,max:1,dflt:0,editType:"plot"},bgcolor:{valType:"color",editType:"plot",dflt:a.background},radialaxis:c,angularaxis:f,gridshape:{valType:"enumerated",values:["circular","linear"],dflt:"circular",editType:"plot"},uirevision:{valType:"any",editType:"none"},editType:"calc"}},{"../../components/color/attributes":649,"../../lib":787,"../../plot_api/edit_types":820,"../cartesian/layout_attributes":853,"../domain":866}],906:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("../../components/color");var i=e("../../plot_api/plot_template");var o=e("../subplot_defaults");var s=e("../get_data").getSubplotData;var l=e("../cartesian/tick_value_defaults");var u=e("../cartesian/tick_mark_defaults");var c=e("../cartesian/tick_label_defaults");var f=e("../cartesian/category_order_defaults");var h=e("../cartesian/line_grid_defaults");var p=e("../cartesian/axis_autotype");var v=e("./layout_attributes");var d=e("./set_convert");var m=e("./constants");var g=m.axisNames;function y(e,t,r,o){var p=r("bgcolor");o.bgColor=n.combine(p,o.paper_bgcolor);var y=r("sector");r("hole");var b=s(o.fullData,m.name,o.id);var _=o.layoutOut;var w;function T(e,t){return r(w+"."+e,t)}for(var k=0;k<g.length;k++){w=g[k];if(!a.isPlainObject(e[w])){e[w]={}}var M=e[w];var A=i.newContainer(t,w);A._id=A._name=w;A._attr=o.id+"."+w;A._traceIndices=b.map((function(e){return e._expandedIndex}));var S=m.axisName2dataArray[w];var E=x(M,A,T,b,S,o);f(M,A,T,{axData:b,dataAttr:S});var L=T("visible");d(A,t,_);T("uirevision",t.uirevision);var C;var I;if(L){C=T("color");I=C===M.color?C:o.font.color}A._m=1;switch(w){case"radialaxis":var P=T("autorange",!A.isValidRange(M.range));M.autorange=P;if(P&&(E==="linear"||E==="-"))T("rangemode");if(P==="reversed")A._m=-1;T("range");A.cleanRange("range",{dfltRange:[0,1]});if(L){T("side");T("angle",y[0]);T("title.text");a.coerceFont(T,"title.font",{family:o.font.family,size:a.bigFont(o.font.size),color:I})}break;case"angularaxis":if(E==="date"){a.log("Polar plots do not support date angular axes yet.");for(var O=0;O<b.length;O++){b[O].visible=false}E=M.type=A.type="linear"}if(E==="linear"){T("thetaunit")}else{T("period")}var z=T("direction");T("rotation",{counterclockwise:0,clockwise:90}[z]);break}if(L){l(M,A,T,A.type);c(M,A,T,A.type,{tickSuffixDflt:A.thetaunit==="degrees"?"°":undefined});u(M,A,T,{outerTicks:true});var D=T("showticklabels");if(D){a.coerceFont(T,"tickfont",{family:o.font.family,size:o.font.size,color:I});T("tickangle");T("tickformat")}h(M,A,T,{dfltColor:C,bgColor:o.bgColor,blend:60,showLine:true,showGrid:true,noZeroLine:true,attributes:v[w]});T("layer")}if(E!=="category")T("hoverformat");A._input=M}if(t.angularaxis.type==="category"){r("gridshape")}}function x(e,t,r,a,n,i){var o=r("autotypenumbers",i.autotypenumbersDflt);var s=r("type");if(s==="-"){var l;for(var u=0;u<a.length;u++){if(a[u].visible){l=a[u];break}}if(l&&l[n]){t.type=p(l[n],"gregorian",{noMultiCategory:true,autotypenumbers:o})}if(t.type==="-"){t.type="linear"}else{e.type=t.type}}return t.type}t.exports=function e(t,r,a){o(t,r,a,{type:m.name,attributes:v,handleDefaults:y,font:r.font,autotypenumbersDflt:r.autotypenumbers,paper_bgcolor:r.paper_bgcolor,fullData:a,layoutOut:r})}},{"../../components/color":650,"../../lib":787,"../../plot_api/plot_template":827,"../cartesian/axis_autotype":839,"../cartesian/category_order_defaults":843,"../cartesian/line_grid_defaults":855,"../cartesian/tick_label_defaults":860,"../cartesian/tick_mark_defaults":861,"../cartesian/tick_value_defaults":862,"../get_data":875,"../subplot_defaults":909,"./constants":902,"./layout_attributes":905,"./set_convert":908}],907:[function(e,t,r){"use strict";var a=e("@plotly/d3");var n=e("tinycolor2");var i=e("../../registry");var o=e("../../lib");var s=o.strRotate;var l=o.strTranslate;var u=e("../../components/color");var c=e("../../components/drawing");var f=e("../plots");var h=e("../../plots/cartesian/axes");var p=e("../cartesian/set_convert");var v=e("./set_convert");var d=e("../cartesian/autorange").doAutoRange;var m=e("../cartesian/dragbox");var g=e("../../components/dragelement");var y=e("../../components/fx");var x=e("../../components/titles");var b=e("../cartesian/select").prepSelect;var _=e("../cartesian/select").selectOnClick;var w=e("../cartesian/select").clearSelect;var T=e("../../lib/setcursor");var k=e("../../lib/clear_gl_canvases");var M=e("../../plot_api/subroutines").redrawReglTraces;var A=e("../../constants/alignment").MID_SHIFT;var S=e("./constants");var E=e("./helpers");var L=o._;var C=o.mod;var I=o.deg2rad;var P=o.rad2deg;function O(e,t){this.id=t;this.gd=e;this._hasClipOnAxisFalse=null;this.vangles=null;this.radialAxisAngle=null;this.traceHash={};this.layers={};this.clipPaths={};this.clipIds={};this.viewInitial={};var r=e._fullLayout;var a="clip"+r._uid+t;this.clipIds.forTraces=a+"-for-traces";this.clipPaths.forTraces=r._clips.append("clipPath").attr("id",this.clipIds.forTraces);this.clipPaths.forTraces.append("path");this.framework=r._polarlayer.append("g").attr("class",t);this.radialTickLayout=null;this.angularTickLayout=null}var z=O.prototype;t.exports=function e(t,r){return new O(t,r)};z.plot=function(e,t){var r=this;var a=t[r.id];r._hasClipOnAxisFalse=false;for(var n=0;n<e.length;n++){var i=e[n][0].trace;if(i.cliponaxis===false){r._hasClipOnAxisFalse=true;break}}r.updateLayers(t,a);r.updateLayout(t,a);f.generalUpdatePerTraceModule(r.gd,r,e,a);r.updateFx(t,a)};z.updateLayers=function(e,t){var r=this;var n=r.layers;var i=t.radialaxis;var o=t.angularaxis;var s=S.layerNames;var l=s.indexOf("frontplot");var u=s.slice(0,l);var c=o.layer==="below traces";var f=i.layer==="below traces";if(c)u.push("angular-line");if(f)u.push("radial-line");if(c)u.push("angular-axis");if(f)u.push("radial-axis");u.push("frontplot");if(!c)u.push("angular-line");if(!f)u.push("radial-line");if(!c)u.push("angular-axis");if(!f)u.push("radial-axis");var h=r.framework.selectAll(".polarsublayer").data(u,String);h.enter().append("g").attr("class",(function(e){return"polarsublayer "+e})).each((function(e){var t=n[e]=a.select(this);switch(e){case"frontplot":t.append("g").classed("barlayer",true);t.append("g").classed("scatterlayer",true);break;case"backplot":t.append("g").classed("maplayer",true);break;case"plotbg":n.bg=t.append("path");break;case"radial-grid":t.style("fill","none");break;case"angular-grid":t.style("fill","none");break;case"radial-line":t.append("line").style("fill","none");break;case"angular-line":t.append("path").style("fill","none");break}}));h.order()};z.updateLayout=function(e,t){var r=this;var a=r.layers;var n=e._size;var i=t.radialaxis;var o=t.angularaxis;var s=t.domain.x;var f=t.domain.y;r.xOffset=n.l+n.w*s[0];r.yOffset=n.t+n.h*(1-f[1]);var h=r.xLength=n.w*(s[1]-s[0]);var p=r.yLength=n.h*(f[1]-f[0]);var v=t.sector;r.sectorInRad=v.map(I);var d=r.sectorBBox=R(v);var m=d[2]-d[0];var g=d[3]-d[1];var y=p/h;var x=Math.abs(g/m);var b,_;var w,T;var k;if(y>x){b=h;_=h*x;k=(p-_)/n.h/2;w=[s[0],s[1]];T=[f[0]+k,f[1]-k]}else{b=p/x;_=p;k=(h-b)/n.w/2;w=[s[0]+k,s[1]-k];T=[f[0],f[1]]}r.xLength2=b;r.yLength2=_;r.xDomain2=w;r.yDomain2=T;var M=r.xOffset2=n.l+n.w*w[0];var A=r.yOffset2=n.t+n.h*(1-T[1]);var S=r.radius=b/m;var E=r.innerRadius=t.hole*S;var L=r.cx=M-S*d[0];var C=r.cy=A+S*d[3];var P=r.cxx=L-M;var O=r.cyy=C-A;r.radialAxis=r.mockAxis(e,t,i,{_id:"x",side:{counterclockwise:"top",clockwise:"bottom"}[i.side],_realSide:i.side,domain:[E/n.w,S/n.w]});r.angularAxis=r.mockAxis(e,t,o,{side:"right",domain:[0,Math.PI],autorange:false});r.doAutoRange(e,t);r.updateAngularAxis(e,t);r.updateRadialAxis(e,t);r.updateRadialAxisTitle(e,t);r.xaxis=r.mockCartesianAxis(e,t,{_id:"x",domain:w});r.yaxis=r.mockCartesianAxis(e,t,{_id:"y",domain:T});var z=r.pathSubplot();r.clipPaths.forTraces.select("path").attr("d",z).attr("transform",l(P,O));a.frontplot.attr("transform",l(M,A)).call(c.setClipUrl,r._hasClipOnAxisFalse?null:r.clipIds.forTraces,r.gd);a.bg.attr("d",z).attr("transform",l(L,C)).call(u.fill,t.bgcolor)};z.mockAxis=function(e,t,r,a){var n=o.extendFlat({},r,a);v(n,t,e);return n};z.mockCartesianAxis=function(e,t,r){var a=this;var n=r._id;var i=o.extendFlat({type:"linear"},r);p(i,e);var s={x:[0,2],y:[1,3]};i.setRange=function(){var e=a.sectorBBox;var r=s[n];var o=a.radialAxis._rl;var l=(o[1]-o[0])/(1-t.hole);i.range=[e[r[0]]*l,e[r[1]]*l]};i.isPtWithinRange=n==="x"?function(e){return a.isPtInside(e)}:function(){return true};i.setRange();i.setScale();return i};z.doAutoRange=function(e,t){var r=this.gd;var a=this.radialAxis;var n=t.radialaxis;a.setScale();d(r,a);var i=a.range;n.range=i.slice();n._input.range=i.slice();a._rl=[a.r2l(i[0],null,"gregorian"),a.r2l(i[1],null,"gregorian")]};z.updateRadialAxis=function(e,t){var r=this;var a=r.gd;var n=r.layers;var i=r.radius;var c=r.innerRadius;var f=r.cx;var p=r.cy;var v=t.radialaxis;var d=C(t.sector[0],360);var m=r.radialAxis;var g=c<i;r.fillViewInitialKey("radialaxis.angle",v.angle);r.fillViewInitialKey("radialaxis.range",m.range.slice());m.setGeometry();if(m.tickangle==="auto"&&(d>90&&d<=270)){m.tickangle=180}var y=function(e){return l(m.l2p(e.x)+c,0)};var x=function(e){return r.pathArc(m.r2p(e.x)+c)};var b=D(v);if(r.radialTickLayout!==b){n["radial-axis"].selectAll(".xtick").remove();r.radialTickLayout=b}if(g){m.setScale();var _=h.calcTicks(m);var w=h.clipEnds(m,_);var T=h.getTickSigns(m)[2];h.drawTicks(a,m,{vals:_,layer:n["radial-axis"],path:h.makeTickPath(m,0,T),transFn:y,crisp:false});h.drawGrid(a,m,{vals:w,layer:n["radial-grid"],path:x,transFn:o.noop,crisp:false});h.drawLabels(a,m,{vals:_,layer:n["radial-axis"],transFn:y,labelFns:h.makeLabelFns(m,0)})}var k=r.radialAxisAngle=r.vangles?P(F(I(v.angle),r.vangles)):v.angle;var M=l(f,p);var A=M+s(-k);B(n["radial-axis"],g&&(v.showticklabels||v.ticks),{transform:A});B(n["radial-grid"],g&&v.showgrid,{transform:M});B(n["radial-line"].select("line"),g&&v.showline,{x1:c,y1:0,x2:i,y2:0,transform:A}).attr("stroke-width",v.linewidth).call(u.stroke,v.linecolor)};z.updateRadialAxisTitle=function(e,t,r){var a=this;var n=a.gd;var i=a.radius;var o=a.cx;var s=a.cy;var l=t.radialaxis;var u=a.id+"title";var f=r!==undefined?r:a.radialAxisAngle;var h=I(f);var p=Math.cos(h);var v=Math.sin(h);var d=0;if(l.title){var m=c.bBox(a.layers["radial-axis"].node()).height;var g=l.title.font.size;d=l.side==="counterclockwise"?-m-g*.4:m+g*.8}a.layers["radial-axis-title"]=x.draw(n,u,{propContainer:l,propName:a.id+".radialaxis.title",placeholder:L(n,"Click to enter radial axis title"),attributes:{x:o+i/2*p+d*v,y:s-i/2*v+d*p,"text-anchor":"middle"},transform:{rotate:-f}})};z.updateAngularAxis=function(e,t){var r=this;var a=r.gd;var n=r.layers;var i=r.radius;var c=r.innerRadius;var f=r.cx;var p=r.cy;var v=t.angularaxis;var d=r.angularAxis;r.fillViewInitialKey("angularaxis.rotation",v.rotation);d.setGeometry();d.setScale();var m=function(e){return d.t2g(e.x)};if(d.type==="linear"&&d.thetaunit==="radians"){d.tick0=P(d.tick0);d.dtick=P(d.dtick)}var g=function(e){return l(f+i*Math.cos(e),p-i*Math.sin(e))};var y=function(e){return g(m(e))};var x=function(e){var t=m(e);return g(t)+s(-P(t))};var b=function(e){var t=m(e);var r=Math.cos(t);var a=Math.sin(t);return"M"+[f+c*r,p-c*a]+"L"+[f+i*r,p-i*a]};var _=h.makeLabelFns(d,0);var w=_.labelStandoff;var T={};T.xFn=function(e){var t=m(e);return Math.cos(t)*w};T.yFn=function(e){var t=m(e);var r=Math.sin(t)>0?.2:1;return-Math.sin(t)*(w+e.fontSize*r)+Math.abs(Math.cos(t))*(e.fontSize*A)};T.anchorFn=function(e){var t=m(e);var r=Math.cos(t);return Math.abs(r)<.1?"middle":r>0?"start":"end"};T.heightFn=function(e,t,r){var a=m(e);return-.5*(1+Math.sin(a))*r};var k=D(v);if(r.angularTickLayout!==k){n["angular-axis"].selectAll("."+d._id+"tick").remove();r.angularTickLayout=k}var M=h.calcTicks(d);var S;if(t.gridshape==="linear"){S=M.map(m);if(o.angleDelta(S[0],S[1])<0){S=S.slice().reverse()}}else{S=null}r.vangles=S;if(d.type==="category"){M=M.filter((function(e){return o.isAngleInsideSector(m(e),r.sectorInRad)}))}if(d.visible){var E=d.ticks==="inside"?-1:1;var L=(d.linewidth||1)/2;h.drawTicks(a,d,{vals:M,layer:n["angular-axis"],path:"M"+E*L+",0h"+E*d.ticklen,transFn:x,crisp:false});h.drawGrid(a,d,{vals:M,layer:n["angular-grid"],path:b,transFn:o.noop,crisp:false});h.drawLabels(a,d,{vals:M,layer:n["angular-axis"],repositionOnUpdate:true,transFn:y,labelFns:T})}B(n["angular-line"].select("path"),v.showline,{d:r.pathSubplot(),transform:l(f,p)}).attr("stroke-width",v.linewidth).call(u.stroke,v.linecolor)};z.updateFx=function(e,t){if(!this.gd._context.staticPlot){this.updateAngularDrag(e);this.updateRadialDrag(e,t,0);this.updateRadialDrag(e,t,1);this.updateMainDrag(e)}};z.updateMainDrag=function(e){var t=this;var r=t.gd;var s=t.layers;var u=e._zoomlayer;var c=S.MINZOOM;var f=S.OFFEDGE;var h=t.radius;var p=t.innerRadius;var v=t.cx;var d=t.cy;var x=t.cxx;var T=t.cyy;var k=t.sectorInRad;var M=t.vangles;var A=t.radialAxis;var L=E.clampTiny;var C=E.findXYatLength;var I=E.findEnclosingVertexAngles;var P=S.cornerHalfWidth;var O=S.cornerLen/2;var z;var D;var R=m.makeDragger(s,"path","maindrag","crosshair");a.select(R).attr("d",t.pathSubplot()).attr("transform",l(v,d));var F={element:R,gd:r,subplot:t.id,plotinfo:{id:t.id,xaxis:t.xaxis,yaxis:t.yaxis},xaxes:[t.xaxis],yaxes:[t.yaxis]};var B,N;var j,U;var V,H,q;var G,Y;function W(e,t){return Math.sqrt(e*e+t*t)}function X(e,t){return W(e-x,t-T)}function Z(e,t){return Math.atan2(T-t,e-x)}function J(e,t){return[e*Math.cos(t),e*Math.sin(-t)]}function K(e,r){if(e===0)return t.pathSector(2*P);var a=O/e;var n=r-a;var i=r+a;var o=Math.max(0,Math.min(e,h));var s=o-P;var l=o+P;return"M"+J(s,n)+"A"+[s,s]+" 0,0,0 "+J(s,i)+"L"+J(l,i)+"A"+[l,l]+" 0,0,1 "+J(l,n)+"Z"}function Q(e,r,a){if(e===0)return t.pathSector(2*P);var n=J(e,r);var i=J(e,a);var o=L((n[0]+i[0])/2);var s=L((n[1]+i[1])/2);var l,u;if(o&&s){var c=s/o;var f=-1/c;var h=C(P,c,o,s);l=C(O,f,h[0][0],h[0][1]);u=C(O,f,h[1][0],h[1][1])}else{var p,v;if(s){p=O;v=P}else{p=P;v=O}l=[[o-p,s-v],[o+p,s-v]];u=[[o-p,s+v],[o+p,s+v]]}return"M"+l.join("L")+"L"+u.reverse().join("L")+"Z"}function $(){j=null;U=null;V=t.pathSubplot();H=false;var e=r._fullLayout[t.id];q=n(e.bgcolor).getLuminance();G=m.makeZoombox(u,q,v,d,V);G.attr("fill-rule","evenodd");Y=m.makeCorners(u,v,d);w(r)}function ee(e,t){t=Math.max(Math.min(t,h),p);if(e<f)e=0;else if(h-e<f)e=h;else if(t<f)t=0;else if(h-t<f)t=h;if(Math.abs(t-e)>c){if(e<t){j=e;U=t}else{j=t;U=e}return true}else{j=null;U=null;return false}}function te(e,t){e=e||V;t=t||"M0,0Z";G.attr("d",e);Y.attr("d",t);m.transitionZoombox(G,Y,H,q);H=true;var a={};oe(a);r.emit("plotly_relayouting",a)}function re(e,r){e=e*z;r=r*D;var a=B+e;var n=N+r;var i=X(B,N);var o=Math.min(X(a,n),h);var s=Z(B,N);var l;var u;if(ee(i,o)){l=V+t.pathSector(U);if(j)l+=t.pathSector(j);u=K(j,s)+K(U,s)}te(l,u)}function ae(e,t,r,a){var n=E.findIntersectionXY(r,a,r,[e-x,T-t]);return W(n[0],n[1])}function ne(e,r){var a=B+e;var n=N+r;var i=Z(B,N);var o=Z(a,n);var s=I(i,M);var l=I(o,M);var u=ae(B,N,s[0],s[1]);var c=Math.min(ae(a,n,l[0],l[1]),h);var f;var p;if(ee(u,c)){f=V+t.pathSector(U);if(j)f+=t.pathSector(j);p=[Q(j,s[0],s[1]),Q(U,s[0],s[1])].join(" ")}te(f,p)}function ie(){m.removeZoombox(r);if(j===null||U===null)return;var e={};oe(e);m.showDoubleClickNotifier(r);i.call("_guiRelayout",r,e)}function oe(e){var r=A._rl;var a=(r[1]-r[0])/(1-p/h)/h;var n=[r[0]+(j-p)*a,r[0]+(U-p)*a];e[t.id+".radialaxis.range"]=n}function se(e,a){var n=r._fullLayout.clickmode;m.removeZoombox(r);if(e===2){var o={};for(var s in t.viewInitial){o[t.id+"."+s]=t.viewInitial[s]}r.emit("plotly_doubleclick",null);i.call("_guiRelayout",r,o)}if(n.indexOf("select")>-1&&e===1){_(a,r,[t.xaxis],[t.yaxis],t.id,F)}if(n.indexOf("event")>-1){y.click(r,a,t.id)}}F.prepFn=function(e,t,a){var n=r._fullLayout.dragmode;var i=R.getBoundingClientRect();r._fullLayout._calcInverseTransform(r);var s=r._fullLayout._invTransform;z=r._fullLayout._invScaleX;D=r._fullLayout._invScaleY;var l=o.apply3DTransform(s)(t-i.left,a-i.top);B=l[0];N=l[1];if(M){var u=E.findPolygonOffset(h,k[0],k[1],M);B+=x+u[0];N+=T+u[1]}switch(n){case"zoom":if(M){F.moveFn=ne}else{F.moveFn=re}F.clickFn=se;F.doneFn=ie;$(e,t,a);break;case"select":case"lasso":b(e,t,a,F,n);break}};R.onmousemove=function(e){y.hover(r,e,t.id);r._fullLayout._lasthover=R;r._fullLayout._hoversubplot=t.id};R.onmouseout=function(e){if(r._dragging)return;g.unhover(r,e)};g.init(F)};z.updateRadialDrag=function(e,t,r){var n=this;var u=n.gd;var c=n.layers;var f=n.radius;var h=n.innerRadius;var p=n.cx;var v=n.cy;var d=n.radialAxis;var y=S.radialDragBoxSize;var x=y/2;if(!d.visible)return;var b=I(n.radialAxisAngle);var _=d._rl;var T=_[0];var A=_[1];var E=_[r];var L=.75*(_[1]-_[0])/(1-t.hole)/f;var C,O,z;if(r){C=p+(f+x)*Math.cos(b);O=v-(f+x)*Math.sin(b);z="radialdrag"}else{C=p+(h-x)*Math.cos(b);O=v-(h-x)*Math.sin(b);z="radialdrag-inner"}var D=m.makeRectDragger(c,z,"crosshair",-x,-x,y,y);var R={element:D,gd:u};B(a.select(D),d.visible&&h<f,{transform:l(C,O)});var N;var j;var U;function V(e,t){if(N){N(e,t)}else{var r=[e,-t];var a=[Math.cos(b),Math.sin(b)];var n=Math.abs(o.dot(r,a)/Math.sqrt(o.dot(r,r)));if(!isNaN(n)){N=n<.5?G:Y}}var i={};H(i);u.emit("plotly_relayouting",i)}function H(e){if(j!==null){e[n.id+".radialaxis.angle"]=j}else if(U!==null){e[n.id+".radialaxis.range["+r+"]"]=U}}function q(){if(j!==null){i.call("_guiRelayout",u,n.id+".radialaxis.angle",j)}else if(U!==null){i.call("_guiRelayout",u,n.id+".radialaxis.range["+r+"]",U)}}function G(e,t){if(r===0)return;var a=C+e;var i=O+t;j=Math.atan2(v-i,a-p);if(n.vangles)j=F(j,n.vangles);j=P(j);var o=l(p,v)+s(-j);c["radial-axis"].attr("transform",o);c["radial-line"].select("line").attr("transform",o);var u=n.gd._fullLayout;var f=u[n.id];n.updateRadialAxisTitle(u,f,j)}function Y(e,t){var a=o.dot([e,-t],[Math.cos(b),Math.sin(b)]);U=E-L*a;if(L>0!==(r?U>T:U<A)){U=null;return}var s=u._fullLayout;var l=s[n.id];d.range[r]=U;d._rl[r]=U;n.updateRadialAxis(s,l);n.xaxis.setRange();n.xaxis.setScale();n.yaxis.setRange();n.yaxis.setScale();var c=false;for(var f in n.traceHash){var h=n.traceHash[f];var p=o.filterVisible(h);var v=h[0][0].trace._module;v.plot(u,n,p,l);if(i.traceIs(f,"gl")&&p.length)c=true}if(c){k(u);M(u)}}R.prepFn=function(){N=null;j=null;U=null;R.moveFn=V;R.doneFn=q;w(u)};R.clampFn=function(e,t){if(Math.sqrt(e*e+t*t)<S.MINDRAG){e=0;t=0}return[e,t]};g.init(R)};z.updateAngularDrag=function(e){var t=this;var r=t.gd;var n=t.layers;var u=t.radius;var f=t.angularAxis;var h=t.cx;var p=t.cy;var v=t.cxx;var d=t.cyy;var y=S.angularDragBoxSize;var x=m.makeDragger(n,"path","angulardrag","move");var b={element:x,gd:r};a.select(x).attr("d",t.pathAnnulus(u,u+y)).attr("transform",l(h,p)).call(T,"move");function _(e,t){return Math.atan2(d+y-t,e-v-y)}var A=n.frontplot.select(".scatterlayer").selectAll(".trace");var E=A.selectAll(".point");var L=A.selectAll(".textpoint");var C,I;var O,z;var D;var R;function F(u,m){var g=t.gd._fullLayout;var y=g[t.id];var x=C+u*e._invScaleX;var b=I+m*e._invScaleY;var w=_(x,b);var T=P(w-R);z=O+T;n.frontplot.attr("transform",l(t.xOffset2,t.yOffset2)+s([-T,v,d]));if(t.vangles){D=t.radialAxisAngle+T;var S=l(h,p)+s(-T);var F=l(h,p)+s(-D);n.bg.attr("transform",S);n["radial-grid"].attr("transform",S);n["radial-axis"].attr("transform",F);n["radial-line"].select("line").attr("transform",F);t.updateRadialAxisTitle(g,y,D)}else{t.clipPaths.forTraces.select("path").attr("transform",l(v,d)+s(T))}E.each((function(){var e=a.select(this);var t=c.getTranslate(e);e.attr("transform",l(t.x,t.y)+s([T]))}));L.each((function(){var e=a.select(this);var t=e.select("text");var r=c.getTranslate(e);e.attr("transform",s([T,t.attr("x"),t.attr("y")])+l(r.x,r.y))}));f.rotation=o.modHalf(z,360);t.updateAngularAxis(g,y);if(t._hasClipOnAxisFalse&&!o.isFullCircle(t.sectorInRad)){A.call(c.hideOutsideRangePoints,t)}var N=false;for(var j in t.traceHash){if(i.traceIs(j,"gl")){var U=t.traceHash[j];var V=o.filterVisible(U);var H=U[0][0].trace._module;H.plot(r,t,V,y);if(V.length)N=true}}if(N){k(r);M(r)}var q={};B(q);r.emit("plotly_relayouting",q)}function B(e){e[t.id+".angularaxis.rotation"]=z;if(t.vangles){e[t.id+".radialaxis.angle"]=D}}function N(){L.select("text").attr("transform",null);var e={};B(e);i.call("_guiRelayout",r,e)}b.prepFn=function(a,n,i){var s=e[t.id];O=s.angularaxis.rotation;var l=x.getBoundingClientRect();C=n-l.left;I=i-l.top;r._fullLayout._calcInverseTransform(r);var u=o.apply3DTransform(e._invTransform)(C,I);C=u[0];I=u[1];R=_(C,I);b.moveFn=F;b.doneFn=N;w(r)};if(t.vangles&&!o.isFullCircle(t.sectorInRad)){b.prepFn=o.noop;T(a.select(x),null)}g.init(b)};z.isPtInside=function(e){var t=this.sectorInRad;var r=this.vangles;var a=this.angularAxis.c2g(e.theta);var n=this.radialAxis;var i=n.c2l(e.r);var s=n._rl;var l=r?E.isPtInsidePolygon:o.isPtInsideSector;return l(i,a,s,t,r)};z.pathArc=function(e){var t=this.sectorInRad;var r=this.vangles;var a=r?E.pathPolygon:o.pathArc;return a(e,t[0],t[1],r)};z.pathSector=function(e){var t=this.sectorInRad;var r=this.vangles;var a=r?E.pathPolygon:o.pathSector;return a(e,t[0],t[1],r)};z.pathAnnulus=function(e,t){var r=this.sectorInRad;var a=this.vangles;var n=a?E.pathPolygonAnnulus:o.pathAnnulus;return n(e,t,r[0],r[1],a)};z.pathSubplot=function(){var e=this.innerRadius;var t=this.radius;return e?this.pathAnnulus(e,t):this.pathSector(t)};z.fillViewInitialKey=function(e,t){if(!(e in this.viewInitial)){this.viewInitial[e]=t}};function D(e){var t=e.ticks+String(e.ticklen)+String(e.showticklabels);if("side"in e)t+=e.side;return t}function R(e){var t=e[0];var r=e[1];var a=r-t;var n=C(t,360);var i=n+a;var o=Math.cos(I(n));var s=Math.sin(I(n));var l=Math.cos(I(i));var u=Math.sin(I(i));var c,f,h,p;if(n<=90&&i>=90||n>90&&i>=450){p=1}else if(s<=0&&u<=0){p=0}else{p=Math.max(s,u)}if(n<=180&&i>=180||n>180&&i>=540){c=-1}else if(o>=0&&l>=0){c=0}else{c=Math.min(o,l)}if(n<=270&&i>=270||n>270&&i>=630){f=-1}else if(s>=0&&u>=0){f=0}else{f=Math.min(s,u)}if(i>=360){h=1}else if(o<=0&&l<=0){h=0}else{h=Math.max(o,l)}return[c,f,h,p]}function F(e,t){var r=function(t){return o.angleDist(e,t)};var a=o.findIndexOfMin(t,r);return t[a]}function B(e,t,r){if(t){e.attr("display",null);e.attr(r)}else if(e){e.attr("display","none")}return e}},{"../../components/color":650,"../../components/dragelement":669,"../../components/drawing":672,"../../components/fx":690,"../../components/titles":748,"../../constants/alignment":755,"../../lib":787,"../../lib/clear_gl_canvases":771,"../../lib/setcursor":808,"../../plot_api/subroutines":828,"../../plots/cartesian/axes":838,"../../registry":915,"../cartesian/autorange":837,"../cartesian/dragbox":847,"../cartesian/select":858,"../cartesian/set_convert":859,"../plots":901,"./constants":902,"./helpers":903,"./set_convert":908,"@plotly/d3":58,tinycolor2:583}],908:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("../cartesian/set_convert");var i=a.deg2rad;var o=a.rad2deg;t.exports=function e(t,r,a){n(t,a);switch(t._id){case"x":case"radialaxis":s(t,r);break;case"angularaxis":c(t,r);break}};function s(e,t){var r=t._subplot;e.setGeometry=function(){var t=e._rl[0];var a=e._rl[1];var n=r.innerRadius;var i=(r.radius-n)/(a-t);var o=n/i;var s=t>a?function(e){return e<=0}:function(e){return e>=0};e.c2g=function(r){var a=e.c2l(r)-t;return(s(a)?a:0)+o};e.g2c=function(r){return e.l2c(r+t-o)};e.g2p=function(e){return e*i};e.c2p=function(t){return e.g2p(e.c2g(t))}}}function l(e,t){return t==="degrees"?i(e):e}function u(e,t){return t==="degrees"?o(e):e}function c(e,t){var r=e.type;if(r==="linear"){var n=e.d2c;var s=e.c2d;e.d2c=function(e,t){return l(n(e),t)};e.c2d=function(e,t){return s(u(e,t))}}e.makeCalcdata=function(t,n){var i=t[n];var o=t._length;var s,l;var u=function(r){return e.d2c(r,t.thetaunit)};if(i){if(a.isTypedArray(i)&&r==="linear"){if(o===i.length){return i}else if(i.subarray){return i.subarray(0,o)}}s=new Array(o);for(l=0;l<o;l++){s[l]=u(i[l])}}else{var c=n+"0";var f="d"+n;var h=c in t?u(t[c]):0;var p=t[f]?u(t[f]):(e.period||2*Math.PI)/o;s=new Array(o);for(l=0;l<o;l++){s[l]=h+l*p}}return s};e.setGeometry=function(){var n=t.sector;var s=n.map(i);var l={clockwise:-1,counterclockwise:1}[e.direction];var u=i(e.rotation);var c=function(e){return l*e+u};var f=function(e){return(e-u)/l};var h,p;var v,d;switch(r){case"linear":p=h=a.identity;d=i;v=o;e.range=a.isFullCircle(s)?[n[0],n[0]+360]:s.map(f).map(o);break;case"category":var m=e._categories.length;var g=e.period?Math.max(e.period,m):m;if(g===0)g=1;p=d=function(e){return e*2*Math.PI/g};h=v=function(e){return e*g/Math.PI/2};e.range=[0,g];break}e.c2g=function(e){return c(p(e))};e.g2c=function(e){return h(f(e))};e.t2g=function(e){return c(d(e))};e.g2t=function(e){return v(f(e))}}}},{"../../lib":787,"../cartesian/set_convert":859}],909:[function(e,t,r){"use strict";var a=e("../lib");var n=e("../plot_api/plot_template");var i=e("./domain").defaults;t.exports=function e(t,r,o,s){var l=s.type;var u=s.attributes;var c=s.handleDefaults;var f=s.partition||"x";var h=r._subplots[l];var p=h.length;var v=p&&h[0].replace(/\d+$/,"");var d,m;function g(e,t){return a.coerce(d,m,u,e,t)}for(var y=0;y<p;y++){var x=h[y];if(t[x])d=t[x];else d=t[x]={};m=n.newContainer(r,x,v);g("uirevision",r.uirevision);var b={};b[f]=[y/p,(y+1)/p];i(m,r,g,b);s.id=x;c(d,m,g,s)}}},{"../lib":787,"../plot_api/plot_template":827,"./domain":866}],910:[function(e,t,r){"use strict";var a=e("../constants/docs");var n=a.FORMAT_LINK;var i=a.DATE_FORMAT_LINK;function o(e){var t=e&&e.supportOther;return["Variables are inserted using %{variable},",'for example "y: %{y}"'+(t?" as well as %{xother}, {%_xother}, {%_xother_}, {%xother_}. When showing info for several points, *xother* will be added to those with different x positions from the first point. An underscore before or after *(x|y)other* will add a space on that side, only when this field is shown.":"."),'Numbers are formatted using d3-format\'s syntax %{variable:d3-format}, for example "Price: %{y:$.2f}".',n,"for details on the formatting syntax.",'Dates are formatted using d3-time-format\'s syntax %{variable|d3-time-format}, for example "Day: %{2019-01-01|%A}".',i,"for details on the date formatting syntax."].join(" ")}function s(e){var t=e.description?" "+e.description:"";var r=e.keys||[];if(r.length>0){var a=[];for(var n=0;n<r.length;n++){a[n]="`"+r[n]+"`"}t=t+"Finally, the template string has access to ";if(r.length===1){t="variable "+a[0]}else{t="variables "+a.slice(0,-1).join(", ")+" and "+a.slice(-1)+"."}}return t}r.hovertemplateAttrs=function(e,t){e=e||{};t=t||{};var r=s(t);var a={valType:"string",dflt:"",editType:e.editType||"none"};if(e.arrayOk!==false){a.arrayOk=true}return a};r.texttemplateAttrs=function(e,t){e=e||{};t=t||{};var r=s(t);var a={valType:"string",dflt:"",editType:e.editType||"calc"};if(e.arrayOk!==false){a.arrayOk=true}return a}},{"../constants/docs":758}],911:[function(e,t,r){"use strict";var a=e("./ternary");var n=e("../../plots/get_data").getSubplotCalcData;var i=e("../../lib").counterRegex;var o="ternary";r.name=o;var s=r.attr="subplot";r.idRoot=o;r.idRegex=r.attrRegex=i(o);var l=r.attributes={};l[s]={valType:"subplotid",dflt:"ternary",editType:"calc"};r.layoutAttributes=e("./layout_attributes");r.supplyLayoutDefaults=e("./layout_defaults");r.plot=function e(t){var r=t._fullLayout;var i=t.calcdata;var s=r._subplots[o];for(var l=0;l<s.length;l++){var u=s[l];var c=n(i,o,u);var f=r[u]._subplot;if(!f){f=new a({id:u,graphDiv:t,container:r._ternarylayer.node()},r);r[u]._subplot=f}f.plot(c,r,t._promises)}};r.clean=function(e,t,r,a){var n=a._subplots[o]||[];for(var i=0;i<n.length;i++){var s=n[i];var l=a[s]._subplot;if(!t[s]&&!!l){l.plotContainer.remove();l.clipDef.remove();l.clipDefRelative.remove();l.layers["a-title"].remove();l.layers["b-title"].remove();l.layers["c-title"].remove()}}}},{"../../lib":787,"../../plots/get_data":875,"./layout_attributes":912,"./layout_defaults":913,"./ternary":914}],912:[function(e,t,r){"use strict";var a=e("../../components/color/attributes");var n=e("../domain").attributes;var i=e("../cartesian/layout_attributes");var o=e("../../plot_api/edit_types").overrideAll;var s=e("../../lib/extend").extendFlat;var l={title:{text:i.title.text,font:i.title.font},color:i.color,tickmode:i.tickmode,nticks:s({},i.nticks,{dflt:6,min:1}),tick0:i.tick0,dtick:i.dtick,tickvals:i.tickvals,ticktext:i.ticktext,ticks:i.ticks,ticklen:i.ticklen,tickwidth:i.tickwidth,tickcolor:i.tickcolor,showticklabels:i.showticklabels,showtickprefix:i.showtickprefix,tickprefix:i.tickprefix,showticksuffix:i.showticksuffix,ticksuffix:i.ticksuffix,showexponent:i.showexponent,exponentformat:i.exponentformat,minexponent:i.minexponent,separatethousands:i.separatethousands,tickfont:i.tickfont,tickangle:i.tickangle,tickformat:i.tickformat,tickformatstops:i.tickformatstops,hoverformat:i.hoverformat,showline:s({},i.showline,{dflt:true}),linecolor:i.linecolor,linewidth:i.linewidth,showgrid:s({},i.showgrid,{dflt:true}),gridcolor:i.gridcolor,gridwidth:i.gridwidth,layer:i.layer,min:{valType:"number",dflt:0,min:0},_deprecated:{title:i._deprecated.title,titlefont:i._deprecated.titlefont}};var u=t.exports=o({domain:n({name:"ternary"}),bgcolor:{valType:"color",dflt:a.background},sum:{valType:"number",dflt:1,min:0},aaxis:l,baxis:l,caxis:l},"plot","from-root");u.uirevision={valType:"any",editType:"none"};u.aaxis.uirevision=u.baxis.uirevision=u.caxis.uirevision={valType:"any",editType:"none"}},{"../../components/color/attributes":649,"../../lib/extend":777,"../../plot_api/edit_types":820,"../cartesian/layout_attributes":853,"../domain":866}],913:[function(e,t,r){"use strict";var a=e("../../components/color");var n=e("../../plot_api/plot_template");var i=e("../../lib");var o=e("../subplot_defaults");var s=e("../cartesian/tick_label_defaults");var l=e("../cartesian/tick_mark_defaults");var u=e("../cartesian/tick_value_defaults");var c=e("../cartesian/line_grid_defaults");var f=e("./layout_attributes");var h=["aaxis","baxis","caxis"];t.exports=function e(t,r,a){o(t,r,a,{type:"ternary",attributes:f,handleDefaults:p,font:r.font,paper_bgcolor:r.paper_bgcolor})};function p(e,t,r,i){var o=r("bgcolor");var s=r("sum");i.bgColor=a.combine(o,i.paper_bgcolor);var l,u,c;for(var f=0;f<h.length;f++){l=h[f];u=e[l]||{};c=n.newContainer(t,l);c._name=l;v(u,c,i,t)}var p=t.aaxis;var d=t.baxis;var m=t.caxis;if(p.min+d.min+m.min>=s){p.min=0;d.min=0;m.min=0;if(e.aaxis)delete e.aaxis.min;if(e.baxis)delete e.baxis.min;if(e.caxis)delete e.caxis.min}}function v(e,t,r,a){var n=f[t._name];function o(r,a){return i.coerce(e,t,n,r,a)}o("uirevision",a.uirevision);t.type="linear";var h=o("color");var p=h!==n.color.dflt?h:r.font.color;var v=t._name;var d=v.charAt(0).toUpperCase();var m="Component "+d;var g=o("title.text",m);t._hovertitle=g===m?g:d;i.coerceFont(o,"title.font",{family:r.font.family,size:i.bigFont(r.font.size),color:p});o("min");u(e,t,o,"linear");s(e,t,o,"linear",{});l(e,t,o,{outerTicks:true});var y=o("showticklabels");if(y){i.coerceFont(o,"tickfont",{family:r.font.family,size:r.font.size,color:p});o("tickangle");o("tickformat")}c(e,t,o,{dfltColor:h,bgColor:r.bgColor,blend:60,showLine:true,showGrid:true,noZeroLine:true,attributes:n});o("hoverformat");o("layer")}},{"../../components/color":650,"../../lib":787,"../../plot_api/plot_template":827,"../cartesian/line_grid_defaults":855,"../cartesian/tick_label_defaults":860,"../cartesian/tick_mark_defaults":861,"../cartesian/tick_value_defaults":862,"../subplot_defaults":909,"./layout_attributes":912}],914:[function(e,t,r){"use strict";var a=e("@plotly/d3");var n=e("tinycolor2");var i=e("../../registry");var o=e("../../lib");var s=o.strTranslate;var l=o._;var u=e("../../components/color");var c=e("../../components/drawing");var f=e("../cartesian/set_convert");var h=e("../../lib/extend").extendFlat;var p=e("../plots");var v=e("../cartesian/axes");var d=e("../../components/dragelement");var m=e("../../components/fx");var g=e("../../components/dragelement/helpers");var y=g.freeMode;var x=g.rectMode;var b=e("../../components/titles");var _=e("../cartesian/select").prepSelect;var w=e("../cartesian/select").selectOnClick;var T=e("../cartesian/select").clearSelect;var k=e("../cartesian/select").clearSelectionsCache;var M=e("../cartesian/constants");function A(e,t){this.id=e.id;this.graphDiv=e.graphDiv;this.init(t);this.makeFramework(t);this.aTickLayout=null;this.bTickLayout=null;this.cTickLayout=null}t.exports=A;var S=A.prototype;S.init=function(e){this.container=e._ternarylayer;this.defs=e._defs;this.layoutId=e._uid;this.traceHash={};this.layers={}};S.plot=function(e,t){var r=this;var a=t[r.id];var n=t._size;r._hasClipOnAxisFalse=false;for(var i=0;i<e.length;i++){var o=e[i][0].trace;if(o.cliponaxis===false){r._hasClipOnAxisFalse=true;break}}r.updateLayers(a);r.adjustLayout(a,n);p.generalUpdatePerTraceModule(r.graphDiv,r,e,a);r.layers.plotbg.select("path").call(u.fill,a.bgcolor)};S.makeFramework=function(e){var t=this;var r=t.graphDiv;var a=e[t.id];var n=t.clipId="clip"+t.layoutId+t.id;var i=t.clipIdRelative="clip-relative"+t.layoutId+t.id;t.clipDef=o.ensureSingleById(e._clips,"clipPath",n,(function(e){e.append("path").attr("d","M0,0Z")}));t.clipDefRelative=o.ensureSingleById(e._clips,"clipPath",i,(function(e){e.append("path").attr("d","M0,0Z")}));t.plotContainer=o.ensureSingle(t.container,"g",t.id);t.updateLayers(a);c.setClipUrl(t.layers.backplot,n,r);c.setClipUrl(t.layers.grids,n,r)};S.updateLayers=function(e){var t=this;var r=t.layers;var n=["draglayer","plotbg","backplot","grids"];if(e.aaxis.layer==="below traces"){n.push("aaxis","aline")}if(e.baxis.layer==="below traces"){n.push("baxis","bline")}if(e.caxis.layer==="below traces"){n.push("caxis","cline")}n.push("frontplot");if(e.aaxis.layer==="above traces"){n.push("aaxis","aline")}if(e.baxis.layer==="above traces"){n.push("baxis","bline")}if(e.caxis.layer==="above traces"){n.push("caxis","cline")}var i=t.plotContainer.selectAll("g.toplevel").data(n,String);var o=["agrid","bgrid","cgrid"];i.enter().append("g").attr("class",(function(e){return"toplevel "+e})).each((function(e){var t=a.select(this);r[e]=t;if(e==="frontplot"){t.append("g").classed("scatterlayer",true)}else if(e==="backplot"){t.append("g").classed("maplayer",true)}else if(e==="plotbg"){t.append("path").attr("d","M0,0Z")}else if(e==="aline"||e==="bline"||e==="cline"){t.append("path")}else if(e==="grids"){o.forEach((function(e){r[e]=t.append("g").classed("grid "+e,true)}))}}));i.order()};var E=Math.sqrt(4/3);S.adjustLayout=function(e,t){var r=this;var a=e.domain;var n=(a.x[0]+a.x[1])/2;var i=(a.y[0]+a.y[1])/2;var o=a.x[1]-a.x[0];var l=a.y[1]-a.y[0];var p=o*t.w;var v=l*t.h;var d=e.sum;var m=e.aaxis.min;var g=e.baxis.min;var y=e.caxis.min;var x,b,_,w,T,k;if(p>E*v){w=v;_=w*E}else{_=p;w=_/E}T=o*_/p;k=l*w/v;x=t.l+t.w*n-_/2;b=t.t+t.h*(1-i)-w/2;r.x0=x;r.y0=b;r.w=_;r.h=w;r.sum=d;r.xaxis={type:"linear",range:[m+2*y-d,d-m-2*g],domain:[n-T/2,n+T/2],_id:"x"};f(r.xaxis,r.graphDiv._fullLayout);r.xaxis.setScale();r.xaxis.isPtWithinRange=function(e){return e.a>=r.aaxis.range[0]&&e.a<=r.aaxis.range[1]&&e.b>=r.baxis.range[1]&&e.b<=r.baxis.range[0]&&e.c>=r.caxis.range[1]&&e.c<=r.caxis.range[0]};r.yaxis={type:"linear",range:[m,d-g-y],domain:[i-k/2,i+k/2],_id:"y"};f(r.yaxis,r.graphDiv._fullLayout);r.yaxis.setScale();r.yaxis.isPtWithinRange=function(){return true};var M=r.yaxis.domain[0];var A=r.aaxis=h({},e.aaxis,{range:[m,d-g-y],side:"left",tickangle:(+e.aaxis.tickangle||0)-30,domain:[M,M+k*E],anchor:"free",position:0,_id:"y",_length:_});f(A,r.graphDiv._fullLayout);A.setScale();var S=r.baxis=h({},e.baxis,{range:[d-m-y,g],side:"bottom",domain:r.xaxis.domain,anchor:"free",position:0,_id:"x",_length:_});f(S,r.graphDiv._fullLayout);S.setScale();var L=r.caxis=h({},e.caxis,{range:[d-m-g,y],side:"right",tickangle:(+e.caxis.tickangle||0)+30,domain:[M,M+k*E],anchor:"free",position:0,_id:"y",_length:_});f(L,r.graphDiv._fullLayout);L.setScale();var C="M"+x+","+(b+w)+"h"+_+"l-"+_/2+",-"+w+"Z";r.clipDef.select("path").attr("d",C);r.layers.plotbg.select("path").attr("d",C);var I="M0,"+w+"h"+_+"l-"+_/2+",-"+w+"Z";r.clipDefRelative.select("path").attr("d",I);var P=s(x,b);r.plotContainer.selectAll(".scatterlayer,.maplayer").attr("transform",P);r.clipDefRelative.select("path").attr("transform",null);var O=s(x-S._offset,b+w);r.layers.baxis.attr("transform",O);r.layers.bgrid.attr("transform",O);var z=s(x+_/2,b)+"rotate(30)"+s(0,-A._offset);r.layers.aaxis.attr("transform",z);r.layers.agrid.attr("transform",z);var D=s(x+_/2,b)+"rotate(-30)"+s(0,-L._offset);r.layers.caxis.attr("transform",D);r.layers.cgrid.attr("transform",D);r.drawAxes(true);r.layers.aline.select("path").attr("d",A.showline?"M"+x+","+(b+w)+"l"+_/2+",-"+w:"M0,0").call(u.stroke,A.linecolor||"#000").style("stroke-width",(A.linewidth||0)+"px");r.layers.bline.select("path").attr("d",S.showline?"M"+x+","+(b+w)+"h"+_:"M0,0").call(u.stroke,S.linecolor||"#000").style("stroke-width",(S.linewidth||0)+"px");r.layers.cline.select("path").attr("d",L.showline?"M"+(x+_/2)+","+b+"l"+_/2+","+w:"M0,0").call(u.stroke,L.linecolor||"#000").style("stroke-width",(L.linewidth||0)+"px");if(!r.graphDiv._context.staticPlot){r.initInteractions()}c.setClipUrl(r.layers.frontplot,r._hasClipOnAxisFalse?null:r.clipId,r.graphDiv)};S.drawAxes=function(e){var t=this;var r=t.graphDiv;var a=t.id.substr(7)+"title";var n=t.layers;var i=t.aaxis;var o=t.baxis;var s=t.caxis;t.drawAx(i);t.drawAx(o);t.drawAx(s);if(e){var u=Math.max(i.showticklabels?i.tickfont.size/2:0,(s.showticklabels?s.tickfont.size*.75:0)+(s.ticks==="outside"?s.ticklen*.87:0));var c=(o.showticklabels?o.tickfont.size:0)+(o.ticks==="outside"?o.ticklen:0)+3;n["a-title"]=b.draw(r,"a"+a,{propContainer:i,propName:t.id+".aaxis.title",placeholder:l(r,"Click to enter Component A title"),attributes:{x:t.x0+t.w/2,y:t.y0-i.title.font.size/3-u,"text-anchor":"middle"}});n["b-title"]=b.draw(r,"b"+a,{propContainer:o,propName:t.id+".baxis.title",placeholder:l(r,"Click to enter Component B title"),attributes:{x:t.x0-c,y:t.y0+t.h+o.title.font.size*.83+c,"text-anchor":"middle"}});n["c-title"]=b.draw(r,"c"+a,{propContainer:s,propName:t.id+".caxis.title",placeholder:l(r,"Click to enter Component C title"),attributes:{x:t.x0+t.w+c,y:t.y0+t.h+s.title.font.size*.83+c,"text-anchor":"middle"}})}};S.drawAx=function(e){var t=this;var r=t.graphDiv;var a=e._name;var n=a.charAt(0);var i=e._id;var s=t.layers[a];var l=30;var u=n+"tickLayout";var c=L(e);if(t[u]!==c){s.selectAll("."+i+"tick").remove();t[u]=c}e.setScale();var f=v.calcTicks(e);var h=v.clipEnds(e,f);var p=v.makeTransTickFn(e);var d=v.getTickSigns(e)[2];var m=o.deg2rad(l);var g=d*(e.linewidth||1)/2;var y=d*e.ticklen;var x=t.w;var b=t.h;var _=n==="b"?"M0,"+g+"l"+Math.sin(m)*y+","+Math.cos(m)*y:"M"+g+",0l"+Math.cos(m)*y+","+-Math.sin(m)*y;var w={a:"M0,0l"+b+",-"+x/2,b:"M0,0l-"+x/2+",-"+b,c:"M0,0l-"+b+","+x/2}[n];v.drawTicks(r,e,{vals:e.ticks==="inside"?h:f,layer:s,path:_,transFn:p,crisp:false});v.drawGrid(r,e,{vals:h,layer:t.layers[n+"grid"],path:w,transFn:p,crisp:false});v.drawLabels(r,e,{vals:f,layer:s,transFn:p,labelFns:v.makeLabelFns(e,0,l)})};function L(e){return e.ticks+String(e.ticklen)+String(e.showticklabels)}var C=M.MINZOOM/2+.87;var I="m-0.87,.5h"+C+"v3h-"+(C+5.2)+"l"+(C/2+2.6)+",-"+(C*.87+4.5)+"l2.6,1.5l-"+C/2+","+C*.87+"Z";var P="m0.87,.5h-"+C+"v3h"+(C+5.2)+"l-"+(C/2+2.6)+",-"+(C*.87+4.5)+"l-2.6,1.5l"+C/2+","+C*.87+"Z";var O="m0,1l"+C/2+","+C*.87+"l2.6,-1.5l-"+(C/2+2.6)+",-"+(C*.87+4.5)+"l-"+(C/2+2.6)+","+(C*.87+4.5)+"l2.6,1.5l"+C/2+",-"+C*.87+"Z";var z="m0.5,0.5h5v-2h-5v-5h-2v5h-5v2h5v5h2Z";var D=true;S.clearSelect=function(){k(this.dragOptions);T(this.dragOptions.gd)};S.initInteractions=function(){var e=this;var t=e.layers.plotbg.select("path").node();var r=e.graphDiv;var a=r._fullLayout._zoomlayer;var f;var h;this.dragOptions={element:t,gd:r,plotinfo:{id:e.id,domain:r._fullLayout[e.id].domain,xaxis:e.xaxis,yaxis:e.yaxis},subplot:e.id,prepFn:function(t,a,n){e.dragOptions.xaxes=[e.xaxis];e.dragOptions.yaxes=[e.yaxis];f=r._fullLayout._invScaleX;h=r._fullLayout._invScaleY;var i=e.dragOptions.dragmode=r._fullLayout.dragmode;if(y(i))e.dragOptions.minDrag=1;else e.dragOptions.minDrag=undefined;if(i==="zoom"){e.dragOptions.moveFn=H;e.dragOptions.clickFn=B;e.dragOptions.doneFn=q;N(t,a,n)}else if(i==="pan"){e.dragOptions.moveFn=Y;e.dragOptions.clickFn=B;e.dragOptions.doneFn=W;G();e.clearSelect(r)}else if(x(i)||y(i)){_(t,a,n,e.dragOptions,i)}}};var p,v,g,b,T,k,A,S,L,C;function F(t){var r={};r[e.id+".aaxis.min"]=t.a;r[e.id+".baxis.min"]=t.b;r[e.id+".caxis.min"]=t.c;return r}function B(t,a){var n=r._fullLayout.clickmode;R(r);if(t===2){r.emit("plotly_doubleclick",null);i.call("_guiRelayout",r,F({a:0,b:0,c:0}))}if(n.indexOf("select")>-1&&t===1){w(a,r,[e.xaxis],[e.yaxis],e.id,e.dragOptions)}if(n.indexOf("event")>-1){m.click(r,a,e.id)}}function N(i,l,c){var f=t.getBoundingClientRect();p=l-f.left;v=c-f.top;r._fullLayout._calcInverseTransform(r);var h=r._fullLayout._invTransform;var d=o.apply3DTransform(h)(p,v);p=d[0];v=d[1];g={a:e.aaxis.range[0],b:e.baxis.range[1],c:e.caxis.range[1]};T=g;b=e.aaxis.range[1]-g.a;k=n(e.graphDiv._fullLayout[e.id].bgcolor).getLuminance();A="M0,"+e.h+"L"+e.w/2+", 0L"+e.w+","+e.h+"Z";S=false;L=a.append("path").attr("class","zoombox").attr("transform",s(e.x0,e.y0)).style({fill:k>.2?"rgba(0,0,0,0)":"rgba(255,255,255,0)","stroke-width":0}).attr("d",A);C=a.append("path").attr("class","zoombox-corners").attr("transform",s(e.x0,e.y0)).style({fill:u.background,stroke:u.defaultLine,"stroke-width":1,opacity:0}).attr("d","M0,0Z");e.clearSelect(r)}function j(t,r){return 1-r/e.h}function U(t,r){return 1-(t+(e.h-r)/Math.sqrt(3))/e.w}function V(t,r){return(t-(e.h-r)/Math.sqrt(3))/e.w}function H(t,a){var n=p+t*f;var i=v+a*h;var o=Math.max(0,Math.min(1,j(p,v),j(n,i)));var s=Math.max(0,Math.min(1,U(p,v),U(n,i)));var l=Math.max(0,Math.min(1,V(p,v),V(n,i)));var u=(o/2+l)*e.w;var c=(1-o/2-s)*e.w;var d=(u+c)/2;var m=c-u;var y=(1-o)*e.h;var x=y-m/E;if(m<M.MINZOOM){T=g;L.attr("d",A);C.attr("d","M0,0Z")}else{T={a:g.a+o*b,b:g.b+s*b,c:g.c+l*b};L.attr("d",A+"M"+u+","+y+"H"+c+"L"+d+","+x+"L"+u+","+y+"Z");C.attr("d","M"+p+","+v+z+"M"+u+","+y+I+"M"+c+","+y+P+"M"+d+","+x+O)}if(!S){L.transition().style("fill",k>.2?"rgba(0,0,0,0.4)":"rgba(255,255,255,0.3)").duration(200);C.transition().style("opacity",1).duration(200);S=true}r.emit("plotly_relayouting",F(T))}function q(){R(r);if(T===g)return;i.call("_guiRelayout",r,F(T));if(D&&r.data&&r._context.showTips){o.notifier(l(r,"Double-click to zoom back out"),"long");D=false}}function G(){g={a:e.aaxis.range[0],b:e.baxis.range[1],c:e.caxis.range[1]};T=g}function Y(t,a){var n=t/e.xaxis._m;var i=a/e.yaxis._m;T={a:g.a-i,b:g.b+(n+i)/2,c:g.c-(n-i)/2};var l=[T.a,T.b,T.c].sort(o.sorterAsc);var u={a:l.indexOf(T.a),b:l.indexOf(T.b),c:l.indexOf(T.c)};if(l[0]<0){if(l[1]+l[0]/2<0){l[2]+=l[0]+l[1];l[0]=l[1]=0}else{l[2]+=l[0]/2;l[1]+=l[0]/2;l[0]=0}T={a:l[u.a],b:l[u.b],c:l[u.c]};a=(g.a-T.a)*e.yaxis._m;t=(g.c-T.c-g.b+T.b)*e.xaxis._m}var f=s(e.x0+t,e.y0+a);e.plotContainer.selectAll(".scatterlayer,.maplayer").attr("transform",f);var h=s(-t,-a);e.clipDefRelative.select("path").attr("transform",h);e.aaxis.range=[T.a,e.sum-T.b-T.c];e.baxis.range=[e.sum-T.a-T.c,T.b];e.caxis.range=[e.sum-T.a-T.b,T.c];e.drawAxes(false);if(e._hasClipOnAxisFalse){e.plotContainer.select(".scatterlayer").selectAll(".trace").call(c.hideOutsideRangePoints,e)}r.emit("plotly_relayouting",F(T))}function W(){i.call("_guiRelayout",r,F(T))}t.onmousemove=function(a){m.hover(r,a,e.id);r._fullLayout._lasthover=t;r._fullLayout._hoversubplot=e.id};t.onmouseout=function(e){if(r._dragging)return;d.unhover(r,e)};d.init(this.dragOptions)};function R(e){a.select(e).selectAll(".zoombox,.js-zoombox-backdrop,.js-zoombox-menu,.zoombox-corners").remove()}},{"../../components/color":650,"../../components/dragelement":669,"../../components/dragelement/helpers":668,"../../components/drawing":672,"../../components/fx":690,"../../components/titles":748,"../../lib":787,"../../lib/extend":777,"../../registry":915,"../cartesian/axes":838,"../cartesian/constants":845,"../cartesian/select":858,"../cartesian/set_convert":859,"../plots":901,"@plotly/d3":58,tinycolor2:583}],915:[function(e,t,r){"use strict";var a=e("./lib/loggers");var n=e("./lib/noop");var i=e("./lib/push_unique");var o=e("./lib/is_plain_object");var s=e("./lib/dom").addStyleRule;var l=e("./lib/extend");var u=e("./plots/attributes");var c=e("./plots/layout_attributes");var f=l.extendFlat;var h=l.extendDeepAll;r.modules={};r.allCategories={};r.allTypes=[];r.subplotsRegistry={};r.transformsRegistry={};r.componentsRegistry={};r.layoutArrayContainers=[];r.layoutArrayRegexes=[];r.traceLayoutAttributes={};r.localeRegistry={};r.apiMethodRegistry={};r.collectableSubplotTypes=null;r.register=function e(t){r.collectableSubplotTypes=null;if(!t){throw new Error("No argument passed to Plotly.register.")}else if(t&&!Array.isArray(t)){t=[t]}for(var a=0;a<t.length;a++){var n=t[a];if(!n){throw new Error("Invalid module was attempted to be registered!")}switch(n.moduleType){case"trace":p(n);break;case"transform":m(n);break;case"component":d(n);break;case"locale":g(n);break;case"apiMethod":var i=n.name;r.apiMethodRegistry[i]=n.fn;break;default:throw new Error("Invalid module was attempted to be registered!")}}};r.getModule=function(e){var t=r.modules[w(e)];if(!t)return false;return t._module};r.traceIs=function(e,t){e=w(e);if(e==="various")return false;var n=r.modules[e];if(!n){if(e){a.log("Unrecognized trace type "+e+".")}n=r.modules[u.type.dflt]}return!!n.categories[t]};r.getTransformIndices=function(e,t){var r=[];var a=e.transforms||[];for(var n=0;n<a.length;n++){if(a[n].type===t){r.push(n)}}return r};r.hasTransform=function(e,t){var r=e.transforms||[];for(var a=0;a<r.length;a++){if(r[a].type===t){return true}}return false};r.getComponentMethod=function(e,t){var a=r.componentsRegistry[e];if(!a)return n;return a[t]||n};r.call=function(){var e=arguments[0];var t=[].slice.call(arguments,1);return r.apiMethodRegistry[e].apply(null,t)};function p(e){var t=e.name;var n=e.categories;var i=e.meta;if(r.modules[t]){a.log("Type "+t+" already registered");return}if(!r.subplotsRegistry[e.basePlotModule.name]){v(e.basePlotModule)}var o={};for(var l=0;l<n.length;l++){o[n[l]]=true;r.allCategories[n[l]]=true}r.modules[t]={_module:e,categories:o};if(i&&Object.keys(i).length){r.modules[t].meta=i}r.allTypes.push(t);for(var u in r.componentsRegistry){x(u,t)}if(e.layoutAttributes){f(r.traceLayoutAttributes,e.layoutAttributes)}var c=e.basePlotModule;var h=c.name;if(h==="mapbox"){var p=c.constants.styleRules;for(var d in p){s(".js-plotly-plot .plotly .mapboxgl-"+d,p[d])}}if((h==="geo"||h==="mapbox")&&(typeof window!==undefined&&window.PlotlyGeoAssets===undefined)){window.PlotlyGeoAssets={topojson:{}}}}function v(e){var t=e.name;if(r.subplotsRegistry[t]){a.log("Plot type "+t+" already registered.");return}y(e);r.subplotsRegistry[t]=e;for(var n in r.componentsRegistry){_(n,e.name)}}function d(e){if(typeof e.name!=="string"){throw new Error("Component module *name* must be a string.")}var t=e.name;r.componentsRegistry[t]=e;if(e.layoutAttributes){if(e.layoutAttributes._isLinkedToArray){i(r.layoutArrayContainers,t)}y(e)}for(var a in r.modules){x(t,a)}for(var n in r.subplotsRegistry){_(t,n)}for(var o in r.transformsRegistry){b(t,o)}if(e.schema&&e.schema.layout){h(c,e.schema.layout)}}function m(e){if(typeof e.name!=="string"){throw new Error("Transform module *name* must be a string.")}var t="Transform module "+e.name;var n=typeof e.transform==="function";var i=typeof e.calcTransform==="function";if(!n&&!i){throw new Error(t+" is missing a *transform* or *calcTransform* method.")}if(n&&i){a.log([t+" has both a *transform* and *calcTransform* methods.","Please note that all *transform* methods are executed","before all *calcTransform* methods."].join(" "))}if(!o(e.attributes)){a.log(t+" registered without an *attributes* object.")}if(typeof e.supplyDefaults!=="function"){a.log(t+" registered without a *supplyDefaults* method.")}r.transformsRegistry[e.name]=e;for(var s in r.componentsRegistry){b(s,e.name)}}function g(e){var t=e.name;var a=t.split("-")[0];var n=e.dictionary;var i=e.format;var o=n&&Object.keys(n).length;var s=i&&Object.keys(i).length;var l=r.localeRegistry;var u=l[t];if(!u)l[t]=u={};if(a!==t){var c=l[a];if(!c)l[a]=c={};if(o&&c.dictionary===u.dictionary){c.dictionary=n}if(s&&c.format===u.format){c.format=i}}if(o)u.dictionary=n;if(s)u.format=i}function y(e){if(e.layoutAttributes){var t=e.layoutAttributes._arrayAttrRegexps;if(t){for(var a=0;a<t.length;a++){i(r.layoutArrayRegexes,t[a])}}}}function x(e,t){var a=r.componentsRegistry[e].schema;if(!a||!a.traces)return;var n=a.traces[t];if(n){h(r.modules[t]._module.attributes,n)}}function b(e,t){var a=r.componentsRegistry[e].schema;if(!a||!a.transforms)return;var n=a.transforms[t];if(n){h(r.transformsRegistry[t].attributes,n)}}function _(e,t){var a=r.componentsRegistry[e].schema;if(!a||!a.subplots)return;var n=r.subplotsRegistry[t];var i=n.layoutAttributes;var o=n.attr==="subplot"?n.name:n.attr;if(Array.isArray(o))o=o[0];var s=a.subplots[o];if(i&&s){h(i,s)}}function w(e){if(typeof e==="object")e=e.type;return e}},{"./lib/dom":775,"./lib/extend":777,"./lib/is_plain_object":788,"./lib/loggers":791,"./lib/noop":796,"./lib/push_unique":802,"./plots/attributes":834,"./plots/layout_attributes":892}],916:[function(e,t,r){"use strict";var a=e("../registry");var n=e("../lib");var i=n.extendFlat;var o=n.extendDeep;function s(e){var t;switch(e){case"themes__thumb":t={autosize:true,width:150,height:150,title:{text:""},showlegend:false,margin:{l:5,r:5,t:5,b:5,pad:0},annotations:[]};break;case"thumbnail":t={title:{text:""},hidesources:true,showlegend:false,borderwidth:0,bordercolor:"",margin:{l:1,r:1,t:1,b:1,pad:0},annotations:[]};break;default:t={}}return t}function l(e){var t=["xaxis","yaxis","zaxis"];return t.indexOf(e.slice(0,5))>-1}t.exports=function e(t,r){var n;var u=t.data;var c=t.layout;var f=o([],u);var h=o({},c,s(r.tileClass));var p=t._context||{};if(r.width)h.width=r.width;if(r.height)h.height=r.height;if(r.tileClass==="thumbnail"||r.tileClass==="themes__thumb"){h.annotations=[];var v=Object.keys(h);for(n=0;n<v.length;n++){if(l(v[n])){h[v[n]].title={text:""}}}for(n=0;n<f.length;n++){var d=f[n];d.showscale=false;if(d.marker)d.marker.showscale=false;if(a.traceIs(d,"pie-like"))d.textposition="none"}}if(Array.isArray(r.annotations)){for(n=0;n<r.annotations.length;n++){h.annotations.push(r.annotations[n])}}var m=Object.keys(h).filter((function(e){return e.match(/^scene\d*$/)}));if(m.length){var g={};if(r.tileClass==="thumbnail"){g={title:{text:""},showaxeslabels:false,showticklabels:false,linetickenable:false}}for(n=0;n<m.length;n++){var y=h[m[n]];if(!y.xaxis){y.xaxis={}}if(!y.yaxis){y.yaxis={}}if(!y.zaxis){y.zaxis={}}i(y.xaxis,g);i(y.yaxis,g);i(y.zaxis,g);y._scene=null}}var x=document.createElement("div");if(r.tileClass)x.className=r.tileClass;var b={gd:x,td:x,layout:h,data:f,config:{staticPlot:r.staticPlot===undefined?true:r.staticPlot,plotGlPixelRatio:r.plotGlPixelRatio===undefined?2:r.plotGlPixelRatio,displaylogo:r.displaylogo||false,showLink:r.showLink||false,showTips:r.showTips||false,mapboxAccessToken:p.mapboxAccessToken}};if(r.setBackground!=="transparent"){b.config.setBackground=r.setBackground||"opaque"}b.gd.defaultLayout=s(r.tileClass);return b}},{"../lib":787,"../registry":915}],917:[function(e,t,r){"use strict";var a=e("../lib");var n=e("../plot_api/to_image");var i=e("./filesaver");var o=e("./helpers");function s(e,t){var r;if(!a.isPlainObject(e))r=a.getGraphDiv(e);t=t||{};t.format=t.format||"png";t.width=t.width||null;t.height=t.height||null;t.imageDataOnly=true;return new Promise((function(s,l){if(r&&r._snapshotInProgress){l(new Error("Snapshotting already in progress."))}if(a.isIE()&&t.format!=="svg"){l(new Error(o.MSG_IE_BAD_FORMAT))}if(r)r._snapshotInProgress=true;var u=n(e,t);var c=t.filename||e.fn||"newplot";c+="."+t.format.replace("-",".");u.then((function(e){if(r)r._snapshotInProgress=false;return i(e,c,t.format)})).then((function(e){s(e)})).catch((function(e){if(r)r._snapshotInProgress=false;l(e)}))}))}t.exports=s},{"../lib":787,"../plot_api/to_image":830,"./filesaver":918,"./helpers":919}],918:[function(e,t,r){"use strict";var a=e("../lib");var n=e("./helpers");function i(e,t,r){var i=document.createElement("a");var o="download"in i;var s=new Promise((function(s,l){var u;var c;if(a.isIE()){u=n.createBlob(e,"svg");window.navigator.msSaveBlob(u,t);u=null;return s(t)}if(o){u=n.createBlob(e,r);c=n.createObjectURL(u);i.href=c;i.download=t;document.body.appendChild(i);i.click();document.body.removeChild(i);n.revokeObjectURL(c);u=null;return s(t)}if(a.isSafari()){var f=r==="svg"?",":";base64,";n.octetStream(f+encodeURIComponent(e));return s(t)}l(new Error("download error"))}));return s}t.exports=i},{"../lib":787,"./helpers":919}],919:[function(e,t,r){"use strict";var a=e("../registry");r.getDelay=function(e){if(!e._has)return 0;return e._has("gl3d")||e._has("gl2d")||e._has("mapbox")?500:0};r.getRedrawFunc=function(e){return function(){a.getComponentMethod("colorbar","draw")(e)}};r.encodeSVG=function(e){return"data:image/svg+xml,"+encodeURIComponent(e)};r.encodeJSON=function(e){return"data:application/json,"+encodeURIComponent(e)};var n=window.URL||window.webkitURL;r.createObjectURL=function(e){return n.createObjectURL(e)};r.revokeObjectURL=function(e){return n.revokeObjectURL(e)};r.createBlob=function(e,t){if(t==="svg"){return new window.Blob([e],{type:"image/svg+xml;charset=utf-8"})}else if(t==="full-json"){return new window.Blob([e],{type:"application/json;charset=utf-8"})}else{var r=i(window.atob(e));return new window.Blob([r],{type:"image/"+t})}};r.octetStream=function(e){document.location.href="data:application/octet-stream"+e};function i(e){var t=e.length;var r=new ArrayBuffer(t);var a=new Uint8Array(r);for(var n=0;n<t;n++){a[n]=e.charCodeAt(n)}return r}r.IMAGE_URL_PREFIX=/^data:image\/\w+;base64,/;r.MSG_IE_BAD_FORMAT="Sorry IE does not support downloading from canvas. Try {format:'svg'} instead."},{"../registry":915}],920:[function(e,t,r){"use strict";var a=e("./helpers");var n={getDelay:a.getDelay,getRedrawFunc:a.getRedrawFunc,clone:e("./cloneplot"),toSVG:e("./tosvg"),svgToImg:e("./svgtoimg"),toImage:e("./toimage"),downloadImage:e("./download")};t.exports=n},{"./cloneplot":916,"./download":917,"./helpers":919,"./svgtoimg":921,"./toimage":922,"./tosvg":923}],921:[function(e,t,r){"use strict";var a=e("../lib");var n=e("events").EventEmitter;var i=e("./helpers");function o(e){var t=e.emitter||new n;var r=new Promise((function(n,o){var s=window.Image;var l=e.svg;var u=e.format||"png";if(a.isIE()&&u!=="svg"){var c=new Error(i.MSG_IE_BAD_FORMAT);o(c);if(!e.promise){return t.emit("error",c)}else{return r}}var f=e.canvas;var h=e.scale||1;var p=e.width||300;var v=e.height||150;var d=h*p;var m=h*v;var g=f.getContext("2d");var y=new s;var x,b;if(u==="svg"||a.isSafari()){b=i.encodeSVG(l)}else{x=i.createBlob(l,"svg");b=i.createObjectURL(x)}f.width=d;f.height=m;y.onload=function(){var r;x=null;i.revokeObjectURL(b);if(u!=="svg"){g.drawImage(y,0,0,d,m)}switch(u){case"jpeg":r=f.toDataURL("image/jpeg");break;case"png":r=f.toDataURL("image/png");break;case"webp":r=f.toDataURL("image/webp");break;case"svg":r=b;break;default:var a="Image format is not jpeg, png, svg or webp.";o(new Error(a));if(!e.promise){return t.emit("error",a)}}n(r);if(!e.promise){t.emit("success",r)}};y.onerror=function(r){x=null;i.revokeObjectURL(b);o(r);if(!e.promise){return t.emit("error",r)}};y.src=b}));if(e.promise){return r}return t}t.exports=o},{"../lib":787,"./helpers":919,events:116}],922:[function(e,t,r){"use strict";var a=e("events").EventEmitter;var n=e("../registry");var i=e("../lib");var o=e("./helpers");var s=e("./cloneplot");var l=e("./tosvg");var u=e("./svgtoimg");function c(e,t){var r=new a;var c=s(e,{format:"png"});var f=c.gd;f.style.position="absolute";f.style.left="-5000px";document.body.appendChild(f);function h(){var e=o.getDelay(f._fullLayout);setTimeout((function(){var e=l(f);var a=document.createElement("canvas");a.id=i.randstr();r=u({format:t.format,width:f._fullLayout.width,height:f._fullLayout.height,canvas:a,emitter:r,svg:e});r.clean=function(){if(f)document.body.removeChild(f)}}),e)}var p=o.getRedrawFunc(f);n.call("_doPlot",f,c.data,c.layout,c.config).then(p).then(h).catch((function(e){r.emit("error",e)}));return r}t.exports=c},{"../lib":787,"../registry":915,"./cloneplot":916,"./helpers":919,"./svgtoimg":921,"./tosvg":923,events:116}],923:[function(e,t,r){"use strict";var a=e("@plotly/d3");var n=e("../lib");var i=e("../components/drawing");var o=e("../components/color");var s=e("../constants/xmlns_namespaces");var l=/"/g;var u="TOBESTRIPPED";var c=new RegExp('("'+u+")|("+u+'")',"g");function f(e){var t=a.select("body").append("div").style({display:"none"}).html("");var r=e.replace(/(&[^;]*;)/gi,(function(e){if(e==="&lt;"){return"&#60;"}if(e==="&rt;"){return"&#62;"}if(e.indexOf("<")!==-1||e.indexOf(">")!==-1){return""}return t.html(e).text()}));t.remove();return r}function h(e){return e.replace(/&(?!\w+;|\#[0-9]+;| \#x[0-9A-F]+;)/g,"&amp;")}t.exports=function e(t,r,p){var v=t._fullLayout;var d=v._paper;var m=v._toppaper;var g=v.width;var y=v.height;var x,b;d.insert("rect",":first-child").call(i.setRect,0,0,g,y).call(o.fill,v.paper_bgcolor);var _=v._basePlotModules||[];for(x=0;x<_.length;x++){var w=_[x];if(w.toSVG)w.toSVG(t)}if(m){var T=m.node().childNodes;var k=Array.prototype.slice.call(T);for(x=0;x<k.length;x++){var M=k[x];if(M.childNodes.length)d.node().appendChild(M)}}if(v._draggers){v._draggers.remove()}d.node().style.background="";d.selectAll("text").attr({"data-unformatted":null,"data-math":null}).each((function(){var e=a.select(this);if(this.style.visibility==="hidden"||this.style.display==="none"){e.remove();return}else{e.style({visibility:null,display:null})}var t=this.style.fontFamily;if(t&&t.indexOf('"')!==-1){e.style("font-family",t.replace(l,u))}}));var A=[];if(v._gradientUrlQueryParts){for(b in v._gradientUrlQueryParts)A.push(b)}if(v._patternUrlQueryParts){for(b in v._patternUrlQueryParts)A.push(b)}if(A.length){d.selectAll(A.join(",")).each((function(){var e=a.select(this);var t=this.style.fill;if(t&&t.indexOf("url(")!==-1){e.style("fill",t.replace(l,u))}var r=this.style.stroke;if(r&&r.indexOf("url(")!==-1){e.style("stroke",r.replace(l,u))}}))}if(r==="pdf"||r==="eps"){d.selectAll("#MathJax_SVG_glyphs path").attr("stroke-width",0)}d.node().setAttributeNS(s.xmlns,"xmlns",s.svg);d.node().setAttributeNS(s.xmlns,"xmlns:xlink",s.xlink);if(r==="svg"&&p){d.attr("width",p*g);d.attr("height",p*y);d.attr("viewBox","0 0 "+g+" "+y)}var S=(new window.XMLSerializer).serializeToString(d.node());S=f(S);S=h(S);S=S.replace(c,"'");if(n.isIE()){S=S.replace(/"/gi,"'");S=S.replace(/(\('#)([^']*)('\))/gi,'("#$2")');S=S.replace(/(\\')/gi,'"')}return S}},{"../components/color":650,"../components/drawing":672,"../constants/xmlns_namespaces":764,"../lib":787,"@plotly/d3":58}],924:[function(e,t,r){"use strict";var a=e("../../lib");t.exports=function e(t,r){for(var n=0;n<t.length;n++)t[n].i=n;a.mergeArray(r.text,t,"tx");a.mergeArray(r.hovertext,t,"htx");var i=r.marker;if(i){a.mergeArray(i.opacity,t,"mo",true);a.mergeArray(i.color,t,"mc");var o=i.line;if(o){a.mergeArray(o.color,t,"mlc");a.mergeArrayCastPositive(o.width,t,"mlw")}}}},{"../../lib":787}],925:[function(e,t,r){"use strict";var a=e("../scatter/attributes");var n=e("../../plots/cartesian/axis_format_attributes").axisHoverFormat;var i=e("../../plots/template_attributes").hovertemplateAttrs;var o=e("../../plots/template_attributes").texttemplateAttrs;var s=e("../../components/colorscale/attributes");var l=e("../../plots/font_attributes");var u=e("./constants");var c=e("../../components/drawing/attributes").pattern;var f=e("../../lib/extend").extendFlat;var h=l({editType:"calc",arrayOk:true,colorEditType:"style"});var p=a.marker;var v=p.line;var d=f({},v.width,{dflt:0});var m=f({width:d,editType:"calc"},s("marker.line"));var g=f({line:m,editType:"calc"},s("marker"),{opacity:{valType:"number",arrayOk:true,dflt:1,min:0,max:1,editType:"style"},pattern:c});t.exports={x:a.x,x0:a.x0,dx:a.dx,y:a.y,y0:a.y0,dy:a.dy,xperiod:a.xperiod,yperiod:a.yperiod,xperiod0:a.xperiod0,yperiod0:a.yperiod0,xperiodalignment:a.xperiodalignment,yperiodalignment:a.yperiodalignment,xhoverformat:n("x"),yhoverformat:n("y"),text:a.text,texttemplate:o({editType:"plot"},{keys:u.eventDataKeys}),hovertext:a.hovertext,hovertemplate:i({},{keys:u.eventDataKeys}),textposition:{valType:"enumerated",values:["inside","outside","auto","none"],dflt:"auto",arrayOk:true,editType:"calc"},insidetextanchor:{valType:"enumerated",values:["end","middle","start"],dflt:"end",editType:"plot"},textangle:{valType:"angle",dflt:"auto",editType:"plot"},textfont:f({},h,{}),insidetextfont:f({},h,{}),outsidetextfont:f({},h,{}),constraintext:{valType:"enumerated",values:["inside","outside","both","none"],dflt:"both",editType:"calc"},cliponaxis:f({},a.cliponaxis,{}),orientation:{valType:"enumerated",values:["v","h"],editType:"calc+clearAxisTypes"},base:{valType:"any",dflt:null,arrayOk:true,editType:"calc"},offset:{valType:"number",dflt:null,arrayOk:true,editType:"calc"},width:{valType:"number",dflt:null,min:0,arrayOk:true,editType:"calc"},marker:g,offsetgroup:{valType:"string",dflt:"",editType:"calc"},alignmentgroup:{valType:"string",dflt:"",editType:"calc"},selected:{marker:{opacity:a.selected.marker.opacity,color:a.selected.marker.color,editType:"style"},textfont:a.selected.textfont,editType:"style"},unselected:{marker:{opacity:a.unselected.marker.opacity,color:a.unselected.marker.color,editType:"style"},textfont:a.unselected.textfont,editType:"style"},_deprecated:{bardir:{valType:"enumerated",editType:"calc",values:["v","h"]}}}},{"../../components/colorscale/attributes":657,"../../components/drawing/attributes":671,"../../lib/extend":777,"../../plots/cartesian/axis_format_attributes":841,"../../plots/font_attributes":867,"../../plots/template_attributes":910,"../scatter/attributes":1202,"./constants":927}],926:[function(e,t,r){"use strict";var a=e("../../plots/cartesian/axes");var n=e("../../plots/cartesian/align_period");var i=e("../../components/colorscale/helpers").hasColorscale;var o=e("../../components/colorscale/calc");var s=e("./arrays_to_calcdata");var l=e("../scatter/calc_selection");t.exports=function e(t,r){var u=a.getFromId(t,r.xaxis||"x");var c=a.getFromId(t,r.yaxis||"y");var f,h,p,v,d,m;var g={msUTC:!!(r.base||r.base===0)};if(r.orientation==="h"){f=u.makeCalcdata(r,"x",g);p=c.makeCalcdata(r,"y");v=n(r,c,"y",p);d=!!r.yperiodalignment;m="y"}else{f=c.makeCalcdata(r,"y",g);p=u.makeCalcdata(r,"x");v=n(r,u,"x",p);d=!!r.xperiodalignment;m="x"}h=v.vals;var y=Math.min(h.length,f.length);var x=new Array(y);for(var b=0;b<y;b++){x[b]={p:h[b],s:f[b]};if(d){x[b].orig_p=p[b];x[b][m+"End"]=v.ends[b];x[b][m+"Start"]=v.starts[b]}if(r.ids){x[b].id=String(r.ids[b])}}if(i(r,"marker")){o(t,r,{vals:r.marker.color,containerStr:"marker",cLetter:"c"})}if(i(r,"marker.line")){o(t,r,{vals:r.marker.line.color,containerStr:"marker.line",cLetter:"c"})}s(x,r);l(x,r);return x}},{"../../components/colorscale/calc":658,"../../components/colorscale/helpers":661,"../../plots/cartesian/align_period":835,"../../plots/cartesian/axes":838,"../scatter/calc_selection":1204,"./arrays_to_calcdata":924}],927:[function(e,t,r){"use strict";t.exports={TEXTPAD:3,eventDataKeys:["value","label"]}},{}],928:[function(e,t,r){"use strict";var a=e("fast-isnumeric");var n=e("../../lib").isArrayOrTypedArray;var i=e("../../constants/numerical").BADNUM;var o=e("../../registry");var s=e("../../plots/cartesian/axes");var l=e("../../plots/cartesian/constraints").getAxisGroup;var u=e("./sieve.js");function c(e,t){var r=t.xaxis;var a=t.yaxis;var n=e._fullLayout;var i=e._fullData;var s=e.calcdata;var l=[];var u=[];for(var c=0;c<i.length;c++){var h=i[c];if(h.visible===true&&o.traceIs(h,"bar")&&h.xaxis===r._id&&h.yaxis===a._id){if(h.orientation==="h"){l.push(s[c])}else{u.push(s[c])}if(h._computePh){var p=e.calcdata[c];for(var v=0;v<p.length;v++){if(typeof p[v].ph0==="function")p[v].ph0=p[v].ph0();if(typeof p[v].ph1==="function")p[v].ph1=p[v].ph1()}}}}var d={xCat:r.type==="category"||r.type==="multicategory",yCat:a.type==="category"||a.type==="multicategory",mode:n.barmode,norm:n.barnorm,gap:n.bargap,groupgap:n.bargroupgap};f(e,r,a,u,d);f(e,a,r,l,d)}function f(e,t,r,a,n){if(!a.length)return;var i;var o;var s,l,u;h(r,a);switch(n.mode){case"overlay":p(t,r,a,n);break;case"group":i=[];o=[];for(s=0;s<a.length;s++){l=a[s];u=l[0].trace;if(u.offset===undefined)o.push(l);else i.push(l)}if(o.length){v(e,t,r,o,n)}if(i.length){p(t,r,i,n)}break;case"stack":case"relative":i=[];o=[];for(s=0;s<a.length;s++){l=a[s];u=l[0].trace;if(u.base===undefined)o.push(l);else i.push(l)}if(o.length){d(e,t,r,o,n)}if(i.length){p(t,r,i,n)}break}A(a,t)}function h(e,t){var r,i;for(r=0;r<t.length;r++){var o=t[r];var s=o[0].trace;var l=s.type==="funnel"?s._base:s.base;var u;var c=s.orientation==="h"?s.xcalendar:s.ycalendar;var f=e.type==="category"||e.type==="multicategory"?function(){return null}:e.d2c;if(n(l)){for(i=0;i<Math.min(l.length,o.length);i++){u=f(l[i],0,c);if(a(u)){o[i].b=+u;o[i].hasB=1}else o[i].b=0}for(;i<o.length;i++){o[i].b=0}}else{u=f(l,0,c);var h=a(u);u=h?u:0;for(i=0;i<o.length;i++){o[i].b=u;if(h)o[i].hasB=1}}}}function p(e,t,r,a){for(var n=0;n<r.length;n++){var i=r[n];var o=new u([i],{posAxis:e,sepNegVal:false,overlapNoMerge:!a.norm});m(e,o,a);if(a.norm){T(o);M(t,o,a)}else{_(t,o)}}}function v(e,t,r,a,n){var i=new u(a,{posAxis:t,sepNegVal:false,overlapNoMerge:!n.norm});g(e,t,i,n);k(i,t);if(n.norm){T(i);M(r,i,n)}else{_(r,i)}}function d(e,t,r,a,n){var o=new u(a,{posAxis:t,sepNegVal:n.mode==="relative",overlapNoMerge:!(n.norm||n.mode==="stack"||n.mode==="relative")});m(t,o,n);w(r,o,n);for(var s=0;s<a.length;s++){var l=a[s];for(var c=0;c<l.length;c++){var f=l[c];if(f.s!==i){var h=f.b+f.s===o.get(f.p,f.s);if(h)f._outmost=true}}}if(n.norm)M(r,o,n)}function m(e,t,r){var a=t.minDiff;var n=t.traces;var i=a*(1-r.gap);var o=i;var s=o*(1-(r.groupgap||0));var l=-s/2;for(var u=0;u<n.length;u++){var c=n[u];var f=c[0].t;f.barwidth=s;f.poffset=l;f.bargroupwidth=i;f.bardelta=a}t.binWidth=n[0][0].t.barwidth/100;y(t);x(e,t);b(e,t)}function g(e,t,r,a){var n=e._fullLayout;var i=r.positions;var o=r.distinctPositions;var s=r.minDiff;var u=r.traces;var c=u.length;var f=i.length!==o.length;var h=s*(1-a.gap);var p=l(n,t._id)+u[0][0].trace.orientation;var v=n._alignmentOpts[p]||{};for(var d=0;d<c;d++){var m=u[d];var g=m[0].trace;var _=v[g.alignmentgroup]||{};var w=Object.keys(_.offsetGroups||{}).length;var T;if(w){T=h/w}else{T=f?h/c:h}var k=T*(1-(a.groupgap||0));var M;if(w){M=((2*g._offsetIndex+1-w)*T-k)/2}else{M=f?((2*d+1-c)*T-k)/2:-k/2}var A=m[0].t;A.barwidth=k;A.poffset=M;A.bargroupwidth=h;A.bardelta=s}r.binWidth=u[0][0].t.barwidth/100;y(r);x(t,r);b(t,r,f)}function y(e){var t=e.traces;var r,i;for(r=0;r<t.length;r++){var o=t[r];var s=o[0];var l=s.trace;var u=s.t;var c=l._offset||l.offset;var f=u.poffset;var h;if(n(c)){h=Array.prototype.slice.call(c,0,o.length);for(i=0;i<h.length;i++){if(!a(h[i])){h[i]=f}}for(i=h.length;i<o.length;i++){h.push(f)}u.poffset=h}else if(c!==undefined){u.poffset=c}var p=l._width||l.width;var v=u.barwidth;if(n(p)){var d=Array.prototype.slice.call(p,0,o.length);for(i=0;i<d.length;i++){if(!a(d[i]))d[i]=v}for(i=d.length;i<o.length;i++){d.push(v)}u.barwidth=d;if(c===undefined){h=[];for(i=0;i<o.length;i++){h.push(f+(v-d[i])/2)}u.poffset=h}}else if(p!==undefined){u.barwidth=p;if(c===undefined){u.poffset=f+(v-p)/2}}}}function x(e,t){var r=t.traces;var a=S(e);for(var n=0;n<r.length;n++){var i=r[n];var o=i[0].t;var s=o.poffset;var l=Array.isArray(s);var u=o.barwidth;var c=Array.isArray(u);for(var f=0;f<i.length;f++){var h=i[f];var p=h.w=c?u[f]:u;h[a]=h.p+(l?s[f]:s)+p/2}}}function b(e,t,r){var a=t.traces;var n=t.minDiff;var i=n/2;s.minDtick(e,t.minDiff,t.distinctPositions[0],r);for(var o=0;o<a.length;o++){var l=a[o];var u=l[0];var c=u.trace;var f=[];var h,p,v,d;for(d=0;d<l.length;d++){h=l[d];p=h.p-i;v=h.p+i;f.push(p,v)}if(c.width||c.offset){var m=u.t;var g=m.poffset;var y=m.barwidth;var x=Array.isArray(g);var b=Array.isArray(y);for(d=0;d<l.length;d++){h=l[d];var _=x?g[d]:g;var w=b?y[d]:y;p=h.p+_;v=p+w;f.push(p,v)}}c._extremes[e._id]=s.findExtremes(e,f,{padded:false})}}function _(e,t){var r=t.traces;var a=S(e);for(var n=0;n<r.length;n++){var i=r[n];var o=i[0].trace;var l=[];var u=false;for(var c=0;c<i.length;c++){var f=i[c];var h=f.b;var p=h+f.s;f[a]=p;l.push(p);if(f.hasB)l.push(h);if(!f.hasB||!f.b){u=true}}o._extremes[e._id]=s.findExtremes(e,l,{tozero:u,padded:true})}}function w(e,t,r){var a=S(e);var n=t.traces;var o;var l;var u;var c,f;var h;for(c=0;c<n.length;c++){o=n[c];l=o[0].trace;if(l.type==="funnel"){for(f=0;f<o.length;f++){h=o[f];if(h.s!==i){t.put(h.p,-.5*h.s)}}}}for(c=0;c<n.length;c++){o=n[c];l=o[0].trace;u=l.type==="funnel";var p=[];for(f=0;f<o.length;f++){h=o[f];if(h.s!==i){var v;if(u){v=h.s}else{v=h.s+h.b}var d=t.put(h.p,v);var m=d+v;h.b=d;h[a]=m;if(!r.norm){p.push(m);if(h.hasB){p.push(d)}}}}if(!r.norm){l._extremes[e._id]=s.findExtremes(e,p,{tozero:true,padded:true})}}}function T(e){var t=e.traces;for(var r=0;r<t.length;r++){var a=t[r];for(var n=0;n<a.length;n++){var o=a[n];if(o.s!==i){e.put(o.p,o.b+o.s)}}}}function k(e,t){var r=e.traces;for(var a=0;a<r.length;a++){var n=r[a];var o=n[0].trace;if(o.base===undefined){var s=new u([n],{posAxis:t,sepNegVal:true,overlapNoMerge:true});for(var l=0;l<n.length;l++){var c=n[l];if(c.p!==i){var f=s.put(c.p,c.b+c.s);if(f)c.b=f}}}}}function M(e,t,r){var n=t.traces;var o=S(e);var l=r.norm==="fraction"?1:100;var u=l/1e9;var c=e.l2c(e.c2l(0));var f=r.mode==="stack"?l:c;function h(t){return a(e.c2l(t))&&(t<c-u||t>f+u||!a(c))}for(var p=0;p<n.length;p++){var v=n[p];var d=v[0].trace;var m=[];var g=false;var y=false;for(var x=0;x<v.length;x++){var b=v[x];if(b.s!==i){var _=Math.abs(l/t.get(b.p,b.s));b.b*=_;b.s*=_;var w=b.b;var T=w+b.s;b[o]=T;m.push(T);y=y||h(T);if(b.hasB){m.push(w);y=y||h(w)}if(!b.hasB||!b.b){g=true}}}d._extremes[e._id]=s.findExtremes(e,m,{tozero:g,padded:y})}}function A(e,t){var r=S(t);var n={};var i,o,s;var l=Infinity;var u=-Infinity;for(i=0;i<e.length;i++){s=e[i];for(o=0;o<s.length;o++){var c=s[o].p;if(a(c)){l=Math.min(l,c);u=Math.max(u,c)}}}var f=1e4/(u-l);var h=n.round=function(e){return String(Math.round(f*(e-l)))};for(i=0;i<e.length;i++){s=e[i];s[0].t.extents=n;var p=s[0].t.poffset;var v=Array.isArray(p);for(o=0;o<s.length;o++){var d=s[o];var m=d[r]-d.w/2;if(a(m)){var g=d[r]+d.w/2;var y=h(d.p);if(n[y]){n[y]=[Math.min(m,n[y][0]),Math.max(g,n[y][1])]}else{n[y]=[m,g]}}d.p0=d.p+(v?p[o]:p);d.p1=d.p0+d.w;d.s0=d.b;d.s1=d.s0+d.s}}}function S(e){return e._id.charAt(0)}t.exports={crossTraceCalc:c,setGroupPositions:f}},{"../../constants/numerical":763,"../../lib":787,"../../plots/cartesian/axes":838,"../../plots/cartesian/constraints":846,"../../registry":915,"./sieve.js":938,"fast-isnumeric":246}],929:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("../../components/color");var i=e("../../registry");var o=e("../scatter/xy_defaults");var s=e("../scatter/period_defaults");var l=e("./style_defaults");var u=e("../../plots/cartesian/constraints").getAxisGroup;var c=e("./attributes");var f=a.coerceFont;function h(e,t,r,u){function f(r,n){return a.coerce(e,t,c,r,n)}var h=o(e,t,u,f);if(!h){t.visible=false;return}s(e,t,u,f);f("xhoverformat");f("yhoverformat");f("orientation",t.x&&!t.y?"h":"v");f("base");f("offset");f("width");f("text");f("hovertext");f("hovertemplate");var p=f("textposition");d(e,t,u,f,p,{moduleHasSelected:true,moduleHasUnselected:true,moduleHasConstrain:true,moduleHasCliponaxis:true,moduleHasTextangle:true,moduleHasInsideanchor:true});l(e,t,f,r,u);var v=(t.marker.line||{}).color;var m=i.getComponentMethod("errorbars","supplyDefaults");m(e,t,v||n.defaultLine,{axis:"y"});m(e,t,v||n.defaultLine,{axis:"x",inherit:"y"});a.coerceSelectionMarkerOpacity(t,f)}function p(e,t,r,a){var n=t.orientation;var i=t[{v:"x",h:"y"}[n]+"axis"];var o=u(r,i)+n;var s=r._alignmentOpts||{};var l=a("alignmentgroup");var c=s[o];if(!c)c=s[o]={};var f=c[l];if(f){f.traces.push(t)}else{f=c[l]={traces:[t],alignmentIndex:Object.keys(c).length,offsetGroups:{}}}var h=a("offsetgroup");var p=f.offsetGroups;var v=p[h];if(h){if(!v){v=p[h]={offsetIndex:Object.keys(p).length}}t._offsetIndex=v.offsetIndex}}function v(e,t){var r,n;function i(e){return a.coerce(n._input,n,c,e)}if(t.barmode==="group"){for(var o=0;o<e.length;o++){n=e[o];if(n.type==="bar"){r=n._input;p(r,n,t,i)}}}}function d(e,t,r,n,i,o){o=o||{};var s=!(o.moduleHasSelected===false);var l=!(o.moduleHasUnselected===false);var u=!(o.moduleHasConstrain===false);var c=!(o.moduleHasCliponaxis===false);var h=!(o.moduleHasTextangle===false);var p=!(o.moduleHasInsideanchor===false);var v=!!o.hasPathbar;var d=Array.isArray(i)||i==="auto";var m=d||i==="inside";var g=d||i==="outside";if(m||g){var y=f(n,"textfont",r.font);var x=a.extendFlat({},y);var b=e.textfont&&e.textfont.color;var _=!b;if(_){delete x.color}f(n,"insidetextfont",x);if(v){var w=a.extendFlat({},y);if(_){delete w.color}f(n,"pathbar.textfont",w)}if(g)f(n,"outsidetextfont",y);if(s)n("selected.textfont.color");if(l)n("unselected.textfont.color");if(u)n("constraintext");if(c)n("cliponaxis");if(h)n("textangle");n("texttemplate")}if(m){if(p)n("insidetextanchor")}}t.exports={supplyDefaults:h,crossTraceDefaults:v,handleGroupingDefaults:p,handleText:d}},{"../../components/color":650,"../../lib":787,"../../plots/cartesian/constraints":846,"../../registry":915,"../scatter/period_defaults":1222,"../scatter/xy_defaults":1229,"./attributes":925,"./style_defaults":940}],930:[function(e,t,r){"use strict";t.exports=function e(t,r,a){t.x="xVal"in r?r.xVal:r.x;t.y="yVal"in r?r.yVal:r.y;if(r.xa)t.xaxis=r.xa;if(r.ya)t.yaxis=r.ya;if(a.orientation==="h"){t.label=t.y;t.value=t.x}else{t.label=t.x;t.value=t.y}return t}},{}],931:[function(e,t,r){"use strict";var a=e("fast-isnumeric");var n=e("tinycolor2");var i=e("../../lib").isArrayOrTypedArray;r.coerceString=function(e,t,r){if(typeof t==="string"){if(t||!e.noBlank)return t}else if(typeof t==="number"||t===true){if(!e.strict)return String(t)}return r!==undefined?r:e.dflt};r.coerceNumber=function(e,t,r){if(a(t)){t=+t;var n=e.min;var i=e.max;var o=n!==undefined&&t<n||i!==undefined&&t>i;if(!o)return t}return r!==undefined?r:e.dflt};r.coerceColor=function(e,t,r){if(n(t).isValid())return t;return r!==undefined?r:e.dflt};r.coerceEnumerated=function(e,t,r){if(e.coerceNumber)t=+t;if(e.values.indexOf(t)!==-1)return t;return r!==undefined?r:e.dflt};r.getValue=function(e,t){var r;if(!Array.isArray(e))r=e;else if(t<e.length)r=e[t];return r};r.getLineWidth=function(e,t){var r=0<t.mlw?t.mlw:!i(e.marker.line.width)?e.marker.line.width:0;return r}},{"../../lib":787,"fast-isnumeric":246,tinycolor2:583}],932:[function(e,t,r){"use strict";var a=e("../../components/fx");var n=e("../../registry");var i=e("../../components/color");var o=e("../../lib").fillText;var s=e("./helpers").getLineWidth;var l=e("../../plots/cartesian/axes").hoverLabelText;var u=e("../../constants/numerical").BADNUM;function c(e,t,r,a,i){var o=f(e,t,r,a,i);if(o){var s=o.cd;var l=s[0].trace;var u=s[o.index];o.color=h(l,u);n.getComponentMethod("errorbars","hoverInfo")(u,l,o);return[o]}}function f(e,t,r,n,i){var s=e.cd;var c=s[0].trace;var f=s[0].t;var h=n==="closest";var p=c.type==="waterfall";var v=e.maxHoverDistance;var d=e.maxSpikeDistance;var m,g,y,x,b,_,w;if(c.orientation==="h"){m=r;g=t;y="y";x="x";b=D;_=P}else{m=t;g=r;y="x";x="y";_=D;b=P}var T=c[y+"period"];var k=h||T;function M(e){return S(e,-1)}function A(e){return S(e,1)}function S(e,t){var r=e.w;return e[y]+t*r/2}function E(e){return e[y+"End"]-e[y+"Start"]}var L=h?M:T?function(e){return e.p-E(e)/2}:function(e){return Math.min(M(e),e.p-f.bardelta/2)};var C=h?A:T?function(e){return e.p+E(e)/2}:function(e){return Math.max(A(e),e.p+f.bardelta/2)};function I(e,t,r){if(i.finiteRange)r=0;return a.inbox(e-m,t-m,r+Math.min(1,Math.abs(t-e)/w)-1)}function P(e){return I(L(e),C(e),v)}function O(e){return I(M(e),A(e),d)}function z(e){var t=e[x];if(p){var r=Math.abs(e.rawS)||0;if(g>0){t+=r}else if(g<0){t-=r}}return t}function D(e){var t=g;var r=e.b;var n=z(e);return a.inbox(r-t,n-t,v+(n-t)/(n-r)-1)}function R(e){var t=g;var r=e.b;var n=z(e);return a.inbox(r-t,n-t,d+(n-t)/(n-r)-1)}var F=e[y+"a"];var B=e[x+"a"];w=Math.abs(F.r2c(F.range[1])-F.r2c(F.range[0]));function N(e){return(b(e)+_(e))/2}var j=a.getDistanceFunction(n,b,_,N);a.getClosest(s,j,e);if(e.index===false)return;if(s[e.index].p===u)return;if(!k){L=function(e){return Math.min(M(e),e.p-f.bargroupwidth/2)};C=function(e){return Math.max(A(e),e.p+f.bargroupwidth/2)}}var U=e.index;var V=s[U];var H=c.base?V.b+V.s:V.s;e[x+"0"]=e[x+"1"]=B.c2p(V[x],true);e[x+"LabelVal"]=H;var q=f.extents[f.extents.round(V.p)];e[y+"0"]=F.c2p(h?L(V):q[0],true);e[y+"1"]=F.c2p(h?C(V):q[1],true);var G=V.orig_p!==undefined;e[y+"LabelVal"]=G?V.orig_p:V.p;e.labelLabel=l(F,e[y+"LabelVal"],c[y+"hoverformat"]);e.valueLabel=l(B,e[x+"LabelVal"],c[x+"hoverformat"]);e.baseLabel=l(B,V.b,c[x+"hoverformat"]);e.spikeDistance=(R(V)+O(V))/2;e[y+"Spike"]=F.c2p(V.p,true);o(V,c,e);e.hovertemplate=c.hovertemplate;return e}function h(e,t){var r=t.mcc||e.marker.color;var a=t.mlcc||e.marker.line.color;var n=s(e,t);if(i.opacity(r))return r;else if(i.opacity(a)&&n)return a}t.exports={hoverPoints:c,hoverOnBars:f,getTraceColor:h}},{"../../components/color":650,"../../components/fx":690,"../../constants/numerical":763,"../../lib":787,"../../plots/cartesian/axes":838,"../../registry":915,"./helpers":931}],933:[function(e,t,r){"use strict";t.exports={attributes:e("./attributes"),layoutAttributes:e("./layout_attributes"),supplyDefaults:e("./defaults").supplyDefaults,crossTraceDefaults:e("./defaults").crossTraceDefaults,supplyLayoutDefaults:e("./layout_defaults"),calc:e("./calc"),crossTraceCalc:e("./cross_trace_calc").crossTraceCalc,colorbar:e("../scatter/marker_colorbar"),arraysToCalcdata:e("./arrays_to_calcdata"),plot:e("./plot").plot,style:e("./style").style,styleOnSelect:e("./style").styleOnSelect,hoverPoints:e("./hover").hoverPoints,eventData:e("./event_data"),selectPoints:e("./select"),moduleType:"trace",name:"bar",basePlotModule:e("../../plots/cartesian"),categories:["bar-like","cartesian","svg","bar","oriented","errorBarsOK","showLegend","zoomScale"],animatable:true,meta:{}}},{"../../plots/cartesian":852,"../scatter/marker_colorbar":1220,"./arrays_to_calcdata":924,"./attributes":925,"./calc":926,"./cross_trace_calc":928,"./defaults":929,"./event_data":930,"./hover":932,"./layout_attributes":934,"./layout_defaults":935,"./plot":936,"./select":937,"./style":939}],934:[function(e,t,r){"use strict";t.exports={barmode:{valType:"enumerated",values:["stack","group","overlay","relative"],dflt:"group",editType:"calc"},barnorm:{valType:"enumerated",values:["","fraction","percent"],dflt:"",editType:"calc"},bargap:{valType:"number",min:0,max:1,editType:"calc"},bargroupgap:{valType:"number",min:0,max:1,dflt:0,editType:"calc"}}},{}],935:[function(e,t,r){"use strict";var a=e("../../registry");var n=e("../../plots/cartesian/axes");var i=e("../../lib");var o=e("./layout_attributes");t.exports=function(e,t,r){function s(r,a){return i.coerce(e,t,o,r,a)}var l=false;var u=false;var c=false;var f={};var h=s("barmode");for(var p=0;p<r.length;p++){var v=r[p];if(a.traceIs(v,"bar")&&v.visible)l=true;else continue;if(h==="group"){var d=v.xaxis+v.yaxis;if(f[d])c=true;f[d]=true}if(v.visible&&v.type==="histogram"){var m=n.getFromId({_fullLayout:t},v[v.orientation==="v"?"xaxis":"yaxis"]);if(m.type!=="category")u=true}}if(!l){delete t.barmode;return}if(h!=="overlay")s("barnorm");s("bargap",u&&!c?0:.2);s("bargroupgap")}},{"../../lib":787,"../../plots/cartesian/axes":838,"../../registry":915,"./layout_attributes":934}],936:[function(e,t,r){"use strict";var a=e("@plotly/d3");var n=e("fast-isnumeric");var i=e("../../lib");var o=e("../../lib/svg_text_utils");var s=e("../../components/color");var l=e("../../components/drawing");var u=e("../../registry");var c=e("../../plots/cartesian/axes").tickText;var f=e("./uniform_text");var h=f.recordMinTextSize;var p=f.clearMinTextSize;var v=e("./style");var d=e("./helpers");var m=e("./constants");var g=e("./attributes");var y=g.text;var x=g.textposition;var b=e("../../components/fx/helpers").appendArrayPointValue;var _=m.TEXTPAD;function w(e){return e.id}function T(e){if(e.ids){return w}}function k(e,t){return e<t?1:-1}function M(e,t,r,a){var n=[];var i=[];var o=a?t:r;var s=a?r:t;n[0]=o.c2p(e.s0,true);i[0]=s.c2p(e.p0,true);n[1]=o.c2p(e.s1,true);i[1]=s.c2p(e.p1,true);return a?[n,i]:[i,n]}function A(e,t,r,a){if(!t.uniformtext.mode&&S(r)){var n;if(a){n=a()}return e.transition().duration(r.duration).ease(r.easing).each("end",(function(){n&&n()})).each("interrupt",(function(){n&&n()}))}else{return e}}function S(e){return e&&e.duration>0}function E(e,t,r,o,c,f){var h=t.xaxis;var v=t.yaxis;var m=e._fullLayout;if(!c){c={mode:m.barmode,norm:m.barmode,gap:m.bargap,groupgap:m.bargroupgap};p("bar",m)}var g=i.makeTraceGroups(o,r,"trace bars").each((function(r){var o=a.select(this);var u=r[0].trace;var p=u.type==="waterfall";var g=u.type==="funnel";var y=u.type==="bar";var x=y||g;var b=0;if(p&&u.connector.visible&&u.connector.mode==="between"){b=u.connector.line.width/2}var _=u.orientation==="h";var w=S(c);var E=i.ensureSingle(o,"g","points");var C=T(u);var I=E.selectAll("g.point").data(i.identity,C);I.enter().append("g").classed("point",true);I.exit().remove();I.each((function(o,p){var g=a.select(this);var y=M(o,h,v,_);var T=y[0][0];var S=y[0][1];var E=y[1][0];var C=y[1][1];var I=(_?S-T:C-E)===0;if(I&&x&&d.getLineWidth(u,o)){I=false}if(!I){I=!n(T)||!n(S)||!n(E)||!n(C)}o.isBlank=I;if(I){if(_){S=T}else{C=E}}if(b&&!I){if(_){T-=k(T,S)*b;S+=k(T,S)*b}else{E-=k(E,C)*b;C+=k(E,C)*b}}var P;var O;if(u.type==="waterfall"){if(!I){var z=u[o.dir].marker;P=z.line.width;O=z.color}}else{P=d.getLineWidth(u,o);O=o.mc||u.marker.color}function D(e){var t=a.round(P/2%1,2);return c.gap===0&&c.groupgap===0?a.round(Math.round(e)-t,2):e}function R(e,t,r){if(r&&e===t){return e}return Math.abs(e-t)>=2?D(e):e>t?Math.ceil(e):Math.floor(e)}if(!e._context.staticPlot){var F=s.opacity(O);var B=F<1||P>.01?D:R;T=B(T,S,_);S=B(S,T,_);E=B(E,C,!_);C=B(C,E,!_)}var N=A(i.ensureSingle(g,"path"),m,c,f);N.style("vector-effect","non-scaling-stroke").attr("d",isNaN((S-T)*(C-E))||I&&e._context.staticPlot?"M0,0Z":"M"+T+","+E+"V"+C+"H"+S+"V"+E+"Z").call(l.setClipUrl,t.layerClipId,e);if(!m.uniformtext.mode&&w){var j=l.makePointStyleFns(u);l.singlePointStyle(o,N,u,j,e)}L(e,t,g,r,p,T,S,E,C,c,f);if(t.layerClipId){l.hideOutsideRangePoint(o,g.select("text"),h,v,u.xcalendar,u.ycalendar)}}));var P=u.cliponaxis===false;l.setClipUrl(o,P?null:t.layerClipId,e)}));u.getComponentMethod("errorbars","plot")(e,g,t,c)}function L(e,t,r,a,n,s,u,c,f,p,d){var m=t.xaxis;var g=t.yaxis;var y=e._fullLayout;var x;function b(t,r,a){var n=i.ensureSingle(t,"text").text(r).attr({class:"bartext bartext-"+x,"text-anchor":"middle","data-notex":1}).call(l.font,a).call(o.convertToTspans,e);return n}var w=a[0].trace;var T=w.orientation==="h";var k=z(y,a,n,m,g);x=D(w,n);var M=p.mode==="stack"||p.mode==="relative";var S=a[n];var E=!M||S._outmost;if(!k||x==="none"||(S.isBlank||s===u||c===f)&&(x==="auto"||x==="inside")){r.select("text").remove();return}var L=y.font;var C=v.getBarColor(a[n],w);var I=v.getInsideTextFont(w,n,L,C);var R=v.getOutsideTextFont(w,n,L);var F=r.datum();if(T){if(m.type==="log"&&F.s0<=0){if(m.range[0]<m.range[1]){s=0}else{s=m._length}}}else{if(g.type==="log"&&F.s0<=0){if(g.range[0]<g.range[1]){c=g._length}else{c=0}}}var B=Math.abs(u-s)-2*_;var N=Math.abs(f-c)-2*_;var j;var U;var V;var H;var q;if(x==="outside"){if(!E&&!S.hasB)x="inside"}if(x==="auto"){if(E){x="inside";q=i.ensureUniformFontSize(e,I);j=b(r,k,q);U=l.bBox(j.node()),V=U.width,H=U.height;var G=V>0&&H>0;var Y=V<=B&&H<=N;var W=V<=N&&H<=B;var X=T?B>=V*(N/H):N>=H*(B/V);if(G&&(Y||W||X)){x="inside"}else{x="outside";j.remove();j=null}}else{x="inside"}}if(!j){q=i.ensureUniformFontSize(e,x==="outside"?R:I);j=b(r,k,q);var Z=j.attr("transform");j.attr("transform","");U=l.bBox(j.node()),V=U.width,H=U.height;j.attr("transform",Z);if(V<=0||H<=0){j.remove();return}}var J=w.textangle;var K,Q;if(x==="outside"){Q=w.constraintext==="both"||w.constraintext==="outside";K=O(s,u,c,f,U,{isHorizontal:T,constrained:Q,angle:J})}else{Q=w.constraintext==="both"||w.constraintext==="inside";K=P(s,u,c,f,U,{isHorizontal:T,constrained:Q,angle:J,anchor:w.insidetextanchor})}K.fontSize=q.size;h(w.type,K,y);S.transform=K;A(j,y,p,d).attr("transform",i.getTextTransform(K))}function C(e){return e==="auto"?0:e}function I(e,t){var r=Math.PI/180*t;var a=Math.abs(Math.sin(r));var n=Math.abs(Math.cos(r));return{x:e.width*n+e.height*a,y:e.width*a+e.height*n}}function P(e,t,r,a,n,i){var o=!!i.isHorizontal;var s=!!i.constrained;var l=i.angle||0;var u=i.anchor||"end";var c=u==="end";var f=u==="start";var h=i.leftToRight||0;var p=(h+1)/2;var v=1-p;var d=n.width;var m=n.height;var g=Math.abs(t-e);var y=Math.abs(a-r);var x=g>2*_&&y>2*_?_:0;g-=2*x;y-=2*x;var b=C(l);if(l==="auto"&&!(d<=g&&m<=y)&&(d>g||m>y)&&(!(d>y||m>g)||d<m!==g<y)){b+=90}var w=I(n,b);var T=1;if(s){T=Math.min(1,g/w.x,y/w.y)}var M=n.left*v+n.right*p;var A=(n.top+n.bottom)/2;var S=(e+_)*v+(t-_)*p;var E=(r+a)/2;var L=0;var P=0;if(f||c){var O=(o?w.x:w.y)/2;var z=o?k(e,t):k(r,a);if(o){if(f){S=e+z*x;L=-z*O}else{S=t-z*x;L=z*O}}else{if(f){E=r+z*x;P=-z*O}else{E=a-z*x;P=z*O}}}return{textX:M,textY:A,targetX:S,targetY:E,anchorX:L,anchorY:P,scale:T,rotate:b}}function O(e,t,r,a,n,i){var o=!!i.isHorizontal;var s=!!i.constrained;var l=i.angle||0;var u=n.width;var c=n.height;var f=Math.abs(t-e);var h=Math.abs(a-r);var p;if(o){p=h>2*_?_:0}else{p=f>2*_?_:0}var v=1;if(s){v=o?Math.min(1,h/c):Math.min(1,f/u)}var d=C(l);var m=I(n,d);var g=(o?m.x:m.y)/2;var y=(n.left+n.right)/2;var x=(n.top+n.bottom)/2;var b=(e+t)/2;var w=(r+a)/2;var T=0;var M=0;var A=o?k(t,e):k(r,a);if(o){b=t-A*p;T=A*g}else{w=a+A*p;M=-A*g}return{textX:y,textY:x,targetX:b,targetY:w,anchorX:T,anchorY:M,scale:v,rotate:d}}function z(e,t,r,a,n){var i=t[0].trace;var o=i.texttemplate;var s;if(o){s=R(e,t,r,a,n)}else if(i.textinfo){s=F(t,r,a,n)}else{s=d.getValue(i.text,r)}return d.coerceString(y,s)}function D(e,t){var r=d.getValue(e.textposition,t);return d.coerceEnumerated(x,r)}function R(e,t,r,a,n){var o=t[0].trace;var s=i.castOption(o,r,"texttemplate");if(!s)return"";var l=o.type==="waterfall";var u=o.type==="funnel";var f,h;var p,v;if(o.orientation==="h"){f="y";h=n;p="x";v=a}else{f="x";h=a;p="y";v=n}function d(e){return c(h,h.c2l(e),true).text}function m(e){return c(v,v.c2l(e),true).text}var g=t[r];var y={};y.label=g.p;y.labelLabel=y[f+"Label"]=d(g.p);var x=i.castOption(o,g.i,"text");if(x===0||x)y.text=x;y.value=g.s;y.valueLabel=y[p+"Label"]=m(g.s);var _={};b(_,o,g.i);if(l){y.delta=+g.rawS||g.s;y.deltaLabel=m(y.delta);y.final=g.v;y.finalLabel=m(y.final);y.initial=y.final-y.delta;y.initialLabel=m(y.initial)}if(u){y.value=g.s;y.valueLabel=m(y.value);y.percentInitial=g.begR;y.percentInitialLabel=i.formatPercent(g.begR);y.percentPrevious=g.difR;y.percentPreviousLabel=i.formatPercent(g.difR);y.percentTotal=g.sumR;y.percenTotalLabel=i.formatPercent(g.sumR)}var w=i.castOption(o,g.i,"customdata");if(w)y.customdata=w;return i.texttemplateString(s,y,e._d3locale,_,y,o._meta||{})}function F(e,t,r,a){var n=e[0].trace;var o=n.orientation==="h";var s=n.type==="waterfall";var l=n.type==="funnel";function u(e){var t=o?a:r;return c(t,e,true).text}function f(e){var t=o?r:a;return c(t,+e,true).text}var h=n.textinfo;var p=e[t];var v=h.split("+");var d=[];var m;var g=function(e){return v.indexOf(e)!==-1};if(g("label")){d.push(u(e[t].p))}if(g("text")){m=i.castOption(n,p.i,"text");if(m===0||m)d.push(m)}if(s){var y=+p.rawS||p.s;var x=p.v;var b=x-y;if(g("initial"))d.push(f(b));if(g("delta"))d.push(f(y));if(g("final"))d.push(f(x))}if(l){if(g("value"))d.push(f(p.s));var _=0;if(g("percent initial"))_++;if(g("percent previous"))_++;if(g("percent total"))_++;var w=_>1;if(g("percent initial")){m=i.formatPercent(p.begR);if(w)m+=" of initial";d.push(m)}if(g("percent previous")){m=i.formatPercent(p.difR);if(w)m+=" of previous";d.push(m)}if(g("percent total")){m=i.formatPercent(p.sumR);if(w)m+=" of total";d.push(m)}}return d.join("<br>")}t.exports={plot:E,toMoveInsideBar:P}},{"../../components/color":650,"../../components/drawing":672,"../../components/fx/helpers":686,"../../lib":787,"../../lib/svg_text_utils":813,"../../plots/cartesian/axes":838,"../../registry":915,"./attributes":925,"./constants":927,"./helpers":931,"./style":939,"./uniform_text":941,"@plotly/d3":58,"fast-isnumeric":246}],937:[function(e,t,r){"use strict";t.exports=function e(t,r){var n=t.cd;var i=t.xaxis;var o=t.yaxis;var s=n[0].trace;var l=s.type==="funnel";var u=s.orientation==="h";var c=[];var f;if(r===false){for(f=0;f<n.length;f++){n[f].selected=0}}else{for(f=0;f<n.length;f++){var h=n[f];var p="ct"in h?h.ct:a(h,i,o,u,l);if(r.contains(p,false,f,t)){c.push({pointNumber:f,x:i.c2d(h.x),y:o.c2d(h.y)});h.selected=1}else{h.selected=0}}}return c};function a(e,t,r,a,n){var i=t.c2p(a?e.s0:e.p0,true);var o=t.c2p(a?e.s1:e.p1,true);var s=r.c2p(a?e.p0:e.s0,true);var l=r.c2p(a?e.p1:e.s1,true);if(n){return[(i+o)/2,(s+l)/2]}else{if(a){return[o,(s+l)/2]}else{return[(i+o)/2,l]}}}},{}],938:[function(e,t,r){"use strict";t.exports=i;var a=e("../../lib").distinctVals;var n=e("../../constants/numerical").BADNUM;function i(e,t){this.traces=e;this.sepNegVal=t.sepNegVal;this.overlapNoMerge=t.overlapNoMerge;var r=Infinity;var i=[];for(var o=0;o<e.length;o++){var s=e[o];for(var l=0;l<s.length;l++){var u=s[l];if(u.p!==n)i.push(u.p)}if(s[0]&&s[0].width1){r=Math.min(s[0].width1,r)}}this.positions=i;var c=a(i);this.distinctPositions=c.vals;if(c.vals.length===1&&r!==Infinity)this.minDiff=r;else this.minDiff=Math.min(c.minDiff,r);var f=(t.posAxis||{}).type;if(f==="category"||f==="multicategory"){this.minDiff=1}this.binWidth=this.minDiff;this.bins={}}i.prototype.put=function e(t,r){var a=this.getLabel(t,r);var n=this.bins[a]||0;this.bins[a]=n+r;return n};i.prototype.get=function e(t,r){var a=this.getLabel(t,r);return this.bins[a]||0};i.prototype.getLabel=function e(t,r){var a=r<0&&this.sepNegVal?"v":"^";var n=this.overlapNoMerge?t:Math.round(t/this.binWidth);return a+n}},{"../../constants/numerical":763,"../../lib":787}],939:[function(e,t,r){"use strict";var a=e("@plotly/d3");var n=e("../../components/color");var i=e("../../components/drawing");var o=e("../../lib");var s=e("../../registry");var l=e("./uniform_text").resizeText;var u=e("./attributes");var c=u.textfont;var f=u.insidetextfont;var h=u.outsidetextfont;var p=e("./helpers");function v(e){var t=a.select(e).selectAll("g.barlayer").selectAll("g.trace");l(e,t,"bar");var r=t.size();var n=e._fullLayout;t.style("opacity",(function(e){return e[0].trace.opacity})).each((function(e){if(n.barmode==="stack"&&r>1||n.bargap===0&&n.bargroupgap===0&&!e[0].trace.marker.line.width){a.select(this).attr("shape-rendering","crispEdges")}}));t.selectAll("g.points").each((function(t){var r=a.select(this);var n=t[0].trace;d(r,n,e)}));s.getComponentMethod("errorbars","style")(t)}function d(e,t,r){i.pointStyle(e.selectAll("path"),t,r);m(e,t,r)}function m(e,t,r){e.selectAll("text").each((function(e){var n=a.select(this);var s=o.ensureUniformFontSize(r,b(n,e,t,r));i.font(n,s)}))}function g(e,t,r){var a=t[0].trace;if(a.selectedpoints){y(r,a,e)}else{d(r,a,e);s.getComponentMethod("errorbars","style")(r)}}function y(e,t,r){i.selectedPointStyle(e.selectAll("path"),t);x(e.selectAll("text"),t,r)}function x(e,t,r){e.each((function(e){var n=a.select(this);var s;if(e.selected){s=o.ensureUniformFontSize(r,b(n,e,t,r));var l=t.selected.textfont&&t.selected.textfont.color;if(l){s.color=l}i.font(n,s)}else{i.selectedTextStyle(n,t)}}))}function b(e,t,r,a){var n=a._fullLayout.font;var i=r.textfont;if(e.classed("bartext-inside")){var o=M(t,r);i=w(r,t.i,n,o)}else if(e.classed("bartext-outside")){i=T(r,t.i,n)}return i}function _(e,t,r){return k(c,e.textfont,t,r)}function w(e,t,r,a){var i=_(e,t,r);var o=e._input.textfont===undefined||e._input.textfont.color===undefined||Array.isArray(e.textfont.color)&&e.textfont.color[t]===undefined;if(o){i={color:n.contrast(a),family:i.family,size:i.size}}return k(f,e.insidetextfont,t,i)}function T(e,t,r){var a=_(e,t,r);return k(h,e.outsidetextfont,t,a)}function k(e,t,r,a){t=t||{};var n=p.getValue(t.family,r);var i=p.getValue(t.size,r);var o=p.getValue(t.color,r);return{family:p.coerceString(e.family,n,a.family),size:p.coerceNumber(e.size,i,a.size),color:p.coerceColor(e.color,o,a.color)}}function M(e,t){if(t.type==="waterfall"){return t[e.dir].marker.color}return e.mcc||e.mc||t.marker.color}t.exports={style:v,styleTextPoints:m,styleOnSelect:g,getInsideTextFont:w,getOutsideTextFont:T,getBarColor:M,resizeText:l}},{"../../components/color":650,"../../components/drawing":672,"../../lib":787,"../../registry":915,"./attributes":925,"./helpers":931,"./uniform_text":941,"@plotly/d3":58}],940:[function(e,t,r){"use strict";var a=e("../../components/color");var n=e("../../components/colorscale/helpers").hasColorscale;var i=e("../../components/colorscale/defaults");var o=e("../../lib").coercePattern;t.exports=function e(t,r,s,l,u){var c=s("marker.color",l);var f=n(t,"marker");if(f){i(t,r,u,s,{prefix:"marker.",cLetter:"c"})}s("marker.line.color",a.defaultLine);if(n(t,"marker.line")){i(t,r,u,s,{prefix:"marker.line.",cLetter:"c"})}s("marker.line.width");s("marker.opacity");o(s,"marker.pattern",c,f);s("selected.marker.color");s("unselected.marker.color")}},{"../../components/color":650,"../../components/colorscale/defaults":660,"../../components/colorscale/helpers":661,"../../lib":787}],941:[function(e,t,r){"use strict";var a=e("@plotly/d3");var n=e("../../lib");function i(e,t,r){var i=e._fullLayout;var o=i["_"+r+"Text_minsize"];if(o){var s=i.uniformtext.mode==="hide";var l;switch(r){case"funnelarea":case"pie":case"sunburst":l="g.slice";break;case"treemap":case"icicle":l="g.slice, g.pathbar";break;default:l="g.points > g.point"}t.selectAll(l).each((function(e){var t=e.transform;if(t){t.scale=s&&t.hide?0:o/t.fontSize;var r=a.select(this).select("text");r.attr("transform",n.getTextTransform(t))}}))}}function o(e,t,r){if(r.uniformtext.mode){var a=l(e);var n=r.uniformtext.minsize;var i=t.scale*t.fontSize;t.hide=i<n;r[a]=r[a]||Infinity;if(!t.hide){r[a]=Math.min(r[a],Math.max(i,n))}}}function s(e,t){var r=l(e);t[r]=undefined}function l(e){return"_"+e+"Text_minsize"}t.exports={recordMinTextSize:o,clearMinTextSize:s,resizeText:i}},{"../../lib":787,"@plotly/d3":58}],942:[function(e,t,r){"use strict";var a=e("../../plots/template_attributes").hovertemplateAttrs;var n=e("../../lib/extend").extendFlat;var i=e("../scatterpolar/attributes");var o=e("../bar/attributes");t.exports={r:i.r,theta:i.theta,r0:i.r0,dr:i.dr,theta0:i.theta0,dtheta:i.dtheta,thetaunit:i.thetaunit,base:n({},o.base,{}),offset:n({},o.offset,{}),width:n({},o.width,{}),text:n({},o.text,{}),hovertext:n({},o.hovertext,{}),marker:o.marker,hoverinfo:i.hoverinfo,hovertemplate:a(),selected:o.selected,unselected:o.unselected}},{"../../lib/extend":777,"../../plots/template_attributes":910,"../bar/attributes":925,"../scatterpolar/attributes":1276}],943:[function(e,t,r){"use strict";var a=e("../../components/colorscale/helpers").hasColorscale;var n=e("../../components/colorscale/calc");var i=e("../bar/arrays_to_calcdata");var o=e("../bar/cross_trace_calc").setGroupPositions;var s=e("../scatter/calc_selection");var l=e("../../registry").traceIs;var u=e("../../lib").extendFlat;function c(e,t){var r=e._fullLayout;var o=t.subplot;var l=r[o].radialaxis;var u=r[o].angularaxis;var c=l.makeCalcdata(t,"r");var f=u.makeCalcdata(t,"theta");var h=t._length;var p=new Array(h);var v=c;var d=f;for(var m=0;m<h;m++){p[m]={p:d[m],s:v[m]}}function g(e){var r=t[e];if(r!==undefined){t["_"+e]=Array.isArray(r)?u.makeCalcdata(t,e):u.d2c(r,t.thetaunit)}}if(u.type==="linear"){g("width");g("offset")}if(a(t,"marker")){n(e,t,{vals:t.marker.color,containerStr:"marker",cLetter:"c"})}if(a(t,"marker.line")){n(e,t,{vals:t.marker.line.color,containerStr:"marker.line",cLetter:"c"})}i(p,t);s(p,t);return p}function f(e,t,r){var a=e.calcdata;var n=[];for(var i=0;i<a.length;i++){var s=a[i];var c=s[0].trace;if(c.visible===true&&l(c,"bar")&&c.subplot===r){n.push(s)}}var f=u({},t.radialaxis,{_id:"x"});var h=t.angularaxis;o(e,h,f,n,{mode:t.barmode,norm:t.barnorm,gap:t.bargap,groupgap:t.bargroupgap})}t.exports={calc:c,crossTraceCalc:f}},{"../../components/colorscale/calc":658,"../../components/colorscale/helpers":661,"../../lib":787,"../../registry":915,"../bar/arrays_to_calcdata":924,"../bar/cross_trace_calc":928,"../scatter/calc_selection":1204}],944:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("../scatterpolar/defaults").handleRThetaDefaults;var i=e("../bar/style_defaults");var o=e("./attributes");t.exports=function e(t,r,s,l){function u(e,n){return a.coerce(t,r,o,e,n)}var c=n(t,r,l,u);if(!c){r.visible=false;return}u("thetaunit");u("base");u("offset");u("width");u("text");u("hovertext");u("hovertemplate");i(t,r,u,s,l);a.coerceSelectionMarkerOpacity(r,u)}},{"../../lib":787,"../bar/style_defaults":940,"../scatterpolar/defaults":1278,"./attributes":942}],945:[function(e,t,r){"use strict";var a=e("../../components/fx");var n=e("../../lib");var i=e("../bar/hover").getTraceColor;var o=n.fillText;var s=e("../scatterpolar/hover").makeHoverPointText;var l=e("../../plots/polar/helpers").isPtInsidePolygon;t.exports=function e(t,r,u){var c=t.cd;var f=c[0].trace;var h=t.subplot;var p=h.radialAxis;var v=h.angularAxis;var d=h.vangles;var m=d?l:n.isPtInsideSector;var g=t.maxHoverDistance;var y=v._period||2*Math.PI;var x=Math.abs(p.g2p(Math.sqrt(r*r+u*u)));var b=Math.atan2(u,r);if(p.range[0]>p.range[1]){b+=Math.PI}var _=function(e){if(m(x,b,[e.rp0,e.rp1],[e.thetag0,e.thetag1],d)){return g+Math.min(1,Math.abs(e.thetag1-e.thetag0)/y)-1+(e.rp1-x)/(e.rp1-e.rp0)-1}else{return Infinity}};a.getClosest(c,_,t);if(t.index===false)return;var w=t.index;var T=c[w];t.x0=t.x1=T.ct[0];t.y0=t.y1=T.ct[1];var k=n.extendFlat({},T,{r:T.s,theta:T.p});o(T,f,t);s(k,f,h,t);t.hovertemplate=f.hovertemplate;t.color=i(f,T);t.xLabelVal=t.yLabelVal=undefined;if(T.s<0){t.idealAlign="left"}return[t]}},{"../../components/fx":690,"../../lib":787,"../../plots/polar/helpers":903,"../bar/hover":932,"../scatterpolar/hover":1280}],946:[function(e,t,r){"use strict";t.exports={moduleType:"trace",name:"barpolar",basePlotModule:e("../../plots/polar"),categories:["polar","bar","showLegend"],attributes:e("./attributes"),layoutAttributes:e("./layout_attributes"),supplyDefaults:e("./defaults"),supplyLayoutDefaults:e("./layout_defaults"),calc:e("./calc").calc,crossTraceCalc:e("./calc").crossTraceCalc,plot:e("./plot"),colorbar:e("../scatter/marker_colorbar"),formatLabels:e("../scatterpolar/format_labels"),style:e("../bar/style").style,styleOnSelect:e("../bar/style").styleOnSelect,hoverPoints:e("./hover"),selectPoints:e("../bar/select"),meta:{}}},{"../../plots/polar":904,"../bar/select":937,"../bar/style":939,"../scatter/marker_colorbar":1220,"../scatterpolar/format_labels":1279,"./attributes":942,"./calc":943,"./defaults":944,"./hover":945,"./layout_attributes":947,"./layout_defaults":948,"./plot":949}],947:[function(e,t,r){"use strict";t.exports={barmode:{valType:"enumerated",values:["stack","overlay"],dflt:"stack",editType:"calc"},bargap:{valType:"number",dflt:.1,min:0,max:1,editType:"calc"}}},{}],948:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("./layout_attributes");t.exports=function(e,t,r){var i={};var o;function s(r,i){return a.coerce(e[o]||{},t[o],n,r,i)}for(var l=0;l<r.length;l++){var u=r[l];if(u.type==="barpolar"&&u.visible===true){o=u.subplot;if(!i[o]){s("barmode");s("bargap");i[o]=1}}}}},{"../../lib":787,"./layout_attributes":947}],949:[function(e,t,r){"use strict";var a=e("@plotly/d3");var n=e("fast-isnumeric");var i=e("../../lib");var o=e("../../components/drawing");var s=e("../../plots/polar/helpers");t.exports=function e(t,r,s){var u=r.xaxis;var c=r.yaxis;var f=r.radialAxis;var h=r.angularAxis;var p=l(r);var v=r.layers.frontplot.select("g.barlayer");i.makeTraceGroups(v,s,"trace bars").each((function(){var e=a.select(this);var s=i.ensureSingle(e,"g","points");var l=s.selectAll("g.point").data(i.identity);l.enter().append("g").style("vector-effect","non-scaling-stroke").style("stroke-miterlimit",2).classed("point",true);l.exit().remove();l.each((function(e){var t=a.select(this);var r=e.rp0=f.c2p(e.s0);var o=e.rp1=f.c2p(e.s1);var s=e.thetag0=h.c2g(e.p0);var l=e.thetag1=h.c2g(e.p1);var v;if(!n(r)||!n(o)||!n(s)||!n(l)||r===o||s===l){v="M0,0Z"}else{var d=f.c2g(e.s1);var m=(s+l)/2;e.ct=[u.c2p(d*Math.cos(m)),c.c2p(d*Math.sin(m))];v=p(r,o,s,l)}i.ensureSingle(t,"path").attr("d",v)}));o.setClipUrl(e,r._hasClipOnAxisFalse?r.clipIds.forTraces:null,t)}))};function l(e){var t=e.cxx;var r=e.cyy;if(e.vangles){return function(a,n,o,l){var u,c;if(i.angleDelta(o,l)>0){u=o;c=l}else{u=l;c=o}var f=s.findEnclosingVertexAngles(u,e.vangles)[0];var h=s.findEnclosingVertexAngles(c,e.vangles)[1];var p=[f,(u+c)/2,h];return s.pathPolygonAnnulus(a,n,u,c,p,t,r)}}return function(e,a,n,o){return i.pathAnnulus(e,a,n,o,t,r)}}},{"../../components/drawing":672,"../../lib":787,"../../plots/polar/helpers":903,"@plotly/d3":58,"fast-isnumeric":246}],950:[function(e,t,r){"use strict";var a=e("../scatter/attributes");var n=e("../bar/attributes");var i=e("../../components/color/attributes");var o=e("../../plots/cartesian/axis_format_attributes").axisHoverFormat;var s=e("../../plots/template_attributes").hovertemplateAttrs;var l=e("../../lib/extend").extendFlat;var u=a.marker;var c=u.line;t.exports={y:{valType:"data_array",editType:"calc+clearAxisTypes"},x:{valType:"data_array",editType:"calc+clearAxisTypes"},x0:{valType:"any",editType:"calc+clearAxisTypes"},y0:{valType:"any",editType:"calc+clearAxisTypes"},dx:{valType:"number",editType:"calc"},dy:{valType:"number",editType:"calc"},xperiod:a.xperiod,yperiod:a.yperiod,xperiod0:a.xperiod0,yperiod0:a.yperiod0,xperiodalignment:a.xperiodalignment,yperiodalignment:a.yperiodalignment,xhoverformat:o("x"),yhoverformat:o("y"),name:{valType:"string",editType:"calc+clearAxisTypes"},q1:{valType:"data_array",editType:"calc+clearAxisTypes"},median:{valType:"data_array",editType:"calc+clearAxisTypes"},q3:{valType:"data_array",editType:"calc+clearAxisTypes"},lowerfence:{valType:"data_array",editType:"calc"},upperfence:{valType:"data_array",editType:"calc"},notched:{valType:"boolean",editType:"calc"},notchwidth:{valType:"number",min:0,max:.5,dflt:.25,editType:"calc"},notchspan:{valType:"data_array",editType:"calc"},boxpoints:{valType:"enumerated",values:["all","outliers","suspectedoutliers",false],editType:"calc"},jitter:{valType:"number",min:0,max:1,editType:"calc"},pointpos:{valType:"number",min:-2,max:2,editType:"calc"},boxmean:{valType:"enumerated",values:[true,"sd",false],editType:"calc"},mean:{valType:"data_array",editType:"calc"},sd:{valType:"data_array",editType:"calc"},orientation:{valType:"enumerated",values:["v","h"],editType:"calc+clearAxisTypes"},quartilemethod:{valType:"enumerated",values:["linear","exclusive","inclusive"],dflt:"linear",editType:"calc"},width:{valType:"number",min:0,dflt:0,editType:"calc"},marker:{outliercolor:{valType:"color",dflt:"rgba(0, 0, 0, 0)",editType:"style"},symbol:l({},u.symbol,{arrayOk:false,editType:"plot"}),opacity:l({},u.opacity,{arrayOk:false,dflt:1,editType:"style"}),size:l({},u.size,{arrayOk:false,editType:"calc"}),color:l({},u.color,{arrayOk:false,editType:"style"}),line:{color:l({},c.color,{arrayOk:false,dflt:i.defaultLine,editType:"style"}),width:l({},c.width,{arrayOk:false,dflt:0,editType:"style"}),outliercolor:{valType:"color",editType:"style"},outlierwidth:{valType:"number",min:0,dflt:1,editType:"style"},editType:"style"},editType:"plot"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,dflt:2,editType:"style"},editType:"plot"},fillcolor:a.fillcolor,whiskerwidth:{valType:"number",min:0,max:1,dflt:.5,editType:"calc"},offsetgroup:n.offsetgroup,alignmentgroup:n.alignmentgroup,selected:{marker:a.selected.marker,editType:"style"},unselected:{marker:a.unselected.marker,editType:"style"},text:l({},a.text,{}),hovertext:l({},a.hovertext,{}),hovertemplate:s({}),hoveron:{valType:"flaglist",flags:["boxes","points"],dflt:"boxes+points",editType:"style"}}},{"../../components/color/attributes":649,"../../lib/extend":777,"../../plots/cartesian/axis_format_attributes":841,"../../plots/template_attributes":910,"../bar/attributes":925,"../scatter/attributes":1202}],951:[function(e,t,r){"use strict";var a=e("fast-isnumeric");var n=e("../../plots/cartesian/axes");var i=e("../../plots/cartesian/align_period");var o=e("../../lib");var s=e("../../constants/numerical").BADNUM;var l=o._;t.exports=function e(t,r){var i=t._fullLayout;var h=n.getFromId(t,r.xaxis||"x");var w=n.getFromId(t,r.yaxis||"y");var T=[];var k=r.type==="violin"?"_numViolins":"_numBoxes";var M,A;var S,E;var L,C;var I;if(r.orientation==="h"){S=h;E="x";L=w;C="y";I=!!r.yperiodalignment}else{S=w;E="y";L=h;C="x";I=!!r.xperiodalignment}var P=u(r,C,L,i[k]);var O=P[0];var z=P[1];var D=o.distinctVals(O,L);var R=D.vals;var F=D.minDiff/2;var B;var N;var j;var U;var V;var H;var q=(r.boxpoints||r.points)==="all"?o.identity:function(e){return e.v<B.lf||e.v>B.uf};if(r._hasPreCompStats){var G=r[E];var Y=function(e){return S.d2c((r[e]||[])[M])};var W=Infinity;var X=-Infinity;for(M=0;M<r._length;M++){var Z=O[M];if(!a(Z))continue;B={};B.pos=B[C]=Z;if(I&&z){B.orig_p=z[M]}B.q1=Y("q1");B.med=Y("median");B.q3=Y("q3");N=[];if(G&&o.isArrayOrTypedArray(G[M])){for(A=0;A<G[M].length;A++){H=S.d2c(G[M][A]);if(H!==s){V={v:H,i:[M,A]};p(V,r,[M,A]);N.push(V)}}}B.pts=N.sort(d);j=B[E]=N.map(m);U=j.length;if(B.med!==s&&B.q1!==s&&B.q3!==s&&B.med>=B.q1&&B.q3>=B.med){var J=Y("lowerfence");B.lf=J!==s&&J<=B.q1?J:g(B,j,U);var K=Y("upperfence");B.uf=K!==s&&K>=B.q3?K:y(B,j,U);var Q=Y("mean");B.mean=Q!==s?Q:U?o.mean(j,U):(B.q1+B.q3)/2;var $=Y("sd");B.sd=Q!==s&&$>=0?$:U?o.stdev(j,U,B.mean):B.q3-B.q1;B.lo=x(B);B.uo=b(B);var ee=Y("notchspan");ee=ee!==s&&ee>0?ee:_(B,U);B.ln=B.med-ee;B.un=B.med+ee;var te=B.lf;var re=B.uf;if(r.boxpoints&&j.length){te=Math.min(te,j[0]);re=Math.max(re,j[U-1])}if(r.notched){te=Math.min(te,B.ln);re=Math.max(re,B.un)}B.min=te;B.max=re}else{o.warn(["Invalid input - make sure that q1 <= median <= q3","q1 = "+B.q1,"median = "+B.med,"q3 = "+B.q3].join("\n"));var ae;if(B.med!==s){ae=B.med}else if(B.q1!==s){if(B.q3!==s)ae=(B.q1+B.q3)/2;else ae=B.q1}else if(B.q3!==s){ae=B.q3}else{ae=0}B.med=ae;B.q1=B.q3=ae;B.lf=B.uf=ae;B.mean=B.sd=ae;B.ln=B.un=ae;B.min=B.max=ae}W=Math.min(W,B.min);X=Math.max(X,B.max);B.pts2=N.filter(q);T.push(B)}r._extremes[S._id]=n.findExtremes(S,[W,X],{padded:true})}else{var ne=S.makeCalcdata(r,E);var ie=c(R,F);var oe=R.length;var se=f(oe);for(M=0;M<r._length;M++){H=ne[M];if(!a(H))continue;var le=o.findBin(O[M],ie);if(le>=0&&le<oe){V={v:H,i:M};p(V,r,M);se[le].push(V)}}var ue=Infinity;var ce=-Infinity;var fe=r.quartilemethod;var he=fe==="exclusive";var pe=fe==="inclusive";for(M=0;M<oe;M++){if(se[M].length>0){B={};B.pos=B[C]=R[M];N=B.pts=se[M].sort(d);j=B[E]=N.map(m);U=j.length;B.min=j[0];B.max=j[U-1];B.mean=o.mean(j,U);B.sd=o.stdev(j,U,B.mean);B.med=o.interp(j,.5);if(U%2&&(he||pe)){var ve;var de;if(he){ve=j.slice(0,U/2);de=j.slice(U/2+1)}else if(pe){ve=j.slice(0,U/2+1);de=j.slice(U/2)}B.q1=o.interp(ve,.5);B.q3=o.interp(de,.5)}else{B.q1=o.interp(j,.25);B.q3=o.interp(j,.75)}B.lf=g(B,j,U);B.uf=y(B,j,U);B.lo=x(B);B.uo=b(B);var me=_(B,U);B.ln=B.med-me;B.un=B.med+me;ue=Math.min(ue,B.ln);ce=Math.max(ce,B.un);B.pts2=N.filter(q);T.push(B)}}r._extremes[S._id]=n.findExtremes(S,r.notched?ne.concat([ue,ce]):ne,{padded:true})}v(T,r);if(T.length>0){T[0].t={num:i[k],dPos:F,posLetter:C,valLetter:E,labels:{med:l(t,"median:"),min:l(t,"min:"),q1:l(t,"q1:"),q3:l(t,"q3:"),max:l(t,"max:"),mean:r.boxmean==="sd"?l(t,"mean ± σ:"):l(t,"mean:"),lf:l(t,"lower fence:"),uf:l(t,"upper fence:")}};i[k]++;return T}else{return[{t:{empty:true}}]}};function u(e,t,r,n){var s=t in e;var l=t+"0"in e;var u="d"+t in e;if(s||l&&u){var c=r.makeCalcdata(e,t);var f=i(e,r,t,c).vals;return[f,c]}var h;if(l){h=e[t+"0"]}else if("name"in e&&(r.type==="category"||a(e.name)&&["linear","log"].indexOf(r.type)!==-1||o.isDateTime(e.name)&&r.type==="date")){h=e.name}else{h=n}var p=r.type==="multicategory"?r.r2c_just_indices(h):r.d2c(h,0,e[t+"calendar"]);var v=e._length;var d=new Array(v);for(var m=0;m<v;m++)d[m]=p;return[d]}function c(e,t){var r=e.length;var a=new Array(r+1);for(var n=0;n<r;n++){a[n]=e[n]-t}a[r]=e[r-1]+t;return a}function f(e){var t=new Array(e);for(var r=0;r<e;r++){t[r]=[]}return t}var h={text:"tx",hovertext:"htx"};function p(e,t,r){for(var a in h){if(o.isArrayOrTypedArray(t[a])){if(Array.isArray(r)){if(o.isArrayOrTypedArray(t[a][r[0]])){e[h[a]]=t[a][r[0]][r[1]]}}else{e[h[a]]=t[a][r]}}}}function v(e,t){if(o.isArrayOrTypedArray(t.selectedpoints)){for(var r=0;r<e.length;r++){var a=e[r].pts||[];var n={};for(var i=0;i<a.length;i++){n[a[i].i]=i}o.tagSelected(a,t,n)}}}function d(e,t){return e.v-t.v}function m(e){return e.v}function g(e,t,r){if(r===0)return e.q1;return Math.min(e.q1,t[Math.min(o.findBin(2.5*e.q1-1.5*e.q3,t,true)+1,r-1)])}function y(e,t,r){if(r===0)return e.q3;return Math.max(e.q3,t[Math.max(o.findBin(2.5*e.q3-1.5*e.q1,t),0)])}function x(e){return 4*e.q1-3*e.q3}function b(e){return 4*e.q3-3*e.q1}function _(e,t){if(t===0)return 0;return 1.57*(e.q3-e.q1)/Math.sqrt(t)}},{"../../constants/numerical":763,"../../lib":787,"../../plots/cartesian/align_period":835,"../../plots/cartesian/axes":838,"fast-isnumeric":246}],952:[function(e,t,r){"use strict";var a=e("../../plots/cartesian/axes");var n=e("../../lib");var i=e("../../plots/cartesian/constraints").getAxisGroup;var o=["v","h"];function s(e,t){var r=e.calcdata;var a=t.xaxis;var n=t.yaxis;for(var i=0;i<o.length;i++){var s=o[i];var u=s==="h"?n:a;var c=[];for(var f=0;f<r.length;f++){var h=r[f];var p=h[0].t;var v=h[0].trace;if(v.visible===true&&(v.type==="box"||v.type==="candlestick")&&!p.empty&&(v.orientation||"v")===s&&v.xaxis===a._id&&v.yaxis===n._id){c.push(f)}}l("box",e,c,u)}}function l(e,t,r,o){var s=t.calcdata;var l=t._fullLayout;var u=o._id;var c=u.charAt(0);var f,h,p;var v=[];var d=0;for(f=0;f<r.length;f++){p=s[r[f]];for(h=0;h<p.length;h++){v.push(o.c2l(p[h].pos,true));d+=(p[h].pts2||[]).length}}if(!v.length)return;var m=n.distinctVals(v);if(o.type==="category"||o.type==="multicategory"){m.minDiff=1}var g=m.minDiff/2;a.minDtick(o,m.minDiff,m.vals[0],true);var y=e==="violin"?"_numViolins":"_numBoxes";var x=l[y];var b=l[e+"mode"]==="group"&&x>1;var _=1-l[e+"gap"];var w=1-l[e+"groupgap"];for(f=0;f<r.length;f++){p=s[r[f]];var T=p[0].trace;var k=p[0].t;var M=T.width;var A=T.side;var S;var E;var L;var C;if(M){S=E=C=M/2;L=0}else{S=g;if(b){var I=i(l,o._id)+T.orientation;var P=l._alignmentOpts[I]||{};var O=P[T.alignmentgroup]||{};var z=Object.keys(O.offsetGroups||{}).length;var D=z||x;var R=z?T._offsetIndex:k.num;E=S*_*w/D;L=2*S*(-.5+(R+.5)/D)*_;C=S*_/D}else{E=S*_*w;L=0;C=S}}k.dPos=S;k.bPos=L;k.bdPos=E;k.wHover=C;var F;var B;var N=L+E;var j;var U;var V;var H;var q;var G;var Y=Boolean(M);var W=(T.boxpoints||T.points)&&d>0;if(A==="positive"){F=S*(M?1:.5);j=N;B=j=L}else if(A==="negative"){F=j=L;B=S*(M?1:.5);U=N}else{F=B=S;j=U=N}if(W){var X=T.pointpos;var Z=T.jitter;var J=T.marker.size/2;var K=0;if(X+Z>=0){K=N*(X+Z);if(K>F){Y=true;q=J;V=K}else if(K>j){q=J;V=F}}if(K<=F){V=F}var Q=0;if(X-Z<=0){Q=-N*(X-Z);if(Q>B){Y=true;G=J;H=Q}else if(Q>U){G=J;H=B}}if(Q<=B){H=B}}else{V=F;H=B}var $=new Array(p.length);for(h=0;h<p.length;h++){$[h]=p[h].pos}T._extremes[u]=a.findExtremes(o,$,{padded:Y,vpadminus:H,vpadplus:V,vpadLinearized:true,ppadminus:{x:G,y:q}[c],ppadplus:{x:q,y:G}[c]})}}t.exports={crossTraceCalc:s,setPositionOffset:l}},{"../../lib":787,"../../plots/cartesian/axes":838,"../../plots/cartesian/constraints":846}],953:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("../../registry");var i=e("../../components/color");var o=e("../scatter/period_defaults");var s=e("../bar/defaults").handleGroupingDefaults;var l=e("../../plots/cartesian/axis_autotype");var u=e("./attributes");function c(e,t,r,n){function s(r,n){return a.coerce(e,t,u,r,n)}f(e,t,s,n);if(t.visible===false)return;o(e,t,n,s);s("xhoverformat");s("yhoverformat");var l=t._hasPreCompStats;if(l){s("lowerfence");s("upperfence")}s("line.color",(e.marker||{}).color||r);s("line.width");s("fillcolor",i.addOpacity(t.line.color,.5));var c=false;if(l){var p=s("mean");var v=s("sd");if(p&&p.length){c=true;if(v&&v.length)c="sd"}}s("boxmean",c);s("whiskerwidth");s("width");s("quartilemethod");var d=false;if(l){var m=s("notchspan");if(m&&m.length){d=true}}else if(a.validate(e.notchwidth,u.notchwidth)){d=true}var g=s("notched",d);if(g)s("notchwidth");h(e,t,s,{prefix:"box"})}function f(e,t,r,i){function o(e){var t=0;if(e&&e.length){t+=1;if(a.isArrayOrTypedArray(e[0])&&e[0].length){t+=1}}return t}function s(t){return a.validate(e[t],u[t])}var c=r("y");var f=r("x");var h;if(t.type==="box"){var p=r("q1");var v=r("median");var d=r("q3");t._hasPreCompStats=p&&p.length&&v&&v.length&&d&&d.length;h=Math.min(a.minRowLength(p),a.minRowLength(v),a.minRowLength(d))}var m=o(c);var g=o(f);var y=m&&a.minRowLength(c);var x=g&&a.minRowLength(f);var b=i.calendar;var _={autotypenumbers:i.autotypenumbers};var w,T;if(t._hasPreCompStats){switch(String(g)+String(m)){case"00":var k=s("x0")||s("dx");var M=s("y0")||s("dy");if(M&&!k){w="h"}else{w="v"}T=h;break;case"10":w="v";T=Math.min(h,x);break;case"20":w="h";T=Math.min(h,f.length);break;case"01":w="h";T=Math.min(h,y);break;case"02":w="v";T=Math.min(h,c.length);break;case"12":w="v";T=Math.min(h,x,c.length);break;case"21":w="h";T=Math.min(h,f.length,y);break;case"11":T=0;break;case"22":var A=false;var S;for(S=0;S<f.length;S++){if(l(f[S],b,_)==="category"){A=true;break}}if(A){w="v";T=Math.min(h,x,c.length)}else{for(S=0;S<c.length;S++){if(l(c[S],b,_)==="category"){A=true;break}}if(A){w="h";T=Math.min(h,f.length,y)}else{w="v";T=Math.min(h,x,c.length)}}break}}else if(m>0){w="v";if(g>0){T=Math.min(x,y)}else{T=Math.min(y)}}else if(g>0){w="h";T=Math.min(x)}else{T=0}if(!T){t.visible=false;return}t._length=T;var E=r("orientation",w);if(t._hasPreCompStats){if(E==="v"&&g===0){r("x0",0);r("dx",1)}else if(E==="h"&&m===0){r("y0",0);r("dy",1)}}else{if(E==="v"&&g===0){r("x0")}else if(E==="h"&&m===0){r("y0")}}var L=n.getComponentMethod("calendars","handleTraceDefaults");L(e,t,["x","y"],i)}function h(e,t,r,n){var i=n.prefix;var o=a.coerce2(e,t,u,"marker.outliercolor");var s=r("marker.line.outliercolor");var l="outliers";if(t._hasPreCompStats){l="all"}else if(o||s){l="suspectedoutliers"}var c=r(i+"points",l);if(c){r("jitter",c==="all"?.3:0);r("pointpos",c==="all"?-1.5:0);r("marker.symbol");r("marker.opacity");r("marker.size");r("marker.color",t.line.color);r("marker.line.color");r("marker.line.width");if(c==="suspectedoutliers"){r("marker.line.outliercolor",t.marker.color);r("marker.line.outlierwidth")}r("selected.marker.color");r("unselected.marker.color");r("selected.marker.size");r("unselected.marker.size");r("text");r("hovertext")}else{delete t.marker}var f=r("hoveron");if(f==="all"||f.indexOf("points")!==-1){r("hovertemplate")}a.coerceSelectionMarkerOpacity(t,r)}function p(e,t){var r,n;function i(e){return a.coerce(n._input,n,u,e)}for(var o=0;o<e.length;o++){n=e[o];var l=n.type;if(l==="box"||l==="violin"){r=n._input;if(t[l+"mode"]==="group"){s(r,n,t,i)}}}}t.exports={supplyDefaults:c,crossTraceDefaults:p,handleSampleDefaults:f,handlePointsDefaults:h}},{"../../components/color":650,"../../lib":787,"../../plots/cartesian/axis_autotype":839,"../../registry":915,"../bar/defaults":929,"../scatter/period_defaults":1222,"./attributes":950}],954:[function(e,t,r){"use strict";t.exports=function e(t,r){if(r.hoverOnBox)t.hoverOnBox=r.hoverOnBox;if("xVal"in r)t.x=r.xVal;if("yVal"in r)t.y=r.yVal;if(r.xa)t.xaxis=r.xa;if(r.ya)t.yaxis=r.ya;return t}},{}],955:[function(e,t,r){"use strict";var a=e("../../plots/cartesian/axes");var n=e("../../lib");var i=e("../../components/fx");var o=e("../../components/color");var s=n.fillText;function l(e,t,r,a){var n=e.cd;var i=n[0].trace;var o=i.hoveron;var s=[];var l;if(o.indexOf("boxes")!==-1){s=s.concat(u(e,t,r,a))}if(o.indexOf("points")!==-1){l=c(e,t,r)}if(a==="closest"){if(l)return[l];return s}if(l){s.push(l);return s}return s}function u(e,t,r,s){var l=e.cd;var u=e.xa;var c=e.ya;var f=l[0].trace;var h=l[0].t;var p=f.type==="violin";var v=[];var d,m,g,y,x,b,_,w,T,k,M;var A=h.bdPos;var S,E;var L=h.wHover;var C=function(e){return g.c2l(e.pos)+h.bPos-g.c2l(b)};if(p&&f.side!=="both"){if(f.side==="positive"){T=function(e){var t=C(e);return i.inbox(t,t+L,k)};S=A;E=0}if(f.side==="negative"){T=function(e){var t=C(e);return i.inbox(t-L,t,k)};S=0;E=A}}else{T=function(e){var t=C(e);return i.inbox(t-L,t+L,k)};S=E=A}var I;if(p){I=function(e){return i.inbox(e.span[0]-x,e.span[1]-x,k)}}else{I=function(e){return i.inbox(e.min-x,e.max-x,k)}}if(f.orientation==="h"){x=t;b=r;_=I;w=T;d="y";g=c;m="x";y=u}else{x=r;b=t;_=T;w=I;d="x";g=u;m="y";y=c}var P=Math.min(1,A/Math.abs(g.r2c(g.range[1])-g.r2c(g.range[0])));k=e.maxHoverDistance-P;M=e.maxSpikeDistance-P;function O(e){return(_(e)+w(e))/2}var z=i.getDistanceFunction(s,_,w,O);i.getClosest(l,z,e);if(e.index===false)return[];var D=l[e.index];var R=f.line.color;var F=(f.marker||{}).color;if(o.opacity(R)&&f.line.width)e.color=R;else if(o.opacity(F)&&f.boxpoints)e.color=F;else e.color=f.fillcolor;e[d+"0"]=g.c2p(D.pos+h.bPos-E,true);e[d+"1"]=g.c2p(D.pos+h.bPos+S,true);e[d+"LabelVal"]=D.orig_p!==undefined?D.orig_p:D.pos;var B=d+"Spike";e.spikeDistance=O(D)*M/k;e[B]=g.c2p(D.pos,true);var N={};var j=["med","q1","q3","min","max"];if(f.boxmean||(f.meanline||{}).visible){j.push("mean")}if(f.boxpoints||f.points){j.push("lf","uf")}for(var U=0;U<j.length;U++){var V=j[U];if(!(V in D)||D[V]in N)continue;N[D[V]]=true;var H=D[V];var q=y.c2p(H,true);var G=n.extendFlat({},e);G.attr=V;G[m+"0"]=G[m+"1"]=q;G[m+"LabelVal"]=H;G[m+"Label"]=(h.labels?h.labels[V]+" ":"")+a.hoverLabelText(y,H,f[m+"hoverformat"]);G.hoverOnBox=true;if(V==="mean"&&"sd"in D&&f.boxmean==="sd"){G[m+"err"]=D.sd}e.name="";e.spikeDistance=undefined;e[B]=undefined;G.hovertemplate=false;v.push(G)}return v}function c(e,t,r){var a=e.cd;var o=e.xa;var l=e.ya;var u=a[0].trace;var c=o.c2p(t);var f=l.c2p(r);var h;var p=function(e){var t=Math.max(3,e.mrc||0);return Math.max(Math.abs(o.c2p(e.x)-c)-t,1-3/t)};var v=function(e){var t=Math.max(3,e.mrc||0);return Math.max(Math.abs(l.c2p(e.y)-f)-t,1-3/t)};var d=i.quadrature(p,v);var m=false;var g,y;for(var x=0;x<a.length;x++){g=a[x];for(var b=0;b<(g.pts||[]).length;b++){y=g.pts[b];var _=d(y);if(_<=e.distance){e.distance=_;m=[x,b]}}}if(!m)return false;g=a[m[0]];y=g.pts[m[1]];var w=o.c2p(y.x,true);var T=l.c2p(y.y,true);var k=y.mrc||1;h=n.extendFlat({},e,{index:y.i,color:(u.marker||{}).color,name:u.name,x0:w-k,x1:w+k,y0:T-k,y1:T+k,spikeDistance:e.distance,hovertemplate:u.hovertemplate});var M=g.orig_p;var A=M!==undefined?M:g.pos;var S;if(u.orientation==="h"){S=l;h.xLabelVal=y.x;h.yLabelVal=A}else{S=o;h.xLabelVal=A;h.yLabelVal=y.y}var E=S._id.charAt(0);h[E+"Spike"]=S.c2p(g.pos,true);s(y,u,h);return h}t.exports={hoverPoints:l,hoverOnBoxes:u,hoverOnPoints:c}},{"../../components/color":650,"../../components/fx":690,"../../lib":787,"../../plots/cartesian/axes":838}],956:[function(e,t,r){"use strict";t.exports={attributes:e("./attributes"),layoutAttributes:e("./layout_attributes"),supplyDefaults:e("./defaults").supplyDefaults,crossTraceDefaults:e("./defaults").crossTraceDefaults,supplyLayoutDefaults:e("./layout_defaults").supplyLayoutDefaults,calc:e("./calc"),crossTraceCalc:e("./cross_trace_calc").crossTraceCalc,plot:e("./plot").plot,style:e("./style").style,styleOnSelect:e("./style").styleOnSelect,hoverPoints:e("./hover").hoverPoints,eventData:e("./event_data"),selectPoints:e("./select"),moduleType:"trace",name:"box",basePlotModule:e("../../plots/cartesian"),categories:["cartesian","svg","symbols","oriented","box-violin","showLegend","boxLayout","zoomScale"],meta:{}}},{"../../plots/cartesian":852,"./attributes":950,"./calc":951,"./cross_trace_calc":952,"./defaults":953,"./event_data":954,"./hover":955,"./layout_attributes":957,"./layout_defaults":958,"./plot":959,"./select":960,"./style":961}],957:[function(e,t,r){"use strict";t.exports={boxmode:{valType:"enumerated",values:["group","overlay"],dflt:"overlay",editType:"calc"},boxgap:{valType:"number",min:0,max:1,dflt:.3,editType:"calc"},boxgroupgap:{valType:"number",min:0,max:1,dflt:.3,editType:"calc"}}},{}],958:[function(e,t,r){"use strict";var a=e("../../registry");var n=e("../../lib");var i=e("./layout_attributes");function o(e,t,r,n,i){var o=i+"Layout";var s=false;for(var l=0;l<r.length;l++){var u=r[l];if(a.traceIs(u,o)){s=true;break}}if(!s)return;n(i+"mode");n(i+"gap");n(i+"groupgap")}function s(e,t,r){function a(r,a){return n.coerce(e,t,i,r,a)}o(e,t,r,a,"box")}t.exports={supplyLayoutDefaults:s,_supply:o}},{"../../lib":787,"../../registry":915,"./layout_attributes":957}],959:[function(e,t,r){"use strict";var a=e("@plotly/d3");var n=e("../../lib");var i=e("../../components/drawing");var o=5;var s=.01;function l(e,t,r,i){var o=t.xaxis;var s=t.yaxis;n.makeTraceGroups(i,r,"trace boxes").each((function(e){var t=a.select(this);var r=e[0];var n=r.t;var i=r.trace;n.wdPos=n.bdPos*i.whiskerwidth;if(i.visible!==true||n.empty){t.remove();return}var l,h;if(i.orientation==="h"){l=s;h=o}else{l=o;h=s}u(t,{pos:l,val:h},i,n);c(t,{x:o,y:s},i,n);f(t,{pos:l,val:h},i,n)}))}function u(e,t,r,i){var o=r.orientation==="h";var s=t.val;var l=t.pos;var u=!!l.rangebreaks;var c=i.bPos;var f=i.wdPos||0;var h=i.bPosPxOffset||0;var p=r.whiskerwidth||0;var v=r.notched||false;var d=v?1-2*r.notchwidth:1;var m;var g;if(Array.isArray(i.bdPos)){m=i.bdPos[0];g=i.bdPos[1]}else{m=i.bdPos;g=i.bdPos}var y=e.selectAll("path.box").data(r.type!=="violin"||r.box.visible?n.identity:[]);y.enter().append("path").style("vector-effect","non-scaling-stroke").attr("class","box");y.exit().remove();y.each((function(e){if(e.empty)return"M0,0Z";var t=l.c2l(e.pos+c,true);var i=l.l2p(t-m)+h;var y=l.l2p(t+g)+h;var x=u?(i+y)/2:l.l2p(t)+h;var b=r.whiskerwidth;var _=u?i*b+(1-b)*x:l.l2p(t-f)+h;var w=u?y*b+(1-b)*x:l.l2p(t+f)+h;var T=l.l2p(t-m*d)+h;var k=l.l2p(t+g*d)+h;var M=s.c2p(e.q1,true);var A=s.c2p(e.q3,true);var S=n.constrain(s.c2p(e.med,true),Math.min(M,A)+1,Math.max(M,A)-1);var E=e.lf===undefined||r.boxpoints===false;var L=s.c2p(E?e.min:e.lf,true);var C=s.c2p(E?e.max:e.uf,true);var I=s.c2p(e.ln,true);var P=s.c2p(e.un,true);if(o){a.select(this).attr("d","M"+S+","+T+"V"+k+"M"+M+","+i+"V"+y+(v?"H"+I+"L"+S+","+k+"L"+P+","+y:"")+"H"+A+"V"+i+(v?"H"+P+"L"+S+","+T+"L"+I+","+i:"")+"Z"+"M"+M+","+x+"H"+L+"M"+A+","+x+"H"+C+(p===0?"":"M"+L+","+_+"V"+w+"M"+C+","+_+"V"+w))}else{a.select(this).attr("d","M"+T+","+S+"H"+k+"M"+i+","+M+"H"+y+(v?"V"+I+"L"+k+","+S+"L"+y+","+P:"")+"V"+A+"H"+i+(v?"V"+P+"L"+T+","+S+"L"+i+","+I:"")+"Z"+"M"+x+","+M+"V"+L+"M"+x+","+A+"V"+C+(p===0?"":"M"+_+","+L+"H"+w+"M"+_+","+C+"H"+w))}}))}function c(e,t,r,a){var l=t.x;var u=t.y;var c=a.bdPos;var f=a.bPos;var h=r.boxpoints||r.points;n.seedPseudoRandom();var p=function(e){e.forEach((function(e){e.t=a;e.trace=r}));return e};var v=e.selectAll("g.points").data(h?p:[]);v.enter().append("g").attr("class","points");v.exit().remove();var d=v.selectAll("path").data((function(e){var t;var a=e.pts2;var i=Math.max((e.max-e.min)/10,e.q3-e.q1);var l=i*1e-9;var u=i*s;var p=[];var v=0;var d;if(r.jitter){if(i===0){v=1;p=new Array(a.length);for(t=0;t<a.length;t++){p[t]=1}}else{for(t=0;t<a.length;t++){var m=Math.max(0,t-o);var g=a[m].v;var y=Math.min(a.length-1,t+o);var x=a[y].v;if(h!=="all"){if(a[t].v<e.lf)x=Math.min(x,e.lf);else g=Math.max(g,e.uf)}var b=Math.sqrt(u*(y-m)/(x-g+l))||0;b=n.constrain(Math.abs(b),0,1);p.push(b);v=Math.max(b,v)}}d=r.jitter*2/(v||1)}for(t=0;t<a.length;t++){var _=a[t];var w=_.v;var T=r.jitter?d*p[t]*(n.pseudoRandom()-.5):0;var k=e.pos+f+c*(r.pointpos+T);if(r.orientation==="h"){_.y=k;_.x=w}else{_.x=k;_.y=w}if(h==="suspectedoutliers"&&w<e.uo&&w>e.lo){_.so=true}}return a}));d.enter().append("path").classed("point",true);d.exit().remove();d.call(i.translatePoints,l,u)}function f(e,t,r,i){var o=t.val;var s=t.pos;var l=!!s.rangebreaks;var u=i.bPos;var c=i.bPosPxOffset||0;var f=r.boxmean||(r.meanline||{}).visible;var h;var p;if(Array.isArray(i.bdPos)){h=i.bdPos[0];p=i.bdPos[1]}else{h=i.bdPos;p=i.bdPos}var v=e.selectAll("path.mean").data(r.type==="box"&&r.boxmean||r.type==="violin"&&r.box.visible&&r.meanline.visible?n.identity:[]);v.enter().append("path").attr("class","mean").style({fill:"none","vector-effect":"non-scaling-stroke"});v.exit().remove();v.each((function(e){var t=s.c2l(e.pos+u,true);var n=s.l2p(t-h)+c;var i=s.l2p(t+p)+c;var v=l?(n+i)/2:s.l2p(t)+c;var d=o.c2p(e.mean,true);var m=o.c2p(e.mean-e.sd,true);var g=o.c2p(e.mean+e.sd,true);if(r.orientation==="h"){a.select(this).attr("d","M"+d+","+n+"V"+i+(f==="sd"?"m0,0L"+m+","+v+"L"+d+","+n+"L"+g+","+v+"Z":""))}else{a.select(this).attr("d","M"+n+","+d+"H"+i+(f==="sd"?"m0,0L"+v+","+m+"L"+n+","+d+"L"+v+","+g+"Z":""))}}))}t.exports={plot:l,plotBoxAndWhiskers:u,plotPoints:c,plotBoxMean:f}},{"../../components/drawing":672,"../../lib":787,"@plotly/d3":58}],960:[function(e,t,r){"use strict";t.exports=function e(t,r){var a=t.cd;var n=t.xaxis;var i=t.yaxis;var o=[];var s,l;if(r===false){for(s=0;s<a.length;s++){for(l=0;l<(a[s].pts||[]).length;l++){a[s].pts[l].selected=0}}}else{for(s=0;s<a.length;s++){for(l=0;l<(a[s].pts||[]).length;l++){var u=a[s].pts[l];var c=n.c2p(u.x);var f=i.c2p(u.y);if(r.contains([c,f],null,u.i,t)){o.push({pointNumber:u.i,x:n.c2d(u.x),y:i.c2d(u.y)});u.selected=1}else{u.selected=0}}}}return o}},{}],961:[function(e,t,r){"use strict";var a=e("@plotly/d3");var n=e("../../components/color");var i=e("../../components/drawing");function o(e,t,r){var o=r?r:a.select(e).selectAll("g.trace.boxes");o.style("opacity",(function(e){return e[0].trace.opacity}));o.each((function(t){var r=a.select(this);var o=t[0].trace;var s=o.line.width;function l(e,t,r,a){e.style("stroke-width",t+"px").call(n.stroke,r).call(n.fill,a)}var u=r.selectAll("path.box");if(o.type==="candlestick"){u.each((function(e){if(e.empty)return;var t=a.select(this);var r=o[e.dir];l(t,r.line.width,r.line.color,r.fillcolor);t.style("opacity",o.selectedpoints&&!e.selected?.3:1)}))}else{l(u,s,o.line.color,o.fillcolor);r.selectAll("path.mean").style({"stroke-width":s,"stroke-dasharray":2*s+"px,"+s+"px"}).call(n.stroke,o.line.color);var c=r.selectAll("path.point");i.pointStyle(c,o,e)}}))}function s(e,t,r){var a=t[0].trace;var n=r.selectAll("path.point");if(a.selectedpoints){i.selectedPointStyle(n,a)}else{i.pointStyle(n,a,e)}}t.exports={style:o,styleOnSelect:s}},{"../../components/color":650,"../../components/drawing":672,"@plotly/d3":58}],962:[function(e,t,r){"use strict";var a=e("../../lib").extendFlat;var n=e("../../plots/cartesian/axis_format_attributes").axisHoverFormat;var i=e("../ohlc/attributes");var o=e("../box/attributes");function s(e){return{line:{color:a({},o.line.color,{dflt:e}),width:o.line.width,editType:"style"},fillcolor:o.fillcolor,editType:"style"}}t.exports={xperiod:i.xperiod,xperiod0:i.xperiod0,xperiodalignment:i.xperiodalignment,xhoverformat:n("x"),yhoverformat:n("y"),x:i.x,open:i.open,high:i.high,low:i.low,close:i.close,line:{width:a({},o.line.width,{}),editType:"style"},increasing:s(i.increasing.line.color.dflt),decreasing:s(i.decreasing.line.color.dflt),text:i.text,hovertext:i.hovertext,whiskerwidth:a({},o.whiskerwidth,{dflt:0}),hoverlabel:i.hoverlabel}},{"../../lib":787,"../../plots/cartesian/axis_format_attributes":841,"../box/attributes":950,"../ohlc/attributes":1148}],963:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("../../plots/cartesian/axes");var i=e("../../plots/cartesian/align_period");var o=e("../ohlc/calc").calcCommon;t.exports=function(e,t){var r=e._fullLayout;var l=n.getFromId(e,t.xaxis);var u=n.getFromId(e,t.yaxis);var c=l.makeCalcdata(t,"x");var f=i(t,l,"x",c).vals;var h=o(e,t,c,f,u,s);if(h.length){a.extendFlat(h[0].t,{num:r._numBoxes,dPos:a.distinctVals(f).minDiff/2,posLetter:"x",valLetter:"y"});r._numBoxes++;return h}else{return[{t:{empty:true}}]}};function s(e,t,r,a){return{min:r,q1:Math.min(e,a),med:a,q3:Math.max(e,a),max:t}}},{"../../lib":787,"../../plots/cartesian/align_period":835,"../../plots/cartesian/axes":838,"../ohlc/calc":1149}],964:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("../../components/color");var i=e("../ohlc/ohlc_defaults");var o=e("../scatter/period_defaults");var s=e("./attributes");t.exports=function e(t,r,n,u){function c(e,n){return a.coerce(t,r,s,e,n)}var f=i(t,r,c,u);if(!f){r.visible=false;return}o(t,r,u,c,{x:true});c("xhoverformat");c("yhoverformat");c("line.width");l(t,r,c,"increasing");l(t,r,c,"decreasing");c("text");c("hovertext");c("whiskerwidth");u._requestRangeslider[r.xaxis]=true};function l(e,t,r,a){var i=r(a+".line.color");r(a+".line.width",t.line.width);r(a+".fillcolor",n.addOpacity(i,.5))}},{"../../components/color":650,"../../lib":787,"../ohlc/ohlc_defaults":1153,"../scatter/period_defaults":1222,"./attributes":962}],965:[function(e,t,r){"use strict";t.exports={moduleType:"trace",name:"candlestick",basePlotModule:e("../../plots/cartesian"),categories:["cartesian","svg","showLegend","candlestick","boxLayout"],meta:{},attributes:e("./attributes"),layoutAttributes:e("../box/layout_attributes"),supplyLayoutDefaults:e("../box/layout_defaults").supplyLayoutDefaults,crossTraceCalc:e("../box/cross_trace_calc").crossTraceCalc,supplyDefaults:e("./defaults"),calc:e("./calc"),plot:e("../box/plot").plot,layerName:"boxlayer",style:e("../box/style").style,hoverPoints:e("../ohlc/hover").hoverPoints,selectPoints:e("../ohlc/select")}},{"../../plots/cartesian":852,"../box/cross_trace_calc":952,"../box/layout_attributes":957,"../box/layout_defaults":958,"../box/plot":959,"../box/style":961,"../ohlc/hover":1151,"../ohlc/select":1155,"./attributes":962,"./calc":963,"./defaults":964}],966:[function(e,t,r){"use strict";var a=e("./axis_defaults");var n=e("../../plot_api/plot_template");t.exports=function e(t,r,a,n,o){var s=n("a");if(!s){n("da");n("a0")}var l=n("b");if(!l){n("db");n("b0")}i(t,r,a,o)};function i(e,t,r,i){var o=["aaxis","baxis"];o.forEach((function(o){var s=o.charAt(0);var l=e[o]||{};var u=n.newContainer(t,o);var c={tickfont:"x",id:s+"axis",letter:s,font:t.font,name:o,data:e[s],calendar:t.calendar,dfltColor:i,bgColor:r.paper_bgcolor,autotypenumbersDflt:r.autotypenumbers,fullLayout:r};a(l,u,c);u._categories=u._categories||[];if(!e[o]&&l.type!=="-"){e[o]={type:l.type}}}))}},{"../../plot_api/plot_template":827,"./axis_defaults":971}],967:[function(e,t,r){"use strict";var a=e("../../lib").isArrayOrTypedArray;t.exports=function(e){return n(e,0)};function n(e,t){if(!a(e)||t>=10){return null}var r=Infinity;var i=-Infinity;var o=e.length;for(var s=0;s<o;s++){var l=e[s];if(a(l)){var u=n(l,t+1);if(u){r=Math.min(u[0],r);i=Math.max(u[1],i)}}else{r=Math.min(l,r);i=Math.max(l,i)}}return[r,i]}},{"../../lib":787}],968:[function(e,t,r){"use strict";var a=e("../../plots/font_attributes");var n=e("./axis_attributes");var i=e("../../components/color/attributes");var o=a({editType:"calc"});o.family.dflt='"Open Sans", verdana, arial, sans-serif';o.size.dflt=12;o.color.dflt=i.defaultLine;t.exports={carpet:{valType:"string",editType:"calc"},x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},a:{valType:"data_array",editType:"calc"},a0:{valType:"number",dflt:0,editType:"calc"},da:{valType:"number",dflt:1,editType:"calc"},b:{valType:"data_array",editType:"calc"},b0:{valType:"number",dflt:0,editType:"calc"},db:{valType:"number",dflt:1,editType:"calc"},cheaterslope:{valType:"number",dflt:1,editType:"calc"},aaxis:n,baxis:n,font:o,color:{valType:"color",dflt:i.defaultLine,editType:"plot"},transforms:undefined}},{"../../components/color/attributes":649,"../../plots/font_attributes":867,"./axis_attributes":970}],969:[function(e,t,r){"use strict";var a=e("../../lib").isArrayOrTypedArray;t.exports=function(e,t,r,n){var i,o,s,l,u,c;var f,h,p,v,d,m,g;var y=a(r)?"a":"b";var x=y==="a"?e.aaxis:e.baxis;var b=x.smoothing;var _=y==="a"?e.a2i:e.b2j;var w=y==="a"?r:n;var T=y==="a"?n:r;var k=y==="a"?t.a.length:t.b.length;var M=y==="a"?t.b.length:t.a.length;var A=Math.floor(y==="a"?e.b2j(T):e.a2i(T));var S=y==="a"?function(t){return e.evalxy([],t,A)}:function(t){return e.evalxy([],A,t)};if(b){s=Math.max(0,Math.min(M-2,A));l=A-s;o=y==="a"?function(t,r){return e.dxydi([],t,s,r,l)}:function(t,r){return e.dxydj([],s,t,l,r)}}var E=_(w[0]);var L=_(w[1]);var C=E<L?1:-1;var I=(L-E)*1e-8;var P=C>0?Math.floor:Math.ceil;var O=C>0?Math.ceil:Math.floor;var z=C>0?Math.min:Math.max;var D=C>0?Math.max:Math.min;var R=P(E+I);var F=O(L-I);f=S(E);var B=[[f]];for(i=R;i*C<F*C;i+=C){u=[];d=D(E,i);m=z(L,i+C);g=m-d;c=Math.max(0,Math.min(k-2,Math.floor(.5*(d+m))));h=S(m);if(b){p=o(c,d-c);v=o(c,m-c);u.push([f[0]+p[0]/3*g,f[1]+p[1]/3*g]);u.push([h[0]-v[0]/3*g,h[1]-v[1]/3*g])}u.push(h);B.push(u);f=h}return B}},{"../../lib":787}],970:[function(e,t,r){"use strict";var a=e("../../plots/font_attributes");var n=e("../../components/color/attributes");var i=e("../../plots/cartesian/layout_attributes");var o=e("../../plots/cartesian/axis_format_attributes").descriptionWithDates;var s=e("../../plot_api/edit_types").overrideAll;t.exports={color:{valType:"color",editType:"calc"},smoothing:{valType:"number",dflt:1,min:0,max:1.3,editType:"calc"},title:{text:{valType:"string",dflt:"",editType:"calc"},font:a({editType:"calc"}),offset:{valType:"number",dflt:10,editType:"calc"},editType:"calc"},type:{valType:"enumerated",values:["-","linear","date","category"],dflt:"-",editType:"calc"},autotypenumbers:i.autotypenumbers,autorange:{valType:"enumerated",values:[true,false,"reversed"],dflt:true,editType:"calc"},rangemode:{valType:"enumerated",values:["normal","tozero","nonnegative"],dflt:"normal",editType:"calc"},range:{valType:"info_array",editType:"calc",items:[{valType:"any",editType:"calc"},{valType:"any",editType:"calc"}]},fixedrange:{valType:"boolean",dflt:false,editType:"calc"},cheatertype:{valType:"enumerated",values:["index","value"],dflt:"value",editType:"calc"},tickmode:{valType:"enumerated",values:["linear","array"],dflt:"array",editType:"calc"},nticks:{valType:"integer",min:0,dflt:0,editType:"calc"},tickvals:{valType:"data_array",editType:"calc"},ticktext:{valType:"data_array",editType:"calc"},showticklabels:{valType:"enumerated",values:["start","end","both","none"],dflt:"start",editType:"calc"},tickfont:a({editType:"calc"}),tickangle:{valType:"angle",dflt:"auto",editType:"calc"},tickprefix:{valType:"string",dflt:"",editType:"calc"},showtickprefix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"calc"},ticksuffix:{valType:"string",dflt:"",editType:"calc"},showticksuffix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"calc"},showexponent:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"calc"},exponentformat:{valType:"enumerated",values:["none","e","E","power","SI","B"],dflt:"B",editType:"calc"},minexponent:{valType:"number",dflt:3,min:0,editType:"calc"},separatethousands:{valType:"boolean",dflt:false,editType:"calc"},tickformat:{valType:"string",dflt:"",editType:"calc",description:o("tick label")},tickformatstops:s(i.tickformatstops,"calc","from-root"),categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},labelpadding:{valType:"integer",dflt:10,editType:"calc"},labelprefix:{valType:"string",editType:"calc"},labelsuffix:{valType:"string",dflt:"",editType:"calc"},showline:{valType:"boolean",dflt:false,editType:"calc"},linecolor:{valType:"color",dflt:n.defaultLine,editType:"calc"},linewidth:{valType:"number",min:0,dflt:1,editType:"calc"},gridcolor:{valType:"color",editType:"calc"},gridwidth:{valType:"number",min:0,dflt:1,editType:"calc"},showgrid:{valType:"boolean",dflt:true,editType:"calc"},minorgridcount:{valType:"integer",min:0,dflt:0,editType:"calc"},minorgridwidth:{valType:"number",min:0,dflt:1,editType:"calc"},minorgridcolor:{valType:"color",dflt:n.lightLine,editType:"calc"},startline:{valType:"boolean",editType:"calc"},startlinecolor:{valType:"color",editType:"calc"},startlinewidth:{valType:"number",dflt:1,editType:"calc"},endline:{valType:"boolean",editType:"calc"},endlinewidth:{valType:"number",dflt:1,editType:"calc"},endlinecolor:{valType:"color",editType:"calc"},tick0:{valType:"number",min:0,dflt:0,editType:"calc"},dtick:{valType:"number",min:0,dflt:1,editType:"calc"},arraytick0:{valType:"integer",min:0,dflt:0,editType:"calc"},arraydtick:{valType:"integer",min:1,dflt:1,editType:"calc"},_deprecated:{title:{valType:"string",editType:"calc"},titlefont:a({editType:"calc"}),titleoffset:{valType:"number",dflt:10,editType:"calc"}},editType:"calc"}},{"../../components/color/attributes":649,"../../plot_api/edit_types":820,"../../plots/cartesian/axis_format_attributes":841,"../../plots/cartesian/layout_attributes":853,"../../plots/font_attributes":867}],971:[function(e,t,r){"use strict";var a=e("./attributes");var n=e("../../components/color").addOpacity;var i=e("../../registry");var o=e("../../lib");var s=e("../../plots/cartesian/tick_value_defaults");var l=e("../../plots/cartesian/tick_label_defaults");var u=e("../../plots/cartesian/category_order_defaults");var c=e("../../plots/cartesian/set_convert");var f=e("../../plots/cartesian/axis_autotype");t.exports=function e(t,r,f){var p=f.letter;var v=f.font||{};var d=a[p+"axis"];function m(e,a){return o.coerce(t,r,d,e,a)}function g(e,a){return o.coerce2(t,r,d,e,a)}if(f.name){r._name=f.name;r._id=f.name}m("autotypenumbers",f.autotypenumbersDflt);var y=m("type");if(y==="-"){if(f.data)h(r,f.data);if(r.type==="-"){r.type="linear"}else{y=t.type=r.type}}m("smoothing");m("cheatertype");m("showticklabels");m("labelprefix",p+" = ");m("labelsuffix");m("showtickprefix");m("showticksuffix");m("separatethousands");m("tickformat");m("exponentformat");m("minexponent");m("showexponent");m("categoryorder");m("tickmode");m("tickvals");m("ticktext");m("tick0");m("dtick");if(r.tickmode==="array"){m("arraytick0");m("arraydtick")}m("labelpadding");r._hovertitle=p;if(y==="date"){var x=i.getComponentMethod("calendars","handleDefaults");x(t,r,"calendar",f.calendar)}c(r,f.fullLayout);r.c2p=o.identity;var b=m("color",f.dfltColor);var _=b===t.color?b:v.color;var w=m("title.text");if(w){o.coerceFont(m,"title.font",{family:v.family,size:o.bigFont(v.size),color:_});m("title.offset")}m("tickangle");var T=m("autorange",!r.isValidRange(t.range));if(T)m("rangemode");m("range");r.cleanRange();m("fixedrange");s(t,r,m,y);l(t,r,m,y,f);u(t,r,m,{data:f.data,dataAttr:p});var k=g("gridcolor",n(b,.3));var M=g("gridwidth");var A=m("showgrid");if(!A){delete r.gridcolor;delete r.gridwidth}var S=g("startlinecolor",b);var E=g("startlinewidth",M);var L=m("startline",r.showgrid||!!S||!!E);if(!L){delete r.startlinecolor;delete r.startlinewidth}var C=g("endlinecolor",b);var I=g("endlinewidth",M);var P=m("endline",r.showgrid||!!C||!!I);if(!P){delete r.endlinecolor;delete r.endlinewidth}if(!A){delete r.gridcolor;delete r.gridWidth}else{m("minorgridcount");m("minorgridwidth",M);m("minorgridcolor",n(k,.06));if(!r.minorgridcount){delete r.minorgridwidth;delete r.minorgridcolor}}if(r.showticklabels==="none"){delete r.tickfont;delete r.tickangle;delete r.showexponent;delete r.exponentformat;delete r.minexponent;delete r.tickformat;delete r.showticksuffix;delete r.showtickprefix}if(!r.showticksuffix){delete r.ticksuffix}if(!r.showtickprefix){delete r.tickprefix}m("tickmode");return r};function h(e,t){if(e.type!=="-")return;var r=e._id;var a=r.charAt(0);var n=a+"calendar";var i=e[n];e.type=f(t,i,{autotypenumbers:e.autotypenumbers})}},{"../../components/color":650,"../../lib":787,"../../plots/cartesian/axis_autotype":839,"../../plots/cartesian/category_order_defaults":843,"../../plots/cartesian/set_convert":859,"../../plots/cartesian/tick_label_defaults":860,"../../plots/cartesian/tick_value_defaults":862,"../../registry":915,"./attributes":968}],972:[function(e,t,r){"use strict";var a=e("../../plots/cartesian/axes");var n=e("../../lib").isArray1D;var i=e("./cheater_basis");var o=e("./array_minmax");var s=e("./calc_gridlines");var l=e("./calc_labels");var u=e("./calc_clippath");var c=e("../heatmap/clean_2d_array");var f=e("./smooth_fill_2d_array");var h=e("../heatmap/convert_column_xyz");var p=e("./set_convert");t.exports=function e(t,r){var v=a.getFromId(t,r.xaxis);var d=a.getFromId(t,r.yaxis);var m=r.aaxis;var g=r.baxis;var y=r.x;var x=r.y;var b=[];if(y&&n(y))b.push("x");if(x&&n(x))b.push("y");if(b.length){h(r,m,g,"a","b",b)}var _=r._a=r._a||r.a;var w=r._b=r._b||r.b;y=r._x||r.x;x=r._y||r.y;var T={};if(r._cheater){var k=m.cheatertype==="index"?_.length:_;var M=g.cheatertype==="index"?w.length:w;y=i(k,M,r.cheaterslope)}r._x=y=c(y);r._y=x=c(x);f(y,_,w);f(x,_,w);p(r);r.setScale();var A=o(y);var S=o(x);var E=.5*(A[1]-A[0]);var L=.5*(A[1]+A[0]);var C=.5*(S[1]-S[0]);var I=.5*(S[1]+S[0]);var P=1.3;A=[L-E*P,L+E*P];S=[I-C*P,I+C*P];r._extremes[v._id]=a.findExtremes(v,A,{padded:true});r._extremes[d._id]=a.findExtremes(d,S,{padded:true});s(r,"a","b");s(r,"b","a");l(r,m);l(r,g);T.clipsegments=u(r._xctrl,r._yctrl,m,g);T.x=y;T.y=x;T.a=_;T.b=w;return[T]}},{"../../lib":787,"../../plots/cartesian/axes":838,"../heatmap/clean_2d_array":1071,"../heatmap/convert_column_xyz":1073,"./array_minmax":967,"./calc_clippath":973,"./calc_gridlines":974,"./calc_labels":975,"./cheater_basis":977,"./set_convert":990,"./smooth_fill_2d_array":991}],973:[function(e,t,r){"use strict";t.exports=function e(t,r,a,n){var i,o,s;var l=[];var u=!!a.smoothing;var c=!!n.smoothing;var f=t[0].length-1;var h=t.length-1;for(i=0,o=[],s=[];i<=f;i++){o[i]=t[0][i];s[i]=r[0][i]}l.push({x:o,y:s,bicubic:u});for(i=0,o=[],s=[];i<=h;i++){o[i]=t[i][f];s[i]=r[i][f]}l.push({x:o,y:s,bicubic:c});for(i=f,o=[],s=[];i>=0;i--){o[f-i]=t[h][i];s[f-i]=r[h][i]}l.push({x:o,y:s,bicubic:u});for(i=h,o=[],s=[];i>=0;i--){o[h-i]=t[i][0];s[h-i]=r[i][0]}l.push({x:o,y:s,bicubic:c});return l}},{}],974:[function(e,t,r){"use strict";var a=e("../../plots/cartesian/axes");var n=e("../../lib/extend").extendFlat;t.exports=function e(t,r,i){var o,s,l;var u,c,f,h,p,v,d;var m,g,y,x;var b=t["_"+r];var _=t[r+"axis"];var w=_._gridlines=[];var T=_._minorgridlines=[];var k=_._boundarylines=[];var M=t["_"+i];var A=t[i+"axis"];if(_.tickmode==="array"){_.tickvals=b.slice()}var S=t._xctrl;var E=t._yctrl;var L=S[0].length;var C=S.length;var I=t._a.length;var P=t._b.length;a.prepTicks(_);if(_.tickmode==="array")delete _.tickvals;var O=_.smoothing?3:1;function z(e){var a,n,o,s,l,u,c,f,h,v,d,m;var g=[];var y=[];var x={};if(r==="b"){n=t.b2j(e);o=Math.floor(Math.max(0,Math.min(P-2,n)));s=n-o;x.length=P;x.crossLength=I;x.xy=function(e){return t.evalxy([],e,n)};x.dxy=function(e,r){return t.dxydi([],e,o,r,s)};for(a=0;a<I;a++){u=Math.min(I-2,a);c=a-u;f=t.evalxy([],a,n);if(A.smoothing&&a>0){h=t.dxydi([],a-1,o,0,s);g.push(l[0]+h[0]/3);y.push(l[1]+h[1]/3);v=t.dxydi([],a-1,o,1,s);g.push(f[0]-v[0]/3);y.push(f[1]-v[1]/3)}g.push(f[0]);y.push(f[1]);l=f}}else{a=t.a2i(e);u=Math.floor(Math.max(0,Math.min(I-2,a)));c=a-u;x.length=I;x.crossLength=P;x.xy=function(e){return t.evalxy([],a,e)};x.dxy=function(e,r){return t.dxydj([],u,e,c,r)};for(n=0;n<P;n++){o=Math.min(P-2,n);s=n-o;f=t.evalxy([],a,n);if(A.smoothing&&n>0){d=t.dxydj([],u,n-1,c,0);g.push(l[0]+d[0]/3);y.push(l[1]+d[1]/3);m=t.dxydj([],u,n-1,c,1);g.push(f[0]-m[0]/3);y.push(f[1]-m[1]/3)}g.push(f[0]);y.push(f[1]);l=f}}x.axisLetter=r;x.axis=_;x.crossAxis=A;x.value=e;x.constvar=i;x.index=p;x.x=g;x.y=y;x.smoothing=A.smoothing;return x}function D(e){var a,n,o,s,l;var u=[];var c=[];var f={};f.length=b.length;f.crossLength=M.length;if(r==="b"){o=Math.max(0,Math.min(P-2,e));l=Math.min(1,Math.max(0,e-o));f.xy=function(r){return t.evalxy([],r,e)};f.dxy=function(e,r){return t.dxydi([],e,o,r,l)};for(a=0;a<L;a++){u[a]=S[e*O][a];c[a]=E[e*O][a]}}else{n=Math.max(0,Math.min(I-2,e));s=Math.min(1,Math.max(0,e-n));f.xy=function(r){return t.evalxy([],e,r)};f.dxy=function(e,r){return t.dxydj([],n,e,s,r)};for(a=0;a<C;a++){u[a]=S[a][e*O];c[a]=E[a][e*O]}}f.axisLetter=r;f.axis=_;f.crossAxis=A;f.value=b[e];f.constvar=i;f.index=e;f.x=u;f.y=c;f.smoothing=A.smoothing;return f}if(_.tickmode==="array"){u=5e-15;c=[Math.floor((b.length-1-_.arraytick0)/_.arraydtick*(1+u)),Math.ceil(-_.arraytick0/_.arraydtick/(1+u))].sort((function(e,t){return e-t}));f=c[0]-1;h=c[1]+1;for(p=f;p<h;p++){s=_.arraytick0+_.arraydtick*p;if(s<0||s>b.length-1)continue;w.push(n(D(s),{color:_.gridcolor,width:_.gridwidth}))}for(p=f;p<h;p++){l=_.arraytick0+_.arraydtick*p;m=Math.min(l+_.arraydtick,b.length-1);if(l<0||l>b.length-1)continue;if(m<0||m>b.length-1)continue;g=b[l];y=b[m];for(o=0;o<_.minorgridcount;o++){x=m-l;if(x<=0)continue;d=g+(y-g)*(o+1)/(_.minorgridcount+1)*(_.arraydtick/x);if(d<b[0]||d>b[b.length-1])continue;T.push(n(z(d),{color:_.minorgridcolor,width:_.minorgridwidth}))}}if(_.startline){k.push(n(D(0),{color:_.startlinecolor,width:_.startlinewidth}))}if(_.endline){k.push(n(D(b.length-1),{color:_.endlinecolor,width:_.endlinewidth}))}}else{u=5e-15;c=[Math.floor((b[b.length-1]-_.tick0)/_.dtick*(1+u)),Math.ceil((b[0]-_.tick0)/_.dtick/(1+u))].sort((function(e,t){return e-t}));f=c[0];h=c[1];for(p=f;p<=h;p++){v=_.tick0+_.dtick*p;w.push(n(z(v),{color:_.gridcolor,width:_.gridwidth}))}for(p=f-1;p<h+1;p++){v=_.tick0+_.dtick*p;for(o=0;o<_.minorgridcount;o++){d=v+_.dtick*(o+1)/(_.minorgridcount+1);if(d<b[0]||d>b[b.length-1])continue;T.push(n(z(d),{color:_.minorgridcolor,width:_.minorgridwidth}))}}if(_.startline){k.push(n(z(b[0]),{color:_.startlinecolor,width:_.startlinewidth}))}if(_.endline){k.push(n(z(b[b.length-1]),{color:_.endlinecolor,width:_.endlinewidth}))}}}},{"../../lib/extend":777,"../../plots/cartesian/axes":838}],975:[function(e,t,r){"use strict";var a=e("../../plots/cartesian/axes");var n=e("../../lib/extend").extendFlat;t.exports=function e(t,r){var i,o,s,l,u;var c=r._labels=[];var f=r._gridlines;for(i=0;i<f.length;i++){u=f[i];if(["start","both"].indexOf(r.showticklabels)!==-1){o=a.tickText(r,u.value);n(o,{prefix:s,suffix:l,endAnchor:true,xy:u.xy(0),dxy:u.dxy(0,0),axis:u.axis,length:u.crossAxis.length,font:u.axis.tickfont,isFirst:i===0,isLast:i===f.length-1});c.push(o)}if(["end","both"].indexOf(r.showticklabels)!==-1){o=a.tickText(r,u.value);n(o,{endAnchor:false,xy:u.xy(u.crossLength-1),dxy:u.dxy(u.crossLength-2,1),axis:u.axis,length:u.crossAxis.length,font:u.axis.tickfont,isFirst:i===0,isLast:i===f.length-1});c.push(o)}}}},{"../../lib/extend":777,"../../plots/cartesian/axes":838}],976:[function(e,t,r){"use strict";var a=.5;t.exports=function e(t,r,n,i){var o=t[0]-r[0];var s=t[1]-r[1];var l=n[0]-r[0];var u=n[1]-r[1];var c=Math.pow(o*o+s*s,a/2);var f=Math.pow(l*l+u*u,a/2);var h=(f*f*o-c*c*l)*i;var p=(f*f*s-c*c*u)*i;var v=f*(c+f)*3;var d=c*(c+f)*3;return[[r[0]+(v&&h/v),r[1]+(v&&p/v)],[r[0]-(d&&h/d),r[1]-(d&&p/d)]]}},{}],977:[function(e,t,r){"use strict";var a=e("../../lib").isArrayOrTypedArray;t.exports=function(e,t,r){var n,i,o,s,l,u;var c=[];var f=a(e)?e.length:e;var h=a(t)?t.length:t;var p=a(e)?e:null;var v=a(t)?t:null;if(p){o=(p.length-1)/(p[p.length-1]-p[0])/(f-1)}if(v){s=(v.length-1)/(v[v.length-1]-v[0])/(h-1)}var d;var m=Infinity;var g=-Infinity;for(i=0;i<h;i++){c[i]=[];u=v?(v[i]-v[0])*s:i/(h-1);for(n=0;n<f;n++){l=p?(p[n]-p[0])*o:n/(f-1);d=l-u*r;m=Math.min(d,m);g=Math.max(d,g);c[i][n]=d}}var y=1/(g-m);var x=-m*y;for(i=0;i<h;i++){for(n=0;n<f;n++){c[i][n]=y*c[i][n]+x}}return c}},{"../../lib":787}],978:[function(e,t,r){"use strict";var a=e("./catmull_rom");var n=e("../../lib").ensureArray;function i(e,t,r){var a=-.5*r[0]+1.5*t[0];var n=-.5*r[1]+1.5*t[1];return[(2*a+e[0])/3,(2*n+e[1])/3]}t.exports=function e(t,r,o,s,l,u){var c,f,h,p,v,d,m,g,y,x;var b=o[0].length;var _=o.length;var w=l?3*b-2:b;var T=u?3*_-2:_;t=n(t,T);r=n(r,T);for(h=0;h<T;h++){t[h]=n(t[h],w);r[h]=n(r[h],w)}for(f=0,p=0;f<_;f++,p+=u?3:1){v=t[p];d=r[p];m=o[f];g=s[f];for(c=0,h=0;c<b;c++,h+=l?3:1){v[h]=m[c];d[h]=g[c]}}if(l){for(f=0,p=0;f<_;f++,p+=u?3:1){for(c=1,h=3;c<b-1;c++,h+=3){y=a([o[f][c-1],s[f][c-1]],[o[f][c],s[f][c]],[o[f][c+1],s[f][c+1]],l);t[p][h-1]=y[0][0];r[p][h-1]=y[0][1];t[p][h+1]=y[1][0];r[p][h+1]=y[1][1]}x=i([t[p][0],r[p][0]],[t[p][2],r[p][2]],[t[p][3],r[p][3]]);t[p][1]=x[0];r[p][1]=x[1];x=i([t[p][w-1],r[p][w-1]],[t[p][w-3],r[p][w-3]],[t[p][w-4],r[p][w-4]]);t[p][w-2]=x[0];r[p][w-2]=x[1]}}if(u){for(h=0;h<w;h++){for(p=3;p<T-3;p+=3){y=a([t[p-3][h],r[p-3][h]],[t[p][h],r[p][h]],[t[p+3][h],r[p+3][h]],u);t[p-1][h]=y[0][0];r[p-1][h]=y[0][1];t[p+1][h]=y[1][0];r[p+1][h]=y[1][1]}x=i([t[0][h],r[0][h]],[t[2][h],r[2][h]],[t[3][h],r[3][h]]);t[1][h]=x[0];r[1][h]=x[1];x=i([t[T-1][h],r[T-1][h]],[t[T-3][h],r[T-3][h]],[t[T-4][h],r[T-4][h]]);t[T-2][h]=x[0];r[T-2][h]=x[1]}}if(l&&u){for(p=1;p<T;p+=(p+1)%3===0?2:1){for(h=3;h<w-3;h+=3){y=a([t[p][h-3],r[p][h-3]],[t[p][h],r[p][h]],[t[p][h+3],r[p][h+3]],l);t[p][h-1]=.5*(t[p][h-1]+y[0][0]);r[p][h-1]=.5*(r[p][h-1]+y[0][1]);t[p][h+1]=.5*(t[p][h+1]+y[1][0]);r[p][h+1]=.5*(r[p][h+1]+y[1][1])}x=i([t[p][0],r[p][0]],[t[p][2],r[p][2]],[t[p][3],r[p][3]]);t[p][1]=.5*(t[p][1]+x[0]);r[p][1]=.5*(r[p][1]+x[1]);x=i([t[p][w-1],r[p][w-1]],[t[p][w-3],r[p][w-3]],[t[p][w-4],r[p][w-4]]);t[p][w-2]=.5*(t[p][w-2]+x[0]);r[p][w-2]=.5*(r[p][w-2]+x[1])}}return[t,r]}},{"../../lib":787,"./catmull_rom":976}],979:[function(e,t,r){"use strict";t.exports={RELATIVE_CULL_TOLERANCE:1e-6}},{}],980:[function(e,t,r){"use strict";t.exports=function(e,t,r){if(t&&r){return function(t,r,a,n,i){if(!t)t=[];var o,s,l,u,c,f;r*=3;a*=3;var h=n*n;var p=1-n;var v=p*p;var d=p*n*2;var m=-3*v;var g=3*(v-d);var y=3*(d-h);var x=3*h;var b=i*i;var _=b*i;var w=1-i;var T=w*w;var k=T*w;for(f=0;f<e.length;f++){c=e[f];o=m*c[a][r]+g*c[a][r+1]+y*c[a][r+2]+x*c[a][r+3];s=m*c[a+1][r]+g*c[a+1][r+1]+y*c[a+1][r+2]+x*c[a+1][r+3];l=m*c[a+2][r]+g*c[a+2][r+1]+y*c[a+2][r+2]+x*c[a+2][r+3];u=m*c[a+3][r]+g*c[a+3][r+1]+y*c[a+3][r+2]+x*c[a+3][r+3];t[f]=k*o+3*(T*i*s+w*b*l)+_*u}return t}}else if(t){return function(t,r,a,n,i){if(!t)t=[];var o,s,l,u;r*=3;var c=n*n;var f=1-n;var h=f*f;var p=f*n*2;var v=-3*h;var d=3*(h-p);var m=3*(p-c);var g=3*c;var y=1-i;for(l=0;l<e.length;l++){u=e[l];o=v*u[a][r]+d*u[a][r+1]+m*u[a][r+2]+g*u[a][r+3];s=v*u[a+1][r]+d*u[a+1][r+1]+m*u[a+1][r+2]+g*u[a+1][r+3];t[l]=y*o+i*s}return t}}else if(r){return function(t,r,a,n,i){if(!t)t=[];var o,s,l,u,c,f;a*=3;var h=i*i;var p=h*i;var v=1-i;var d=v*v;var m=d*v;for(c=0;c<e.length;c++){f=e[c];o=f[a][r+1]-f[a][r];s=f[a+1][r+1]-f[a+1][r];l=f[a+2][r+1]-f[a+2][r];u=f[a+3][r+1]-f[a+3][r];t[c]=m*o+3*(d*i*s+v*h*l)+p*u}return t}}else{return function(t,r,a,n,i){if(!t)t=[];var o,s,l,u;var c=1-i;for(l=0;l<e.length;l++){u=e[l];o=u[a][r+1]-u[a][r];s=u[a+1][r+1]-u[a+1][r];t[l]=c*o+i*s}return t}}}},{}],981:[function(e,t,r){"use strict";t.exports=function(e,t,r){if(t&&r){return function(t,r,a,n,i){if(!t)t=[];var o,s,l,u,c,f;r*=3;a*=3;var h=n*n;var p=h*n;var v=1-n;var d=v*v;var m=d*v;var g=i*i;var y=1-i;var x=y*y;var b=y*i*2;var _=-3*x;var w=3*(x-b);var T=3*(b-g);var k=3*g;for(f=0;f<e.length;f++){c=e[f];o=_*c[a][r]+w*c[a+1][r]+T*c[a+2][r]+k*c[a+3][r];s=_*c[a][r+1]+w*c[a+1][r+1]+T*c[a+2][r+1]+k*c[a+3][r+1];l=_*c[a][r+2]+w*c[a+1][r+2]+T*c[a+2][r+2]+k*c[a+3][r+2];u=_*c[a][r+3]+w*c[a+1][r+3]+T*c[a+2][r+3]+k*c[a+3][r+3];t[f]=m*o+3*(d*n*s+v*h*l)+p*u}return t}}else if(t){return function(t,r,a,n,i){if(!t)t=[];var o,s,l,u,c,f;r*=3;var h=i*i;var p=h*i;var v=1-i;var d=v*v;var m=d*v;for(c=0;c<e.length;c++){f=e[c];o=f[a+1][r]-f[a][r];s=f[a+1][r+1]-f[a][r+1];l=f[a+1][r+2]-f[a][r+2];u=f[a+1][r+3]-f[a][r+3];t[c]=m*o+3*(d*i*s+v*h*l)+p*u}return t}}else if(r){return function(t,r,a,n,i){if(!t)t=[];var o,s,l,u;a*=3;var c=1-n;var f=i*i;var h=1-i;var p=h*h;var v=h*i*2;var d=-3*p;var m=3*(p-v);var g=3*(v-f);var y=3*f;for(l=0;l<e.length;l++){u=e[l];o=d*u[a][r]+m*u[a+1][r]+g*u[a+2][r]+y*u[a+3][r];s=d*u[a][r+1]+m*u[a+1][r+1]+g*u[a+2][r+1]+y*u[a+3][r+1];t[l]=c*o+n*s}return t}}else{return function(t,r,a,n,i){if(!t)t=[];var o,s,l,u;var c=1-n;for(l=0;l<e.length;l++){u=e[l];o=u[a+1][r]-u[a][r];s=u[a+1][r+1]-u[a][r+1];t[l]=c*o+n*s}return t}}}},{}],982:[function(e,t,r){"use strict";t.exports=function(e,t,r,a,n){var i=t-2;var o=r-2;if(a&&n){return function(t,r,a){if(!t)t=[];var n,s,l,u,c,f;var h=Math.max(0,Math.min(Math.floor(r),i));var p=Math.max(0,Math.min(Math.floor(a),o));var v=Math.max(0,Math.min(1,r-h));var d=Math.max(0,Math.min(1,a-p));h*=3;p*=3;var m=v*v;var g=m*v;var y=1-v;var x=y*y;var b=x*y;var _=d*d;var w=_*d;var T=1-d;var k=T*T;var M=k*T;for(f=0;f<e.length;f++){c=e[f];n=b*c[p][h]+3*(x*v*c[p][h+1]+y*m*c[p][h+2])+g*c[p][h+3];s=b*c[p+1][h]+3*(x*v*c[p+1][h+1]+y*m*c[p+1][h+2])+g*c[p+1][h+3];l=b*c[p+2][h]+3*(x*v*c[p+2][h+1]+y*m*c[p+2][h+2])+g*c[p+2][h+3];u=b*c[p+3][h]+3*(x*v*c[p+3][h+1]+y*m*c[p+3][h+2])+g*c[p+3][h+3];t[f]=M*n+3*(k*d*s+T*_*l)+w*u}return t}}else if(a){return function(t,r,a){if(!t)t=[];var n=Math.max(0,Math.min(Math.floor(r),i));var s=Math.max(0,Math.min(Math.floor(a),o));var l=Math.max(0,Math.min(1,r-n));var u=Math.max(0,Math.min(1,a-s));var c,f,h,p,v,d;n*=3;var m=l*l;var g=m*l;var y=1-l;var x=y*y;var b=x*y;var _=1-u;for(v=0;v<e.length;v++){d=e[v];c=_*d[s][n]+u*d[s+1][n];f=_*d[s][n+1]+u*d[s+1][n+1];h=_*d[s][n+2]+u*d[s+1][n+1];p=_*d[s][n+3]+u*d[s+1][n+1];t[v]=b*c+3*(x*l*f+y*m*h)+g*p}return t}}else if(n){return function(t,r,a){if(!t)t=[];var n=Math.max(0,Math.min(Math.floor(r),i));var s=Math.max(0,Math.min(Math.floor(a),o));var l=Math.max(0,Math.min(1,r-n));var u=Math.max(0,Math.min(1,a-s));var c,f,h,p,v,d;s*=3;var m=u*u;var g=m*u;var y=1-u;var x=y*y;var b=x*y;var _=1-l;for(v=0;v<e.length;v++){d=e[v];c=_*d[s][n]+l*d[s][n+1];f=_*d[s+1][n]+l*d[s+1][n+1];h=_*d[s+2][n]+l*d[s+2][n+1];p=_*d[s+3][n]+l*d[s+3][n+1];t[v]=b*c+3*(x*u*f+y*m*h)+g*p}return t}}else{return function(t,r,a){if(!t)t=[];var n=Math.max(0,Math.min(Math.floor(r),i));var s=Math.max(0,Math.min(Math.floor(a),o));var l=Math.max(0,Math.min(1,r-n));var u=Math.max(0,Math.min(1,a-s));var c,f,h,p;var v=1-u;var d=1-l;for(h=0;h<e.length;h++){p=e[h];c=d*p[s][n]+l*p[s][n+1];f=d*p[s+1][n]+l*p[s+1][n+1];t[h]=v*c+u*f}return t}}}},{}],983:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("./xy_defaults");var i=e("./ab_defaults");var o=e("./attributes");var s=e("../../components/color/attributes");t.exports=function e(t,r,l,u){function c(e,n){return a.coerce(t,r,o,e,n)}r._clipPathId="clip"+r.uid+"carpet";var f=c("color",s.defaultLine);a.coerceFont(c,"font");c("carpet");i(t,r,u,c,f);if(!r.a||!r.b){r.visible=false;return}if(r.a.length<3){r.aaxis.smoothing=0}if(r.b.length<3){r.baxis.smoothing=0}var h=n(t,r,c);if(!h){r.visible=false}if(r._cheater){c("cheaterslope")}}},{"../../components/color/attributes":649,"../../lib":787,"./ab_defaults":966,"./attributes":968,"./xy_defaults":992}],984:[function(e,t,r){"use strict";t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),plot:e("./plot"),calc:e("./calc"),animatable:true,isContainer:true,moduleType:"trace",name:"carpet",basePlotModule:e("../../plots/cartesian"),categories:["cartesian","svg","carpet","carpetAxis","notLegendIsolatable","noMultiCategory","noHover","noSortingByValue"],meta:{}}},{"../../plots/cartesian":852,"./attributes":968,"./calc":972,"./defaults":983,"./plot":989}],985:[function(e,t,r){"use strict";t.exports=function(e,t){var r=e._fullData.length;var a;for(var n=0;n<r;n++){var i=e._fullData[n];if(i.index===t.index)continue;if(i.type==="carpet"){if(!a){a=i}if(i.carpet===t.carpet){return i}}}return a}},{}],986:[function(e,t,r){"use strict";t.exports=function e(t,r,a){if(t.length===0)return"";var n;var i=[];var o=a?3:1;for(n=0;n<t.length;n+=o){i.push(t[n]+","+r[n]);if(a&&n<t.length-o){i.push("C");i.push([t[n+1]+","+r[n+1],t[n+2]+","+r[n+2]+" "].join(" "))}}return i.join(a?"":"L")}},{}],987:[function(e,t,r){"use strict";var a=e("../../lib").isArrayOrTypedArray;t.exports=function e(t,r,n){var i;if(!a(t)){t=[]}else if(t.length>r.length){t=t.slice(0,r.length)}for(i=0;i<r.length;i++){t[i]=n(r[i])}return t}},{"../../lib":787}],988:[function(e,t,r){"use strict";t.exports=function e(t,r,a,n,i,o){var s=i[0]*t.dpdx(r);var l=i[1]*t.dpdy(a);var u=1;var c=1;if(o){var f=Math.sqrt(i[0]*i[0]+i[1]*i[1]);var h=Math.sqrt(o[0]*o[0]+o[1]*o[1]);var p=(i[0]*o[0]+i[1]*o[1])/f/h;c=Math.max(0,p)}var v=Math.atan2(l,s)*180/Math.PI;if(v<-90){v+=180;u=-u}else if(v>90){v-=180;u=-u}return{angle:v,flip:u,p:t.c2p(n,r,a),offsetMultplier:c}}},{}],989:[function(e,t,r){"use strict";var a=e("@plotly/d3");var n=e("../../components/drawing");var i=e("./map_1d_array");var o=e("./makepath");var s=e("./orient_text");var l=e("../../lib/svg_text_utils");var u=e("../../lib");var c=u.strRotate;var f=u.strTranslate;var h=e("../../constants/alignment");t.exports=function e(t,r,n,i){var o=r.xaxis;var s=r.yaxis;var l=t._fullLayout;var c=l._clips;u.makeTraceGroups(i,n,"trace").each((function(e){var r=a.select(this);var n=e[0];var i=n.trace;var l=i.aaxis;var f=i.baxis;var h=u.ensureSingle(r,"g","minorlayer");var g=u.ensureSingle(r,"g","majorlayer");var y=u.ensureSingle(r,"g","boundarylayer");var x=u.ensureSingle(r,"g","labellayer");r.style("opacity",i.opacity);v(o,s,g,l,"a",l._gridlines,true);v(o,s,g,f,"b",f._gridlines,true);v(o,s,h,l,"a",l._minorgridlines,true);v(o,s,h,f,"b",f._minorgridlines,true);v(o,s,y,l,"a-boundary",l._boundarylines);v(o,s,y,f,"b-boundary",f._boundarylines);var b=d(t,o,s,i,n,x,l._labels,"a-label");var _=d(t,o,s,i,n,x,f._labels,"b-label");m(t,x,i,n,o,s,b,_);p(i,n,c,o,s)}))};function p(e,t,r,a,n){var s,l,c,f;var h=r.select("#"+e._clipPathId);if(!h.size()){h=r.append("clipPath").classed("carpetclip",true)}var p=u.ensureSingle(h,"path","carpetboundary");var v=t.clipsegments;var d=[];for(f=0;f<v.length;f++){s=v[f];l=i([],s.x,a.c2p);c=i([],s.y,n.c2p);d.push(o(l,c,s.bicubic))}var m="M"+d.join("L")+"Z";h.attr("id",e._clipPathId);p.attr("d",m)}function v(e,t,r,n,s,l){var u="const-"+s+"-lines";var c=r.selectAll("."+u).data(l);c.enter().append("path").classed(u,true).style("vector-effect","non-scaling-stroke");c.each((function(r){var n=r;var s=n.x;var l=n.y;var u=i([],s,e.c2p);var c=i([],l,t.c2p);var f="M"+o(u,c,n.smoothing);var h=a.select(this);h.attr("d",f).style("stroke-width",n.width).style("stroke",n.color).style("fill","none")}));c.exit().remove()}function d(e,t,r,i,o,u,h,p){var v=u.selectAll("text."+p).data(h);v.enter().append("text").classed(p,true);var d=0;var m={};v.each((function(o,u){var h;if(o.axis.tickangle==="auto"){h=s(i,t,r,o.xy,o.dxy)}else{var p=(o.axis.tickangle+180)*Math.PI/180;h=s(i,t,r,o.xy,[Math.cos(p),Math.sin(p)])}if(!u){m={angle:h.angle,flip:h.flip}}var v=(o.endAnchor?-1:1)*h.flip;var g=a.select(this).attr({"text-anchor":v>0?"start":"end","data-notex":1}).call(n.font,o.font).text(o.text).call(l.convertToTspans,e);var y=n.bBox(this);g.attr("transform",f(h.p[0],h.p[1])+c(h.angle)+f(o.axis.labelpadding*v,y.height*.3));d=Math.max(d,y.width+o.axis.labelpadding)}));v.exit().remove();m.maxExtent=d;return m}function m(e,t,r,a,n,i,o,l){var c,f,h,p;var v=u.aggNums(Math.min,null,r.a);var d=u.aggNums(Math.max,null,r.a);var m=u.aggNums(Math.min,null,r.b);var g=u.aggNums(Math.max,null,r.b);c=.5*(v+d);f=m;h=r.ab2xy(c,f,true);p=r.dxyda_rough(c,f);if(o.angle===undefined){u.extendFlat(o,s(r,n,i,h,r.dxydb_rough(c,f)))}x(e,t,r,a,h,p,r.aaxis,n,i,o,"a-title");c=v;f=.5*(m+g);h=r.ab2xy(c,f,true);p=r.dxydb_rough(c,f);if(l.angle===undefined){u.extendFlat(l,s(r,n,i,h,r.dxyda_rough(c,f)))}x(e,t,r,a,h,p,r.baxis,n,i,l,"b-title")}var g=h.LINE_SPACING;var y=(1-h.MID_SHIFT)/g+1;function x(e,t,r,i,o,u,h,p,v,d,m){var x=[];if(h.title.text)x.push(h.title.text);var b=t.selectAll("text."+m).data(x);var _=d.maxExtent;b.enter().append("text").classed(m,true);b.each((function(){var t=s(r,p,v,o,u);if(["start","both"].indexOf(h.showticklabels)===-1){_=0}var i=h.title.font.size;_+=i+h.title.offset;var m=d.angle+(d.flip<0?180:0);var x=(m-t.angle+450)%360;var b=x>90&&x<270;var w=a.select(this);w.text(h.title.text).call(l.convertToTspans,e);if(b){_=(-l.lineCount(w)+y)*g*i-_}w.attr("transform",f(t.p[0],t.p[1])+c(t.angle)+f(0,_)).attr("text-anchor","middle").call(n.font,h.title.font)}));b.exit().remove()}},{"../../components/drawing":672,"../../constants/alignment":755,"../../lib":787,"../../lib/svg_text_utils":813,"./makepath":986,"./map_1d_array":987,"./orient_text":988,"@plotly/d3":58}],990:[function(e,t,r){"use strict";var a=e("./constants");var n=e("../../lib/search").findBin;var i=e("./compute_control_points");var o=e("./create_spline_evaluator");var s=e("./create_i_derivative_evaluator");var l=e("./create_j_derivative_evaluator");t.exports=function e(t){var r=t._a;var u=t._b;var c=r.length;var f=u.length;var h=t.aaxis;var p=t.baxis;var v=r[0];var d=r[c-1];var m=u[0];var g=u[f-1];var y=r[r.length-1]-r[0];var x=u[u.length-1]-u[0];var b=y*a.RELATIVE_CULL_TOLERANCE;var _=x*a.RELATIVE_CULL_TOLERANCE;v-=b;d+=b;m-=_;g+=_;t.isVisible=function(e,t){return e>v&&e<d&&t>m&&t<g};t.isOccluded=function(e,t){return e<v||e>d||t<m||t>g};t.setScale=function(){var e=t._x;var r=t._y;var a=i(t._xctrl,t._yctrl,e,r,h.smoothing,p.smoothing);t._xctrl=a[0];t._yctrl=a[1];t.evalxy=o([t._xctrl,t._yctrl],c,f,h.smoothing,p.smoothing);t.dxydi=s([t._xctrl,t._yctrl],h.smoothing,p.smoothing);t.dxydj=l([t._xctrl,t._yctrl],h.smoothing,p.smoothing)};t.i2a=function(e){var t=Math.max(0,Math.floor(e[0]),c-2);var a=e[0]-t;return(1-a)*r[t]+a*r[t+1]};t.j2b=function(e){var t=Math.max(0,Math.floor(e[1]),c-2);var r=e[1]-t;return(1-r)*u[t]+r*u[t+1]};t.ij2ab=function(e){return[t.i2a(e[0]),t.j2b(e[1])]};t.a2i=function(e){var t=Math.max(0,Math.min(n(e,r),c-2));var a=r[t];var i=r[t+1];return Math.max(0,Math.min(c-1,t+(e-a)/(i-a)))};t.b2j=function(e){var t=Math.max(0,Math.min(n(e,u),f-2));var r=u[t];var a=u[t+1];return Math.max(0,Math.min(f-1,t+(e-r)/(a-r)))};t.ab2ij=function(e){return[t.a2i(e[0]),t.b2j(e[1])]};t.i2c=function(e,r){return t.evalxy([],e,r)};t.ab2xy=function(e,a,n){if(!n&&(e<r[0]||e>r[c-1]|a<u[0]||a>u[f-1])){return[false,false]}var i=t.a2i(e);var o=t.b2j(a);var s=t.evalxy([],i,o);if(n){var l=0;var h=0;var p=[];var v,d,m,g;if(e<r[0]){v=0;d=0;l=(e-r[0])/(r[1]-r[0])}else if(e>r[c-1]){v=c-2;d=1;l=(e-r[c-1])/(r[c-1]-r[c-2])}else{v=Math.max(0,Math.min(c-2,Math.floor(i)));d=i-v}if(a<u[0]){m=0;g=0;h=(a-u[0])/(u[1]-u[0])}else if(a>u[f-1]){m=f-2;g=1;h=(a-u[f-1])/(u[f-1]-u[f-2])}else{m=Math.max(0,Math.min(f-2,Math.floor(o)));g=o-m}if(l){t.dxydi(p,v,m,d,g);s[0]+=p[0]*l;s[1]+=p[1]*l}if(h){t.dxydj(p,v,m,d,g);s[0]+=p[0]*h;s[1]+=p[1]*h}}return s};t.c2p=function(e,t,r){return[t.c2p(e[0]),r.c2p(e[1])]};t.p2x=function(e,t,r){return[t.p2c(e[0]),r.p2c(e[1])]};t.dadi=function(e){var t=Math.max(0,Math.min(r.length-2,e));return r[t+1]-r[t]};t.dbdj=function(e){var t=Math.max(0,Math.min(u.length-2,e));return u[t+1]-u[t]};t.dxyda=function(e,r,a,n){var i=t.dxydi(null,e,r,a,n);var o=t.dadi(e,a);return[i[0]/o,i[1]/o]};t.dxydb=function(e,r,a,n){var i=t.dxydj(null,e,r,a,n);var o=t.dbdj(r,n);return[i[0]/o,i[1]/o]};t.dxyda_rough=function(e,r,a){var n=y*(a||.1);var i=t.ab2xy(e+n,r,true);var o=t.ab2xy(e-n,r,true);return[(i[0]-o[0])*.5/n,(i[1]-o[1])*.5/n]};t.dxydb_rough=function(e,r,a){var n=x*(a||.1);var i=t.ab2xy(e,r+n,true);var o=t.ab2xy(e,r-n,true);return[(i[0]-o[0])*.5/n,(i[1]-o[1])*.5/n]};t.dpdx=function(e){return e._m};t.dpdy=function(e){return e._m}}},{"../../lib/search":807,"./compute_control_points":978,"./constants":979,"./create_i_derivative_evaluator":980,"./create_j_derivative_evaluator":981,"./create_spline_evaluator":982}],991:[function(e,t,r){"use strict";var a=e("../../lib");t.exports=function e(t,r,n){var i,o,s;var l=[];var u=[];var c=t[0].length;var f=t.length;function h(e,r){var a=0;var n;var i=0;if(e>0&&(n=t[r][e-1])!==undefined){i++;a+=n}if(e<c-1&&(n=t[r][e+1])!==undefined){i++;a+=n}if(r>0&&(n=t[r-1][e])!==undefined){i++;a+=n}if(r<f-1&&(n=t[r+1][e])!==undefined){i++;a+=n}return a/Math.max(1,i)}var p=0;for(i=0;i<c;i++){for(o=0;o<f;o++){if(t[o][i]===undefined){l.push(i);u.push(o);t[o][i]=h(i,o)}p=Math.max(p,Math.abs(t[o][i]))}}if(!l.length)return t;var v,d,m,g,y,x,b,_,w,T,k;var M=1e-5;var A=0;var S=100;var E=0;var L=l.length;do{A=0;for(s=0;s<L;s++){i=l[s];o=u[s];var C=0;var I=0;var P,O,z,D,R,F;if(i===0){R=Math.min(c-1,2);z=r[R];D=r[1];P=t[o][R];O=t[o][1];I+=O+(O-P)*(r[0]-D)/(D-z);C++}else if(i===c-1){R=Math.max(0,c-3);z=r[R];D=r[c-2];P=t[o][R];O=t[o][c-2];I+=O+(O-P)*(r[c-1]-D)/(D-z);C++}if((i===0||i===c-1)&&(o>0&&o<f-1)){v=n[o+1]-n[o];d=n[o]-n[o-1];I+=(d*t[o+1][i]+v*t[o-1][i])/(d+v);C++}if(o===0){F=Math.min(f-1,2);z=n[F];D=n[1];P=t[F][i];O=t[1][i];I+=O+(O-P)*(n[0]-D)/(D-z);C++}else if(o===f-1){F=Math.max(0,f-3);z=n[F];D=n[f-2];P=t[F][i];O=t[f-2][i];I+=O+(O-P)*(n[f-1]-D)/(D-z);C++}if((o===0||o===f-1)&&(i>0&&i<c-1)){v=r[i+1]-r[i];d=r[i]-r[i-1];I+=(d*t[o][i+1]+v*t[o][i-1])/(d+v);C++}if(!C){m=r[i+1]-r[i];g=r[i]-r[i-1];y=n[o+1]-n[o];x=n[o]-n[o-1];b=m*g*(m+g);_=y*x*(y+x);I=(b*(x*t[o+1][i]+y*t[o-1][i])+_*(g*t[o][i+1]+m*t[o][i-1]))/(_*(g+m)+b*(x+y))}else{I/=C}w=I-t[o][i];T=w/p;A+=T*T;k=C?0:.85;t[o][i]+=w*(1+k)}A=Math.sqrt(A)}while(E++<S&&A>M);a.log("Smoother converged to",A,"after",E,"iterations");return t}},{"../../lib":787}],992:[function(e,t,r){"use strict";var a=e("../../lib").isArray1D;t.exports=function e(t,r,n){var i=n("x");var o=i&&i.length;var s=n("y");var l=s&&s.length;if(!o&&!l)return false;r._cheater=!i;if((!o||a(i))&&(!l||a(s))){var u=o?i.length:Infinity;if(l)u=Math.min(u,s.length);if(r.a&&r.a.length)u=Math.min(u,r.a.length);if(r.b&&r.b.length)u=Math.min(u,r.b.length);r._length=u}else r._length=null;return true}},{"../../lib":787}],993:[function(e,t,r){"use strict";var a=e("../../plots/template_attributes").hovertemplateAttrs;var n=e("../scattergeo/attributes");var i=e("../../components/colorscale/attributes");var o=e("../../plots/attributes");var s=e("../../components/color/attributes").defaultLine;var l=e("../../lib/extend").extendFlat;var u=n.marker.line;t.exports=l({locations:{valType:"data_array",editType:"calc"},locationmode:n.locationmode,z:{valType:"data_array",editType:"calc"},geojson:l({},n.geojson,{}),featureidkey:n.featureidkey,text:l({},n.text,{}),hovertext:l({},n.hovertext,{}),marker:{line:{color:l({},u.color,{dflt:s}),width:l({},u.width,{dflt:1}),editType:"calc"},opacity:{valType:"number",arrayOk:true,min:0,max:1,dflt:1,editType:"style"},editType:"calc"},selected:{marker:{opacity:n.selected.marker.opacity,editType:"plot"},editType:"plot"},unselected:{marker:{opacity:n.unselected.marker.opacity,editType:"plot"},editType:"plot"},hoverinfo:l({},o.hoverinfo,{editType:"calc",flags:["location","z","text","name"]}),hovertemplate:a(),showlegend:l({},o.showlegend,{dflt:false})},i("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/color/attributes":649,"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../plots/attributes":834,"../../plots/template_attributes":910,"../scattergeo/attributes":1244}],994:[function(e,t,r){"use strict";var a=e("fast-isnumeric");var n=e("../../constants/numerical").BADNUM;var i=e("../../components/colorscale/calc");var o=e("../scatter/arrays_to_calcdata");var s=e("../scatter/calc_selection");function l(e){return e&&typeof e==="string"}t.exports=function e(t,r){var u=r._length;var c=new Array(u);var f;if(r.geojson){f=function(e){return l(e)||a(e)}}else{f=l}for(var h=0;h<u;h++){var p=c[h]={};var v=r.locations[h];var d=r.z[h];if(f(v)&&a(d)){p.loc=v;p.z=d}else{p.loc=null;p.z=n}p.index=h}o(c,r);i(t,r,{vals:r.z,containerStr:"",cLetter:"z"});s(c,r);return c}},{"../../components/colorscale/calc":658,"../../constants/numerical":763,"../scatter/arrays_to_calcdata":1201,"../scatter/calc_selection":1204,"fast-isnumeric":246}],995:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("../../components/colorscale/defaults");var i=e("./attributes");t.exports=function e(t,r,o,s){function l(e,n){return a.coerce(t,r,i,e,n)}var u=l("locations");var c=l("z");if(!(u&&u.length&&a.isArrayOrTypedArray(c)&&c.length)){r.visible=false;return}r._length=Math.min(u.length,c.length);var f=l("geojson");var h;if(typeof f==="string"&&f!==""||a.isPlainObject(f)){h="geojson-id"}var p=l("locationmode",h);if(p==="geojson-id"){l("featureidkey")}l("text");l("hovertext");l("hovertemplate");var v=l("marker.line.width");if(v)l("marker.line.color");l("marker.opacity");n(t,r,s,l,{prefix:"",cLetter:"z"});a.coerceSelectionMarkerOpacity(r,l)}},{"../../components/colorscale/defaults":660,"../../lib":787,"./attributes":993}],996:[function(e,t,r){"use strict";t.exports=function e(t,r,a,n,i){t.location=r.location;t.z=r.z;var o=n[i];if(o.fIn&&o.fIn.properties){t.properties=o.fIn.properties}t.ct=o.ct;return t}},{}],997:[function(e,t,r){"use strict";var a=e("../../plots/cartesian/axes");var n=e("./attributes");var i=e("../../lib").fillText;t.exports=function e(t,r,n){var i=t.cd;var s=i[0].trace;var l=t.subplot;var u,c,f,h;var p=[r,n];var v=[r+360,n];for(c=0;c<i.length;c++){u=i[c];h=false;if(u._polygons){for(f=0;f<u._polygons.length;f++){if(u._polygons[f].contains(p)){h=!h}if(u._polygons[f].contains(v)){h=!h}}if(h)break}}if(!h||!u)return;t.x0=t.x1=t.xa.c2p(u.ct);t.y0=t.y1=t.ya.c2p(u.ct);t.index=u.index;t.location=u.loc;t.z=u.z;t.zLabel=a.tickText(l.mockAxis,l.mockAxis.c2l(u.z),"hover").text;t.hovertemplate=u.hovertemplate;o(t,s,u);return[t]};function o(e,t,r){if(t.hovertemplate)return;var a=r.hi||t.hoverinfo;var o=String(r.loc);var s=a==="all"?n.hoverinfo.flags:a.split("+");var l=s.indexOf("name")!==-1;var u=s.indexOf("location")!==-1;var c=s.indexOf("z")!==-1;var f=s.indexOf("text")!==-1;var h=!l&&u;var p=[];if(h){e.nameOverride=o}else{if(l)e.nameOverride=t.name;if(u)p.push(o)}if(c){p.push(e.zLabel)}if(f){i(r,t,p)}e.extraText=p.join("<br>")}},{"../../lib":787,"../../plots/cartesian/axes":838,"./attributes":993}],998:[function(e,t,r){"use strict";t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),colorbar:e("../heatmap/colorbar"),calc:e("./calc"),calcGeoJSON:e("./plot").calcGeoJSON,plot:e("./plot").plot,style:e("./style").style,styleOnSelect:e("./style").styleOnSelect,hoverPoints:e("./hover"),eventData:e("./event_data"),selectPoints:e("./select"),moduleType:"trace",name:"choropleth",basePlotModule:e("../../plots/geo"),categories:["geo","noOpacity","showLegend"],meta:{}}},{"../../plots/geo":871,"../heatmap/colorbar":1072,"./attributes":993,"./calc":994,"./defaults":995,"./event_data":996,"./hover":997,"./plot":999,"./select":1e3,"./style":1001}],999:[function(e,t,r){"use strict";var a=e("@plotly/d3");var n=e("../../lib");var i=e("../../lib/geo_location_utils");var o=e("../../lib/topojson_utils").getTopojsonFeatures;var s=e("../../plots/cartesian/autorange").findExtremes;var l=e("./style").style;function u(e,t,r){var i=t.layers.backplot.select(".choroplethlayer");n.makeTraceGroups(i,r,"trace choropleth").each((function(t){var r=a.select(this);var i=r.selectAll("path.choroplethlocation").data(n.identity);i.enter().append("path").classed("choroplethlocation",true);i.exit().remove();l(e,t)}))}function c(e,t){var r=e[0].trace;var a=t[r.geo];var n=a._subplot;var l=r.locationmode;var u=r._length;var c=l==="geojson-id"?i.extractTraceFeature(e):o(r,n.topojson);var f=[];var h=[];for(var p=0;p<u;p++){var v=e[p];var d=l==="geojson-id"?v.fOut:i.locationToFeature(l,v.loc,c);if(d){v.geojson=d;v.ct=d.properties.ct;v._polygons=i.feature2polygons(d);var m=i.computeBbox(d);f.push(m[0],m[2]);h.push(m[1],m[3])}else{v.geojson=null}}if(a.fitbounds==="geojson"&&l==="geojson-id"){var g=i.computeBbox(i.getTraceGeojson(r));f=[g[0],g[2]];h=[g[1],g[3]]}var y={padded:true};r._extremes.lon=s(a.lonaxis._ax,f,y);r._extremes.lat=s(a.lataxis._ax,h,y)}t.exports={calcGeoJSON:c,plot:u}},{"../../lib":787,"../../lib/geo_location_utils":780,"../../lib/topojson_utils":816,"../../plots/cartesian/autorange":837,"./style":1001,"@plotly/d3":58}],1e3:[function(e,t,r){"use strict";t.exports=function e(t,r){var a=t.cd;var n=t.xaxis;var i=t.yaxis;var o=[];var s,l,u,c,f;if(r===false){for(s=0;s<a.length;s++){a[s].selected=0}}else{for(s=0;s<a.length;s++){l=a[s];u=l.ct;if(!u)continue;c=n.c2p(u);f=i.c2p(u);if(r.contains([c,f],null,s,t)){o.push({pointNumber:s,lon:u[0],lat:u[1]});l.selected=1}else{l.selected=0}}}return o}},{}],1001:[function(e,t,r){"use strict";var a=e("@plotly/d3");var n=e("../../components/color");var i=e("../../components/drawing");var o=e("../../components/colorscale");function s(e,t){if(t)l(e,t)}function l(e,t){var r=t[0].trace;var s=t[0].node3;var l=s.selectAll(".choroplethlocation");var u=r.marker||{};var c=u.line||{};var f=o.makeColorScaleFuncFromTrace(r);l.each((function(e){a.select(this).attr("fill",f(e.z)).call(n.stroke,e.mlc||c.color).call(i.dashLine,"",e.mlw||c.width||0).style("opacity",u.opacity)}));i.selectedPointStyle(l,r,e)}function u(e,t){var r=t[0].node3;var a=t[0].trace;if(a.selectedpoints){i.selectedPointStyle(r.selectAll(".choroplethlocation"),a,e)}else{l(e,t)}}t.exports={style:s,styleOnSelect:u}},{"../../components/color":650,"../../components/colorscale":662,"../../components/drawing":672,"@plotly/d3":58}],1002:[function(e,t,r){"use strict";var a=e("../choropleth/attributes");var n=e("../../components/colorscale/attributes");var i=e("../../plots/template_attributes").hovertemplateAttrs;var o=e("../../plots/attributes");var s=e("../../lib/extend").extendFlat;t.exports=s({locations:{valType:"data_array",editType:"calc"},z:{valType:"data_array",editType:"calc"},geojson:{valType:"any",editType:"calc"},featureidkey:s({},a.featureidkey,{}),below:{valType:"string",editType:"plot"},text:a.text,hovertext:a.hovertext,marker:{line:{color:s({},a.marker.line.color,{editType:"plot"}),width:s({},a.marker.line.width,{editType:"plot"}),editType:"calc"},opacity:s({},a.marker.opacity,{editType:"plot"}),editType:"calc"},selected:{marker:{opacity:s({},a.selected.marker.opacity,{editType:"plot"}),editType:"plot"},editType:"plot"},unselected:{marker:{opacity:s({},a.unselected.marker.opacity,{editType:"plot"}),editType:"plot"},editType:"plot"},hoverinfo:a.hoverinfo,hovertemplate:i({},{keys:["properties"]}),showlegend:s({},o.showlegend,{dflt:false})},n("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../plots/attributes":834,"../../plots/template_attributes":910,"../choropleth/attributes":993}],1003:[function(e,t,r){"use strict";var a=e("fast-isnumeric");var n=e("../../lib");var i=e("../../components/colorscale");var o=e("../../components/drawing");var s=e("../../lib/geojson_utils").makeBlank;var l=e("../../lib/geo_location_utils");function u(e){var t=e[0].trace;var r=t.visible===true&&t._length!==0;var o={layout:{visibility:"none"},paint:{}};var u={layout:{visibility:"none"},paint:{}};var f=t._opts={fill:o,line:u,geojson:s()};if(!r)return f;var h=l.extractTraceFeature(e);if(!h)return f;var p=i.makeColorScaleFuncFromTrace(t);var v=t.marker;var d=v.line||{};var m;if(n.isArrayOrTypedArray(v.opacity)){m=function(e){var t=e.mo;return a(t)?+n.constrain(t,0,1):0}}var g;if(n.isArrayOrTypedArray(d.color)){g=function(e){return e.mlc}}var y;if(n.isArrayOrTypedArray(d.width)){y=function(e){return e.mlw}}for(var x=0;x<e.length;x++){var b=e[x];var _=b.fOut;if(_){var w=_.properties;w.fc=p(b.z);if(m)w.mo=m(b);if(g)w.mlc=g(b);if(y)w.mlw=y(b);b.ct=w.ct;b._polygons=l.feature2polygons(_)}}var T=m?{type:"identity",property:"mo"}:v.opacity;n.extendFlat(o.paint,{"fill-color":{type:"identity",property:"fc"},"fill-opacity":T});n.extendFlat(u.paint,{"line-color":g?{type:"identity",property:"mlc"}:d.color,"line-width":y?{type:"identity",property:"mlw"}:d.width,"line-opacity":T});o.layout.visibility="visible";u.layout.visibility="visible";f.geojson={type:"FeatureCollection",features:h};c(e);return f}function c(e){var t=e[0].trace;var r=t._opts;var a;if(t.selectedpoints){var i=o.makeSelectedPointStyleFns(t);for(var s=0;s<e.length;s++){var l=e[s];if(l.fOut){l.fOut.properties.mo2=i.selectedOpacityFn(l)}}a={type:"identity",property:"mo2"}}else{a=n.isArrayOrTypedArray(t.marker.opacity)?{type:"identity",property:"mo"}:t.marker.opacity}n.extendFlat(r.fill.paint,{"fill-opacity":a});n.extendFlat(r.line.paint,{"line-opacity":a});return r}t.exports={convert:u,convertOnSelect:c}},{"../../components/colorscale":662,"../../components/drawing":672,"../../lib":787,"../../lib/geo_location_utils":780,"../../lib/geojson_utils":781,"fast-isnumeric":246}],1004:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("../../components/colorscale/defaults");var i=e("./attributes");t.exports=function e(t,r,o,s){function l(e,n){return a.coerce(t,r,i,e,n)}var u=l("locations");var c=l("z");var f=l("geojson");if(!a.isArrayOrTypedArray(u)||!u.length||!a.isArrayOrTypedArray(c)||!c.length||!(typeof f==="string"&&f!==""||a.isPlainObject(f))){r.visible=false;return}l("featureidkey");r._length=Math.min(u.length,c.length);l("below");l("text");l("hovertext");l("hovertemplate");var h=l("marker.line.width");if(h)l("marker.line.color");l("marker.opacity");n(t,r,s,l,{prefix:"",cLetter:"z"});a.coerceSelectionMarkerOpacity(r,l)}},{"../../components/colorscale/defaults":660,"../../lib":787,"./attributes":1002}],1005:[function(e,t,r){"use strict";t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),colorbar:e("../heatmap/colorbar"),calc:e("../choropleth/calc"),plot:e("./plot"),hoverPoints:e("../choropleth/hover"),eventData:e("../choropleth/event_data"),selectPoints:e("../choropleth/select"),styleOnSelect:function(e,t){if(t){var r=t[0].trace;r._glTrace.updateOnSelect(t)}},getBelow:function(e,t){var r=t.getMapLayers();for(var a=r.length-2;a>=0;a--){var n=r[a].id;if(typeof n==="string"&&n.indexOf("water")===0){for(var i=a+1;i<r.length;i++){n=r[i].id;if(typeof n==="string"&&n.indexOf("plotly-")===-1){return n}}}}},moduleType:"trace",name:"choroplethmapbox",basePlotModule:e("../../plots/mapbox"),categories:["mapbox","gl","noOpacity","showLegend"],meta:{hr_name:"choropleth_mapbox"}}},{"../../plots/mapbox":895,"../choropleth/calc":994,"../choropleth/event_data":996,"../choropleth/hover":997,"../choropleth/select":1e3,"../heatmap/colorbar":1072,"./attributes":1002,"./defaults":1004,"./plot":1006}],1006:[function(e,t,r){"use strict";var a=e("./convert").convert;var n=e("./convert").convertOnSelect;var i=e("../../plots/mapbox/constants").traceLayerPrefix;function o(e,t){this.type="choroplethmapbox";this.subplot=e;this.uid=t;this.sourceId="source-"+t;this.layerList=[["fill",i+t+"-fill"],["line",i+t+"-line"]];this.below=null}var s=o.prototype;s.update=function(e){this._update(a(e))};s.updateOnSelect=function(e){this._update(n(e))};s._update=function(e){var t=this.subplot;var r=this.layerList;var a=t.belowLookup["trace-"+this.uid];t.map.getSource(this.sourceId).setData(e.geojson);if(a!==this.below){this._removeLayers();this._addLayers(e,a);this.below=a}for(var n=0;n<r.length;n++){var i=r[n];var o=i[0];var s=i[1];var l=e[o];t.setOptions(s,"setLayoutProperty",l.layout);if(l.layout.visibility==="visible"){t.setOptions(s,"setPaintProperty",l.paint)}}};s._addLayers=function(e,t){var r=this.subplot;var a=this.layerList;var n=this.sourceId;for(var i=0;i<a.length;i++){var o=a[i];var s=o[0];var l=e[s];r.addLayer({type:s,id:o[1],source:n,layout:l.layout,paint:l.paint},t)}};s._removeLayers=function(){var e=this.subplot.map;var t=this.layerList;for(var r=t.length-1;r>=0;r--){e.removeLayer(t[r][1])}};s.dispose=function(){var e=this.subplot.map;this._removeLayers();e.removeSource(this.sourceId)};t.exports=function e(t,r){var n=r[0].trace;var i=new o(t,n.uid);var s=i.sourceId;var l=a(r);var u=i.below=t.belowLookup["trace-"+n.uid];t.map.addSource(s,{type:"geojson",data:l.geojson});i._addLayers(l,u);r[0].trace._glTrace=i;return i}},{"../../plots/mapbox/constants":893,"./convert":1003}],1007:[function(e,t,r){"use strict";var a=e("../../components/colorscale/attributes");var n=e("../../plots/cartesian/axis_format_attributes").axisHoverFormat;var i=e("../../plots/template_attributes").hovertemplateAttrs;var o=e("../mesh3d/attributes");var s=e("../../plots/attributes");var l=e("../../lib/extend").extendFlat;var u={x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},u:{valType:"data_array",editType:"calc"},v:{valType:"data_array",editType:"calc"},w:{valType:"data_array",editType:"calc"},sizemode:{valType:"enumerated",values:["scaled","absolute"],editType:"calc",dflt:"scaled"},sizeref:{valType:"number",editType:"calc",min:0},anchor:{valType:"enumerated",editType:"calc",values:["tip","tail","cm","center"],dflt:"cm"},text:{valType:"string",dflt:"",arrayOk:true,editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:true,editType:"calc"},hovertemplate:i({editType:"calc"},{keys:["norm"]}),uhoverformat:n("u",1),vhoverformat:n("v",1),whoverformat:n("w",1),xhoverformat:n("x"),yhoverformat:n("y"),zhoverformat:n("z"),showlegend:l({},s.showlegend,{dflt:false})};l(u,a("",{colorAttr:"u/v/w norm",showScaleDflt:true,editTypeOverride:"calc"}));var c=["opacity","lightposition","lighting"];c.forEach((function(e){u[e]=o[e]}));u.hoverinfo=l({},s.hoverinfo,{editType:"calc",flags:["x","y","z","u","v","w","norm","text","name"],dflt:"x+y+z+norm+text+name"});u.transforms=undefined;t.exports=u},{"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../plots/attributes":834,"../../plots/cartesian/axis_format_attributes":841,"../../plots/template_attributes":910,"../mesh3d/attributes":1143}],1008:[function(e,t,r){"use strict";var a=e("../../components/colorscale/calc");t.exports=function e(t,r){var n=r.u;var i=r.v;var o=r.w;var s=Math.min(r.x.length,r.y.length,r.z.length,n.length,i.length,o.length);var l=-Infinity;var u=Infinity;for(var c=0;c<s;c++){var f=n[c];var h=i[c];var p=o[c];var v=Math.sqrt(f*f+h*h+p*p);l=Math.max(l,v);u=Math.min(u,v)}r._len=s;r._normMax=l;a(t,r,{vals:[u,l],containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":658}],1009:[function(e,t,r){"use strict";var a=e("gl-cone3d");var n=e("gl-cone3d").createConeMesh;var i=e("../../lib").simpleMap;var o=e("../../lib/gl_format_color").parseColorScale;var s=e("../../components/colorscale").extractOpts;var l=e("../../plots/gl3d/zip3");function u(e,t){this.scene=e;this.uid=t;this.mesh=null;this.data=null}var c=u.prototype;c.handlePick=function(e){if(e.object===this.mesh){var t=e.index=e.data.index;var r=this.data.x[t];var a=this.data.y[t];var n=this.data.z[t];var i=this.data.u[t];var o=this.data.v[t];var s=this.data.w[t];e.traceCoordinate=[r,a,n,i,o,s,Math.sqrt(i*i+o*o+s*s)];var l=this.data.hovertext||this.data.text;if(Array.isArray(l)&&l[t]!==undefined){e.textLabel=l[t]}else if(l){e.textLabel=l}return true}};var f={xaxis:0,yaxis:1,zaxis:2};var h={tip:1,tail:0,cm:.25,center:.5};var p={tip:1,tail:1,cm:.75,center:.5};function v(e,t){var r=e.fullSceneLayout;var n=e.dataScale;var u={};function c(e,t){var a=r[t];var o=n[f[t]];return i(e,(function(e){return a.d2l(e)*o}))}u.vectors=l(c(t.u,"xaxis"),c(t.v,"yaxis"),c(t.w,"zaxis"),t._len);u.positions=l(c(t.x,"xaxis"),c(t.y,"yaxis"),c(t.z,"zaxis"),t._len);var v=s(t);u.colormap=o(t);u.vertexIntensityBounds=[v.min/t._normMax,v.max/t._normMax];u.coneOffset=h[t.anchor];if(t.sizemode==="scaled"){u.coneSize=t.sizeref||.5}else{u.coneSize=t.sizeref&&t._normMax?t.sizeref/t._normMax:.5}var d=a(u);var m=t.lightposition;d.lightPosition=[m.x,m.y,m.z];d.ambient=t.lighting.ambient;d.diffuse=t.lighting.diffuse;d.specular=t.lighting.specular;d.roughness=t.lighting.roughness;d.fresnel=t.lighting.fresnel;d.opacity=t.opacity;t._pad=p[t.anchor]*d.vectorScale*d.coneScale*t._normMax;return d}c.update=function(e){this.data=e;var t=v(this.scene,e);this.mesh.update(t)};c.dispose=function(){this.scene.glplot.remove(this.mesh);this.mesh.dispose()};function d(e,t){var r=e.glplot.gl;var a=v(e,t);var i=n(r,a);var o=new u(e,t.uid);o.mesh=i;o.data=t;i._trace=o;e.glplot.add(i);return o}t.exports=d},{"../../components/colorscale":662,"../../lib":787,"../../lib/gl_format_color":783,"../../plots/gl3d/zip3":891,"gl-cone3d":262}],1010:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("../../components/colorscale/defaults");var i=e("./attributes");t.exports=function e(t,r,o,s){function l(e,n){return a.coerce(t,r,i,e,n)}var u=l("u");var c=l("v");var f=l("w");var h=l("x");var p=l("y");var v=l("z");if(!u||!u.length||!c||!c.length||!f||!f.length||!h||!h.length||!p||!p.length||!v||!v.length){r.visible=false;return}l("sizeref");l("sizemode");l("anchor");l("lighting.ambient");l("lighting.diffuse");l("lighting.specular");l("lighting.roughness");l("lighting.fresnel");l("lightposition.x");l("lightposition.y");l("lightposition.z");n(t,r,s,l,{prefix:"",cLetter:"c"});l("text");l("hovertext");l("hovertemplate");l("uhoverformat");l("vhoverformat");l("whoverformat");l("xhoverformat");l("yhoverformat");l("zhoverformat");r._length=null}},{"../../components/colorscale/defaults":660,"../../lib":787,"./attributes":1007}],1011:[function(e,t,r){"use strict";t.exports={moduleType:"trace",name:"cone",basePlotModule:e("../../plots/gl3d"),categories:["gl3d","showLegend"],attributes:e("./attributes"),supplyDefaults:e("./defaults"),colorbar:{min:"cmin",max:"cmax"},calc:e("./calc"),plot:e("./convert"),eventData:function(e,t){e.norm=t.traceCoordinate[6];return e},meta:{}}},{"../../plots/gl3d":880,"./attributes":1007,"./calc":1008,"./convert":1009,"./defaults":1010}],1012:[function(e,t,r){"use strict";var a=e("../heatmap/attributes");var n=e("../scatter/attributes");var i=e("../../plots/cartesian/axis_format_attributes");var o=i.axisHoverFormat;var s=i.descriptionOnlyNumbers;var l=e("../../components/colorscale/attributes");var u=e("../../components/drawing/attributes").dash;var c=e("../../plots/font_attributes");var f=e("../../lib/extend").extendFlat;var h=e("../../constants/filter_ops");var p=h.COMPARISON_OPS2;var v=h.INTERVAL_OPS;var d=n.line;t.exports=f({z:a.z,x:a.x,x0:a.x0,dx:a.dx,y:a.y,y0:a.y0,dy:a.dy,xperiod:a.xperiod,yperiod:a.yperiod,xperiod0:n.xperiod0,yperiod0:n.yperiod0,xperiodalignment:a.xperiodalignment,yperiodalignment:a.yperiodalignment,text:a.text,hovertext:a.hovertext,transpose:a.transpose,xtype:a.xtype,ytype:a.ytype,xhoverformat:o("x"),yhoverformat:o("y"),zhoverformat:o("z",1),hovertemplate:a.hovertemplate,hoverongaps:a.hoverongaps,connectgaps:f({},a.connectgaps,{}),fillcolor:{valType:"color",editType:"calc"},autocontour:{valType:"boolean",dflt:true,editType:"calc",impliedEdits:{"contours.start":undefined,"contours.end":undefined,"contours.size":undefined}},ncontours:{valType:"integer",dflt:15,min:1,editType:"calc"},contours:{type:{valType:"enumerated",values:["levels","constraint"],dflt:"levels",editType:"calc"},start:{valType:"number",dflt:null,editType:"plot",impliedEdits:{"^autocontour":false}},end:{valType:"number",dflt:null,editType:"plot",impliedEdits:{"^autocontour":false}},size:{valType:"number",dflt:null,min:0,editType:"plot",impliedEdits:{"^autocontour":false}},coloring:{valType:"enumerated",values:["fill","heatmap","lines","none"],dflt:"fill",editType:"calc"},showlines:{valType:"boolean",dflt:true,editType:"plot"},showlabels:{valType:"boolean",dflt:false,editType:"plot"},labelfont:c({editType:"plot",colorEditType:"style"}),labelformat:{valType:"string",dflt:"",editType:"plot",description:s("contour label")},operation:{valType:"enumerated",values:[].concat(p).concat(v),dflt:"=",editType:"calc"},value:{valType:"any",dflt:0,editType:"calc"},editType:"calc",impliedEdits:{autocontour:false}},line:{color:f({},d.color,{editType:"style+colorbars"}),width:{valType:"number",min:0,editType:"style+colorbars"},dash:u,smoothing:f({},d.smoothing,{}),editType:"plot"}},l("",{cLetter:"z",autoColorDflt:false,editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":657,"../../components/drawing/attributes":671,"../../constants/filter_ops":759,"../../lib/extend":777,"../../plots/cartesian/axis_format_attributes":841,"../../plots/font_attributes":867,"../heatmap/attributes":1069,"../scatter/attributes":1202}],1013:[function(e,t,r){"use strict";var a=e("../../components/colorscale");var n=e("../heatmap/calc");var i=e("./set_contours");var o=e("./end_plus");t.exports=function e(t,r){var s=n(t,r);var l=s[0].z;i(r,l);var u=r.contours;var c=a.extractOpts(r);var f;if(u.coloring==="heatmap"&&c.auto&&r.autocontour===false){var h=u.start;var p=o(u);var v=u.size||1;var d=Math.floor((p-h)/v)+1;if(!isFinite(v)){v=1;d=1}var m=h-v/2;var g=m+d*v;f=[m,g]}else{f=l}a.calc(t,r,{vals:f,cLetter:"z"});return s}},{"../../components/colorscale":662,"../heatmap/calc":1070,"./end_plus":1023,"./set_contours":1031}],1014:[function(e,t,r){"use strict";t.exports=function(e,t){var r=e[0];var a=r.z;var n;switch(t.type){case"levels":var i=Math.min(a[0][0],a[0][1]);for(n=0;n<e.length;n++){var o=e[n];o.prefixBoundary=!o.edgepaths.length&&(i>o.level||o.starts.length&&i===o.level)}break;case"constraint":r.prefixBoundary=false;if(r.edgepaths.length)return;var s=r.x.length;var l=r.y.length;var u=-Infinity;var c=Infinity;for(n=0;n<l;n++){c=Math.min(c,a[n][0]);c=Math.min(c,a[n][s-1]);u=Math.max(u,a[n][0]);u=Math.max(u,a[n][s-1])}for(n=1;n<s-1;n++){c=Math.min(c,a[0][n]);c=Math.min(c,a[l-1][n]);u=Math.max(u,a[0][n]);u=Math.max(u,a[l-1][n])}var f=t.value;var h,p;switch(t._operation){case">":if(f>u){r.prefixBoundary=true}break;case"<":if(f<c||r.starts.length&&f===c){r.prefixBoundary=true}break;case"[]":h=Math.min(f[0],f[1]);p=Math.max(f[0],f[1]);if(p<c||h>u||r.starts.length&&p===c){r.prefixBoundary=true}break;case"][":h=Math.min(f[0],f[1]);p=Math.max(f[0],f[1]);if(h<c&&p>u){r.prefixBoundary=true}break}break}}},{}],1015:[function(e,t,r){"use strict";var a=e("../../components/colorscale");var n=e("./make_color_map");var i=e("./end_plus");function o(e,t,r){var o=t.contours;var s=t.line;var l=o.size||1;var u=o.coloring;var c=n(t,{isColorbar:true});if(u==="heatmap"){var f=a.extractOpts(t);r._fillgradient=f.reversescale?a.flipScale(f.colorscale):f.colorscale;r._zrange=[f.min,f.max]}else if(u==="fill"){r._fillcolor=c}r._line={color:u==="lines"?c:s.color,width:o.showlines!==false?s.width:0,dash:s.dash};r._levels={start:o.start,end:i(o),size:l}}t.exports={min:"zmin",max:"zmax",calc:o}},{"../../components/colorscale":662,"./end_plus":1023,"./make_color_map":1028}],1016:[function(e,t,r){"use strict";t.exports={BOTTOMSTART:[1,9,13,104,713],TOPSTART:[4,6,7,104,713],LEFTSTART:[8,12,14,208,1114],RIGHTSTART:[2,3,11,208,1114],NEWDELTA:[null,[-1,0],[0,-1],[-1,0],[1,0],null,[0,-1],[-1,0],[0,1],[0,1],null,[0,1],[1,0],[1,0],[0,-1]],CHOOSESADDLE:{104:[4,1],208:[2,8],713:[7,13],1114:[11,14]},SADDLEREMAINDER:{1:4,2:8,4:1,7:13,8:2,11:14,13:7,14:11},LABELDISTANCE:2,LABELINCREASE:10,LABELMIN:3,LABELMAX:10,LABELOPTIMIZER:{EDGECOST:1,ANGLECOST:1,NEIGHBORCOST:5,SAMELEVELFACTOR:10,SAMELEVELDISTANCE:5,MAXCOST:100,INITIALSEARCHPOINTS:10,ITERATIONS:5}}},{}],1017:[function(e,t,r){"use strict";var a=e("fast-isnumeric");var n=e("./label_defaults");var i=e("../../components/color");var o=i.addOpacity;var s=i.opacity;var l=e("../../constants/filter_ops");var u=l.CONSTRAINT_REDUCTION;var c=l.COMPARISON_OPS2;t.exports=function e(t,r,a,i,l,c){var h=r.contours;var p,v,d;var m=a("contours.operation");h._operation=u[m];f(a,h);if(m==="="){p=h.showlines=true}else{p=a("contours.showlines");d=a("fillcolor",o((t.line||{}).color||l,.5))}if(p){var g=d&&s(d)?o(r.fillcolor,1):l;v=a("line.color",g);a("line.width",2);a("line.dash")}a("line.smoothing");n(a,i,v,c)};function f(e,t){var r;if(c.indexOf(t.operation)===-1){e("contours.value",[0,1]);if(!Array.isArray(t.value)){if(a(t.value)){r=parseFloat(t.value);t.value=[r,r+1]}}else if(t.value.length>2){t.value=t.value.slice(2)}else if(t.length===0){t.value=[0,1]}else if(t.length<2){r=parseFloat(t.value[0]);t.value=[r,r+1]}else{t.value=[parseFloat(t.value[0]),parseFloat(t.value[1])]}}else{e("contours.value",0);if(!a(t.value)){if(Array.isArray(t.value)){t.value=parseFloat(t.value[0])}else{t.value=0}}}}},{"../../components/color":650,"../../constants/filter_ops":759,"./label_defaults":1027,"fast-isnumeric":246}],1018:[function(e,t,r){"use strict";var a=e("../../constants/filter_ops");var n=e("fast-isnumeric");t.exports={"[]":o("[]"),"][":o("]["),">":s(">"),"<":s("<"),"=":s("=")};function i(e,t){var r=Array.isArray(t);var i;function o(e){return n(e)?+e:null}if(a.COMPARISON_OPS2.indexOf(e)!==-1){i=r?o(t[0]):o(t)}else if(a.INTERVAL_OPS.indexOf(e)!==-1){i=r?[o(t[0]),o(t[1])]:[o(t),o(t)]}else if(a.SET_OPS.indexOf(e)!==-1){i=r?t.map(o):[o(t)]}return i}function o(e){return function(t){t=i(e,t);var r=Math.min(t[0],t[1]);var a=Math.max(t[0],t[1]);return{start:r,end:a,size:a-r}}}function s(e){return function(t){t=i(e,t);return{start:t,end:Infinity,size:Infinity}}}},{"../../constants/filter_ops":759,"fast-isnumeric":246}],1019:[function(e,t,r){"use strict";t.exports=function e(t,r,a,n){var i=n("contours.start");var o=n("contours.end");var s=i===false||o===false;var l=a("contours.size");var u;if(s)u=r.autocontour=true;else u=a("autocontour",false);if(u||!l)a("ncontours")}},{}],1020:[function(e,t,r){"use strict";var a=e("../../lib");t.exports=function(e,t){var r,i,o;var s=function(e){return e.reverse()};var l=function(e){return e};switch(t){case"=":case"<":return e;case">":if(e.length!==1){a.warn("Contour data invalid for the specified inequality operation.")}i=e[0];for(r=0;r<i.edgepaths.length;r++){i.edgepaths[r]=s(i.edgepaths[r])}for(r=0;r<i.paths.length;r++){i.paths[r]=s(i.paths[r])}for(r=0;r<i.starts.length;r++){i.starts[r]=s(i.starts[r])}return e;case"][":var u=s;s=l;l=u;case"[]":if(e.length!==2){a.warn("Contour data invalid for the specified inequality range operation.")}i=n(e[0]);o=n(e[1]);for(r=0;r<i.edgepaths.length;r++){i.edgepaths[r]=s(i.edgepaths[r])}for(r=0;r<i.paths.length;r++){i.paths[r]=s(i.paths[r])}for(r=0;r<i.starts.length;r++){i.starts[r]=s(i.starts[r])}while(o.edgepaths.length){i.edgepaths.push(l(o.edgepaths.shift()))}while(o.paths.length){i.paths.push(l(o.paths.shift()))}while(o.starts.length){i.starts.push(l(o.starts.shift()))}return[i]}};function n(e){return a.extendFlat({},e,{edgepaths:a.extendDeep([],e.edgepaths),paths:a.extendDeep([],e.paths),starts:a.extendDeep([],e.starts)})}},{"../../lib":787}],1021:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("../heatmap/xyz_defaults");var i=e("../scatter/period_defaults");var o=e("./constraint_defaults");var s=e("./contours_defaults");var l=e("./style_defaults");var u=e("./attributes");t.exports=function e(t,r,c,f){function h(e,n){return a.coerce(t,r,u,e,n)}function p(e){return a.coerce2(t,r,u,e)}var v=n(t,r,h,f);if(!v){r.visible=false;return}i(t,r,f,h);h("xhoverformat");h("yhoverformat");h("text");h("hovertext");h("hovertemplate");h("hoverongaps");var d=h("contours.type")==="constraint";h("connectgaps",a.isArray1D(r.z));if(d){o(t,r,h,f,c)}else{s(t,r,h,p);l(t,r,h,f)}}},{"../../lib":787,"../heatmap/xyz_defaults":1083,"../scatter/period_defaults":1222,"./attributes":1012,"./constraint_defaults":1017,"./contours_defaults":1019,"./style_defaults":1033}],1022:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("./constraint_mapping");var i=e("./end_plus");t.exports=function e(t,r,o){var s=t.type==="constraint"?n[t._operation](t.value):t;var l=s.size;var u=[];var c=i(s);var f=o.trace._carpetTrace;var h=f?{xaxis:f.aaxis,yaxis:f.baxis,x:o.a,y:o.b}:{xaxis:r.xaxis,yaxis:r.yaxis,x:o.x,y:o.y};for(var p=s.start;p<c;p+=l){u.push(a.extendFlat({level:p,crossings:{},starts:[],edgepaths:[],paths:[],z:o.z,smoothing:o.trace.line.smoothing},h));if(u.length>1e3){a.warn("Too many contours, clipping at 1000",t);break}}return u}},{"../../lib":787,"./constraint_mapping":1018,"./end_plus":1023}],1023:[function(e,t,r){"use strict";t.exports=function e(t){return t.end+t.size/1e6}},{}],1024:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("./constants");t.exports=function e(t,r,n){var i,o,l,u,c;r=r||.01;n=n||.01;for(l=0;l<t.length;l++){u=t[l];for(c=0;c<u.starts.length;c++){o=u.starts[c];s(u,o,"edge",r,n)}i=0;while(Object.keys(u.crossings).length&&i<1e4){i++;o=Object.keys(u.crossings)[0].split(",").map(Number);s(u,o,undefined,r,n)}if(i===1e4)a.log("Infinite loop in contour?")}};function i(e,t,r,a){return Math.abs(e[0]-t[0])<r&&Math.abs(e[1]-t[1])<a}function o(e,t){var r=e[2]-t[2];var a=e[3]-t[3];return Math.sqrt(r*r+a*a)}function s(e,t,r,s,c){var f=t.join(",");var h=e.crossings[f];var p=l(h,r,t);var v=[u(e,t,[-p[0],-p[1]])];var d=e.z.length;var m=e.z[0].length;var g=t.slice();var y=p.slice();var x;for(x=0;x<1e4;x++){if(h>20){h=n.CHOOSESADDLE[h][(p[0]||p[1])<0?0:1];e.crossings[f]=n.SADDLEREMAINDER[h]}else{delete e.crossings[f]}p=n.NEWDELTA[h];if(!p){a.log("Found bad marching index:",h,t,e.level);break}v.push(u(e,t,p));t[0]+=p[0];t[1]+=p[1];f=t.join(",");if(i(v[v.length-1],v[v.length-2],s,c))v.pop();var b=p[0]&&(t[0]<0||t[0]>m-2)||p[1]&&(t[1]<0||t[1]>d-2);var _=t[0]===g[0]&&t[1]===g[1]&&p[0]===y[0]&&p[1]===y[1];if(_||r&&b)break;h=e.crossings[f]}if(x===1e4){a.log("Infinite loop in contour?")}var w=i(v[0],v[v.length-1],s,c);var T=0;var k=.2*e.smoothing;var M=[];var A=0;var S,E,L,C,I,P,O,z,D,R,F;for(x=1;x<v.length;x++){O=o(v[x],v[x-1]);T+=O;M.push(O)}var B=T/M.length*k;function N(e){return v[e%v.length]}for(x=v.length-2;x>=A;x--){S=M[x];if(S<B){L=0;for(E=x-1;E>=A;E--){if(S+M[E]<B){S+=M[E]}else break}if(w&&x===v.length-2){for(L=0;L<E;L++){if(S+M[L]<B){S+=M[L]}else break}}I=x-E+L+1;P=Math.floor((x+E+L+2)/2);if(!w&&x===v.length-2)C=v[v.length-1];else if(!w&&E===-1)C=v[0];else if(I%2)C=N(P);else{C=[(N(P)[0]+N(P+1)[0])/2,(N(P)[1]+N(P+1)[1])/2]}v.splice(E+1,x-E+1,C);x=E+1;if(L)A=L;if(w){if(x===v.length-2)v[L]=v[v.length-1];else if(x===0)v[v.length-1]=v[0]}}}v.splice(0,A);for(x=0;x<v.length;x++)v[x].length=2;if(v.length<2)return;else if(w){v.pop();e.paths.push(v)}else{if(!r){a.log("Unclosed interior contour?",e.level,g.join(","),v.join("L"))}var j=false;for(z=0;z<e.edgepaths.length;z++){R=e.edgepaths[z];if(!j&&i(R[0],v[v.length-1],s,c)){v.pop();j=true;var U=false;for(D=0;D<e.edgepaths.length;D++){F=e.edgepaths[D];if(i(F[F.length-1],v[0],s,c)){U=true;v.shift();e.edgepaths.splice(z,1);if(D===z){e.paths.push(v.concat(F))}else{if(D>z)D--;e.edgepaths[D]=F.concat(v,R)}break}}if(!U){e.edgepaths[z]=v.concat(R)}}}for(z=0;z<e.edgepaths.length;z++){if(j)break;R=e.edgepaths[z];if(i(R[R.length-1],v[0],s,c)){v.shift();e.edgepaths[z]=R.concat(v);j=true}}if(!j)e.edgepaths.push(v)}}function l(e,t,r){var a=0;var i=0;if(e>20&&t){if(e===208||e===1114){a=r[0]===0?1:-1}else{i=r[1]===0?1:-1}}else if(n.BOTTOMSTART.indexOf(e)!==-1)i=1;else if(n.LEFTSTART.indexOf(e)!==-1)a=1;else if(n.TOPSTART.indexOf(e)!==-1)i=-1;else a=-1;return[a,i]}function u(e,t,r){var a=t[0]+Math.max(r[0],0);var n=t[1]+Math.max(r[1],0);var i=e.z[n][a];var o=e.xaxis;var s=e.yaxis;if(r[1]){var l=(e.level-i)/(e.z[n][a+1]-i);return[o.c2p((1-l)*e.x[a]+l*e.x[a+1],true),s.c2p(e.y[n],true),a+l,n]}else{var u=(e.level-i)/(e.z[n+1][a]-i);return[o.c2p(e.x[a],true),s.c2p((1-u)*e.y[n]+u*e.y[n+1],true),a,n+u]}}},{"../../lib":787,"./constants":1016}],1025:[function(e,t,r){"use strict";var a=e("../../components/color");var n=e("../heatmap/hover");t.exports=function e(t,r,i,o,s){if(!s)s={};s.isContour=true;var l=n(t,r,i,o,s);if(l){l.forEach((function(e){var t=e.trace;if(t.contours.type==="constraint"){if(t.fillcolor&&a.opacity(t.fillcolor)){e.color=a.addOpacity(t.fillcolor,1)}else if(t.contours.showlines&&a.opacity(t.line.color)){e.color=a.addOpacity(t.line.color,1)}}}))}return l}},{"../../components/color":650,"../heatmap/hover":1076}],1026:[function(e,t,r){"use strict";t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),calc:e("./calc"),plot:e("./plot").plot,style:e("./style"),colorbar:e("./colorbar"),hoverPoints:e("./hover"),moduleType:"trace",name:"contour",basePlotModule:e("../../plots/cartesian"),categories:["cartesian","svg","2dMap","contour","showLegend"],meta:{}}},{"../../plots/cartesian":852,"./attributes":1012,"./calc":1013,"./colorbar":1015,"./defaults":1021,"./hover":1025,"./plot":1030,"./style":1032}],1027:[function(e,t,r){"use strict";var a=e("../../lib");t.exports=function e(t,r,n,i){if(!i)i={};var o=t("contours.showlabels");if(o){var s=r.font;a.coerceFont(t,"contours.labelfont",{family:s.family,size:s.size,color:n});t("contours.labelformat")}if(i.hasHover!==false)t("zhoverformat")}},{"../../lib":787}],1028:[function(e,t,r){"use strict";var a=e("@plotly/d3");var n=e("../../components/colorscale");var i=e("./end_plus");t.exports=function e(t){var r=t.contours;var o=r.start;var s=i(r);var l=r.size||1;var u=Math.floor((s-o)/l)+1;var c=r.coloring==="lines"?0:1;var f=n.extractOpts(t);if(!isFinite(l)){l=1;u=1}var h=f.reversescale?n.flipScale(f.colorscale):f.colorscale;var p=h.length;var v=new Array(p);var d=new Array(p);var m,g;if(r.coloring==="heatmap"){var y=f.min;var x=f.max;for(g=0;g<p;g++){m=h[g];v[g]=m[0]*(x-y)+y;d[g]=m[1]}var b=a.extent([y,x,r.start,r.start+l*(u-1)]);var _=b[y<x?0:1];var w=b[y<x?1:0];if(_!==y){v.splice(0,0,_);d.splice(0,0,d[0])}if(w!==x){v.push(w);d.push(d[d.length-1])}}else{for(g=0;g<p;g++){m=h[g];v[g]=(m[0]*(u+c-1)-c/2)*l+o;d[g]=m[1]}}return n.makeColorScaleFunc({domain:v,range:d},{noNumericCheck:true})}},{"../../components/colorscale":662,"./end_plus":1023,"@plotly/d3":58}],1029:[function(e,t,r){"use strict";var a=e("./constants");t.exports=function e(t){var r=t[0].z;var i=r.length;var o=r[0].length;var s=i===2||o===2;var l;var u;var c;var f;var h;var p;var v;var d;var m;for(u=0;u<i-1;u++){f=[];if(u===0)f=f.concat(a.BOTTOMSTART);if(u===i-2)f=f.concat(a.TOPSTART);for(l=0;l<o-1;l++){c=f.slice();if(l===0)c=c.concat(a.LEFTSTART);if(l===o-2)c=c.concat(a.RIGHTSTART);h=l+","+u;p=[[r[u][l],r[u][l+1]],[r[u+1][l],r[u+1][l+1]]];for(m=0;m<t.length;m++){d=t[m];v=n(d.level,p);if(!v)continue;d.crossings[h]=v;if(c.indexOf(v)!==-1){d.starts.push([l,u]);if(s&&c.indexOf(v,c.indexOf(v)+1)!==-1){d.starts.push([l,u])}}}}}};function n(e,t){var r=(t[0][0]>e?0:1)+(t[0][1]>e?0:2)+(t[1][1]>e?0:4)+(t[1][0]>e?0:8);if(r===5||r===10){var a=(t[0][0]+t[0][1]+t[1][0]+t[1][1])/4;if(e>a)return r===5?713:1114;return r===5?104:208}return r===15?0:r}},{"./constants":1016}],1030:[function(e,t,r){"use strict";var a=e("@plotly/d3");var n=e("../../lib");var i=e("../../components/drawing");var o=e("../../components/colorscale");var s=e("../../lib/svg_text_utils");var l=e("../../plots/cartesian/axes");var u=e("../../plots/cartesian/set_convert");var c=e("../heatmap/plot");var f=e("./make_crossings");var h=e("./find_all_paths");var p=e("./empty_pathinfo");var v=e("./convert_to_constraints");var d=e("./close_boundaries");var m=e("./constants");var g=m.LABELOPTIMIZER;r.plot=function e(t,r,i,o){var s=r.xaxis;var l=r.yaxis;n.makeTraceGroups(o,i,"contour").each((function(e){var i=a.select(this);var o=e[0];var u=o.trace;var d=o.x;var m=o.y;var g=u.contours;var b=p(g,r,o);var w=n.ensureSingle(i,"g","heatmapcoloring");var k=[];if(g.coloring==="heatmap"){k=[e]}c(t,r,k,w);f(b);h(b);var M=s.c2p(d[0],true);var A=s.c2p(d[d.length-1],true);var S=l.c2p(m[0],true);var E=l.c2p(m[m.length-1],true);var L=[[M,E],[A,E],[A,S],[M,S]];var C=b;if(g.type==="constraint"){C=v(b,g._operation)}y(i,L,g);x(i,C,L,g);_(i,b,t,o,g);T(i,r,t,o,L)}))};function y(e,t,r){var a=n.ensureSingle(e,"g","contourbg");var i=a.selectAll("path").data(r.coloring==="fill"?[0]:[]);i.enter().append("path");i.exit().remove();i.attr("d","M"+t.join("L")+"Z").style("stroke","none")}function x(e,t,r,i){var o=i.coloring==="fill"||i.type==="constraint"&&i._operation!=="=";var s="M"+r.join("L")+"Z";if(o){d(t,i)}var l=n.ensureSingle(e,"g","contourfill");var u=l.selectAll("path").data(o?t:[]);u.enter().append("path");u.exit().remove();u.each((function(e){var t=(e.prefixBoundary?s:"")+b(e,r);if(!t){a.select(this).remove()}else{a.select(this).attr("d",t).style("stroke","none")}}))}function b(e,t){var r="";var a=0;var o=e.edgepaths.map((function(e,t){return t}));var s=true;var l;var u;var c;var f;var h;var p;function v(e){return Math.abs(e[1]-t[0][1])<.01}function d(e){return Math.abs(e[1]-t[2][1])<.01}function m(e){return Math.abs(e[0]-t[0][0])<.01}function g(e){return Math.abs(e[0]-t[2][0])<.01}while(o.length){p=i.smoothopen(e.edgepaths[a],e.smoothing);r+=s?p:p.replace(/^M/,"L");o.splice(o.indexOf(a),1);l=e.edgepaths[a][e.edgepaths[a].length-1];f=-1;for(c=0;c<4;c++){if(!l){n.log("Missing end?",a,e);break}if(v(l)&&!g(l))u=t[1];else if(m(l))u=t[0];else if(d(l))u=t[3];else if(g(l))u=t[2];for(h=0;h<e.edgepaths.length;h++){var y=e.edgepaths[h][0];if(Math.abs(l[0]-u[0])<.01){if(Math.abs(l[0]-y[0])<.01&&(y[1]-l[1])*(u[1]-y[1])>=0){u=y;f=h}}else if(Math.abs(l[1]-u[1])<.01){if(Math.abs(l[1]-y[1])<.01&&(y[0]-l[0])*(u[0]-y[0])>=0){u=y;f=h}}else{n.log("endpt to newendpt is not vert. or horz.",l,u,y)}}l=u;if(f>=0)break;r+="L"+u}if(f===e.edgepaths.length){n.log("unclosed perimeter path");break}a=f;s=o.indexOf(a)===-1;if(s){a=o[0];r+="Z"}}for(a=0;a<e.paths.length;a++){r+=i.smoothclosed(e.paths[a],e.smoothing)}return r}function _(e,t,o,s,l){var u=n.ensureSingle(e,"g","contourlines");var c=l.showlines!==false;var f=l.showlabels;var h=c&&f;var p=r.createLines(u,c||f,t);var v=r.createLineClip(u,h,o,s.trace.uid);var d=e.selectAll("g.contourlabels").data(f?[0]:[]);d.exit().remove();d.enter().append("g").classed("contourlabels",true);if(f){var g=[];var y=[];n.clearLocationCache();var x=r.labelFormatter(o,s);var b=i.tester.append("text").attr("data-notex",1).call(i.font,l.labelfont);var _=t[0].xaxis;var w=t[0].yaxis;var T=_._length;var k=w._length;var M=_.range;var A=w.range;var S=n.aggNums(Math.min,null,s.x);var E=n.aggNums(Math.max,null,s.x);var L=n.aggNums(Math.min,null,s.y);var C=n.aggNums(Math.max,null,s.y);var I=Math.max(_.c2p(S,true),0);var P=Math.min(_.c2p(E,true),T);var O=Math.max(w.c2p(C,true),0);var z=Math.min(w.c2p(L,true),k);var D={};if(M[0]<M[1]){D.left=I;D.right=P}else{D.left=P;D.right=I}if(A[0]<A[1]){D.top=O;D.bottom=z}else{D.top=z;D.bottom=O}D.middle=(D.top+D.bottom)/2;D.center=(D.left+D.right)/2;g.push([[D.left,D.top],[D.right,D.top],[D.right,D.bottom],[D.left,D.bottom]]);var R=Math.sqrt(T*T+k*k);var F=m.LABELDISTANCE*R/Math.max(1,t.length/m.LABELINCREASE);p.each((function(e){var t=r.calcTextOpts(e.level,x,b,o);a.select(this).selectAll("path").each((function(){var e=this;var a=n.getVisibleSegment(e,D,t.height/2);if(!a)return;if(a.len<(t.width+t.height)*m.LABELMIN)return;var i=Math.min(Math.ceil(a.len/F),m.LABELMAX);for(var o=0;o<i;o++){var s=r.findBestTextLocation(e,a,t,y,D);if(!s)break;r.addLabelData(s,t,y,g)}}))}));b.remove();r.drawLabels(d,y,o,v,h?g:null)}if(f&&!c)p.remove()}r.createLines=function(e,t,r){var a=r[0].smoothing;var n=e.selectAll("g.contourlevel").data(t?r:[]);n.exit().remove();n.enter().append("g").classed("contourlevel",true);if(t){var o=n.selectAll("path.openline").data((function(e){return e.pedgepaths||e.edgepaths}));o.exit().remove();o.enter().append("path").classed("openline",true);o.attr("d",(function(e){return i.smoothopen(e,a)})).style("stroke-miterlimit",1).style("vector-effect","non-scaling-stroke");var s=n.selectAll("path.closedline").data((function(e){return e.ppaths||e.paths}));s.exit().remove();s.enter().append("path").classed("closedline",true);s.attr("d",(function(e){return i.smoothclosed(e,a)})).style("stroke-miterlimit",1).style("vector-effect","non-scaling-stroke")}return n};r.createLineClip=function(e,t,r,a){var n=r._fullLayout._clips;var o=t?"clipline"+a:null;var s=n.selectAll("#"+o).data(t?[0]:[]);s.exit().remove();s.enter().append("clipPath").classed("contourlineclip",true).attr("id",o);i.setClipUrl(e,o,r);return s};r.labelFormatter=function(e,t){var r=e._fullLayout;var a=t.trace;var n=a.contours;var i={type:"linear",_id:"ycontour",showexponent:"all",exponentformat:"B"};if(n.labelformat){i.tickformat=n.labelformat;u(i,r)}else{var s=o.extractOpts(a);if(s&&s.colorbar&&s.colorbar._axis){i=s.colorbar._axis}else{if(n.type==="constraint"){var c=n.value;if(Array.isArray(c)){i.range=[c[0],c[c.length-1]]}else i.range=[c,c]}else{i.range=[n.start,n.end];i.nticks=(n.end-n.start)/n.size}if(i.range[0]===i.range[1]){i.range[1]+=i.range[0]||1}if(!i.nticks)i.nticks=1e3;u(i,r);l.prepTicks(i);i._tmin=null;i._tmax=null}}return function(e){return l.tickText(i,e).text}};r.calcTextOpts=function(e,t,r,a){var n=t(e);r.text(n).call(s.convertToTspans,a);var o=r.node();var l=i.bBox(o,true);return{text:n,width:l.width,height:l.height,fontSize:+o.style["font-size"].replace("px",""),level:e,dy:(l.top+l.bottom)/2}};r.findBestTextLocation=function(e,t,r,a,i){var o=r.width;var s,l,u,c,f;if(t.isClosed){l=t.len/g.INITIALSEARCHPOINTS;s=t.min+l/2;u=t.max}else{l=(t.len-o)/(g.INITIALSEARCHPOINTS+1);s=t.min+l+o/2;u=t.max-(l+o)/2}var h=Infinity;for(var p=0;p<g.ITERATIONS;p++){for(var v=s;v<u;v+=l){var d=n.getTextLocation(e,t.total,v,o);var m=w(d,r,a,i);if(m<h){h=m;f=d;c=v}}if(h>g.MAXCOST*2)break;if(p)l/=2;s=c-l/2;u=s+l*1.5}if(h<=g.MAXCOST)return f};function w(e,t,r,a){var i=t.width/2;var o=t.height/2;var s=e.x;var l=e.y;var u=e.theta;var c=Math.cos(u)*i;var f=Math.sin(u)*i;var h=(s>a.center?a.right-s:s-a.left)/(c+Math.abs(Math.sin(u)*o));var p=(l>a.middle?a.bottom-l:l-a.top)/(Math.abs(f)+Math.cos(u)*o);if(h<1||p<1)return Infinity;var v=g.EDGECOST*(1/(h-1)+1/(p-1));v+=g.ANGLECOST*u*u;var d=s-c;var m=l-f;var y=s+c;var x=l+f;for(var b=0;b<r.length;b++){var _=r[b];var w=Math.cos(_.theta)*_.width/2;var T=Math.sin(_.theta)*_.width/2;var k=n.segmentDistance(d,m,y,x,_.x-w,_.y-T,_.x+w,_.y+T)*2/(t.height+_.height);var M=_.level===t.level;var A=M?g.SAMELEVELDISTANCE:1;if(k<=A)return Infinity;var S=g.NEIGHBORCOST*(M?g.SAMELEVELFACTOR:1);v+=S/(k-A)}return v}r.addLabelData=function(e,t,r,a){var n=t.fontSize;var i=t.width+n/3;var o=Math.max(0,t.height-n/3);var s=e.x;var l=e.y;var u=e.theta;var c=Math.sin(u);var f=Math.cos(u);var h=function(e,t){return[s+e*f-t*c,l+e*c+t*f]};var p=[h(-i/2,-o/2),h(-i/2,o/2),h(i/2,o/2),h(i/2,-o/2)];r.push({text:t.text,x:s,y:l,dy:t.dy,theta:u,level:t.level,width:i,height:o});a.push(p)};r.drawLabels=function(e,t,r,i,o){var l=e.selectAll("text").data(t,(function(e){return e.text+","+e.x+","+e.y+","+e.theta}));l.exit().remove();l.enter().append("text").attr({"data-notex":1,"text-anchor":"middle"}).each((function(e){var t=e.x+Math.sin(e.theta)*e.dy;var n=e.y-Math.cos(e.theta)*e.dy;a.select(this).text(e.text).attr({x:t,y:n,transform:"rotate("+180*e.theta/Math.PI+" "+t+" "+n+")"}).call(s.convertToTspans,r)}));if(o){var u="";for(var c=0;c<o.length;c++){u+="M"+o[c].join("L")+"Z"}var f=n.ensureSingle(i,"path","");f.attr("d",u)}};function T(e,t,r,a,o){var s=a.trace;var l=r._fullLayout._clips;var u="clip"+s.uid;var c=l.selectAll("#"+u).data(s.connectgaps?[]:[0]);c.enter().append("clipPath").classed("contourclip",true).attr("id",u);c.exit().remove();if(s.connectgaps===false){var p={level:.9,crossings:{},starts:[],edgepaths:[],paths:[],xaxis:t.xaxis,yaxis:t.yaxis,x:a.x,y:a.y,z:k(a),smoothing:0};f([p]);h([p]);d([p],{type:"levels"});var v=n.ensureSingle(c,"path","");v.attr("d",(p.prefixBoundary?"M"+o.join("L")+"Z":"")+b(p,o))}else u=null;i.setClipUrl(e,u,r)}function k(e){var t=e.trace._emptypoints;var r=[];var a=e.z.length;var n=e.z[0].length;var i;var o=[];var s;for(i=0;i<n;i++)o.push(1);for(i=0;i<a;i++)r.push(o.slice());for(i=0;i<t.length;i++){s=t[i];r[s[0]][s[1]]=0}e.zmask=r;return r}},{"../../components/colorscale":662,"../../components/drawing":672,"../../lib":787,"../../lib/svg_text_utils":813,"../../plots/cartesian/axes":838,"../../plots/cartesian/set_convert":859,"../heatmap/plot":1080,"./close_boundaries":1014,"./constants":1016,"./convert_to_constraints":1020,"./empty_pathinfo":1022,"./find_all_paths":1024,"./make_crossings":1029,"@plotly/d3":58}],1031:[function(e,t,r){"use strict";var a=e("../../plots/cartesian/axes");var n=e("../../lib");t.exports=function e(t,r){var o=t.contours;if(t.autocontour){var s=t.zmin;var l=t.zmax;if(t.zauto||s===undefined){s=n.aggNums(Math.min,null,r)}if(t.zauto||l===undefined){l=n.aggNums(Math.max,null,r)}var u=i(s,l,t.ncontours);o.size=u.dtick;o.start=a.tickFirst(u);u.range.reverse();o.end=a.tickFirst(u);if(o.start===s)o.start+=o.size;if(o.end===l)o.end-=o.size;if(o.start>o.end){o.start=o.end=(o.start+o.end)/2}if(!t._input.contours)t._input.contours={};n.extendFlat(t._input.contours,{start:o.start,end:o.end,size:o.size});t._input.autocontour=true}else if(o.type!=="constraint"){var c=o.start;var f=o.end;var h=t._input.contours;if(c>f){o.start=h.start=f;f=o.end=h.end=c;c=o.start}if(!(o.size>0)){var p;if(c===f)p=1;else p=i(c,f,t.ncontours).dtick;h.size=o.size=p}}};function i(e,t,r){var n={type:"linear",range:[e,t]};a.autoTicks(n,(t-e)/(r||15));return n}},{"../../lib":787,"../../plots/cartesian/axes":838}],1032:[function(e,t,r){"use strict";var a=e("@plotly/d3");var n=e("../../components/drawing");var i=e("../heatmap/style");var o=e("./make_color_map");t.exports=function e(t){var r=a.select(t).selectAll("g.contour");r.style("opacity",(function(e){return e[0].trace.opacity}));r.each((function(e){var t=a.select(this);var r=e[0].trace;var i=r.contours;var s=r.line;var l=i.size||1;var u=i.start;var c=i.type==="constraint";var f=!c&&i.coloring==="lines";var h=!c&&i.coloring==="fill";var p=f||h?o(r):null;t.selectAll("g.contourlevel").each((function(e){a.select(this).selectAll("path").call(n.lineGroupStyle,s.width,f?p(e.level):s.color,s.dash)}));var v=i.labelfont;t.selectAll("g.contourlabels text").each((function(e){n.font(a.select(this),{family:v.family,size:v.size,color:v.color||(f?p(e.level):s.color)})}));if(c){t.selectAll("g.contourfill path").style("fill",r.fillcolor)}else if(h){var d;t.selectAll("g.contourfill path").style("fill",(function(e){if(d===undefined)d=e.level;return p(e.level+.5*l)}));if(d===undefined)d=u;t.selectAll("g.contourbg path").style("fill",p(d-.5*l))}}));i(t)}},{"../../components/drawing":672,"../heatmap/style":1081,"./make_color_map":1028,"@plotly/d3":58}],1033:[function(e,t,r){"use strict";var a=e("../../components/colorscale/defaults");var n=e("./label_defaults");t.exports=function e(t,r,i,o,s){var l=i("contours.coloring");var u;var c="";if(l==="fill")u=i("contours.showlines");if(u!==false){if(l!=="lines")c=i("line.color","#000");i("line.width",.5);i("line.dash")}if(l!=="none"){if(t.showlegend!==true)r.showlegend=false;r._dfltShowLegend=false;a(t,r,o,i,{prefix:"",cLetter:"z"})}i("line.smoothing");n(i,o,c,s)}},{"../../components/colorscale/defaults":660,"./label_defaults":1027}],1034:[function(e,t,r){"use strict";var a=e("../heatmap/attributes");var n=e("../contour/attributes");var i=e("../../components/colorscale/attributes");var o=e("../../lib/extend").extendFlat;var s=n.contours;t.exports=o({carpet:{valType:"string",editType:"calc"},z:a.z,a:a.x,a0:a.x0,da:a.dx,b:a.y,b0:a.y0,db:a.dy,text:a.text,hovertext:a.hovertext,transpose:a.transpose,atype:a.xtype,btype:a.ytype,fillcolor:n.fillcolor,autocontour:n.autocontour,ncontours:n.ncontours,contours:{type:s.type,start:s.start,end:s.end,size:s.size,coloring:{valType:"enumerated",values:["fill","lines","none"],dflt:"fill",editType:"calc"},showlines:s.showlines,showlabels:s.showlabels,labelfont:s.labelfont,labelformat:s.labelformat,operation:s.operation,value:s.value,editType:"calc",impliedEdits:{autocontour:false}},line:{color:n.line.color,width:n.line.width,dash:n.line.dash,smoothing:n.line.smoothing,editType:"plot"},transforms:undefined},i("",{cLetter:"z",autoColorDflt:false}))},{"../../components/colorscale/attributes":657,"../../lib/extend":777,"../contour/attributes":1012,"../heatmap/attributes":1069}],1035:[function(e,t,r){"use strict";var a=e("../../components/colorscale/calc");var n=e("../../lib");var i=e("../heatmap/convert_column_xyz");var o=e("../heatmap/clean_2d_array");var s=e("../heatmap/interp2d");var l=e("../heatmap/find_empties");var u=e("../heatmap/make_bound_array");var c=e("./defaults");var f=e("../carpet/lookup_carpetid");var h=e("../contour/set_contours");t.exports=function e(t,r){var a=r._carpetTrace=f(t,r);if(!a||!a.visible||a.visible==="legendonly")return;if(!r.a||!r.b){var n=t.data[a.index];var i=t.data[r.index];if(!i.a)i.a=n.a;if(!i.b)i.b=n.b;c(i,r,r._defaultColor,t._fullLayout)}var o=p(t,r);h(r,r._z);return o};function p(e,t){var r=t._carpetTrace;var c=r.aaxis;var f=r.baxis;var h,p,v,d,m,g,y;c._minDtick=0;f._minDtick=0;if(n.isArray1D(t.z))i(t,c,f,"a","b",["z"]);h=t._a=t._a||t.a;d=t._b=t._b||t.b;h=h?c.makeCalcdata(t,"_a"):[];d=d?f.makeCalcdata(t,"_b"):[];p=t.a0||0;v=t.da||1;m=t.b0||0;g=t.db||1;y=t._z=o(t._z||t.z,t.transpose);t._emptypoints=l(y);s(y,t._emptypoints);var x=n.maxRowLength(y);var b=t.xtype==="scaled"?"":h;var _=u(t,b,p,v,x,c);var w=t.ytype==="scaled"?"":d;var T=u(t,w,m,g,y.length,f);var k={a:_,b:T,z:y};if(t.contours.type==="levels"&&t.contours.coloring!=="none"){a(e,t,{vals:y,containerStr:"",cLetter:"z"})}return[k]}},{"../../components/colorscale/calc":658,"../../lib":787,"../carpet/lookup_carpetid":985,"../contour/set_contours":1031,"../heatmap/clean_2d_array":1071,"../heatmap/convert_column_xyz":1073,"../heatmap/find_empties":1075,"../heatmap/interp2d":1078,"../heatmap/make_bound_array":1079,"./defaults":1036}],1036:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("../heatmap/xyz_defaults");var i=e("./attributes");var o=e("../contour/constraint_defaults");var s=e("../contour/contours_defaults");var l=e("../contour/style_defaults");t.exports=function e(t,r,u,c){function f(e,n){return a.coerce(t,r,i,e,n)}function h(e){return a.coerce2(t,r,i,e)}f("carpet");if(t.a&&t.b){var p=n(t,r,f,c,"a","b");if(!p){r.visible=false;return}f("text");var v=f("contours.type")==="constraint";if(v){o(t,r,f,c,u,{hasHover:false})}else{s(t,r,f,h);l(t,r,f,c,{hasHover:false})}}else{r._defaultColor=u;r._length=null}}},{"../../lib":787,"../contour/constraint_defaults":1017,"../contour/contours_defaults":1019,"../contour/style_defaults":1033,"../heatmap/xyz_defaults":1083,"./attributes":1034}],1037:[function(e,t,r){"use strict";t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),colorbar:e("../contour/colorbar"),calc:e("./calc"),plot:e("./plot"),style:e("../contour/style"),moduleType:"trace",name:"contourcarpet",basePlotModule:e("../../plots/cartesian"),categories:["cartesian","svg","carpet","contour","symbols","showLegend","hasLines","carpetDependent","noHover","noSortingByValue"],meta:{}}},{"../../plots/cartesian":852,"../contour/colorbar":1015,"../contour/style":1032,"./attributes":1034,"./calc":1035,"./defaults":1036,"./plot":1038}],1038:[function(e,t,r){"use strict";var a=e("@plotly/d3");var n=e("../carpet/map_1d_array");var i=e("../carpet/makepath");var o=e("../../components/drawing");var s=e("../../lib");var l=e("../contour/make_crossings");var u=e("../contour/find_all_paths");var c=e("../contour/plot");var f=e("../contour/constants");var h=e("../contour/convert_to_constraints");var p=e("../contour/empty_pathinfo");var v=e("../contour/close_boundaries");var d=e("../carpet/lookup_carpetid");var m=e("../carpet/axis_aligned_line");t.exports=function e(t,r,c,f){var v=r.xaxis;var m=r.yaxis;s.makeTraceGroups(f,c,"contour").each((function(e){var s=a.select(this);var c=e[0];var f=c.trace;var x=f._carpetTrace=d(t,f);var b=t.calcdata[x.index][0];if(!x.visible||x.visible==="legendonly")return;var _=c.a;var w=c.b;var M=f.contours;var A=p(M,r,c);var S=M.type==="constraint";var E=M._operation;var L=S?E==="="?"lines":"fill":M.coloring;function C(e){var t=x.ab2xy(e[0],e[1],true);return[v.c2p(t[0]),m.c2p(t[1])]}var I=[[_[0],w[w.length-1]],[_[_.length-1],w[w.length-1]],[_[_.length-1],w[0]],[_[0],w[0]]];l(A);var P=(_[_.length-1]-_[0])*1e-8;var O=(w[w.length-1]-w[0])*1e-8;u(A,P,O);var z=A;if(M.type==="constraint"){z=h(A,E)}g(A,C);var D,R,F,B;var N=[];for(B=b.clipsegments.length-1;B>=0;B--){D=b.clipsegments[B];R=n([],D.x,v.c2p);F=n([],D.y,m.c2p);R.reverse();F.reverse();N.push(i(R,F,D.bicubic))}var j="M"+N.join("L")+"Z";T(s,b.clipsegments,v,m,S,L);k(f,s,v,m,z,I,C,x,b,L,j);y(s,A,t,c,M,r,x);o.setClipUrl(s,x._clipPathId,t)}))};function g(e,t){var r,a,n,i,o,s,l,u,c;for(r=0;r<e.length;r++){i=e[r];o=i.pedgepaths=[];s=i.ppaths=[];for(a=0;a<i.edgepaths.length;a++){c=i.edgepaths[a];l=[];for(n=0;n<c.length;n++){l[n]=t(c[n])}o.push(l)}for(a=0;a<i.paths.length;a++){c=i.paths[a];u=[];for(n=0;n<c.length;n++){u[n]=t(c[n])}s.push(u)}}}function y(e,t,r,n,i,l,u){var h=s.ensureSingle(e,"g","contourlines");var p=i.showlines!==false;var v=i.showlabels;var d=p&&v;var m=c.createLines(h,p||v,t);var g=c.createLineClip(h,d,r,n.trace.uid);var y=e.selectAll("g.contourlabels").data(v?[0]:[]);y.exit().remove();y.enter().append("g").classed("contourlabels",true);if(v){var b=l.xaxis;var _=l.yaxis;var w=b._length;var T=_._length;var k=[[[0,0],[w,0],[w,T],[0,T]]];var M=[];s.clearLocationCache();var A=c.labelFormatter(r,n);var S=o.tester.append("text").attr("data-notex",1).call(o.font,i.labelfont);var E={left:0,right:w,center:w/2,top:0,bottom:T,middle:T/2};var L=Math.sqrt(w*w+T*T);var C=f.LABELDISTANCE*L/Math.max(1,t.length/f.LABELINCREASE);m.each((function(e){var t=c.calcTextOpts(e.level,A,S,r);a.select(this).selectAll("path").each((function(r){var a=this;var n=s.getVisibleSegment(a,E,t.height/2);if(!n)return;x(a,r,e,n,u,t.height);if(n.len<(t.width+t.height)*f.LABELMIN)return;var i=Math.min(Math.ceil(n.len/C),f.LABELMAX);for(var o=0;o<i;o++){var l=c.findBestTextLocation(a,n,t,M,E);if(!l)break;c.addLabelData(l,t,M,k)}}))}));S.remove();c.drawLabels(y,M,r,g,d?k:null)}if(v&&!p)m.remove()}function x(e,t,r,a,n,i){var o;for(var s=0;s<r.pedgepaths.length;s++){if(t===r.pedgepaths[s]){o=r.edgepaths[s]}}if(!o)return;var l=n.a[0];var u=n.a[n.a.length-1];var c=n.b[0];var f=n.b[n.b.length-1];function h(e,t){var r=0;var a;var o=.1;if(Math.abs(e[0]-l)<o||Math.abs(e[0]-u)<o){a=_(n.dxydb_rough(e[0],e[1],o));r=Math.max(r,i*w(t,a)/2)}if(Math.abs(e[1]-c)<o||Math.abs(e[1]-f)<o){a=_(n.dxyda_rough(e[0],e[1],o));r=Math.max(r,i*w(t,a)/2)}return r}var p=b(e,0,1);var v=b(e,a.total,a.total-1);var d=h(o[0],p);var m=a.total-h(o[o.length-1],v);if(a.min<d)a.min=d;if(a.max>m)a.max=m;a.len=a.max-a.min}function b(e,t,r){var a=e.getPointAtLength(t);var n=e.getPointAtLength(r);var i=n.x-a.x;var o=n.y-a.y;var s=Math.sqrt(i*i+o*o);return[i/s,o/s]}function _(e){var t=Math.sqrt(e[0]*e[0]+e[1]*e[1]);return[e[0]/t,e[1]/t]}function w(e,t){var r=Math.abs(e[0]*t[0]+e[1]*t[1]);var a=Math.sqrt(1-r*r);return a/r}function T(e,t,r,a,o,l){var u,c,f,h;var p=s.ensureSingle(e,"g","contourbg");var v=p.selectAll("path").data(l==="fill"&&!o?[0]:[]);v.enter().append("path");v.exit().remove();var d=[];for(h=0;h<t.length;h++){u=t[h];c=n([],u.x,r.c2p);f=n([],u.y,a.c2p);d.push(i(c,f,u.bicubic))}v.attr("d","M"+d.join("L")+"Z").style("stroke","none")}function k(e,t,r,n,i,o,l,u,c,f,h){var p=f==="fill";if(p){v(i,e.contours)}var d=s.ensureSingle(t,"g","contourfill");var m=d.selectAll("path").data(p?i:[]);m.enter().append("path");m.exit().remove();m.each((function(t){var i=(t.prefixBoundary?h:"")+M(e,t,o,l,u,c,r,n);if(!i){a.select(this).remove()}else{a.select(this).attr("d",i).style("stroke","none")}}))}function M(e,t,r,a,n,i,l,u){var c;var f="";var h=t.edgepaths.map((function(e,t){return t}));var p=true;var v,d,g,y,x,b;var _=Math.abs(r[0][0]-r[2][0])*1e-4;var w=Math.abs(r[0][1]-r[2][1])*1e-4;function T(e){return Math.abs(e[1]-r[0][1])<w}function k(e){return Math.abs(e[1]-r[2][1])<w}function M(e){return Math.abs(e[0]-r[0][0])<_}function A(e){return Math.abs(e[0]-r[2][0])<_}function S(e,t){var r,a,o,s;var c="";if(T(e)&&!A(e)||k(e)&&!M(e)){s=n.aaxis;o=m(n,i,[e[0],t[0]],.5*(e[1]+t[1]))}else{s=n.baxis;o=m(n,i,.5*(e[0]+t[0]),[e[1],t[1]])}for(r=1;r<o.length;r++){c+=s.smoothing?"C":"L";for(a=0;a<o[r].length;a++){var f=o[r][a];c+=[l.c2p(f[0]),u.c2p(f[1])]+" "}}return c}c=0;v=null;while(h.length){var E=t.edgepaths[c][0];if(v){f+=S(v,E)}b=o.smoothopen(t.edgepaths[c].map(a),t.smoothing);f+=p?b:b.replace(/^M/,"L");h.splice(h.indexOf(c),1);v=t.edgepaths[c][t.edgepaths[c].length-1];y=-1;for(g=0;g<4;g++){if(!v){s.log("Missing end?",c,t);break}if(T(v)&&!A(v)){d=r[1]}else if(M(v)){d=r[0]}else if(k(v)){d=r[3]}else if(A(v)){d=r[2]}for(x=0;x<t.edgepaths.length;x++){var L=t.edgepaths[x][0];if(Math.abs(v[0]-d[0])<_){if(Math.abs(v[0]-L[0])<_&&(L[1]-v[1])*(d[1]-L[1])>=0){d=L;y=x}}else if(Math.abs(v[1]-d[1])<w){if(Math.abs(v[1]-L[1])<w&&(L[0]-v[0])*(d[0]-L[0])>=0){d=L;y=x}}else{s.log("endpt to newendpt is not vert. or horz.",v,d,L)}}if(y>=0)break;f+=S(v,d);v=d}if(y===t.edgepaths.length){s.log("unclosed perimeter path");break}c=y;p=h.indexOf(c)===-1;if(p){c=h[0];f+=S(v,d)+"Z";v=null}}for(c=0;c<t.paths.length;c++){f+=o.smoothclosed(t.paths[c].map(a),t.smoothing)}return f}},{"../../components/drawing":672,"../../lib":787,"../carpet/axis_aligned_line":969,"../carpet/lookup_carpetid":985,"../carpet/makepath":986,"../carpet/map_1d_array":987,"../contour/close_boundaries":1014,"../contour/constants":1016,"../contour/convert_to_constraints":1020,"../contour/empty_pathinfo":1022,"../contour/find_all_paths":1024,"../contour/make_crossings":1029,"../contour/plot":1030,"@plotly/d3":58}],1039:[function(e,t,r){"use strict";var a=e("../../components/colorscale/attributes");var n=e("../../plots/template_attributes").hovertemplateAttrs;var i=e("../../plots/attributes");var o=e("../scattermapbox/attributes");var s=e("../../lib/extend").extendFlat;t.exports=s({lon:o.lon,lat:o.lat,z:{valType:"data_array",editType:"calc"},radius:{valType:"number",editType:"plot",arrayOk:true,min:1,dflt:30},below:{valType:"string",editType:"plot"},text:o.text,hovertext:o.hovertext,hoverinfo:s({},i.hoverinfo,{flags:["lon","lat","z","text","name"]}),hovertemplate:n(),showlegend:s({},i.showlegend,{dflt:false})},a("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../plots/attributes":834,"../../plots/template_attributes":910,"../scattermapbox/attributes":1267}],1040:[function(e,t,r){"use strict";var a=e("fast-isnumeric");var n=e("../../lib").isArrayOrTypedArray;var i=e("../../constants/numerical").BADNUM;var o=e("../../components/colorscale/calc");var s=e("../../lib")._;t.exports=function e(t,r){var l=r._length;var u=new Array(l);var c=r.z;var f=n(c)&&c.length;for(var h=0;h<l;h++){var p=u[h]={};var v=r.lon[h];var d=r.lat[h];p.lonlat=a(v)&&a(d)?[+v,+d]:[i,i];if(f){var m=c[h];p.z=a(m)?m:i}}o(t,r,{vals:f?c:[0,1],containerStr:"",cLetter:"z"});if(l){u[0].t={labels:{lat:s(t,"lat:")+" ",lon:s(t,"lon:")+" "}}}return u}},{"../../components/colorscale/calc":658,"../../constants/numerical":763,"../../lib":787,"fast-isnumeric":246}],1041:[function(e,t,r){"use strict";var a=e("fast-isnumeric");var n=e("../../lib");var i=e("../../components/color");var o=e("../../components/colorscale");var s=e("../../constants/numerical").BADNUM;var l=e("../../lib/geojson_utils").makeBlank;t.exports=function e(t){var r=t[0].trace;var u=r.visible===true&&r._length!==0;var c={layout:{visibility:"none"},paint:{}};var f=r._opts={heatmap:c,geojson:l()};if(!u)return f;var h=[];var p;var v=r.z;var d=r.radius;var m=n.isArrayOrTypedArray(v)&&v.length;var g=n.isArrayOrTypedArray(d);for(p=0;p<t.length;p++){var y=t[p];var x=y.lonlat;if(x[0]!==s){var b={};if(m){var _=y.z;b.z=_!==s?_:0}if(g){b.r=a(d[p])&&d[p]>0?+d[p]:0}h.push({type:"Feature",geometry:{type:"Point",coordinates:x},properties:b})}}var w=o.extractOpts(r);var T=w.reversescale?o.flipScale(w.colorscale):w.colorscale;var k=T[0][1];var M=i.opacity(k)<1?k:i.addOpacity(k,0);var A=["interpolate",["linear"],["heatmap-density"],0,M];for(p=1;p<T.length;p++){A.push(T[p][0],T[p][1])}var S=["interpolate",["linear"],["get","z"],w.min,0,w.max,1];n.extendFlat(f.heatmap.paint,{"heatmap-weight":m?S:1/(w.max-w.min),"heatmap-color":A,"heatmap-radius":g?{type:"identity",property:"r"}:r.radius,"heatmap-opacity":r.opacity});f.geojson={type:"FeatureCollection",features:h};f.heatmap.layout.visibility="visible";return f}},{"../../components/color":650,"../../components/colorscale":662,"../../constants/numerical":763,"../../lib":787,"../../lib/geojson_utils":781,"fast-isnumeric":246}],1042:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("../../components/colorscale/defaults");var i=e("./attributes");t.exports=function e(t,r,o,s){function l(e,n){return a.coerce(t,r,i,e,n)}var u=l("lon")||[];var c=l("lat")||[];var f=Math.min(u.length,c.length);if(!f){r.visible=false;return}r._length=f;l("z");l("radius");l("below");l("text");l("hovertext");l("hovertemplate");n(t,r,s,l,{prefix:"",cLetter:"z"})}},{"../../components/colorscale/defaults":660,"../../lib":787,"./attributes":1039}],1043:[function(e,t,r){"use strict";t.exports=function e(t,r){t.lon=r.lon;t.lat=r.lat;t.z=r.z;return t}},{}],1044:[function(e,t,r){"use strict";var a=e("../../plots/cartesian/axes");var n=e("../scattermapbox/hover").hoverPoints;var i=e("../scattermapbox/hover").getExtraText;t.exports=function e(t,r,o){var s=n(t,r,o);if(!s)return;var l=s[0];var u=l.cd;var c=u[0].trace;var f=u[l.index];delete l.color;if("z"in f){var h=l.subplot.mockAxis;l.z=f.z;l.zLabel=a.tickText(h,h.c2l(f.z),"hover").text}l.extraText=i(c,f,u[0].t.labels);return[l]}},{"../../plots/cartesian/axes":838,"../scattermapbox/hover":1272}],1045:[function(e,t,r){"use strict";t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),colorbar:e("../heatmap/colorbar"),formatLabels:e("../scattermapbox/format_labels"),calc:e("./calc"),plot:e("./plot"),hoverPoints:e("./hover"),eventData:e("./event_data"),getBelow:function(e,t){var r=t.getMapLayers();for(var a=0;a<r.length;a++){var n=r[a];var i=n.id;if(n.type==="symbol"&&typeof i==="string"&&i.indexOf("plotly-")===-1){return i}}},moduleType:"trace",name:"densitymapbox",basePlotModule:e("../../plots/mapbox"),categories:["mapbox","gl","showLegend"],meta:{hr_name:"density_mapbox"}}},{"../../plots/mapbox":895,"../heatmap/colorbar":1072,"../scattermapbox/format_labels":1271,"./attributes":1039,"./calc":1040,"./defaults":1042,"./event_data":1043,"./hover":1044,"./plot":1046}],1046:[function(e,t,r){"use strict";var a=e("./convert");var n=e("../../plots/mapbox/constants").traceLayerPrefix;function i(e,t){this.type="densitymapbox";this.subplot=e;this.uid=t;this.sourceId="source-"+t;this.layerList=[["heatmap",n+t+"-heatmap"]];this.below=null}var o=i.prototype;o.update=function(e){var t=this.subplot;var r=this.layerList;var n=a(e);var i=t.belowLookup["trace-"+this.uid];t.map.getSource(this.sourceId).setData(n.geojson);if(i!==this.below){this._removeLayers();this._addLayers(n,i);this.below=i}for(var o=0;o<r.length;o++){var s=r[o];var l=s[0];var u=s[1];var c=n[l];t.setOptions(u,"setLayoutProperty",c.layout);if(c.layout.visibility==="visible"){t.setOptions(u,"setPaintProperty",c.paint)}}};o._addLayers=function(e,t){var r=this.subplot;var a=this.layerList;var n=this.sourceId;for(var i=0;i<a.length;i++){var o=a[i];var s=o[0];var l=e[s];r.addLayer({type:s,id:o[1],source:n,layout:l.layout,paint:l.paint},t)}};o._removeLayers=function(){var e=this.subplot.map;var t=this.layerList;for(var r=t.length-1;r>=0;r--){e.removeLayer(t[r][1])}};o.dispose=function(){var e=this.subplot.map;this._removeLayers();e.removeSource(this.sourceId)};t.exports=function e(t,r){var n=r[0].trace;var o=new i(t,n.uid);var s=o.sourceId;var l=a(r);var u=o.below=t.belowLookup["trace-"+n.uid];t.map.addSource(s,{type:"geojson",data:l.geojson});o._addLayers(l,u);return o}},{"../../plots/mapbox/constants":893,"./convert":1041}],1047:[function(e,t,r){"use strict";var a=e("../../lib");t.exports=function e(t,r){for(var n=0;n<t.length;n++)t[n].i=n;a.mergeArray(r.text,t,"tx");a.mergeArray(r.hovertext,t,"htx");var i=r.marker;if(i){a.mergeArray(i.opacity,t,"mo");a.mergeArray(i.color,t,"mc");var o=i.line;if(o){a.mergeArray(o.color,t,"mlc");a.mergeArrayCastPositive(o.width,t,"mlw")}}}},{"../../lib":787}],1048:[function(e,t,r){"use strict";var a=e("../bar/attributes");var n=e("../scatter/attributes").line;var i=e("../../plots/attributes");var o=e("../../plots/cartesian/axis_format_attributes").axisHoverFormat;var s=e("../../plots/template_attributes").hovertemplateAttrs;var l=e("../../plots/template_attributes").texttemplateAttrs;var u=e("./constants");var c=e("../../lib/extend").extendFlat;var f=e("../../components/color");t.exports={x:a.x,x0:a.x0,dx:a.dx,y:a.y,y0:a.y0,dy:a.dy,xperiod:a.xperiod,yperiod:a.yperiod,xperiod0:a.xperiod0,yperiod0:a.yperiod0,xperiodalignment:a.xperiodalignment,yperiodalignment:a.yperiodalignment,xhoverformat:o("x"),yhoverformat:o("y"),hovertext:a.hovertext,hovertemplate:s({},{keys:u.eventDataKeys}),hoverinfo:c({},i.hoverinfo,{flags:["name","x","y","text","percent initial","percent previous","percent total"]}),textinfo:{valType:"flaglist",flags:["label","text","percent initial","percent previous","percent total","value"],extras:["none"],editType:"plot",arrayOk:false},texttemplate:l({editType:"plot"},{keys:u.eventDataKeys.concat(["label","value"])}),text:a.text,textposition:a.textposition,insidetextanchor:c({},a.insidetextanchor,{dflt:"middle"}),textangle:c({},a.textangle,{dflt:0}),textfont:a.textfont,insidetextfont:a.insidetextfont,outsidetextfont:a.outsidetextfont,constraintext:a.constraintext,cliponaxis:a.cliponaxis,orientation:c({},a.orientation,{}),offset:c({},a.offset,{arrayOk:false}),width:c({},a.width,{arrayOk:false}),marker:h(),connector:{fillcolor:{valType:"color",editType:"style"},line:{color:c({},n.color,{dflt:f.defaultLine}),width:c({},n.width,{dflt:0,editType:"plot"}),dash:n.dash,editType:"style"},visible:{valType:"boolean",dflt:true,editType:"plot"},editType:"plot"},offsetgroup:a.offsetgroup,alignmentgroup:a.alignmentgroup};function h(){var e=c({},a.marker);delete e.pattern;return e}},{"../../components/color":650,"../../lib/extend":777,"../../plots/attributes":834,"../../plots/cartesian/axis_format_attributes":841,"../../plots/template_attributes":910,"../bar/attributes":925,"../scatter/attributes":1202,"./constants":1050}],1049:[function(e,t,r){"use strict";var a=e("../../plots/cartesian/axes");var n=e("../../plots/cartesian/align_period");var i=e("./arrays_to_calcdata");var o=e("../scatter/calc_selection");var s=e("../../constants/numerical").BADNUM;t.exports=function e(t,r){var u=a.getFromId(t,r.xaxis||"x");var c=a.getFromId(t,r.yaxis||"y");var f,h,p,v,d,m,g,y;if(r.orientation==="h"){f=u.makeCalcdata(r,"x");p=c.makeCalcdata(r,"y");v=n(r,c,"y",p);d=!!r.yperiodalignment;m="y"}else{f=c.makeCalcdata(r,"y");p=u.makeCalcdata(r,"x");v=n(r,u,"x",p);d=!!r.xperiodalignment;m="x"}h=v.vals;var x=Math.min(h.length,f.length);var b=new Array(x);r._base=[];for(g=0;g<x;g++){if(f[g]<0)f[g]=s;var _=false;if(f[g]!==s){if(g+1<x&&f[g+1]!==s){_=true}}y=b[g]={p:h[g],s:f[g],cNext:_};r._base[g]=-.5*y.s;if(d){b[g].orig_p=p[g];b[g][m+"End"]=v.ends[g];b[g][m+"Start"]=v.starts[g]}if(r.ids){y.id=String(r.ids[g])}if(g===0)b[0].vTotal=0;b[0].vTotal+=l(y.s);y.begR=l(y.s)/l(b[0].s)}var w;for(g=0;g<x;g++){y=b[g];if(y.s===s)continue;y.sumR=y.s/b[0].vTotal;y.difR=w!==undefined?y.s/w:1;w=y.s}i(b,r);o(b,r);return b};function l(e){return e===s?0:e}},{"../../constants/numerical":763,"../../plots/cartesian/align_period":835,"../../plots/cartesian/axes":838,"../scatter/calc_selection":1204,"./arrays_to_calcdata":1047}],1050:[function(e,t,r){"use strict";t.exports={eventDataKeys:["percentInitial","percentPrevious","percentTotal"]}},{}],1051:[function(e,t,r){"use strict";var a=e("../bar/cross_trace_calc").setGroupPositions;t.exports=function e(t,r){var n=t._fullLayout;var i=t._fullData;var o=t.calcdata;var s=r.xaxis;var l=r.yaxis;var u=[];var c=[];var f=[];var h,p;for(p=0;p<i.length;p++){var v=i[p];var d=v.orientation==="h";if(v.visible===true&&v.xaxis===s._id&&v.yaxis===l._id&&v.type==="funnel"){h=o[p];if(d){f.push(h)}else{c.push(h)}u.push(h)}}var m={mode:n.funnelmode,norm:n.funnelnorm,gap:n.funnelgap,groupgap:n.funnelgroupgap};a(t,s,l,c,m);a(t,l,s,f,m);for(p=0;p<u.length;p++){h=u[p];for(var g=0;g<h.length;g++){if(g+1<h.length){h[g].nextP0=h[g+1].p0;h[g].nextS0=h[g+1].s0;h[g].nextP1=h[g+1].p1;h[g].nextS1=h[g+1].s1}}}}},{"../bar/cross_trace_calc":928}],1052:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("../bar/defaults").handleGroupingDefaults;var i=e("../bar/defaults").handleText;var o=e("../scatter/xy_defaults");var s=e("../scatter/period_defaults");var l=e("./attributes");var u=e("../../components/color");function c(e,t,r,n){function c(r,n){return a.coerce(e,t,l,r,n)}var h=o(e,t,n,c);if(!h){t.visible=false;return}s(e,t,n,c);c("xhoverformat");c("yhoverformat");c("orientation",t.y&&!t.x?"v":"h");c("offset");c("width");var p=c("text");c("hovertext");c("hovertemplate");var v=c("textposition");i(e,t,n,c,v,{moduleHasSelected:false,moduleHasUnselected:false,moduleHasConstrain:true,moduleHasCliponaxis:true,moduleHasTextangle:true,moduleHasInsideanchor:true});if(t.textposition!=="none"&&!t.texttemplate){c("textinfo",Array.isArray(p)?"text+value":"value")}var d=c("marker.color",r);c("marker.line.color",u.defaultLine);c("marker.line.width");var m=c("connector.visible");if(m){c("connector.fillcolor",f(d));var g=c("connector.line.width");if(g){c("connector.line.color");c("connector.line.dash")}}}function f(e){var t=a.isArrayOrTypedArray(e)?"#000":e;return u.addOpacity(t,.5*u.opacity(t))}function h(e,t){var r,i;function o(e){return a.coerce(i._input,i,l,e)}if(t.funnelmode==="group"){for(var s=0;s<e.length;s++){i=e[s];r=i._input;n(r,i,t,o)}}}t.exports={supplyDefaults:c,crossTraceDefaults:h}},{"../../components/color":650,"../../lib":787,"../bar/defaults":929,"../scatter/period_defaults":1222,"../scatter/xy_defaults":1229,"./attributes":1048}],1053:[function(e,t,r){"use strict";t.exports=function e(t,r){t.x="xVal"in r?r.xVal:r.x;t.y="yVal"in r?r.yVal:r.y;if("percentInitial"in r)t.percentInitial=r.percentInitial;if("percentPrevious"in r)t.percentPrevious=r.percentPrevious;if("percentTotal"in r)t.percentTotal=r.percentTotal;if(r.xa)t.xaxis=r.xa;if(r.ya)t.yaxis=r.ya;return t}},{}],1054:[function(e,t,r){"use strict";var a=e("../../components/color").opacity;var n=e("../bar/hover").hoverOnBars;var i=e("../../lib").formatPercent;t.exports=function e(t,r,a,s,l){var u=n(t,r,a,s,l);if(!u)return;var c=u.cd;var f=c[0].trace;var h=f.orientation==="h";var p=u.index;var v=c[p];var d=h?"x":"y";u[d+"LabelVal"]=v.s;u.percentInitial=v.begR;u.percentInitialLabel=i(v.begR,1);u.percentPrevious=v.difR;u.percentPreviousLabel=i(v.difR,1);u.percentTotal=v.sumR;u.percentTotalLabel=i(v.sumR,1);var m=v.hi||f.hoverinfo;var g=[];if(m&&m!=="none"&&m!=="skip"){var y=m==="all";var x=m.split("+");var b=function(e){return y||x.indexOf(e)!==-1};if(b("percent initial")){g.push(u.percentInitialLabel+" of initial")}if(b("percent previous")){g.push(u.percentPreviousLabel+" of previous")}if(b("percent total")){g.push(u.percentTotalLabel+" of total")}}u.extraText=g.join("<br>");u.color=o(f,v);return[u]};function o(e,t){var r=e.marker;var n=t.mc||r.color;var i=t.mlc||r.line.color;var o=t.mlw||r.line.width;if(a(n))return n;else if(a(i)&&o)return i}},{"../../components/color":650,"../../lib":787,"../bar/hover":932}],1055:[function(e,t,r){"use strict";t.exports={attributes:e("./attributes"),layoutAttributes:e("./layout_attributes"),supplyDefaults:e("./defaults").supplyDefaults,crossTraceDefaults:e("./defaults").crossTraceDefaults,supplyLayoutDefaults:e("./layout_defaults"),calc:e("./calc"),crossTraceCalc:e("./cross_trace_calc"),plot:e("./plot"),style:e("./style").style,hoverPoints:e("./hover"),eventData:e("./event_data"),selectPoints:e("../bar/select"),moduleType:"trace",name:"funnel",basePlotModule:e("../../plots/cartesian"),categories:["bar-like","cartesian","svg","oriented","showLegend","zoomScale"],meta:{}}},{"../../plots/cartesian":852,"../bar/select":937,"./attributes":1048,"./calc":1049,"./cross_trace_calc":1051,"./defaults":1052,"./event_data":1053,"./hover":1054,"./layout_attributes":1056,"./layout_defaults":1057,"./plot":1058,"./style":1059}],1056:[function(e,t,r){"use strict";t.exports={funnelmode:{valType:"enumerated",values:["stack","group","overlay"],dflt:"stack",editType:"calc"},funnelgap:{valType:"number",min:0,max:1,editType:"calc"},funnelgroupgap:{valType:"number",min:0,max:1,dflt:0,editType:"calc"}}},{}],1057:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("./layout_attributes");t.exports=function(e,t,r){var i=false;function o(r,i){return a.coerce(e,t,n,r,i)}for(var s=0;s<r.length;s++){var l=r[s];if(l.visible&&l.type==="funnel"){i=true;break}}if(i){o("funnelmode");o("funnelgap",.2);o("funnelgroupgap")}}},{"../../lib":787,"./layout_attributes":1056}],1058:[function(e,t,r){"use strict";var a=e("@plotly/d3");var n=e("../../lib");var i=e("../../components/drawing");var o=e("../../constants/numerical").BADNUM;var s=e("../bar/plot");var l=e("../bar/uniform_text").clearMinTextSize;t.exports=function e(t,r,a,n){var i=t._fullLayout;l("funnel",i);u(t,r,a,n);c(t,r,a,n);s.plot(t,r,a,n,{mode:i.funnelmode,norm:i.funnelmode,gap:i.funnelgap,groupgap:i.funnelgroupgap})};function u(e,t,r,s){var l=t.xaxis;var u=t.yaxis;n.makeTraceGroups(s,r,"trace bars").each((function(r){var s=a.select(this);var c=r[0].trace;var h=n.ensureSingle(s,"g","regions");if(!c.connector||!c.connector.visible){h.remove();return}var p=c.orientation==="h";var v=h.selectAll("g.region").data(n.identity);v.enter().append("g").classed("region",true);v.exit().remove();var d=v.size();v.each((function(r,s){if(s!==d-1&&!r.cNext)return;var c=f(r,l,u,p);var h=c[0];var v=c[1];var m="";if(h[0]!==o&&v[0]!==o&&h[1]!==o&&v[1]!==o&&h[2]!==o&&v[2]!==o&&h[3]!==o&&v[3]!==o){if(p){m+="M"+h[0]+","+v[1]+"L"+h[2]+","+v[2]+"H"+h[3]+"L"+h[1]+","+v[1]+"Z"}else{m+="M"+h[1]+","+v[1]+"L"+h[2]+","+v[3]+"V"+v[2]+"L"+h[1]+","+v[0]+"Z"}}if(m==="")m="M0,0Z";n.ensureSingle(a.select(this),"path").attr("d",m).call(i.setClipUrl,t.layerClipId,e)}))}))}function c(e,t,r,o){var s=t.xaxis;var l=t.yaxis;n.makeTraceGroups(o,r,"trace bars").each((function(r){var o=a.select(this);var u=r[0].trace;var c=n.ensureSingle(o,"g","lines");if(!u.connector||!u.connector.visible||!u.connector.line.width){c.remove();return}var h=u.orientation==="h";var p=c.selectAll("g.line").data(n.identity);p.enter().append("g").classed("line",true);p.exit().remove();var v=p.size();p.each((function(r,o){if(o!==v-1&&!r.cNext)return;var u=f(r,s,l,h);var c=u[0];var p=u[1];var d="";if(c[3]!==undefined&&p[3]!==undefined){if(h){d+="M"+c[0]+","+p[1]+"L"+c[2]+","+p[2];d+="M"+c[1]+","+p[1]+"L"+c[3]+","+p[2]}else{d+="M"+c[1]+","+p[1]+"L"+c[2]+","+p[3];d+="M"+c[1]+","+p[0]+"L"+c[2]+","+p[2]}}if(d==="")d="M0,0Z";n.ensureSingle(a.select(this),"path").attr("d",d).call(i.setClipUrl,t.layerClipId,e)}))}))}function f(e,t,r,a){var n=[];var i=[];var o=a?t:r;var s=a?r:t;n[0]=o.c2p(e.s0,true);i[0]=s.c2p(e.p0,true);n[1]=o.c2p(e.s1,true);i[1]=s.c2p(e.p1,true);n[2]=o.c2p(e.nextS0,true);i[2]=s.c2p(e.nextP0,true);n[3]=o.c2p(e.nextS1,true);i[3]=s.c2p(e.nextP1,true);return a?[n,i]:[i,n]}},{"../../components/drawing":672,"../../constants/numerical":763,"../../lib":787,"../bar/plot":936,"../bar/uniform_text":941,"@plotly/d3":58}],1059:[function(e,t,r){"use strict";var a=e("@plotly/d3");var n=e("../../components/drawing");var i=e("../../components/color");var o=e("../../constants/interactions").DESELECTDIM;var s=e("../bar/style");var l=e("../bar/uniform_text").resizeText;var u=s.styleTextPoints;function c(e,t,r){var s=r?r:a.select(e).selectAll("g.funnellayer").selectAll("g.trace");l(e,s,"funnel");s.style("opacity",(function(e){return e[0].trace.opacity}));s.each((function(t){var r=a.select(this);var s=t[0].trace;r.selectAll(".point > path").each((function(e){if(!e.isBlank){var t=s.marker;a.select(this).call(i.fill,e.mc||t.color).call(i.stroke,e.mlc||t.line.color).call(n.dashLine,t.line.dash,e.mlw||t.line.width).style("opacity",s.selectedpoints&&!e.selected?o:1)}}));u(r,s,e);r.selectAll(".regions").each((function(){a.select(this).selectAll("path").style("stroke-width",0).call(i.fill,s.connector.fillcolor)}));r.selectAll(".lines").each((function(){var e=s.connector.line;n.lineGroupStyle(a.select(this).selectAll("path"),e.width,e.color,e.dash)}))}))}t.exports={style:c}},{"../../components/color":650,"../../components/drawing":672,"../../constants/interactions":762,"../bar/style":939,"../bar/uniform_text":941,"@plotly/d3":58}],1060:[function(e,t,r){"use strict";var a=e("../pie/attributes");var n=e("../../plots/attributes");var i=e("../../plots/domain").attributes;var o=e("../../plots/template_attributes").hovertemplateAttrs;var s=e("../../plots/template_attributes").texttemplateAttrs;var l=e("../../lib/extend").extendFlat;t.exports={labels:a.labels,label0:a.label0,dlabel:a.dlabel,values:a.values,marker:{colors:a.marker.colors,line:{color:l({},a.marker.line.color,{dflt:null}),width:l({},a.marker.line.width,{dflt:1}),editType:"calc"},editType:"calc"},text:a.text,hovertext:a.hovertext,scalegroup:l({},a.scalegroup,{}),textinfo:l({},a.textinfo,{flags:["label","text","value","percent"]}),texttemplate:s({editType:"plot"},{keys:["label","color","value","text","percent"]}),hoverinfo:l({},n.hoverinfo,{flags:["label","text","value","percent","name"]}),hovertemplate:o({},{keys:["label","color","value","text","percent"]}),textposition:l({},a.textposition,{values:["inside","none"],dflt:"inside"}),textfont:a.textfont,insidetextfont:a.insidetextfont,title:{text:a.title.text,font:a.title.font,position:l({},a.title.position,{values:["top left","top center","top right"],dflt:"top center"}),editType:"plot"},domain:i({name:"funnelarea",trace:true,editType:"calc"}),aspectratio:{valType:"number",min:0,dflt:1,editType:"plot"},baseratio:{valType:"number",min:0,max:1,dflt:.333,editType:"plot"}}},{"../../lib/extend":777,"../../plots/attributes":834,"../../plots/domain":866,"../../plots/template_attributes":910,"../pie/attributes":1176}],1061:[function(e,t,r){"use strict";var a=e("../../plots/plots");r.name="funnelarea";r.plot=function(e,t,n,i){a.plotBasePlot(r.name,e,t,n,i)};r.clean=function(e,t,n,i){a.cleanBasePlot(r.name,e,t,n,i)}},{"../../plots/plots":901}],1062:[function(e,t,r){"use strict";var a=e("../pie/calc");function n(e,t){return a.calc(e,t)}function i(e){a.crossTraceCalc(e,{type:"funnelarea"})}t.exports={calc:n,crossTraceCalc:i}},{"../pie/calc":1178}],1063:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("./attributes");var i=e("../../plots/domain").defaults;var o=e("../bar/defaults").handleText;var s=e("../pie/defaults").handleLabelsAndValues;t.exports=function e(t,r,l,u){function c(e,i){return a.coerce(t,r,n,e,i)}var f=c("labels");var h=c("values");var p=s(f,h);var v=p.len;r._hasLabels=p.hasLabels;r._hasValues=p.hasValues;if(!r._hasLabels&&r._hasValues){c("label0");c("dlabel")}if(!v){r.visible=false;return}r._length=v;var d=c("marker.line.width");if(d)c("marker.line.color",u.paper_bgcolor);c("marker.colors");c("scalegroup");var m=c("text");var g=c("texttemplate");var y;if(!g)y=c("textinfo",Array.isArray(m)?"text+percent":"percent");c("hovertext");c("hovertemplate");if(g||y&&y!=="none"){var x=c("textposition");o(t,r,u,c,x,{moduleHasSelected:false,moduleHasUnselected:false,moduleHasConstrain:false,moduleHasCliponaxis:false,moduleHasTextangle:false,moduleHasInsideanchor:false})}i(r,u,c);var b=c("title.text");if(b){c("title.position");a.coerceFont(c,"title.font",u.font)}c("aspectratio");c("baseratio")}},{"../../lib":787,"../../plots/domain":866,"../bar/defaults":929,"../pie/defaults":1179,"./attributes":1060}],1064:[function(e,t,r){"use strict";t.exports={moduleType:"trace",name:"funnelarea",basePlotModule:e("./base_plot"),categories:["pie-like","funnelarea","showLegend"],attributes:e("./attributes"),layoutAttributes:e("./layout_attributes"),supplyDefaults:e("./defaults"),supplyLayoutDefaults:e("./layout_defaults"),calc:e("./calc").calc,crossTraceCalc:e("./calc").crossTraceCalc,plot:e("./plot"),style:e("./style"),styleOne:e("../pie/style_one"),meta:{}}},{"../pie/style_one":1187,"./attributes":1060,"./base_plot":1061,"./calc":1062,"./defaults":1063,"./layout_attributes":1065,"./layout_defaults":1066,"./plot":1067,"./style":1068}],1065:[function(e,t,r){"use strict";var a=e("../pie/layout_attributes").hiddenlabels;t.exports={hiddenlabels:a,funnelareacolorway:{valType:"colorlist",editType:"calc"},extendfunnelareacolors:{valType:"boolean",dflt:true,editType:"calc"}}},{"../pie/layout_attributes":1183}],1066:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("./layout_attributes");t.exports=function e(t,r){function i(e,i){return a.coerce(t,r,n,e,i)}i("hiddenlabels");i("funnelareacolorway",r.colorway);i("extendfunnelareacolors")}},{"../../lib":787,"./layout_attributes":1065}],1067:[function(e,t,r){"use strict";var a=e("@plotly/d3");var n=e("../../components/drawing");var i=e("../../lib");var o=i.strScale;var s=i.strTranslate;var l=e("../../lib/svg_text_utils");var u=e("../bar/plot");var c=u.toMoveInsideBar;var f=e("../bar/uniform_text");var h=f.recordMinTextSize;var p=f.clearMinTextSize;var v=e("../pie/helpers");var d=e("../pie/plot");var m=d.attachFxHandlers;var g=d.determineInsideTextFont;var y=d.layoutAreas;var x=d.prerenderTitles;var b=d.positionTitleOutside;var _=d.formatSliceLabel;t.exports=function e(t,r){var u=t._fullLayout;p("funnelarea",u);x(r,t);y(r,u._size);i.makeTraceGroups(u._funnelarealayer,r,"trace").each((function(e){var r=a.select(this);var f=e[0];var p=f.trace;k(e);r.each((function(){var r=a.select(this).selectAll("g.slice").data(e);r.enter().append("g").classed("slice",true);r.exit().remove();r.each((function(r,o){if(r.hidden){a.select(this).selectAll("path,g").remove();return}r.pointNumber=r.i;r.curveNumber=p.index;var s=f.cx;var d=f.cy;var y=a.select(this);var x=y.selectAll("path.surface").data([r]);x.enter().append("path").classed("surface",true).style({"pointer-events":"all"});y.call(m,t,e);var b="M"+(s+r.TR[0])+","+(d+r.TR[1])+w(r.TR,r.BR)+w(r.BR,r.BL)+w(r.BL,r.TL)+"Z";x.attr("d",b);_(t,r,f);var T=v.castOption(p.textposition,r.pts);var k=y.selectAll("g.slicetext").data(r.text&&T!=="none"?[0]:[]);k.enter().append("g").classed("slicetext",true);k.exit().remove();k.each((function(){var f=i.ensureSingle(a.select(this),"text","",(function(e){e.attr("data-notex",1)}));var v=i.ensureUniformFontSize(t,g(p,r,u.font));f.text(r.text).attr({class:"slicetext",transform:"","text-anchor":"middle"}).call(n.font,v).call(l.convertToTspans,t);var m=n.bBox(f.node());var y;var x,b;var _=Math.min(r.BL[1],r.BR[1])+d;var w=Math.max(r.TL[1],r.TR[1])+d;x=Math.max(r.TL[0],r.BL[0])+s;b=Math.min(r.TR[0],r.BR[0])+s;y=c(x,b,_,w,m,{isHorizontal:true,constrained:true,angle:0,anchor:"middle"});y.fontSize=v.size;h(p.type,y,u);e[o].transform=y;f.attr("transform",i.getTextTransform(y))}))}));var d=a.select(this).selectAll("g.titletext").data(p.title.text?[0]:[]);d.enter().append("g").classed("titletext",true);d.exit().remove();d.each((function(){var e=i.ensureSingle(a.select(this),"text","",(function(e){e.attr("data-notex",1)}));var r=p.title.text;if(p._meta){r=i.templateString(r,p._meta)}e.text(r).attr({class:"titletext",transform:"","text-anchor":"middle"}).call(n.font,p.title.font).call(l.convertToTspans,t);var c=b(f,u._size);e.attr("transform",s(c.x,c.y)+o(Math.min(1,c.scale))+s(c.tx,c.ty))}))}))}))};function w(e,t){var r=t[0]-e[0];var a=t[1]-e[1];return"l"+r+","+a}function T(e,t){return[.5*(e[0]+t[0]),.5*(e[1]+t[1])]}function k(e){if(!e.length)return;var t=e[0];var r=t.trace;var a=r.aspectratio;var n=r.baseratio;if(n>.999)n=.999;var i=Math.pow(n,2);var o=t.vTotal;var s=o*i/(1-i);var l=o;var u=s/o;function c(){var e=Math.sqrt(u);return{x:e,y:-e}}function f(){var e=c();return[e.x,e.y]}var h;var p=[];p.push(f());var v,d;for(v=e.length-1;v>-1;v--){d=e[v];if(d.hidden)continue;var m=d.v/l;u+=m;p.push(f())}var g=Infinity;var y=-Infinity;for(v=0;v<p.length;v++){h=p[v];g=Math.min(g,h[1]);y=Math.max(y,h[1])}for(v=0;v<p.length;v++){p[v][1]-=(y+g)/2}var x=p[p.length-1][0];var b=t.r;var _=(y-g)/2;var w=b/x;var k=b/_*a;t.r=k*_;for(v=0;v<p.length;v++){p[v][0]*=w;p[v][1]*=k}h=p[0];var M=[-h[0],h[1]];var A=[h[0],h[1]];var S=0;for(v=e.length-1;v>-1;v--){d=e[v];if(d.hidden)continue;S+=1;var E=p[S][0];var L=p[S][1];d.TL=[-E,L];d.TR=[E,L];d.BL=M;d.BR=A;d.pxmid=T(d.TR,d.BR);M=d.TL;A=d.TR}}},{"../../components/drawing":672,"../../lib":787,"../../lib/svg_text_utils":813,"../bar/plot":936,"../bar/uniform_text":941,"../pie/helpers":1181,"../pie/plot":1185,"@plotly/d3":58}],1068:[function(e,t,r){"use strict";var a=e("@plotly/d3");var n=e("../pie/style_one");var i=e("../bar/uniform_text").resizeText;t.exports=function e(t){var r=t._fullLayout._funnelarealayer.selectAll(".trace");i(t,r,"funnelarea");r.each((function(e){var t=e[0];var r=t.trace;var i=a.select(this);i.style({opacity:r.opacity});i.selectAll("path.surface").each((function(e){a.select(this).call(n,e,r)}))}))}},{"../bar/uniform_text":941,"../pie/style_one":1187,"@plotly/d3":58}],1069:[function(e,t,r){"use strict";var a=e("../scatter/attributes");var n=e("../../plots/attributes");var i=e("../../plots/cartesian/axis_format_attributes").axisHoverFormat;var o=e("../../plots/template_attributes").hovertemplateAttrs;var s=e("../../components/colorscale/attributes");var l=e("../../lib/extend").extendFlat;t.exports=l({z:{valType:"data_array",editType:"calc"},x:l({},a.x,{impliedEdits:{xtype:"array"}}),x0:l({},a.x0,{impliedEdits:{xtype:"scaled"}}),dx:l({},a.dx,{impliedEdits:{xtype:"scaled"}}),y:l({},a.y,{impliedEdits:{ytype:"array"}}),y0:l({},a.y0,{impliedEdits:{ytype:"scaled"}}),dy:l({},a.dy,{impliedEdits:{ytype:"scaled"}}),xperiod:l({},a.xperiod,{impliedEdits:{xtype:"scaled"}}),yperiod:l({},a.yperiod,{impliedEdits:{ytype:"scaled"}}),xperiod0:l({},a.xperiod0,{impliedEdits:{xtype:"scaled"}}),yperiod0:l({},a.yperiod0,{impliedEdits:{ytype:"scaled"}}),xperiodalignment:l({},a.xperiodalignment,{impliedEdits:{xtype:"scaled"}}),yperiodalignment:l({},a.yperiodalignment,{impliedEdits:{ytype:"scaled"}}),text:{valType:"data_array",editType:"calc"},hovertext:{valType:"data_array",editType:"calc"},transpose:{valType:"boolean",dflt:false,editType:"calc"},xtype:{valType:"enumerated",values:["array","scaled"],editType:"calc+clearAxisTypes"},ytype:{valType:"enumerated",values:["array","scaled"],editType:"calc+clearAxisTypes"},zsmooth:{valType:"enumerated",values:["fast","best",false],dflt:false,editType:"calc"},hoverongaps:{valType:"boolean",dflt:true,editType:"none"},connectgaps:{valType:"boolean",editType:"calc"},xgap:{valType:"number",dflt:0,min:0,editType:"plot"},ygap:{valType:"number",dflt:0,min:0,editType:"plot"},xhoverformat:i("x"),yhoverformat:i("y"),zhoverformat:i("z",1),hovertemplate:o(),showlegend:l({},n.showlegend,{dflt:false})},{transforms:undefined},s("",{cLetter:"z",autoColorDflt:false}))},{"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../plots/attributes":834,"../../plots/cartesian/axis_format_attributes":841,"../../plots/template_attributes":910,"../scatter/attributes":1202}],1070:[function(e,t,r){"use strict";var a=e("../../registry");var n=e("../../lib");var i=e("../../plots/cartesian/axes");var o=e("../../plots/cartesian/align_period");var s=e("../histogram2d/calc");var l=e("../../components/colorscale/calc");var u=e("./convert_column_xyz");var c=e("./clean_2d_array");var f=e("./interp2d");var h=e("./find_empties");var p=e("./make_bound_array");var v=e("../../constants/numerical").BADNUM;t.exports=function e(t,r){var v=i.getFromId(t,r.xaxis||"x");var g=i.getFromId(t,r.yaxis||"y");var y=a.traceIs(r,"contour");var x=a.traceIs(r,"histogram");var b=a.traceIs(r,"gl2d");var _=y?"best":r.zsmooth;var w,T,k,M;var A,S,E,L;var C,I,P;v._minDtick=0;g._minDtick=0;if(x){P=s(t,r);M=P.orig_x;w=P.x;T=P.x0;k=P.dx;L=P.orig_y;A=P.y;S=P.y0;E=P.dy;C=P.z}else{var O=r.z;if(n.isArray1D(O)){u(r,v,g,"x","y",["z"]);w=r._x;A=r._y;O=r._z}else{M=r.x?v.makeCalcdata(r,"x"):[];L=r.y?g.makeCalcdata(r,"y"):[];w=o(r,v,"x",M).vals;A=o(r,g,"y",L).vals;r._x=w;r._y=A}T=r.x0;k=r.dx;S=r.y0;E=r.dy;C=c(O,r,v,g)}if(v.rangebreaks||g.rangebreaks){C=m(w,A,C);if(!x){w=d(w);A=d(A);r._x=w;r._y=A}}if(!x&&(y||r.connectgaps)){r._emptypoints=h(C);f(C,r._emptypoints)}function z(e){_=r._input.zsmooth=r.zsmooth=false;n.warn('cannot use zsmooth: "fast": '+e)}if(_==="fast"){if(v.type==="log"||g.type==="log"){z("log axis found")}else if(!x){if(w.length){var D=(w[w.length-1]-w[0])/(w.length-1);var R=Math.abs(D/100);for(I=0;I<w.length-1;I++){if(Math.abs(w[I+1]-w[I]-D)>R){z("x scale is not linear");break}}}if(A.length&&_==="fast"){var F=(A[A.length-1]-A[0])/(A.length-1);var B=Math.abs(F/100);for(I=0;I<A.length-1;I++){if(Math.abs(A[I+1]-A[I]-F)>B){z("y scale is not linear");break}}}}}var N=n.maxRowLength(C);var j=r.xtype==="scaled"?"":w;var U=p(r,j,T,k,N,v);var V=r.ytype==="scaled"?"":A;var H=p(r,V,S,E,C.length,g);if(!b){r._extremes[v._id]=i.findExtremes(v,U);r._extremes[g._id]=i.findExtremes(g,H)}var q={x:U,y:H,z:C,text:r._text||r.text,hovertext:r._hovertext||r.hovertext};if(r.xperiodalignment&&M){q.orig_x=M}if(r.yperiodalignment&&L){q.orig_y=L}if(j&&j.length===U.length-1)q.xCenter=j;if(V&&V.length===H.length-1)q.yCenter=V;if(x){q.xRanges=P.xRanges;q.yRanges=P.yRanges;q.pts=P.pts}if(!y){l(t,r,{vals:C,cLetter:"z"})}if(y&&r.contours&&r.contours.coloring==="heatmap"){var G={type:r.type==="contour"?"heatmap":"histogram2d",xcalendar:r.xcalendar,ycalendar:r.ycalendar};q.xfill=p(G,j,T,k,N,v);q.yfill=p(G,V,S,E,C.length,g)}return[q]};function d(e){var t=[];var r=e.length;for(var a=0;a<r;a++){var n=e[a];if(n!==v)t.push(n)}return t}function m(e,t,r){var a=[];var n=-1;for(var i=0;i<r.length;i++){if(t[i]===v)continue;n++;a[n]=[];for(var o=0;o<r[i].length;o++){if(e[o]===v)continue;a[n].push(r[i][o])}}return a}},{"../../components/colorscale/calc":658,"../../constants/numerical":763,"../../lib":787,"../../plots/cartesian/align_period":835,"../../plots/cartesian/axes":838,"../../registry":915,"../histogram2d/calc":1102,"./clean_2d_array":1071,"./convert_column_xyz":1073,"./find_empties":1075,"./interp2d":1078,"./make_bound_array":1079}],1071:[function(e,t,r){"use strict";var a=e("fast-isnumeric");var n=e("../../lib");var i=e("../../constants/numerical").BADNUM;t.exports=function e(t,r,o,s){var l,u,c,f,h,p;function v(e){if(!a(e))return undefined;return+e}if(r&&r.transpose){l=0;for(h=0;h<t.length;h++)l=Math.max(l,t[h].length);if(l===0)return false;c=function(e){return e.length};f=function(e,t,r){return(e[r]||[])[t]}}else{l=t.length;c=function(e,t){return e[t].length};f=function(e,t,r){return(e[t]||[])[r]}}var d=function(e,t,r){if(t===i||r===i)return i;return f(e,t,r)};function m(e){if(r&&r.type!=="carpet"&&r.type!=="contourcarpet"&&e&&e.type==="category"&&r["_"+e._id.charAt(0)].length){var t=e._id.charAt(0);var a={};var o=r["_"+t+"CategoryMap"]||r[t];for(h=0;h<o.length;h++){a[o[h]]=h}return function(t){var r=a[e._categories[t]];return r+1?r:i}}else{return n.identity}}var g=m(o);var y=m(s);if(s&&s.type==="category")l=s._categories.length;var x=new Array(l);for(h=0;h<l;h++){if(o&&o.type==="category"){u=o._categories.length}else{u=c(t,h)}x[h]=new Array(u);for(p=0;p<u;p++)x[h][p]=v(d(t,y(h),g(p)))}return x}},{"../../constants/numerical":763,"../../lib":787,"fast-isnumeric":246}],1072:[function(e,t,r){"use strict";t.exports={min:"zmin",max:"zmax"}},{}],1073:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("../../constants/numerical").BADNUM;var i=e("../../plots/cartesian/align_period");t.exports=function e(t,r,o,s,l,u){var c=t._length;var f=r.makeCalcdata(t,s);var h=o.makeCalcdata(t,l);f=i(t,r,s,f).vals;h=i(t,o,l,h).vals;var p=t.text;var v=p!==undefined&&a.isArray1D(p);var d=t.hovertext;var m=d!==undefined&&a.isArray1D(d);var g,y;var x=a.distinctVals(f);var b=x.vals;var _=a.distinctVals(h);var w=_.vals;var T=[];var k;var M;var A=w.length;var S=b.length;for(g=0;g<u.length;g++){T[g]=a.init2dArray(A,S)}if(v){k=a.init2dArray(A,S)}if(m){M=a.init2dArray(A,S)}var E=a.init2dArray(A,S);for(g=0;g<c;g++){if(f[g]!==n&&h[g]!==n){var L=a.findBin(f[g]+x.minDiff/2,b);var C=a.findBin(h[g]+_.minDiff/2,w);for(y=0;y<u.length;y++){var I=u[y];var P=t[I];var O=T[y];O[C][L]=P[g];E[C][L]=g}if(v)k[C][L]=p[g];if(m)M[C][L]=d[g]}}t["_"+s]=b;t["_"+l]=w;for(y=0;y<u.length;y++){t["_"+u[y]]=T[y]}if(v)t._text=k;if(m)t._hovertext=M;if(r&&r.type==="category"){t["_"+s+"CategoryMap"]=b.map((function(e){return r._categories[e]}))}if(o&&o.type==="category"){t["_"+l+"CategoryMap"]=w.map((function(e){return o._categories[e]}))}t._after2before=E}},{"../../constants/numerical":763,"../../lib":787,"../../plots/cartesian/align_period":835}],1074:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("./xyz_defaults");var i=e("../scatter/period_defaults");var o=e("./style_defaults");var s=e("../../components/colorscale/defaults");var l=e("./attributes");t.exports=function e(t,r,u,c){function f(e,n){return a.coerce(t,r,l,e,n)}var h=n(t,r,f,c);if(!h){r.visible=false;return}i(t,r,c,f);f("xhoverformat");f("yhoverformat");f("text");f("hovertext");f("hovertemplate");o(t,r,f,c);f("hoverongaps");f("connectgaps",a.isArray1D(r.z)&&r.zsmooth!==false);s(t,r,c,f,{prefix:"",cLetter:"z"})}},{"../../components/colorscale/defaults":660,"../../lib":787,"../scatter/period_defaults":1222,"./attributes":1069,"./style_defaults":1082,"./xyz_defaults":1083}],1075:[function(e,t,r){"use strict";var a=e("../../lib").maxRowLength;t.exports=function e(t){var r=[];var n={};var i=[];var o=t[0];var s=[];var l=[0,0,0];var u=a(t);var c;var f;var h;var p;var v;var d;var m;var g;for(f=0;f<t.length;f++){c=s;s=o;o=t[f+1]||[];for(h=0;h<u;h++){if(s[h]===undefined){d=(s[h-1]!==undefined?1:0)+(s[h+1]!==undefined?1:0)+(c[h]!==undefined?1:0)+(o[h]!==undefined?1:0);if(d){if(f===0)d++;if(h===0)d++;if(f===t.length-1)d++;if(h===s.length-1)d++;if(d<4){n[[f,h]]=[f,h,d]}r.push([f,h,d])}else i.push([f,h])}}}while(i.length){m={};g=false;for(v=i.length-1;v>=0;v--){p=i[v];f=p[0];h=p[1];d=((n[[f-1,h]]||l)[2]+(n[[f+1,h]]||l)[2]+(n[[f,h-1]]||l)[2]+(n[[f,h+1]]||l)[2])/20;if(d){m[p]=[f,h,d];i.splice(v,1);g=true}}if(!g){throw"findEmpties iterated with no new neighbors"}for(p in m){n[p]=m[p];r.push(m[p])}}return r.sort((function(e,t){return t[2]-e[2]}))}},{"../../lib":787}],1076:[function(e,t,r){"use strict";var a=e("../../components/fx");var n=e("../../lib");var i=e("../../plots/cartesian/axes");var o=e("../../components/colorscale").extractOpts;t.exports=function e(t,r,s,l,u){if(!u)u={};var c=u.isContour;var f=t.cd[0];var h=f.trace;var p=t.xa;var v=t.ya;var d=f.x;var m=f.y;var g=f.z;var y=f.xCenter;var x=f.yCenter;var b=f.zmask;var _=h.zhoverformat;var w=d;var T=m;var k,M,A,S;if(t.index!==false){try{A=Math.round(t.index[1]);S=Math.round(t.index[0])}catch(j){n.error("Error hovering on heatmap, "+"pointNumber must be [row,col], found:",t.index);return}if(A<0||A>=g[0].length||S<0||S>g.length){return}}else if(a.inbox(r-d[0],r-d[d.length-1],0)>0||a.inbox(s-m[0],s-m[m.length-1],0)>0){return}else{if(c){var E;w=[2*d[0]-d[1]];for(E=1;E<d.length;E++){w.push((d[E]+d[E-1])/2)}w.push([2*d[d.length-1]-d[d.length-2]]);T=[2*m[0]-m[1]];for(E=1;E<m.length;E++){T.push((m[E]+m[E-1])/2)}T.push([2*m[m.length-1]-m[m.length-2]])}A=Math.max(0,Math.min(w.length-2,n.findBin(r,w)));S=Math.max(0,Math.min(T.length-2,n.findBin(s,T)))}var L=p.c2p(d[A]);var C=p.c2p(d[A+1]);var I=v.c2p(m[S]);var P=v.c2p(m[S+1]);var O,z;if(c){O=f.orig_x||d;z=f.orig_y||m;C=L;k=O[A];P=I;M=z[S]}else{O=f.orig_x||y||d;z=f.orig_y||x||m;k=y?O[A]:(O[A]+O[A+1])/2;M=x?z[S]:(z[S]+z[S+1])/2;if(p&&p.type==="category")k=d[A];if(v&&v.type==="category")M=m[S];if(h.zsmooth){L=C=p.c2p(k);I=P=v.c2p(M)}}var D=g[S][A];if(b&&!b[S][A])D=undefined;if(D===undefined&&!h.hoverongaps)return;var R;if(Array.isArray(f.hovertext)&&Array.isArray(f.hovertext[S])){R=f.hovertext[S][A]}else if(Array.isArray(f.text)&&Array.isArray(f.text[S])){R=f.text[S][A]}var F=o(h);var B={type:"linear",range:[F.min,F.max],hoverformat:_,_separators:p._separators,_numFormat:p._numFormat};var N=i.tickText(B,D,"hover").text;return[n.extendFlat(t,{index:h._after2before?h._after2before[S][A]:[S,A],distance:t.maxHoverDistance,spikeDistance:t.maxSpikeDistance,x0:L,x1:C,y0:I,y1:P,xLabelVal:k,yLabelVal:M,zLabelVal:D,zLabel:N,text:R})]}},{"../../components/colorscale":662,"../../components/fx":690,"../../lib":787,"../../plots/cartesian/axes":838}],1077:[function(e,t,r){"use strict";t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),calc:e("./calc"),plot:e("./plot"),colorbar:e("./colorbar"),style:e("./style"),hoverPoints:e("./hover"),moduleType:"trace",name:"heatmap",basePlotModule:e("../../plots/cartesian"),categories:["cartesian","svg","2dMap","showLegend"],meta:{}}},{"../../plots/cartesian":852,"./attributes":1069,"./calc":1070,"./colorbar":1072,"./defaults":1074,"./hover":1076,"./plot":1080,"./style":1081}],1078:[function(e,t,r){"use strict";var a=e("../../lib");var n=.01;var i=[[-1,0],[1,0],[0,-1],[0,1]];function o(e){return.5-.25*Math.min(1,e*.5)}t.exports=function e(t,r){var i=1;var l;s(t,r);for(l=0;l<r.length;l++){if(r[l][2]<4)break}r=r.slice(l);for(l=0;l<100&&i>n;l++){i=s(t,r,o(i))}if(i>n){a.log("interp2d didn't converge quickly",i)}return t};function s(e,t,r){var a=0;var n;var o;var s;var l;var u;var c;var f;var h;var p;var v;var d;var m;var g;for(l=0;l<t.length;l++){n=t[l];o=n[0];s=n[1];d=e[o][s];v=0;p=0;for(u=0;u<4;u++){c=i[u];f=e[o+c[0]];if(!f)continue;h=f[s+c[1]];if(h!==undefined){if(v===0){m=g=h}else{m=Math.min(m,h);g=Math.max(g,h)}p++;v+=h}}if(p===0){throw"iterateInterp2d order is wrong: no defined neighbors"}e[o][s]=v/p;if(d===undefined){if(p<4)a=1}else{e[o][s]=(1+r)*e[o][s]-r*d;if(g>m){a=Math.max(a,Math.abs(e[o][s]-d)/(g-m))}}}return a}},{"../../lib":787}],1079:[function(e,t,r){"use strict";var a=e("../../registry");var n=e("../../lib").isArrayOrTypedArray;t.exports=function e(t,r,i,o,s,l){var u=[];var c=a.traceIs(t,"contour");var f=a.traceIs(t,"histogram");var h=a.traceIs(t,"gl2d");var p;var v;var d;var m=n(r)&&r.length>1;if(m&&!f&&l.type!=="category"){var g=r.length;if(g<=s){if(c||h)u=r.slice(0,s);else if(s===1){u=[r[0]-.5,r[0]+.5]}else{u=[1.5*r[0]-.5*r[1]];for(d=1;d<g;d++){u.push((r[d-1]+r[d])*.5)}u.push(1.5*r[g-1]-.5*r[g-2])}if(g<s){var y=u[u.length-1];var x=y-u[u.length-2];for(d=g;d<s;d++){y+=x;u.push(y)}}}else{return c?r.slice(0,s):r.slice(0,s+1)}}else{var b=t[l._id.charAt(0)+"calendar"];if(f){p=l.r2c(i,0,b)}else{if(n(r)&&r.length===1){p=r[0]}else if(i===undefined){p=0}else{var _=l.type==="log"?l.d2c:l.r2c;p=_(i,0,b)}}v=o||1;for(d=c||h?0:-.5;d<s;d++){u.push(p+v*d)}}return u}},{"../../lib":787,"../../registry":915}],1080:[function(e,t,r){"use strict";var a=e("@plotly/d3");var n=e("tinycolor2");var i=e("../../registry");var o=e("../../lib");var s=e("../../components/colorscale").makeColorScaleFuncFromTrace;var l=e("../../constants/xmlns_namespaces");t.exports=function(e,t,r,h){var p=t.xaxis;var v=t.yaxis;o.makeTraceGroups(h,r,"hm").each((function(t){var r=a.select(this);var h=t[0];var d=h.trace;var m=h.z;var g=h.x;var y=h.y;var x=h.xCenter;var b=h.yCenter;var _=i.traceIs(d,"contour");var w=_?"best":d.zsmooth;var T=m.length;var k=o.maxRowLength(m);var M=false;var A=false;var S,E,L,C,I,P;P=0;while(S===undefined&&P<g.length-1){S=p.c2p(g[P]);P++}P=g.length-1;while(E===undefined&&P>0){E=p.c2p(g[P]);P--}if(E<S){L=E;E=S;S=L;M=true}P=0;while(C===undefined&&P<y.length-1){C=v.c2p(y[P]);P++}P=y.length-1;while(I===undefined&&P>0){I=v.c2p(y[P]);P--}if(I<C){L=C;C=I;I=L;A=true}if(_){x=g;b=y;g=h.xfill;y=h.yfill}if(w!=="fast"){var O=w==="best"?0:.5;S=Math.max(-O*p._length,S);E=Math.min((1+O)*p._length,E);C=Math.max(-O*v._length,C);I=Math.min((1+O)*v._length,I)}var z=Math.round(E-S);var D=Math.round(I-C);var R=z<=0||D<=0;if(R){var F=r.selectAll("image").data([]);F.exit().remove();return}var B,N;if(w==="fast"){B=k;N=T}else{B=z;N=D}var j=document.createElement("canvas");j.width=B;j.height=N;var U=j.getContext("2d");var V=s(d,{noNumericCheck:true,returnArray:true});var H,q;if(w==="fast"){H=M?function(e){return k-1-e}:o.identity;q=A?function(e){return T-1-e}:o.identity}else{H=function(e){return o.constrain(Math.round(p.c2p(g[e])-S),0,z)};q=function(e){return o.constrain(Math.round(v.c2p(y[e])-C),0,D)}}var G=q(0);var Y=[G,G];var W=M?0:1;var X=A?0:1;var Z=0;var J=0;var K=0;var Q=0;var $,ee,te,re,ae,ne;function ie(e,t){if(e!==undefined){var r=V(e);r[0]=Math.round(r[0]);r[1]=Math.round(r[1]);r[2]=Math.round(r[2]);Z+=t;J+=r[0]*t;K+=r[1]*t;Q+=r[2]*t;return r}return[0,0,0,0]}function oe(e,t,r,a){var n=e[r.bin0];if(n===undefined)return ie(undefined,1);var i=e[r.bin1];var o=t[r.bin0];var s=t[r.bin1];var l=i-n||0;var u=o-n||0;var c;if(i===undefined){if(s===undefined)c=0;else if(o===undefined)c=2*(s-n);else c=(2*s-o-n)*2/3}else if(s===undefined){if(o===undefined)c=0;else c=(2*n-i-o)*2/3}else if(o===undefined)c=(2*s-i-n)*2/3;else c=s+n-i-o;return ie(n+r.frac*l+a.frac*(u+r.frac*c))}if(w){var se=0;var le;try{le=new Uint8Array(z*D*4)}catch(Ee){le=new Array(z*D*4)}if(w==="best"){var ue=x||g;var ce=b||y;var fe=new Array(ue.length);var he=new Array(ce.length);var pe=new Array(z);var ve=x?c:u;var de=b?c:u;var me,ge,ye;for(P=0;P<ue.length;P++)fe[P]=Math.round(p.c2p(ue[P])-S);for(P=0;P<ce.length;P++)he[P]=Math.round(v.c2p(ce[P])-C);for(P=0;P<z;P++)pe[P]=ve(P,fe);for(ee=0;ee<D;ee++){me=de(ee,he);ge=m[me.bin0];ye=m[me.bin1];for(P=0;P<z;P++,se+=4){ne=oe(ge,ye,pe[P],me);f(le,se,ne)}}}else{for(ee=0;ee<T;ee++){ae=m[ee];Y=q(ee);for(P=0;P<z;P++){ne=ie(ae[P],1);se=(Y*z+H(P))*4;f(le,se,ne)}}}var xe=U.createImageData(z,D);try{xe.data.set(le)}catch(Ee){var be=xe.data;var _e=be.length;for(ee=0;ee<_e;ee++){be[ee]=le[ee]}}U.putImageData(xe,0,0)}else{var we=d.xgap;var Te=d.ygap;var ke=Math.floor(we/2);var Me=Math.floor(Te/2);for(ee=0;ee<T;ee++){ae=m[ee];Y.reverse();Y[X]=q(ee+1);if(Y[0]===Y[1]||Y[0]===undefined||Y[1]===undefined){continue}te=H(0);$=[te,te];for(P=0;P<k;P++){$.reverse();$[W]=H(P+1);if($[0]===$[1]||$[0]===undefined||$[1]===undefined){continue}re=ae[P];ne=ie(re,($[1]-$[0])*(Y[1]-Y[0]));U.fillStyle="rgba("+ne.join(",")+")";U.fillRect($[0]+ke,Y[0]+Me,$[1]-$[0]-we,Y[1]-Y[0]-Te)}}}J=Math.round(J/Z);K=Math.round(K/Z);Q=Math.round(Q/Z);var Ae=n("rgb("+J+","+K+","+Q+")");e._hmpixcount=(e._hmpixcount||0)+Z;e._hmlumcount=(e._hmlumcount||0)+Z*Ae.getLuminance();var Se=r.selectAll("image").data(t);Se.enter().append("svg:image").attr({xmlns:l.svg,preserveAspectRatio:"none"});Se.attr({height:D,width:z,x:S,y:C,"xlink:href":j.toDataURL("image/png")})}))};function u(e,t){var r=t.length-2;var a=o.constrain(o.findBin(e,t),0,r);var n=t[a];var i=t[a+1];var s=o.constrain(a+(e-n)/(i-n)-.5,0,r);var l=Math.round(s);var u=Math.abs(s-l);if(!s||s===r||!u){return{bin0:l,bin1:l,frac:0}}return{bin0:l,frac:u,bin1:Math.round(l+u/(s-l))}}function c(e,t){var r=t.length-1;var a=o.constrain(o.findBin(e,t),0,r);var n=t[a];var i=t[a+1];var s=(e-n)/(i-n)||0;if(s<=0){return{bin0:a,bin1:a,frac:0}}if(s<.5){return{bin0:a,bin1:a+1,frac:s}}return{bin0:a+1,bin1:a,frac:1-s}}function f(e,t,r){e[t]=r[0];e[t+1]=r[1];e[t+2]=r[2];e[t+3]=Math.round(r[3]*255)}},{"../../components/colorscale":662,"../../constants/xmlns_namespaces":764,"../../lib":787,"../../registry":915,"@plotly/d3":58,tinycolor2:583}],1081:[function(e,t,r){"use strict";var a=e("@plotly/d3");t.exports=function e(t){a.select(t).selectAll(".hm image").style("opacity",(function(e){return e.trace.opacity}))}},{"@plotly/d3":58}],1082:[function(e,t,r){"use strict";t.exports=function e(t,r,a){var n=a("zsmooth");if(n===false){a("xgap");a("ygap")}a("zhoverformat")}},{}],1083:[function(e,t,r){"use strict";var a=e("fast-isnumeric");var n=e("../../lib");var i=e("../../registry");t.exports=function e(t,r,a,l,u,c){var f=a("z");u=u||"x";c=c||"y";var h,p;if(f===undefined||!f.length)return 0;if(n.isArray1D(t.z)){h=a(u);p=a(c);var v=n.minRowLength(h);var d=n.minRowLength(p);if(v===0||d===0)return 0;r._length=Math.min(v,d,f.length)}else{h=o(u,a);p=o(c,a);if(!s(f))return 0;a("transpose");r._length=null}if(t.type==="heatmapgl")return true;var m=i.getComponentMethod("calendars","handleTraceDefaults");m(t,r,[u,c],l);return true};function o(e,t){var r=t(e);var a=r?t(e+"type","array"):"scaled";if(a==="scaled"){t(e+"0");t("d"+e)}return r}function s(e){var t=true;var r=false;var i=false;var o;for(var s=0;s<e.length;s++){o=e[s];if(!n.isArrayOrTypedArray(o)){t=false;break}if(o.length>0)r=true;for(var l=0;l<o.length;l++){if(a(o[l])){i=true;break}}}return t&&r&&i}},{"../../lib":787,"../../registry":915,"fast-isnumeric":246}],1084:[function(e,t,r){"use strict";var a=e("../heatmap/attributes");var n=e("../../components/colorscale/attributes");var i=e("../../lib/extend").extendFlat;var o=e("../../plot_api/edit_types").overrideAll;var s=["z","x","x0","dx","y","y0","dy","text","transpose","xtype","ytype"];var l={};for(var u=0;u<s.length;u++){var c=s[u];l[c]=a[c]}l.zsmooth={valType:"enumerated",values:["fast",false],dflt:"fast",editType:"calc"};i(l,n("",{cLetter:"z",autoColorDflt:false}));t.exports=o(l,"calc","nested")},{"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../plot_api/edit_types":820,"../heatmap/attributes":1069}],1085:[function(e,t,r){"use strict";var a=e("gl-heatmap2d");var n=e("../../plots/cartesian/axes");var i=e("../../lib/str2rgbarray");function o(e,t){this.scene=e;this.uid=t;this.type="heatmapgl";this.name="";this.hoverinfo="all";this.xData=[];this.yData=[];this.zData=[];this.textLabels=[];this.idToIndex=[];this.bounds=[0,0,0,0];this.options={zsmooth:"fast",z:[],x:[],y:[],shape:[0,0],colorLevels:[0],colorValues:[0,0,0,1]};this.heatmap=a(e.glplot,this.options);this.heatmap._trace=this}var s=o.prototype;s.handlePick=function(e){var t=this.options;var r=t.shape;var a=e.pointId;var n=a%r[0];var i=Math.floor(a/r[0]);var o=a;return{trace:this,dataCoord:e.dataCoord,traceCoord:[t.x[n],t.y[i],t.z[o]],textLabel:this.textLabels[a],name:this.name,pointIndex:[i,n],hoverinfo:this.hoverinfo}};s.update=function(e,t){var r=t[0];this.index=e.index;this.name=e.name;this.hoverinfo=e.hoverinfo;var a=r.z;this.options.z=[].concat.apply([],a);var i=a[0].length;var o=a.length;this.options.shape=[i,o];this.options.x=r.x;this.options.y=r.y;this.options.zsmooth=e.zsmooth;var s=l(e);this.options.colorLevels=s.colorLevels;this.options.colorValues=s.colorValues;this.textLabels=[].concat.apply([],e.text);this.heatmap.update(this.options);var u=this.scene.xaxis;var c=this.scene.yaxis;var f,h;if(e.zsmooth===false){f={ppad:r.x[1]-r.x[0]};h={ppad:r.y[1]-r.y[0]}}e._extremes[u._id]=n.findExtremes(u,r.x,f);e._extremes[c._id]=n.findExtremes(c,r.y,h)};s.dispose=function(){this.heatmap.dispose()};function l(e){var t=e.colorscale;var r=e.zmin;var a=e.zmax;var n=t.length;var o=new Array(n);var s=new Array(4*n);for(var l=0;l<n;l++){var u=t[l];var c=i(u[1]);o[l]=r+u[0]*(a-r);for(var f=0;f<4;f++){s[4*l+f]=c[f]}}return{colorLevels:o,colorValues:s}}function u(e,t,r){var a=new o(e,t.uid);a.update(t,r);return a}t.exports=u},{"../../lib/str2rgbarray":812,"../../plots/cartesian/axes":838,"gl-heatmap2d":272}],1086:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("../heatmap/xyz_defaults");var i=e("../../components/colorscale/defaults");var o=e("./attributes");t.exports=function e(t,r,s,l){function u(e,n){return a.coerce(t,r,o,e,n)}var c=n(t,r,u,l);if(!c){r.visible=false;return}u("text");u("zsmooth");i(t,r,l,u,{prefix:"",cLetter:"z"})}},{"../../components/colorscale/defaults":660,"../../lib":787,"../heatmap/xyz_defaults":1083,"./attributes":1084}],1087:[function(e,t,r){"use strict";var a=["*heatmapgl* trace is deprecated!","Please consider switching to the *heatmap* or *image* trace types.","Alternatively you could contribute/sponsor rewriting this trace type","based on cartesian features and using regl framework."].join(" ");t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),colorbar:e("../heatmap/colorbar"),calc:e("../heatmap/calc"),plot:e("./convert"),moduleType:"trace",name:"heatmapgl",basePlotModule:e("../../plots/gl2d"),categories:["gl","gl2d","2dMap"],meta:{}}},{"../../plots/gl2d":878,"../heatmap/calc":1070,"../heatmap/colorbar":1072,"./attributes":1084,"./convert":1085,"./defaults":1086}],1088:[function(e,t,r){"use strict";var a=e("../bar/attributes");var n=e("../../plots/cartesian/axis_format_attributes").axisHoverFormat;var i=e("../../plots/template_attributes").hovertemplateAttrs;var o=e("./bin_attributes");var s=e("./constants");var l=e("../../lib/extend").extendFlat;t.exports={x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},xhoverformat:n("x"),yhoverformat:n("y"),text:l({},a.text,{}),hovertext:l({},a.hovertext,{}),orientation:a.orientation,histfunc:{valType:"enumerated",values:["count","sum","avg","min","max"],dflt:"count",editType:"calc"},histnorm:{valType:"enumerated",values:["","percent","probability","density","probability density"],dflt:"",editType:"calc"},cumulative:{enabled:{valType:"boolean",dflt:false,editType:"calc"},direction:{valType:"enumerated",values:["increasing","decreasing"],dflt:"increasing",editType:"calc"},currentbin:{valType:"enumerated",values:["include","exclude","half"],dflt:"include",editType:"calc"},editType:"calc"},nbinsx:{valType:"integer",min:0,dflt:0,editType:"calc"},xbins:o("x",true),nbinsy:{valType:"integer",min:0,dflt:0,editType:"calc"},ybins:o("y",true),autobinx:{valType:"boolean",dflt:null,editType:"calc"},autobiny:{valType:"boolean",dflt:null,editType:"calc"},bingroup:{valType:"string",dflt:"",editType:"calc"},hovertemplate:i({},{keys:s.eventDataKeys}),marker:a.marker,offsetgroup:a.offsetgroup,alignmentgroup:a.alignmentgroup,selected:a.selected,unselected:a.unselected,_deprecated:{bardir:a._deprecated.bardir}}},{"../../lib/extend":777,"../../plots/cartesian/axis_format_attributes":841,"../../plots/template_attributes":910,"../bar/attributes":925,"./bin_attributes":1090,"./constants":1094}],1089:[function(e,t,r){"use strict";t.exports=function e(t,r){var a=t.length;var n=0;for(var i=0;i<a;i++){if(r[i]){t[i]/=r[i];n+=t[i]}else t[i]=null}return n}},{}],1090:[function(e,t,r){"use strict";t.exports=function e(t,r){return{start:{valType:"any",editType:"calc"},end:{valType:"any",editType:"calc"},size:{valType:"any",editType:"calc"},editType:"calc"}}},{}],1091:[function(e,t,r){"use strict";var a=e("fast-isnumeric");t.exports={count:function(e,t,r){r[e]++;return 1},sum:function(e,t,r,n){var i=n[t];if(a(i)){i=Number(i);r[e]+=i;return i}return 0},avg:function(e,t,r,n,i){var o=n[t];if(a(o)){o=Number(o);r[e]+=o;i[e]++}return 0},min:function(e,t,r,n){var i=n[t];if(a(i)){i=Number(i);if(!a(r[e])){r[e]=i;return i}else if(r[e]>i){var o=i-r[e];r[e]=i;return o}}return 0},max:function(e,t,r,n){var i=n[t];if(a(i)){i=Number(i);if(!a(r[e])){r[e]=i;return i}else if(r[e]<i){var o=i-r[e];r[e]=i;return o}}return 0}}},{"fast-isnumeric":246}],1092:[function(e,t,r){"use strict";var a=e("../../constants/numerical");var n=a.ONEAVGYEAR;var i=a.ONEAVGMONTH;var o=a.ONEDAY;var s=a.ONEHOUR;var l=a.ONEMIN;var u=a.ONESEC;var c=e("../../plots/cartesian/axes").tickIncrement;t.exports=function e(t,r,a,i,s){var l=-1.1*r;var u=-.1*r;var h=t-u;var p=a[0];var v=a[1];var d=Math.min(f(p+u,p+h,i,s),f(v+u,v+h,i,s));var m=Math.min(f(p+l,p+u,i,s),f(v+l,v+u,i,s));var g,y;if(d>m&&m<Math.abs(v-p)/4e3){g=d;y=false}else{g=Math.min(d,m);y=true}if(i.type==="date"&&g>o){var x=g===n?1:6;var b=g===n?"M12":"M1";return function(e,r){var a=i.c2d(e,n,s);var o=a.indexOf("-",x);if(o>0)a=a.substr(0,o);var l=i.d2c(a,0,s);if(l<e){var u=c(l,b,false,s);if((l+u)/2<e+t)l=u}if(r&&y){return c(l,b,true,s)}return l}}return function(e,r){var a=g*Math.round(e/g);if(a+g/10<e&&a+g*.9<e+t){a+=g}if(r&&y){a-=g}return a}};function f(e,t,r,a){if(e*t<=0)return Infinity;var n=Math.abs(t-e);var i=r.type==="date";var o=h(n,i);for(var s=0;s<10;s++){var l=h(o*80,i);if(o===l)break;if(p(l,e,t,i,r,a))o=l;else break}return o}function h(e,t){if(t&&e>u){if(e>o){if(e>n*1.1)return n;if(e>i*1.1)return i;return o}if(e>s)return s;if(e>l)return l;return u}return Math.pow(10,Math.floor(Math.log(e)/Math.LN10))}function p(e,t,r,a,i,s){if(a&&e>o){var l=v(t,i,s);var u=v(r,i,s);var c=e===n?0:1;return l[c]!==u[c]}return Math.floor(r/e)-Math.floor(t/e)>.1}function v(e,t,r){var a=t.c2d(e,n,r).split("-");if(a[0]===""){a.unshift();a[0]="-"+a[0]}return a}},{"../../constants/numerical":763,"../../plots/cartesian/axes":838}],1093:[function(e,t,r){"use strict";var a=e("fast-isnumeric");var n=e("../../lib");var i=e("../../registry");var o=e("../../plots/cartesian/axes");var s=e("../bar/arrays_to_calcdata");var l=e("./bin_functions");var u=e("./norm_functions");var c=e("./average");var f=e("./bin_label_vals");function h(e,t){var r=[];var i=[];var h=o.getFromId(e,t.orientation==="h"?t.yaxis:t.xaxis);var v=t.orientation==="h"?"y":"x";var d={x:"y",y:"x"}[v];var g=t[v+"calendar"];var y=t.cumulative;var x;var b=p(e,t,h,v);var _=b[0];var w=b[1];var T=typeof _.size==="string";var k=[];var M=T?k:_;var A=[];var S=[];var E=[];var L=0;var C=t.histnorm;var I=t.histfunc;var P=C.indexOf("density")!==-1;var O,z,D;if(y.enabled&&P){C=C.replace(/ ?density$/,"");P=false}var R=I==="max"||I==="min";var F=R?null:0;var B=l.count;var N=u[C];var j=false;var U=function(e){return h.r2c(e,0,g)};var V;if(n.isArrayOrTypedArray(t[d])&&I!=="count"){V=t[d];j=I==="avg";B=l[I]}x=U(_.start);z=U(_.end)+(x-o.tickIncrement(x,_.size,false,g))/1e6;while(x<z&&r.length<1e6){O=o.tickIncrement(x,_.size,false,g);r.push((x+O)/2);i.push(F);E.push([]);k.push(x);if(P)A.push(1/(O-x));if(j)S.push(0);if(O<=x)break;x=O}k.push(x);if(!T&&h.type==="date"){M={start:U(M.start),end:U(M.end),size:M.size}}if(!e._fullLayout._roundFnOpts)e._fullLayout._roundFnOpts={};var H=t["_"+v+"bingroup"];var q={leftGap:Infinity,rightGap:Infinity};if(H){if(!e._fullLayout._roundFnOpts[H])e._fullLayout._roundFnOpts[H]=q;q=e._fullLayout._roundFnOpts[H]}var G=i.length;var Y=true;var W=q.leftGap;var X=q.rightGap;var Z={};for(x=0;x<w.length;x++){var J=w[x];D=n.findBin(J,M);if(D>=0&&D<G){L+=B(D,x,i,V,S);if(Y&&E[D].length&&J!==w[E[D][0]]){Y=false}E[D].push(x);Z[x]=D;W=Math.min(W,J-k[D]);X=Math.min(X,k[D+1]-J)}}q.leftGap=W;q.rightGap=X;var K;if(!Y){K=function(t,r){return function(){var a=e._fullLayout._roundFnOpts[H];return f(a.leftGap,a.rightGap,k,h,g)(t,r)}}}if(j)L=c(i,S);if(N)N(i,L,A);if(y.enabled)m(i,y.direction,y.currentbin);var Q=Math.min(r.length,i.length);var $=[];var ee=0;var te=Q-1;for(x=0;x<Q;x++){if(i[x]){ee=x;break}}for(x=Q-1;x>=ee;x--){if(i[x]){te=x;break}}for(x=ee;x<=te;x++){if(a(r[x])&&a(i[x])){var re={p:r[x],s:i[x],b:0};if(!y.enabled){re.pts=E[x];if(Y){re.ph0=re.ph1=E[x].length?w[E[x][0]]:r[x]}else{t._computePh=true;re.ph0=K(k[x]);re.ph1=K(k[x+1],true)}}$.push(re)}}if($.length===1){$[0].width1=o.tickIncrement($[0].p,_.size,false,g)-$[0].p}s($,t);if(n.isArrayOrTypedArray(t.selectedpoints)){n.tagSelected($,t,Z)}return $}function p(e,t,r,s,l){var u=s+"bins";var c=e._fullLayout;var f=t["_"+s+"bingroup"];var h=c._histogramBinOpts[f];var p=c.barmode==="overlay";var d,m,g,y,x,b,_;var w=function(e){return r.r2c(e,0,y)};var T=function(e){return r.c2r(e,0,y)};var k=r.type==="date"?function(e){return e||e===0?n.cleanDate(e,null,y):null}:function(e){return a(e)?Number(e):null};function M(e,t,r){if(t[e+"Found"]){t[e]=k(t[e]);if(t[e]===null)t[e]=r[e]}else{b[e]=t[e]=r[e];n.nestedProperty(m[0],u+"."+e).set(r[e])}}if(t["_"+s+"autoBinFinished"]){delete t["_"+s+"autoBinFinished"]}else{m=h.traces;var A=[];var S=true;var E=false;var L=false;for(d=0;d<m.length;d++){g=m[d];if(g.visible){var C=h.dirs[d];x=g["_"+C+"pos0"]=r.makeCalcdata(g,C);A=n.concat(A,x);delete g["_"+s+"autoBinFinished"];if(t.visible===true){if(S){S=false}else{delete g._autoBin;g["_"+s+"autoBinFinished"]=1}if(i.traceIs(g,"2dMap")){E=true}if(g.type==="histogram2dcontour"){L=true}}}}y=m[0][s+"calendar"];var I=o.autoBin(A,r,h.nbins,E,y,h.sizeFound&&h.size);var P=m[0]._autoBin={};b=P[h.dirs[0]]={};if(L){if(!h.size){I.start=T(o.tickIncrement(w(I.start),I.size,true,y))}if(h.end===undefined){I.end=T(o.tickIncrement(w(I.end),I.size,false,y))}}if(p&&!i.traceIs(t,"2dMap")&&I._dataSpan===0&&r.type!=="category"&&r.type!=="multicategory"){if(l)return[I,x,true];I=v(e,t,r,s,u)}_=g.cumulative||{};if(_.enabled&&_.currentbin!=="include"){if(_.direction==="decreasing"){I.start=T(o.tickIncrement(w(I.start),I.size,true,y))}else{I.end=T(o.tickIncrement(w(I.end),I.size,false,y))}}h.size=I.size;if(!h.sizeFound){b.size=I.size;n.nestedProperty(m[0],u+".size").set(I.size)}M("start",h,I);M("end",h,I)}x=t["_"+s+"pos0"];delete t["_"+s+"pos0"];var O=t._input[u]||{};var z=n.extendFlat({},h);var D=h.start;var R=r.r2l(O.start);var F=R!==undefined;if((h.startFound||F)&&R!==r.r2l(D)){var B=F?R:n.aggNums(Math.min,null,x);var N={type:r.type==="category"||r.type==="multicategory"?"linear":r.type,r2l:r.r2l,dtick:h.size,tick0:D,calendar:y,range:[B,o.tickIncrement(B,h.size,false,y)].map(r.l2r)};var j=o.tickFirst(N);if(j>r.r2l(B)){j=o.tickIncrement(j,h.size,true,y)}z.start=r.l2r(j);if(!F)n.nestedProperty(t,u+".start").set(z.start)}var U=h.end;var V=r.r2l(O.end);var H=V!==undefined;if((h.endFound||H)&&V!==r.r2l(U)){var q=H?V:n.aggNums(Math.max,null,x);z.end=r.l2r(q);if(!H)n.nestedProperty(t,u+".start").set(z.end)}var G="autobin"+s;if(t._input[G]===false){t._input[u]=n.extendFlat({},t[u]||{});delete t._input[G];delete t[G]}return[z,x]}function v(e,t,r,a,i){var o=e._fullLayout;var s=d(e,t);var l=false;var u=Infinity;var c=[t];var f,h,v;for(f=0;f<s.length;f++){h=s[f];if(h===t){l=true}else if(!l){v=o._histogramBinOpts[h["_"+a+"bingroup"]];u=Math.min(u,v.size||h[i].size)}else{var m=p(e,h,r,a,true);var g=m[0];var y=m[2];h["_"+a+"autoBinFinished"]=1;h["_"+a+"pos0"]=m[1];if(y){c.push(h)}else{u=Math.min(u,g.size)}}}var x=new Array(c.length);for(f=0;f<c.length;f++){var b=c[f]["_"+a+"pos0"];for(var _=0;_<b.length;_++){if(b[_]!==undefined){x[f]=b[_];break}}}if(!isFinite(u)){u=n.distinctVals(x).minDiff}for(f=0;f<c.length;f++){h=c[f];var w=h[a+"calendar"];var T={start:r.c2r(x[f]-u/2,0,w),end:r.c2r(x[f]+u/2,0,w),size:u};h._input[i]=h[i]=T;v=o._histogramBinOpts[h["_"+a+"bingroup"]];if(v)n.extendFlat(v,T)}return t[i]}function d(e,t){var r=t.xaxis;var a=t.yaxis;var n=t.orientation;var i=[];var o=e._fullData;for(var s=0;s<o.length;s++){var l=o[s];if(l.type==="histogram"&&l.visible===true&&l.orientation===n&&l.xaxis===r&&l.yaxis===a){i.push(l)}}return i}function m(e,t,r){var a,n,i;function o(t){i=e[t];e[t]/=2}function s(t){n=e[t];e[t]=i+n/2;i+=n}if(r==="half"){if(t==="increasing"){o(0);for(a=1;a<e.length;a++){s(a)}}else{o(e.length-1);for(a=e.length-2;a>=0;a--){s(a)}}}else if(t==="increasing"){for(a=1;a<e.length;a++){e[a]+=e[a-1]}if(r==="exclude"){e.unshift(0);e.pop()}}else{for(a=e.length-2;a>=0;a--){e[a]+=e[a+1]}if(r==="exclude"){e.push(0);e.shift()}}}t.exports={calc:h,calcAllAutoBins:p}},{"../../lib":787,"../../plots/cartesian/axes":838,"../../registry":915,"../bar/arrays_to_calcdata":924,"./average":1089,"./bin_functions":1091,"./bin_label_vals":1092,"./norm_functions":1100,"fast-isnumeric":246}],1094:[function(e,t,r){"use strict";t.exports={eventDataKeys:["binNumber"]}},{}],1095:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("../../plots/cartesian/axis_ids");var i=e("../../registry").traceIs;var o=e("../bar/defaults").handleGroupingDefaults;var s=a.nestedProperty;var l=e("../../plots/cartesian/constraints").getAxisGroup;var u=[{aStr:{x:"xbins.start",y:"ybins.start"},name:"start"},{aStr:{x:"xbins.end",y:"ybins.end"},name:"end"},{aStr:{x:"xbins.size",y:"ybins.size"},name:"size"},{aStr:{x:"nbinsx",y:"nbinsy"},name:"nbins"}];var c=["x","y"];t.exports=function e(t,r){var f=r._histogramBinOpts={};var h=[];var p={};var v=[];var d,m,g,y;var x,b,_;function w(e,t){return a.coerce(d._input,d,d._module.attributes,e,t)}function T(e){return e.orientation==="v"?"x":"y"}function k(e,t){var a=n.getFromTrace({_fullLayout:r},e,t);return a.type}function M(e,t,r){var n=e.uid+"__"+r;if(!t)t=n;var i=k(e,r);var o=e[r+"calendar"]||"";var s=f[t];var l=true;if(s){if(i===s.axType&&o===s.calendar){l=false;s.traces.push(e);s.dirs.push(r)}else{t=n;if(i!==s.axType){a.warn(["Attempted to group the bins of trace",e.index,"set on a","type:"+i,"axis","with bins on","type:"+s.axType,"axis."].join(" "))}if(o!==s.calendar){a.warn(["Attempted to group the bins of trace",e.index,"set with a",o,"calendar","with bins",s.calendar?"on a "+s.calendar+" calendar":"w/o a set calendar"].join(" "))}}}if(l){f[t]={traces:[e],dirs:[r],axType:i,calendar:e[r+"calendar"]||""}}e["_"+r+"bingroup"]=t}for(x=0;x<t.length;x++){d=t[x];if(i(d,"histogram")){h.push(d);delete d._xautoBinFinished;delete d._yautoBinFinished;if(!i(d,"2dMap")){o(d._input,d,r,w)}}}var A=r._alignmentOpts||{};for(x=0;x<h.length;x++){d=h[x];g="";if(!i(d,"2dMap")){y=T(d);if(r.barmode==="group"&&d.alignmentgroup){var S=d[y+"axis"];var E=l(r,S)+d.orientation;if((A[E]||{})[d.alignmentgroup]){g=E}}if(!g&&r.barmode!=="overlay"){g=l(r,d.xaxis)+l(r,d.yaxis)+T(d)}}if(g){if(!p[g]){p[g]=[]}p[g].push(d)}else{v.push(d)}}for(g in p){m=p[g];if(m.length===1){v.push(m[0]);continue}var L=false;if(m.length){d=m[0];L=w("bingroup")}g=L||g;for(x=0;x<m.length;x++){d=m[x];var C=d._input.bingroup;if(C&&C!==g){a.warn(["Trace",d.index,"must match","within bingroup",g+".","Ignoring its bingroup:",C,"setting."].join(" "))}d.bingroup=g;M(d,g,T(d))}}for(x=0;x<v.length;x++){d=v[x];var I=w("bingroup");if(i(d,"2dMap")){for(_=0;_<2;_++){y=c[_];var P=w(y+"bingroup",I?I+"__"+y:null);M(d,P,y)}}else{M(d,I,T(d))}}for(g in f){var O=f[g];m=O.traces;for(b=0;b<u.length;b++){var z=u[b];var D=z.name;var R;var F;if(D==="nbins"&&O.sizeFound)continue;for(x=0;x<m.length;x++){d=m[x];y=O.dirs[x];R=z.aStr[y];if(s(d._input,R).get()!==undefined){O[D]=w(R);O[D+"Found"]=true;break}F=(d._autoBin||{})[y]||{};if(F[D]){s(d,R).set(F[D])}}if(D==="start"||D==="end"){for(;x<m.length;x++){d=m[x];if(d["_"+y+"bingroup"]){F=(d._autoBin||{})[y]||{};w(R,F[D])}}}if(D==="nbins"&&!O.sizeFound&&!O.nbinsFound){d=m[0];O[D]=w(R)}}}}},{"../../lib":787,"../../plots/cartesian/axis_ids":842,"../../plots/cartesian/constraints":846,"../../registry":915,"../bar/defaults":929}],1096:[function(e,t,r){"use strict";var a=e("../../registry");var n=e("../../lib");var i=e("../../components/color");var o=e("../bar/style_defaults");var s=e("./attributes");t.exports=function e(t,r,l,u){function c(e,a){return n.coerce(t,r,s,e,a)}var f=c("x");var h=c("y");var p=c("cumulative.enabled");if(p){c("cumulative.direction");c("cumulative.currentbin")}c("text");c("hovertext");c("hovertemplate");c("xhoverformat");c("yhoverformat");var v=c("orientation",h&&!f?"h":"v");var d=v==="v"?"x":"y";var m=v==="v"?"y":"x";var g=f&&h?Math.min(n.minRowLength(f)&&n.minRowLength(h)):n.minRowLength(r[d]||[]);if(!g){r.visible=false;return}r._length=g;var y=a.getComponentMethod("calendars","handleTraceDefaults");y(t,r,["x","y"],u);var x=r[m];if(x)c("histfunc");c("histnorm");c("autobin"+d);o(t,r,c,l,u);n.coerceSelectionMarkerOpacity(r,c);var b=(r.marker.line||{}).color;var _=a.getComponentMethod("errorbars","supplyDefaults");_(t,r,b||i.defaultLine,{axis:"y"});_(t,r,b||i.defaultLine,{axis:"x",inherit:"y"})}},{"../../components/color":650,"../../lib":787,"../../registry":915,"../bar/style_defaults":940,"./attributes":1088}],1097:[function(e,t,r){"use strict";t.exports=function e(t,r,a,n,i){t.x="xVal"in r?r.xVal:r.x;t.y="yVal"in r?r.yVal:r.y;if("zLabelVal"in r)t.z=r.zLabelVal;if(r.xa)t.xaxis=r.xa;if(r.ya)t.yaxis=r.ya;if(!(a.cumulative||{}).enabled){var o=Array.isArray(i)?n[0].pts[i[0]][i[1]]:n[i].pts;t.pointNumbers=o;t.binNumber=t.pointNumber;delete t.pointNumber;delete t.pointIndex;var s;if(a._indexToPoints){s=[];for(var l=0;l<o.length;l++){s=s.concat(a._indexToPoints[o[l]])}}else{s=o}t.pointIndices=s}return t}},{}],1098:[function(e,t,r){"use strict";var a=e("../bar/hover").hoverPoints;var n=e("../../plots/cartesian/axes").hoverLabelText;t.exports=function e(t,r,i,o,s){var l=a(t,r,i,o,s);if(!l)return;t=l[0];var u=t.cd[t.index];var c=t.cd[0].trace;if(!c.cumulative.enabled){var f=c.orientation==="h"?"y":"x";t[f+"Label"]=n(t[f+"a"],[u.ph0,u.ph1],c[f+"hoverformat"])}return l}},{"../../plots/cartesian/axes":838,"../bar/hover":932}],1099:[function(e,t,r){"use strict";t.exports={attributes:e("./attributes"),layoutAttributes:e("../bar/layout_attributes"),supplyDefaults:e("./defaults"),crossTraceDefaults:e("./cross_trace_defaults"),supplyLayoutDefaults:e("../bar/layout_defaults"),calc:e("./calc").calc,crossTraceCalc:e("../bar/cross_trace_calc").crossTraceCalc,plot:e("../bar/plot").plot,layerName:"barlayer",style:e("../bar/style").style,styleOnSelect:e("../bar/style").styleOnSelect,colorbar:e("../scatter/marker_colorbar"),hoverPoints:e("./hover"),selectPoints:e("../bar/select"),eventData:e("./event_data"),moduleType:"trace",name:"histogram",basePlotModule:e("../../plots/cartesian"),categories:["bar-like","cartesian","svg","bar","histogram","oriented","errorBarsOK","showLegend"],meta:{}}},{"../../plots/cartesian":852,"../bar/cross_trace_calc":928,"../bar/layout_attributes":934,"../bar/layout_defaults":935,"../bar/plot":936,"../bar/select":937,"../bar/style":939,"../scatter/marker_colorbar":1220,"./attributes":1088,"./calc":1093,"./cross_trace_defaults":1095,"./defaults":1096,"./event_data":1097,"./hover":1098}],1100:[function(e,t,r){"use strict";t.exports={percent:function(e,t){var r=e.length;var a=100/t;for(var n=0;n<r;n++)e[n]*=a},probability:function(e,t){var r=e.length;for(var a=0;a<r;a++)e[a]/=t},density:function(e,t,r,a){var n=e.length;a=a||1;for(var i=0;i<n;i++)e[i]*=r[i]*a},"probability density":function(e,t,r,a){var n=e.length;if(a)t/=a;for(var i=0;i<n;i++)e[i]*=r[i]/t}}},{}],1101:[function(e,t,r){"use strict";var a=e("../histogram/attributes");var n=e("../histogram/bin_attributes");var i=e("../heatmap/attributes");var o=e("../../plots/attributes");var s=e("../../plots/cartesian/axis_format_attributes").axisHoverFormat;var l=e("../../plots/template_attributes").hovertemplateAttrs;var u=e("../../components/colorscale/attributes");var c=e("../../lib/extend").extendFlat;t.exports=c({x:a.x,y:a.y,z:{valType:"data_array",editType:"calc"},marker:{color:{valType:"data_array",editType:"calc"},editType:"calc"},histnorm:a.histnorm,histfunc:a.histfunc,nbinsx:a.nbinsx,xbins:n("x"),nbinsy:a.nbinsy,ybins:n("y"),autobinx:a.autobinx,autobiny:a.autobiny,bingroup:c({},a.bingroup,{}),xbingroup:c({},a.bingroup,{}),ybingroup:c({},a.bingroup,{}),xgap:i.xgap,ygap:i.ygap,zsmooth:i.zsmooth,xhoverformat:s("x"),yhoverformat:s("y"),zhoverformat:s("z",1),hovertemplate:l({},{keys:"z"}),showlegend:c({},o.showlegend,{dflt:false})},u("",{cLetter:"z",autoColorDflt:false}))},{"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../plots/attributes":834,"../../plots/cartesian/axis_format_attributes":841,"../../plots/template_attributes":910,"../heatmap/attributes":1069,"../histogram/attributes":1088,"../histogram/bin_attributes":1090}],1102:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("../../plots/cartesian/axes");var i=e("../histogram/bin_functions");var o=e("../histogram/norm_functions");var s=e("../histogram/average");var l=e("../histogram/bin_label_vals");var u=e("../histogram/calc").calcAllAutoBins;t.exports=function e(t,r){var l=n.getFromId(t,r.xaxis);var p=n.getFromId(t,r.yaxis);var v=r.xcalendar;var d=r.ycalendar;var m=function(e){return l.r2c(e,0,v)};var g=function(e){return p.r2c(e,0,d)};var y=function(e){return l.c2r(e,0,v)};var x=function(e){return p.c2r(e,0,d)};var b,_,w,T;var k=u(t,r,l,"x");var M=k[0];var A=k[1];var S=u(t,r,p,"y");var E=S[0];var L=S[1];var C=r._length;if(A.length>C)A.splice(C,A.length-C);if(L.length>C)L.splice(C,L.length-C);var I=[];var P=[];var O=[];var z=typeof M.size==="string";var D=typeof E.size==="string";var R=[];var F=[];var B=z?R:M;var N=D?F:E;var j=0;var U=[];var V=[];var H=r.histnorm;var q=r.histfunc;var G=H.indexOf("density")!==-1;var Y=q==="max"||q==="min";var W=Y?null:0;var X=i.count;var Z=o[H];var J=false;var K=[];var Q=[];var $="z"in r?r.z:"marker"in r&&Array.isArray(r.marker.color)?r.marker.color:"";if($&&q!=="count"){J=q==="avg";X=i[q]}var ee=M.size;var te=m(M.start);var re=m(M.end)+(te-n.tickIncrement(te,ee,false,v))/1e6;for(b=te;b<re;b=n.tickIncrement(b,ee,false,v)){P.push(W);R.push(b);if(J)O.push(0)}R.push(b);var ae=P.length;var ne=(b-te)/ae;var ie=y(te+ne/2);var oe=E.size;var se=g(E.start);var le=g(E.end)+(se-n.tickIncrement(se,oe,false,d))/1e6;for(b=se;b<le;b=n.tickIncrement(b,oe,false,d)){I.push(P.slice());F.push(b);var ue=new Array(ae);for(_=0;_<ae;_++)ue[_]=[];V.push(ue);if(J)U.push(O.slice())}F.push(b);var ce=I.length;var fe=(b-se)/ce;var he=x(se+fe/2);if(G){K=c(P.length,B,ne,z);Q=c(I.length,N,fe,D)}if(!z&&l.type==="date")B=f(m,B);if(!D&&p.type==="date")N=f(g,N);var pe=true;var ve=true;var de=new Array(ae);var me=new Array(ce);var ge=Infinity;var ye=Infinity;var xe=Infinity;var be=Infinity;for(b=0;b<C;b++){var _e=A[b];var we=L[b];w=a.findBin(_e,B);T=a.findBin(we,N);if(w>=0&&w<ae&&T>=0&&T<ce){j+=X(w,b,I[T],$,U[T]);V[T][w].push(b);if(pe){if(de[w]===undefined)de[w]=_e;else if(de[w]!==_e)pe=false}if(ve){if(me[T]===undefined)me[T]=we;else if(me[T]!==we)ve=false}ge=Math.min(ge,_e-R[w]);ye=Math.min(ye,R[w+1]-_e);xe=Math.min(xe,we-F[T]);be=Math.min(be,F[T+1]-we)}}if(J){for(T=0;T<ce;T++)j+=s(I[T],U[T])}if(Z){for(T=0;T<ce;T++)Z(I[T],j,K,Q[T])}return{x:A,xRanges:h(R,pe&&de,ge,ye,l,v),x0:ie,dx:ne,y:L,yRanges:h(F,ve&&me,xe,be,p,d),y0:he,dy:fe,z:I,pts:V}};function c(e,t,r,a){var n=new Array(e);var i;if(a){for(i=0;i<e;i++)n[i]=1/(t[i+1]-t[i])}else{var o=1/r;for(i=0;i<e;i++)n[i]=o}return n}function f(e,t){return{start:e(t.start),end:e(t.end),size:t.size}}function h(e,t,r,a,n,i){var o;var s=e.length-1;var u=new Array(s);var c=l(r,a,e,n,i);for(o=0;o<s;o++){var f=(t||[])[o];u[o]=f===undefined?[c(e[o]),c(e[o+1],true)]:[f,f]}return u}},{"../../lib":787,"../../plots/cartesian/axes":838,"../histogram/average":1089,"../histogram/bin_functions":1091,"../histogram/bin_label_vals":1092,"../histogram/calc":1093,"../histogram/norm_functions":1100}],1103:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("./sample_defaults");var i=e("../heatmap/style_defaults");var o=e("../../components/colorscale/defaults");var s=e("./attributes");t.exports=function e(t,r,l,u){function c(e,n){return a.coerce(t,r,s,e,n)}n(t,r,c,u);if(r.visible===false)return;i(t,r,c,u);o(t,r,u,c,{prefix:"",cLetter:"z"});c("hovertemplate");c("xhoverformat");c("yhoverformat")}},{"../../components/colorscale/defaults":660,"../../lib":787,"../heatmap/style_defaults":1082,"./attributes":1101,"./sample_defaults":1106}],1104:[function(e,t,r){"use strict";var a=e("../heatmap/hover");var n=e("../../plots/cartesian/axes").hoverLabelText;t.exports=function e(t,r,i,o,s){var l=a(t,r,i,o,s);if(!l)return;t=l[0];var u=t.index;var c=u[0];var f=u[1];var h=t.cd[0];var p=h.trace;var v=h.xRanges[f];var d=h.yRanges[c];t.xLabel=n(t.xa,[v[0],v[1]],p.xhoverformat);t.yLabel=n(t.ya,[d[0],d[1]],p.yhoverformat);return l}},{"../../plots/cartesian/axes":838,"../heatmap/hover":1076}],1105:[function(e,t,r){"use strict";t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),crossTraceDefaults:e("../histogram/cross_trace_defaults"),calc:e("../heatmap/calc"),plot:e("../heatmap/plot"),layerName:"heatmaplayer",colorbar:e("../heatmap/colorbar"),style:e("../heatmap/style"),hoverPoints:e("./hover"),eventData:e("../histogram/event_data"),moduleType:"trace",name:"histogram2d",basePlotModule:e("../../plots/cartesian"),categories:["cartesian","svg","2dMap","histogram","showLegend"],meta:{}}},{"../../plots/cartesian":852,"../heatmap/calc":1070,"../heatmap/colorbar":1072,"../heatmap/plot":1080,"../heatmap/style":1081,"../histogram/cross_trace_defaults":1095,"../histogram/event_data":1097,"./attributes":1101,"./defaults":1103,"./hover":1104}],1106:[function(e,t,r){"use strict";var a=e("../../registry");var n=e("../../lib");t.exports=function e(t,r,i,o){var s=i("x");var l=i("y");var u=n.minRowLength(s);var c=n.minRowLength(l);if(!u||!c){r.visible=false;return}r._length=Math.min(u,c);var f=a.getComponentMethod("calendars","handleTraceDefaults");f(t,r,["x","y"],o);var h=i("z")||i("marker.color");if(h)i("histfunc");i("histnorm");i("autobinx");i("autobiny")}},{"../../lib":787,"../../registry":915}],1107:[function(e,t,r){"use strict";var a=e("../histogram2d/attributes");var n=e("../contour/attributes");var i=e("../../components/colorscale/attributes");var o=e("../../plots/cartesian/axis_format_attributes").axisHoverFormat;var s=e("../../lib/extend").extendFlat;t.exports=s({x:a.x,y:a.y,z:a.z,marker:a.marker,histnorm:a.histnorm,histfunc:a.histfunc,nbinsx:a.nbinsx,xbins:a.xbins,nbinsy:a.nbinsy,ybins:a.ybins,autobinx:a.autobinx,autobiny:a.autobiny,bingroup:a.bingroup,xbingroup:a.xbingroup,ybingroup:a.ybingroup,autocontour:n.autocontour,ncontours:n.ncontours,contours:n.contours,line:{color:n.line.color,width:s({},n.line.width,{dflt:.5}),dash:n.line.dash,smoothing:n.line.smoothing,editType:"plot"},xhoverformat:o("x"),yhoverformat:o("y"),zhoverformat:o("z",1),hovertemplate:a.hovertemplate},i("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../plots/cartesian/axis_format_attributes":841,"../contour/attributes":1012,"../histogram2d/attributes":1101}],1108:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("../histogram2d/sample_defaults");var i=e("../contour/contours_defaults");var o=e("../contour/style_defaults");var s=e("./attributes");t.exports=function e(t,r,l,u){function c(e,n){return a.coerce(t,r,s,e,n)}function f(e){return a.coerce2(t,r,s,e)}n(t,r,c,u);if(r.visible===false)return;i(t,r,c,f);o(t,r,c,u);c("hovertemplate");c("xhoverformat");c("yhoverformat")}},{"../../lib":787,"../contour/contours_defaults":1019,"../contour/style_defaults":1033,"../histogram2d/sample_defaults":1106,"./attributes":1107}],1109:[function(e,t,r){"use strict";t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),crossTraceDefaults:e("../histogram/cross_trace_defaults"),calc:e("../contour/calc"),plot:e("../contour/plot").plot,layerName:"contourlayer",style:e("../contour/style"),colorbar:e("../contour/colorbar"),hoverPoints:e("../contour/hover"),moduleType:"trace",name:"histogram2dcontour",basePlotModule:e("../../plots/cartesian"),categories:["cartesian","svg","2dMap","contour","histogram","showLegend"],meta:{}}},{"../../plots/cartesian":852,"../contour/calc":1013,"../contour/colorbar":1015,"../contour/hover":1025,"../contour/plot":1030,"../contour/style":1032,"../histogram/cross_trace_defaults":1095,"./attributes":1107,"./defaults":1108}],1110:[function(e,t,r){"use strict";var a=e("../../plots/template_attributes").hovertemplateAttrs;var n=e("../../plots/template_attributes").texttemplateAttrs;var i=e("../../components/colorscale/attributes");var o=e("../../plots/domain").attributes;var s=e("../pie/attributes");var l=e("../sunburst/attributes");var u=e("../treemap/attributes");var c=e("../treemap/constants");var f=e("../../lib/extend").extendFlat;t.exports={labels:l.labels,parents:l.parents,values:l.values,branchvalues:l.branchvalues,count:l.count,level:l.level,maxdepth:l.maxdepth,tiling:{orientation:{valType:"enumerated",values:["v","h"],dflt:"h",editType:"plot"},flip:u.tiling.flip,pad:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"calc"},marker:f({colors:l.marker.colors,line:l.marker.line,editType:"calc"},i("marker",{colorAttr:"colors",anim:false})),leaf:l.leaf,pathbar:u.pathbar,text:s.text,textinfo:l.textinfo,texttemplate:n({editType:"plot"},{keys:c.eventDataKeys.concat(["label","value"])}),hovertext:s.hovertext,hoverinfo:l.hoverinfo,hovertemplate:a({},{keys:c.eventDataKeys}),textfont:s.textfont,insidetextfont:s.insidetextfont,outsidetextfont:u.outsidetextfont,textposition:u.textposition,sort:s.sort,root:l.root,domain:o({name:"icicle",trace:true,editType:"calc"})}},{"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../plots/domain":866,"../../plots/template_attributes":910,"../pie/attributes":1176,"../sunburst/attributes":1314,"../treemap/attributes":1340,"../treemap/constants":1343}],1111:[function(e,t,r){"use strict";var a=e("../../plots/plots");r.name="icicle";r.plot=function(e,t,n,i){a.plotBasePlot(r.name,e,t,n,i)};r.clean=function(e,t,n,i){a.cleanBasePlot(r.name,e,t,n,i)}},{"../../plots/plots":901}],1112:[function(e,t,r){"use strict";var a=e("../sunburst/calc");r.calc=function(e,t){return a.calc(e,t)};r.crossTraceCalc=function(e){return a._runCrossTraceCalc("icicle",e)}},{"../sunburst/calc":1316}],1113:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("./attributes");var i=e("../../components/color");var o=e("../../plots/domain").defaults;var s=e("../bar/defaults").handleText;var l=e("../bar/constants").TEXTPAD;var u=e("../../components/colorscale");var c=u.hasColorscale;var f=u.handleDefaults;t.exports=function e(t,r,u,h){function p(e,i){return a.coerce(t,r,n,e,i)}var v=p("labels");var d=p("parents");if(!v||!v.length||!d||!d.length){r.visible=false;return}var m=p("values");if(m&&m.length){p("branchvalues")}else{p("count")}p("level");p("maxdepth");p("tiling.orientation");p("tiling.flip");p("tiling.pad");var g=p("text");p("texttemplate");if(!r.texttemplate)p("textinfo",Array.isArray(g)?"text+label":"label");p("hovertext");p("hovertemplate");var y=p("pathbar.visible");var x="auto";s(t,r,h,p,x,{hasPathbar:y,moduleHasSelected:false,moduleHasUnselected:false,moduleHasConstrain:false,moduleHasCliponaxis:false,moduleHasTextangle:false,moduleHasInsideanchor:false});p("textposition");var b=p("marker.line.width");if(b)p("marker.line.color",h.paper_bgcolor);p("marker.colors");var _=r._hasColorscale=c(t,"marker","colors")||(t.marker||{}).coloraxis;if(_){f(t,r,h,p,{prefix:"marker.",cLetter:"c"})}p("leaf.opacity",_?1:.7);r._hovered={marker:{line:{width:2,color:i.contrast(h.paper_bgcolor)}}};if(y){p("pathbar.thickness",r.pathbar.textfont.size+2*l);p("pathbar.side");p("pathbar.edgeshape")}p("sort");p("root.color");o(r,h,p);r._length=null}},{"../../components/color":650,"../../components/colorscale":662,"../../lib":787,"../../plots/domain":866,"../bar/constants":927,"../bar/defaults":929,"./attributes":1110}],1114:[function(e,t,r){"use strict";var a=e("@plotly/d3");var n=e("../../lib");var i=e("../../components/drawing");var o=e("../../lib/svg_text_utils");var s=e("./partition");var l=e("./style").styleOne;var u=e("../treemap/constants");var c=e("../sunburst/helpers");var f=e("../sunburst/fx");var h=e("../sunburst/plot").formatSliceLabel;var p=false;t.exports=function e(t,r,v,d,m){var g=m.width;var y=m.height;var x=m.viewX;var b=m.viewY;var _=m.pathSlice;var w=m.toMoveInsideSlice;var T=m.strTransform;var k=m.hasTransition;var M=m.handleSlicesExit;var A=m.makeUpdateSliceInterpolator;var S=m.makeUpdateTextInterpolator;var E=m.prevEntry;var L={};var C=t._fullLayout;var I=r[0];var P=I.trace;var O=P.textposition.indexOf("left")!==-1;var z=P.textposition.indexOf("right")!==-1;var D=P.textposition.indexOf("bottom")!==-1;var R=s(v,[g,y],{flipX:P.tiling.flip.indexOf("x")>-1,flipY:P.tiling.flip.indexOf("y")>-1,orientation:P.tiling.orientation,pad:{inner:P.tiling.pad},maxDepth:P._maxDepth});var F=R.descendants();var B=Infinity;var N=-Infinity;F.forEach((function(e){var t=e.depth;if(t>=P._maxDepth){e.x0=e.x1=(e.x0+e.x1)/2;e.y0=e.y1=(e.y0+e.y1)/2}else{B=Math.min(B,t);N=Math.max(N,t)}}));d=d.data(F,c.getPtId);P._maxVisibleLayers=isFinite(N)?N-B+1:0;d.enter().append("g").classed("slice",true);M(d,p,L,[g,y],_);d.order();var j=null;if(k&&E){var U=c.getPtId(E);d.each((function(e){if(j===null&&c.getPtId(e)===U){j={x0:e.x0,x1:e.x1,y0:e.y0,y1:e.y1}}}))}var V=function(){return j||{x0:0,x1:g,y0:0,y1:y}};var H=d;if(k){H=H.transition().each("end",(function(){var e=a.select(this);c.setSliceCursor(e,t,{hideOnRoot:true,hideOnLeaves:false,isTransitioning:false})}))}H.each((function(e){e._x0=x(e.x0);e._x1=x(e.x1);e._y0=b(e.y0);e._y1=b(e.y1);e._hoverX=x(e.x1-P.tiling.pad),e._hoverY=D?b(e.y1-P.tiling.pad/2):b(e.y0+P.tiling.pad/2);var s=a.select(this);var d=n.ensureSingle(s,"path","surface",(function(e){e.style("pointer-events","all")}));if(k){d.transition().attrTween("d",(function(e){var t=A(e,p,V(),[g,y],{orientation:P.tiling.orientation,flipX:P.tiling.flip.indexOf("x")>-1,flipY:P.tiling.flip.indexOf("y")>-1});return function(e){return _(t(e))}}))}else{d.attr("d",_)}s.call(f,v,t,r,{styleOne:l,eventDataKeys:u.eventDataKeys,transitionTime:u.CLICK_TRANSITION_TIME,transitionEasing:u.CLICK_TRANSITION_EASING}).call(c.setSliceCursor,t,{isTransitioning:t._transitioning});d.call(l,e,P,{hovered:false});if(e.x0===e.x1||e.y0===e.y1){e._text=""}else{e._text=h(e,v,P,r,C)||""}var m=n.ensureSingle(s,"g","slicetext");var M=n.ensureSingle(m,"text","",(function(e){e.attr("data-notex",1)}));var E=n.ensureUniformFontSize(t,c.determineTextFont(P,e,C.font));M.text(e._text||" ").classed("slicetext",true).attr("text-anchor",z?"end":O?"start":"middle").call(i.font,E).call(o.convertToTspans,t);e.textBB=i.bBox(M.node());e.transform=w(e,{fontSize:E.size});e.transform.fontSize=E.size;if(k){M.transition().attrTween("transform",(function(e){var t=S(e,p,V(),[g,y]);return function(e){return T(t(e))}}))}else{M.attr("transform",T(e))}}));return j}},{"../../components/drawing":672,"../../lib":787,"../../lib/svg_text_utils":813,"../sunburst/fx":1319,"../sunburst/helpers":1320,"../sunburst/plot":1324,"../treemap/constants":1343,"./partition":1118,"./style":1120,"@plotly/d3":58}],1115:[function(e,t,r){"use strict";t.exports={moduleType:"trace",name:"icicle",basePlotModule:e("./base_plot"),categories:[],animatable:true,attributes:e("./attributes"),layoutAttributes:e("./layout_attributes"),supplyDefaults:e("./defaults"),supplyLayoutDefaults:e("./layout_defaults"),calc:e("./calc").calc,crossTraceCalc:e("./calc").crossTraceCalc,plot:e("./plot"),style:e("./style").style,colorbar:e("../scatter/marker_colorbar"),meta:{}}},{"../scatter/marker_colorbar":1220,"./attributes":1110,"./base_plot":1111,"./calc":1112,"./defaults":1113,"./layout_attributes":1116,"./layout_defaults":1117,"./plot":1119,"./style":1120}],1116:[function(e,t,r){"use strict";t.exports={iciclecolorway:{valType:"colorlist",editType:"calc"},extendiciclecolors:{valType:"boolean",dflt:true,editType:"calc"}}},{}],1117:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("./layout_attributes");t.exports=function e(t,r){function i(e,i){return a.coerce(t,r,n,e,i)}i("iciclecolorway",r.colorway);i("extendiciclecolors")}},{"../../lib":787,"./layout_attributes":1116}],1118:[function(e,t,r){"use strict";var a=e("d3-hierarchy");var n=e("../treemap/flip_tree");t.exports=function e(t,r,i){var o=i.flipX;var s=i.flipY;var l=i.orientation==="h";var u=i.maxDepth;var c=r[0];var f=r[1];if(u){c=(t.height+1)*r[0]/Math.min(t.height+1,u);f=(t.height+1)*r[1]/Math.min(t.height+1,u)}var h=a.partition().padding(i.pad.inner).size(l?[r[1],c]:[r[0],f])(t);if(l||o||s){n(h,r,{swapXY:l,flipX:o,flipY:s})}return h}},{"../treemap/flip_tree":1348,"d3-hierarchy":167}],1119:[function(e,t,r){"use strict";var a=e("../treemap/draw");var n=e("./draw_descendants");t.exports=function e(t,r,i,o){return a(t,r,i,o,{type:"icicle",drawDescendants:n})}},{"../treemap/draw":1345,"./draw_descendants":1114}],1120:[function(e,t,r){"use strict";var a=e("@plotly/d3");var n=e("../../components/color");var i=e("../../lib");var o=e("../bar/uniform_text").resizeText;function s(e){var t=e._fullLayout._iciclelayer.selectAll(".trace");o(e,t,"icicle");t.each((function(e){var t=a.select(this);var r=e[0];var n=r.trace;t.style("opacity",n.opacity);t.selectAll("path.surface").each((function(e){a.select(this).call(l,e,n)}))}))}function l(e,t,r){var a=t.data.data;var o=!t.children;var s=a.i;var l=i.castOption(r,s,"marker.line.color")||n.defaultLine;var u=i.castOption(r,s,"marker.line.width")||0;e.style("stroke-width",u).call(n.fill,a.color).call(n.stroke,l).style("opacity",o?r.leaf.opacity:null)}t.exports={style:s,styleOne:l}},{"../../components/color":650,"../../lib":787,"../bar/uniform_text":941,"@plotly/d3":58}],1121:[function(e,t,r){"use strict";var a=e("../../plots/attributes");var n=e("../../plots/template_attributes").hovertemplateAttrs;var i=e("../../lib/extend").extendFlat;var o=e("./constants").colormodel;var s=["rgb","rgba","rgba256","hsl","hsla"];var l=[];var u=[];for(var c=0;c<s.length;c++){var f=o[s[c]];l.push("For the `"+s[c]+"` colormodel, it is ["+(f.zminDflt||f.min).join(", ")+"].");u.push("For the `"+s[c]+"` colormodel, it is ["+(f.zmaxDflt||f.max).join(", ")+"].")}t.exports=i({source:{valType:"string",editType:"calc"},z:{valType:"data_array",editType:"calc"},colormodel:{valType:"enumerated",values:s,editType:"calc"},zsmooth:{valType:"enumerated",values:["fast",false],dflt:false,editType:"plot"},zmin:{valType:"info_array",items:[{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"}],editType:"calc"},zmax:{valType:"info_array",items:[{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"}],editType:"calc"},x0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},y0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dx:{valType:"number",dflt:1,editType:"calc"},dy:{valType:"number",dflt:1,editType:"calc"},text:{valType:"data_array",editType:"plot"},hovertext:{valType:"data_array",editType:"plot"},hoverinfo:i({},a.hoverinfo,{flags:["x","y","z","color","name","text"],dflt:"x+y+z+text+name"}),hovertemplate:n({},{keys:["z","color","colormodel"]}),transforms:undefined})},{"../../lib/extend":777,"../../plots/attributes":834,"../../plots/template_attributes":910,"./constants":1123}],1122:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("./constants");var i=e("fast-isnumeric");var o=e("../../plots/cartesian/axes");var s=e("../../lib").maxRowLength;var l=e("./helpers").getImageSize;t.exports=function e(t,r){var a;var n;if(r._hasZ){a=r.z.length;n=s(r.z)}else if(r._hasSource){var i=l(r.source);a=i.height;n=i.width}var u=o.getFromId(t,r.xaxis||"x");var c=o.getFromId(t,r.yaxis||"y");var h=u.d2c(r.x0)-r.dx/2;var p=c.d2c(r.y0)-r.dy/2;var v;var d=[h,h+n*r.dx];var m=[p,p+a*r.dy];if(u&&u.type==="log")for(v=0;v<n;v++)d.push(h+v*r.dx);if(c&&c.type==="log")for(v=0;v<a;v++)m.push(p+v*r.dy);r._extremes[u._id]=o.findExtremes(u,d);r._extremes[c._id]=o.findExtremes(c,m);r._scaler=f(r);var g={x0:h,y0:p,z:r.z,w:n,h:a};return[g]};function u(e,t,r,n){return function(i){return a.constrain((i-e)*t,r,n)}}function c(e,t){return function(r){return a.constrain(r,e,t)}}function f(e){var t=n.colormodel[e.colormodel];var r=t.colormodel||e.colormodel;var a=r.length;e._sArray=[];for(var o=0;o<a;o++){if(t.min[o]!==e.zmin[o]||t.max[o]!==e.zmax[o]){e._sArray.push(u(e.zmin[o],(t.max[o]-t.min[o])/(e.zmax[o]-e.zmin[o]),t.min[o],t.max[o]))}else{e._sArray.push(c(t.min[o],t.max[o]))}}return function(t){var r=t.slice(0,a);for(var n=0;n<a;n++){var o=r[n];if(!i(o))return false;r[n]=e._sArray[n](o)}return r}}},{"../../lib":787,"../../plots/cartesian/axes":838,"./constants":1123,"./helpers":1126,"fast-isnumeric":246}],1123:[function(e,t,r){"use strict";t.exports={colormodel:{rgb:{min:[0,0,0],max:[255,255,255],fmt:function(e){return e.slice(0,3)},suffix:["","",""]},rgba:{min:[0,0,0,0],max:[255,255,255,1],fmt:function(e){return e.slice(0,4)},suffix:["","","",""]},rgba256:{colormodel:"rgba",zminDflt:[0,0,0,0],zmaxDflt:[255,255,255,255],min:[0,0,0,0],max:[255,255,255,1],fmt:function(e){return e.slice(0,4)},suffix:["","","",""]},hsl:{min:[0,0,0],max:[360,100,100],fmt:function(e){var t=e.slice(0,3);t[1]=t[1]+"%";t[2]=t[2]+"%";return t},suffix:["°","%","%"]},hsla:{min:[0,0,0,0],max:[360,100,100,1],fmt:function(e){var t=e.slice(0,4);t[1]=t[1]+"%";t[2]=t[2]+"%";return t},suffix:["°","%","%",""]}},pixelatedStyle:["image-rendering: optimizeSpeed","image-rendering: -moz-crisp-edges","image-rendering: -o-crisp-edges","image-rendering: -webkit-optimize-contrast","image-rendering: optimize-contrast","image-rendering: crisp-edges","image-rendering: pixelated",""].join("; ")}},{}],1124:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("./attributes");var i=e("./constants");var o=e("../../snapshot/helpers").IMAGE_URL_PREFIX;t.exports=function e(t,r){function s(e,i){return a.coerce(t,r,n,e,i)}s("source");if(r.source&&!r.source.match(o))delete r.source;r._hasSource=!!r.source;var l=s("z");r._hasZ=!(l===undefined||!l.length||!l[0]||!l[0].length);if(!r._hasZ&&!r._hasSource){r.visible=false;return}s("x0");s("y0");s("dx");s("dy");var u;if(r._hasZ){s("colormodel","rgb");u=i.colormodel[r.colormodel];s("zmin",u.zminDflt||u.min);s("zmax",u.zmaxDflt||u.max)}else if(r._hasSource){r.colormodel="rgba256";u=i.colormodel[r.colormodel];r.zmin=u.zminDflt;r.zmax=u.zmaxDflt}s("zsmooth");s("text");s("hovertext");s("hovertemplate");r._length=null}},{"../../lib":787,"../../snapshot/helpers":919,"./attributes":1121,"./constants":1123}],1125:[function(e,t,r){"use strict";t.exports=function e(t,r){if("xVal"in r)t.x=r.xVal;if("yVal"in r)t.y=r.yVal;if(r.xa)t.xaxis=r.xa;if(r.ya)t.yaxis=r.ya;t.color=r.color;t.colormodel=r.trace.colormodel;if(!t.z)t.z=r.color;return t}},{}],1126:[function(e,t,r){"use strict";var a=e("probe-image-size/sync");var n=e("../../snapshot/helpers").IMAGE_URL_PREFIX;var i=e("buffer/").Buffer;r.getImageSize=function(e){var t=e.replace(n,"");var r=new i(t,"base64");return a(r)}},{"../../snapshot/helpers":919,"buffer/":117,"probe-image-size/sync":513}],1127:[function(e,t,r){"use strict";var a=e("../../components/fx");var n=e("../../lib");var i=e("./constants");t.exports=function e(t,r,o){var s=t.cd[0];var l=s.trace;var u=t.xa;var c=t.ya;if(a.inbox(r-s.x0,r-(s.x0+s.w*l.dx),0)>0||a.inbox(o-s.y0,o-(s.y0+s.h*l.dy),0)>0){return}var f=Math.floor((r-s.x0)/l.dx);var h=Math.floor(Math.abs(o-s.y0)/l.dy);var p;if(l._hasZ){p=s.z[h][f]}else if(l._hasSource){p=l._canvas.el.getContext("2d").getImageData(f,h,1,1).data}if(!p)return;var v=s.hi||l.hoverinfo;var d;if(v){var m=v.split("+");if(m.indexOf("all")!==-1)m=["color"];if(m.indexOf("color")!==-1)d=true}var g=i.colormodel[l.colormodel];var y=g.colormodel||l.colormodel;var x=y.length;var b=l._scaler(p);var _=g.suffix;var w=[];if(l.hovertemplate||d){w.push("["+[b[0]+_[0],b[1]+_[1],b[2]+_[2]].join(", "));if(x===4)w.push(", "+b[3]+_[3]);w.push("]");w=w.join("");t.extraText=y.toUpperCase()+": "+w}var T;if(Array.isArray(l.hovertext)&&Array.isArray(l.hovertext[h])){T=l.hovertext[h][f]}else if(Array.isArray(l.text)&&Array.isArray(l.text[h])){T=l.text[h][f]}var k=c.c2p(s.y0+(h+.5)*l.dy);var M=s.x0+(f+.5)*l.dx;var A=s.y0+(h+.5)*l.dy;var S="["+p.slice(0,l.colormodel.length).join(", ")+"]";return[n.extendFlat(t,{index:[h,f],x0:u.c2p(s.x0+f*l.dx),x1:u.c2p(s.x0+(f+1)*l.dx),y0:k,y1:k,color:b,xVal:M,xLabelVal:M,yVal:A,yLabelVal:A,zLabelVal:S,text:T,hovertemplateLabels:{zLabel:S,colorLabel:w,"color[0]Label":b[0]+_[0],"color[1]Label":b[1]+_[1],"color[2]Label":b[2]+_[2],"color[3]Label":b[3]+_[3]}})]}},{"../../components/fx":690,"../../lib":787,"./constants":1123}],1128:[function(e,t,r){"use strict";t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),calc:e("./calc"),plot:e("./plot"),style:e("./style"),hoverPoints:e("./hover"),eventData:e("./event_data"),moduleType:"trace",name:"image",basePlotModule:e("../../plots/cartesian"),categories:["cartesian","svg","2dMap","noSortingByValue"],animatable:false,meta:{}}},{"../../plots/cartesian":852,"./attributes":1121,"./calc":1122,"./defaults":1124,"./event_data":1125,"./hover":1127,"./plot":1129,"./style":1130}],1129:[function(e,t,r){"use strict";var a=e("@plotly/d3");var n=e("../../lib");var i=n.strTranslate;var o=e("../../constants/xmlns_namespaces");var s=e("./constants");var l=n.isIOS()||n.isSafari()||n.isIE();t.exports=function e(t,r,u,c){var f=r.xaxis;var h=r.yaxis;var p=!(l||t._context._exportedPlot);n.makeTraceGroups(c,u,"im").each((function(e){var r=a.select(this);var l=e[0];var u=l.trace;var c=(u.zsmooth==="fast"||u.zsmooth===false&&p)&&!u._hasZ&&u._hasSource&&f.type==="linear"&&h.type==="linear";u._realImage=c;var v=l.z;var d=l.x0;var m=l.y0;var g=l.w;var y=l.h;var x=u.dx;var b=u.dy;var _,w,T,k,M,A;A=0;while(_===undefined&&A<g){_=f.c2p(d+A*x);A++}A=g;while(w===undefined&&A>0){w=f.c2p(d+A*x);A--}A=0;while(k===undefined&&A<y){k=h.c2p(m+A*b);A++}A=y;while(M===undefined&&A>0){M=h.c2p(m+A*b);A--}if(w<_){T=w;w=_;_=T}if(M<k){T=k;k=M;M=T}if(!c){var S=.5;_=Math.max(-S*f._length,_);w=Math.min((1+S)*f._length,w);k=Math.max(-S*h._length,k);M=Math.min((1+S)*h._length,M)}var E=Math.round(w-_);var L=Math.round(M-k);var C=E<=0||L<=0;if(C){var I=r.selectAll("image").data([]);I.exit().remove();return}function P(e){var t=document.createElement("canvas");t.width=E;t.height=L;var r=t.getContext("2d");var a=function(e){return n.constrain(Math.round(f.c2p(d+e*x)-_),0,E)};var i=function(e){return n.constrain(Math.round(h.c2p(m+e*b)-k),0,L)};var o=s.colormodel[u.colormodel];var c=o.colormodel||u.colormodel;var p=o.fmt;var v;for(A=0;A<l.w;A++){var g=a(A);var y=a(A+1);if(y===g||isNaN(y)||isNaN(g))continue;for(var w=0;w<l.h;w++){var T=i(w);var M=i(w+1);if(M===T||isNaN(M)||isNaN(T)||!e(A,w))continue;v=u._scaler(e(A,w));if(v){r.fillStyle=c+"("+p(v).join(",")+")"}else{r.fillStyle="rgba(0,0,0,0)"}r.fillRect(g,T,y-g,M-T)}}return t}var O=r.selectAll("image").data([e]);O.enter().append("svg:image").attr({xmlns:o.svg,preserveAspectRatio:"none"});O.exit().remove();var z=u.zsmooth===false?s.pixelatedStyle:"";if(c){var D=n.simpleMap(f.range,f.r2l);var R=n.simpleMap(h.range,h.r2l);var F=D[1]<D[0];var B=R[1]>R[0];if(F||B){var N=_+E/2;var j=k+L/2;z+="transform:"+i(N+"px",j+"px")+"scale("+(F?-1:1)+","+(B?-1:1)+")"+i(-N+"px",-j+"px")+";"}}O.attr("style",z);var U=new Promise((function(e){if(u._hasZ){e()}else if(u._hasSource){if(u._canvas&&u._canvas.el.width===g&&u._canvas.el.height===y&&u._canvas.source===u.source){e()}else{var t=document.createElement("canvas");t.width=g;t.height=y;var r=t.getContext("2d");u._image=u._image||new Image;var a=u._image;a.onload=function(){r.drawImage(a,0,0);u._canvas={el:t,source:u.source};e()};a.setAttribute("src",u.source)}}})).then((function(){var e,t;if(u._hasZ){t=P((function(e,t){return v[t][e]}));e=t.toDataURL("image/png")}else if(u._hasSource){if(c){e=u.source}else{var r=u._canvas.el.getContext("2d");var a=r.getImageData(0,0,g,y).data;t=P((function(e,t){var r=4*(t*g+e);return[a[r],a[r+1],a[r+2],a[r+3]]}));e=t.toDataURL("image/png")}}O.attr({"xlink:href":e,height:L,width:E,x:_,y:k})}));t._promises.push(U)}))}},{"../../constants/xmlns_namespaces":764,"../../lib":787,"./constants":1123,"@plotly/d3":58}],1130:[function(e,t,r){"use strict";var a=e("@plotly/d3");t.exports=function e(t){a.select(t).selectAll(".im image").style("opacity",(function(e){return e[0].trace.opacity}))}},{"@plotly/d3":58}],1131:[function(e,t,r){"use strict";var a=e("../../lib/extend").extendFlat;var n=e("../../lib/extend").extendDeep;var i=e("../../plot_api/edit_types").overrideAll;var o=e("../../plots/font_attributes");var s=e("../../components/color/attributes");var l=e("../../plots/domain").attributes;var u=e("../../plots/cartesian/layout_attributes");var c=e("../../plot_api/plot_template").templatedArray;var f=e("../../constants/delta.js");var h=e("../../plots/cartesian/axis_format_attributes").descriptionOnlyNumbers;var p=o({editType:"plot",colorEditType:"plot"});var v={color:{valType:"color",editType:"plot"},line:{color:{valType:"color",dflt:s.defaultLine,editType:"plot"},width:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"calc"},thickness:{valType:"number",min:0,max:1,dflt:1,editType:"plot"},editType:"calc"};var d={valType:"info_array",items:[{valType:"number",editType:"plot"},{valType:"number",editType:"plot"}],editType:"plot"};var m=c("step",n({},v,{range:d}));t.exports={mode:{valType:"flaglist",editType:"calc",flags:["number","delta","gauge"],dflt:"number"},value:{valType:"number",editType:"calc",anim:true},align:{valType:"enumerated",values:["left","center","right"],editType:"plot"},domain:l({name:"indicator",trace:true,editType:"calc"}),title:{text:{valType:"string",editType:"plot"},align:{valType:"enumerated",values:["left","center","right"],editType:"plot"},font:a({},p,{}),editType:"plot"},number:{valueformat:{valType:"string",dflt:"",editType:"plot",description:h("value")},font:a({},p,{}),prefix:{valType:"string",dflt:"",editType:"plot"},suffix:{valType:"string",dflt:"",editType:"plot"},editType:"plot"},delta:{reference:{valType:"number",editType:"calc"},position:{valType:"enumerated",values:["top","bottom","left","right"],dflt:"bottom",editType:"plot"},relative:{valType:"boolean",editType:"plot",dflt:false},valueformat:{valType:"string",editType:"plot",description:h("value")},increasing:{symbol:{valType:"string",dflt:f.INCREASING.SYMBOL,editType:"plot"},color:{valType:"color",dflt:f.INCREASING.COLOR,editType:"plot"},editType:"plot"},decreasing:{symbol:{valType:"string",dflt:f.DECREASING.SYMBOL,editType:"plot"},color:{valType:"color",dflt:f.DECREASING.COLOR,editType:"plot"},editType:"plot"},font:a({},p,{}),editType:"calc"},gauge:{shape:{valType:"enumerated",editType:"plot",dflt:"angular",values:["angular","bullet"]},bar:n({},v,{color:{dflt:"green"}}),bgcolor:{valType:"color",editType:"plot"},bordercolor:{valType:"color",dflt:s.defaultLine,editType:"plot"},borderwidth:{valType:"number",min:0,dflt:1,editType:"plot"},axis:i({range:d,visible:a({},u.visible,{dflt:true}),tickmode:u.tickmode,nticks:u.nticks,tick0:u.tick0,dtick:u.dtick,tickvals:u.tickvals,ticktext:u.ticktext,ticks:a({},u.ticks,{dflt:"outside"}),ticklen:u.ticklen,tickwidth:u.tickwidth,tickcolor:u.tickcolor,showticklabels:u.showticklabels,tickfont:o({}),tickangle:u.tickangle,tickformat:u.tickformat,tickformatstops:u.tickformatstops,tickprefix:u.tickprefix,showtickprefix:u.showtickprefix,ticksuffix:u.ticksuffix,showticksuffix:u.showticksuffix,separatethousands:u.separatethousands,exponentformat:u.exponentformat,minexponent:u.minexponent,showexponent:u.showexponent,editType:"plot"},"plot"),steps:m,threshold:{line:{color:a({},v.line.color,{}),width:a({},v.line.width,{dflt:1}),editType:"plot"},thickness:a({},v.thickness,{dflt:.85}),value:{valType:"number",editType:"calc",dflt:false},editType:"plot"},editType:"plot"}}},{"../../components/color/attributes":649,"../../constants/delta.js":757,"../../lib/extend":777,"../../plot_api/edit_types":820,"../../plot_api/plot_template":827,"../../plots/cartesian/axis_format_attributes":841,"../../plots/cartesian/layout_attributes":853,"../../plots/domain":866,"../../plots/font_attributes":867}],1132:[function(e,t,r){"use strict";var a=e("../../plots/plots");r.name="indicator";r.plot=function(e,t,n,i){a.plotBasePlot(r.name,e,t,n,i)};r.clean=function(e,t,n,i){a.cleanBasePlot(r.name,e,t,n,i)}},{"../../plots/plots":901}],1133:[function(e,t,r){"use strict";function a(e,t){var r=[];var a=t.value;if(!(typeof t._lastValue==="number"))t._lastValue=t.value;var n=t._lastValue;var i=n;if(t._hasDelta&&typeof t.delta.reference==="number"){i=t.delta.reference}r[0]={y:a,lastY:n,delta:a-i,relativeDelta:(a-i)/i};return r}t.exports={calc:a}},{}],1134:[function(e,t,r){"use strict";t.exports={defaultNumberFontSize:80,bulletNumberDomainSize:.25,bulletPadding:.025,innerRadius:.75,valueThickness:.5,titlePadding:5,horizontalPadding:10}},{}],1135:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("./attributes");var i=e("../../plots/domain").defaults;var o=e("../../plot_api/plot_template");var s=e("../../plots/array_container_defaults");var l=e("./constants.js");var u=e("../../plots/cartesian/tick_value_defaults");var c=e("../../plots/cartesian/tick_mark_defaults");var f=e("../../plots/cartesian/tick_label_defaults");function h(e,t,r,h){function v(r,i){return a.coerce(e,t,n,r,i)}i(t,h,v);v("mode");t._hasNumber=t.mode.indexOf("number")!==-1;t._hasDelta=t.mode.indexOf("delta")!==-1;t._hasGauge=t.mode.indexOf("gauge")!==-1;var d=v("value");t._range=[0,typeof d==="number"?1.5*d:1];var m=new Array(2);var g;if(t._hasNumber){v("number.valueformat");v("number.font.color",h.font.color);v("number.font.family",h.font.family);v("number.font.size");if(t.number.font.size===undefined){t.number.font.size=l.defaultNumberFontSize;m[0]=true}v("number.prefix");v("number.suffix");g=t.number.font.size}var y;if(t._hasDelta){v("delta.font.color",h.font.color);v("delta.font.family",h.font.family);v("delta.font.size");if(t.delta.font.size===undefined){t.delta.font.size=(t._hasNumber?.5:1)*(g||l.defaultNumberFontSize);m[1]=true}v("delta.reference",t.value);v("delta.relative");v("delta.valueformat",t.delta.relative?"2%":"");v("delta.increasing.symbol");v("delta.increasing.color");v("delta.decreasing.symbol");v("delta.decreasing.color");v("delta.position");y=t.delta.font.size}t._scaleNumbers=(!t._hasNumber||m[0])&&(!t._hasDelta||m[1])||false;v("title.font.color",h.font.color);v("title.font.family",h.font.family);v("title.font.size",.25*(g||y||l.defaultNumberFontSize));v("title.text");var x,b,_,w;function T(e,t){return a.coerce(x,b,n.gauge,e,t)}function k(e,t){return a.coerce(_,w,n.gauge.axis,e,t)}if(t._hasGauge){x=e.gauge;if(!x)x={};b=o.newContainer(t,"gauge");T("shape");var M=t._isBullet=t.gauge.shape==="bullet";if(!M){v("title.align","center")}var A=t._isAngular=t.gauge.shape==="angular";if(!A){v("align","center")}T("bgcolor",h.paper_bgcolor);T("borderwidth");T("bordercolor");T("bar.color");T("bar.line.color");T("bar.line.width");var S=l.valueThickness*(t.gauge.shape==="bullet"?.5:1);T("bar.thickness",S);s(x,b,{name:"steps",handleItemDefaults:p});T("threshold.value");T("threshold.thickness");T("threshold.line.width");T("threshold.line.color");_={};if(x)_=x.axis||{};w=o.newContainer(b,"axis");k("visible");t._range=k("range",t._range);var E={outerTicks:true};u(_,w,k,"linear");f(_,w,k,"linear",E);c(_,w,k,E)}else{v("title.align","center");v("align","center");t._isAngular=t._isBullet=false}t._length=null}function p(e,t){function r(r,i){return a.coerce(e,t,n.gauge.steps,r,i)}r("color");r("line.color");r("line.width");r("range");r("thickness")}t.exports={supplyDefaults:h}},{"../../lib":787,"../../plot_api/plot_template":827,"../../plots/array_container_defaults":833,"../../plots/cartesian/tick_label_defaults":860,"../../plots/cartesian/tick_mark_defaults":861,"../../plots/cartesian/tick_value_defaults":862,"../../plots/domain":866,"./attributes":1131,"./constants.js":1134}],1136:[function(e,t,r){"use strict";t.exports={moduleType:"trace",name:"indicator",basePlotModule:e("./base_plot"),categories:["svg","noOpacity","noHover"],animatable:true,attributes:e("./attributes"),supplyDefaults:e("./defaults").supplyDefaults,calc:e("./calc").calc,plot:e("./plot"),meta:{}}},{"./attributes":1131,"./base_plot":1132,"./calc":1133,"./defaults":1135,"./plot":1137}],1137:[function(e,t,r){"use strict";var a=e("@plotly/d3");var n=e("d3-interpolate").interpolate;var i=e("d3-interpolate").interpolateNumber;var o=e("../../lib");var s=o.strScale;var l=o.strTranslate;var u=o.rad2deg;var c=e("../../constants/alignment").MID_SHIFT;var f=e("../../components/drawing");var h=e("./constants");var p=e("../../lib/svg_text_utils");var v=e("../../plots/cartesian/axes");var d=e("../../plots/cartesian/axis_defaults");var m=e("../../plots/cartesian/position_defaults");var g=e("../../plots/cartesian/layout_attributes");var y=e("../../components/color");var x={left:"start",center:"middle",right:"end"};var b={left:0,center:.5,right:1};var _=/[yzafpnµmkMGTPEZY]/;function w(e){return e&&e.duration>0}t.exports=function e(t,r,n,i){var s=t._fullLayout;var u;if(w(n)){if(i){u=i()}}o.makeTraceGroups(s._indicatorlayer,r,"trace").each((function(e){var r=e[0];var i=r.trace;var o=a.select(this);var c=i._hasGauge;var v=i._isAngular;var d=i._isBullet;var m=i.domain;var g={w:s._size.w*(m.x[1]-m.x[0]),h:s._size.h*(m.y[1]-m.y[0]),l:s._size.l+s._size.w*m.x[0],r:s._size.r+s._size.w*(1-m.x[1]),t:s._size.t+s._size.h*(1-m.y[1]),b:s._size.b+s._size.h*m.y[0]};var y=g.l+g.w/2;var _=g.t+g.h/2;var w=Math.min(g.w/2,g.h);var A=h.innerRadius*w;var S,E,I;var P=i.align||"center";E=_;if(!c){S=g.l+b[P]*g.w;I=function(e){return L(e,g.w,g.h)}}else{if(v){S=y;E=_+w/2;I=function(e){return C(e,.9*A)}}if(d){var O=h.bulletPadding;var z=1-h.bulletNumberDomainSize+O;S=g.l+(z+(1-z)*b[P])*g.w;I=function(e){return L(e,(h.bulletNumberDomainSize-O)*g.w,g.h)}}}M(t,o,e,{numbersX:S,numbersY:E,numbersScaler:I,transitionOpts:n,onComplete:u});var D,R;if(c){D={range:i.gauge.axis.range,color:i.gauge.bgcolor,line:{color:i.gauge.bordercolor,width:0},thickness:1};R={range:i.gauge.axis.range,color:"rgba(0, 0, 0, 0)",line:{color:i.gauge.bordercolor,width:i.gauge.borderwidth},thickness:1}}var F=o.selectAll("g.angular").data(v?e:[]);F.exit().remove();var B=o.selectAll("g.angularaxis").data(v?e:[]);B.exit().remove();if(v){k(t,o,e,{radius:w,innerRadius:A,gauge:F,layer:B,size:g,gaugeBg:D,gaugeOutline:R,transitionOpts:n,onComplete:u})}var N=o.selectAll("g.bullet").data(d?e:[]);N.exit().remove();var j=o.selectAll("g.bulletaxis").data(d?e:[]);j.exit().remove();if(d){T(t,o,e,{gauge:N,layer:j,size:g,gaugeBg:D,gaugeOutline:R,transitionOpts:n,onComplete:u})}var U=o.selectAll("text.title").data(e);U.exit().remove();U.enter().append("text").classed("title",true);U.attr("text-anchor",(function(){return d?x.right:x[i.title.align]})).text(i.title.text).call(f.font,i.title.font).call(p.convertToTspans,t);U.attr("transform",(function(){var e=g.l+g.w*b[i.title.align];var t;var r=h.titlePadding;var a=f.bBox(U.node());if(c){if(v){if(i.gauge.axis.visible){var n=f.bBox(B.node());t=n.top-r-a.bottom}else{t=g.t+g.h/2-w/2-a.bottom-r}}if(d){t=E-(a.top+a.bottom)/2;e=g.l-h.bulletPadding*g.w}}else{t=i._numbersTop-r-a.bottom}return l(e,t)}))}))};function T(e,t,r,a){var n=r[0].trace;var i=a.gauge;var o=a.layer;var s=a.gaugeBg;var u=a.gaugeOutline;var c=a.size;var f=n.domain;var p=a.transitionOpts;var d=a.onComplete;var m,g,x,b,_;i.enter().append("g").classed("bullet",true);i.attr("transform",l(c.l,c.t));o.enter().append("g").classed("bulletaxis",true).classed("crisp",true);o.selectAll("g."+"xbulletaxis"+"tick,path,text").remove();var T=c.h;var k=n.gauge.bar.thickness*T;var M=f.x[0];var S=f.x[0]+(f.x[1]-f.x[0])*(n._hasNumber||n._hasDelta?1-h.bulletNumberDomainSize:1);m=E(e,n.gauge.axis);m._id="xbulletaxis";m.domain=[M,S];m.setScale();g=v.calcTicks(m);x=v.makeTransTickFn(m);b=v.getTickSigns(m)[2];_=c.t+c.h;if(m.visible){v.drawTicks(e,m,{vals:m.ticks==="inside"?v.clipEnds(m,g):g,layer:o,path:v.makeTickPath(m,_,b),transFn:x});v.drawLabels(e,m,{vals:g,layer:o,transFn:x,labelFns:v.makeLabelFns(m,_)})}function L(e){e.attr("width",(function(e){return Math.max(0,m.c2p(e.range[1])-m.c2p(e.range[0]))})).attr("x",(function(e){return m.c2p(e.range[0])})).attr("y",(function(e){return.5*(1-e.thickness)*T})).attr("height",(function(e){return e.thickness*T}))}var C=[s].concat(n.gauge.steps);var I=i.selectAll("g.bg-bullet").data(C);I.enter().append("g").classed("bg-bullet",true).append("rect");I.select("rect").call(L).call(A);I.exit().remove();var P=i.selectAll("g.value-bullet").data([n.gauge.bar]);P.enter().append("g").classed("value-bullet",true).append("rect");P.select("rect").attr("height",k).attr("y",(T-k)/2).call(A);if(w(p)){P.select("rect").transition().duration(p.duration).ease(p.easing).each("end",(function(){d&&d()})).each("interrupt",(function(){d&&d()})).attr("width",Math.max(0,m.c2p(Math.min(n.gauge.axis.range[1],r[0].y))))}else{P.select("rect").attr("width",typeof r[0].y==="number"?Math.max(0,m.c2p(Math.min(n.gauge.axis.range[1],r[0].y))):0)}P.exit().remove();var O=r.filter((function(){return n.gauge.threshold.value||n.gauge.threshold.value===0}));var z=i.selectAll("g.threshold-bullet").data(O);z.enter().append("g").classed("threshold-bullet",true).append("line");z.select("line").attr("x1",m.c2p(n.gauge.threshold.value)).attr("x2",m.c2p(n.gauge.threshold.value)).attr("y1",(1-n.gauge.threshold.thickness)/2*T).attr("y2",(1-(1-n.gauge.threshold.thickness)/2)*T).call(y.stroke,n.gauge.threshold.line.color).style("stroke-width",n.gauge.threshold.line.width);z.exit().remove();var D=i.selectAll("g.gauge-outline").data([u]);D.enter().append("g").classed("gauge-outline",true).append("rect");D.select("rect").call(L).call(A);D.exit().remove()}function k(e,t,r,n){var i=r[0].trace;var o=n.size;var s=n.radius;var f=n.innerRadius;var h=n.gaugeBg;var p=n.gaugeOutline;var d=[o.l+o.w/2,o.t+o.h/2+s/2];var m=n.gauge;var g=n.layer;var y=n.transitionOpts;var x=n.onComplete;var b=Math.PI/2;function _(e){var t=i.gauge.axis.range[0];var r=i.gauge.axis.range[1];var a=(e-t)/(r-t)*Math.PI-b;if(a<-b)return-b;if(a>b)return b;return a}function T(e){return a.svg.arc().innerRadius((f+s)/2-e/2*(s-f)).outerRadius((f+s)/2+e/2*(s-f)).startAngle(-b)}function k(e){e.attr("d",(function(e){return T(e.thickness).startAngle(_(e.range[0])).endAngle(_(e.range[1]))()}))}var M,L,C,I;m.enter().append("g").classed("angular",true);m.attr("transform",l(d[0],d[1]));g.enter().append("g").classed("angularaxis",true).classed("crisp",true);g.selectAll("g."+"xangularaxis"+"tick,path,text").remove();M=E(e,i.gauge.axis);M.type="linear";M.range=i.gauge.axis.range;M._id="xangularaxis";M.ticklabeloverflow="allow";M.setScale();var P=function(e){return(M.range[0]-e.x)/(M.range[1]-M.range[0])*Math.PI+Math.PI};var O={};var z=v.makeLabelFns(M,0);var D=z.labelStandoff;O.xFn=function(e){var t=P(e);return Math.cos(t)*D};O.yFn=function(e){var t=P(e);var r=Math.sin(t)>0?.2:1;return-Math.sin(t)*(D+e.fontSize*r)+Math.abs(Math.cos(t))*(e.fontSize*c)};O.anchorFn=function(e){var t=P(e);var r=Math.cos(t);return Math.abs(r)<.1?"middle":r>0?"start":"end"};O.heightFn=function(e,t,r){var a=P(e);return-.5*(1+Math.sin(a))*r};var R=function(e){return l(d[0]+s*Math.cos(e),d[1]-s*Math.sin(e))};C=function(e){return R(P(e))};var F=function(e){var t=P(e);return R(t)+"rotate("+-u(t)+")"};L=v.calcTicks(M);I=v.getTickSigns(M)[2];if(M.visible){I=M.ticks==="inside"?-1:1;var B=(M.linewidth||1)/2;v.drawTicks(e,M,{vals:L,layer:g,path:"M"+I*B+",0h"+I*M.ticklen,transFn:F});v.drawLabels(e,M,{vals:L,layer:g,transFn:C,labelFns:O})}var N=[h].concat(i.gauge.steps);var j=m.selectAll("g.bg-arc").data(N);j.enter().append("g").classed("bg-arc",true).append("path");j.select("path").call(k).call(A);j.exit().remove();var U=T(i.gauge.bar.thickness);var V=m.selectAll("g.value-arc").data([i.gauge.bar]);V.enter().append("g").classed("value-arc",true).append("path");var H=V.select("path");if(w(y)){H.transition().duration(y.duration).ease(y.easing).each("end",(function(){x&&x()})).each("interrupt",(function(){x&&x()})).attrTween("d",S(U,_(r[0].lastY),_(r[0].y)));i._lastValue=r[0].y}else{H.attr("d",typeof r[0].y==="number"?U.endAngle(_(r[0].y)):"M0,0Z")}H.call(A);V.exit().remove();N=[];var q=i.gauge.threshold.value;if(q||q===0){N.push({range:[q,q],color:i.gauge.threshold.color,line:{color:i.gauge.threshold.line.color,width:i.gauge.threshold.line.width},thickness:i.gauge.threshold.thickness})}var G=m.selectAll("g.threshold-arc").data(N);G.enter().append("g").classed("threshold-arc",true).append("path");G.select("path").call(k).call(A);G.exit().remove();var Y=m.selectAll("g.gauge-outline").data([p]);Y.enter().append("g").classed("gauge-outline",true).append("path");Y.select("path").call(k).call(A);Y.exit().remove()}function M(e,t,r,n){var u=r[0].trace;var c=n.numbersX;var h=n.numbersY;var d=u.align||"center";var m=x[d];var g=n.transitionOpts;var T=n.onComplete;var k=o.ensureSingle(t,"g","numbers");var M,A;var S;var L=[];if(u._hasNumber)L.push("number");if(u._hasDelta){L.push("delta");if(u.delta.position==="left")L.reverse()}var C=k.selectAll("text").data(L);C.enter().append("text");C.attr("text-anchor",(function(){return m})).attr("class",(function(e){return e})).attr("x",null).attr("y",null).attr("dx",null).attr("dy",null);C.exit().remove();function O(t,r,a,n){if(t.match("s")&&a>=0!==n>=0&&(!r(a).slice(-1).match(_)&&!r(n).slice(-1).match(_))){var i=t.slice().replace("s","f").replace(/\d+/,(function(e){return parseInt(e)-1}));var o=E(e,{tickformat:i});return function(e){if(Math.abs(e)<1)return v.tickText(o,e).text;return r(e)}}else{return r}}function z(){var t=E(e,{tickformat:u.number.valueformat},u._range);t.setScale();v.prepTicks(t);var n=function(e){return v.tickText(t,e).text};var o=u.number.suffix;var s=u.number.prefix;var l=k.select("text.number");function c(){var t=typeof r[0].y==="number"?s+n(r[0].y)+o:"-";l.text(t).call(f.font,u.number.font).call(p.convertToTspans,e)}if(w(g)){l.transition().duration(g.duration).ease(g.easing).each("end",(function(){c();T&&T()})).each("interrupt",(function(){c();T&&T()})).attrTween("text",(function(){var e=a.select(this);var t=i(r[0].lastY,r[0].y);u._lastValue=r[0].y;var l=O(u.number.valueformat,n,r[0].lastY,r[0].y);return function(r){e.text(s+l(t(r))+o)}}))}else{c()}M=I(s+n(r[0].y)+o,u.number.font,m,e);return l}function D(){var t=E(e,{tickformat:u.delta.valueformat},u._range);t.setScale();v.prepTicks(t);var n=function(e){return v.tickText(t,e).text};var o=function(e){var t=u.delta.relative?e.relativeDelta:e.delta;return t};var s=function(e,t){if(e===0||typeof e!=="number"||isNaN(e))return"-";return(e>0?u.delta.increasing.symbol:u.delta.decreasing.symbol)+t(e)};var l=function(e){return e.delta>=0?u.delta.increasing.color:u.delta.decreasing.color};if(u._deltaLastValue===undefined){u._deltaLastValue=o(r[0])}var c=k.select("text.delta");c.call(f.font,u.delta.font).call(y.fill,l({delta:u._deltaLastValue}));function h(){c.text(s(o(r[0]),n)).call(y.fill,l(r[0])).call(p.convertToTspans,e)}if(w(g)){c.transition().duration(g.duration).ease(g.easing).tween("text",(function(){var e=a.select(this);var t=o(r[0]);var c=u._deltaLastValue;var f=O(u.delta.valueformat,n,c,t);var h=i(c,t);u._deltaLastValue=t;return function(t){e.text(s(h(t),f));e.call(y.fill,l({delta:h(t)}))}})).each("end",(function(){h();T&&T()})).each("interrupt",(function(){h();T&&T()}))}else{h()}A=I(s(o(r[0]),n),u.delta.font,m,e);return c}var R=u.mode+u.align;var F;if(u._hasDelta){F=D();R+=u.delta.position+u.delta.font.size+u.delta.font.family+u.delta.valueformat;R+=u.delta.increasing.symbol+u.delta.decreasing.symbol;S=A}if(u._hasNumber){z();R+=u.number.font.size+u.number.font.family+u.number.valueformat+u.number.suffix+u.number.prefix;S=M}if(u._hasDelta&&u._hasNumber){var B=[(M.left+M.right)/2,(M.top+M.bottom)/2];var N=[(A.left+A.right)/2,(A.top+A.bottom)/2];var j,U;var V=.75*u.delta.font.size;if(u.delta.position==="left"){j=P(u,"deltaPos",0,-1*(M.width*b[u.align]+A.width*(1-b[u.align])+V),R,Math.min);U=B[1]-N[1];S={width:M.width+A.width+V,height:Math.max(M.height,A.height),left:A.left+j,right:M.right,top:Math.min(M.top,A.top+U),bottom:Math.max(M.bottom,A.bottom+U)}}if(u.delta.position==="right"){j=P(u,"deltaPos",0,M.width*(1-b[u.align])+A.width*b[u.align]+V,R,Math.max);U=B[1]-N[1];S={width:M.width+A.width+V,height:Math.max(M.height,A.height),left:M.left,right:A.right+j,top:Math.min(M.top,A.top+U),bottom:Math.max(M.bottom,A.bottom+U)}}if(u.delta.position==="bottom"){j=null;U=A.height;S={width:Math.max(M.width,A.width),height:M.height+A.height,left:Math.min(M.left,A.left),right:Math.max(M.right,A.right),top:M.bottom-M.height,bottom:M.bottom+A.height}}if(u.delta.position==="top"){j=null;U=M.top;S={width:Math.max(M.width,A.width),height:M.height+A.height,left:Math.min(M.left,A.left),right:Math.max(M.right,A.right),top:M.bottom-M.height-A.height,bottom:M.bottom}}F.attr({dx:j,dy:U})}if(u._hasNumber||u._hasDelta){k.attr("transform",(function(){var e=n.numbersScaler(S);R+=e[2];var t=P(u,"numbersScale",1,e[0],R,Math.min);var r;if(!u._scaleNumbers)t=1;if(u._isAngular){r=h-t*S.bottom}else{r=h-t*(S.top+S.bottom)/2}u._numbersTop=t*S.top+r;var a=S[d];if(d==="center")a=(S.left+S.right)/2;var i=c-t*a;i=P(u,"numbersTranslate",0,i,R,Math.max);return l(i,r)+s(t)}))}}function A(e){e.each((function(e){y.stroke(a.select(this),e.line.color)})).each((function(e){y.fill(a.select(this),e.color)})).style("stroke-width",(function(e){return e.line.width}))}function S(e,t,r){return function(){var a=n(t,r);return function(t){return e.endAngle(a(t))()}}}function E(e,t,r){var a=e._fullLayout;var n=o.extendFlat({type:"linear",ticks:"outside",range:r,showline:true},t);var i={type:"linear",_id:"x"+t._id};var s={letter:"x",font:a.font,noHover:true,noTickson:true};function l(e,t){return o.coerce(n,i,g,e,t)}d(n,i,l,s,a);m(n,i,l,s);return i}function L(e,t,r){var a=Math.min(t/e.width,r/e.height);return[a,e,t+"x"+r]}function C(e,t){var r=Math.sqrt(e.width/2*(e.width/2)+e.height*e.height);var a=t/r;return[a,e,t]}function I(e,t,r,n){var i=document.createElementNS("http://www.w3.org/2000/svg","text");var o=a.select(i);o.text(e).attr("x",0).attr("y",0).attr("text-anchor",r).attr("data-unformatted",e).call(p.convertToTspans,n).call(f.font,t);return f.bBox(o.node())}function P(e,t,r,a,n,i){var s="_cache"+t;if(!(e[s]&&e[s].key===n)){e[s]={key:n,value:r}}var l=o.aggNums(i,null,[e[s].value,a],2);e[s].value=l;return l}},{"../../components/color":650,"../../components/drawing":672,"../../constants/alignment":755,"../../lib":787,"../../lib/svg_text_utils":813,"../../plots/cartesian/axes":838,"../../plots/cartesian/axis_defaults":840,"../../plots/cartesian/layout_attributes":853,"../../plots/cartesian/position_defaults":856,"./constants":1134,"@plotly/d3":58,"d3-interpolate":168}],1138:[function(e,t,r){"use strict";var a=e("../../components/colorscale/attributes");var n=e("../../plots/cartesian/axis_format_attributes").axisHoverFormat;var i=e("../../plots/template_attributes").hovertemplateAttrs;var o=e("../mesh3d/attributes");var s=e("../../plots/attributes");var l=e("../../lib/extend").extendFlat;var u=e("../../plot_api/edit_types").overrideAll;function c(e){return{show:{valType:"boolean",dflt:false},locations:{valType:"data_array",dflt:[]},fill:{valType:"number",min:0,max:1,dflt:1}}}function f(e){return{show:{valType:"boolean",dflt:true},fill:{valType:"number",min:0,max:1,dflt:1}}}var h=t.exports=u(l({x:{valType:"data_array"},y:{valType:"data_array"},z:{valType:"data_array"},value:{valType:"data_array"},isomin:{valType:"number"},isomax:{valType:"number"},surface:{show:{valType:"boolean",dflt:true},count:{valType:"integer",dflt:2,min:1},fill:{valType:"number",min:0,max:1,dflt:1},pattern:{valType:"flaglist",flags:["A","B","C","D","E"],extras:["all","odd","even"],dflt:"all"}},spaceframe:{show:{valType:"boolean",dflt:false},fill:{valType:"number",min:0,max:1,dflt:.15}},slices:{x:c("x"),y:c("y"),z:c("z")},caps:{x:f("x"),y:f("y"),z:f("z")},text:{valType:"string",dflt:"",arrayOk:true},hovertext:{valType:"string",dflt:"",arrayOk:true},hovertemplate:i(),xhoverformat:n("x"),yhoverformat:n("y"),zhoverformat:n("z"),valuehoverformat:n("value",1),showlegend:l({},s.showlegend,{dflt:false})},a("",{colorAttr:"`value`",showScaleDflt:true,editTypeOverride:"calc"}),{opacity:o.opacity,lightposition:o.lightposition,lighting:o.lighting,flatshading:o.flatshading,contour:o.contour,hoverinfo:l({},s.hoverinfo)}),"calc","nested");h.flatshading.dflt=true;h.lighting.facenormalsepsilon.dflt=0;h.x.editType=h.y.editType=h.z.editType=h.value.editType="calc+clearAxisTypes";h.transforms=undefined},{"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../plot_api/edit_types":820,"../../plots/attributes":834,"../../plots/cartesian/axis_format_attributes":841,"../../plots/template_attributes":910,"../mesh3d/attributes":1143}],1139:[function(e,t,r){"use strict";var a=e("../../components/colorscale/calc");var n=e("../streamtube/calc").processGrid;var i=e("../streamtube/calc").filter;t.exports=function e(t,r){r._len=Math.min(r.x.length,r.y.length,r.z.length,r.value.length);r._x=i(r.x,r._len);r._y=i(r.y,r._len);r._z=i(r.z,r._len);r._value=i(r.value,r._len);var o=n(r);r._gridFill=o.fill;r._Xs=o.Xs;r._Ys=o.Ys;r._Zs=o.Zs;r._len=o.len;var s=Infinity;var l=-Infinity;for(var u=0;u<r._len;u++){var c=r._value[u];s=Math.min(s,c);l=Math.max(l,c)}r._minValues=s;r._maxValues=l;r._vMin=r.isomin===undefined||r.isomin===null?s:r.isomin;r._vMax=r.isomax===undefined||r.isomin===null?l:r.isomax;a(t,r,{vals:[r._vMin,r._vMax],containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":658,"../streamtube/calc":1310}],1140:[function(e,t,r){"use strict";var a=e("gl-mesh3d");var n=e("../../lib/gl_format_color").parseColorScale;var i=e("../../lib/str2rgbarray");var o=e("../../components/colorscale").extractOpts;var s=e("../../plots/gl3d/zip3");var l=function(e,t){for(var r=t.length-1;r>0;r--){var a=Math.min(t[r],t[r-1]);var n=Math.max(t[r],t[r-1]);if(n>a&&a<e&&e<=n){return{id:r,distRatio:(n-e)/(n-a)}}}return{id:0,distRatio:0}};function u(e,t,r){this.scene=e;this.uid=r;this.mesh=t;this.name="";this.data=null;this.showContour=false}var c=u.prototype;c.handlePick=function(e){if(e.object===this.mesh){var t=e.data.index;var r=this.data._meshX[t];var a=this.data._meshY[t];var n=this.data._meshZ[t];var i=this.data._Ys.length;var o=this.data._Zs.length;var s=l(r,this.data._Xs).id;var u=l(a,this.data._Ys).id;var c=l(n,this.data._Zs).id;var f=e.index=c+o*u+o*i*s;e.traceCoordinate=[this.data._meshX[f],this.data._meshY[f],this.data._meshZ[f],this.data._value[f]];var h=this.data.hovertext||this.data.text;if(Array.isArray(h)&&h[f]!==undefined){e.textLabel=h[f]}else if(h){e.textLabel=h}return true}};c.update=function(e){var t=this.scene;var r=t.fullSceneLayout;this.data=h(e);function a(e,t,r,a){return t.map((function(t){return e.d2l(t,0,a)*r}))}var l=s(a(r.xaxis,e._meshX,t.dataScale[0],e.xcalendar),a(r.yaxis,e._meshY,t.dataScale[1],e.ycalendar),a(r.zaxis,e._meshZ,t.dataScale[2],e.zcalendar));var u=s(e._meshI,e._meshJ,e._meshK);var c={positions:l,cells:u,lightPosition:[e.lightposition.x,e.lightposition.y,e.lightposition.z],ambient:e.lighting.ambient,diffuse:e.lighting.diffuse,specular:e.lighting.specular,roughness:e.lighting.roughness,fresnel:e.lighting.fresnel,vertexNormalsEpsilon:e.lighting.vertexnormalsepsilon,faceNormalsEpsilon:e.lighting.facenormalsepsilon,opacity:e.opacity,contourEnable:e.contour.show,contourColor:i(e.contour.color).slice(0,3),contourWidth:e.contour.width,useFacetNormals:e.flatshading};var f=o(e);c.vertexIntensity=e._meshIntensity;c.vertexIntensityBounds=[f.min,f.max];c.colormap=n(e);this.mesh.update(c)};c.dispose=function(){this.scene.glplot.remove(this.mesh);this.mesh.dispose()};var f=["xyz","xzy","yxz","yzx","zxy","zyx"];function h(e){e._meshI=[];e._meshJ=[];e._meshK=[];var t=e.surface.show;var r=e.spaceframe.show;var a=e.surface.fill;var n=e.spaceframe.fill;var i=false;var o=false;var s=0;var u;var c;var h=e._Xs;var p=e._Ys;var v=e._Zs;var d=h.length;var m=p.length;var g=v.length;var y=f.indexOf(e._gridFill.replace(/-/g,"").replace(/\+/g,""));var x=function(e,t,r){switch(y){case 5:return r+g*t+g*m*e;case 4:return r+g*e+g*d*t;case 3:return t+m*r+m*g*e;case 2:return t+m*e+m*d*r;case 1:return e+d*r+d*g*t;default:return e+d*t+d*m*r}};var b=e._minValues;var _=e._maxValues;var w=e._vMin;var T=e._vMax;var k;var M;var A;var S;function E(e,t,r){var a=S.length;for(var n=c;n<a;n++){if(e===k[n]&&t===M[n]&&r===A[n]){return n}}return-1}function L(){c=u}function C(){k=[];M=[];A=[];S=[];u=0;L()}function I(e,t,r,a){k.push(e);M.push(t);A.push(r);S.push(a);u++;return u-1}function P(t,r,a){e._meshI.push(t);e._meshJ.push(r);e._meshK.push(a);s++;return s-1}function O(e,t,r){var a=[];for(var n=0;n<e.length;n++){a[n]=(e[n]+t[n]+r[n])/3}return a}function z(e,t,r){var a=[];for(var n=0;n<e.length;n++){a[n]=e[n]*(1-r)+r*t[n]}return a}var D;function R(e){D=e}function F(e,t){var r=e[0];var a=e[1];var n=e[2];var i=O(r,a,n);var o=Math.sqrt(1-D);var s=z(i,r,o);var l=z(i,a,o);var u=z(i,n,o);var c=t[0];var f=t[1];var h=t[2];return{xyzv:[[r,a,l],[l,s,r],[a,n,u],[u,l,a],[n,r,s],[s,u,n]],abc:[[c,f,-1],[-1,-1,c],[f,h,-1],[-1,-1,f],[h,c,-1],[-1,-1,h]]}}function B(e,t){if(e==="all"||e===null)return true;return e.indexOf(t)>-1}function N(e,t){if(e===null)return t;return e}function j(e,t,r){L();var a=[t];var n=[r];if(D>=1){a=[t];n=[r]}else if(D>0){var i=F(t,r);a=i.xyzv;n=i.abc}for(var o=0;o<a.length;o++){t=a[o];r=n[o];var s=[];for(var l=0;l<3;l++){var u=t[l][0];var c=t[l][1];var f=t[l][2];var h=t[l][3];var p=r[l]>-1?r[l]:E(u,c,f);if(p>-1){s[l]=p}else{s[l]=I(u,c,f,N(e,h))}}P(s[0],s[1],s[2])}}function U(e,t,r){var a=function(a,n,i){j(e,[t[a],t[n],t[i]],[r[a],r[n],r[i]])};a(0,1,2);a(2,3,0)}function V(e,t,r){var a=function(a,n,i){j(e,[t[a],t[n],t[i]],[r[a],r[n],r[i]])};a(0,1,2);a(3,0,1);a(2,3,0);a(1,2,3)}function H(e,t,r,a){var n=e[3];if(n<r)n=r;if(n>a)n=a;var i=(e[3]-n)/(e[3]-t[3]+1e-9);var o=[];for(var s=0;s<4;s++){o[s]=(1-i)*e[s]+i*t[s]}return o}function q(e,t,r){return e>=t&&e<=r}function G(e){var t=.001*(T-w);return e>=w-t&&e<=T+t}function Y(t){var r=[];for(var a=0;a<4;a++){var n=t[a];r.push([e._x[n],e._y[n],e._z[n],e._value[n]])}return r}var W=3;function X(e,t,r,a,n,i){if(!i)i=1;r=[-1,-1,-1];var o=false;var s=[q(t[0][3],a,n),q(t[1][3],a,n),q(t[2][3],a,n)];if(!s[0]&&!s[1]&&!s[2]){return false}var l=function(e,t,r){if(G(t[0][3])&&G(t[1][3])&&G(t[2][3])){j(e,t,r);return true}else if(i<W){return X(e,t,r,w,T,++i)}return false};if(s[0]&&s[1]&&s[2]){return l(e,t,r)||o}var u=false;[[0,1,2],[2,0,1],[1,2,0]].forEach((function(i){if(s[i[0]]&&s[i[1]]&&!s[i[2]]){var c=t[i[0]];var f=t[i[1]];var h=t[i[2]];var p=H(h,c,a,n);var v=H(h,f,a,n);o=l(e,[v,p,c],[-1,-1,r[i[0]]])||o;o=l(e,[c,f,v],[r[i[0]],r[i[1]],-1])||o;u=true}}));if(u)return o;[[0,1,2],[1,2,0],[2,0,1]].forEach((function(i){if(s[i[0]]&&!s[i[1]]&&!s[i[2]]){var c=t[i[0]];var f=t[i[1]];var h=t[i[2]];var p=H(f,c,a,n);var v=H(h,c,a,n);o=l(e,[v,p,c],[-1,-1,r[i[0]]])||o;u=true}}));return o}function Z(e,t,r,a){var n=false;var i=Y(t);var s=[q(i[0][3],r,a),q(i[1][3],r,a),q(i[2][3],r,a),q(i[3][3],r,a)];if(!s[0]&&!s[1]&&!s[2]&&!s[3]){return n}if(s[0]&&s[1]&&s[2]&&s[3]){if(o){n=V(e,i,t)||n}return n}var l=false;[[0,1,2,3],[3,0,1,2],[2,3,0,1],[1,2,3,0]].forEach((function(u){if(s[u[0]]&&s[u[1]]&&s[u[2]]&&!s[u[3]]){var c=i[u[0]];var f=i[u[1]];var h=i[u[2]];var p=i[u[3]];if(o){n=j(e,[c,f,h],[t[u[0]],t[u[1]],t[u[2]]])||n}else{var v=H(p,c,r,a);var d=H(p,f,r,a);var m=H(p,h,r,a);n=j(null,[v,d,m],[-1,-1,-1])||n}l=true}}));if(l)return n;[[0,1,2,3],[1,2,3,0],[2,3,0,1],[3,0,1,2],[0,2,3,1],[1,3,2,0]].forEach((function(u){if(s[u[0]]&&s[u[1]]&&!s[u[2]]&&!s[u[3]]){var c=i[u[0]];var f=i[u[1]];var h=i[u[2]];var p=i[u[3]];var v=H(h,c,r,a);var d=H(h,f,r,a);var m=H(p,f,r,a);var g=H(p,c,r,a);if(o){n=j(e,[c,g,v],[t[u[0]],-1,-1])||n;n=j(e,[f,d,m],[t[u[1]],-1,-1])||n}else{n=U(null,[v,d,m,g],[-1,-1,-1,-1])||n}l=true}}));if(l)return n;[[0,1,2,3],[1,2,3,0],[2,3,0,1],[3,0,1,2]].forEach((function(u){if(s[u[0]]&&!s[u[1]]&&!s[u[2]]&&!s[u[3]]){var c=i[u[0]];var f=i[u[1]];var h=i[u[2]];var p=i[u[3]];var v=H(f,c,r,a);var d=H(h,c,r,a);var m=H(p,c,r,a);if(o){n=j(e,[c,v,d],[t[u[0]],-1,-1])||n;n=j(e,[c,d,m],[t[u[0]],-1,-1])||n;n=j(e,[c,m,v],[t[u[0]],-1,-1])||n}else{n=j(null,[v,d,m],[-1,-1,-1])||n}l=true}}));return n}function J(e,t,r,a,n,s,l,u,c,f,h){var p=false;if(i){if(B(e,"A")){p=Z(null,[t,r,a,s],f,h)||p}if(B(e,"B")){p=Z(null,[r,a,n,c],f,h)||p}if(B(e,"C")){p=Z(null,[r,s,l,c],f,h)||p}if(B(e,"D")){p=Z(null,[a,s,u,c],f,h)||p}if(B(e,"E")){p=Z(null,[r,a,s,c],f,h)||p}}if(o){p=Z(e,[r,a,s,c],f,h)||p}return p}function K(e,t,r,a,n,i,o,s){return[s[0]===true?true:X(e,Y([t,r,a]),[t,r,a],i,o),s[1]===true?true:X(e,Y([a,n,t]),[a,n,t],i,o)]}function Q(e,t,r,a,n,i,o,s,l){if(s){return K(e,t,r,n,a,i,o,l)}else{return K(e,r,n,a,t,i,o,l)}}function $(e,t,r,a,n,i,o){var s=false;var l,u,c,f;var h=function(){s=X(e,[l,u,c],[-1,-1,-1],n,i)||s;s=X(e,[c,f,l],[-1,-1,-1],n,i)||s};var p=o[0];var v=o[1];var d=o[2];if(p){l=z(Y([x(t,r-0,a-0)])[0],Y([x(t-1,r-0,a-0)])[0],p);u=z(Y([x(t,r-0,a-1)])[0],Y([x(t-1,r-0,a-1)])[0],p);c=z(Y([x(t,r-1,a-1)])[0],Y([x(t-1,r-1,a-1)])[0],p);f=z(Y([x(t,r-1,a-0)])[0],Y([x(t-1,r-1,a-0)])[0],p);h()}if(v){l=z(Y([x(t-0,r,a-0)])[0],Y([x(t-0,r-1,a-0)])[0],v);u=z(Y([x(t-0,r,a-1)])[0],Y([x(t-0,r-1,a-1)])[0],v);c=z(Y([x(t-1,r,a-1)])[0],Y([x(t-1,r-1,a-1)])[0],v);f=z(Y([x(t-1,r,a-0)])[0],Y([x(t-1,r-1,a-0)])[0],v);h()}if(d){l=z(Y([x(t-0,r-0,a)])[0],Y([x(t-0,r-0,a-1)])[0],d);u=z(Y([x(t-0,r-1,a)])[0],Y([x(t-0,r-1,a-1)])[0],d);c=z(Y([x(t-1,r-1,a)])[0],Y([x(t-1,r-1,a-1)])[0],d);f=z(Y([x(t-1,r-0,a)])[0],Y([x(t-1,r-0,a-1)])[0],d);h()}return s}function ee(e,t,r,a,n,o,s,l,u,c,f,h){var p=e;if(h){if(i&&e==="even")p=null;return J(p,t,r,a,n,o,s,l,u,c,f)}else{if(i&&e==="odd")p=null;return J(p,u,l,s,o,n,a,r,t,c,f)}}function te(e,t,r,a,n){var i=[];var o=0;for(var s=0;s<t.length;s++){var l=t[s];for(var u=1;u<g;u++){for(var c=1;c<m;c++){i.push(Q(e,x(l,c-1,u-1),x(l,c-1,u),x(l,c,u-1),x(l,c,u),r,a,(l+c+u)%2,n&&n[o]?n[o]:[]));o++}}}return i}function re(e,t,r,a,n){var i=[];var o=0;for(var s=0;s<t.length;s++){var l=t[s];for(var u=1;u<d;u++){for(var c=1;c<g;c++){i.push(Q(e,x(u-1,l,c-1),x(u,l,c-1),x(u-1,l,c),x(u,l,c),r,a,(u+l+c)%2,n&&n[o]?n[o]:[]));o++}}}return i}function ae(e,t,r,a,n){var i=[];var o=0;for(var s=0;s<t.length;s++){var l=t[s];for(var u=1;u<m;u++){for(var c=1;c<d;c++){i.push(Q(e,x(c-1,u-1,l),x(c-1,u,l),x(c,u-1,l),x(c,u,l),r,a,(c+u+l)%2,n&&n[o]?n[o]:[]));o++}}}return i}function ne(e,t,r){for(var a=1;a<g;a++){for(var n=1;n<m;n++){for(var i=1;i<d;i++){ee(e,x(i-1,n-1,a-1),x(i-1,n-1,a),x(i-1,n,a-1),x(i-1,n,a),x(i,n-1,a-1),x(i,n-1,a),x(i,n,a-1),x(i,n,a),t,r,(i+n+a)%2)}}}}function ie(e,t,r){o=true;ne(e,t,r);o=false}function oe(e,t,r){i=true;ne(e,t,r);i=false}function se(e,t,r,a,n,i){var o=[];var s=0;for(var l=0;l<t.length;l++){var u=t[l];for(var c=1;c<g;c++){for(var f=1;f<m;f++){o.push($(e,u,f,c,r,a,n[l],i&&i[s]?i[s]:[]));s++}}}return o}function le(e,t,r,a,n,i){var o=[];var s=0;for(var l=0;l<t.length;l++){var u=t[l];for(var c=1;c<d;c++){for(var f=1;f<g;f++){o.push($(e,c,u,f,r,a,n[l],i&&i[s]?i[s]:[]));s++}}}return o}function ue(e,t,r,a,n,i){var o=[];var s=0;for(var l=0;l<t.length;l++){var u=t[l];for(var c=1;c<m;c++){for(var f=1;f<d;f++){o.push($(e,f,c,u,r,a,n[l],i&&i[s]?i[s]:[]));s++}}}return o}function ce(e,t){var r=[];for(var a=e;a<t;a++){r.push(a)}return r}function fe(){for(var t=0;t<d;t++){for(var r=0;r<m;r++){for(var a=0;a<g;a++){var n=x(t,r,a);I(e._x[n],e._y[n],e._z[n],e._value[n])}}}}function he(){C();fe();var i=null;if(r&&n){R(n);ie(i,w,T)}if(t&&a){R(a);var o=e.surface.pattern;var u=e.surface.count;for(var c=0;c<u;c++){var f=u===1?.5:c/(u-1);var y=(1-f)*w+f*T;var x=Math.abs(y-b);var E=Math.abs(y-_);var L=x>E?[b,y]:[y,_];oe(o,L[0],L[1])}}var I=[[Math.min(w,_),Math.max(w,_)],[Math.min(b,T),Math.max(b,T)]];["x","y","z"].forEach((function(t){var r=[];for(var a=0;a<I.length;a++){var n=0;var o=I[a][0];var s=I[a][1];var u=e.slices[t];if(u.show&&u.fill){R(u.fill);var c=[];var f=[];var y=[];if(u.locations.length){for(var x=0;x<u.locations.length;x++){var b=l(u.locations[x],t==="x"?h:t==="y"?p:v);if(b.distRatio===0){c.push(b.id)}else if(b.id>0){f.push(b.id);if(t==="x"){y.push([b.distRatio,0,0])}else if(t==="y"){y.push([0,b.distRatio,0])}else{y.push([0,0,b.distRatio])}}}}else{if(t==="x"){c=ce(1,d-1)}else if(t==="y"){c=ce(1,m-1)}else{c=ce(1,g-1)}}if(f.length>0){if(t==="x"){r[n]=se(i,f,o,s,y,r[n])}else if(t==="y"){r[n]=le(i,f,o,s,y,r[n])}else{r[n]=ue(i,f,o,s,y,r[n])}n++}if(c.length>0){if(t==="x"){r[n]=te(i,c,o,s,r[n])}else if(t==="y"){r[n]=re(i,c,o,s,r[n])}else{r[n]=ae(i,c,o,s,r[n])}n++}}var _=e.caps[t];if(_.show&&_.fill){R(_.fill);if(t==="x"){r[n]=te(i,[0,d-1],o,s,r[n])}else if(t==="y"){r[n]=re(i,[0,m-1],o,s,r[n])}else{r[n]=ae(i,[0,g-1],o,s,r[n])}n++}}}));if(s===0){C()}e._meshX=k;e._meshY=M;e._meshZ=A;e._meshIntensity=S;e._Xs=h;e._Ys=p;e._Zs=v}he();return e}function p(e,t){var r=e.glplot.gl;var n=a({gl:r});var i=new u(e,n,t.uid);n._trace=i;i.update(t);e.glplot.add(n);return i}t.exports={findNearestOnAxis:l,generateIsoMeshes:h,createIsosurfaceTrace:p}},{"../../components/colorscale":662,"../../lib/gl_format_color":783,"../../lib/str2rgbarray":812,"../../plots/gl3d/zip3":891,"gl-mesh3d":309}],1141:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("../../registry");var i=e("./attributes");var o=e("../../components/colorscale/defaults");function s(e,t,r,n){function o(r,n){return a.coerce(e,t,i,r,n)}l(e,t,r,n,o)}function l(e,t,r,a,i){var s=i("isomin");var l=i("isomax");if(l!==undefined&&l!==null&&s!==undefined&&s!==null&&s>l){t.isomin=null;t.isomax=null}var u=i("x");var c=i("y");var f=i("z");var h=i("value");if(!u||!u.length||!c||!c.length||!f||!f.length||!h||!h.length){t.visible=false;return}var p=n.getComponentMethod("calendars","handleTraceDefaults");p(e,t,["x","y","z"],a);i("valuehoverformat");["x","y","z"].forEach((function(e){i(e+"hoverformat");var t="caps."+e;var r=i(t+".show");if(r){i(t+".fill")}var a="slices."+e;var n=i(a+".show");if(n){i(a+".fill");i(a+".locations")}}));var v=i("spaceframe.show");if(v){i("spaceframe.fill")}var d=i("surface.show");if(d){i("surface.count");i("surface.fill");i("surface.pattern")}var m=i("contour.show");if(m){i("contour.color");i("contour.width")}["text","hovertext","hovertemplate","lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lighting.vertexnormalsepsilon","lighting.facenormalsepsilon","lightposition.x","lightposition.y","lightposition.z","flatshading","opacity"].forEach((function(e){i(e)}));o(e,t,a,i,{prefix:"",cLetter:"c"});t._length=null}t.exports={supplyDefaults:s,supplyIsoDefaults:l}},{"../../components/colorscale/defaults":660,"../../lib":787,"../../registry":915,"./attributes":1138}],1142:[function(e,t,r){"use strict";t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults").supplyDefaults,calc:e("./calc"),colorbar:{min:"cmin",max:"cmax"},plot:e("./convert").createIsosurfaceTrace,moduleType:"trace",name:"isosurface",basePlotModule:e("../../plots/gl3d"),categories:["gl3d","showLegend"],meta:{}}},{"../../plots/gl3d":880,"./attributes":1138,"./calc":1139,"./convert":1140,"./defaults":1141}],1143:[function(e,t,r){"use strict";var a=e("../../components/colorscale/attributes");var n=e("../../plots/cartesian/axis_format_attributes").axisHoverFormat;var i=e("../../plots/template_attributes").hovertemplateAttrs;var o=e("../surface/attributes");var s=e("../../plots/attributes");var l=e("../../lib/extend").extendFlat;t.exports=l({x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},i:{valType:"data_array",editType:"calc"},j:{valType:"data_array",editType:"calc"},k:{valType:"data_array",editType:"calc"},text:{valType:"string",dflt:"",arrayOk:true,editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:true,editType:"calc"},hovertemplate:i({editType:"calc"}),xhoverformat:n("x"),yhoverformat:n("y"),zhoverformat:n("z"),delaunayaxis:{valType:"enumerated",values:["x","y","z"],dflt:"z",editType:"calc"},alphahull:{valType:"number",dflt:-1,editType:"calc"},intensity:{valType:"data_array",editType:"calc"},intensitymode:{valType:"enumerated",values:["vertex","cell"],dflt:"vertex",editType:"calc"},color:{valType:"color",editType:"calc"},vertexcolor:{valType:"data_array",editType:"calc"},facecolor:{valType:"data_array",editType:"calc"},transforms:undefined},a("",{colorAttr:"`intensity`",showScaleDflt:true,editTypeOverride:"calc"}),{opacity:o.opacity,flatshading:{valType:"boolean",dflt:false,editType:"calc"},contour:{show:l({},o.contours.x.show,{}),color:o.contours.x.color,width:o.contours.x.width,editType:"calc"},lightposition:{x:l({},o.lightposition.x,{dflt:1e5}),y:l({},o.lightposition.y,{dflt:1e5}),z:l({},o.lightposition.z,{dflt:0}),editType:"calc"},lighting:l({vertexnormalsepsilon:{valType:"number",min:0,max:1,dflt:1e-12,editType:"calc"},facenormalsepsilon:{valType:"number",min:0,max:1,dflt:1e-6,editType:"calc"},editType:"calc"},o.lighting),hoverinfo:l({},s.hoverinfo,{editType:"calc"}),showlegend:l({},s.showlegend,{dflt:false})})},{"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../plots/attributes":834,"../../plots/cartesian/axis_format_attributes":841,"../../plots/template_attributes":910,"../surface/attributes":1326}],1144:[function(e,t,r){"use strict";var a=e("../../components/colorscale/calc");t.exports=function e(t,r){if(r.intensity){a(t,r,{vals:r.intensity,containerStr:"",cLetter:"c"})}}},{"../../components/colorscale/calc":658}],1145:[function(e,t,r){"use strict";var a=e("gl-mesh3d");var n=e("delaunay-triangulate");var i=e("alpha-shape");var o=e("convex-hull");var s=e("../../lib/gl_format_color").parseColorScale;var l=e("../../lib/str2rgbarray");var u=e("../../components/colorscale").extractOpts;var c=e("../../plots/gl3d/zip3");function f(e,t,r){this.scene=e;this.uid=r;this.mesh=t;this.name="";this.color="#fff";this.data=null;this.showContour=false}var h=f.prototype;h.handlePick=function(e){if(e.object===this.mesh){var t=e.index=e.data.index;if(e.data._cellCenter){e.traceCoordinate=e.data.dataCoordinate}else{e.traceCoordinate=[this.data.x[t],this.data.y[t],this.data.z[t]]}var r=this.data.hovertext||this.data.text;if(Array.isArray(r)&&r[t]!==undefined){e.textLabel=r[t]}else if(r){e.textLabel=r}return true}};function p(e){var t=[];var r=e.length;for(var a=0;a<r;a++){t[a]=l(e[a])}return t}function v(e,t,r,a){var n=[];var i=t.length;for(var o=0;o<i;o++){n[o]=e.d2l(t[o],0,a)*r}return n}function d(e){var t=[];var r=e.length;for(var a=0;a<r;a++){t[a]=Math.round(e[a])}return t}function m(e,t){var r=["x","y","z"].indexOf(e);var a=[];var i=t.length;for(var o=0;o<i;o++){a[o]=[t[o][(r+1)%3],t[o][(r+2)%3]]}return n(a)}function g(e,t){var r=e.length;for(var a=0;a<r;a++){if(e[a]<=-.5||e[a]>=t-.5){return false}}return true}h.update=function(e){var t=this.scene;var r=t.fullSceneLayout;this.data=e;var a=e.x.length;var n=c(v(r.xaxis,e.x,t.dataScale[0],e.xcalendar),v(r.yaxis,e.y,t.dataScale[1],e.ycalendar),v(r.zaxis,e.z,t.dataScale[2],e.zcalendar));var f;if(e.i&&e.j&&e.k){if(e.i.length!==e.j.length||e.j.length!==e.k.length||!g(e.i,a)||!g(e.j,a)||!g(e.k,a)){return}f=c(d(e.i),d(e.j),d(e.k))}else if(e.alphahull===0){f=o(n)}else if(e.alphahull>0){f=i(e.alphahull,n)}else{f=m(e.delaunayaxis,n)}var h={positions:n,cells:f,lightPosition:[e.lightposition.x,e.lightposition.y,e.lightposition.z],ambient:e.lighting.ambient,diffuse:e.lighting.diffuse,specular:e.lighting.specular,roughness:e.lighting.roughness,fresnel:e.lighting.fresnel,vertexNormalsEpsilon:e.lighting.vertexnormalsepsilon,faceNormalsEpsilon:e.lighting.facenormalsepsilon,opacity:e.opacity,contourEnable:e.contour.show,contourColor:l(e.contour.color).slice(0,3),contourWidth:e.contour.width,useFacetNormals:e.flatshading};if(e.intensity){var y=u(e);this.color="#fff";var x=e.intensitymode;h[x+"Intensity"]=e.intensity;h[x+"IntensityBounds"]=[y.min,y.max];h.colormap=s(e)}else if(e.vertexcolor){this.color=e.vertexcolor[0];h.vertexColors=p(e.vertexcolor)}else if(e.facecolor){this.color=e.facecolor[0];h.cellColors=p(e.facecolor)}else{this.color=e.color;h.meshColor=l(e.color)}this.mesh.update(h)};h.dispose=function(){this.scene.glplot.remove(this.mesh);this.mesh.dispose()};function y(e,t){var r=e.glplot.gl;var n=a({gl:r});var i=new f(e,n,t.uid);n._trace=i;i.update(t);e.glplot.add(n);return i}t.exports=y},{"../../components/colorscale":662,"../../lib/gl_format_color":783,"../../lib/str2rgbarray":812,"../../plots/gl3d/zip3":891,"alpha-shape":75,"convex-hull":141,"delaunay-triangulate":177,"gl-mesh3d":309}],1146:[function(e,t,r){"use strict";var a=e("../../registry");var n=e("../../lib");var i=e("../../components/colorscale/defaults");var o=e("./attributes");t.exports=function e(t,r,s,l){function u(e,a){return n.coerce(t,r,o,e,a)}function c(e){var t=e.map((function(e){var t=u(e);if(t&&n.isArrayOrTypedArray(t))return t;return null}));return t.every((function(e){return e&&e.length===t[0].length}))&&t}var f=c(["x","y","z"]);if(!f){r.visible=false;return}c(["i","j","k"]);if(r.i&&(!r.j||!r.k)||r.j&&(!r.k||!r.i)||r.k&&(!r.i||!r.j)){r.visible=false;return}var h=a.getComponentMethod("calendars","handleTraceDefaults");h(t,r,["x","y","z"],l);["lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lighting.vertexnormalsepsilon","lighting.facenormalsepsilon","lightposition.x","lightposition.y","lightposition.z","flatshading","alphahull","delaunayaxis","opacity"].forEach((function(e){u(e)}));var p=u("contour.show");if(p){u("contour.color");u("contour.width")}if("intensity"in t){u("intensity");u("intensitymode");i(t,r,l,u,{prefix:"",cLetter:"c"})}else{r.showscale=false;if("facecolor"in t)u("facecolor");else if("vertexcolor"in t)u("vertexcolor");else u("color",s)}u("text");u("hovertext");u("hovertemplate");u("xhoverformat");u("yhoverformat");u("zhoverformat");r._length=null}},{"../../components/colorscale/defaults":660,"../../lib":787,"../../registry":915,"./attributes":1143}],1147:[function(e,t,r){"use strict";t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),calc:e("./calc"),colorbar:{min:"cmin",max:"cmax"},plot:e("./convert"),moduleType:"trace",name:"mesh3d",basePlotModule:e("../../plots/gl3d"),categories:["gl3d","showLegend"],meta:{}}},{"../../plots/gl3d":880,"./attributes":1143,"./calc":1144,"./convert":1145,"./defaults":1146}],1148:[function(e,t,r){"use strict";var a=e("../../lib").extendFlat;var n=e("../scatter/attributes");var i=e("../../plots/cartesian/axis_format_attributes").axisHoverFormat;var o=e("../../components/drawing/attributes").dash;var s=e("../../components/fx/attributes");var l=e("../../constants/delta.js");var u=l.INCREASING.COLOR;var c=l.DECREASING.COLOR;var f=n.line;function h(e){return{line:{color:a({},f.color,{dflt:e}),width:f.width,dash:o,editType:"style"},editType:"style"}}t.exports={xperiod:n.xperiod,xperiod0:n.xperiod0,xperiodalignment:n.xperiodalignment,xhoverformat:i("x"),yhoverformat:i("y"),x:{valType:"data_array",editType:"calc+clearAxisTypes"},open:{valType:"data_array",editType:"calc"},high:{valType:"data_array",editType:"calc"},low:{valType:"data_array",editType:"calc"},close:{valType:"data_array",editType:"calc"},line:{width:a({},f.width,{}),dash:a({},o,{}),editType:"style"},increasing:h(u),decreasing:h(c),text:{valType:"string",dflt:"",arrayOk:true,editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:true,editType:"calc"},tickwidth:{valType:"number",min:0,max:.5,dflt:.3,editType:"calc"},hoverlabel:a({},s.hoverlabel,{split:{valType:"boolean",dflt:false,editType:"style"}})}},{"../../components/drawing/attributes":671,"../../components/fx/attributes":681,"../../constants/delta.js":757,"../../lib":787,"../../plots/cartesian/axis_format_attributes":841,"../scatter/attributes":1202}],1149:[function(e,t,r){"use strict";var a=e("../../lib");var n=a._;var i=e("../../plots/cartesian/axes");var o=e("../../plots/cartesian/align_period");var s=e("../../constants/numerical").BADNUM;function l(e,t){var r=i.getFromId(e,t.xaxis);var n=i.getFromId(e,t.yaxis);var o=f(e,r,t);var s=t._minDiff;t._minDiff=null;var l=t._origX;t._origX=null;var h=t._xcalc;t._xcalc=null;var p=c(e,t,l,h,n,u);t._extremes[r._id]=i.findExtremes(r,h,{vpad:s/2});if(p.length){a.extendFlat(p[0].t,{wHover:s/2,tickLen:o});return p}else{return[{t:{empty:true}}]}}function u(e,t,r,a){return{o:e,h:t,l:r,c:a}}function c(e,t,r,o,l,u){var c=l.makeCalcdata(t,"open");var f=l.makeCalcdata(t,"high");var h=l.makeCalcdata(t,"low");var p=l.makeCalcdata(t,"close");var v=Array.isArray(t.text);var d=Array.isArray(t.hovertext);var m=true;var g=null;var y=!!t.xperiodalignment;var x=[];for(var b=0;b<o.length;b++){var _=o[b];var w=c[b];var T=f[b];var k=h[b];var M=p[b];if(_!==s&&w!==s&&T!==s&&k!==s&&M!==s){if(M===w){if(g!==null&&M!==g)m=M>g}else m=M>w;g=M;var A=u(w,T,k,M);A.pos=_;A.yc=(w+M)/2;A.i=b;A.dir=m?"increasing":"decreasing";A.x=A.pos;A.y=[k,T];if(y)A.orig_p=r[b];if(v)A.tx=t.text[b];if(d)A.htx=t.hovertext[b];x.push(A)}else{x.push({pos:_,empty:true})}}t._extremes[l._id]=i.findExtremes(l,a.concat(h,f),{padded:true});if(x.length){x[0].t={labels:{open:n(e,"open:")+" ",high:n(e,"high:")+" ",low:n(e,"low:")+" ",close:n(e,"close:")+" "}}}return x}function f(e,t,r){var n=r._minDiff;if(!n){var i=e._fullData;var s=[];n=Infinity;var l;for(l=0;l<i.length;l++){var u=i[l];if(u.type==="ohlc"&&u.visible===true&&u.xaxis===t._id){s.push(u);var c=t.makeCalcdata(u,"x");u._origX=c;var f=o(r,t,"x",c).vals;u._xcalc=f;var h=a.distinctVals(f).minDiff;if(h&&isFinite(h)){n=Math.min(n,h)}}}if(n===Infinity)n=1;for(l=0;l<s.length;l++){s[l]._minDiff=n}}return n*r.tickwidth}t.exports={calc:l,calcCommon:c}},{"../../constants/numerical":763,"../../lib":787,"../../plots/cartesian/align_period":835,"../../plots/cartesian/axes":838}],1150:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("./ohlc_defaults");var i=e("../scatter/period_defaults");var o=e("./attributes");t.exports=function e(t,r,l,u){function c(e,n){return a.coerce(t,r,o,e,n)}var f=n(t,r,c,u);if(!f){r.visible=false;return}i(t,r,u,c,{x:true});c("xhoverformat");c("yhoverformat");c("line.width");c("line.dash");s(t,r,c,"increasing");s(t,r,c,"decreasing");c("text");c("hovertext");c("tickwidth");u._requestRangeslider[r.xaxis]=true};function s(e,t,r,a){r(a+".line.color");r(a+".line.width",t.line.width);r(a+".line.dash",t.line.dash)}},{"../../lib":787,"../scatter/period_defaults":1222,"./attributes":1148,"./ohlc_defaults":1153}],1151:[function(e,t,r){"use strict";var a=e("../../plots/cartesian/axes");var n=e("../../lib");var i=e("../../components/fx");var o=e("../../components/color");var s=e("../../lib").fillText;var l=e("../../constants/delta.js");var u={increasing:l.INCREASING.SYMBOL,decreasing:l.DECREASING.SYMBOL};function c(e,t,r,a){var n=e.cd;var i=n[0].trace;if(i.hoverlabel.split){return h(e,t,r,a)}return p(e,t,r,a)}function f(e,t,r,a){var n=e.cd;var s=e.xa;var l=n[0].trace;var u=n[0].t;var c=l.type;var f=c==="ohlc"?"l":"min";var h=c==="ohlc"?"h":"max";var p,v;var d=u.bPos||0;var m=function(e){return e.pos+d-t};var g=u.bdPos||u.tickLen;var y=u.wHover;var x=Math.min(1,g/Math.abs(s.r2c(s.range[1])-s.r2c(s.range[0])));p=e.maxHoverDistance-x;v=e.maxSpikeDistance-x;function b(e){var t=m(e);return i.inbox(t-y,t+y,p)}function _(e){var t=e[f];var a=e[h];return t===a||i.inbox(t-r,a-r,p)}function w(e){return(b(e)+_(e))/2}var T=i.getDistanceFunction(a,b,_,w);i.getClosest(n,T,e);if(e.index===false)return null;var k=n[e.index];if(k.empty)return null;var M=k.dir;var A=l[M];var S=A.line.color;if(o.opacity(S)&&A.line.width)e.color=S;else e.color=A.fillcolor;e.x0=s.c2p(k.pos+d-g,true);e.x1=s.c2p(k.pos+d+g,true);e.xLabelVal=k.orig_p!==undefined?k.orig_p:k.pos;e.spikeDistance=w(k)*v/p;e.xSpike=s.c2p(k.pos,true);return e}function h(e,t,r,i){var o=e.cd;var s=e.ya;var l=o[0].trace;var u=o[0].t;var c=[];var h=f(e,t,r,i);if(!h)return[];var p=h.index;var v=o[p];var d=v.hi||l.hoverinfo;var m=d.split("+");var g=d==="all";var y=g||m.indexOf("y")!==-1;if(!y)return[];var x=["high","open","close","low"];var b={};for(var _=0;_<x.length;_++){var w=x[_];var T=l[w][h.index];var k=s.c2p(T,true);var M;if(T in b){M=b[T];M.yLabel+="<br>"+u.labels[w]+a.hoverLabelText(s,T,l.yhoverformat)}else{M=n.extendFlat({},h);M.y0=M.y1=k;M.yLabelVal=T;M.yLabel=u.labels[w]+a.hoverLabelText(s,T,l.yhoverformat);M.name="";c.push(M);b[T]=M}}return c}function p(e,t,r,n){var i=e.cd;var o=e.ya;var l=i[0].trace;var c=i[0].t;var h=f(e,t,r,n);if(!h)return[];var p=h.index;var v=i[p];var d=h.index=v.i;var m=v.dir;function g(e){return c.labels[e]+a.hoverLabelText(o,l[e][d],l.yhoverformat)}var y=v.hi||l.hoverinfo;var x=y.split("+");var b=y==="all";var _=b||x.indexOf("y")!==-1;var w=b||x.indexOf("text")!==-1;var T=_?[g("open"),g("high"),g("low"),g("close")+"  "+u[m]]:[];if(w)s(v,l,T);h.extraText=T.join("<br>");h.y0=h.y1=o.c2p(v.yc,true);return[h]}t.exports={hoverPoints:c,hoverSplit:h,hoverOnPoints:p}},{"../../components/color":650,"../../components/fx":690,"../../constants/delta.js":757,"../../lib":787,"../../plots/cartesian/axes":838}],1152:[function(e,t,r){"use strict";t.exports={moduleType:"trace",name:"ohlc",basePlotModule:e("../../plots/cartesian"),categories:["cartesian","svg","showLegend"],meta:{},attributes:e("./attributes"),supplyDefaults:e("./defaults"),calc:e("./calc").calc,plot:e("./plot"),style:e("./style"),hoverPoints:e("./hover").hoverPoints,selectPoints:e("./select")}},{"../../plots/cartesian":852,"./attributes":1148,"./calc":1149,"./defaults":1150,"./hover":1151,"./plot":1154,"./select":1155,"./style":1156}],1153:[function(e,t,r){"use strict";var a=e("../../registry");var n=e("../../lib");t.exports=function e(t,r,i,o){var s=i("x");var l=i("open");var u=i("high");var c=i("low");var f=i("close");i("hoverlabel.split");var h=a.getComponentMethod("calendars","handleTraceDefaults");h(t,r,["x"],o);if(!(l&&u&&c&&f))return;var p=Math.min(l.length,u.length,c.length,f.length);if(s)p=Math.min(p,n.minRowLength(s));r._length=p;return p}},{"../../lib":787,"../../registry":915}],1154:[function(e,t,r){"use strict";var a=e("@plotly/d3");var n=e("../../lib");t.exports=function e(t,r,i,o){var s=r.yaxis;var l=r.xaxis;var u=!!l.rangebreaks;n.makeTraceGroups(o,i,"trace ohlc").each((function(e){var t=a.select(this);var r=e[0];var i=r.t;var o=r.trace;if(o.visible!==true||i.empty){t.remove();return}var c=i.tickLen;var f=t.selectAll("path").data(n.identity);f.enter().append("path");f.exit().remove();f.attr("d",(function(e){if(e.empty)return"M0,0Z";var t=l.c2p(e.pos-c,true);var r=l.c2p(e.pos+c,true);var a=u?(t+r)/2:l.c2p(e.pos,true);var n=s.c2p(e.o,true);var i=s.c2p(e.h,true);var o=s.c2p(e.l,true);var f=s.c2p(e.c,true);return"M"+t+","+n+"H"+a+"M"+a+","+i+"V"+o+"M"+r+","+f+"H"+a}))}))}},{"../../lib":787,"@plotly/d3":58}],1155:[function(e,t,r){"use strict";t.exports=function e(t,r){var a=t.cd;var n=t.xaxis;var i=t.yaxis;var o=[];var s;var l=a[0].t.bPos||0;if(r===false){for(s=0;s<a.length;s++){a[s].selected=0}}else{for(s=0;s<a.length;s++){var u=a[s];if(r.contains([n.c2p(u.pos+l),i.c2p(u.yc)],null,u.i,t)){o.push({pointNumber:u.i,x:n.c2d(u.pos),y:i.c2d(u.yc)});u.selected=1}else{u.selected=0}}}return o}},{}],1156:[function(e,t,r){"use strict";var a=e("@plotly/d3");var n=e("../../components/drawing");var i=e("../../components/color");t.exports=function e(t,r,o){var s=o?o:a.select(t).selectAll("g.ohlclayer").selectAll("g.trace");s.style("opacity",(function(e){return e[0].trace.opacity}));s.each((function(e){var t=e[0].trace;a.select(this).selectAll("path").each((function(e){if(e.empty)return;var r=t[e.dir].line;a.select(this).style("fill","none").call(i.stroke,r.color).call(n.dashLine,r.dash,r.width).style("opacity",t.selectedpoints&&!e.selected?.3:1)}))}))}},{"../../components/color":650,"../../components/drawing":672,"@plotly/d3":58}],1157:[function(e,t,r){"use strict";var a=e("../../lib/extend").extendFlat;var n=e("../../plots/attributes");var i=e("../../plots/font_attributes");var o=e("../../components/colorscale/attributes");var s=e("../../plots/template_attributes").hovertemplateAttrs;var l=e("../../plots/domain").attributes;var u=a({editType:"calc"},o("line",{editTypeOverride:"calc"}),{shape:{valType:"enumerated",values:["linear","hspline"],dflt:"linear",editType:"plot"},hovertemplate:s({editType:"plot",arrayOk:false},{keys:["count","probability"]})});t.exports={domain:l({name:"parcats",trace:true,editType:"calc"}),hoverinfo:a({},n.hoverinfo,{flags:["count","probability"],editType:"plot",arrayOk:false}),hoveron:{valType:"enumerated",values:["category","color","dimension"],dflt:"category",editType:"plot"},hovertemplate:s({editType:"plot",arrayOk:false},{keys:["count","probability","category","categorycount","colorcount","bandcolorcount"]}),arrangement:{valType:"enumerated",values:["perpendicular","freeform","fixed"],dflt:"perpendicular",editType:"plot"},bundlecolors:{valType:"boolean",dflt:true,editType:"plot"},sortpaths:{valType:"enumerated",values:["forward","backward"],dflt:"forward",editType:"plot"},labelfont:i({editType:"calc"}),tickfont:i({editType:"calc"}),dimensions:{_isLinkedToArray:"dimension",label:{valType:"string",editType:"calc"},categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},ticktext:{valType:"data_array",editType:"calc"},values:{valType:"data_array",dflt:[],editType:"calc"},displayindex:{valType:"integer",editType:"calc"},editType:"calc",visible:{valType:"boolean",dflt:true,editType:"calc"}},line:u,counts:{valType:"number",min:0,dflt:1,arrayOk:true,editType:"calc"},customdata:undefined,hoverlabel:undefined,ids:undefined,legendgroup:undefined,legendrank:undefined,opacity:undefined,selectedpoints:undefined,showlegend:undefined}},{"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../plots/attributes":834,"../../plots/domain":866,"../../plots/font_attributes":867,"../../plots/template_attributes":910}],1158:[function(e,t,r){"use strict";var a=e("../../plots/get_data").getModuleCalcData;var n=e("./plot");var i="parcats";r.name=i;r.plot=function(e,t,r,o){var s=a(e.calcdata,i);if(s.length){var l=s[0];n(e,l,r,o)}};r.clean=function(e,t,r,a){var n=a._has&&a._has("parcats");var i=t._has&&t._has("parcats");if(n&&!i){a._paperdiv.selectAll(".parcats").remove()}}},{"../../plots/get_data":875,"./plot":1163}],1159:[function(e,t,r){"use strict";var a=e("../../lib/gup").wrap;var n=e("../../components/colorscale/helpers").hasColorscale;var i=e("../../components/colorscale/calc");var o=e("../../lib/filter_unique.js");var s=e("../../components/drawing");var l=e("../../lib");var u=e("fast-isnumeric");t.exports=function e(t,r){var x=l.filterVisible(r.dimensions);if(x.length===0)return[];var b=x.map((function(e){var t;if(e.categoryorder==="trace"){t=null}else if(e.categoryorder==="array"){t=e.categoryarray}else{t=o(e.values);var r=true;for(var a=0;a<t.length;a++){if(!u(t[a])){r=false;break}}t.sort(r?l.sorterAsc:undefined);if(e.categoryorder==="category descending"){t=t.reverse()}}return m(e.values,t)}));var _,w,T;if(l.isArrayOrTypedArray(r.counts)){_=r.counts}else{_=[r.counts]}g(x);x.forEach((function(e,t){y(e,b[t])}));var k=r.line;var M;if(k){if(n(r,"line")){i(t,r,{vals:r.line.color,containerStr:"line",cLetter:"c"})}M=s.tryColorscale(k)}else{M=l.identity}function A(e){var t,r;if(l.isArrayOrTypedArray(k.color)){t=k.color[e%k.color.length];r=t}else{t=k.color}return{color:M(t),rawColor:r}}var S=x[0].values.length;var E={};var L=b.map((function(e){return e.inds}));T=0;var C;var I;for(C=0;C<S;C++){var P=[];for(I=0;I<L.length;I++){P.push(L[I][C])}w=_[C%_.length];T+=w;var O=A(C);var z=P+"-"+O.rawColor;if(E[z]===undefined){E[z]=v(P,O.color,O.rawColor)}d(E[z],C,w)}var D=x.map((function(e,t){return f(t,e._index,e._displayindex,e.label,T)}));for(C=0;C<S;C++){w=_[C%_.length];for(I=0;I<D.length;I++){var R=D[I].containerInd;var F=b[I].inds[C];var B=D[I].categories;if(B[F]===undefined){var N=r.dimensions[R]._categoryarray[F];var j=r.dimensions[R]._ticktext[F];B[F]=h(I,F,N,j)}p(B[F],C,w)}}return a(c(D,E,T))};function c(e,t,r){var a=e.map((function(e){return e.categories.length})).reduce((function(e,t){return Math.max(e,t)}));return{dimensions:e,paths:t,trace:undefined,maxCats:a,count:r}}function f(e,t,r,a,n){return{dimensionInd:e,containerInd:t,displayInd:r,dimensionLabel:a,count:n,categories:[],dragX:null}}function h(e,t,r,a){return{dimensionInd:e,categoryInd:t,categoryValue:r,displayInd:t,categoryLabel:a,valueInds:[],count:0,dragY:null}}function p(e,t,r){e.valueInds.push(t);e.count+=r}function v(e,t,r){return{categoryInds:e,color:t,rawColor:r,valueInds:[],count:0}}function d(e,t,r){e.valueInds.push(t);e.count+=r}function m(e,t){if(t===undefined||t===null){t=[]}else{t=t.map((function(e){return e}))}var r={};var a={};var n=[];t.forEach((function(e,t){r[e]=0;a[e]=t}));for(var i=0;i<e.length;i++){var o=e[i];var s;if(r[o]===undefined){r[o]=1;s=t.push(o)-1;a[o]=s}else{r[o]++;s=a[o]}n.push(s)}var l=t.map((function(e){return r[e]}));return{uniqueValues:t,uniqueCounts:l,inds:n}}function g(e){var t=e.map((function(e){return e.displayindex}));var r;if(x(t)){for(r=0;r<e.length;r++){e[r]._displayindex=e[r].displayindex}}else{for(r=0;r<e.length;r++){e[r]._displayindex=r}}}function y(e,t){e._categoryarray=t.uniqueValues;if(e.ticktext===null||e.ticktext===undefined){e._ticktext=[]}else{e._ticktext=e.ticktext.slice()}for(var r=e._ticktext.length;r<t.uniqueValues.length;r++){e._ticktext.push(t.uniqueValues[r])}}function x(e){var t=new Array(e.length);for(var r=0;r<e.length;r++){if(e[r]<0||e[r]>=e.length){return false}if(t[e[r]]!==undefined){return false}t[e[r]]=true}return true}},{"../../components/colorscale/calc":658,"../../components/colorscale/helpers":661,"../../components/drawing":672,"../../lib":787,"../../lib/filter_unique.js":778,"../../lib/gup":784,"fast-isnumeric":246}],1160:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("../../components/colorscale/helpers").hasColorscale;var i=e("../../components/colorscale/defaults");var o=e("../../plots/domain").defaults;var s=e("../../plots/array_container_defaults");var l=e("./attributes");var u=e("../parcoords/merge_length");function c(e,t,r,o,s){s("line.shape");s("line.hovertemplate");var l=s("line.color",o.colorway[0]);if(n(e,"line")&&a.isArrayOrTypedArray(l)){if(l.length){s("line.colorscale");i(e,t,o,s,{prefix:"line.",cLetter:"c"});return l.length}else{t.line.color=r}}return Infinity}function f(e,t){function r(r,n){return a.coerce(e,t,l.dimensions,r,n)}var n=r("values");var i=r("visible");if(!(n&&n.length)){i=t.visible=false}if(i){r("label");r("displayindex",t._index);var o=e.categoryarray;var s=Array.isArray(o)&&o.length>0;var u;if(s)u="array";var c=r("categoryorder",u);if(c==="array"){r("categoryarray");r("ticktext")}else{delete e.categoryarray;delete e.ticktext}if(!s&&c==="array"){t.categoryorder="trace"}}}t.exports=function e(t,r,n,i){function h(e,n){return a.coerce(t,r,l,e,n)}var p=s(t,r,{name:"dimensions",handleItemDefaults:f});var v=c(t,r,n,i,h);o(r,i,h);if(!Array.isArray(p)||!p.length){r.visible=false}u(r,p,"values",v);h("hoveron");h("hovertemplate");h("arrangement");h("bundlecolors");h("sortpaths");h("counts");var d={family:i.font.family,size:Math.round(i.font.size),color:i.font.color};a.coerceFont(h,"labelfont",d);var m={family:i.font.family,size:Math.round(i.font.size/1.2),color:i.font.color};a.coerceFont(h,"tickfont",m)}},{"../../components/colorscale/defaults":660,"../../components/colorscale/helpers":661,"../../lib":787,"../../plots/array_container_defaults":833,"../../plots/domain":866,"../parcoords/merge_length":1173,"./attributes":1157}],1161:[function(e,t,r){"use strict";t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),calc:e("./calc"),plot:e("./plot"),colorbar:{container:"line",min:"cmin",max:"cmax"},moduleType:"trace",name:"parcats",basePlotModule:e("./base_plot"),categories:["noOpacity"],meta:{}}},{"./attributes":1157,"./base_plot":1158,"./calc":1159,"./defaults":1160,"./plot":1163}],1162:[function(e,t,r){"use strict";var a=e("@plotly/d3");var n=e("d3-interpolate").interpolateNumber;var i=e("../../plot_api/plot_api");var o=e("../../components/fx");var s=e("../../lib");var l=s.strTranslate;var u=e("../../components/drawing");var c=e("tinycolor2");var f=e("../../lib/svg_text_utils");function h(e,t,r,n){var i=e.map(H.bind(0,t,r));var o=n.selectAll("g.parcatslayer").data([null]);o.enter().append("g").attr("class","parcatslayer").style("pointer-events","all");var c=o.selectAll("g.trace.parcats").data(i,p);var h=c.enter().append("g").attr("class","trace parcats");c.attr("transform",(function(e){return l(e.x,e.y)}));h.append("g").attr("class","paths");var y=c.select("g.paths");var x=y.selectAll("path.path").data((function(e){return e.paths}),p);x.attr("fill",(function(e){return e.model.color}));var w=x.enter().append("path").attr("class","path").attr("stroke-opacity",0).attr("fill",(function(e){return e.model.color})).attr("fill-opacity",0);_(w);x.attr("d",(function(e){return e.svgD}));if(!w.empty()){x.sort(d)}x.exit().remove();x.on("mouseover",m).on("mouseout",g).on("click",b);h.append("g").attr("class","dimensions");var T=c.select("g.dimensions");var M=T.selectAll("g.dimension").data((function(e){return e.dimensions}),p);M.enter().append("g").attr("class","dimension");M.attr("transform",(function(e){return l(e.x,0)}));M.exit().remove();var S=M.selectAll("g.category").data((function(e){return e.categories}),p);var E=S.enter().append("g").attr("class","category");S.attr("transform",(function(e){return l(0,e.y)}));E.append("rect").attr("class","catrect").attr("pointer-events","none");S.select("rect.catrect").attr("fill","none").attr("width",(function(e){return e.width})).attr("height",(function(e){return e.height}));k(E);var L=S.selectAll("rect.bandrect").data((function(e){return e.bands}),p);L.each((function(){s.raiseToTop(this)}));L.attr("fill",(function(e){return e.color}));var C=L.enter().append("rect").attr("class","bandrect").attr("stroke-opacity",0).attr("fill",(function(e){return e.color})).attr("fill-opacity",0);L.attr("fill",(function(e){return e.color})).attr("width",(function(e){return e.width})).attr("height",(function(e){return e.height})).attr("y",(function(e){return e.y})).attr("cursor",(function(e){if(e.parcatsViewModel.arrangement==="fixed"){return"default"}else if(e.parcatsViewModel.arrangement==="perpendicular"){return"ns-resize"}else{return"move"}}));A(C);L.exit().remove();E.append("text").attr("class","catlabel").attr("pointer-events","none");var I=t._fullLayout.paper_bgcolor;S.select("text.catlabel").attr("text-anchor",(function(e){if(v(e)){return"start"}else{return"end"}})).attr("alignment-baseline","middle").style("text-shadow",f.makeTextShadow(I)).style("fill","rgb(0, 0, 0)").attr("x",(function(e){if(v(e)){return e.width+5}else{return-5}})).attr("y",(function(e){return e.height/2})).text((function(e){return e.model.categoryLabel})).each((function(e){u.font(a.select(this),e.parcatsViewModel.categorylabelfont);f.convertToTspans(a.select(this),t)}));E.append("text").attr("class","dimlabel");S.select("text.dimlabel").attr("text-anchor","middle").attr("alignment-baseline","baseline").attr("cursor",(function(e){if(e.parcatsViewModel.arrangement==="fixed"){return"default"}else{return"ew-resize"}})).attr("x",(function(e){return e.width/2})).attr("y",-5).text((function(e,t){if(t===0){return e.parcatsViewModel.model.dimensions[e.model.dimensionInd].dimensionLabel}else{return null}})).each((function(e){u.font(a.select(this),e.parcatsViewModel.labelfont)}));S.selectAll("rect.bandrect").on("mouseover",D).on("mouseout",R);S.exit().remove();M.call(a.behavior.drag().origin((function(e){return{x:e.x,y:0}})).on("dragstart",F).on("drag",B).on("dragend",N));c.each((function(e){e.traceSelection=a.select(this);e.pathSelection=a.select(this).selectAll("g.paths").selectAll("path.path");e.dimensionSelection=a.select(this).selectAll("g.dimensions").selectAll("g.dimension")}));c.exit().remove()}t.exports=function(e,t,r,a){h(r,e,a,t)};function p(e){return e.key}function v(e){var t=e.parcatsViewModel.dimensions.length;var r=e.parcatsViewModel.dimensions[t-1].model.dimensionInd;return e.model.dimensionInd===r}function d(e,t){if(e.model.rawColor>t.model.rawColor){return 1}else if(e.model.rawColor<t.model.rawColor){return-1}else{return 0}}function m(e){if(!e.parcatsViewModel.dragDimension){if(e.parcatsViewModel.hoverinfoItems.indexOf("skip")===-1){s.raiseToTop(this);w(a.select(this));var t=y(e);var r=x(e);e.parcatsViewModel.graphDiv.emit("plotly_hover",{points:t,event:a.event,constraints:r});if(e.parcatsViewModel.hoverinfoItems.indexOf("none")===-1){var n=a.mouse(this)[0];var i=e.parcatsViewModel.graphDiv;var l=e.parcatsViewModel.trace;var u=i._fullLayout;var f=u._paperdiv.node().getBoundingClientRect();var h=e.parcatsViewModel.graphDiv.getBoundingClientRect();var p,v,d;for(d=0;d<e.leftXs.length-1;d++){if(e.leftXs[d]+e.dimWidths[d]-2<=n&&n<=e.leftXs[d+1]+2){var m=e.parcatsViewModel.dimensions[d];var g=e.parcatsViewModel.dimensions[d+1];p=(m.x+m.width+g.x)/2;v=(e.topYs[d]+e.topYs[d+1]+e.height)/2;break}}var b=e.parcatsViewModel.x+p;var _=e.parcatsViewModel.y+v;var T=c.mostReadable(e.model.color,["black","white"]);var k=e.model.count;var M=k/e.parcatsViewModel.model.count;var A={countLabel:k,probabilityLabel:M.toFixed(3)};var S=[];if(e.parcatsViewModel.hoverinfoItems.indexOf("count")!==-1){S.push(["Count:",A.countLabel].join(" "))}if(e.parcatsViewModel.hoverinfoItems.indexOf("probability")!==-1){S.push(["P:",A.probabilityLabel].join(" "))}var E=S.join("<br>");var L=a.mouse(i)[0];o.loneHover({trace:l,x:b-f.left+h.left,y:_-f.top+h.top,text:E,color:e.model.color,borderColor:"black",fontFamily:'Monaco, "Courier New", monospace',fontSize:10,fontColor:T,idealAlign:L<b?"right":"left",hovertemplate:(l.line||{}).hovertemplate,hovertemplateLabels:A,eventData:[{data:l._input,fullData:l,count:k,probability:M}]},{container:u._hoverlayer.node(),outerContainer:u._paper.node(),gd:i})}}}}function g(e){if(!e.parcatsViewModel.dragDimension){_(a.select(this));o.loneUnhover(e.parcatsViewModel.graphDiv._fullLayout._hoverlayer.node());e.parcatsViewModel.pathSelection.sort(d);if(e.parcatsViewModel.hoverinfoItems.indexOf("skip")===-1){var t=y(e);var r=x(e);e.parcatsViewModel.graphDiv.emit("plotly_unhover",{points:t,event:a.event,constraints:r})}}}function y(e){var t=[];var r=j(e.parcatsViewModel);for(var a=0;a<e.model.valueInds.length;a++){var n=e.model.valueInds[a];t.push({curveNumber:r,pointNumber:n})}return t}function x(e){var t={};var r=e.parcatsViewModel.model.dimensions;for(var a=0;a<r.length;a++){var n=r[a];var i=n.categories[e.model.categoryInds[a]];t[n.containerInd]=i.categoryValue}if(e.model.rawColor!==undefined){t.color=e.model.rawColor}return t}function b(e){if(e.parcatsViewModel.hoverinfoItems.indexOf("skip")===-1){var t=y(e);var r=x(e);e.parcatsViewModel.graphDiv.emit("plotly_click",{points:t,event:a.event,constraints:r})}}function _(e){e.attr("fill",(function(e){return e.model.color})).attr("fill-opacity",.6).attr("stroke","lightgray").attr("stroke-width",.2).attr("stroke-opacity",1)}function w(e){e.attr("fill-opacity",.8).attr("stroke",(function(e){return c.mostReadable(e.model.color,["black","white"])})).attr("stroke-width",.3)}function T(e){e.select("rect.catrect").attr("stroke","black").attr("stroke-width",2.5)}function k(e){e.select("rect.catrect").attr("stroke","black").attr("stroke-width",1).attr("stroke-opacity",1)}function M(e){e.attr("stroke","black").attr("stroke-width",1.5)}function A(e){e.attr("stroke","black").attr("stroke-width",.2).attr("stroke-opacity",1).attr("fill-opacity",1)}function S(e){var t=e.parcatsViewModel.pathSelection;var r=e.categoryViewModel.model.dimensionInd;var a=e.categoryViewModel.model.categoryInd;return t.filter((function(t){return t.model.categoryInds[r]===a&&t.model.color===e.color}))}function E(e){var t=a.select(e.parentNode).selectAll("rect.bandrect");t.each((function(e){var t=S(e);w(t);t.each((function(){s.raiseToTop(this)}))}));T(a.select(e.parentNode))}function L(e){var t=a.select(e).datum();var r=S(t);w(r);r.each((function(){s.raiseToTop(this)}));a.select(e.parentNode).selectAll("rect.bandrect").filter((function(e){return e.color===t.color})).each((function(){s.raiseToTop(this);M(a.select(this))}))}function C(e,t,r){var n=a.select(e).datum();var i=n.categoryViewModel.model;var o=n.parcatsViewModel.graphDiv;var s=a.select(e.parentNode).selectAll("rect.bandrect");var l=[];s.each((function(e){var t=S(e);t.each((function(e){Array.prototype.push.apply(l,y(e))}))}));var u={};u[i.dimensionInd]=i.categoryValue;o.emit(t,{points:l,event:r,constraints:u})}function I(e,t,r){var n=a.select(e).datum();var i=n.categoryViewModel.model;var o=n.parcatsViewModel.graphDiv;var s=S(n);var l=[];s.each((function(e){Array.prototype.push.apply(l,y(e))}));var u={};u[i.dimensionInd]=i.categoryValue;if(n.rawColor!==undefined){u.color=n.rawColor}o.emit(t,{points:l,event:r,constraints:u})}function P(e,t,r){e._fullLayout._calcInverseTransform(e);var n=e._fullLayout._invScaleX;var i=e._fullLayout._invScaleY;var o=a.select(r.parentNode).select("rect.catrect");var s=o.node().getBoundingClientRect();var l=o.datum();var u=l.parcatsViewModel;var c=u.model.dimensions[l.model.dimensionInd];var f=u.trace;var h=s.top+s.height/2;var p,v;if(u.dimensions.length>1&&c.displayInd===u.dimensions.length-1){p=s.left;v="left"}else{p=s.left+s.width;v="right"}var d=l.model.count;var m=l.model.categoryLabel;var g=d/l.parcatsViewModel.model.count;var y={countLabel:d,categoryLabel:m,probabilityLabel:g.toFixed(3)};var x=[];if(l.parcatsViewModel.hoverinfoItems.indexOf("count")!==-1){x.push(["Count:",y.countLabel].join(" "))}if(l.parcatsViewModel.hoverinfoItems.indexOf("probability")!==-1){x.push(["P("+y.categoryLabel+"):",y.probabilityLabel].join(" "))}var b=x.join("<br>");return{trace:f,x:n*(p-t.left),y:i*(h-t.top),text:b,color:"lightgray",borderColor:"black",fontFamily:'Monaco, "Courier New", monospace',fontSize:12,fontColor:"black",idealAlign:v,hovertemplate:f.hovertemplate,hovertemplateLabels:y,eventData:[{data:f._input,fullData:f,count:d,category:m,probability:g}]}}function O(e,t,r){var n=[];a.select(r.parentNode.parentNode).selectAll("g.category").select("rect.catrect").each((function(){var r=this;n.push(P(e,t,r))}));return n}function z(e,t,r){e._fullLayout._calcInverseTransform(e);var n=e._fullLayout._invScaleX;var i=e._fullLayout._invScaleY;var o=r.getBoundingClientRect();var s=a.select(r).datum();var l=s.categoryViewModel;var u=l.parcatsViewModel;var f=u.model.dimensions[l.model.dimensionInd];var h=u.trace;var p=o.y+o.height/2;var v,d;if(u.dimensions.length>1&&f.displayInd===u.dimensions.length-1){v=o.left;d="left"}else{v=o.left+o.width;d="right"}var m=l.model.categoryLabel;var g=s.parcatsViewModel.model.count;var y=0;s.categoryViewModel.bands.forEach((function(e){if(e.color===s.color){y+=e.count}}));var x=l.model.count;var b=0;u.pathSelection.each((function(e){if(e.model.color===s.color){b+=e.model.count}}));var _=y/g;var w=y/b;var T=y/x;var k={countLabel:g,categoryLabel:m,probabilityLabel:_.toFixed(3)};var M=[];if(l.parcatsViewModel.hoverinfoItems.indexOf("count")!==-1){M.push(["Count:",k.countLabel].join(" "))}if(l.parcatsViewModel.hoverinfoItems.indexOf("probability")!==-1){M.push("P(color ∩ "+m+"): "+k.probabilityLabel);M.push("P("+m+" | color): "+w.toFixed(3));M.push("P(color | "+m+"): "+T.toFixed(3))}var A=M.join("<br>");var S=c.mostReadable(s.color,["black","white"]);return{trace:h,x:n*(v-t.left),y:i*(p-t.top),text:A,color:s.color,borderColor:"black",fontFamily:'Monaco, "Courier New", monospace',fontColor:S,fontSize:10,idealAlign:d,hovertemplate:h.hovertemplate,hovertemplateLabels:k,eventData:[{data:h._input,fullData:h,category:m,count:g,probability:_,categorycount:x,colorcount:b,bandcolorcount:y}]}}function D(e){if(!e.parcatsViewModel.dragDimension){if(e.parcatsViewModel.hoverinfoItems.indexOf("skip")===-1){var t=a.mouse(this)[1];if(t<-1){return}var r=e.parcatsViewModel.graphDiv;var n=r._fullLayout;var i=n._paperdiv.node().getBoundingClientRect();var s=e.parcatsViewModel.hoveron;var l=this;if(s==="color"){L(l);I(l,"plotly_hover",a.event)}else{E(l);C(l,"plotly_hover",a.event)}if(e.parcatsViewModel.hoverinfoItems.indexOf("none")===-1){var u;if(s==="category"){u=P(r,i,l)}else if(s==="color"){u=z(r,i,l)}else if(s==="dimension"){u=O(r,i,l)}if(u){o.loneHover(u,{container:n._hoverlayer.node(),outerContainer:n._paper.node(),gd:r})}}}}}function R(e){var t=e.parcatsViewModel;if(!t.dragDimension){_(t.pathSelection);k(t.dimensionSelection.selectAll("g.category"));A(t.dimensionSelection.selectAll("g.category").selectAll("rect.bandrect"));o.loneUnhover(t.graphDiv._fullLayout._hoverlayer.node());t.pathSelection.sort(d);if(t.hoverinfoItems.indexOf("skip")===-1){var r=e.parcatsViewModel.hoveron;var n=this;if(r==="color"){I(n,"plotly_unhover",a.event)}else{C(n,"plotly_unhover",a.event)}}}}function F(e){if(e.parcatsViewModel.arrangement==="fixed"){return}e.dragDimensionDisplayInd=e.model.displayInd;e.initialDragDimensionDisplayInds=e.parcatsViewModel.model.dimensions.map((function(e){return e.displayInd}));e.dragHasMoved=false;e.dragCategoryDisplayInd=null;a.select(this).selectAll("g.category").select("rect.catrect").each((function(t){var r=a.mouse(this)[0];var n=a.mouse(this)[1];if(-2<=r&&r<=t.width+2&&-2<=n&&n<=t.height+2){e.dragCategoryDisplayInd=t.model.displayInd;e.initialDragCategoryDisplayInds=e.model.categories.map((function(e){return e.displayInd}));t.model.dragY=t.y;s.raiseToTop(this.parentNode);a.select(this.parentNode).selectAll("rect.bandrect").each((function(t){if(t.y<n&&n<=t.y+t.height){e.potentialClickBand=this}}))}}));e.parcatsViewModel.dragDimension=e;o.loneUnhover(e.parcatsViewModel.graphDiv._fullLayout._hoverlayer.node())}function B(e){if(e.parcatsViewModel.arrangement==="fixed"){return}e.dragHasMoved=true;if(e.dragDimensionDisplayInd===null){return}var t=e.dragDimensionDisplayInd;var r=t-1;var n=t+1;var i=e.parcatsViewModel.dimensions[t];if(e.dragCategoryDisplayInd!==null){var o=i.categories[e.dragCategoryDisplayInd];o.model.dragY+=a.event.dy;var s=o.model.dragY;var l=o.model.displayInd;var u=i.categories;var c=u[l-1];var f=u[l+1];if(c!==undefined){if(s<c.y+c.height/2){o.model.displayInd=c.model.displayInd;c.model.displayInd=l}}if(f!==undefined){if(s+o.height>f.y+f.height/2){o.model.displayInd=f.model.displayInd;f.model.displayInd=l}}e.dragCategoryDisplayInd=o.model.displayInd}if(e.dragCategoryDisplayInd===null||e.parcatsViewModel.arrangement==="freeform"){i.model.dragX=a.event.x;var h=e.parcatsViewModel.dimensions[r];var p=e.parcatsViewModel.dimensions[n];if(h!==undefined){if(i.model.dragX<h.x+h.width){i.model.displayInd=h.model.displayInd;h.model.displayInd=t}}if(p!==undefined){if(i.model.dragX+i.width>p.x){i.model.displayInd=p.model.displayInd;p.model.displayInd=e.dragDimensionDisplayInd}}e.dragDimensionDisplayInd=i.model.displayInd}Y(e.parcatsViewModel);G(e.parcatsViewModel);V(e.parcatsViewModel);U(e.parcatsViewModel)}function N(e){if(e.parcatsViewModel.arrangement==="fixed"){return}if(e.dragDimensionDisplayInd===null){return}a.select(this).selectAll("text").attr("font-weight","normal");var t={};var r=j(e.parcatsViewModel);var n=e.parcatsViewModel.model.dimensions.map((function(e){return e.displayInd}));var o=e.initialDragDimensionDisplayInds.some((function(e,t){return e!==n[t]}));if(o){n.forEach((function(r,a){var n=e.parcatsViewModel.model.dimensions[a].containerInd;t["dimensions["+n+"].displayindex"]=r}))}var s=false;if(e.dragCategoryDisplayInd!==null){var l=e.model.categories.map((function(e){return e.displayInd}));s=e.initialDragCategoryDisplayInds.some((function(e,t){return e!==l[t]}));if(s){var u=e.model.categories.slice().sort((function(e,t){return e.displayInd-t.displayInd}));var c=u.map((function(e){return e.categoryValue}));var f=u.map((function(e){return e.categoryLabel}));t["dimensions["+e.model.containerInd+"].categoryarray"]=[c];t["dimensions["+e.model.containerInd+"].ticktext"]=[f];t["dimensions["+e.model.containerInd+"].categoryorder"]="array"}}if(e.parcatsViewModel.hoverinfoItems.indexOf("skip")===-1){if(!e.dragHasMoved&&e.potentialClickBand){if(e.parcatsViewModel.hoveron==="color"){I(e.potentialClickBand,"plotly_click",a.event.sourceEvent)}else{C(e.potentialClickBand,"plotly_click",a.event.sourceEvent)}}}e.model.dragX=null;if(e.dragCategoryDisplayInd!==null){var h=e.parcatsViewModel.dimensions[e.dragDimensionDisplayInd].categories[e.dragCategoryDisplayInd];h.model.dragY=null;e.dragCategoryDisplayInd=null}e.dragDimensionDisplayInd=null;e.parcatsViewModel.dragDimension=null;e.dragHasMoved=null;e.potentialClickBand=null;Y(e.parcatsViewModel);G(e.parcatsViewModel);var p=a.transition().duration(300).ease("cubic-in-out");p.each((function(){V(e.parcatsViewModel,true);U(e.parcatsViewModel,true)})).each("end",(function(){if(o||s){i.restyle(e.parcatsViewModel.graphDiv,t,[r])}}))}function j(e){var t;var r=e.graphDiv._fullData;for(var a=0;a<r.length;a++){if(e.key===r[a].uid){t=a;break}}return t}function U(e,t){if(t===undefined){t=false}function r(e){return t?e.transition():e}e.pathSelection.data((function(e){return e.paths}),p);r(e.pathSelection).attr("d",(function(e){return e.svgD}))}function V(e,t){if(t===undefined){t=false}function r(e){return t?e.transition():e}e.dimensionSelection.data((function(e){return e.dimensions}),p);var n=e.dimensionSelection.selectAll("g.category").data((function(e){return e.categories}),p);r(e.dimensionSelection).attr("transform",(function(e){return l(e.x,0)}));r(n).attr("transform",(function(e){return l(0,e.y)}));var i=n.select(".dimlabel");i.text((function(e,t){if(t===0){return e.parcatsViewModel.model.dimensions[e.model.dimensionInd].dimensionLabel}else{return null}}));var o=n.select(".catlabel");o.attr("text-anchor",(function(e){if(v(e)){return"start"}else{return"end"}})).attr("x",(function(e){if(v(e)){return e.width+5}else{return-5}})).each((function(e){var t;var r;if(v(e)){t=e.width+5;r="start"}else{t=-5;r="end"}a.select(this).selectAll("tspan").attr("x",t).attr("text-anchor",r)}));var u=n.selectAll("rect.bandrect").data((function(e){return e.bands}),p);var c=u.enter().append("rect").attr("class","bandrect").attr("cursor","move").attr("stroke-opacity",0).attr("fill",(function(e){return e.color})).attr("fill-opacity",0);u.attr("fill",(function(e){return e.color})).attr("width",(function(e){return e.width})).attr("height",(function(e){return e.height})).attr("y",(function(e){return e.y}));A(c);u.each((function(){s.raiseToTop(this)}));u.exit().remove()}function H(e,t,r){var a=r[0];var n=t.margin||{l:80,r:80,t:100,b:80};var i=a.trace;var o=i.domain;var s=t.width;var l=t.height;var u=Math.floor(s*(o.x[1]-o.x[0]));var c=Math.floor(l*(o.y[1]-o.y[0]));var f=o.x[0]*s+n.l;var h=t.height-o.y[1]*t.height+n.t;var p=i.line.shape;var v;if(i.hoverinfo==="all"){v=["count","probability"]}else{v=(i.hoverinfo||"").split("+")}var d={trace:i,key:i.uid,model:a,x:f,y:h,width:u,height:c,hoveron:i.hoveron,hoverinfoItems:v,arrangement:i.arrangement,bundlecolors:i.bundlecolors,sortpaths:i.sortpaths,labelfont:i.labelfont,categorylabelfont:i.tickfont,pathShape:p,dragDimension:null,margin:n,paths:[],dimensions:[],graphDiv:e,traceSelection:null,pathSelection:null,dimensionSelection:null};if(a.dimensions){Y(d);G(d)}return d}function q(e,t,r,a,i){var o=[];var s=[];var l;var u;for(u=0;u<r.length-1;u++){l=n(r[u]+e[u],e[u+1]);o.push(l(i));s.push(l(1-i))}var c="M "+e[0]+","+t[0];c+="l"+r[0]+",0 ";for(u=1;u<r.length;u++){c+="C"+o[u-1]+","+t[u-1]+" "+s[u-1]+","+t[u]+" "+e[u]+","+t[u];c+="l"+r[u]+",0 "}c+="l"+"0,"+a+" ";c+="l -"+r[r.length-1]+",0 ";for(u=r.length-2;u>=0;u--){c+="C"+s[u]+","+(t[u+1]+a)+" "+o[u]+","+(t[u]+a)+" "+(e[u]+r[u])+","+(t[u]+a);c+="l-"+r[u]+",0 "}c+="Z";return c}function G(e){var t=e.dimensions;var r=e.model;var a=t.map((function(e){return e.categories.map((function(e){return e.y}))}));var n=e.model.dimensions.map((function(e){return e.categories.map((function(e){return e.displayInd}))}));var i=e.model.dimensions.map((function(e){return e.displayInd}));var o=e.dimensions.map((function(e){return e.model.dimensionInd}));var s=t.map((function(e){return e.x}));var l=t.map((function(e){return e.width}));var u=[];for(var c in r.paths){if(r.paths.hasOwnProperty(c)){u.push(r.paths[c])}}function f(e){var t=e.categoryInds.map((function(e,t){return n[t][e]}));var r=o.map((function(e){return t[e]}));return r}u.sort((function(t,r){var a=f(t);var n=f(r);if(e.sortpaths==="backward"){a.reverse();n.reverse()}a.push(t.valueInds[0]);n.push(r.valueInds[0]);if(e.bundlecolors){a.unshift(t.rawColor);n.unshift(r.rawColor)}if(a<n){return-1}if(a>n){return 1}return 0}));var h=new Array(u.length);var p=t[0].model.count;var v=t[0].categories.map((function(e){return e.height})).reduce((function(e,t){return e+t}));for(var d=0;d<u.length;d++){var m=u[d];var g;if(p>0){g=v*(m.count/p)}else{g=0}var y=new Array(a.length);for(var x=0;x<m.categoryInds.length;x++){var b=m.categoryInds[x];var _=n[x][b];var w=i[x];y[w]=a[w][_];a[w][_]+=g;var T=e.dimensions[w].categories[_];var k=T.bands.length;var M=T.bands[k-1];if(M===undefined||m.rawColor!==M.rawColor){var A=M===undefined?0:M.y+M.height;T.bands.push({key:A,color:m.color,rawColor:m.rawColor,height:g,width:T.width,count:m.count,y:A,categoryViewModel:T,parcatsViewModel:e})}else{var S=T.bands[k-1];S.height+=g;S.count+=m.count}}var E;if(e.pathShape==="hspline"){E=q(s,y,l,g,.5)}else{E=q(s,y,l,g,0)}h[d]={key:m.valueInds[0],model:m,height:g,leftXs:s,topYs:y,dimWidths:l,svgD:E,parcatsViewModel:e}}e.paths=h}function Y(e){var t=e.model.dimensions.map((function(e){return{displayInd:e.displayInd,dimensionInd:e.dimensionInd}}));t.sort((function(e,t){return e.displayInd-t.displayInd}));var r=[];for(var a in t){var n=t[a].dimensionInd;var i=e.model.dimensions[n];r.push(W(e,i))}e.dimensions=r}function W(e,t){var r=40;var a=16;var n=e.model.dimensions.length;var i=t.displayInd;var o;var s;var l;if(n>1){o=(e.width-2*r-a)/(n-1)}else{o=0}s=r;l=s+o*i;var u=[];var c=e.model.maxCats;var f=t.categories.length;var h=8;var p=t.count;var v=e.height-h*(c-1);var d;var m;var g;var y;var x;var b=(c-f)*h/2;var _=t.categories.map((function(e){return{displayInd:e.displayInd,categoryInd:e.categoryInd}}));_.sort((function(e,t){return e.displayInd-t.displayInd}));for(x=0;x<f;x++){y=_[x].categoryInd;m=t.categories[y];if(p>0){d=m.count/p*v}else{d=0}g={key:m.valueInds[0],model:m,width:a,height:d,y:m.dragY!==null?m.dragY:b,bands:[],parcatsViewModel:e};b=b+d+h;u.push(g)}return{key:t.dimensionInd,x:t.dragX!==null?t.dragX:l,y:0,width:a,model:t,categories:u,parcatsViewModel:e,dragCategoryDisplayInd:null,dragDimensionDisplayInd:null,initialDragDimensionDisplayInds:null,initialDragCategoryDisplayInds:null,dragHasMoved:null,potentialClickBand:null}}},{"../../components/drawing":672,"../../components/fx":690,"../../lib":787,"../../lib/svg_text_utils":813,"../../plot_api/plot_api":824,"@plotly/d3":58,"d3-interpolate":168,tinycolor2:583}],1163:[function(e,t,r){"use strict";var a=e("./parcats");t.exports=function e(t,r,n,i){var o=t._fullLayout;var s=o._paper;var l=o._size;a(t,s,r,{width:l.w,height:l.h,margin:{t:l.t,r:l.r,b:l.b,l:l.l}},n,i)}},{"./parcats":1162}],1164:[function(e,t,r){"use strict";var a=e("../../components/colorscale/attributes");var n=e("../../plots/cartesian/layout_attributes");var i=e("../../plots/font_attributes");var o=e("../../plots/domain").attributes;var s=e("../../lib/extend").extendFlat;var l=e("../../plot_api/plot_template").templatedArray;t.exports={domain:o({name:"parcoords",trace:true,editType:"plot"}),labelangle:{valType:"angle",dflt:0,editType:"plot"},labelside:{valType:"enumerated",values:["top","bottom"],dflt:"top",editType:"plot"},labelfont:i({editType:"plot"}),tickfont:i({editType:"plot"}),rangefont:i({editType:"plot"}),dimensions:l("dimension",{label:{valType:"string",editType:"plot"},tickvals:s({},n.tickvals,{editType:"plot"}),ticktext:s({},n.ticktext,{editType:"plot"}),tickformat:s({},n.tickformat,{editType:"plot"}),visible:{valType:"boolean",dflt:true,editType:"plot"},range:{valType:"info_array",items:[{valType:"number",editType:"plot"},{valType:"number",editType:"plot"}],editType:"plot"},constraintrange:{valType:"info_array",freeLength:true,dimensions:"1-2",items:[{valType:"any",editType:"plot"},{valType:"any",editType:"plot"}],editType:"plot"},multiselect:{valType:"boolean",dflt:true,editType:"plot"},values:{valType:"data_array",editType:"calc"},editType:"calc"}),line:s({editType:"calc"},a("line",{colorscaleDflt:"Viridis",autoColorDflt:false,editTypeOverride:"calc"}))}},{"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../plot_api/plot_template":827,"../../plots/cartesian/layout_attributes":853,"../../plots/domain":866,"../../plots/font_attributes":867}],1165:[function(e,t,r){"use strict";var a=e("./constants");var n=e("@plotly/d3");var i=e("../../lib/gup").keyFun;var o=e("../../lib/gup").repeat;var s=e("../../lib").sorterAsc;var l=e("../../lib").strTranslate;var u=a.bar.snapRatio;function c(e,t){return e*(1-u)+t*u}var f=a.bar.snapClose;function h(e,t){return e*(1-f)+t*f}function p(e,t,r,a){if(v(r,a))return r;var n=e?-1:1;var i=0;var o=t.length-1;if(n<0){var s=i;i=o;o=s}var l=t[i];var u=l;for(var f=i;n*f<n*o;f+=n){var p=f+n;var d=t[p];if(n*r<n*h(l,d))return c(l,u);if(n*r<n*d||p===o)return c(d,l);u=l;l=d}}function v(e,t){for(var r=0;r<t.length;r++){if(e>=t[r][0]&&e<=t[r][1])return true}return false}function d(e){e.attr("x",-a.bar.captureWidth/2).attr("width",a.bar.captureWidth)}function m(e){e.attr("visibility","visible").style("visibility","visible").attr("fill","yellow").attr("opacity",0)}function g(e){if(!e.brush.filterSpecified){return"0,"+e.height}var t=y(e.brush.filter.getConsolidated(),e.height);var r=[0];var a,n,i;var o=t.length?t[0][0]:null;for(var s=0;s<t.length;s++){a=t[s];n=a[1]-a[0];r.push(o);r.push(n);i=s+1;if(i<t.length){o=t[i][0]-a[1]}}r.push(e.height);return r}function y(e,t){return e.map((function(e){return e.map((function(e){return Math.max(0,e*t)})).sort(s)}))}function x(e,t){var r=a.bar.handleHeight;if(t>e[1]+r||t<e[0]-r)return;if(t>=.9*e[1]+.1*e[0])return"n";if(t<=.9*e[0]+.1*e[1])return"s";return"ns"}function b(){n.select(document.body).style("cursor",null)}function _(e){e.attr("stroke-dasharray",g)}function w(e,t){var r=n.select(e).selectAll(".highlight, .highlight-shadow");var i=t?r.transition().duration(a.bar.snapDuration).each("end",t):r;_(i)}function T(e,t){var r=e.brush;var a=r.filterSpecified;var n=NaN;var i={};var o;if(a){var s=e.height;var l=r.filter.getConsolidated();var u=y(l,s);var c=NaN;var f=NaN;var h=NaN;for(o=0;o<=u.length;o++){var p=u[o];if(p&&p[0]<=t&&t<=p[1]){c=o;break}else{f=o?o-1:NaN;if(p&&p[0]>t){h=o;break}}}n=c;if(isNaN(n)){if(isNaN(f)||isNaN(h)){n=isNaN(f)?h:f}else{n=t-u[f][1]<u[h][0]-t?f:h}}if(!isNaN(n)){var v=u[n];var d=x(v,t);if(d){i.interval=l[n];i.intervalPix=v;i.region=d}}}if(e.ordinal&&!i.region){var m=e.unitTickvals;var g=e.unitToPaddedPx.invert(t);for(o=0;o<m.length;o++){var b=[m[Math.max(o-1,0)]*.25+m[o]*.75,m[Math.min(o+1,m.length-1)]*.25+m[o]*.75];if(g>=b[0]&&g<=b[1]){i.clickableOrdinalRange=b;break}}}return i}function k(e,t){n.event.sourceEvent.stopPropagation();var r=t.height-n.mouse(e)[1]-2*a.verticalPadding;var i=t.unitToPaddedPx.invert(r);var o=t.brush;var s=T(t,r);var l=s.interval;var u=o.svgBrush;u.wasDragged=false;u.grabbingBar=s.region==="ns";if(u.grabbingBar){var c=l.map(t.unitToPaddedPx);u.grabPoint=r-c[0]-a.verticalPadding;u.barLength=c[1]-c[0]}u.clickableOrdinalRange=s.clickableOrdinalRange;u.stayingIntervals=t.multiselect&&o.filterSpecified?o.filter.getConsolidated():[];if(l){u.stayingIntervals=u.stayingIntervals.filter((function(e){return e[0]!==l[0]&&e[1]!==l[1]}))}u.startExtent=s.region?l[s.region==="s"?1:0]:i;t.parent.inBrushDrag=true;u.brushStartCallback()}function M(e,t){n.event.sourceEvent.stopPropagation();var r=t.height-n.mouse(e)[1]-2*a.verticalPadding;var i=t.brush.svgBrush;i.wasDragged=true;i._dragging=true;if(i.grabbingBar){i.newExtent=[r-i.grabPoint,r+i.barLength-i.grabPoint].map(t.unitToPaddedPx.invert)}else{i.newExtent=[i.startExtent,t.unitToPaddedPx.invert(r)].sort(s)}t.brush.filterSpecified=true;i.extent=i.stayingIntervals.concat([i.newExtent]);i.brushCallback(t);w(e.parentNode)}function A(e,t){var r=t.brush;var a=r.filter;var i=r.svgBrush;if(!i._dragging){S(e,t);M(e,t);t.brush.svgBrush.wasDragged=false}i._dragging=false;var o=n.event;o.sourceEvent.stopPropagation();var s=i.grabbingBar;i.grabbingBar=false;i.grabLocation=undefined;t.parent.inBrushDrag=false;b();if(!i.wasDragged){i.wasDragged=undefined;if(i.clickableOrdinalRange){if(r.filterSpecified&&t.multiselect){i.extent.push(i.clickableOrdinalRange)}else{i.extent=[i.clickableOrdinalRange];r.filterSpecified=true}}else if(s){i.extent=i.stayingIntervals;if(i.extent.length===0){O(r)}}else{O(r)}i.brushCallback(t);w(e.parentNode);i.brushEndCallback(r.filterSpecified?a.getConsolidated():[]);return}var l=function(){a.set(a.getConsolidated())};if(t.ordinal){var u=t.unitTickvals;if(u[u.length-1]<u[0])u.reverse();i.newExtent=[p(0,u,i.newExtent[0],i.stayingIntervals),p(1,u,i.newExtent[1],i.stayingIntervals)];var c=i.newExtent[1]>i.newExtent[0];i.extent=i.stayingIntervals.concat(c?[i.newExtent]:[]);if(!i.extent.length){O(r)}i.brushCallback(t);if(c){w(e.parentNode,l)}else{l();w(e.parentNode)}}else{l()}i.brushEndCallback(r.filterSpecified?a.getConsolidated():[])}function S(e,t){var r=t.height-n.mouse(e)[1]-2*a.verticalPadding;var i=T(t,r);var o="crosshair";if(i.clickableOrdinalRange)o="pointer";else if(i.region)o=i.region+"-resize";n.select(document.body).style("cursor",o)}function E(e){e.on("mousemove",(function(e){n.event.preventDefault();if(!e.parent.inBrushDrag)S(this,e)})).on("mouseleave",(function(e){if(!e.parent.inBrushDrag)b()})).call(n.behavior.drag().on("dragstart",(function(e){k(this,e)})).on("drag",(function(e){M(this,e)})).on("dragend",(function(e){A(this,e)})))}function L(e,t){return e[0]-t[0]}function C(e,t){var r=e.selectAll(".background").data(o);r.enter().append("rect").classed("background",true).call(d).call(m).style("pointer-events","auto").attr("transform",l(0,a.verticalPadding));r.call(E).attr("height",(function(e){return e.height-a.verticalPadding}));var n=e.selectAll(".highlight-shadow").data(o);n.enter().append("line").classed("highlight-shadow",true).attr("x",-a.bar.width/2).attr("stroke-width",a.bar.width+a.bar.strokeWidth).attr("stroke",t).attr("opacity",a.bar.strokeOpacity).attr("stroke-linecap","butt");n.attr("y1",(function(e){return e.height})).call(_);var i=e.selectAll(".highlight").data(o);i.enter().append("line").classed("highlight",true).attr("x",-a.bar.width/2).attr("stroke-width",a.bar.width-a.bar.strokeWidth).attr("stroke",a.bar.fillColor).attr("opacity",a.bar.fillOpacity).attr("stroke-linecap","butt");i.attr("y1",(function(e){return e.height})).call(_)}function I(e,t){var r=e.selectAll("."+a.cn.axisBrush).data(o,i);r.enter().append("g").classed(a.cn.axisBrush,true);C(r,t)}function P(e){return e.svgBrush.extent.map((function(e){return e.slice()}))}function O(e){e.filterSpecified=false;e.svgBrush.extent=[[-Infinity,Infinity]]}function z(e){return function t(r){var a=r.brush;var n=P(a);var i=n.slice();a.filter.set(i);e()}}function D(e){var t=e.slice();var r=[];var a;var n=t.shift();while(n){a=n.slice();while((n=t.shift())&&n[0]<=a[1]){a[1]=Math.max(a[1],n[1])}r.push(a)}if(r.length===1&&r[0][0]>r[0][1]){r=[]}return r}function R(){var e=[];var t;var r;return{set:function(a){e=a.map((function(e){return e.slice().sort(s)})).sort(L);if(e.length===1&&e[0][0]===-Infinity&&e[0][1]===Infinity){e=[[0,-1]]}t=D(e);r=e.reduce((function(e,t){return[Math.min(e[0],t[0]),Math.max(e[1],t[1])]}),[Infinity,-Infinity])},get:function(){return e.slice()},getConsolidated:function(){return t},getBounds:function(){return r}}}function F(e,t,r,a,n,i){var o=R();o.set(r);return{filter:o,filterSpecified:t,svgBrush:{extent:[],brushStartCallback:a,brushCallback:z(n),brushEndCallback:i}}}function B(e,t){if(Array.isArray(e[0])){e=e.map((function(e){return e.sort(s)}));if(!t.multiselect)e=[e[0]];else e=D(e.sort(L))}else e=[e.sort(s)];if(t.tickvals){var r=t.tickvals.slice().sort(s);e=e.map((function(e){var t=[p(0,r,e[0],[]),p(1,r,e[1],[])];if(t[1]>t[0])return t})).filter((function(e){return e}));if(!e.length)return}return e.length>1?e:e[0]}t.exports={makeBrush:F,ensureAxisBrush:I,cleanRanges:B}},{"../../lib":787,"../../lib/gup":784,"./constants":1168,"@plotly/d3":58}],1166:[function(e,t,r){"use strict";var a=e("@plotly/d3");var n=e("../../plots/get_data").getModuleCalcData;var i=e("./plot");var o=e("../../constants/xmlns_namespaces");r.name="parcoords";r.plot=function(e){var t=n(e.calcdata,"parcoords")[0];if(t.length)i(e,t)};r.clean=function(e,t,r,a){var n=a._has&&a._has("parcoords");var i=t._has&&t._has("parcoords");if(n&&!i){a._paperdiv.selectAll(".parcoords").remove();a._glimages.selectAll("*").remove()}};r.toSVG=function(e){var t=e._fullLayout._glimages;var r=a.select(e).selectAll(".svg-container");var n=r.filter((function(e,t){return t===r.size()-1})).selectAll(".gl-canvas-context, .gl-canvas-focus");function i(){var e=this;var r=e.toDataURL("image/png");var a=t.append("svg:image");a.attr({xmlns:o.svg,"xlink:href":r,preserveAspectRatio:"none",x:0,y:0,width:e.style.width,height:e.style.height})}n.each(i);window.setTimeout((function(){a.selectAll("#filterBarPattern").attr("id","filterBarPattern")}),60)}},{"../../constants/xmlns_namespaces":764,"../../plots/get_data":875,"./plot":1175,"@plotly/d3":58}],1167:[function(e,t,r){"use strict";var a=e("../../lib").isArrayOrTypedArray;var n=e("../../components/colorscale");var i=e("../../lib/gup").wrap;t.exports=function e(t,r){var s;var l;if(n.hasColorscale(r,"line")&&a(r.line.color)){s=r.line.color;l=n.extractOpts(r.line).colorscale;n.calc(t,r,{vals:s,containerStr:"line",cLetter:"c"})}else{s=o(r._length);l=[[0,r.line.color],[1,r.line.color]]}return i({lineColor:s,cscale:l})};function o(e){var t=new Array(e);for(var r=0;r<e;r++){t[r]=.5}return t}},{"../../components/colorscale":662,"../../lib":787,"../../lib/gup":784}],1168:[function(e,t,r){"use strict";t.exports={maxDimensionCount:60,overdrag:45,verticalPadding:2,tickDistance:50,canvasPixelRatio:1,blockLineCount:5e3,layers:["contextLineLayer","focusLineLayer","pickLineLayer"],axisTitleOffset:28,axisExtentOffset:10,deselectedLineColor:"#777",bar:{width:4,captureWidth:10,fillColor:"magenta",fillOpacity:1,snapDuration:150,snapRatio:.25,snapClose:.01,strokeOpacity:1,strokeWidth:1,handleHeight:8,handleOpacity:1,handleOverlap:0},cn:{axisExtentText:"axis-extent-text",parcoordsLineLayers:"parcoords-line-layers",parcoordsLineLayer:"parcoords-lines",parcoords:"parcoords",parcoordsControlView:"parcoords-control-view",yAxis:"y-axis",axisOverlays:"axis-overlays",axis:"axis",axisHeading:"axis-heading",axisTitle:"axis-title",axisExtent:"axis-extent",axisExtentTop:"axis-extent-top",axisExtentTopText:"axis-extent-top-text",axisExtentBottom:"axis-extent-bottom",axisExtentBottomText:"axis-extent-bottom-text",axisBrush:"axis-brush"},id:{filterBarPattern:"filter-bar-pattern"}}},{}],1169:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("../../components/colorscale/helpers").hasColorscale;var i=e("../../components/colorscale/defaults");var o=e("../../plots/domain").defaults;var s=e("../../plots/array_container_defaults");var l=e("../../plots/cartesian/axes");var u=e("./attributes");var c=e("./axisbrush");var f=e("./constants").maxDimensionCount;var h=e("./merge_length");function p(e,t,r,o,s){var l=s("line.color",r);if(n(e,"line")&&a.isArrayOrTypedArray(l)){if(l.length){s("line.colorscale");i(e,t,o,s,{prefix:"line.",cLetter:"c"});return l.length}else{t.line.color=r}}return Infinity}function v(e,t,r,n){function i(r,n){return a.coerce(e,t,u.dimensions,r,n)}var o=i("values");var s=i("visible");if(!(o&&o.length)){s=t.visible=false}if(s){i("label");i("tickvals");i("ticktext");i("tickformat");var f=i("range");t._ax={_id:"y",type:"linear",showexponent:"all",exponentformat:"B",range:f};l.setConvert(t._ax,n.layout);i("multiselect");var h=i("constraintrange");if(h){t.constraintrange=c.cleanRanges(h,t)}}}t.exports=function e(t,r,n,i){function l(e,n){return a.coerce(t,r,u,e,n)}var c=t.dimensions;if(Array.isArray(c)&&c.length>f){a.log("parcoords traces support up to "+f+" dimensions at the moment");c.splice(f)}var d=s(t,r,{name:"dimensions",layout:i,handleItemDefaults:v});var m=p(t,r,n,i,l);o(r,i,l);if(!Array.isArray(d)||!d.length){r.visible=false}h(r,d,"values",m);var g={family:i.font.family,size:Math.round(i.font.size/1.2),color:i.font.color};a.coerceFont(l,"labelfont",g);a.coerceFont(l,"tickfont",g);a.coerceFont(l,"rangefont",g);l("labelangle");l("labelside")}},{"../../components/colorscale/defaults":660,"../../components/colorscale/helpers":661,"../../lib":787,"../../plots/array_container_defaults":833,"../../plots/cartesian/axes":838,"../../plots/domain":866,"./attributes":1164,"./axisbrush":1165,"./constants":1168,"./merge_length":1173}],1170:[function(e,t,r){"use strict";var a=e("../../lib").isTypedArray;r.convertTypedArray=function(e){return a(e)?Array.prototype.slice.call(e):e};r.isOrdinal=function(e){return!!e.tickvals};r.isVisible=function(e){return e.visible||!("visible"in e)}},{"../../lib":787}],1171:[function(e,t,r){"use strict";t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),calc:e("./calc"),plot:e("./plot"),colorbar:{container:"line",min:"cmin",max:"cmax"},moduleType:"trace",name:"parcoords",basePlotModule:e("./base_plot"),categories:["gl","regl","noOpacity","noHover"],meta:{}}},{"./attributes":1164,"./base_plot":1166,"./calc":1167,"./defaults":1169,"./plot":1175}],1172:[function(e,t,r){"use strict";var a=e("glslify");var n=a(["precision highp float;\n#define GLSLIFY 1\n\nvarying vec4 fragColor;\n\nattribute vec4 p01_04, p05_08, p09_12, p13_16,\n               p17_20, p21_24, p25_28, p29_32,\n               p33_36, p37_40, p41_44, p45_48,\n               p49_52, p53_56, p57_60, colors;\n\nuniform mat4 dim0A, dim1A, dim0B, dim1B, dim0C, dim1C, dim0D, dim1D,\n             loA, hiA, loB, hiB, loC, hiC, loD, hiD;\n\nuniform vec2 resolution, viewBoxPos, viewBoxSize;\nuniform float maskHeight;\nuniform float drwLayer; // 0: context, 1: focus, 2: pick\nuniform vec4 contextColor;\nuniform sampler2D maskTexture, palette;\n\nbool isPick    = (drwLayer > 1.5);\nbool isContext = (drwLayer < 0.5);\n\nconst vec4 ZEROS = vec4(0.0, 0.0, 0.0, 0.0);\nconst vec4 UNITS = vec4(1.0, 1.0, 1.0, 1.0);\n\nfloat val(mat4 p, mat4 v) {\n    return dot(matrixCompMult(p, v) * UNITS, UNITS);\n}\n\nfloat axisY(float ratio, mat4 A, mat4 B, mat4 C, mat4 D) {\n    float y1 = val(A, dim0A) + val(B, dim0B) + val(C, dim0C) + val(D, dim0D);\n    float y2 = val(A, dim1A) + val(B, dim1B) + val(C, dim1C) + val(D, dim1D);\n    return y1 * (1.0 - ratio) + y2 * ratio;\n}\n\nint iMod(int a, int b) {\n    return a - b * (a / b);\n}\n\nbool fOutside(float p, float lo, float hi) {\n    return (lo < hi) && (lo > p || p > hi);\n}\n\nbool vOutside(vec4 p, vec4 lo, vec4 hi) {\n    return (\n        fOutside(p[0], lo[0], hi[0]) ||\n        fOutside(p[1], lo[1], hi[1]) ||\n        fOutside(p[2], lo[2], hi[2]) ||\n        fOutside(p[3], lo[3], hi[3])\n    );\n}\n\nbool mOutside(mat4 p, mat4 lo, mat4 hi) {\n    return (\n        vOutside(p[0], lo[0], hi[0]) ||\n        vOutside(p[1], lo[1], hi[1]) ||\n        vOutside(p[2], lo[2], hi[2]) ||\n        vOutside(p[3], lo[3], hi[3])\n    );\n}\n\nbool outsideBoundingBox(mat4 A, mat4 B, mat4 C, mat4 D) {\n    return mOutside(A, loA, hiA) ||\n           mOutside(B, loB, hiB) ||\n           mOutside(C, loC, hiC) ||\n           mOutside(D, loD, hiD);\n}\n\nbool outsideRasterMask(mat4 A, mat4 B, mat4 C, mat4 D) {\n    mat4 pnts[4];\n    pnts[0] = A;\n    pnts[1] = B;\n    pnts[2] = C;\n    pnts[3] = D;\n\n    for(int i = 0; i < 4; ++i) {\n        for(int j = 0; j < 4; ++j) {\n            for(int k = 0; k < 4; ++k) {\n                if(0 == iMod(\n                    int(255.0 * texture2D(maskTexture,\n                        vec2(\n                            (float(i * 2 + j / 2) + 0.5) / 8.0,\n                            (pnts[i][j][k] * (maskHeight - 1.0) + 1.0) / maskHeight\n                        ))[3]\n                    ) / int(pow(2.0, float(iMod(j * 4 + k, 8)))),\n                    2\n                )) return true;\n            }\n        }\n    }\n    return false;\n}\n\nvec4 position(bool isContext, float v, mat4 A, mat4 B, mat4 C, mat4 D) {\n    float x = 0.5 * sign(v) + 0.5;\n    float y = axisY(x, A, B, C, D);\n    float z = 1.0 - abs(v);\n\n    z += isContext ? 0.0 : 2.0 * float(\n        outsideBoundingBox(A, B, C, D) ||\n        outsideRasterMask(A, B, C, D)\n    );\n\n    return vec4(\n        2.0 * (vec2(x, y) * viewBoxSize + viewBoxPos) / resolution - 1.0,\n        z,\n        1.0\n    );\n}\n\nvoid main() {\n    mat4 A = mat4(p01_04, p05_08, p09_12, p13_16);\n    mat4 B = mat4(p17_20, p21_24, p25_28, p29_32);\n    mat4 C = mat4(p33_36, p37_40, p41_44, p45_48);\n    mat4 D = mat4(p49_52, p53_56, p57_60, ZEROS);\n\n    float v = colors[3];\n\n    gl_Position = position(isContext, v, A, B, C, D);\n\n    fragColor =\n        isContext ? vec4(contextColor) :\n        isPick ? vec4(colors.rgb, 1.0) : texture2D(palette, vec2(abs(v), 0.5));\n}\n"]);var i=a(["precision highp float;\n#define GLSLIFY 1\n\nvarying vec4 fragColor;\n\nvoid main() {\n    gl_FragColor = fragColor;\n}\n"]);var o=e("./constants").maxDimensionCount;var s=e("../../lib");var l=1e-6;var u=2048;var c=new Uint8Array(4);var f=new Uint8Array(4);var h={shape:[256,1],format:"rgba",type:"uint8",mag:"nearest",min:"nearest"};function p(e){e.read({x:0,y:0,width:1,height:1,data:c})}function v(e,t,r,a,n){var i=e._gl;i.enable(i.SCISSOR_TEST);i.scissor(t,r,a,n);e.clear({color:[0,0,0,0],depth:1})}function d(e,t,r,a,n,i){var o=i.key;function s(l){var u=Math.min(a,n-l*a);if(l===0){window.cancelAnimationFrame(r.currentRafs[o]);delete r.currentRafs[o];v(e,i.scissorX,i.scissorY,i.scissorWidth,i.viewBoxSize[1])}if(r.clearOnly){return}i.count=2*u;i.offset=2*l*a;t(i);if(l*a+u<n){r.currentRafs[o]=window.requestAnimationFrame((function(){s(l+1)}))}r.drawCompleted=false}if(!r.drawCompleted){p(e);r.drawCompleted=true}s(0)}function m(e){return Math.max(l,Math.min(1-l,e))}function g(e,t){var r=new Array(256);for(var a=0;a<256;a++){r[a]=e(a/255).concat(t)}return r}function y(e,t){return(e>>>8*t)%256/255}function x(e,t,r){var a=new Array(e*(o+4));var n=0;for(var i=0;i<e;i++){for(var s=0;s<o;s++){a[n++]=s<t.length?t[s].paddedUnitValues[i]:.5}a[n++]=y(i,2);a[n++]=y(i,1);a[n++]=y(i,0);a[n++]=m(r[i])}return a}function b(e,t,r){var a=new Array(t*8);var n=0;for(var i=0;i<t;i++){for(var o=0;o<2;o++){for(var s=0;s<4;s++){var l=e*4+s;var u=r[i*64+l];if(l===63&&o===0){u*=-1}a[n++]=u}}}return a}function _(e){var t="0"+e;return t.substr(t.length-2)}function w(e){return e<o?"p"+_(e+1)+"_"+_(e+4):"colors"}function T(e,t,r){for(var a=0;a<=o;a+=4){e[w(a)](b(a/4,t,r))}}function k(e){var t={};for(var r=0;r<=o;r+=4){t[w(r)]=e.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)})}return t}function M(e,t,r,a,n,i,o,l,u,c,f,h,p,v){var d=[[],[]];for(var m=0;m<64;m++){d[0][m]=m===n?1:0;d[1][m]=m===i?1:0}o*=v;l*=v;u*=v;c*=v;var g=e.lines.canvasOverdrag*v;var y=e.domain;var x=e.canvasWidth*v;var b=e.canvasHeight*v;var _=e.pad.l*v;var w=e.pad.b*v;var T=e.layoutHeight*v;var k=e.layoutWidth*v;var M=e.deselectedLines.color;var A=s.extendFlat({key:f,resolution:[x,b],viewBoxPos:[o+g,l],viewBoxSize:[u,c],i0:n,i1:i,dim0A:d[0].slice(0,16),dim0B:d[0].slice(16,32),dim0C:d[0].slice(32,48),dim0D:d[0].slice(48,64),dim1A:d[1].slice(0,16),dim1B:d[1].slice(16,32),dim1C:d[1].slice(32,48),dim1D:d[1].slice(48,64),drwLayer:h,contextColor:[M[0]/255,M[1]/255,M[2]/255,M[3]<1?M[3]:Math.max(1/255,Math.pow(1/e.lines.color.length,1/3))],scissorX:(a===t?0:o+g)+(_-g)+k*y.x[0],scissorWidth:(a===r?x-o+g:u+.5)+(a===t?o+g:0),scissorY:l+w+T*y.y[0],scissorHeight:c,viewportX:_-g+k*y.x[0],viewportY:w+T*y.y[0],viewportWidth:x,viewportHeight:b},p);return A}function A(e){var t=u-1;var r=Math.max(0,Math.floor(e[0]*t),0);var a=Math.min(t,Math.ceil(e[1]*t),t);return[Math.min(r,a),Math.max(r,a)]}t.exports=function(e,t){var r=t.context;var a=t.pick;var o=t.regl;var l=o._gl;var c=l.getParameter(l.ALIASED_LINE_WIDTH_RANGE);var p=Math.max(c[0],Math.min(c[1],t.viewModel.plotGlPixelRatio));var m={currentRafs:{},drawCompleted:true,clearOnly:false};var y;var b;var _;var w;var S=k(o);var E;var L=o.texture(h);var C=[];P(t);var I=o({profile:false,blend:{enable:r,func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:1,dstAlpha:1},equation:{rgb:"add",alpha:"add"},color:[0,0,0,0]},depth:{enable:!r,mask:true,func:"less",range:[0,1]},cull:{enable:true,face:"back"},scissor:{enable:true,box:{x:o.prop("scissorX"),y:o.prop("scissorY"),width:o.prop("scissorWidth"),height:o.prop("scissorHeight")}},viewport:{x:o.prop("viewportX"),y:o.prop("viewportY"),width:o.prop("viewportWidth"),height:o.prop("viewportHeight")},dither:false,vert:n,frag:i,primitive:"lines",lineWidth:p,attributes:S,uniforms:{resolution:o.prop("resolution"),viewBoxPos:o.prop("viewBoxPos"),viewBoxSize:o.prop("viewBoxSize"),dim0A:o.prop("dim0A"),dim1A:o.prop("dim1A"),dim0B:o.prop("dim0B"),dim1B:o.prop("dim1B"),dim0C:o.prop("dim0C"),dim1C:o.prop("dim1C"),dim0D:o.prop("dim0D"),dim1D:o.prop("dim1D"),loA:o.prop("loA"),hiA:o.prop("hiA"),loB:o.prop("loB"),hiB:o.prop("hiB"),loC:o.prop("loC"),hiC:o.prop("hiC"),loD:o.prop("loD"),hiD:o.prop("hiD"),palette:L,contextColor:o.prop("contextColor"),maskTexture:o.prop("maskTexture"),drwLayer:o.prop("drwLayer"),maskHeight:o.prop("maskHeight")},offset:o.prop("offset"),count:o.prop("count")});function P(e){y=e.model;b=e.viewModel;_=b.dimensions.slice();w=_[0]?_[0].values.length:0;var t=y.lines;var n=a?t.color.map((function(e,r){return r/t.color.length})):t.color;var i=x(w,_,n);T(S,w,i);if(!r&&!a){L=o.texture(s.extendFlat({data:g(y.unitToColor,255)},h))}}function O(e){var t,r,a;var n=[[],[]];for(a=0;a<64;a++){var i=!e&&a<_.length?_[a].brush.filter.getBounds():[-Infinity,Infinity];n[0][a]=i[0];n[1][a]=i[1]}var s=u*8;var l=new Array(s);for(t=0;t<s;t++){l[t]=255}if(!e){for(t=0;t<_.length;t++){var c=t%8;var f=(t-c)/8;var h=Math.pow(2,c);var p=_[t];var v=p.brush.filter.get();if(v.length<2)continue;var d=A(v[0])[1];for(r=1;r<v.length;r++){var m=A(v[r]);for(a=d+1;a<m[0];a++){l[a*8+f]&=~h}d=Math.max(d,m[1])}}}var g={shape:[8,u],format:"alpha",type:"uint8",mag:"nearest",min:"nearest",data:l};if(E)E(g);else E=o.texture(g);return{maskTexture:E,maskHeight:u,loA:n[0].slice(0,16),loB:n[0].slice(16,32),loC:n[0].slice(32,48),loD:n[0].slice(48,64),hiA:n[1].slice(0,16),hiB:n[1].slice(16,32),hiC:n[1].slice(32,48),hiD:n[1].slice(48,64)}}function z(e,t,n){var i=e.length;var s;var l;var u;var c=Infinity;var f=-Infinity;for(s=0;s<i;s++){if(e[s].dim0.canvasX<c){c=e[s].dim0.canvasX;l=s}if(e[s].dim1.canvasX>f){f=e[s].dim1.canvasX;u=s}}if(i===0){v(o,0,0,y.canvasWidth,y.canvasHeight)}var h=O(r);for(s=0;s<i;s++){var p=e[s];var g=p.dim0.crossfilterDimensionIndex;var x=p.dim1.crossfilterDimensionIndex;var b=p.canvasX;var _=p.canvasY;var T=b+p.panelSizeX;var k=p.plotGlPixelRatio;if(t||!C[g]||C[g][0]!==b||C[g][1]!==T){C[g]=[b,T];var A=M(y,l,u,s,g,x,b,_,p.panelSizeX,p.panelSizeY,p.dim0.crossfilterDimensionIndex,r?0:a?2:1,h,k);m.clearOnly=n;var S=t?y.lines.blockLineCount:w;d(o,I,m,S,w,A)}}}function D(e,t){o.read({x:e,y:t,width:1,height:1,data:f});return f}function R(e,t,r,a){var n=new Uint8Array(4*r*a);o.read({x:e,y:t,width:r,height:a,data:n});return n}function F(){e.style["pointer-events"]="none";L.destroy();if(E)E.destroy();for(var t in S)S[t].destroy()}return{render:z,readPixel:D,readPixels:R,destroy:F,update:P}}},{"../../lib":787,"./constants":1168,glslify:434}],1173:[function(e,t,r){"use strict";t.exports=function(e,t,r,a){if(!a)a=Infinity;var n,i;for(n=0;n<t.length;n++){i=t[n];if(i.visible)a=Math.min(a,i[r].length)}if(a===Infinity)a=0;e._length=a;for(n=0;n<t.length;n++){i=t[n];if(i.visible)i._length=a}return a}},{}],1174:[function(e,t,r){"use strict";var a=e("@plotly/d3");var n=e("../../lib");var i=n.numberFormat;var o=e("color-rgba");var s=e("../../plots/cartesian/axes");var l=n.strRotate;var u=n.strTranslate;var c=e("../../lib/svg_text_utils");var f=e("../../components/drawing");var h=e("../../components/colorscale");var p=e("../../lib/gup");var v=p.keyFun;var d=p.repeat;var m=p.unwrap;var g=e("./helpers");var y=e("./constants");var x=e("./axisbrush");var b=e("./lines");function _(e,t,r){return n.aggNums(e,null,t,r)}function w(e,t){return k(_(Math.min,e,t),_(Math.max,e,t))}function T(e){var t=e.range;return t?k(t[0],t[1]):w(e.values,e._length)}function k(e,t){if(isNaN(e)||!isFinite(e)){e=0}if(isNaN(t)||!isFinite(t)){t=0}if(e===t){if(e===0){e-=1;t+=1}else{e*=.9;t*=1.1}}return[e,t]}function M(e,t){if(t){return function(r,a){var n=t[a];if(n===null||n===undefined)return e(r);return n}}return e}function A(e,t,r,n,o){var s=T(r);if(n){return a.scale.ordinal().domain(n.map(M(i(r.tickformat),o))).range(n.map((function(r){var a=(r-s[0])/(s[1]-s[0]);return e-t+a*(2*t-e)})))}return a.scale.linear().domain(s).range([e-t,t])}function S(e,t){return a.scale.linear().range([t,e-t])}function E(e,t){return a.scale.linear().domain(T(e)).range([t,1-t])}function L(e){if(!e.tickvals)return;var t=T(e);return a.scale.ordinal().domain(e.tickvals).range(e.tickvals.map((function(e){return(e-t[0])/(t[1]-t[0])})))}function C(e){var t=e.map((function(e){return e[0]}));var r=e.map((function(e){var t=o(e[1]);return a.rgb("rgb("+t[0]+","+t[1]+","+t[2]+")")}));var n=function(e){return function(t){return t[e]}};var i="rgb".split("").map((function(e){return a.scale.linear().clamp(true).domain(t).range(r.map(n(e)))}));return function(e){return i.map((function(t){return t(e)}))}}function I(e){return e.dimensions.some((function(e){return e.brush.filterSpecified}))}function P(e,t,r){var i=m(t);var s=i.trace;var l=g.convertTypedArray(i.lineColor);var u=s.line;var c={color:o(y.deselectedLineColor)};var f=h.extractOpts(u);var p=f.reversescale?h.flipScale(i.cscale):i.cscale;var v=s.domain;var d=s.dimensions;var x=e.width;var b=s.labelangle;var _=s.labelside;var w=s.labelfont;var k=s.tickfont;var M=s.rangefont;var A=n.extendDeepNoArrays({},u,{color:l.map(a.scale.linear().domain(T({values:l,range:[f.min,f.max],_length:s._length}))),blockLineCount:y.blockLineCount,canvasOverdrag:y.overdrag*y.canvasPixelRatio});var S=Math.floor(x*(v.x[1]-v.x[0]));var E=Math.floor(e.height*(v.y[1]-v.y[0]));var L=e.margin||{l:80,r:80,t:100,b:80};var I=S;var P=E;return{key:r,colCount:d.filter(g.isVisible).length,dimensions:d,tickDistance:y.tickDistance,unitToColor:C(p),lines:A,deselectedLines:c,labelAngle:b,labelSide:_,labelFont:w,tickFont:k,rangeFont:M,layoutWidth:x,layoutHeight:e.height,domain:v,translateX:v.x[0]*x,translateY:e.height-v.y[1]*e.height,pad:L,canvasWidth:I*y.canvasPixelRatio+2*A.canvasOverdrag,canvasHeight:P*y.canvasPixelRatio,width:I,height:P,canvasPixelRatio:y.canvasPixelRatio}}function O(e,t,r){var a=r.width;var o=r.height;var s=r.dimensions;var l=r.canvasPixelRatio;var u=function(e){return a*e/Math.max(1,r.colCount-1)};var c=y.verticalPadding/o;var f=S(o,y.verticalPadding);var h={key:r.key,xScale:u,model:r,inBrushDrag:false};var p={};h.dimensions=s.filter(g.isVisible).map((function(a,s){var v=E(a,c);var d=p[a.label];p[a.label]=(d||0)+1;var m=a.label+(d?"__"+d:"");var b=a.constraintrange;var _=b&&b.length;if(_&&!Array.isArray(b[0])){b=[b]}var w=_?b.map((function(e){return e.map(v)})):[[-Infinity,Infinity]];var T=function(){var t=h;t.focusLayer&&t.focusLayer.render(t.panels,true);var r=I(t);if(!e.contextShown()&&r){t.contextLayer&&t.contextLayer.render(t.panels,true);e.contextShown(true)}else if(e.contextShown()&&!r){t.contextLayer&&t.contextLayer.render(t.panels,true,true);e.contextShown(false)}};var k=a.values;if(k.length>a._length){k=k.slice(0,a._length)}var M=a.tickvals;var S;function C(e,t){return{val:e,text:S[t]}}function P(e,t){return e.val-t.val}if(Array.isArray(M)&&M.length){S=a.ticktext;if(!Array.isArray(S)||!S.length){S=M.map(i(a.tickformat))}else if(S.length>M.length){S=S.slice(0,M.length)}else if(M.length>S.length){M=M.slice(0,S.length)}for(var O=1;O<M.length;O++){if(M[O]<M[O-1]){var z=M.map(C).sort(P);for(var D=0;D<M.length;D++){M[D]=z[D].val;S[D]=z[D].text}break}}}else M=undefined;k=g.convertTypedArray(k);return{key:m,label:a.label,tickFormat:a.tickformat,tickvals:M,ticktext:S,ordinal:g.isOrdinal(a),multiselect:a.multiselect,xIndex:s,crossfilterDimensionIndex:s,visibleIndex:a._index,height:o,values:k,paddedUnitValues:k.map(v),unitTickvals:M&&M.map(v),xScale:u,x:u(s),canvasX:u(s)*l,unitToPaddedPx:f,domainScale:A(o,y.verticalPadding,a,M,S),ordinalScale:L(a),parent:h,model:r,brush:x.makeBrush(e,_,w,(function(){e.linePickActive(false)}),T,(function(r){h.focusLayer.render(h.panels,true);h.pickLayer&&h.pickLayer.render(h.panels,true);e.linePickActive(true);if(t&&t.filterChanged){var i=v.invert;var o=r.map((function(e){return e.map(i).sort(n.sorterAsc)})).sort((function(e,t){return e[0]-t[0]}));t.filterChanged(h.key,a._index,o)}}))}}));return h}function z(e){e.classed(y.cn.axisExtentText,true).attr("text-anchor","middle").style("cursor","default")}function D(){var e=true;var t=false;return{linePickActive:function(t){return arguments.length?e=!!t:e},contextShown:function(e){return arguments.length?t=!!e:t}}}function R(e,t){var r=t==="top"?1:-1;var a=e*Math.PI/180;var n=Math.sin(a);var i=Math.cos(a);return{dir:r,dx:n,dy:i,degrees:e}}function F(e,t,r){var a=t.panels||(t.panels=[]);var n=e.data();for(var i=0;i<n.length-1;i++){var o=a[i]||(a[i]={});var s=n[i];var l=n[i+1];o.dim0=s;o.dim1=l;o.canvasX=s.canvasX;o.panelSizeX=l.canvasX-s.canvasX;o.panelSizeY=t.model.canvasHeight;o.y=0;o.canvasY=0;o.plotGlPixelRatio=r}}function B(e){for(var t=0;t<e.length;t++){for(var r=0;r<e[t].length;r++){var a=e[t][r].trace;var n=a.dimensions;for(var i=0;i<n.length;i++){var o=n[i].values;var l=n[i]._ax;if(l){if(!l.range){l.range=w(o,a._length)}else{l.range=k(l.range[0],l.range[1])}if(!l.dtick){l.dtick=.01*(Math.abs(l.range[1]-l.range[0])||1)}l.tickformat=n[i].tickformat;s.calcTicks(l);l.cleanRange()}}}}}function N(e,t){return s.tickText(e._ax,t,false).text}function j(e,t){if(e.ordinal)return"";var r=e.domainScale.domain();var a=r[t?r.length-1:0];return N(e.model.dimensions[e.visibleIndex],a)}t.exports=function e(t,r,i,o){var s=t._fullLayout;var h=s._toppaper;var p=s._glcontainer;var _=t._context.plotGlPixelRatio;var w=t._fullLayout.paper_bgcolor;B(r);var T=D();var k=r.filter((function(e){return m(e).trace.visible})).map(P.bind(0,i)).map(O.bind(0,T,o));p.each((function(e,t){return n.extendFlat(e,k[t])}));var M=p.selectAll(".gl-canvas").each((function(e){e.viewModel=k[0];e.viewModel.plotGlPixelRatio=_;e.viewModel.paperColor=w;e.model=e.viewModel?e.viewModel.model:null}));var A=null;var S=M.filter((function(e){return e.pick}));S.style("pointer-events","auto").on("mousemove",(function(e){if(T.linePickActive()&&e.lineLayer&&o&&o.hover){var t=a.event;var r=this.width;var n=this.height;var i=a.mouse(this);var s=i[0];var l=i[1];if(s<0||l<0||s>=r||l>=n){return}var u=e.lineLayer.readPixel(s,n-1-l);var c=u[3]!==0;var f=c?u[2]+256*(u[1]+256*u[0]):null;var h={x:s,y:l,clientX:t.clientX,clientY:t.clientY,dataIndex:e.model.key,curveNumber:f};if(f!==A){if(c){o.hover(h)}else if(o.unhover){o.unhover(h)}A=f}}}));M.style("opacity",(function(e){return e.pick?0:1}));h.style("background","rgba(255, 255, 255, 0)");var E=h.selectAll("."+y.cn.parcoords).data(k,v);E.exit().remove();E.enter().append("g").classed(y.cn.parcoords,true).style("shape-rendering","crispEdges").style("pointer-events","none");E.attr("transform",(function(e){return u(e.model.translateX,e.model.translateY)}));var L=E.selectAll("."+y.cn.parcoordsControlView).data(d,v);L.enter().append("g").classed(y.cn.parcoordsControlView,true);L.attr("transform",(function(e){return u(e.model.pad.l,e.model.pad.t)}));var C=L.selectAll("."+y.cn.yAxis).data((function(e){return e.dimensions}),v);C.enter().append("g").classed(y.cn.yAxis,true);L.each((function(e){F(C,e,_)}));M.each((function(e){if(e.viewModel){if(!e.lineLayer||o){e.lineLayer=b(this,e)}else e.lineLayer.update(e);if(e.key||e.key===0)e.viewModel[e.key]=e.lineLayer;var t=!e.context||o;e.lineLayer.render(e.viewModel.panels,t)}}));C.attr("transform",(function(e){return u(e.xScale(e.xIndex),0)}));C.call(a.behavior.drag().origin((function(e){return e})).on("drag",(function(e){var t=e.parent;T.linePickActive(false);e.x=Math.max(-y.overdrag,Math.min(e.model.width+y.overdrag,a.event.x));e.canvasX=e.x*e.model.canvasPixelRatio;C.sort((function(e,t){return e.x-t.x})).each((function(t,r){t.xIndex=r;t.x=e===t?t.x:t.xScale(t.xIndex);t.canvasX=t.x*t.model.canvasPixelRatio}));F(C,t,_);C.filter((function(t){return Math.abs(e.xIndex-t.xIndex)!==0})).attr("transform",(function(e){return u(e.xScale(e.xIndex),0)}));a.select(this).attr("transform",u(e.x,0));C.each((function(r,a,n){if(n===e.parent.key)t.dimensions[a]=r}));t.contextLayer&&t.contextLayer.render(t.panels,false,!I(t));t.focusLayer.render&&t.focusLayer.render(t.panels)})).on("dragend",(function(e){var t=e.parent;e.x=e.xScale(e.xIndex);e.canvasX=e.x*e.model.canvasPixelRatio;F(C,t,_);a.select(this).attr("transform",(function(e){return u(e.x,0)}));t.contextLayer&&t.contextLayer.render(t.panels,false,!I(t));t.focusLayer&&t.focusLayer.render(t.panels);t.pickLayer&&t.pickLayer.render(t.panels,true);T.linePickActive(true);if(o&&o.axesMoved){o.axesMoved(t.key,t.dimensions.map((function(e){return e.crossfilterDimensionIndex})))}})));C.exit().remove();var U=C.selectAll("."+y.cn.axisOverlays).data(d,v);U.enter().append("g").classed(y.cn.axisOverlays,true);U.selectAll("."+y.cn.axis).remove();var V=U.selectAll("."+y.cn.axis).data(d,v);V.enter().append("g").classed(y.cn.axis,true);V.each((function(e){var t=e.model.height/e.model.tickDistance;var r=e.domainScale;var n=r.domain();a.select(this).call(a.svg.axis().orient("left").tickSize(4).outerTickSize(2).ticks(t,e.tickFormat).tickValues(e.ordinal?n:null).tickFormat((function(t){return g.isOrdinal(e)?t:N(e.model.dimensions[e.visibleIndex],t)})).scale(r));f.font(V.selectAll("text"),e.model.tickFont)}));V.selectAll(".domain, .tick>line").attr("fill","none").attr("stroke","black").attr("stroke-opacity",.25).attr("stroke-width","1px");V.selectAll("text").style("text-shadow",c.makeTextShadow(w)).style("cursor","default");var H=U.selectAll("."+y.cn.axisHeading).data(d,v);H.enter().append("g").classed(y.cn.axisHeading,true);var q=H.selectAll("."+y.cn.axisTitle).data(d,v);q.enter().append("text").classed(y.cn.axisTitle,true).attr("text-anchor","middle").style("cursor","ew-resize").style("pointer-events","auto");q.text((function(e){return e.label})).each((function(e){var r=a.select(this);f.font(r,e.model.labelFont);c.convertToTspans(r,t)})).attr("transform",(function(e){var t=R(e.model.labelAngle,e.model.labelSide);var r=y.axisTitleOffset;return(t.dir>0?"":u(0,2*r+e.model.height))+l(t.degrees)+u(-r*t.dx,-r*t.dy)})).attr("text-anchor",(function(e){var t=R(e.model.labelAngle,e.model.labelSide);var r=Math.abs(t.dx);var a=Math.abs(t.dy);if(2*r>a){return t.dir*t.dx<0?"start":"end"}else{return"middle"}}));var G=U.selectAll("."+y.cn.axisExtent).data(d,v);G.enter().append("g").classed(y.cn.axisExtent,true);var Y=G.selectAll("."+y.cn.axisExtentTop).data(d,v);Y.enter().append("g").classed(y.cn.axisExtentTop,true);Y.attr("transform",u(0,-y.axisExtentOffset));var W=Y.selectAll("."+y.cn.axisExtentTopText).data(d,v);W.enter().append("text").classed(y.cn.axisExtentTopText,true).call(z);W.text((function(e){return j(e,true)})).each((function(e){f.font(a.select(this),e.model.rangeFont)}));var X=G.selectAll("."+y.cn.axisExtentBottom).data(d,v);X.enter().append("g").classed(y.cn.axisExtentBottom,true);X.attr("transform",(function(e){return u(0,e.model.height+y.axisExtentOffset)}));var Z=X.selectAll("."+y.cn.axisExtentBottomText).data(d,v);Z.enter().append("text").classed(y.cn.axisExtentBottomText,true).attr("dy","0.75em").call(z);Z.text((function(e){return j(e,false)})).each((function(e){f.font(a.select(this),e.model.rangeFont)}));x.ensureAxisBrush(U,w)}},{"../../components/colorscale":662,"../../components/drawing":672,"../../lib":787,"../../lib/gup":784,"../../lib/svg_text_utils":813,"../../plots/cartesian/axes":838,"./axisbrush":1165,"./constants":1168,"./helpers":1170,"./lines":1172,"@plotly/d3":58,"color-rgba":133}],1175:[function(e,t,r){"use strict";var a=e("./parcoords");var n=e("../../lib/prepare_regl");var i=e("./helpers").isVisible;function o(e,t,r){var a=t.indexOf(r);var n=e.indexOf(a);if(n===-1){n+=t.length}return n}function s(e,t){return function r(a,n){return o(e,t,a)-o(e,t,n)}}t.exports=function e(t,r){var o=t._fullLayout;var l=n(t);if(!l)return;var u={};var c={};var f={};var h={};var p=o._size;r.forEach((function(e,r){var a=e[0].trace;f[r]=a.index;var n=h[r]=a._fullInput.index;u[r]=t.data[n].dimensions;c[r]=t.data[n].dimensions.slice()}));var v=function(e,r,a){var n=c[e][r];var i=a.map((function(e){return e.slice()}));var s="dimensions["+r+"].constraintrange";var l=o._tracePreGUI[t._fullData[f[e]]._fullInput.uid];if(l[s]===undefined){var u=n.constraintrange;l[s]=u||null}var p=t._fullData[f[e]].dimensions[r];if(!i.length){delete n.constraintrange;delete p.constraintrange;i=null}else{if(i.length===1)i=i[0];n.constraintrange=i;p.constraintrange=i.slice();i=[i]}var v={};v[s]=i;t.emit("plotly_restyle",[v,[h[e]]])};var d=function(e){t.emit("plotly_hover",e)};var m=function(e){t.emit("plotly_unhover",e)};var g=function(e,r){var a=s(r,c[e].filter(i));u[e].sort(a);c[e].filter((function(e){return!i(e)})).sort((function(t){return c[e].indexOf(t)})).forEach((function(t){u[e].splice(u[e].indexOf(t),1);u[e].splice(c[e].indexOf(t),0,t)}));t.emit("plotly_restyle",[{dimensions:[u[e]]},[h[e]]])};a(t,r,{width:p.w,height:p.h,margin:{t:p.t,r:p.r,b:p.b,l:p.l}},{filterChanged:v,hover:d,unhover:m,axesMoved:g})}},{"../../lib/prepare_regl":800,"./helpers":1170,"./parcoords":1174}],1176:[function(e,t,r){"use strict";var a=e("../../plots/attributes");var n=e("../../plots/domain").attributes;var i=e("../../plots/font_attributes");var o=e("../../components/color/attributes");var s=e("../../plots/template_attributes").hovertemplateAttrs;var l=e("../../plots/template_attributes").texttemplateAttrs;var u=e("../../lib/extend").extendFlat;var c=i({editType:"plot",arrayOk:true,colorEditType:"plot"});t.exports={labels:{valType:"data_array",editType:"calc"},label0:{valType:"number",dflt:0,editType:"calc"},dlabel:{valType:"number",dflt:1,editType:"calc"},values:{valType:"data_array",editType:"calc"},marker:{colors:{valType:"data_array",editType:"calc"},line:{color:{valType:"color",dflt:o.defaultLine,arrayOk:true,editType:"style"},width:{valType:"number",min:0,dflt:0,arrayOk:true,editType:"style"},editType:"calc"},editType:"calc"},text:{valType:"data_array",editType:"plot"},hovertext:{valType:"string",dflt:"",arrayOk:true,editType:"style"},scalegroup:{valType:"string",dflt:"",editType:"calc"},textinfo:{valType:"flaglist",flags:["label","text","value","percent"],extras:["none"],editType:"calc"},hoverinfo:u({},a.hoverinfo,{flags:["label","text","value","percent","name"]}),hovertemplate:s({},{keys:["label","color","value","percent","text"]}),texttemplate:l({editType:"plot"},{keys:["label","color","value","percent","text"]}),textposition:{valType:"enumerated",values:["inside","outside","auto","none"],dflt:"auto",arrayOk:true,editType:"plot"},textfont:u({},c,{}),insidetextorientation:{valType:"enumerated",values:["horizontal","radial","tangential","auto"],dflt:"auto",editType:"plot"},insidetextfont:u({},c,{}),outsidetextfont:u({},c,{}),automargin:{valType:"boolean",dflt:false,editType:"plot"},title:{text:{valType:"string",dflt:"",editType:"plot"},font:u({},c,{}),position:{valType:"enumerated",values:["top left","top center","top right","middle center","bottom left","bottom center","bottom right"],editType:"plot"},editType:"plot"},domain:n({name:"pie",trace:true,editType:"calc"}),hole:{valType:"number",min:0,max:1,dflt:0,editType:"calc"},sort:{valType:"boolean",dflt:true,editType:"calc"},direction:{valType:"enumerated",values:["clockwise","counterclockwise"],dflt:"counterclockwise",editType:"calc"},rotation:{valType:"number",min:-360,max:360,dflt:0,editType:"calc"},pull:{valType:"number",min:0,max:1,dflt:0,arrayOk:true,editType:"calc"},_deprecated:{title:{valType:"string",dflt:"",editType:"calc"},titlefont:u({},c,{}),titleposition:{valType:"enumerated",values:["top left","top center","top right","middle center","bottom left","bottom center","bottom right"],editType:"calc"}}}},{"../../components/color/attributes":649,"../../lib/extend":777,"../../plots/attributes":834,"../../plots/domain":866,"../../plots/font_attributes":867,"../../plots/template_attributes":910}],1177:[function(e,t,r){"use strict";var a=e("../../plots/plots");r.name="pie";r.plot=function(e,t,n,i){a.plotBasePlot(r.name,e,t,n,i)};r.clean=function(e,t,n,i){a.cleanBasePlot(r.name,e,t,n,i)}},{"../../plots/plots":901}],1178:[function(e,t,r){"use strict";var a=e("fast-isnumeric");var n=e("tinycolor2");var i=e("../../components/color");var o={};function s(e,t){var r=[];var n=e._fullLayout;var i=n.hiddenlabels||[];var o=t.labels;var s=t.marker.colors||[];var u=t.values;var c=t._length;var f=t._hasValues&&c;var h,p;if(t.dlabel){o=new Array(c);for(h=0;h<c;h++){o[h]=String(t.label0+h*t.dlabel)}}var v={};var d=l(n["_"+t.type+"colormap"]);var m=0;var g=false;for(h=0;h<c;h++){var y,x,b;if(f){y=u[h];if(!a(y))continue;y=+y;if(y<0)continue}else y=1;x=o[h];if(x===undefined||x==="")x=h;x=String(x);var _=v[x];if(_===undefined){v[x]=r.length;b=i.indexOf(x)!==-1;if(!b)m+=y;r.push({v:y,label:x,color:d(s[h],x),i:h,pts:[h],hidden:b})}else{g=true;p=r[_];p.v+=y;p.pts.push(h);if(!p.hidden)m+=y;if(p.color===false&&s[h]){p.color=d(s[h],x)}}}var w=t.type==="funnelarea"?g:t.sort;if(w)r.sort((function(e,t){return t.v-e.v}));if(r[0])r[0].vTotal=m;return r}function l(e){return function t(r,a){if(!r)return false;r=n(r);if(!r.isValid())return false;r=i.addOpacity(r,r.getAlpha());if(!e[a])e[a]=r;return r}}function u(e,t){var r=(t||{}).type;if(!r)r="pie";var a=e._fullLayout;var n=e.calcdata;var i=a[r+"colorway"];var s=a["_"+r+"colormap"];if(a["extend"+r+"colors"]){i=c(i,o)}var l=0;for(var u=0;u<n.length;u++){var f=n[u];var h=f[0].trace.type;if(h!==r)continue;for(var p=0;p<f.length;p++){var v=f[p];if(v.color===false){if(s[v.label]){v.color=s[v.label]}else{s[v.label]=v.color=i[l%i.length];l++}}}}}function c(e,t){var r;var a=JSON.stringify(e);var i=t[a];if(!i){i=e.slice();for(r=0;r<e.length;r++){i.push(n(e[r]).lighten(20).toHexString())}for(r=0;r<e.length;r++){i.push(n(e[r]).darken(20).toHexString())}t[a]=i}return i}t.exports={calc:s,crossTraceCalc:u,makePullColorFn:l,generateExtendedColors:c}},{"../../components/color":650,"fast-isnumeric":246,tinycolor2:583}],1179:[function(e,t,r){"use strict";var a=e("fast-isnumeric");var n=e("../../lib");var i=e("./attributes");var o=e("../../plots/domain").defaults;var s=e("../bar/defaults").handleText;function l(e,t){var r=Array.isArray(e);var i=n.isArrayOrTypedArray(t);var o=Math.min(r?e.length:Infinity,i?t.length:Infinity);if(!isFinite(o))o=0;if(o&&i){var s;for(var l=0;l<o;l++){var u=t[l];if(a(u)&&u>0){s=true;break}}if(!s)o=0}return{hasLabels:r,hasValues:i,len:o}}function u(e,t,r,a){function u(r,a){return n.coerce(e,t,i,r,a)}var c=u("labels");var f=u("values");var h=l(c,f);var p=h.len;t._hasLabels=h.hasLabels;t._hasValues=h.hasValues;if(!t._hasLabels&&t._hasValues){u("label0");u("dlabel")}if(!p){t.visible=false;return}t._length=p;var v=u("marker.line.width");if(v)u("marker.line.color");u("marker.colors");u("scalegroup");var d=u("text");var m=u("texttemplate");var g;if(!m)g=u("textinfo",Array.isArray(d)?"text+percent":"percent");u("hovertext");u("hovertemplate");if(m||g&&g!=="none"){var y=u("textposition");s(e,t,a,u,y,{moduleHasSelected:false,moduleHasUnselected:false,moduleHasConstrain:false,moduleHasCliponaxis:false,moduleHasTextangle:false,moduleHasInsideanchor:false});var x=Array.isArray(y)||y==="auto";var b=x||y==="outside";if(b){u("automargin")}if(y==="inside"||y==="auto"||Array.isArray(y)){u("insidetextorientation")}}o(t,a,u);var _=u("hole");var w=u("title.text");if(w){var T=u("title.position",_?"middle center":"top center");if(!_&&T==="middle center")t.title.position="top center";n.coerceFont(u,"title.font",a.font)}u("sort");u("direction");u("rotation");u("pull")}t.exports={handleLabelsAndValues:l,supplyDefaults:u}},{"../../lib":787,"../../plots/domain":866,"../bar/defaults":929,"./attributes":1176,"fast-isnumeric":246}],1180:[function(e,t,r){"use strict";var a=e("../../components/fx/helpers").appendArrayMultiPointValues;t.exports=function e(t,r){var n={curveNumber:r.index,pointNumbers:t.pts,data:r._input,fullData:r,label:t.label,color:t.color,value:t.v,percent:t.percent,text:t.text,bbox:t.bbox,v:t.v};if(t.pts.length===1)n.pointNumber=n.i=t.pts[0];a(n,r,t.pts);if(r.type==="funnelarea"){delete n.v;delete n.i}return n}},{"../../components/fx/helpers":686}],1181:[function(e,t,r){"use strict";var a=e("../../lib");function n(e){return e.indexOf("e")!==-1?e.replace(/[.]?0+e/,"e"):e.indexOf(".")!==-1?e.replace(/[.]?0+$/,""):e}r.formatPiePercent=function e(t,r){var i=n((t*100).toPrecision(3));return a.numSeparate(i,r)+"%"};r.formatPieValue=function e(t,r){var i=n(t.toPrecision(10));return a.numSeparate(i,r)};r.getFirstFilled=function e(t,r){if(!Array.isArray(t))return;for(var a=0;a<r.length;a++){var n=t[r[a]];if(n||n===0||n==="")return n}};r.castOption=function e(t,a){if(Array.isArray(t))return r.getFirstFilled(t,a);else if(t)return t};r.getRotationAngle=function(e){return(e==="auto"?0:e)*Math.PI/180}},{"../../lib":787}],1182:[function(e,t,r){"use strict";t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults").supplyDefaults,supplyLayoutDefaults:e("./layout_defaults"),layoutAttributes:e("./layout_attributes"),calc:e("./calc").calc,crossTraceCalc:e("./calc").crossTraceCalc,plot:e("./plot").plot,style:e("./style"),styleOne:e("./style_one"),moduleType:"trace",name:"pie",basePlotModule:e("./base_plot"),categories:["pie-like","pie","showLegend"],meta:{}}},{"./attributes":1176,"./base_plot":1177,"./calc":1178,"./defaults":1179,"./layout_attributes":1183,"./layout_defaults":1184,"./plot":1185,"./style":1186,"./style_one":1187}],1183:[function(e,t,r){"use strict";t.exports={hiddenlabels:{valType:"data_array",editType:"calc"},piecolorway:{valType:"colorlist",editType:"calc"},extendpiecolors:{valType:"boolean",dflt:true,editType:"calc"}}},{}],1184:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("./layout_attributes");t.exports=function e(t,r){function i(e,i){return a.coerce(t,r,n,e,i)}i("hiddenlabels");i("piecolorway",r.colorway);i("extendpiecolors")}},{"../../lib":787,"./layout_attributes":1183}],1185:[function(e,t,r){"use strict";var a=e("@plotly/d3");var n=e("../../plots/plots");var i=e("../../components/fx");var o=e("../../components/color");var s=e("../../components/drawing");var l=e("../../lib");var u=l.strScale;var c=l.strTranslate;var f=e("../../lib/svg_text_utils");var h=e("../bar/uniform_text");var p=h.recordMinTextSize;var v=h.clearMinTextSize;var d=e("../bar/constants").TEXTPAD;var m=e("./helpers");var g=e("./event_data");var y=e("../../lib").isValidTextValue;function x(e,t){var r=e._fullLayout;var i=r._size;v("pie",r);k(t,e);j(t,i);var o=l.makeTraceGroups(r._pielayer,t,"trace").each((function(t){var o=a.select(this);var h=t[0];var v=h.trace;V(t);o.attr("stroke-linejoin","round");o.each((function(){var d=a.select(this).selectAll("g.slice").data(t);d.enter().append("g").classed("slice",true);d.exit().remove();var g=[[[],[]],[[],[]]];var y=false;d.each((function(n,i){if(n.hidden){a.select(this).selectAll("path,g").remove();return}n.pointNumber=n.i;n.curveNumber=v.index;g[n.pxmid[1]<0?0:1][n.pxmid[0]<0?0:1].push(n);var o=h.cx;var u=h.cy;var c=a.select(this);var d=c.selectAll("path.surface").data([n]);d.enter().append("path").classed("surface",true).style({"pointer-events":"all"});c.call(_,e,t);if(v.pull){var x=+m.castOption(v.pull,n.pts)||0;if(x>0){o+=x*n.pxmid[0];u+=x*n.pxmid[1]}}n.cxFinal=o;n.cyFinal=u;function b(e,t,r,a){var i=a*(t[0]-e[0]);var o=a*(t[1]-e[1]);return"a"+a*h.r+","+a*h.r+" 0 "+n.largeArc+(r?" 1 ":" 0 ")+i+","+o}var k=v.hole;if(n.v===h.vTotal){var A="M"+(o+n.px0[0])+","+(u+n.px0[1])+b(n.px0,n.pxmid,true,1)+b(n.pxmid,n.px0,true,1)+"Z";if(k){d.attr("d","M"+(o+k*n.px0[0])+","+(u+k*n.px0[1])+b(n.px0,n.pxmid,false,k)+b(n.pxmid,n.px0,false,k)+"Z"+A)}else d.attr("d",A)}else{var S=b(n.px0,n.px1,true,1);if(k){var E=1-k;d.attr("d","M"+(o+k*n.px1[0])+","+(u+k*n.px1[1])+b(n.px1,n.px0,false,k)+"l"+E*n.px0[0]+","+E*n.px0[1]+S+"Z")}else{d.attr("d","M"+o+","+u+"l"+n.px0[0]+","+n.px0[1]+S+"Z")}}q(e,n,h);var L=m.castOption(v.textposition,n.pts);var C=c.selectAll("g.slicetext").data(n.text&&L!=="none"?[0]:[]);C.enter().append("g").classed("slicetext",true);C.exit().remove();C.each((function(){var c=l.ensureSingle(a.select(this),"text","",(function(e){e.attr("data-notex",1)}));var d=l.ensureUniformFontSize(e,L==="outside"?w(v,n,r.font):T(v,n,r.font));c.text(n.text).attr({class:"slicetext",transform:"","text-anchor":"middle"}).call(s.font,d).call(f.convertToTspans,e);var m=s.bBox(c.node());var g;if(L==="outside"){g=O(m,n)}else{g=M(m,n,h);if(L==="auto"&&g.scale<1){var x=l.ensureUniformFontSize(e,v.outsidetextfont);c.call(s.font,x);m=s.bBox(c.node());g=O(m,n)}}var b=g.textPosAngle;var _=b===undefined?n.pxmid:H(h.r,b);g.targetX=o+_[0]*g.rCenter+(g.x||0);g.targetY=u+_[1]*g.rCenter+(g.y||0);G(g,m);if(g.outside){var k=g.targetY;n.yLabelMin=k-m.height/2;n.yLabelMid=k;n.yLabelMax=k+m.height/2;n.labelExtraX=0;n.labelExtraY=0;y=true}g.fontSize=d.size;p(v.type,g,r);t[i].transform=g;c.attr("transform",l.getTextTransform(g))}))}));var x=a.select(this).selectAll("g.titletext").data(v.title.text?[0]:[]);x.enter().append("g").classed("titletext",true);x.exit().remove();x.each((function(){var t=l.ensureSingle(a.select(this),"text","",(function(e){e.attr("data-notex",1)}));var r=v.title.text;if(v._meta){r=l.templateString(r,v._meta)}t.text(r).attr({class:"titletext",transform:"","text-anchor":"middle"}).call(s.font,v.title.font).call(f.convertToTspans,e);var n;if(v.title.position==="middle center"){n=z(h)}else{n=D(h,i)}t.attr("transform",c(n.x,n.y)+u(Math.min(1,n.scale))+c(n.tx,n.ty))}));if(y)N(g,v);b(d,v);if(y&&v.automargin){var k=s.bBox(o.node());var A=v.domain;var S=i.w*(A.x[1]-A.x[0]);var E=i.h*(A.y[1]-A.y[0]);var L=(.5*S-h.r)/i.w;var C=(.5*E-h.r)/i.h;n.autoMargin(e,"pie."+v.uid+".automargin",{xl:A.x[0]-L,xr:A.x[1]+L,yb:A.y[0]-C,yt:A.y[1]+C,l:Math.max(h.cx-h.r-k.left,0),r:Math.max(k.right-(h.cx+h.r),0),b:Math.max(k.bottom-(h.cy+h.r),0),t:Math.max(h.cy-h.r-k.top,0),pad:5})}}))}));setTimeout((function(){o.selectAll("tspan").each((function(){var e=a.select(this);if(e.attr("dy"))e.attr("dy",e.attr("dy"))}))}),0)}function b(e,t){e.each((function(e){var r=a.select(this);if(!e.labelExtraX&&!e.labelExtraY){r.select("path.textline").remove();return}var n=r.select("g.slicetext text");e.transform.targetX+=e.labelExtraX;e.transform.targetY+=e.labelExtraY;n.attr("transform",l.getTextTransform(e.transform));var i=e.cxFinal+e.pxmid[0];var s=e.cyFinal+e.pxmid[1];var u="M"+i+","+s;var c=(e.yLabelMax-e.yLabelMin)*(e.pxmid[0]<0?-1:1)/4;if(e.labelExtraX){var f=e.labelExtraX*e.pxmid[1]/e.pxmid[0];var h=e.yLabelMid+e.labelExtraY-(e.cyFinal+e.pxmid[1]);if(Math.abs(f)>Math.abs(h)){u+="l"+h*e.pxmid[0]/e.pxmid[1]+","+h+"H"+(i+e.labelExtraX+c)}else{u+="l"+e.labelExtraX+","+f+"v"+(h-f)+"h"+c}}else{u+="V"+(e.yLabelMid+e.labelExtraY)+"h"+c}l.ensureSingle(r,"path","textline").call(o.stroke,t.outsidetextfont.color).attr({"stroke-width":Math.min(2,t.outsidetextfont.size/8),d:u,fill:"none"})}))}function _(e,t,r){var n=r[0];var o=n.cx;var s=n.cy;var u=n.trace;var c=u.type==="funnelarea";if(!("_hasHoverLabel"in u))u._hasHoverLabel=false;if(!("_hasHoverEvent"in u))u._hasHoverEvent=false;e.on("mouseover",(function(e){var r=t._fullLayout;var f=t._fullData[u.index];if(t._dragging||r.hovermode===false)return;var h=f.hoverinfo;if(Array.isArray(h)){h=i.castHoverinfo({hoverinfo:[m.castOption(h,e.pts)],_module:u._module},r,0)}if(h==="all")h="label+text+value+percent+name";if(f.hovertemplate||h!=="none"&&h!=="skip"&&h){var p=e.rInscribed||0;var v=o+e.pxmid[0]*(1-p);var d=s+e.pxmid[1]*(1-p);var y=r.separators;var x=[];if(h&&h.indexOf("label")!==-1)x.push(e.label);e.text=m.castOption(f.hovertext||f.text,e.pts);if(h&&h.indexOf("text")!==-1){var b=e.text;if(l.isValidTextValue(b))x.push(b)}e.value=e.v;e.valueLabel=m.formatPieValue(e.v,y);if(h&&h.indexOf("value")!==-1)x.push(e.valueLabel);e.percent=e.v/n.vTotal;e.percentLabel=m.formatPiePercent(e.percent,y);if(h&&h.indexOf("percent")!==-1)x.push(e.percentLabel);var _=f.hoverlabel;var w=_.font;var T=[];i.loneHover({trace:u,x0:v-p*n.r,x1:v+p*n.r,y:d,_x0:c?o+e.TL[0]:v-p*n.r,_x1:c?o+e.TR[0]:v+p*n.r,_y0:c?s+e.TL[1]:d-p*n.r,_y1:c?s+e.BL[1]:d+p*n.r,text:x.join("<br>"),name:f.hovertemplate||h.indexOf("name")!==-1?f.name:undefined,idealAlign:e.pxmid[0]<0?"left":"right",color:m.castOption(_.bgcolor,e.pts)||e.color,borderColor:m.castOption(_.bordercolor,e.pts),fontFamily:m.castOption(w.family,e.pts),fontSize:m.castOption(w.size,e.pts),fontColor:m.castOption(w.color,e.pts),nameLength:m.castOption(_.namelength,e.pts),textAlign:m.castOption(_.align,e.pts),hovertemplate:m.castOption(f.hovertemplate,e.pts),hovertemplateLabels:e,eventData:[g(e,f)]},{container:r._hoverlayer.node(),outerContainer:r._paper.node(),gd:t,inOut_bbox:T});e.bbox=T[0];u._hasHoverLabel=true}u._hasHoverEvent=true;t.emit("plotly_hover",{points:[g(e,f)],event:a.event})}));e.on("mouseout",(function(e){var r=t._fullLayout;var n=t._fullData[u.index];var o=a.select(this).datum();if(u._hasHoverEvent){e.originalEvent=a.event;t.emit("plotly_unhover",{points:[g(o,n)],event:a.event});u._hasHoverEvent=false}if(u._hasHoverLabel){i.loneUnhover(r._hoverlayer.node());u._hasHoverLabel=false}}));e.on("click",(function(e){var r=t._fullLayout;var n=t._fullData[u.index];if(t._dragging||r.hovermode===false)return;t._hoverdata=[g(e,n)];i.click(t,a.event)}))}function w(e,t,r){var a=m.castOption(e.outsidetextfont.color,t.pts)||m.castOption(e.textfont.color,t.pts)||r.color;var n=m.castOption(e.outsidetextfont.family,t.pts)||m.castOption(e.textfont.family,t.pts)||r.family;var i=m.castOption(e.outsidetextfont.size,t.pts)||m.castOption(e.textfont.size,t.pts)||r.size;return{color:a,family:n,size:i}}function T(e,t,r){var a=m.castOption(e.insidetextfont.color,t.pts);if(!a&&e._input.textfont){a=m.castOption(e._input.textfont.color,t.pts)}var n=m.castOption(e.insidetextfont.family,t.pts)||m.castOption(e.textfont.family,t.pts)||r.family;var i=m.castOption(e.insidetextfont.size,t.pts)||m.castOption(e.textfont.size,t.pts)||r.size;return{color:a||o.contrast(t.color),family:n,size:i}}function k(e,t){var r,a;for(var n=0;n<e.length;n++){r=e[n][0];a=r.trace;if(a.title.text){var i=a.title.text;if(a._meta){i=l.templateString(i,a._meta)}var o=s.tester.append("text").attr("data-notex",1).text(i).call(s.font,a.title.font).call(f.convertToTspans,t);var u=s.bBox(o.node(),true);r.titleBox={width:u.width,height:u.height};o.remove()}}}function M(e,t,r){var a=r.r||t.rpx1;var n=t.rInscribed;var i=t.startangle===t.stopangle;if(i){return{rCenter:1-n,scale:0,rotate:0,textPosAngle:0}}var o=t.ring;var s=o===1&&Math.abs(t.startangle-t.stopangle)===Math.PI*2;var l=t.halfangle;var u=t.midangle;var c=r.trace.insidetextorientation;var f=c==="horizontal";var h=c==="tangential";var p=c==="radial";var v=c==="auto";var d=[];var m;if(!v){var g=function(r,n){if(A(t,r)){var i=Math.abs(r-t.startangle);var s=Math.abs(r-t.stopangle);var l=i<s?i:s;if(n==="tan"){m=E(e,a,o,l,0)}else{m=S(e,a,o,l,Math.PI/2)}m.textPosAngle=r;d.push(m)}};var y;if(f||h){for(y=4;y>=-4;y-=2)g(Math.PI*y,"tan");for(y=4;y>=-4;y-=2)g(Math.PI*(y+1),"tan")}if(f||p){for(y=4;y>=-4;y-=2)g(Math.PI*(y+1.5),"rad");for(y=4;y>=-4;y-=2)g(Math.PI*(y+.5),"rad")}}if(s||v||f){var x=Math.sqrt(e.width*e.width+e.height*e.height);m={scale:n*a*2/x,rCenter:1-n,rotate:0};m.textPosAngle=(t.startangle+t.stopangle)/2;if(m.scale>=1)return m;d.push(m)}if(v||p){m=S(e,a,o,l,u);m.textPosAngle=(t.startangle+t.stopangle)/2;d.push(m)}if(v||h){m=E(e,a,o,l,u);m.textPosAngle=(t.startangle+t.stopangle)/2;d.push(m)}var b=0;var _=0;for(var w=0;w<d.length;w++){var T=d[w].scale;if(_<T){_=T;b=w}if(!v&&_>=1){break}}return d[b]}function A(e,t){var r=e.startangle;var a=e.stopangle;return r>t&&t>a||r<t&&t<a}function S(e,t,r,a,n){t=Math.max(0,t-2*d);var i=e.width/e.height;var o=I(i,a,t,r);return{scale:o*2/e.height,rCenter:L(i,o/t),rotate:C(n)}}function E(e,t,r,a,n){t=Math.max(0,t-2*d);var i=e.height/e.width;var o=I(i,a,t,r);return{scale:o*2/e.width,rCenter:L(i,o/t),rotate:C(n+Math.PI/2)}}function L(e,t){return Math.cos(t)-e*t}function C(e){return(180/Math.PI*e+720)%180-90}function I(e,t,r,a){var n=e+1/(2*Math.tan(t));return r*Math.min(1/(Math.sqrt(n*n+.5)+n),a/(Math.sqrt(e*e+a/2)+e))}function P(e,t){if(e.v===t.vTotal&&!t.trace.hole)return 1;return Math.min(1/(1+1/Math.sin(e.halfangle)),e.ring/2)}function O(e,t){var r=t.pxmid[0];var a=t.pxmid[1];var n=e.width/2;var i=e.height/2;if(r<0)n*=-1;if(a<0)i*=-1;return{scale:1,rCenter:1,rotate:0,x:n+Math.abs(i)*(n>0?1:-1)/2,y:i/(1+r*r/(a*a)),outside:true}}function z(e){var t=Math.sqrt(e.titleBox.width*e.titleBox.width+e.titleBox.height*e.titleBox.height);return{x:e.cx,y:e.cy,scale:e.trace.hole*e.r*2/t,tx:0,ty:-e.titleBox.height/2+e.trace.title.font.size}}function D(e,t){var r=1;var a=1;var n;var i=e.trace;var o={x:e.cx,y:e.cy};var s={tx:0,ty:0};s.ty+=i.title.font.size;n=B(i);if(i.title.position.indexOf("top")!==-1){o.y-=(1+n)*e.r;s.ty-=e.titleBox.height}else if(i.title.position.indexOf("bottom")!==-1){o.y+=(1+n)*e.r}var l=R(e.r,e.trace.aspectratio);var u=t.w*(i.domain.x[1]-i.domain.x[0])/2;if(i.title.position.indexOf("left")!==-1){u=u+l;o.x-=(1+n)*l;s.tx+=e.titleBox.width/2}else if(i.title.position.indexOf("center")!==-1){u*=2}else if(i.title.position.indexOf("right")!==-1){u=u+l;o.x+=(1+n)*l;s.tx-=e.titleBox.width/2}r=u/e.titleBox.width;a=F(e,t)/e.titleBox.height;return{x:o.x,y:o.y,scale:Math.min(r,a),tx:s.tx,ty:s.ty}}function R(e,t){return e/(t===undefined?1:t)}function F(e,t){var r=e.trace;var a=t.h*(r.domain.y[1]-r.domain.y[0]);return Math.min(e.titleBox.height,a/2)}function B(e){var t=e.pull;if(!t)return 0;var r;if(Array.isArray(t)){t=0;for(r=0;r<e.pull.length;r++){if(e.pull[r]>t)t=e.pull[r]}}return t}function N(e,t){var r,a,n,i,o,s,l,u,c,f,h,p,v;function d(e,t){return e.pxmid[1]-t.pxmid[1]}function g(e,t){return t.pxmid[1]-e.pxmid[1]}function y(e,r){if(!r)r={};var n=r.labelExtraY+(a?r.yLabelMax:r.yLabelMin);var u=a?e.yLabelMin:e.yLabelMax;var c=a?e.yLabelMax:e.yLabelMin;var h=e.cyFinal+o(e.px0[1],e.px1[1]);var p=n-u;var v,d,g,y,x,b;if(p*l>0)e.labelExtraY=p;if(!Array.isArray(t.pull))return;for(d=0;d<f.length;d++){g=f[d];if(g===e||(m.castOption(t.pull,e.pts)||0)>=(m.castOption(t.pull,g.pts)||0)){continue}if((e.pxmid[1]-g.pxmid[1])*l>0){y=g.cyFinal+o(g.px0[1],g.px1[1]);p=y-u-e.labelExtraY;if(p*l>0)e.labelExtraY+=p}else if((c+e.labelExtraY-h)*l>0){v=3*s*Math.abs(d-f.indexOf(e));x=g.cxFinal+i(g.px0[0],g.px1[0]);b=x+v-(e.cxFinal+e.pxmid[0])-e.labelExtraX;if(b*s>0)e.labelExtraX+=b}}}for(a=0;a<2;a++){n=a?d:g;o=a?Math.max:Math.min;l=a?1:-1;for(r=0;r<2;r++){i=r?Math.max:Math.min;s=r?1:-1;u=e[a][r];u.sort(n);c=e[1-a][r];f=c.concat(u);p=[];for(h=0;h<u.length;h++){if(u[h].yLabelMid!==undefined)p.push(u[h])}v=false;for(h=0;a&&h<c.length;h++){if(c[h].yLabelMid!==undefined){v=c[h];break}}for(h=0;h<p.length;h++){var x=h&&p[h-1];if(v&&!h)x=v;y(p[h],x)}}}}function j(e,t){var r=[];for(var a=0;a<e.length;a++){var n=e[a][0];var i=n.trace;var o=i.domain;var s=t.w*(o.x[1]-o.x[0]);var l=t.h*(o.y[1]-o.y[0]);if(i.title.text&&i.title.position!=="middle center"){l-=F(n,t)}var u=s/2;var c=l/2;if(i.type==="funnelarea"&&!i.scalegroup){c/=i.aspectratio}n.r=Math.min(u,c)/(1+B(i));n.cx=t.l+t.w*(i.domain.x[1]+i.domain.x[0])/2;n.cy=t.t+t.h*(1-i.domain.y[0])-l/2;if(i.title.text&&i.title.position.indexOf("bottom")!==-1){n.cy-=F(n,t)}if(i.scalegroup&&r.indexOf(i.scalegroup)===-1){r.push(i.scalegroup)}}U(e,r)}function U(e,t){var r,a,n;for(var i=0;i<t.length;i++){var o=Infinity;var s=t[i];for(a=0;a<e.length;a++){r=e[a][0];n=r.trace;if(n.scalegroup===s){var l;if(n.type==="pie"){l=r.r*r.r}else if(n.type==="funnelarea"){var u,c;if(n.aspectratio>1){u=r.r;c=u/n.aspectratio}else{c=r.r;u=c*n.aspectratio}u*=(1+n.baseratio)/2;l=u*c}o=Math.min(o,l/r.vTotal)}}for(a=0;a<e.length;a++){r=e[a][0];n=r.trace;if(n.scalegroup===s){var f=o*r.vTotal;if(n.type==="funnelarea"){f/=(1+n.baseratio)/2;f/=n.aspectratio}r.r=Math.sqrt(f)}}}}function V(e){var t=e[0];var r=t.r;var a=t.trace;var n=m.getRotationAngle(a.rotation);var i=2*Math.PI/t.vTotal;var o="px0";var s="px1";var l,u,c;if(a.direction==="counterclockwise"){for(l=0;l<e.length;l++){if(!e[l].hidden)break}if(l===e.length)return;n+=i*e[l].v;i*=-1;o="px1";s="px0"}c=H(r,n);for(l=0;l<e.length;l++){u=e[l];if(u.hidden)continue;u[o]=c;u.startangle=n;n+=i*u.v/2;u.pxmid=H(r,n);u.midangle=n;n+=i*u.v/2;c=H(r,n);u.stopangle=n;u[s]=c;u.largeArc=u.v>t.vTotal/2?1:0;u.halfangle=Math.PI*Math.min(u.v/t.vTotal,.5);u.ring=1-a.hole;u.rInscribed=P(u,t)}}function H(e,t){return[e*Math.sin(t),-e*Math.cos(t)]}function q(e,t,r){var a=e._fullLayout;var n=r.trace;var i=n.texttemplate;var o=n.textinfo;if(!i&&o&&o!=="none"){var s=o.split("+");var u=function(e){return s.indexOf(e)!==-1};var c=u("label");var f=u("text");var h=u("value");var p=u("percent");var v=a.separators;var d;d=c?[t.label]:[];if(f){var g=m.getFirstFilled(n.text,t.pts);if(y(g))d.push(g)}if(h)d.push(m.formatPieValue(t.v,v));if(p)d.push(m.formatPiePercent(t.v/r.vTotal,v));t.text=d.join("<br>")}function x(e){return{label:e.label,value:e.v,valueLabel:m.formatPieValue(e.v,a.separators),percent:e.v/r.vTotal,percentLabel:m.formatPiePercent(e.v/r.vTotal,a.separators),color:e.color,text:e.text,customdata:l.castOption(n,e.i,"customdata")}}if(i){var b=l.castOption(n,t.i,"texttemplate");if(!b){t.text=""}else{var _=x(t);var w=m.getFirstFilled(n.text,t.pts);if(y(w)||w==="")_.text=w;t.text=l.texttemplateString(b,_,e._fullLayout._d3locale,_,n._meta||{})}}}function G(e,t){var r=e.rotate*Math.PI/180;var a=Math.cos(r);var n=Math.sin(r);var i=(t.left+t.right)/2;var o=(t.top+t.bottom)/2;e.textX=i*a-o*n;e.textY=i*n+o*a;e.noCenter=true}t.exports={plot:x,formatSliceLabel:q,transformInsideText:M,determineInsideTextFont:T,positionTitleOutside:D,prerenderTitles:k,layoutAreas:j,attachFxHandlers:_,computeTransform:G}},{"../../components/color":650,"../../components/drawing":672,"../../components/fx":690,"../../lib":787,"../../lib/svg_text_utils":813,"../../plots/plots":901,"../bar/constants":927,"../bar/uniform_text":941,"./event_data":1180,"./helpers":1181,"@plotly/d3":58}],1186:[function(e,t,r){"use strict";var a=e("@plotly/d3");var n=e("./style_one");var i=e("../bar/uniform_text").resizeText;t.exports=function e(t){var r=t._fullLayout._pielayer.selectAll(".trace");i(t,r,"pie");r.each((function(e){var t=e[0];var r=t.trace;var i=a.select(this);i.style({opacity:r.opacity});i.selectAll("path.surface").each((function(e){a.select(this).call(n,e,r)}))}))}},{"../bar/uniform_text":941,"./style_one":1187,"@plotly/d3":58}],1187:[function(e,t,r){"use strict";var a=e("../../components/color");var n=e("./helpers").castOption;t.exports=function e(t,r,i){var o=i.marker.line;var s=n(o.color,r.pts)||a.defaultLine;var l=n(o.width,r.pts)||0;t.style("stroke-width",l).call(a.fill,r.color).call(a.stroke,s)}},{"../../components/color":650,"./helpers":1181}],1188:[function(e,t,r){"use strict";var a=e("../scatter/attributes");t.exports={x:a.x,y:a.y,xy:{valType:"data_array",editType:"calc"},indices:{valType:"data_array",editType:"calc"},xbounds:{valType:"data_array",editType:"calc"},ybounds:{valType:"data_array",editType:"calc"},text:a.text,marker:{color:{valType:"color",arrayOk:false,editType:"calc"},opacity:{valType:"number",min:0,max:1,dflt:1,arrayOk:false,editType:"calc"},blend:{valType:"boolean",dflt:null,editType:"calc"},sizemin:{valType:"number",min:.1,max:2,dflt:.5,editType:"calc"},sizemax:{valType:"number",min:.1,dflt:20,editType:"calc"},border:{color:{valType:"color",arrayOk:false,editType:"calc"},arearatio:{valType:"number",min:0,max:1,dflt:0,editType:"calc"},editType:"calc"},editType:"calc"},transforms:undefined}},{"../scatter/attributes":1202}],1189:[function(e,t,r){"use strict";var a=e("gl-pointcloud2d");var n=e("../../lib/str2rgbarray");var i=e("../../plots/cartesian/autorange").findExtremes;var o=e("../scatter/get_trace_color");function s(e,t){this.scene=e;this.uid=t;this.type="pointcloud";this.pickXData=[];this.pickYData=[];this.xData=[];this.yData=[];this.textLabels=[];this.color="rgb(0, 0, 0)";this.name="";this.hoverinfo="all";this.idToIndex=new Int32Array(0);this.bounds=[0,0,0,0];this.pointcloudOptions={positions:new Float32Array(0),idToIndex:this.idToIndex,sizemin:.5,sizemax:12,color:[0,0,0,1],areaRatio:1,borderColor:[0,0,0,1]};this.pointcloud=a(e.glplot,this.pointcloudOptions);this.pointcloud._trace=this}var l=s.prototype;l.handlePick=function(e){var t=this.idToIndex[e.pointId];return{trace:this,dataCoord:e.dataCoord,traceCoord:this.pickXYData?[this.pickXYData[t*2],this.pickXYData[t*2+1]]:[this.pickXData[t],this.pickYData[t]],textLabel:Array.isArray(this.textLabels)?this.textLabels[t]:this.textLabels,color:this.color,name:this.name,pointIndex:t,hoverinfo:this.hoverinfo}};l.update=function(e){this.index=e.index;this.textLabels=e.text;this.name=e.name;this.hoverinfo=e.hoverinfo;this.bounds=[Infinity,Infinity,-Infinity,-Infinity];this.updateFast(e);this.color=o(e,{})};l.updateFast=function(e){var t=this.xData=this.pickXData=e.x;var r=this.yData=this.pickYData=e.y;var a=this.pickXYData=e.xy;var o=e.xbounds&&e.ybounds;var s=e.indices;var l;var u;var c;var f=this.bounds;var h,p,v;if(a){c=a;l=a.length>>>1;if(o){f[0]=e.xbounds[0];f[2]=e.xbounds[1];f[1]=e.ybounds[0];f[3]=e.ybounds[1]}else{for(v=0;v<l;v++){h=c[v*2];p=c[v*2+1];if(h<f[0])f[0]=h;if(h>f[2])f[2]=h;if(p<f[1])f[1]=p;if(p>f[3])f[3]=p}}if(s){u=s}else{u=new Int32Array(l);for(v=0;v<l;v++){u[v]=v}}}else{l=t.length;c=new Float32Array(2*l);u=new Int32Array(l);for(v=0;v<l;v++){h=t[v];p=r[v];u[v]=v;c[v*2]=h;c[v*2+1]=p;if(h<f[0])f[0]=h;if(h>f[2])f[2]=h;if(p<f[1])f[1]=p;if(p>f[3])f[3]=p}}this.idToIndex=u;this.pointcloudOptions.idToIndex=u;this.pointcloudOptions.positions=c;var d=n(e.marker.color);var m=n(e.marker.border.color);var g=e.opacity*e.marker.opacity;d[3]*=g;this.pointcloudOptions.color=d;var y=e.marker.blend;if(y===null){var x=100;y=t.length<x||r.length<x}this.pointcloudOptions.blend=y;m[3]*=g;this.pointcloudOptions.borderColor=m;var b=e.marker.sizemin;var _=Math.max(e.marker.sizemax,e.marker.sizemin);this.pointcloudOptions.sizeMin=b;this.pointcloudOptions.sizeMax=_;this.pointcloudOptions.areaRatio=e.marker.border.arearatio;this.pointcloud.update(this.pointcloudOptions);var w=this.scene.xaxis;var T=this.scene.yaxis;var k=_/2||.5;e._extremes[w._id]=i(w,[f[0],f[2]],{ppad:k});e._extremes[T._id]=i(T,[f[1],f[3]],{ppad:k})};l.dispose=function(){this.pointcloud.dispose()};function u(e,t){var r=new s(e,t.uid);r.update(t);return r}t.exports=u},{"../../lib/str2rgbarray":812,"../../plots/cartesian/autorange":837,"../scatter/get_trace_color":1212,"gl-pointcloud2d":321}],1190:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("./attributes");t.exports=function e(t,r,i){function o(e,i){return a.coerce(t,r,n,e,i)}o("x");o("y");o("xbounds");o("ybounds");if(t.xy&&t.xy instanceof Float32Array){r.xy=t.xy}if(t.indices&&t.indices instanceof Int32Array){r.indices=t.indices}o("text");o("marker.color",i);o("marker.opacity");o("marker.blend");o("marker.sizemin");o("marker.sizemax");o("marker.border.color",i);o("marker.border.arearatio");r._length=null}},{"../../lib":787,"./attributes":1188}],1191:[function(e,t,r){"use strict";var a=["*pointcloud* trace is deprecated!","Please consider switching to the *scattergl* trace type."].join(" ");t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),calc:e("../scatter3d/calc"),plot:e("./convert"),moduleType:"trace",name:"pointcloud",basePlotModule:e("../../plots/gl2d"),categories:["gl","gl2d","showLegend"],meta:{}}},{"../../plots/gl2d":878,"../scatter3d/calc":1231,"./attributes":1188,"./convert":1189,"./defaults":1190}],1192:[function(e,t,r){"use strict";var a=e("../../plots/font_attributes");var n=e("../../plots/attributes");var i=e("../../components/color/attributes");var o=e("../../components/fx/attributes");var s=e("../../plots/domain").attributes;var l=e("../../plots/template_attributes").hovertemplateAttrs;var u=e("../../components/colorscale/attributes");var c=e("../../plot_api/plot_template").templatedArray;var f=e("../../plots/cartesian/axis_format_attributes").descriptionOnlyNumbers;var h=e("../../lib/extend").extendFlat;var p=e("../../plot_api/edit_types").overrideAll;var v=t.exports=p({hoverinfo:h({},n.hoverinfo,{flags:[],arrayOk:false}),hoverlabel:o.hoverlabel,domain:s({name:"sankey",trace:true}),orientation:{valType:"enumerated",values:["v","h"],dflt:"h"},valueformat:{valType:"string",dflt:".3s",description:f("value")},valuesuffix:{valType:"string",dflt:""},arrangement:{valType:"enumerated",values:["snap","perpendicular","freeform","fixed"],dflt:"snap"},textfont:a({}),customdata:undefined,node:{label:{valType:"data_array",dflt:[]},groups:{valType:"info_array",impliedEdits:{x:[],y:[]},dimensions:2,freeLength:true,dflt:[],items:{valType:"number",editType:"calc"}},x:{valType:"data_array",dflt:[]},y:{valType:"data_array",dflt:[]},color:{valType:"color",arrayOk:true},customdata:{valType:"data_array",editType:"calc"},line:{color:{valType:"color",dflt:i.defaultLine,arrayOk:true},width:{valType:"number",min:0,dflt:.5,arrayOk:true}},pad:{valType:"number",arrayOk:false,min:0,dflt:20},thickness:{valType:"number",arrayOk:false,min:1,dflt:20},hoverinfo:{valType:"enumerated",values:["all","none","skip"],dflt:"all"},hoverlabel:o.hoverlabel,hovertemplate:l({},{keys:["value","label"]})},link:{label:{valType:"data_array",dflt:[]},color:{valType:"color",arrayOk:true},customdata:{valType:"data_array",editType:"calc"},line:{color:{valType:"color",dflt:i.defaultLine,arrayOk:true},width:{valType:"number",min:0,dflt:0,arrayOk:true}},source:{valType:"data_array",dflt:[]},target:{valType:"data_array",dflt:[]},value:{valType:"data_array",dflt:[]},hoverinfo:{valType:"enumerated",values:["all","none","skip"],dflt:"all"},hoverlabel:o.hoverlabel,hovertemplate:l({},{keys:["value","label"]}),colorscales:c("concentrationscales",{editType:"calc",label:{valType:"string",editType:"calc",dflt:""},cmax:{valType:"number",editType:"calc",dflt:1},cmin:{valType:"number",editType:"calc",dflt:0},colorscale:h(u().colorscale,{dflt:[[0,"white"],[1,"black"]]})})}},"calc","nested");v.transforms=undefined},{"../../components/color/attributes":649,"../../components/colorscale/attributes":657,"../../components/fx/attributes":681,"../../lib/extend":777,"../../plot_api/edit_types":820,"../../plot_api/plot_template":827,"../../plots/attributes":834,"../../plots/cartesian/axis_format_attributes":841,"../../plots/domain":866,"../../plots/font_attributes":867,"../../plots/template_attributes":910}],1193:[function(e,t,r){"use strict";var a=e("../../plot_api/edit_types").overrideAll;var n=e("../../plots/get_data").getModuleCalcData;var i=e("./plot");var o=e("../../components/fx/layout_attributes");var s=e("../../lib/setcursor");var l=e("../../components/dragelement");var u=e("../../plots/cartesian/select").prepSelect;var c=e("../../lib");var f=e("../../registry");var h="sankey";r.name=h;r.baseLayoutAttrOverrides=a({hoverlabel:o.hoverlabel},"plot","nested");r.plot=function(e){var t=n(e.calcdata,h)[0];i(e,t);r.updateFx(e)};r.clean=function(e,t,r,a){var n=a._has&&a._has(h);var i=t._has&&t._has(h);if(n&&!i){a._paperdiv.selectAll(".sankey").remove();a._paperdiv.selectAll(".bgsankey").remove()}};r.updateFx=function(e){for(var t=0;t<e._fullData.length;t++){p(e,t)}};function p(e,t){var r=e._fullData[t];var a=e._fullLayout;var n=a.dragmode;var i=a.dragmode==="pan"?"move":"crosshair";var o=r._bgRect;if(n==="pan"||n==="zoom")return;s(o,i);var h={_id:"x",c2p:c.identity,_offset:r._sankey.translateX,_length:r._sankey.width};var p={_id:"y",c2p:c.identity,_offset:r._sankey.translateY,_length:r._sankey.height};var v={gd:e,element:o.node(),plotinfo:{id:t,xaxis:h,yaxis:p,fillRangeItems:c.noop},subplot:t,xaxes:[h],yaxes:[p],doneFnCompleted:function(r){var a=e._fullData[t];var n;var i=a.node.groups.slice();var o=[];function s(e){var t=a._sankey.graph.nodes;for(var r=0;r<t.length;r++){if(t[r].pointNumber===e)return t[r]}}for(var l=0;l<r.length;l++){var u=s(r[l].pointNumber);if(!u)continue;if(u.group){for(var c=0;c<u.childrenNodes.length;c++){o.push(u.childrenNodes[c].pointNumber)}i[u.pointNumber-a.node._count]=false}else{o.push(u.pointNumber)}}n=i.filter(Boolean).concat([o]);f.call("_guiRestyle",e,{"node.groups":[n]},t)}};v.prepFn=function(e,t,r){u(e,t,r,v,n)};l.init(v)}},{"../../components/dragelement":669,"../../components/fx/layout_attributes":691,"../../lib":787,"../../lib/setcursor":808,"../../plot_api/edit_types":820,"../../plots/cartesian/select":858,"../../plots/get_data":875,"../../registry":915,"./plot":1198}],1194:[function(e,t,r){"use strict";var a=e("strongly-connected-components");var n=e("../../lib");var i=e("../../lib/gup").wrap;var o=n.isArrayOrTypedArray;var s=n.isIndex;var l=e("../../components/colorscale");function u(e){var t=e.node;var r=e.link;var a=[];var i=o(r.color);var u=o(r.customdata);var f={};var h={};var p=r.colorscales.length;var v;for(v=0;v<p;v++){var d=r.colorscales[v];var m=l.extractScale(d,{cLetter:"c"});var g=l.makeColorScaleFunc(m);h[d.label]=g}var y=0;for(v=0;v<r.value.length;v++){if(r.source[v]>y)y=r.source[v];if(r.target[v]>y)y=r.target[v]}var x=y+1;e.node._count=x;var b;var _=e.node.groups;var w={};for(v=0;v<_.length;v++){var T=_[v];for(b=0;b<T.length;b++){var k=T[b];var M=x+v;if(w.hasOwnProperty(k)){n.warn("Node "+k+" is already part of a group.")}else{w[k]=M}}}var A={source:[],target:[]};for(v=0;v<r.value.length;v++){var S=r.value[v];var E=r.source[v];var L=r.target[v];if(!(S>0&&s(E,x)&&s(L,x))){continue}if(w.hasOwnProperty(E)&&w.hasOwnProperty(L)&&w[E]===w[L]){continue}if(w.hasOwnProperty(L)){L=w[L]}if(w.hasOwnProperty(E)){E=w[E]}E=+E;L=+L;f[E]=f[L]=true;var C="";if(r.label&&r.label[v])C=r.label[v];var I=null;if(C&&h.hasOwnProperty(C))I=h[C];a.push({pointNumber:v,label:C,color:i?r.color[v]:r.color,customdata:u?r.customdata[v]:r.customdata,concentrationscale:I,source:E,target:L,value:+S});A.source.push(E);A.target.push(L)}var P=x+_.length;var O=o(t.color);var z=o(t.customdata);var D=[];for(v=0;v<P;v++){if(!f[v])continue;var R=t.label[v];D.push({group:v>x-1,childrenNodes:[],pointNumber:v,label:R,color:O?t.color[v]:t.color,customdata:z?t.customdata[v]:t.customdata})}var F=false;if(c(P,A.source,A.target)){F=true}return{circular:F,links:a,nodes:D,groups:_,groupLookup:w}}function c(e,t,r){var i=n.init2dArray(e,0);for(var o=0;o<Math.min(t.length,r.length);o++){if(n.isIndex(t[o],e)&&n.isIndex(r[o],e)){if(t[o]===r[o]){return true}i[t[o]].push(r[o])}}var s=a(i);return s.components.some((function(e){return e.length>1}))}t.exports=function e(t,r){var a=u(r);return i({circular:a.circular,_nodes:a.nodes,_links:a.links,_groups:a.groups,_groupLookup:a.groupLookup})}},{"../../components/colorscale":662,"../../lib":787,"../../lib/gup":784,"strongly-connected-components":575}],1195:[function(e,t,r){"use strict";t.exports={nodeTextOffsetHorizontal:4,nodeTextOffsetVertical:3,nodePadAcross:10,sankeyIterations:50,forceIterations:5,forceTicksPerFrame:10,duration:500,ease:"linear",cn:{sankey:"sankey",sankeyLinks:"sankey-links",sankeyLink:"sankey-link",sankeyNodeSet:"sankey-node-set",sankeyNode:"sankey-node",nodeRect:"node-rect",nodeLabel:"node-label"}}},{}],1196:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("./attributes");var i=e("../../components/color");var o=e("tinycolor2");var s=e("../../plots/domain").defaults;var l=e("../../components/fx/hoverlabel_defaults");var u=e("../../plot_api/plot_template");var c=e("../../plots/array_container_defaults");t.exports=function e(t,r,h,p){function v(e,i){return a.coerce(t,r,n,e,i)}var d=a.extendDeep(p.hoverlabel,t.hoverlabel);var m=t.node;var g=u.newContainer(r,"node");function y(e,t){return a.coerce(m,g,n.node,e,t)}y("label");y("groups");y("x");y("y");y("pad");y("thickness");y("line.color");y("line.width");y("hoverinfo",t.hoverinfo);l(m,g,y,d);y("hovertemplate");var x=p.colorway;var b=function(e){return x[e%x.length]};y("color",g.label.map((function(e,t){return i.addOpacity(b(t),.8)})));y("customdata");var _=t.link||{};var w=u.newContainer(r,"link");function T(e,t){return a.coerce(_,w,n.link,e,t)}T("label");T("source");T("target");T("value");T("line.color");T("line.width");T("hoverinfo",t.hoverinfo);l(_,w,T,d);T("hovertemplate");var k=o(p.paper_bgcolor).getLuminance()<.333?"rgba(255, 255, 255, 0.6)":"rgba(0, 0, 0, 0.2)";T("color",a.repeat(k,w.value.length));T("customdata");c(_,w,{name:"colorscales",handleItemDefaults:f});s(r,p,v);v("orientation");v("valueformat");v("valuesuffix");var M;if(g.x.length&&g.y.length){M="freeform"}v("arrangement",M);a.coerceFont(v,"textfont",a.extendFlat({},p.font));r._length=null};function f(e,t){function r(r,i){return a.coerce(e,t,n.link.colorscales,r,i)}r("label");r("cmin");r("cmax");r("colorscale")}},{"../../components/color":650,"../../components/fx/hoverlabel_defaults":688,"../../lib":787,"../../plot_api/plot_template":827,"../../plots/array_container_defaults":833,"../../plots/domain":866,"./attributes":1192,tinycolor2:583}],1197:[function(e,t,r){"use strict";t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),calc:e("./calc"),plot:e("./plot"),moduleType:"trace",name:"sankey",basePlotModule:e("./base_plot"),selectPoints:e("./select.js"),categories:["noOpacity"],meta:{}}},{"./attributes":1192,"./base_plot":1193,"./calc":1194,"./defaults":1196,"./plot":1198,"./select.js":1200}],1198:[function(e,t,r){"use strict";var a=e("@plotly/d3");var n=e("../../lib");var i=n.numberFormat;var o=e("./render");var s=e("../../components/fx");var l=e("../../components/color");var u=e("./constants").cn;var c=n._;function f(e){return e!==""}function h(e,t){return e.filter((function(e){return e.key===t.traceId}))}function p(e,t){a.select(e).select("path").style("fill-opacity",t);a.select(e).select("rect").style("fill-opacity",t)}function v(e){a.select(e).select("text.name").style("fill","black")}function d(e){return function(t){return e.node.sourceLinks.indexOf(t.link)!==-1||e.node.targetLinks.indexOf(t.link)!==-1}}function m(e){return function(t){return t.node.sourceLinks.indexOf(e.link)!==-1||t.node.targetLinks.indexOf(e.link)!==-1}}function g(e,t,r){if(t&&r){h(r,t).selectAll("."+u.sankeyLink).filter(d(t)).call(x.bind(0,t,r,false))}}function y(e,t,r){if(t&&r){h(r,t).selectAll("."+u.sankeyLink).filter(d(t)).call(b.bind(0,t,r,false))}}function x(e,t,r,a){var n=a.datum().link.label;a.style("fill-opacity",(function(e){if(!e.link.concentrationscale){return.4}}));if(n){h(t,e).selectAll("."+u.sankeyLink).filter((function(e){return e.link.label===n})).style("fill-opacity",(function(e){if(!e.link.concentrationscale){return.4}}))}if(r){h(t,e).selectAll("."+u.sankeyNode).filter(m(e)).call(g)}}function b(e,t,r,a){var n=a.datum().link.label;a.style("fill-opacity",(function(e){return e.tinyColorAlpha}));if(n){h(t,e).selectAll("."+u.sankeyLink).filter((function(e){return e.link.label===n})).style("fill-opacity",(function(e){return e.tinyColorAlpha}))}if(r){h(t,e).selectAll(u.sankeyNode).filter(m(e)).call(y)}}function _(e,t){var r=e.hoverlabel||{};var a=n.nestedProperty(r,t).get();return Array.isArray(a)?false:a}t.exports=function e(t,r){var n=t._fullLayout;var h=n._paper;var d=n._size;for(var m=0;m<t._fullData.length;m++){if(!t._fullData[m].visible)continue;if(t._fullData[m].type!==u.sankey)continue;if(!t._fullData[m]._viewInitial){var w=t._fullData[m].node;t._fullData[m]._viewInitial={node:{groups:w.groups.slice(),x:w.x.slice(),y:w.y.slice()}}}}var T=function(e,r){var n=r.link;n.originalEvent=a.event;t._hoverdata=[n];s.click(t,{target:true})};var k=function(e,r,n){if(t._fullLayout.hovermode===false)return;a.select(e).call(x.bind(0,r,n,true));if(r.link.trace.link.hoverinfo!=="skip"){r.link.fullData=r.link.trace;t.emit("plotly_hover",{event:a.event,points:[r.link]})}};var M=c(t,"source:")+" ";var A=c(t,"target:")+" ";var S=c(t,"concentration:")+" ";var E=c(t,"incoming flow count:")+" ";var L=c(t,"outgoing flow count:")+" ";var C=function(e,r){if(t._fullLayout.hovermode===false)return;var o=r.link.trace.link;if(o.hoverinfo==="none"||o.hoverinfo==="skip")return;var u=[];function c(e){var t,a;if(e.circular){t=(e.circularPathData.leftInnerExtent+e.circularPathData.rightInnerExtent)/2;a=e.circularPathData.verticalFullExtent}else{t=(e.source.x1+e.target.x0)/2;a=(e.y0+e.y1)/2}var n=[t,a];if(e.trace.orientation==="v")n.reverse();n[0]+=r.parent.translateX;n[1]+=r.parent.translateY;return n}var h=0;for(var d=0;d<r.flow.links.length;d++){var m=r.flow.links[d];if(t._fullLayout.hovermode==="closest"&&r.link.pointNumber!==m.pointNumber)continue;if(r.link.pointNumber===m.pointNumber)h=d;m.fullData=m.trace;o=r.link.trace.link;var g=c(m);var y={valueLabel:i(r.valueFormat)(m.value)+r.valueSuffix};u.push({x:g[0],y:g[1],name:y.valueLabel,text:[m.label||"",M+m.source.label,A+m.target.label,m.concentrationscale?S+i("%0.2f")(m.flow.labelConcentration):""].filter(f).join("<br>"),color:_(o,"bgcolor")||l.addOpacity(m.color,1),borderColor:_(o,"bordercolor"),fontFamily:_(o,"font.family"),fontSize:_(o,"font.size"),fontColor:_(o,"font.color"),nameLength:_(o,"namelength"),textAlign:_(o,"align"),idealAlign:a.event.x<g[0]?"right":"left",hovertemplate:o.hovertemplate,hovertemplateLabels:y,eventData:[m]})}var x=s.loneHover(u,{container:n._hoverlayer.node(),outerContainer:n._paper.node(),gd:t,anchorIndex:h});x.each((function(){var e=this;if(!r.link.concentrationscale){p(e,.65)}v(e)}))};var I=function(e,r,i){if(t._fullLayout.hovermode===false)return;a.select(e).call(b.bind(0,r,i,true));if(r.link.trace.link.hoverinfo!=="skip"){r.link.fullData=r.link.trace;t.emit("plotly_unhover",{event:a.event,points:[r.link]})}s.loneUnhover(n._hoverlayer.node())};var P=function(e,r,n){var i=r.node;i.originalEvent=a.event;t._hoverdata=[i];a.select(e).call(y,r,n);s.click(t,{target:true})};var O=function(e,r,n){if(t._fullLayout.hovermode===false)return;a.select(e).call(g,r,n);if(r.node.trace.node.hoverinfo!=="skip"){r.node.fullData=r.node.trace;t.emit("plotly_hover",{event:a.event,points:[r.node]})}};var z=function(e,r){if(t._fullLayout.hovermode===false)return;var o=r.node.trace.node;if(o.hoverinfo==="none"||o.hoverinfo==="skip")return;var l=a.select(e).select("."+u.nodeRect);var c=t._fullLayout._paperdiv.node().getBoundingClientRect();var h=l.node().getBoundingClientRect();var d=h.left-2-c.left;var m=h.right+2-c.left;var g=h.top+h.height/4-c.top;var y={valueLabel:i(r.valueFormat)(r.node.value)+r.valueSuffix};r.node.fullData=r.node.trace;t._fullLayout._calcInverseTransform(t);var x=t._fullLayout._invScaleX;var b=t._fullLayout._invScaleY;var w=s.loneHover({x0:x*d,x1:x*m,y:b*g,name:i(r.valueFormat)(r.node.value)+r.valueSuffix,text:[r.node.label,E+r.node.targetLinks.length,L+r.node.sourceLinks.length].filter(f).join("<br>"),color:_(o,"bgcolor")||r.tinyColorHue,borderColor:_(o,"bordercolor"),fontFamily:_(o,"font.family"),fontSize:_(o,"font.size"),fontColor:_(o,"font.color"),nameLength:_(o,"namelength"),textAlign:_(o,"align"),idealAlign:"left",hovertemplate:o.hovertemplate,hovertemplateLabels:y,eventData:[r.node]},{container:n._hoverlayer.node(),outerContainer:n._paper.node(),gd:t});p(w,.85);v(w)};var D=function(e,r,i){if(t._fullLayout.hovermode===false)return;a.select(e).call(y,r,i);if(r.node.trace.node.hoverinfo!=="skip"){r.node.fullData=r.node.trace;t.emit("plotly_unhover",{event:a.event,points:[r.node]})}s.loneUnhover(n._hoverlayer.node())};o(t,h,r,{width:d.w,height:d.h,margin:{t:d.t,r:d.r,b:d.b,l:d.l}},{linkEvents:{hover:k,follow:C,unhover:I,select:T},nodeEvents:{hover:O,follow:z,unhover:D,select:P}})}},{"../../components/color":650,"../../components/fx":690,"../../lib":787,"./constants":1195,"./render":1199,"@plotly/d3":58}],1199:[function(e,t,r){"use strict";var a=e("d3-force");var n=e("d3-interpolate").interpolateNumber;var i=e("@plotly/d3");var o=e("@plotly/d3-sankey");var s=e("@plotly/d3-sankey-circular");var l=e("./constants");var u=e("tinycolor2");var c=e("../../components/color");var f=e("../../components/drawing");var h=e("../../lib");var p=h.strTranslate;var v=h.strRotate;var d=e("../../lib/gup");var m=d.keyFun;var g=d.repeat;var y=d.unwrap;var x=e("../../lib/svg_text_utils");var b=e("../../registry");var _=e("../../constants/alignment");var w=_.CAP_SHIFT;var T=_.LINE_SPACING;var k=3;function M(e,t,r){var a=y(t);var n=a.trace;var i=n.domain;var c=n.orientation==="h";var f=n.node.pad;var p=n.node.thickness;var v=e.width*(i.x[1]-i.x[0]);var d=e.height*(i.y[1]-i.y[0]);var m=a._nodes;var g=a._links;var x=a.circular;var b;if(x){b=s.sankeyCircular().circularLinkGap(0)}else{b=o.sankey()}b.iterations(l.sankeyIterations).size(c?[v,d]:[d,v]).nodeWidth(p).nodePadding(f).nodeId((function(e){return e.pointNumber})).nodes(m).links(g);var _=b();if(b.nodePadding()<f){h.warn("node.pad was reduced to ",b.nodePadding()," to fit within the figure.")}var w,T,k;for(var M in a._groupLookup){var A=parseInt(a._groupLookup[M]);var S;for(w=0;w<_.nodes.length;w++){if(_.nodes[w].pointNumber===A){S=_.nodes[w];break}}if(!S)continue;var E={pointNumber:parseInt(M),x0:S.x0,x1:S.x1,y0:S.y0,y1:S.y1,partOfGroup:true,sourceLinks:[],targetLinks:[]};_.nodes.unshift(E);S.childrenNodes.unshift(E)}function L(){for(w=0;w<_.nodes.length;w++){var e=_.nodes[w];var t={};var r;var a;for(T=0;T<e.targetLinks.length;T++){a=e.targetLinks[T];r=a.source.pointNumber+":"+a.target.pointNumber;if(!t.hasOwnProperty(r))t[r]=[];t[r].push(a)}var n=Object.keys(t);for(T=0;T<n.length;T++){r=n[T];var i=t[r];var o=0;var s={};for(k=0;k<i.length;k++){a=i[k];if(!s[a.label])s[a.label]=0;s[a.label]+=a.value;o+=a.value}for(k=0;k<i.length;k++){a=i[k];a.flow={value:o,labelConcentration:s[a.label]/o,concentration:a.value/o,links:i};if(a.concentrationscale){a.color=u(a.concentrationscale(a.flow.labelConcentration))}}}var l=0;for(T=0;T<e.sourceLinks.length;T++){l+=e.sourceLinks[T].value}for(T=0;T<e.sourceLinks.length;T++){a=e.sourceLinks[T];a.concentrationOut=a.value/l}var c=0;for(T=0;T<e.targetLinks.length;T++){c+=e.targetLinks[T].value}for(T=0;T<e.targetLinks.length;T++){a=e.targetLinks[T];a.concenrationIn=a.value/c}}}L();function C(e){e.forEach((function(e){var t;var r;var a=0;var n=e.length;var i;e.sort((function(e,t){return e.y0-t.y0}));for(i=0;i<n;++i){t=e[i];if(t.y0>=a){}else{r=a-t.y0;if(r>1e-6)t.y0+=r,t.y1+=r}a=t.y1+f}}))}function I(e){var t=e.map((function(e,t){return{x0:e.x0,index:t}})).sort((function(e,t){return e.x0-t.x0}));var r=[];var a=-1;var n;var i=-Infinity;var o;for(w=0;w<t.length;w++){var s=e[t[w].index];if(s.x0>i+p){a+=1;n=s.x0}i=s.x0;if(!r[a])r[a]=[];r[a].push(s);o=n-s.x0;s.x0+=o,s.x1+=o}return r}if(n.node.x.length&&n.node.y.length){for(w=0;w<Math.min(n.node.x.length,n.node.y.length,_.nodes.length);w++){if(n.node.x[w]&&n.node.y[w]){var P=[n.node.x[w]*v,n.node.y[w]*d];_.nodes[w].x0=P[0]-p/2;_.nodes[w].x1=P[0]+p/2;var O=_.nodes[w].y1-_.nodes[w].y0;_.nodes[w].y0=P[1]-O/2;_.nodes[w].y1=P[1]+O/2}}if(n.arrangement==="snap"){m=_.nodes;var z=I(m);C(z)}b.update(_)}return{circular:x,key:r,trace:n,guid:h.randstr(),horizontal:c,width:v,height:d,nodePad:n.node.pad,nodeLineColor:n.node.line.color,nodeLineWidth:n.node.line.width,linkLineColor:n.link.line.color,linkLineWidth:n.link.line.width,valueFormat:n.valueformat,valueSuffix:n.valuesuffix,textFont:n.textfont,translateX:i.x[0]*e.width+e.margin.l,translateY:e.height-i.y[1]*e.height+e.margin.t,dragParallel:c?d:v,dragPerpendicular:c?v:d,arrangement:n.arrangement,sankey:b,graph:_,forceLayouts:{},interactionState:{dragInProgress:false,hovered:false}}}function A(e,t,r){var a=u(t.color);var n=t.source.label+"|"+t.target.label;var i=n+"__"+r;t.trace=e.trace;t.curveNumber=e.trace.index;return{circular:e.circular,key:i,traceId:e.key,pointNumber:t.pointNumber,link:t,tinyColorHue:c.tinyRGB(a),tinyColorAlpha:a.getAlpha(),linkPath:E,linkLineColor:e.linkLineColor,linkLineWidth:e.linkLineWidth,valueFormat:e.valueFormat,valueSuffix:e.valueSuffix,sankey:e.sankey,parent:e,interactionState:e.interactionState,flow:t.flow}}function S(e){var t="";var r=e.width/2;var a=e.circularPathData;if(e.circularLinkType==="top"){t="M "+a.targetX+" "+(a.targetY+r)+" "+"L"+a.rightInnerExtent+" "+(a.targetY+r)+"A"+(a.rightLargeArcRadius+r)+" "+(a.rightSmallArcRadius+r)+" 0 0 1 "+(a.rightFullExtent-r)+" "+(a.targetY-a.rightSmallArcRadius)+"L"+(a.rightFullExtent-r)+" "+a.verticalRightInnerExtent+"A"+(a.rightLargeArcRadius+r)+" "+(a.rightLargeArcRadius+r)+" 0 0 1 "+a.rightInnerExtent+" "+(a.verticalFullExtent-r)+"L"+a.leftInnerExtent+" "+(a.verticalFullExtent-r)+"A"+(a.leftLargeArcRadius+r)+" "+(a.leftLargeArcRadius+r)+" 0 0 1 "+(a.leftFullExtent+r)+" "+a.verticalLeftInnerExtent+"L"+(a.leftFullExtent+r)+" "+(a.sourceY-a.leftSmallArcRadius)+"A"+(a.leftLargeArcRadius+r)+" "+(a.leftSmallArcRadius+r)+" 0 0 1 "+a.leftInnerExtent+" "+(a.sourceY+r)+"L"+a.sourceX+" "+(a.sourceY+r)+"L"+a.sourceX+" "+(a.sourceY-r)+"L"+a.leftInnerExtent+" "+(a.sourceY-r)+"A"+(a.leftLargeArcRadius-r)+" "+(a.leftSmallArcRadius-r)+" 0 0 0 "+(a.leftFullExtent-r)+" "+(a.sourceY-a.leftSmallArcRadius)+"L"+(a.leftFullExtent-r)+" "+a.verticalLeftInnerExtent+"A"+(a.leftLargeArcRadius-r)+" "+(a.leftLargeArcRadius-r)+" 0 0 0 "+a.leftInnerExtent+" "+(a.verticalFullExtent+r)+"L"+a.rightInnerExtent+" "+(a.verticalFullExtent+r)+"A"+(a.rightLargeArcRadius-r)+" "+(a.rightLargeArcRadius-r)+" 0 0 0 "+(a.rightFullExtent+r)+" "+a.verticalRightInnerExtent+"L"+(a.rightFullExtent+r)+" "+(a.targetY-a.rightSmallArcRadius)+"A"+(a.rightLargeArcRadius-r)+" "+(a.rightSmallArcRadius-r)+" 0 0 0 "+a.rightInnerExtent+" "+(a.targetY-r)+"L"+a.targetX+" "+(a.targetY-r)+"Z"}else{t="M "+a.targetX+" "+(a.targetY-r)+" "+"L"+a.rightInnerExtent+" "+(a.targetY-r)+"A"+(a.rightLargeArcRadius+r)+" "+(a.rightSmallArcRadius+r)+" 0 0 0 "+(a.rightFullExtent-r)+" "+(a.targetY+a.rightSmallArcRadius)+"L"+(a.rightFullExtent-r)+" "+a.verticalRightInnerExtent+"A"+(a.rightLargeArcRadius+r)+" "+(a.rightLargeArcRadius+r)+" 0 0 0 "+a.rightInnerExtent+" "+(a.verticalFullExtent+r)+"L"+a.leftInnerExtent+" "+(a.verticalFullExtent+r)+"A"+(a.leftLargeArcRadius+r)+" "+(a.leftLargeArcRadius+r)+" 0 0 0 "+(a.leftFullExtent+r)+" "+a.verticalLeftInnerExtent+"L"+(a.leftFullExtent+r)+" "+(a.sourceY+a.leftSmallArcRadius)+"A"+(a.leftLargeArcRadius+r)+" "+(a.leftSmallArcRadius+r)+" 0 0 0 "+a.leftInnerExtent+" "+(a.sourceY-r)+"L"+a.sourceX+" "+(a.sourceY-r)+"L"+a.sourceX+" "+(a.sourceY+r)+"L"+a.leftInnerExtent+" "+(a.sourceY+r)+"A"+(a.leftLargeArcRadius-r)+" "+(a.leftSmallArcRadius-r)+" 0 0 1 "+(a.leftFullExtent-r)+" "+(a.sourceY+a.leftSmallArcRadius)+"L"+(a.leftFullExtent-r)+" "+a.verticalLeftInnerExtent+"A"+(a.leftLargeArcRadius-r)+" "+(a.leftLargeArcRadius-r)+" 0 0 1 "+a.leftInnerExtent+" "+(a.verticalFullExtent-r)+"L"+a.rightInnerExtent+" "+(a.verticalFullExtent-r)+"A"+(a.rightLargeArcRadius-r)+" "+(a.rightLargeArcRadius-r)+" 0 0 1 "+(a.rightFullExtent+r)+" "+a.verticalRightInnerExtent+"L"+(a.rightFullExtent+r)+" "+(a.targetY+a.rightSmallArcRadius)+"A"+(a.rightLargeArcRadius-r)+" "+(a.rightSmallArcRadius-r)+" 0 0 1 "+a.rightInnerExtent+" "+(a.targetY+r)+"L"+a.targetX+" "+(a.targetY+r)+"Z"}return t}function E(){var e=.5;function t(t){if(t.link.circular){return S(t.link)}else{var r=t.link.source.x1;var a=t.link.target.x0;var i=n(r,a);var o=i(e);var s=i(1-e);var l=t.link.y0-t.link.width/2;var u=t.link.y0+t.link.width/2;var c=t.link.y1-t.link.width/2;var f=t.link.y1+t.link.width/2;return"M"+r+","+l+"C"+o+","+l+" "+s+","+c+" "+a+","+c+"L"+a+","+f+"C"+s+","+f+" "+o+","+u+" "+r+","+u+"Z"}}return t}function L(e,t){var r=u(t.color);var a=l.nodePadAcross;var n=e.nodePad/2;t.dx=t.x1-t.x0;t.dy=t.y1-t.y0;var i=t.dx;var o=Math.max(.5,t.dy);var s="node_"+t.pointNumber;if(t.group){s=h.randstr()}t.trace=e.trace;t.curveNumber=e.trace.index;return{index:t.pointNumber,key:s,partOfGroup:t.partOfGroup||false,group:t.group,traceId:e.key,trace:e.trace,node:t,nodePad:e.nodePad,nodeLineColor:e.nodeLineColor,nodeLineWidth:e.nodeLineWidth,textFont:e.textFont,size:e.horizontal?e.height:e.width,visibleWidth:Math.ceil(i),visibleHeight:o,zoneX:-a,zoneY:-n,zoneWidth:i+2*a,zoneHeight:o+2*n,labelY:e.horizontal?t.dy/2+1:t.dx/2+1,left:t.originalLayer===1,sizeAcross:e.width,forceLayouts:e.forceLayouts,horizontal:e.horizontal,darkBackground:r.getBrightness()<=128,tinyColorHue:c.tinyRGB(r),tinyColorAlpha:r.getAlpha(),valueFormat:e.valueFormat,valueSuffix:e.valueSuffix,sankey:e.sankey,graph:e.graph,arrangement:e.arrangement,uniqueNodeLabelPathId:[e.guid,e.key,s].join("_"),interactionState:e.interactionState,figure:e}}function C(e){e.attr("transform",(function(e){return p(e.node.x0.toFixed(3),e.node.y0.toFixed(3))}))}function I(e){e.call(C)}function P(e,t){e.call(I);t.attr("d",E())}function O(e){e.attr("width",(function(e){return e.node.x1-e.node.x0})).attr("height",(function(e){return e.visibleHeight}))}function z(e){return e.link.width>1||e.linkLineWidth>0}function D(e){var t=p(e.translateX,e.translateY);return t+(e.horizontal?"matrix(1 0 0 1 0 0)":"matrix(0 1 1 0 0 0)")}function R(e,t,r){e.on(".basic",null).on("mouseover.basic",(function(e){if(!e.interactionState.dragInProgress&&!e.partOfGroup){r.hover(this,e,t);e.interactionState.hovered=[this,e]}})).on("mousemove.basic",(function(e){if(!e.interactionState.dragInProgress&&!e.partOfGroup){r.follow(this,e);e.interactionState.hovered=[this,e]}})).on("mouseout.basic",(function(e){if(!e.interactionState.dragInProgress&&!e.partOfGroup){r.unhover(this,e,t);e.interactionState.hovered=false}})).on("click.basic",(function(e){if(e.interactionState.hovered){r.unhover(this,e,t);e.interactionState.hovered=false}if(!e.interactionState.dragInProgress&&!e.partOfGroup){r.select(this,e,t)}}))}function F(e,t,r,a){var n=i.behavior.drag().origin((function(e){return{x:e.node.x0+e.visibleWidth/2,y:e.node.y0+e.visibleHeight/2}})).on("dragstart",(function(n){if(n.arrangement==="fixed")return;h.ensureSingle(a._fullLayout._infolayer,"g","dragcover",(function(e){a._fullLayout._dragCover=e}));h.raiseToTop(this);n.interactionState.dragInProgress=n.node;H(n.node);if(n.interactionState.hovered){r.nodeEvents.unhover.apply(0,n.interactionState.hovered);n.interactionState.hovered=false}if(n.arrangement==="snap"){var i=n.traceId+"|"+n.key;if(n.forceLayouts[i]){n.forceLayouts[i].alpha(1)}else{B(e,i,n,a)}N(e,t,n,i,a)}})).on("drag",(function(r){if(r.arrangement==="fixed")return;var a=i.event.x;var n=i.event.y;if(r.arrangement==="snap"){r.node.x0=a-r.visibleWidth/2;r.node.x1=a+r.visibleWidth/2;r.node.y0=n-r.visibleHeight/2;r.node.y1=n+r.visibleHeight/2}else{if(r.arrangement==="freeform"){r.node.x0=a-r.visibleWidth/2;r.node.x1=a+r.visibleWidth/2}n=Math.max(0,Math.min(r.size-r.visibleHeight/2,n));r.node.y0=n-r.visibleHeight/2;r.node.y1=n+r.visibleHeight/2}H(r.node);if(r.arrangement!=="snap"){r.sankey.update(r.graph);P(e.filter(q(r)),t)}})).on("dragend",(function(e){if(e.arrangement==="fixed")return;e.interactionState.dragInProgress=false;for(var t=0;t<e.node.childrenNodes.length;t++){e.node.childrenNodes[t].x=e.node.x;e.node.childrenNodes[t].y=e.node.y}if(e.arrangement!=="snap")U(e,a)}));e.on(".drag",null).call(n)}function B(e,t,r,n){G(r.graph.nodes);var i=r.graph.nodes.filter((function(e){return e.originalX===r.node.originalX})).filter((function(e){return!e.partOfGroup}));r.forceLayouts[t]=a.forceSimulation(i).alphaDecay(0).force("collide",a.forceCollide().radius((function(e){return e.dy/2+r.nodePad/2})).strength(1).iterations(l.forceIterations)).force("constrain",j(e,t,i,r,n)).stop()}function N(e,t,r,a,n){window.requestAnimationFrame((function i(){var o;for(o=0;o<l.forceTicksPerFrame;o++){r.forceLayouts[a].tick()}var s=r.graph.nodes;Y(s);r.sankey.update(r.graph);P(e.filter(q(r)),t);if(r.forceLayouts[a].alpha()>0){window.requestAnimationFrame(i)}else{var u=r.node.originalX;r.node.x0=u-r.visibleWidth/2;r.node.x1=u+r.visibleWidth/2;U(r,n)}}))}function j(e,t,r,a){return function e(){var n=0;for(var i=0;i<r.length;i++){var o=r[i];if(o===a.interactionState.dragInProgress){o.x=o.lastDraggedX;o.y=o.lastDraggedY}else{o.vx=(o.originalX-o.x)/l.forceTicksPerFrame;o.y=Math.min(a.size-o.dy/2,Math.max(o.dy/2,o.y))}n=Math.max(n,Math.abs(o.vx),Math.abs(o.vy))}if(!a.interactionState.dragInProgress&&n<.1&&a.forceLayouts[t].alpha()>0){a.forceLayouts[t].alpha(0)}}}function U(e,t){var r=[];var a=[];for(var n=0;n<e.graph.nodes.length;n++){var i=(e.graph.nodes[n].x0+e.graph.nodes[n].x1)/2;var o=(e.graph.nodes[n].y0+e.graph.nodes[n].y1)/2;r.push(i/e.figure.width);a.push(o/e.figure.height)}b.call("_guiRestyle",t,{"node.x":[r],"node.y":[a]},e.trace.index).then((function(){if(t._fullLayout._dragCover)t._fullLayout._dragCover.remove()}))}function V(e){var t=[];var r;for(r=0;r<e.length;r++){e[r].originalX=(e[r].x0+e[r].x1)/2;e[r].originalY=(e[r].y0+e[r].y1)/2;if(t.indexOf(e[r].originalX)===-1){t.push(e[r].originalX)}}t.sort((function(e,t){return e-t}));for(r=0;r<e.length;r++){e[r].originalLayerIndex=t.indexOf(e[r].originalX);e[r].originalLayer=e[r].originalLayerIndex/(t.length-1)}}function H(e){e.lastDraggedX=e.x0+e.dx/2;e.lastDraggedY=e.y0+e.dy/2}function q(e){return function(t){return t.node.originalX===e.node.originalX}}function G(e){for(var t=0;t<e.length;t++){e[t].y=(e[t].y0+e[t].y1)/2;e[t].x=(e[t].x0+e[t].x1)/2}}function Y(e){for(var t=0;t<e.length;t++){e[t].y0=e[t].y-e[t].dy/2;e[t].y1=e[t].y0+e[t].dy;e[t].x0=e[t].x-e[t].dx/2;e[t].x1=e[t].x0+e[t].dx}}t.exports=function(e,t,r,a,n){var o=false;h.ensureSingle(e._fullLayout._infolayer,"g","first-render",(function(){o=true}));var s=e._fullLayout._dragCover;var d=r.filter((function(e){return y(e).trace.visible})).map(M.bind(null,a));var b=t.selectAll("."+l.cn.sankey).data(d,m);b.exit().remove();b.enter().append("g").classed(l.cn.sankey,true).style("box-sizing","content-box").style("position","absolute").style("left",0).style("shape-rendering","geometricPrecision").style("pointer-events","auto").attr("transform",D);b.each((function(t,r){e._fullData[r]._sankey=t;var a="bgsankey-"+t.trace.uid+"-"+r;h.ensureSingle(e._fullLayout._draggers,"rect",a);e._fullData[r]._bgRect=i.select("."+a);e._fullData[r]._bgRect.style("pointer-events","all").attr("width",t.width).attr("height",t.height).attr("x",t.translateX).attr("y",t.translateY).classed("bgsankey",true).style({fill:"transparent","stroke-width":0})}));b.transition().ease(l.ease).duration(l.duration).attr("transform",D);var _=b.selectAll("."+l.cn.sankeyLinks).data(g,m);_.enter().append("g").classed(l.cn.sankeyLinks,true).style("fill","none");var S=_.selectAll("."+l.cn.sankeyLink).data((function(e){var t=e.graph.links;return t.filter((function(e){return e.value})).map(A.bind(null,e))}),m);S.enter().append("path").classed(l.cn.sankeyLink,true).call(R,b,n.linkEvents);S.style("stroke",(function(e){return z(e)?c.tinyRGB(u(e.linkLineColor)):e.tinyColorHue})).style("stroke-opacity",(function(e){return z(e)?c.opacity(e.linkLineColor):e.tinyColorAlpha})).style("fill",(function(e){return e.tinyColorHue})).style("fill-opacity",(function(e){return e.tinyColorAlpha})).style("stroke-width",(function(e){return z(e)?e.linkLineWidth:1})).attr("d",E());S.style("opacity",(function(){return e._context.staticPlot||o||s?1:0})).transition().ease(l.ease).duration(l.duration).style("opacity",1);S.exit().transition().ease(l.ease).duration(l.duration).style("opacity",0).remove();var I=b.selectAll("."+l.cn.sankeyNodeSet).data(g,m);I.enter().append("g").classed(l.cn.sankeyNodeSet,true);I.style("cursor",(function(e){switch(e.arrangement){case"fixed":return"default";case"perpendicular":return"ns-resize";default:return"move"}}));var P=I.selectAll("."+l.cn.sankeyNode).data((function(e){var t=e.graph.nodes;V(t);return t.map(L.bind(null,e))}),m);P.enter().append("g").classed(l.cn.sankeyNode,true).call(C).style("opacity",(function(t){return(e._context.staticPlot||o)&&!t.partOfGroup?1:0}));P.call(R,b,n.nodeEvents).call(F,S,n,e);P.transition().ease(l.ease).duration(l.duration).call(C).style("opacity",(function(e){return e.partOfGroup?0:1}));P.exit().transition().ease(l.ease).duration(l.duration).style("opacity",0).remove();var B=P.selectAll("."+l.cn.nodeRect).data(g);B.enter().append("rect").classed(l.cn.nodeRect,true).call(O);B.style("stroke-width",(function(e){return e.nodeLineWidth})).style("stroke",(function(e){return c.tinyRGB(u(e.nodeLineColor))})).style("stroke-opacity",(function(e){return c.opacity(e.nodeLineColor)})).style("fill",(function(e){return e.tinyColorHue})).style("fill-opacity",(function(e){return e.tinyColorAlpha}));B.transition().ease(l.ease).duration(l.duration).call(O);var N=P.selectAll("."+l.cn.nodeLabel).data(g);N.enter().append("text").classed(l.cn.nodeLabel,true).style("cursor","default");N.attr("data-notex",1).text((function(e){return e.node.label})).each((function(t){var r=i.select(this);f.font(r,t.textFont);x.convertToTspans(r,e)})).style("text-shadow",x.makeTextShadow(e._fullLayout.paper_bgcolor)).attr("text-anchor",(function(e){return e.horizontal&&e.left?"end":"start"})).attr("transform",(function(e){var t=i.select(this);var r=x.lineCount(t);var a=e.textFont.size*((r-1)*T-w);var n=e.nodeLineWidth/2+k;var o=((e.horizontal?e.visibleHeight:e.visibleWidth)-a)/2;if(e.horizontal){if(e.left){n=-n}else{n+=e.visibleWidth}}var s=e.horizontal?"":"scale(-1,1)"+v(90);return p(e.horizontal?n:o,e.horizontal?o:n)+s}));N.transition().ease(l.ease).duration(l.duration)}},{"../../components/color":650,"../../components/drawing":672,"../../constants/alignment":755,"../../lib":787,"../../lib/gup":784,"../../lib/svg_text_utils":813,"../../registry":915,"./constants":1195,"@plotly/d3":58,"@plotly/d3-sankey":57,"@plotly/d3-sankey-circular":56,"d3-force":163,"d3-interpolate":168,tinycolor2:583}],1200:[function(e,t,r){"use strict";t.exports=function e(t,r){var a=t.cd;var n=[];var i=a[0].trace;var o=i._sankey.graph.nodes;for(var s=0;s<o.length;s++){var l=o[s];if(l.partOfGroup)continue;var u=[(l.x0+l.x1)/2,(l.y0+l.y1)/2];if(i.orientation==="v")u.reverse();if(r&&r.contains(u,false,s,t)){n.push({pointNumber:l.pointNumber})}}return n}},{}],1201:[function(e,t,r){"use strict";var a=e("../../lib");t.exports=function e(t,r){for(var n=0;n<t.length;n++)t[n].i=n;a.mergeArray(r.text,t,"tx");a.mergeArray(r.texttemplate,t,"txt");a.mergeArray(r.hovertext,t,"htx");a.mergeArray(r.customdata,t,"data");a.mergeArray(r.textposition,t,"tp");if(r.textfont){a.mergeArrayCastPositive(r.textfont.size,t,"ts");a.mergeArray(r.textfont.color,t,"tc");a.mergeArray(r.textfont.family,t,"tf")}var i=r.marker;if(i){a.mergeArrayCastPositive(i.size,t,"ms");a.mergeArrayCastPositive(i.opacity,t,"mo");a.mergeArray(i.symbol,t,"mx");a.mergeArray(i.color,t,"mc");var o=i.line;if(i.line){a.mergeArray(o.color,t,"mlc");a.mergeArrayCastPositive(o.width,t,"mlw")}var s=i.gradient;if(s&&s.type!=="none"){a.mergeArray(s.type,t,"mgt");a.mergeArray(s.color,t,"mgc")}}}},{"../../lib":787}],1202:[function(e,t,r){"use strict";var a=e("../../plots/cartesian/axis_format_attributes").axisHoverFormat;var n=e("../../plots/template_attributes").texttemplateAttrs;var i=e("../../plots/template_attributes").hovertemplateAttrs;var o=e("../../components/colorscale/attributes");var s=e("../../plots/font_attributes");var l=e("../../components/drawing/attributes").dash;var u=e("../../components/drawing");var c=e("./constants");var f=e("../../lib/extend").extendFlat;function h(e){return{valType:"any",dflt:0,editType:"calc"}}function p(e){return{valType:"any",editType:"calc"}}function v(e){return{valType:"enumerated",values:["start","middle","end"],dflt:"middle",editType:"calc"}}t.exports={x:{valType:"data_array",editType:"calc+clearAxisTypes",anim:true},x0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes",anim:true},dx:{valType:"number",dflt:1,editType:"calc",anim:true},y:{valType:"data_array",editType:"calc+clearAxisTypes",anim:true},y0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes",anim:true},dy:{valType:"number",dflt:1,editType:"calc",anim:true},xperiod:h("x"),yperiod:h("y"),xperiod0:p("x0"),yperiod0:p("y0"),xperiodalignment:v("x"),yperiodalignment:v("y"),xhoverformat:a("x"),yhoverformat:a("y"),stackgroup:{valType:"string",dflt:"",editType:"calc"},orientation:{valType:"enumerated",values:["v","h"],editType:"calc"},groupnorm:{valType:"enumerated",values:["","fraction","percent"],dflt:"",editType:"calc"},stackgaps:{valType:"enumerated",values:["infer zero","interpolate"],dflt:"infer zero",editType:"calc"},text:{valType:"string",dflt:"",arrayOk:true,editType:"calc"},texttemplate:n({},{}),hovertext:{valType:"string",dflt:"",arrayOk:true,editType:"style"},mode:{valType:"flaglist",flags:["lines","markers","text"],extras:["none"],editType:"calc"},hoveron:{valType:"flaglist",flags:["points","fills"],editType:"style"},hovertemplate:i({},{keys:c.eventDataKeys}),line:{color:{valType:"color",editType:"style",anim:true},width:{valType:"number",min:0,dflt:2,editType:"style",anim:true},shape:{valType:"enumerated",values:["linear","spline","hv","vh","hvh","vhv"],dflt:"linear",editType:"plot"},smoothing:{valType:"number",min:0,max:1.3,dflt:1,editType:"plot"},dash:f({},l,{editType:"style"}),simplify:{valType:"boolean",dflt:true,editType:"plot"},editType:"plot"},connectgaps:{valType:"boolean",dflt:false,editType:"calc"},cliponaxis:{valType:"boolean",dflt:true,editType:"plot"},fill:{valType:"enumerated",values:["none","tozeroy","tozerox","tonexty","tonextx","toself","tonext"],editType:"calc"},fillcolor:{valType:"color",editType:"style",anim:true},marker:f({symbol:{valType:"enumerated",values:u.symbolList,dflt:"circle",arrayOk:true,editType:"style"},opacity:{valType:"number",min:0,max:1,arrayOk:true,editType:"style",anim:true},size:{valType:"number",min:0,dflt:6,arrayOk:true,editType:"calc",anim:true},maxdisplayed:{valType:"number",min:0,dflt:0,editType:"plot"},sizeref:{valType:"number",dflt:1,editType:"calc"},sizemin:{valType:"number",min:0,dflt:0,editType:"calc"},sizemode:{valType:"enumerated",values:["diameter","area"],dflt:"diameter",editType:"calc"},line:f({width:{valType:"number",min:0,arrayOk:true,editType:"style",anim:true},editType:"calc"},o("marker.line",{anim:true})),gradient:{type:{valType:"enumerated",values:["radial","horizontal","vertical","none"],arrayOk:true,dflt:"none",editType:"calc"},color:{valType:"color",arrayOk:true,editType:"calc"},editType:"calc"},editType:"calc"},o("marker",{anim:true})),selected:{marker:{opacity:{valType:"number",min:0,max:1,editType:"style"},color:{valType:"color",editType:"style"},size:{valType:"number",min:0,editType:"style"},editType:"style"},textfont:{color:{valType:"color",editType:"style"},editType:"style"},editType:"style"},unselected:{marker:{opacity:{valType:"number",min:0,max:1,editType:"style"},color:{valType:"color",editType:"style"},size:{valType:"number",min:0,editType:"style"},editType:"style"},textfont:{color:{valType:"color",editType:"style"},editType:"style"},editType:"style"},textposition:{valType:"enumerated",values:["top left","top center","top right","middle left","middle center","middle right","bottom left","bottom center","bottom right"],dflt:"middle center",arrayOk:true,editType:"calc"},textfont:s({editType:"calc",colorEditType:"style",arrayOk:true})}},{"../../components/colorscale/attributes":657,"../../components/drawing":672,"../../components/drawing/attributes":671,"../../lib/extend":777,"../../plots/cartesian/axis_format_attributes":841,"../../plots/font_attributes":867,"../../plots/template_attributes":910,"./constants":1206}],1203:[function(e,t,r){"use strict";var a=e("fast-isnumeric");var n=e("../../lib");var i=e("../../plots/cartesian/axes");var o=e("../../plots/cartesian/align_period");var s=e("../../constants/numerical").BADNUM;var l=e("./subtypes");var u=e("./colorscale_calc");var c=e("./arrays_to_calcdata");var f=e("./calc_selection");function h(e,t){var r=e._fullLayout;var l=i.getFromId(e,t.xaxis||"x");var h=i.getFromId(e,t.yaxis||"y");var m=l.makeCalcdata(t,"x");var y=h.makeCalcdata(t,"y");var x=o(t,l,"x",m);var b=o(t,h,"y",y);var _=x.vals;var w=b.vals;var T=t._length;var k=new Array(T);var M=t.ids;var A=g(t,r,l,h);var S=false;var E,L,C,I,P,O;d(r,t);var z="x";var D="y";var R;if(A){n.pushUnique(A.traceIndices,t._expandedIndex);E=A.orientation==="v";if(E){D="s";R="x"}else{z="s";R="y"}P=A.stackgaps==="interpolate"}else{var F=v(t,T);p(e,t,l,h,_,w,F)}var B=!!t.xperiodalignment;var N=!!t.yperiodalignment;for(L=0;L<T;L++){var j=k[L]={};var U=a(_[L]);var V=a(w[L]);if(U&&V){j[z]=_[L];j[D]=w[L];if(B){j.orig_x=m[L];j.xEnd=x.ends[L];j.xStart=x.starts[L]}if(N){j.orig_y=y[L];j.yEnd=b.ends[L];j.yStart=b.starts[L]}}else if(A&&(E?U:V)){j[R]=E?_[L]:w[L];j.gap=true;if(P){j.s=s;S=true}else{j.s=0}}else{j[z]=j[D]=s}if(M){j.id=String(M[L])}}c(k,t);u(e,t);f(k,t);if(A){L=0;while(L<k.length){if(k[L][R]===s){k.splice(L,1)}else L++}n.sort(k,(function(e,t){return e[R]-t[R]||e.i-t.i}));if(S){L=0;while(L<k.length-1&&k[L].gap){L++}O=k[L].s;if(!O)O=k[L].s=0;for(C=0;C<L;C++){k[C].s=O}I=k.length-1;while(I>L&&k[I].gap){I--}O=k[I].s;for(C=k.length-1;C>I;C--){k[C].s=O}while(L<I){L++;if(k[L].gap){C=L+1;while(k[C].gap){C++}var H=k[L-1][R];var q=k[L-1].s;var G=(k[C].s-q)/(k[C][R]-H);while(L<C){k[L].s=q+(k[L][R]-H)*G;L++}}}}}return k}function p(e,t,r,a,n,o,s){var u=t._length;var c=e._fullLayout;var f=r._id;var h=a._id;var p=c._firstScatter[m(t)]===t.uid;var v=(g(t,c,r,a)||{}).orientation;var d=t.fill;r._minDtick=0;a._minDtick=0;var y={padded:true};var x={padded:true};if(s){y.ppad=x.ppad=s}var b=u<2||n[0]!==n[u-1]||o[0]!==o[u-1];if(b&&(d==="tozerox"||d==="tonextx"&&(p||v==="h"))){y.tozero=true}else if(!(t.error_y||{}).visible&&(d==="tonexty"||d==="tozeroy"||!l.hasMarkers(t)&&!l.hasText(t))){y.padded=false;y.ppad=0}if(b&&(d==="tozeroy"||d==="tonexty"&&(p||v==="v"))){x.tozero=true}else if(d==="tonextx"||d==="tozerox"){x.padded=false}if(f)t._extremes[f]=i.findExtremes(r,n,y);if(h)t._extremes[h]=i.findExtremes(a,o,x)}function v(e,t){if(!l.hasMarkers(e))return;var r=e.marker;var a=1.6*(e.marker.sizeref||1);var o;if(e.marker.sizemode==="area"){o=function(e){return Math.max(Math.sqrt((e||0)/a),3)}}else{o=function(e){return Math.max((e||0)/a,3)}}if(n.isArrayOrTypedArray(r.size)){var s={type:"linear"};i.setConvert(s);var u=s.makeCalcdata(e.marker,"size");var c=new Array(t);for(var f=0;f<t;f++){c[f]=o(u[f])}return c}else{return o(r.size)}}function d(e,t){var r=m(t);var a=e._firstScatter;if(!a[r])a[r]=t.uid}function m(e){var t=e.stackgroup;return e.xaxis+e.yaxis+e.type+(t?"-"+t:"")}function g(e,t,r,a){var n=e.stackgroup;if(!n)return;var i=t._scatterStackOpts[r._id+a._id][n];var o=i.orientation==="v"?a:r;if(o.type==="linear"||o.type==="log")return i}t.exports={calc:h,calcMarkerSize:v,calcAxisExpansion:p,setFirstScatter:d,getStackOpts:g}},{"../../constants/numerical":763,"../../lib":787,"../../plots/cartesian/align_period":835,"../../plots/cartesian/axes":838,"./arrays_to_calcdata":1201,"./calc_selection":1204,"./colorscale_calc":1205,"./subtypes":1227,"fast-isnumeric":246}],1204:[function(e,t,r){"use strict";var a=e("../../lib");t.exports=function e(t,r){if(a.isArrayOrTypedArray(r.selectedpoints)){a.tagSelected(t,r)}}},{"../../lib":787}],1205:[function(e,t,r){"use strict";var a=e("../../components/colorscale/helpers").hasColorscale;var n=e("../../components/colorscale/calc");var i=e("./subtypes");t.exports=function e(t,r){if(i.hasLines(r)&&a(r,"line")){n(t,r,{vals:r.line.color,containerStr:"line",cLetter:"c"})}if(i.hasMarkers(r)){if(a(r,"marker")){n(t,r,{vals:r.marker.color,containerStr:"marker",cLetter:"c"})}if(a(r,"marker.line")){n(t,r,{vals:r.marker.line.color,containerStr:"marker.line",cLetter:"c"})}}}},{"../../components/colorscale/calc":658,"../../components/colorscale/helpers":661,"./subtypes":1227}],1206:[function(e,t,r){"use strict";t.exports={PTS_LINESONLY:20,minTolerance:.2,toleranceGrowth:10,maxScreensAway:20,eventDataKeys:[]}},{}],1207:[function(e,t,r){"use strict";var a=e("./calc");t.exports=function e(t,r){var i=r.xaxis;var o=r.yaxis;var s=i._id+o._id;var l=t._fullLayout._scatterStackOpts[s];if(!l)return;var u=t.calcdata;var c,f,h,p,v,d,m,g,y;var x,b,_,w,T;var k;for(var M in l){x=l[M];var A=x.traceIndices;if(!A.length)continue;b=x.stackgaps==="interpolate";_=x.groupnorm;if(x.orientation==="v"){w="x";T="y"}else{w="y";T="x"}k=new Array(A.length);for(c=0;c<k.length;c++){k[c]=false}d=u[A[0]];var S=new Array(d.length);for(c=0;c<d.length;c++){S[c]=d[c][w]}for(c=1;c<A.length;c++){v=u[A[c]];for(f=h=0;f<v.length;f++){m=v[f][w];for(;m>S[h]&&h<S.length;h++){n(v,f,S[h],c,k,b,w);f++}if(m!==S[h]){for(p=0;p<c;p++){n(u[A[p]],h,m,p,k,b,w)}S.splice(h,0,m)}h++}for(;h<S.length;h++){n(v,f,S[h],c,k,b,w);f++}}var E=S.length;for(f=0;f<d.length;f++){g=d[f][T]=d[f].s;for(c=1;c<A.length;c++){v=u[A[c]];v[0].trace._rawLength=v[0].trace._length;v[0].trace._length=E;g+=v[f].s;v[f][T]=g}if(_){y=(_==="fraction"?g:g/100)||1;for(c=0;c<A.length;c++){var L=u[A[c]][f];L[T]/=y;L.sNorm=L.s/y}}}for(c=0;c<A.length;c++){v=u[A[c]];var C=v[0].trace;var I=a.calcMarkerSize(C,C._rawLength);var P=Array.isArray(I);if(I&&k[c]||P){var O=I;I=new Array(E);for(f=0;f<E;f++){I[f]=v[f].gap?0:P?O[v[f].i]:O}}var z=new Array(E);var D=new Array(E);for(f=0;f<E;f++){z[f]=v[f].x;D[f]=v[f].y}a.calcAxisExpansion(t,C,i,o,z,D,I);v[0].t.orientation=x.orientation}}};function n(e,t,r,a,n,o,s){n[a]=true;var l={i:null,gap:true,s:0};l[s]=r;e.splice(t,0,l);if(t&&r===e[t-1][s]){var u=e[t-1];l.s=u.s;l.i=u.i;l.gap=u.gap}else if(o){l.s=i(e,t,r,s)}if(!t){e[0].t=e[1].t;e[0].trace=e[1].trace;delete e[1].t;delete e[1].trace}}function i(e,t,r,a){var n=e[t-1];var i=e[t+1];if(!i)return n.s;if(!n)return i.s;return n.s+(i.s-n.s)*(r-n[a])/(i[a]-n[a])}},{"./calc":1203}],1208:[function(e,t,r){"use strict";t.exports=function e(t){for(var r=0;r<t.length;r++){var a=t[r];if(a.type!=="scatter")continue;var n=a.fill;if(n==="none"||n==="toself")continue;a.opacity=undefined;if(n==="tonexty"||n==="tonextx"){for(var i=r-1;i>=0;i--){var o=t[i];if(o.type==="scatter"&&o.xaxis===a.xaxis&&o.yaxis===a.yaxis){o.opacity=undefined;break}}}}}},{}],1209:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("../../registry");var i=e("./attributes");var o=e("./constants");var s=e("./subtypes");var l=e("./xy_defaults");var u=e("./period_defaults");var c=e("./stack_defaults");var f=e("./marker_defaults");var h=e("./line_defaults");var p=e("./line_shape_defaults");var v=e("./text_defaults");var d=e("./fillcolor_defaults");t.exports=function e(t,r,m,g){function y(e,n){return a.coerce(t,r,i,e,n)}var x=l(t,r,g,y);if(!x)r.visible=false;if(!r.visible)return;u(t,r,g,y);y("xhoverformat");y("yhoverformat");var b=c(t,r,g,y);var _=!b&&x<o.PTS_LINESONLY?"lines+markers":"lines";y("text");y("hovertext");y("mode",_);if(s.hasLines(r)){h(t,r,m,g,y);p(t,r,y);y("connectgaps");y("line.simplify")}if(s.hasMarkers(r)){f(t,r,m,g,y,{gradient:true})}if(s.hasText(r)){y("texttemplate");v(t,r,g,y)}var w=[];if(s.hasMarkers(r)||s.hasText(r)){y("cliponaxis");y("marker.maxdisplayed");w.push("points")}y("fill",b?b.fillDflt:"none");if(r.fill!=="none"){d(t,r,m,y);if(!s.hasLines(r))p(t,r,y)}var T=(r.line||{}).color;var k=(r.marker||{}).color;if(r.fill==="tonext"||r.fill==="toself"){w.push("fills")}y("hoveron",w.join("+")||"points");if(r.hoveron!=="fills")y("hovertemplate");var M=n.getComponentMethod("errorbars","supplyDefaults");M(t,r,T||k||m,{axis:"y"});M(t,r,T||k||m,{axis:"x",inherit:"y"});a.coerceSelectionMarkerOpacity(r,y)}},{"../../lib":787,"../../registry":915,"./attributes":1202,"./constants":1206,"./fillcolor_defaults":1210,"./line_defaults":1215,"./line_shape_defaults":1217,"./marker_defaults":1221,"./period_defaults":1222,"./stack_defaults":1225,"./subtypes":1227,"./text_defaults":1228,"./xy_defaults":1229}],1210:[function(e,t,r){"use strict";var a=e("../../components/color");var n=e("../../lib").isArrayOrTypedArray;t.exports=function e(t,r,i,o){var s=false;if(r.marker){var l=r.marker.color;var u=(r.marker.line||{}).color;if(l&&!n(l)){s=l}else if(u&&!n(u)){s=u}}o("fillcolor",a.addOpacity((r.line||{}).color||s||i,.5))}},{"../../components/color":650,"../../lib":787}],1211:[function(e,t,r){"use strict";var a=e("../../plots/cartesian/axes");t.exports=function e(t,r,n){var i={};var o={_fullLayout:n};var s=a.getFromTrace(o,r,"x");var l=a.getFromTrace(o,r,"y");i.xLabel=a.tickText(s,s.c2l(t.x),true).text;i.yLabel=a.tickText(l,l.c2l(t.y),true).text;return i}},{"../../plots/cartesian/axes":838}],1212:[function(e,t,r){"use strict";var a=e("../../components/color");var n=e("./subtypes");t.exports=function e(t,r){var i,o;if(t.mode==="lines"){i=t.line.color;return i&&a.opacity(i)?i:t.fillcolor}else if(t.mode==="none"){return t.fill?t.fillcolor:""}else{var s=r.mcc||(t.marker||{}).color;var l=r.mlcc||((t.marker||{}).line||{}).color;o=s&&a.opacity(s)?s:l&&a.opacity(l)&&(r.mlw||((t.marker||{}).line||{}).width)?l:"";if(o){if(a.opacity(o)<.3){return a.addOpacity(o,.3)}else return o}else{i=(t.line||{}).color;return i&&a.opacity(i)&&n.hasLines(t)&&t.line.width?i:t.fillcolor}}}},{"../../components/color":650,"./subtypes":1227}],1213:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("../../components/fx");var i=e("../../registry");var o=e("./get_trace_color");var s=e("../../components/color");var l=a.fillText;t.exports=function e(t,r,u,c){var f=t.cd;var h=f[0].trace;var p=t.xa;var v=t.ya;var d=p.c2p(r);var m=v.c2p(u);var g=[d,m];var y=h.hoveron||"";var x=h.mode.indexOf("markers")!==-1?3:.5;var b=!!h.xperiodalignment;var _=!!h.yperiodalignment;if(y.indexOf("points")!==-1){var w=function(e){if(b){var t=p.c2p(e.xStart);var r=p.c2p(e.xEnd);return d>=Math.min(t,r)&&d<=Math.max(t,r)?0:Infinity}var a=Math.max(3,e.mrc||0);var n=1-1/a;var i=Math.abs(p.c2p(e.x)-d);return i<a?n*i/a:i-a+n};var T=function(e){if(_){var t=v.c2p(e.yStart);var r=v.c2p(e.yEnd);return m>=Math.min(t,r)&&m<=Math.max(t,r)?0:Infinity}var a=Math.max(3,e.mrc||0);var n=1-1/a;var i=Math.abs(v.c2p(e.y)-m);return i<a?n*i/a:i-a+n};var k=function(e){var t=Math.max(x,e.mrc||0);var r=p.c2p(e.x)-d;var a=v.c2p(e.y)-m;return Math.max(Math.sqrt(r*r+a*a)-t,1-x/t)};var M=n.getDistanceFunction(c,w,T,k);n.getClosest(f,M,t);if(t.index!==false){var A=f[t.index];var S=p.c2p(A.x,true);var E=v.c2p(A.y,true);var L=A.mrc||1;t.index=A.i;var C=f[0].t.orientation;var I=C&&(A.sNorm||A.s);var P=C==="h"?I:A.orig_x!==undefined?A.orig_x:A.x;var O=C==="v"?I:A.orig_y!==undefined?A.orig_y:A.y;a.extendFlat(t,{color:o(h,A),x0:S-L,x1:S+L,xLabelVal:P,y0:E-L,y1:E+L,yLabelVal:O,spikeDistance:k(A),hovertemplate:h.hovertemplate});l(A,h,t);i.getComponentMethod("errorbars","hoverInfo")(A,h,t);return[t]}}if(y.indexOf("fills")!==-1&&h._polygons){var z=h._polygons;var D=[];var R=false;var F=Infinity;var B=-Infinity;var N=Infinity;var j=-Infinity;var U,V,H,q,G,Y,W,X,Z;for(U=0;U<z.length;U++){H=z[U];if(H.contains(g)){R=!R;D.push(H);N=Math.min(N,H.ymin);j=Math.max(j,H.ymax)}}if(R){N=Math.max(N,0);j=Math.min(j,v._length);var J=(N+j)/2;for(U=0;U<D.length;U++){q=D[U].pts;for(V=1;V<q.length;V++){X=q[V-1][1];Z=q[V][1];if(X>J!==Z>=J){Y=q[V-1][0];W=q[V][0];if(Z-X){G=Y+(W-Y)*(J-X)/(Z-X);F=Math.min(F,G);B=Math.max(B,G)}}}}F=Math.max(F,0);B=Math.min(B,p._length);var K=s.defaultLine;if(s.opacity(h.fillcolor))K=h.fillcolor;else if(s.opacity((h.line||{}).color)){K=h.line.color}a.extendFlat(t,{distance:t.maxHoverDistance,x0:F,x1:B,y0:J,y1:J,color:K,hovertemplate:false});delete t.index;if(h.text&&!Array.isArray(h.text)){t.text=String(h.text)}else t.text=h.name;return[t]}}}},{"../../components/color":650,"../../components/fx":690,"../../lib":787,"../../registry":915,"./get_trace_color":1212}],1214:[function(e,t,r){"use strict";var a=e("./subtypes");t.exports={hasLines:a.hasLines,hasMarkers:a.hasMarkers,hasText:a.hasText,isBubble:a.isBubble,attributes:e("./attributes"),supplyDefaults:e("./defaults"),crossTraceDefaults:e("./cross_trace_defaults"),calc:e("./calc").calc,crossTraceCalc:e("./cross_trace_calc"),arraysToCalcdata:e("./arrays_to_calcdata"),plot:e("./plot"),colorbar:e("./marker_colorbar"),formatLabels:e("./format_labels"),style:e("./style").style,styleOnSelect:e("./style").styleOnSelect,hoverPoints:e("./hover"),selectPoints:e("./select"),animatable:true,moduleType:"trace",name:"scatter",basePlotModule:e("../../plots/cartesian"),categories:["cartesian","svg","symbols","errorBarsOK","showLegend","scatter-like","zoomScale"],meta:{}}},{"../../plots/cartesian":852,"./arrays_to_calcdata":1201,"./attributes":1202,"./calc":1203,"./cross_trace_calc":1207,"./cross_trace_defaults":1208,"./defaults":1209,"./format_labels":1211,"./hover":1213,"./marker_colorbar":1220,"./plot":1223,"./select":1224,"./style":1226,"./subtypes":1227}],1215:[function(e,t,r){"use strict";var a=e("../../lib").isArrayOrTypedArray;var n=e("../../components/colorscale/helpers").hasColorscale;var i=e("../../components/colorscale/defaults");t.exports=function e(t,r,o,s,l,u){var c=(t.marker||{}).color;l("line.color",o);if(n(t,"line")){i(t,r,s,l,{prefix:"line.",cLetter:"c"})}else{var f=(a(c)?false:c)||o;l("line.color",f)}l("line.width");if(!(u||{}).noDash)l("line.dash")}},{"../../components/colorscale/defaults":660,"../../components/colorscale/helpers":661,"../../lib":787}],1216:[function(e,t,r){"use strict";var a=e("../../constants/numerical");var n=a.BADNUM;var i=a.LOG_CLIP;var o=i+.5;var s=i-.5;var l=e("../../lib");var u=l.segmentsIntersect;var c=l.constrain;var f=e("./constants");t.exports=function e(t,r){var a=r.xaxis;var i=r.yaxis;var h=a.type==="log";var p=i.type==="log";var v=a._length;var d=i._length;var m=r.connectGaps;var g=r.baseTolerance;var y=r.shape;var x=y==="linear";var b=r.fill&&r.fill!=="none";var _=[];var w=f.minTolerance;var T=t.length;var k=new Array(T);var M=0;var A;var S,E,L,C;var I;var P;var O;var z;var D,R,F,B;var N,j,U;function V(e){var l=t[e];if(!l)return false;var u=r.linearized?a.l2p(l.x):a.c2p(l.x);var c=r.linearized?i.l2p(l.y):i.c2p(l.y);if(u===n){if(h)u=a.c2p(l.x,true);if(u===n)return false;if(p&&c===n){u*=Math.abs(a._m*d*(a._m>0?o:s)/(i._m*v*(i._m>0?o:s)))}u*=1e3}if(c===n){if(p)c=i.c2p(l.y,true);if(c===n)return false;c*=1e3}return[u,c]}function H(e,t,r,a){var n=r-e;var i=a-t;var o=.5-e;var s=.5-t;var l=n*n+i*i;var u=n*o+i*s;if(u>0&&u<l){var c=o*i-s*n;if(c*c<l)return true}}var q,G;function Y(e,t){var r=e[0]/v;var a=e[1]/d;var n=Math.max(0,-r,r-1,-a,a-1);if(n&&q!==undefined&&H(r,a,q,G)){n=0}if(n&&t&&H(r,a,t[0]/v,t[1]/d)){n=0}return(1+f.toleranceGrowth*n)*g}function W(e,t){var r=e[0]-t[0];var a=e[1]-t[1];return Math.sqrt(r*r+a*a)}var X=f.maxScreensAway;var Z=-v*X;var J=v*(1+X);var K=-d*X;var Q=d*(1+X);var $=[[Z,K,J,K],[J,K,J,Q],[J,Q,Z,Q],[Z,Q,Z,K]];var ee,te,re,ae,ne,ie;function oe(e,t){var r=[];var a=0;for(var n=0;n<4;n++){var i=$[n];var o=u(e[0],e[1],t[0],t[1],i[0],i[1],i[2],i[3]);if(o&&(!a||Math.abs(o.x-r[0][0])>1||Math.abs(o.y-r[0][1])>1)){o=[o.x,o.y];if(a&&W(o,e)<W(r[0],e))r.unshift(o);else r.push(o);a++}}return r}function se(e){if(e[0]<Z||e[0]>J||e[1]<K||e[1]>Q){return[c(e[0],Z,J),c(e[1],K,Q)]}}function le(e,t){if(e[0]===t[0]&&(e[0]===Z||e[0]===J))return true;if(e[1]===t[1]&&(e[1]===K||e[1]===Q))return true}function ue(e,t){var r=[];var a=se(e);var n=se(t);if(a&&n&&le(a,n))return r;if(a)r.push(a);if(n)r.push(n);return r}function ce(e,t,r){return function(a,n){var i=se(a);var o=se(n);var s=[];if(i&&o&&le(i,o))return s;if(i)s.push(i);if(o)s.push(o);var u=2*l.constrain((a[e]+n[e])/2,t,r)-((i||a)[e]+(o||n)[e]);if(u){var c;if(i&&o){c=u>0===i[e]>o[e]?i:o}else c=i||o;c[e]+=u}return s}}var fe;if(y==="linear"||y==="spline"){fe=oe}else if(y==="hv"||y==="vh"){fe=ue}else if(y==="hvh")fe=ce(0,Z,J);else if(y==="vhv")fe=ce(1,K,Q);function he(e,t){var r=t[0]-e[0];var a=(t[1]-e[1])/r;var n=(e[1]*t[0]-t[1]*e[0])/r;if(n>0)return[a>0?Z:J,Q];else return[a>0?J:Z,K]}function pe(e){var t=e[0];var r=e[1];var a=t===k[M-1][0];var n=r===k[M-1][1];if(a&&n)return;if(M>1){var i=t===k[M-2][0];var o=r===k[M-2][1];if(a&&(t===Z||t===J)&&i){if(o)M--;else k[M-1]=e}else if(n&&(r===K||r===Q)&&o){if(i)M--;else k[M-1]=e}else k[M++]=e}else k[M++]=e}function ve(e){if(k[M-1][0]!==e[0]&&k[M-1][1]!==e[1]){pe([re,ae])}pe(e);ne=null;re=ae=0}function de(e){q=e[0]/v;G=e[1]/d;ee=e[0]<Z?Z:e[0]>J?J:0;te=e[1]<K?K:e[1]>Q?Q:0;if(ee||te){if(!M){k[M++]=[ee||e[0],te||e[1]]}else if(ne){var t=fe(ne,e);if(t.length>1){ve(t[0]);k[M++]=t[1]}}else{ie=fe(k[M-1],e)[0];k[M++]=ie}var r=k[M-1];if(ee&&te&&(r[0]!==ee||r[1]!==te)){if(ne){if(re!==ee&&ae!==te){if(re&&ae){pe(he(ne,e))}else{pe([re||ee,ae||te])}}else if(re&&ae){pe([re,ae])}}pe([ee,te])}else if(re-ee&&ae-te){pe([ee||re,te||ae])}ne=e;re=ee;ae=te}else{if(ne){ve(fe(ne,e)[0])}k[M++]=e}}for(A=0;A<T;A++){S=V(A);if(!S)continue;M=0;ne=null;de(S);for(A++;A<T;A++){L=V(A);if(!L){if(m)continue;else break}if(!x||!r.simplify){de(L);continue}var me=V(A+1);D=W(L,S);if(!(b&&(M===0||M===T-1))&&D<Y(L,me)*w)continue;O=[(L[0]-S[0])/D,(L[1]-S[1])/D];C=S;R=D;F=N=j=0;P=false;E=L;for(A++;A<t.length;A++){I=me;me=V(A+1);if(!I){if(m)continue;else break}z=[I[0]-S[0],I[1]-S[1]];U=z[0]*O[1]-z[1]*O[0];N=Math.min(N,U);j=Math.max(j,U);if(j-N>Y(I,me))break;E=I;B=z[0]*O[0]+z[1]*O[1];if(B>R){R=B;L=I;P=false}else if(B<F){F=B;C=I;P=true}}if(P){de(L);if(E!==C)de(C)}else{if(C!==S)de(C);if(E!==L)de(L)}de(E);if(A>=t.length||!I)break;de(I);S=I}if(ne)pe([re||ne[0],ae||ne[1]]);_.push(k.slice(0,M))}return _}},{"../../constants/numerical":763,"../../lib":787,"./constants":1206}],1217:[function(e,t,r){"use strict";t.exports=function e(t,r,a){var n=a("line.shape");if(n==="spline")a("line.smoothing")}},{}],1218:[function(e,t,r){"use strict";var a={tonextx:1,tonexty:1,tonext:1};t.exports=function e(t,r,n){var i,o,s,l,u;var c={};var f=false;var h=-1;var p=0;var v=-1;for(o=0;o<n.length;o++){i=n[o][0].trace;s=i.stackgroup||"";if(s){if(s in c){u=c[s]}else{u=c[s]=p;p++}}else if(i.fill in a&&v>=0){u=v}else{u=v=p;p++}if(u<h)f=true;i._groupIndex=h=u}var d=n.slice();if(f){d.sort((function(e,t){var r=e[0].trace;var a=t[0].trace;return r._groupIndex-a._groupIndex||r.index-a.index}))}var m={};for(o=0;o<d.length;o++){i=d[o][0].trace;s=i.stackgroup||"";if(i.visible===true){i._nexttrace=null;if(i.fill in a){l=m[s];i._prevtrace=l||null;if(l){l._nexttrace=i}}i._ownfill=i.fill&&(i.fill.substr(0,6)==="tozero"||i.fill==="toself"||i.fill.substr(0,2)==="to"&&!i._prevtrace);m[s]=i}else{i._prevtrace=i._nexttrace=i._ownfill=null}}return d}},{}],1219:[function(e,t,r){"use strict";var a=e("fast-isnumeric");t.exports=function e(t,r){if(!r){r=2}var n=t.marker;var i=n.sizeref||1;var o=n.sizemin||0;var s=n.sizemode==="area"?function(e){return Math.sqrt(e/i)}:function(e){return e/i};return function(e){var t=s(e/r);return a(t)&&t>0?Math.max(t,o):0}}},{"fast-isnumeric":246}],1220:[function(e,t,r){"use strict";t.exports={container:"marker",min:"cmin",max:"cmax"}},{}],1221:[function(e,t,r){"use strict";var a=e("../../components/color");var n=e("../../components/colorscale/helpers").hasColorscale;var i=e("../../components/colorscale/defaults");var o=e("./subtypes");t.exports=function e(t,r,s,l,u,c){var f=o.isBubble(t);var h=(t.line||{}).color;var p;c=c||{};if(h)s=h;u("marker.symbol");u("marker.opacity",f?.7:1);u("marker.size");u("marker.color",s);if(n(t,"marker")){i(t,r,l,u,{prefix:"marker.",cLetter:"c"})}if(!c.noSelect){u("selected.marker.color");u("unselected.marker.color");u("selected.marker.size");u("unselected.marker.size")}if(!c.noLine){if(h&&!Array.isArray(h)&&r.marker.color!==h){p=h}else if(f)p=a.background;else p=a.defaultLine;u("marker.line.color",p);if(n(t,"marker.line")){i(t,r,l,u,{prefix:"marker.line.",cLetter:"c"})}u("marker.line.width",f?1:0)}if(f){u("marker.sizeref");u("marker.sizemin");u("marker.sizemode")}if(c.gradient){var v=u("marker.gradient.type");if(v!=="none"){u("marker.gradient.color")}}}},{"../../components/color":650,"../../components/colorscale/defaults":660,"../../components/colorscale/helpers":661,"./subtypes":1227}],1222:[function(e,t,r){"use strict";var a=e("../../lib").dateTick0;var n=e("../../constants/numerical");var i=n.ONEWEEK;function o(e,t){if(e%i===0){return a(t,1)}return a(t,0)}t.exports=function e(t,r,a,n,i){if(!i){i={x:true,y:true}}if(i.x){var s=n("xperiod");if(s){n("xperiod0",o(s,r.xcalendar));n("xperiodalignment")}}if(i.y){var l=n("yperiod");if(l){n("yperiod0",o(l,r.ycalendar));n("yperiodalignment")}}}},{"../../constants/numerical":763,"../../lib":787}],1223:[function(e,t,r){"use strict";var a=e("@plotly/d3");var n=e("../../registry");var i=e("../../lib");var o=i.ensureSingle;var s=i.identity;var l=e("../../components/drawing");var u=e("./subtypes");var c=e("./line_points");var f=e("./link_traces");var h=e("../../lib/polygon").tester;t.exports=function e(t,r,n,i,o,s){var l,u;var c=!o;var h=!!o&&o.duration>0;var d=f(t,r,n);l=i.selectAll("g.trace").data(d,(function(e){return e[0].trace.uid}));l.enter().append("g").attr("class",(function(e){return"trace scatter trace"+e[0].trace.uid})).style("stroke-miterlimit",2);l.order();p(t,l,r);if(h){if(s){u=s()}var m=a.transition().duration(o.duration).ease(o.easing).each("end",(function(){u&&u()})).each("interrupt",(function(){u&&u()}));m.each((function(){i.selectAll("g.trace").each((function(e,a){v(t,a,r,e,d,this,o)}))}))}else{l.each((function(e,a){v(t,a,r,e,d,this,o)}))}if(c){l.exit().remove()}i.selectAll("path:not([d])").remove()};function p(e,t,r){t.each((function(t){var n=o(a.select(this),"g","fills");l.setClipUrl(n,r.layerClipId,e);var i=t[0].trace;var u=[];if(i._ownfill)u.push("_ownFill");if(i._nexttrace)u.push("_nextFill");var c=n.selectAll("g").data(u,s);c.enter().append("g");c.exit().each((function(e){i[e]=null})).remove();c.order().each((function(e){i[e]=o(a.select(this),"path","js-fill")}))}))}function v(e,t,r,f,p,v,m){var g;d(e,t,r,f,p);var y=!!m&&m.duration>0;function x(e){return y?e.transition():e}var b=r.xaxis;var _=r.yaxis;var w=f[0].trace;var T=w.line;var k=a.select(v);var M=o(k,"g","errorbars");var A=o(k,"g","lines");var S=o(k,"g","points");var E=o(k,"g","text");n.getComponentMethod("errorbars","plot")(e,M,r,m);if(w.visible!==true)return;x(k).style("opacity",w.opacity);var L,C;var I=w.fill.charAt(w.fill.length-1);if(I!=="x"&&I!=="y")I="";f[0][r.isRangePlot?"nodeRangePlot3":"node3"]=k;var P="";var O=[];var z=w._prevtrace;if(z){P=z._prevRevpath||"";C=z._nextFill;O=z._polygons}var D;var R;var F="";var B="";var N,j,U;var V,H,q,G;var Y=[];var W=i.noop;L=w._ownFill;if(u.hasLines(w)||w.fill!=="none"){if(C){C.datum(f)}if(["hv","vh","hvh","vhv"].indexOf(T.shape)!==-1){N=l.steps(T.shape);j=l.steps(T.shape.split("").reverse().join(""))}else if(T.shape==="spline"){N=j=function(e){var t=e[e.length-1];if(e.length>1&&e[0][0]===t[0]&&e[0][1]===t[1]){return l.smoothclosed(e.slice(1),T.smoothing)}else{return l.smoothopen(e,T.smoothing)}}}else{N=j=function(e){return"M"+e.join("L")}}U=function(e){return j(e.reverse())};Y=c(f,{xaxis:b,yaxis:_,connectGaps:w.connectgaps,baseTolerance:Math.max(T.width||1,3)/4,shape:T.shape,simplify:T.simplify,fill:w.fill});G=w._polygons=new Array(Y.length);for(g=0;g<Y.length;g++){w._polygons[g]=h(Y[g])}if(Y.length){V=Y[0][0];H=Y[Y.length-1];q=H[H.length-1]}W=function(e){return function(t){D=N(t);R=U(t);if(!F){F=D;B=R}else if(I){F+="L"+D.substr(1);B=R+("L"+B.substr(1))}else{F+="Z"+D;B=R+"Z"+B}if(u.hasLines(w)&&t.length>1){var r=a.select(this);r.datum(f);if(e){x(r.style("opacity",0).attr("d",D).call(l.lineGroupStyle)).style("opacity",1)}else{var n=x(r);n.attr("d",D);l.singleLineStyle(f,n)}}}}}var X=A.selectAll(".js-line").data(Y);x(X.exit()).style("opacity",0).remove();X.each(W(false));X.enter().append("path").classed("js-line",true).style("vector-effect","non-scaling-stroke").call(l.lineGroupStyle).each(W(true));l.setClipUrl(X,r.layerClipId,e);function Z(e){x(e).attr("d","M0,0Z")}if(Y.length){if(L){L.datum(f);if(V&&q){if(I){if(I==="y"){V[1]=q[1]=_.c2p(0,true)}else if(I==="x"){V[0]=q[0]=b.c2p(0,true)}x(L).attr("d","M"+q+"L"+V+"L"+F.substr(1)).call(l.singleFillStyle)}else{x(L).attr("d",F+"Z").call(l.singleFillStyle)}}}else if(C){if(w.fill.substr(0,6)==="tonext"&&F&&P){if(w.fill==="tonext"){x(C).attr("d",F+"Z"+P+"Z").call(l.singleFillStyle)}else{x(C).attr("d",F+"L"+P.substr(1)+"Z").call(l.singleFillStyle)}w._polygons=w._polygons.concat(O)}else{Z(C);w._polygons=null}}w._prevRevpath=B;w._prevPolygons=G}else{if(L)Z(L);else if(C)Z(C);w._polygons=w._prevRevpath=w._prevPolygons=null}function J(e){return e.filter((function(e){return!e.gap&&e.vis}))}function K(e){return e.filter((function(e){return e.vis}))}function Q(e){return e.filter((function(e){return!e.gap}))}function $(e){return e.id}function ee(e){if(e.ids){return $}}function te(){return false}function re(t,n,i){var o,c,f;var h=i[0].trace;var p=u.hasMarkers(h);var v=u.hasText(h);var d=ee(h);var m=te;var g=te;if(p||v){var w=s;var T=h.stackgroup;var k=T&&e._fullLayout._scatterStackOpts[b._id+_._id][T].stackgaps==="infer zero";if(h.marker.maxdisplayed||h._needsCull){w=k?K:J}else if(T&&!k){w=Q}if(p)m=w;if(v)g=w}c=t.selectAll("path.point");o=c.data(m,d);var M=o.enter().append("path").classed("point",true);if(y){M.call(l.pointStyle,h,e).call(l.translatePoints,b,_).style("opacity",0).transition().style("opacity",1)}o.order();var A;if(p){A=l.makePointStyleFns(h)}o.each((function(t){var n=a.select(this);var i=x(n);f=l.translatePoint(t,i,b,_);if(f){l.singlePointStyle(t,i,h,A,e);if(r.layerClipId){l.hideOutsideRangePoint(t,i,b,_,h.xcalendar,h.ycalendar)}if(h.customdata){n.classed("plotly-customdata",t.data!==null&&t.data!==undefined)}}else{i.remove()}}));if(y){o.exit().transition().style("opacity",0).remove()}else{o.exit().remove()}c=n.selectAll("g");o=c.data(g,d);o.enter().append("g").classed("textpoint",true).append("text");o.order();o.each((function(e){var t=a.select(this);var n=x(t.select("text"));f=l.translatePoint(e,n,b,_);if(f){if(r.layerClipId){l.hideOutsideRangePoint(e,t,b,_,h.xcalendar,h.ycalendar)}}else{t.remove()}}));o.selectAll("text").call(l.textPointStyle,h,e).each((function(e){var t=b.c2p(e.x);var r=_.c2p(e.y);a.select(this).selectAll("tspan.line").each((function(){x(a.select(this)).attr({x:t,y:r})}))}));o.exit().remove()}S.datum(f);E.datum(f);re(S,E,f);var ae=w.cliponaxis===false;var ne=ae?null:r.layerClipId;l.setClipUrl(S,ne,e);l.setClipUrl(E,ne,e)}function d(e,t,r,n,o){var s=r.xaxis;var l=r.yaxis;var c=a.extent(i.simpleMap(s.range,s.r2c));var f=a.extent(i.simpleMap(l.range,l.r2c));var h=n[0].trace;if(!u.hasMarkers(h))return;var p=h.marker.maxdisplayed;if(p===0)return;var v=n.filter((function(e){return e.x>=c[0]&&e.x<=c[1]&&e.y>=f[0]&&e.y<=f[1]}));var d=Math.ceil(v.length/p);var m=0;o.forEach((function(e,r){var a=e[0].trace;if(u.hasMarkers(a)&&a.marker.maxdisplayed>0&&r<t){m++}}));var g=Math.round(m*d/3+Math.floor(m/3)*d/7.1);n.forEach((function(e){delete e.vis}));v.forEach((function(e,t){if(Math.round((t+g)%d)===0)e.vis=true}))}},{"../../components/drawing":672,"../../lib":787,"../../lib/polygon":799,"../../registry":915,"./line_points":1216,"./link_traces":1218,"./subtypes":1227,"@plotly/d3":58}],1224:[function(e,t,r){"use strict";var a=e("./subtypes");t.exports=function e(t,r){var n=t.cd;var i=t.xaxis;var o=t.yaxis;var s=[];var l=n[0].trace;var u;var c;var f;var h;var p=!a.hasMarkers(l)&&!a.hasText(l);if(p)return[];if(r===false){for(u=0;u<n.length;u++){n[u].selected=0}}else{for(u=0;u<n.length;u++){c=n[u];f=i.c2p(c.x);h=o.c2p(c.y);if(c.i!==null&&r.contains([f,h],false,u,t)){s.push({pointNumber:c.i,x:i.c2d(c.x),y:o.c2d(c.y)});c.selected=1}else{c.selected=0}}}return s}},{"./subtypes":1227}],1225:[function(e,t,r){"use strict";var a=["orientation","groupnorm","stackgaps"];t.exports=function e(t,r,n,i){var o=n._scatterStackOpts;var s=i("stackgroup");if(s){var l=r.xaxis+r.yaxis;var u=o[l];if(!u)u=o[l]={};var c=u[s];var f=false;if(c){c.traces.push(r)}else{c=u[s]={traceIndices:[],traces:[r]};f=true}var h={orientation:r.x&&!r.y?"h":"v"};for(var p=0;p<a.length;p++){var v=a[p];var d=v+"Found";if(!c[d]){var m=t[v]!==undefined;var g=v==="orientation";if(m||f){c[v]=i(v,h[v]);if(g){c.fillDflt=c[v]==="h"?"tonextx":"tonexty"}if(m){c[d]=true;if(!f){delete c.traces[0][v];if(g){for(var y=0;y<c.traces.length-1;y++){var x=c.traces[y];if(x._input.fill!==x.fill){x.fill=c.fillDflt}}}}}}}}return c}}},{}],1226:[function(e,t,r){"use strict";var a=e("@plotly/d3");var n=e("../../components/drawing");var i=e("../../registry");function o(e){var t=a.select(e).selectAll("g.trace.scatter");t.style("opacity",(function(e){return e[0].trace.opacity}));t.selectAll("g.points").each((function(t){var r=a.select(this);var n=t.trace||t[0].trace;s(r,n,e)}));t.selectAll("g.text").each((function(t){var r=a.select(this);var n=t.trace||t[0].trace;l(r,n,e)}));t.selectAll("g.trace path.js-line").call(n.lineGroupStyle);t.selectAll("g.trace path.js-fill").call(n.fillGroupStyle);i.getComponentMethod("errorbars","style")(t)}function s(e,t,r){n.pointStyle(e.selectAll("path.point"),t,r)}function l(e,t,r){n.textPointStyle(e.selectAll("text"),t,r)}function u(e,t,r){var a=t[0].trace;if(a.selectedpoints){n.selectedPointStyle(r.selectAll("path.point"),a);n.selectedTextStyle(r.selectAll("text"),a)}else{s(r,a,e);l(r,a,e)}}t.exports={style:o,stylePoints:s,styleText:l,styleOnSelect:u}},{"../../components/drawing":672,"../../registry":915,"@plotly/d3":58}],1227:[function(e,t,r){"use strict";var a=e("../../lib");t.exports={hasLines:function(e){return e.visible&&e.mode&&e.mode.indexOf("lines")!==-1},hasMarkers:function(e){return e.visible&&(e.mode&&e.mode.indexOf("markers")!==-1||e.type==="splom")},hasText:function(e){return e.visible&&e.mode&&e.mode.indexOf("text")!==-1},isBubble:function(e){return a.isPlainObject(e.marker)&&a.isArrayOrTypedArray(e.marker.size)}}},{"../../lib":787}],1228:[function(e,t,r){"use strict";var a=e("../../lib");t.exports=function(e,t,r,n,i){i=i||{};n("textposition");a.coerceFont(n,"textfont",r.font);if(!i.noSelect){n("selected.textfont.color");n("unselected.textfont.color")}}},{"../../lib":787}],1229:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("../../registry");t.exports=function e(t,r,i,o){var s=o("x");var l=o("y");var u;var c=n.getComponentMethod("calendars","handleTraceDefaults");c(t,r,["x","y"],i);if(s){var f=a.minRowLength(s);if(l){u=Math.min(f,a.minRowLength(l))}else{u=f;o("y0");o("dy")}}else{if(!l)return 0;u=a.minRowLength(l);o("x0");o("dx")}r._length=u;return u}},{"../../lib":787,"../../registry":915}],1230:[function(e,t,r){"use strict";var a=e("../scatter/attributes");var n=e("../../components/colorscale/attributes");var i=e("../../plots/cartesian/axis_format_attributes").axisHoverFormat;var o=e("../../plots/template_attributes").hovertemplateAttrs;var s=e("../../plots/template_attributes").texttemplateAttrs;var l=e("../../plots/attributes");var u=e("../../constants/gl3d_dashes");var c=e("../../constants/gl3d_markers");var f=e("../../lib/extend").extendFlat;var h=e("../../plot_api/edit_types").overrideAll;var p=e("../../lib/sort_object_keys");var v=a.line;var d=a.marker;var m=d.line;var g=f({width:v.width,dash:{valType:"enumerated",values:p(u),dflt:"solid"}},n("line"));function y(e){return{show:{valType:"boolean",dflt:false},opacity:{valType:"number",min:0,max:1,dflt:1},scale:{valType:"number",min:0,max:10,dflt:2/3}}}var x=t.exports=h({x:a.x,y:a.y,z:{valType:"data_array"},text:f({},a.text,{}),texttemplate:s({},{}),hovertext:f({},a.hovertext,{}),hovertemplate:o(),xhoverformat:i("x"),yhoverformat:i("y"),zhoverformat:i("z"),mode:f({},a.mode,{dflt:"lines+markers"}),surfaceaxis:{valType:"enumerated",values:[-1,0,1,2],dflt:-1},surfacecolor:{valType:"color"},projection:{x:y("x"),y:y("y"),z:y("z")},connectgaps:a.connectgaps,line:g,marker:f({symbol:{valType:"enumerated",values:p(c),dflt:"circle",arrayOk:true},size:f({},d.size,{dflt:8}),sizeref:d.sizeref,sizemin:d.sizemin,sizemode:d.sizemode,opacity:f({},d.opacity,{arrayOk:false}),colorbar:d.colorbar,line:f({width:f({},m.width,{arrayOk:false})},n("marker.line"))},n("marker")),textposition:f({},a.textposition,{dflt:"top center"}),textfont:{color:a.textfont.color,size:a.textfont.size,family:f({},a.textfont.family,{arrayOk:false})},hoverinfo:f({},l.hoverinfo)},"calc","nested");x.x.editType=x.y.editType=x.z.editType="calc+clearAxisTypes"},{"../../components/colorscale/attributes":657,"../../constants/gl3d_dashes":760,"../../constants/gl3d_markers":761,"../../lib/extend":777,"../../lib/sort_object_keys":810,"../../plot_api/edit_types":820,"../../plots/attributes":834,"../../plots/cartesian/axis_format_attributes":841,"../../plots/template_attributes":910,"../scatter/attributes":1202}],1231:[function(e,t,r){"use strict";var a=e("../scatter/arrays_to_calcdata");var n=e("../scatter/colorscale_calc");t.exports=function e(t,r){var i=[{x:false,y:false,trace:r,t:{}}];a(i,r);n(t,r);return i}},{"../scatter/arrays_to_calcdata":1201,"../scatter/colorscale_calc":1205}],1232:[function(e,t,r){"use strict";var a=e("../../registry");function n(e,t,r,n){if(!t||!t.visible)return null;var i=a.getComponentMethod("errorbars","makeComputeError")(t);var o=new Array(e.length);for(var s=0;s<e.length;s++){var l=i(+e[s],s);if(n.type==="log"){var u=n.c2l(e[s]);var c=e[s]-l[0];var f=e[s]+l[1];o[s]=[(n.c2l(c,true)-u)*r,(n.c2l(f,true)-u)*r];if(c>0){var h=n.c2l(c);if(!n._lowerLogErrorBound)n._lowerLogErrorBound=h;n._lowerErrorBound=Math.min(n._lowerLogErrorBound,h)}}else{o[s]=[-l[0]*r,l[1]*r]}}return o}function i(e){for(var t=0;t<e.length;t++){if(e[t])return e[t].length}return 0}function o(e,t,r){var a=[n(e.x,e.error_x,t[0],r.xaxis),n(e.y,e.error_y,t[1],r.yaxis),n(e.z,e.error_z,t[2],r.zaxis)];var o=i(a);if(o===0)return null;var s=new Array(o);for(var l=0;l<o;l++){var u=[[0,0,0],[0,0,0]];for(var c=0;c<3;c++){if(a[c]){for(var f=0;f<2;f++){u[f][c]=a[c][l][f]}}}s[l]=u}return s}t.exports=o},{"../../registry":915}],1233:[function(e,t,r){"use strict";var a=e("gl-line3d");var n=e("gl-scatter3d");var i=e("gl-error3d");var o=e("gl-mesh3d");var s=e("delaunay-triangulate");var l=e("../../lib");var u=e("../../lib/str2rgbarray");var c=e("../../lib/gl_format_color").formatColor;var f=e("../scatter/make_bubble_size_func");var h=e("../../constants/gl3d_dashes");var p=e("../../constants/gl3d_markers");var v=e("../../plots/cartesian/axes");var d=e("../../components/fx/helpers").appendArrayPointValue;var m=e("./calc_errors");function g(e,t){this.scene=e;this.uid=t;this.linePlot=null;this.scatterPlot=null;this.errorBars=null;this.textMarkers=null;this.delaunayMesh=null;this.color=null;this.mode="";this.dataPoints=[];this.axesBounds=[[-Infinity,-Infinity,-Infinity],[Infinity,Infinity,Infinity]];this.textLabels=null;this.data=null}var y=g.prototype;y.handlePick=function(e){if(e.object&&(e.object===this.linePlot||e.object===this.delaunayMesh||e.object===this.textMarkers||e.object===this.scatterPlot)){var t=e.index=e.data.index;if(e.object.highlight){e.object.highlight(null)}if(this.scatterPlot){e.object=this.scatterPlot;this.scatterPlot.highlight(e.data)}e.textLabel="";if(this.textLabels){if(Array.isArray(this.textLabels)){if(this.textLabels[t]||this.textLabels[t]===0){e.textLabel=this.textLabels[t]}}else{e.textLabel=this.textLabels}}e.traceCoordinate=[this.data.x[t],this.data.y[t],this.data.z[t]];return true}};function x(e,t,r){var a=(r+1)%3;var n=(r+2)%3;var i=[];var o=[];var l;for(l=0;l<e.length;++l){var u=e[l];if(isNaN(u[a])||!isFinite(u[a])||isNaN(u[n])||!isFinite(u[n])){continue}i.push([u[a],u[n]]);o.push(l)}var c=s(i);for(l=0;l<c.length;++l){var f=c[l];for(var h=0;h<f.length;++h){f[h]=o[f[h]]}}return{positions:e,cells:c,meshColor:t}}function b(e){var t=[0,0,0];var r=[[0,0,0],[0,0,0],[0,0,0]];var a=[1,1,1];for(var n=0;n<3;n++){var i=e[n];if(i&&i.copy_zstyle!==false&&e[2].visible!==false)i=e[2];if(!i||!i.visible)continue;t[n]=i.width/2;r[n]=u(i.color);a[n]=i.thickness}return{capSize:t,color:r,lineWidth:a}}function _(e){if(e===null||e===undefined)return 0;return e.indexOf("left")>-1?-1:e.indexOf("right")>-1?1:0}function w(e){if(e===null||e===undefined)return 0;return e.indexOf("top")>-1?-1:e.indexOf("bottom")>-1?1:0}function T(e){var t=0;var r=0;var a=[t,r];if(Array.isArray(e)){for(var n=0;n<e.length;n++){a[n]=[t,r];if(e[n]){a[n][0]=_(e[n]);a[n][1]=w(e[n])}}}else{a[0]=_(e);a[1]=w(e)}return a}function k(e,t){return t(e*4)}function M(e){return p[e]}function A(e,t,r,a,n){var i=null;if(l.isArrayOrTypedArray(e)){i=[];for(var o=0;o<t;o++){if(e[o]===undefined)i[o]=a;else i[o]=r(e[o],n)}}else i=r(e,l.identity);return i}function S(e,t){var r=[];var a=e.fullSceneLayout;var n=e.dataScale;var i=a.xaxis;var o=a.yaxis;var s=a.zaxis;var h=t.marker;var p=t.line;var g=t.x||[];var y=t.y||[];var x=t.z||[];var _=g.length;var w=t.xcalendar;var S=t.ycalendar;var E=t.zcalendar;var L,C,I;var P,O;var z;for(O=0;O<_;O++){L=i.d2l(g[O],0,w)*n[0];C=o.d2l(y[O],0,S)*n[1];I=s.d2l(x[O],0,E)*n[2];r[O]=[L,C,I]}if(Array.isArray(t.text))z=t.text;else if(t.text!==undefined){z=new Array(_);for(O=0;O<_;O++)z[O]=t.text}function D(e,t){var r=a[e];return v.tickText(r,r.d2l(t),true).text}var R=t.texttemplate;if(R){var F=e.fullLayout;var B=F._d3locale;var N=Array.isArray(R);var j=N?Math.min(R.length,_):_;var U=N?function(e){return R[e]}:function(){return R};z=new Array(j);for(O=0;O<j;O++){var V={x:g[O],y:y[O],z:x[O]};var H={xLabel:D("xaxis",g[O]),yLabel:D("yaxis",y[O]),zLabel:D("zaxis",x[O])};var q={};d(q,t,O);var G=t._meta||{};z[O]=l.texttemplateString(U(O),H,B,q,V,G)}}P={position:r,mode:t.mode,text:z};if("line"in t){P.lineColor=c(p,1,_);P.lineWidth=p.width;P.lineDashes=p.dash}if("marker"in t){var Y=f(t);P.scatterColor=c(h,1,_);P.scatterSize=A(h.size,_,k,20,Y);P.scatterMarker=A(h.symbol,_,M,"●");P.scatterLineWidth=h.line.width;P.scatterLineColor=c(h.line,1,_);P.scatterAngle=0}if("textposition"in t){P.textOffset=T(t.textposition);P.textColor=c(t.textfont,1,_);P.textSize=A(t.textfont.size,_,l.identity,12);P.textFont=t.textfont.family;P.textAngle=0}var W=["x","y","z"];P.project=[false,false,false];P.projectScale=[1,1,1];P.projectOpacity=[1,1,1];for(O=0;O<3;++O){var X=t.projection[W[O]];if(P.project[O]=X.show){P.projectOpacity[O]=X.opacity;P.projectScale[O]=X.scale}}P.errorBounds=m(t,n,a);var Z=b([t.error_x,t.error_y,t.error_z]);P.errorColor=Z.color;P.errorLineWidth=Z.lineWidth;P.errorCapSize=Z.capSize;P.delaunayAxis=t.surfaceaxis;P.delaunayColor=u(t.surfacecolor);return P}function E(e){if(l.isArrayOrTypedArray(e)){var t=e[0];if(l.isArrayOrTypedArray(t))e=t;return"rgb("+e.slice(0,3).map((function(e){return Math.round(e*255)}))+")"}return null}function L(e){if(!l.isArrayOrTypedArray(e)){return null}if(e.length===4&&typeof e[0]==="number"){return E(e)}return e.map(E)}y.update=function(e){var t=this.scene.glplot.gl;var r;var s;var l;var u;var c=h.solid;this.data=e;var f=S(this.scene,e);if("mode"in f){this.mode=f.mode}if("lineDashes"in f){if(f.lineDashes in h){c=h[f.lineDashes]}}this.color=L(f.scatterColor)||L(f.lineColor);this.dataPoints=f.position;r={gl:this.scene.glplot.gl,position:f.position,color:f.lineColor,lineWidth:f.lineWidth||1,dashes:c[0],dashScale:c[1],opacity:e.opacity,connectGaps:e.connectgaps};if(this.mode.indexOf("lines")!==-1){if(this.linePlot)this.linePlot.update(r);else{this.linePlot=a(r);this.linePlot._trace=this;this.scene.glplot.add(this.linePlot)}}else if(this.linePlot){this.scene.glplot.remove(this.linePlot);this.linePlot.dispose();this.linePlot=null}var p=e.opacity;if(e.marker&&e.marker.opacity)p*=e.marker.opacity;s={gl:this.scene.glplot.gl,position:f.position,color:f.scatterColor,size:f.scatterSize,glyph:f.scatterMarker,opacity:p,orthographic:true,lineWidth:f.scatterLineWidth,lineColor:f.scatterLineColor,project:f.project,projectScale:f.projectScale,projectOpacity:f.projectOpacity};if(this.mode.indexOf("markers")!==-1){if(this.scatterPlot)this.scatterPlot.update(s);else{this.scatterPlot=n(s);this.scatterPlot._trace=this;this.scatterPlot.highlightScale=1;this.scene.glplot.add(this.scatterPlot)}}else if(this.scatterPlot){this.scene.glplot.remove(this.scatterPlot);this.scatterPlot.dispose();this.scatterPlot=null}u={gl:this.scene.glplot.gl,position:f.position,glyph:f.text,color:f.textColor,size:f.textSize,angle:f.textAngle,alignment:f.textOffset,font:f.textFont,orthographic:true,lineWidth:0,project:false,opacity:e.opacity};this.textLabels=e.hovertext||e.text;if(this.mode.indexOf("text")!==-1){if(this.textMarkers)this.textMarkers.update(u);else{this.textMarkers=n(u);this.textMarkers._trace=this;this.textMarkers.highlightScale=1;this.scene.glplot.add(this.textMarkers)}}else if(this.textMarkers){this.scene.glplot.remove(this.textMarkers);this.textMarkers.dispose();this.textMarkers=null}l={gl:this.scene.glplot.gl,position:f.position,color:f.errorColor,error:f.errorBounds,lineWidth:f.errorLineWidth,capSize:f.errorCapSize,opacity:e.opacity};if(this.errorBars){if(f.errorBounds){this.errorBars.update(l)}else{this.scene.glplot.remove(this.errorBars);this.errorBars.dispose();this.errorBars=null}}else if(f.errorBounds){this.errorBars=i(l);this.errorBars._trace=this;this.scene.glplot.add(this.errorBars)}if(f.delaunayAxis>=0){var v=x(f.position,f.delaunayColor,f.delaunayAxis);v.opacity=e.opacity;if(this.delaunayMesh){this.delaunayMesh.update(v)}else{v.gl=t;this.delaunayMesh=o(v);this.delaunayMesh._trace=this;this.scene.glplot.add(this.delaunayMesh)}}else if(this.delaunayMesh){this.scene.glplot.remove(this.delaunayMesh);this.delaunayMesh.dispose();this.delaunayMesh=null}};y.dispose=function(){if(this.linePlot){this.scene.glplot.remove(this.linePlot);this.linePlot.dispose()}if(this.scatterPlot){this.scene.glplot.remove(this.scatterPlot);this.scatterPlot.dispose()}if(this.errorBars){this.scene.glplot.remove(this.errorBars);this.errorBars.dispose()}if(this.textMarkers){this.scene.glplot.remove(this.textMarkers);this.textMarkers.dispose()}if(this.delaunayMesh){this.scene.glplot.remove(this.delaunayMesh);this.delaunayMesh.dispose()}};function C(e,t){var r=new g(e,t.uid);r.update(t);return r}t.exports=C},{"../../components/fx/helpers":686,"../../constants/gl3d_dashes":760,"../../constants/gl3d_markers":761,"../../lib":787,"../../lib/gl_format_color":783,"../../lib/str2rgbarray":812,"../../plots/cartesian/axes":838,"../scatter/make_bubble_size_func":1219,"./calc_errors":1232,"delaunay-triangulate":177,"gl-error3d":267,"gl-line3d":275,"gl-mesh3d":309,"gl-scatter3d":327}],1234:[function(e,t,r){"use strict";var a=e("../../registry");var n=e("../../lib");var i=e("../scatter/subtypes");var o=e("../scatter/marker_defaults");var s=e("../scatter/line_defaults");var l=e("../scatter/text_defaults");var u=e("./attributes");t.exports=function e(t,r,f,h){function p(e,a){return n.coerce(t,r,u,e,a)}var v=c(t,r,p,h);if(!v){r.visible=false;return}p("text");p("hovertext");p("hovertemplate");p("xhoverformat");p("yhoverformat");p("zhoverformat");p("mode");if(i.hasLines(r)){p("connectgaps");s(t,r,f,h,p)}if(i.hasMarkers(r)){o(t,r,f,h,p,{noSelect:true})}if(i.hasText(r)){p("texttemplate");l(t,r,h,p,{noSelect:true})}var d=(r.line||{}).color;var m=(r.marker||{}).color;if(p("surfaceaxis")>=0)p("surfacecolor",d||m);var g=["x","y","z"];for(var y=0;y<3;++y){var x="projection."+g[y];if(p(x+".show")){p(x+".opacity");p(x+".scale")}}var b=a.getComponentMethod("errorbars","supplyDefaults");b(t,r,d||m||f,{axis:"z"});b(t,r,d||m||f,{axis:"y",inherit:"z"});b(t,r,d||m||f,{axis:"x",inherit:"z"})};function c(e,t,r,n){var i=0;var o=r("x");var s=r("y");var l=r("z");var u=a.getComponentMethod("calendars","handleTraceDefaults");u(e,t,["x","y","z"],n);if(o&&s&&l){i=Math.min(o.length,s.length,l.length);t._length=t._xlength=t._ylength=t._zlength=i}return i}},{"../../lib":787,"../../registry":915,"../scatter/line_defaults":1215,"../scatter/marker_defaults":1221,"../scatter/subtypes":1227,"../scatter/text_defaults":1228,"./attributes":1230}],1235:[function(e,t,r){"use strict";t.exports={plot:e("./convert"),attributes:e("./attributes"),markerSymbols:e("../../constants/gl3d_markers"),supplyDefaults:e("./defaults"),colorbar:[{container:"marker",min:"cmin",max:"cmax"},{container:"line",min:"cmin",max:"cmax"}],calc:e("./calc"),moduleType:"trace",name:"scatter3d",basePlotModule:e("../../plots/gl3d"),categories:["gl3d","symbols","showLegend","scatter-like"],meta:{}}},{"../../constants/gl3d_markers":761,"../../plots/gl3d":880,"./attributes":1230,"./calc":1231,"./convert":1233,"./defaults":1234}],1236:[function(e,t,r){"use strict";var a=e("../scatter/attributes");var n=e("../../plots/attributes");var i=e("../../plots/template_attributes").hovertemplateAttrs;var o=e("../../plots/template_attributes").texttemplateAttrs;var s=e("../../components/colorscale/attributes");var l=e("../../lib/extend").extendFlat;var u=a.marker;var c=a.line;var f=u.line;t.exports={carpet:{valType:"string",editType:"calc"},a:{valType:"data_array",editType:"calc"},b:{valType:"data_array",editType:"calc"},mode:l({},a.mode,{dflt:"markers"}),text:l({},a.text,{}),texttemplate:o({editType:"plot"},{keys:["a","b","text"]}),hovertext:l({},a.hovertext,{}),line:{color:c.color,width:c.width,dash:c.dash,shape:l({},c.shape,{values:["linear","spline"]}),smoothing:c.smoothing,editType:"calc"},connectgaps:a.connectgaps,fill:l({},a.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:a.fillcolor,marker:l({symbol:u.symbol,opacity:u.opacity,maxdisplayed:u.maxdisplayed,size:u.size,sizeref:u.sizeref,sizemin:u.sizemin,sizemode:u.sizemode,line:l({width:f.width,editType:"calc"},s("marker.line")),gradient:u.gradient,editType:"calc"},s("marker")),textfont:a.textfont,textposition:a.textposition,selected:a.selected,unselected:a.unselected,hoverinfo:l({},n.hoverinfo,{flags:["a","b","text","name"]}),hoveron:a.hoveron,hovertemplate:i()}},{"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../plots/attributes":834,"../../plots/template_attributes":910,"../scatter/attributes":1202}],1237:[function(e,t,r){"use strict";var a=e("fast-isnumeric");var n=e("../scatter/colorscale_calc");var i=e("../scatter/arrays_to_calcdata");var o=e("../scatter/calc_selection");var s=e("../scatter/calc").calcMarkerSize;var l=e("../carpet/lookup_carpetid");t.exports=function e(t,r){var u=r._carpetTrace=l(t,r);if(!u||!u.visible||u.visible==="legendonly")return;var c;r.xaxis=u.xaxis;r.yaxis=u.yaxis;var f=r._length;var h=new Array(f);var p,v;var d=false;for(c=0;c<f;c++){p=r.a[c];v=r.b[c];if(a(p)&&a(v)){var m=u.ab2xy(+p,+v,true);var g=u.isVisible(+p,+v);if(!g)d=true;h[c]={x:m[0],y:m[1],a:p,b:v,vis:g}}else h[c]={x:false,y:false}}r._needsCull=d;h[0].carpet=u;h[0].trace=r;s(r,f);n(t,r);i(h,r);o(h,r);return h}},{"../carpet/lookup_carpetid":985,"../scatter/arrays_to_calcdata":1201,"../scatter/calc":1203,"../scatter/calc_selection":1204,"../scatter/colorscale_calc":1205,"fast-isnumeric":246}],1238:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("../scatter/constants");var i=e("../scatter/subtypes");var o=e("../scatter/marker_defaults");var s=e("../scatter/line_defaults");var l=e("../scatter/line_shape_defaults");var u=e("../scatter/text_defaults");var c=e("../scatter/fillcolor_defaults");var f=e("./attributes");t.exports=function e(t,r,h,p){function v(e,n){return a.coerce(t,r,f,e,n)}v("carpet");r.xaxis="x";r.yaxis="y";var d=v("a");var m=v("b");var g=Math.min(d.length,m.length);if(!g){r.visible=false;return}r._length=g;v("text");v("texttemplate");v("hovertext");var y=g<n.PTS_LINESONLY?"lines+markers":"lines";v("mode",y);if(i.hasLines(r)){s(t,r,h,p,v);l(t,r,v);v("connectgaps")}if(i.hasMarkers(r)){o(t,r,h,p,v,{gradient:true})}if(i.hasText(r)){u(t,r,p,v)}var x=[];if(i.hasMarkers(r)||i.hasText(r)){v("marker.maxdisplayed");x.push("points")}v("fill");if(r.fill!=="none"){c(t,r,h,v);if(!i.hasLines(r))l(t,r,v)}if(r.fill==="tonext"||r.fill==="toself"){x.push("fills")}var b=v("hoveron",x.join("+")||"points");if(b!=="fills")v("hovertemplate");a.coerceSelectionMarkerOpacity(r,v)}},{"../../lib":787,"../scatter/constants":1206,"../scatter/fillcolor_defaults":1210,"../scatter/line_defaults":1215,"../scatter/line_shape_defaults":1217,"../scatter/marker_defaults":1221,"../scatter/subtypes":1227,"../scatter/text_defaults":1228,"./attributes":1236}],1239:[function(e,t,r){"use strict";t.exports=function e(t,r,a,n,i){var o=n[i];t.a=o.a;t.b=o.b;t.y=o.y;return t}},{}],1240:[function(e,t,r){"use strict";t.exports=function e(t,r){var a={};var n=r._carpet;var i=n.ab2ij([t.a,t.b]);var o=Math.floor(i[0]);var s=i[0]-o;var l=Math.floor(i[1]);var u=i[1]-l;var c=n.evalxy([],o,l,s,u);a.yLabel=c[1].toFixed(3);return a}},{}],1241:[function(e,t,r){"use strict";var a=e("../scatter/hover");var n=e("../../lib").fillText;t.exports=function e(t,r,i,o){var s=a(t,r,i,o);if(!s||s[0].index===false)return;var l=s[0];if(l.index===undefined){var u=1-l.y0/t.ya._length;var c=t.xa._length;var f=c*u/2;var h=c-f;l.x0=Math.max(Math.min(l.x0,h),f);l.x1=Math.max(Math.min(l.x1,h),f);return s}var p=l.cd[l.index];l.a=p.a;l.b=p.b;l.xLabelVal=undefined;l.yLabelVal=undefined;var v=l.trace;var d=v._carpet;var m=v._module.formatLabels(p,v);l.yLabel=m.yLabel;delete l.text;var g=[];function y(e,t){var r;if(e.labelprefix&&e.labelprefix.length>0){r=e.labelprefix.replace(/ = $/,"")}else{r=e._hovertitle}g.push(r+": "+t.toFixed(3)+e.labelsuffix)}if(!v.hovertemplate){var x=p.hi||v.hoverinfo;var b=x.split("+");if(b.indexOf("all")!==-1)b=["a","b","text"];if(b.indexOf("a")!==-1)y(d.aaxis,p.a);if(b.indexOf("b")!==-1)y(d.baxis,p.b);g.push("y: "+l.yLabel);if(b.indexOf("text")!==-1){n(p,v,g)}l.extraText=g.join("<br>")}return s}},{"../../lib":787,"../scatter/hover":1213}],1242:[function(e,t,r){"use strict";t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),colorbar:e("../scatter/marker_colorbar"),formatLabels:e("./format_labels"),calc:e("./calc"),plot:e("./plot"),style:e("../scatter/style").style,styleOnSelect:e("../scatter/style").styleOnSelect,hoverPoints:e("./hover"),selectPoints:e("../scatter/select"),eventData:e("./event_data"),moduleType:"trace",name:"scattercarpet",basePlotModule:e("../../plots/cartesian"),categories:["svg","carpet","symbols","showLegend","carpetDependent","zoomScale"],meta:{}}},{"../../plots/cartesian":852,"../scatter/marker_colorbar":1220,"../scatter/select":1224,"../scatter/style":1226,"./attributes":1236,"./calc":1237,"./defaults":1238,"./event_data":1239,"./format_labels":1240,"./hover":1241,"./plot":1243}],1243:[function(e,t,r){"use strict";var a=e("../scatter/plot");var n=e("../../plots/cartesian/axes");var i=e("../../components/drawing");t.exports=function e(t,r,o,s){var l,u,c;var f=o[0][0].carpet;var h={xaxis:n.getFromId(t,f.xaxis||"x"),yaxis:n.getFromId(t,f.yaxis||"y"),plot:r.plot};a(t,h,o,s);for(l=0;l<o.length;l++){u=o[l][0].trace;c=s.selectAll("g.trace"+u.uid+" .js-line");i.setClipUrl(c,o[l][0].carpet._clipPathId,t)}}},{"../../components/drawing":672,"../../plots/cartesian/axes":838,"../scatter/plot":1223}],1244:[function(e,t,r){"use strict";var a=e("../../plots/template_attributes").hovertemplateAttrs;var n=e("../../plots/template_attributes").texttemplateAttrs;var i=e("../scatter/attributes");var o=e("../../plots/attributes");var s=e("../../components/colorscale/attributes");var l=e("../../components/drawing/attributes").dash;var u=e("../../lib/extend").extendFlat;var c=e("../../plot_api/edit_types").overrideAll;var f=i.marker;var h=i.line;var p=f.line;t.exports=c({lon:{valType:"data_array"},lat:{valType:"data_array"},locations:{valType:"data_array"},locationmode:{valType:"enumerated",values:["ISO-3","USA-states","country names","geojson-id"],dflt:"ISO-3"},geojson:{valType:"any",editType:"calc"},featureidkey:{valType:"string",editType:"calc",dflt:"id"},mode:u({},i.mode,{dflt:"markers"}),text:u({},i.text,{}),texttemplate:n({editType:"plot"},{keys:["lat","lon","location","text"]}),hovertext:u({},i.hovertext,{}),textfont:i.textfont,textposition:i.textposition,line:{color:h.color,width:h.width,dash:l},connectgaps:i.connectgaps,marker:u({symbol:f.symbol,opacity:f.opacity,size:f.size,sizeref:f.sizeref,sizemin:f.sizemin,sizemode:f.sizemode,colorbar:f.colorbar,line:u({width:p.width},s("marker.line")),gradient:f.gradient},s("marker")),fill:{valType:"enumerated",values:["none","toself"],dflt:"none"},fillcolor:i.fillcolor,selected:i.selected,unselected:i.unselected,hoverinfo:u({},o.hoverinfo,{flags:["lon","lat","location","text","name"]}),hovertemplate:a()},"calc","nested")},{"../../components/colorscale/attributes":657,"../../components/drawing/attributes":671,"../../lib/extend":777,"../../plot_api/edit_types":820,"../../plots/attributes":834,"../../plots/template_attributes":910,"../scatter/attributes":1202}],1245:[function(e,t,r){"use strict";var a=e("fast-isnumeric");var n=e("../../constants/numerical").BADNUM;var i=e("../scatter/colorscale_calc");var o=e("../scatter/arrays_to_calcdata");var s=e("../scatter/calc_selection");var l=e("../../lib")._;function u(e){return e&&typeof e==="string"}t.exports=function e(t,r){var c=Array.isArray(r.locations);var f=c?r.locations.length:r._length;var h=new Array(f);var p;if(r.geojson){p=function(e){return u(e)||a(e)}}else{p=u}for(var v=0;v<f;v++){var d=h[v]={};if(c){var m=r.locations[v];d.loc=p(m)?m:null}else{var g=r.lon[v];var y=r.lat[v];if(a(g)&&a(y))d.lonlat=[+g,+y];else d.lonlat=[n,n]}}o(h,r);i(t,r);s(h,r);if(f){h[0].t={labels:{lat:l(t,"lat:")+" ",lon:l(t,"lon:")+" "}}}return h}},{"../../constants/numerical":763,"../../lib":787,"../scatter/arrays_to_calcdata":1201,"../scatter/calc_selection":1204,"../scatter/colorscale_calc":1205,"fast-isnumeric":246}],1246:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("../scatter/subtypes");var i=e("../scatter/marker_defaults");var o=e("../scatter/line_defaults");var s=e("../scatter/text_defaults");var l=e("../scatter/fillcolor_defaults");var u=e("./attributes");t.exports=function e(t,r,c,f){function h(e,n){return a.coerce(t,r,u,e,n)}var p=h("locations");var v;if(p&&p.length){var d=h("geojson");var m;if(typeof d==="string"&&d!==""||a.isPlainObject(d)){m="geojson-id"}var g=h("locationmode",m);if(g==="geojson-id"){h("featureidkey")}v=p.length}else{var y=h("lon")||[];var x=h("lat")||[];v=Math.min(y.length,x.length)}if(!v){r.visible=false;return}r._length=v;h("text");h("hovertext");h("hovertemplate");h("mode");if(n.hasLines(r)){o(t,r,c,f,h);h("connectgaps")}if(n.hasMarkers(r)){i(t,r,c,f,h,{gradient:true})}if(n.hasText(r)){h("texttemplate");s(t,r,f,h)}h("fill");if(r.fill!=="none"){l(t,r,c,h)}a.coerceSelectionMarkerOpacity(r,h)}},{"../../lib":787,"../scatter/fillcolor_defaults":1210,"../scatter/line_defaults":1215,"../scatter/marker_defaults":1221,"../scatter/subtypes":1227,"../scatter/text_defaults":1228,"./attributes":1244}],1247:[function(e,t,r){"use strict";t.exports=function e(t,r,a,n,i){t.lon=r.lon;t.lat=r.lat;t.location=r.loc?r.loc:null;var o=n[i];if(o.fIn&&o.fIn.properties){t.properties=o.fIn.properties}return t}},{}],1248:[function(e,t,r){"use strict";var a=e("../../plots/cartesian/axes");t.exports=function e(t,r,n){var i={};var o=n[r.geo]._subplot;var s=o.mockAxis;var l=t.lonlat;i.lonLabel=a.tickText(s,s.c2l(l[0]),true).text;i.latLabel=a.tickText(s,s.c2l(l[1]),true).text;return i}},{"../../plots/cartesian/axes":838}],1249:[function(e,t,r){"use strict";var a=e("../../components/fx");var n=e("../../constants/numerical").BADNUM;var i=e("../scatter/get_trace_color");var o=e("../../lib").fillText;var s=e("./attributes");t.exports=function e(t,r,o){var s=t.cd;var u=s[0].trace;var c=t.xa;var f=t.ya;var h=t.subplot;var p=h.projection.isLonLatOverEdges;var v=h.project;function d(e){var t=e.lonlat;if(t[0]===n)return Infinity;if(p(t))return Infinity;var a=v(t);var i=v([r,o]);var s=Math.abs(a[0]-i[0]);var l=Math.abs(a[1]-i[1]);var u=Math.max(3,e.mrc||0);return Math.max(Math.sqrt(s*s+l*l)-u,1-3/u)}a.getClosest(s,d,t);if(t.index===false)return;var m=s[t.index];var g=m.lonlat;var y=[c.c2p(g),f.c2p(g)];var x=m.mrc||1;t.x0=y[0]-x;t.x1=y[0]+x;t.y0=y[1]-x;t.y1=y[1]+x;t.loc=m.loc;t.lon=g[0];t.lat=g[1];var b={};b[u.geo]={_subplot:h};var _=u._module.formatLabels(m,u,b);t.lonLabel=_.lonLabel;t.latLabel=_.latLabel;t.color=i(u,m);t.extraText=l(u,m,t,s[0].t.labels);t.hovertemplate=u.hovertemplate;return[t]};function l(e,t,r,a){if(e.hovertemplate)return;var n=t.hi||e.hoverinfo;var i=n==="all"?s.hoverinfo.flags:n.split("+");var l=i.indexOf("location")!==-1&&Array.isArray(e.locations);var u=i.indexOf("lon")!==-1;var c=i.indexOf("lat")!==-1;var f=i.indexOf("text")!==-1;var h=[];function p(e){return e+"°"}if(l){h.push(t.loc)}else if(u&&c){h.push("("+p(r.latLabel)+", "+p(r.lonLabel)+")")}else if(u){h.push(a.lon+p(r.lonLabel))}else if(c){h.push(a.lat+p(r.latLabel))}if(f){o(t,e,h)}return h.join("<br>")}},{"../../components/fx":690,"../../constants/numerical":763,"../../lib":787,"../scatter/get_trace_color":1212,"./attributes":1244}],1250:[function(e,t,r){"use strict";t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),colorbar:e("../scatter/marker_colorbar"),formatLabels:e("./format_labels"),calc:e("./calc"),calcGeoJSON:e("./plot").calcGeoJSON,plot:e("./plot").plot,style:e("./style"),styleOnSelect:e("../scatter/style").styleOnSelect,hoverPoints:e("./hover"),eventData:e("./event_data"),selectPoints:e("./select"),moduleType:"trace",name:"scattergeo",basePlotModule:e("../../plots/geo"),categories:["geo","symbols","showLegend","scatter-like"],meta:{}}},{"../../plots/geo":871,"../scatter/marker_colorbar":1220,"../scatter/style":1226,"./attributes":1244,"./calc":1245,"./defaults":1246,"./event_data":1247,"./format_labels":1248,"./hover":1249,"./plot":1251,"./select":1252,"./style":1253}],1251:[function(e,t,r){"use strict";var a=e("@plotly/d3");var n=e("../../lib");var i=e("../../lib/topojson_utils").getTopojsonFeatures;var o=e("../../lib/geojson_utils");var s=e("../../lib/geo_location_utils");var l=e("../../plots/cartesian/autorange").findExtremes;var u=e("../../constants/numerical").BADNUM;var c=e("../scatter/calc").calcMarkerSize;var f=e("../scatter/subtypes");var h=e("./style");function p(e,t,r){var i=t.layers.frontplot.select(".scatterlayer");var s=n.makeTraceGroups(i,r,"trace scattergeo");function l(e,t){if(e.lonlat[0]===u){a.select(t).remove()}}s.selectAll("*").remove();s.each((function(t){var r=a.select(this);var i=t[0].trace;if(f.hasLines(i)||i.fill!=="none"){var s=o.calcTraceToLineCoords(t);var u=i.fill!=="none"?o.makePolygon(s):o.makeLine(s);r.selectAll("path.js-line").data([{geojson:u,trace:i}]).enter().append("path").classed("js-line",true).style("stroke-miterlimit",2)}if(f.hasMarkers(i)){r.selectAll("path.point").data(n.identity).enter().append("path").classed("point",true).each((function(e){l(e,this)}))}if(f.hasText(i)){r.selectAll("g").data(n.identity).enter().append("g").append("text").each((function(e){l(e,this)}))}h(e,t)}))}function v(e,t){var r=e[0].trace;var a=t[r.geo];var n=a._subplot;var o=r._length;var f,h;if(Array.isArray(r.locations)){var p=r.locationmode;var v=p==="geojson-id"?s.extractTraceFeature(e):i(r,n.topojson);for(f=0;f<o;f++){h=e[f];var d=p==="geojson-id"?h.fOut:s.locationToFeature(p,h.loc,v);h.lonlat=d?d.properties.ct:[u,u]}}var m={padded:true};var g;var y;if(a.fitbounds==="geojson"&&r.locationmode==="geojson-id"){var x=s.computeBbox(s.getTraceGeojson(r));g=[x[0],x[2]];y=[x[1],x[3]]}else{g=new Array(o);y=new Array(o);for(f=0;f<o;f++){h=e[f];g[f]=h.lonlat[0];y[f]=h.lonlat[1]}m.ppad=c(r,o)}r._extremes.lon=l(a.lonaxis._ax,g,m);r._extremes.lat=l(a.lataxis._ax,y,m)}t.exports={calcGeoJSON:v,plot:p}},{"../../constants/numerical":763,"../../lib":787,"../../lib/geo_location_utils":780,"../../lib/geojson_utils":781,"../../lib/topojson_utils":816,"../../plots/cartesian/autorange":837,"../scatter/calc":1203,"../scatter/subtypes":1227,"./style":1253,"@plotly/d3":58}],1252:[function(e,t,r){"use strict";var a=e("../scatter/subtypes");var n=e("../../constants/numerical").BADNUM;t.exports=function e(t,r){var i=t.cd;var o=t.xaxis;var s=t.yaxis;var l=[];var u=i[0].trace;var c,f,h,p,v;var d=!a.hasMarkers(u)&&!a.hasText(u);if(d)return[];if(r===false){for(v=0;v<i.length;v++){i[v].selected=0}}else{for(v=0;v<i.length;v++){c=i[v];f=c.lonlat;if(f[0]===n)continue;h=o.c2p(f);p=s.c2p(f);if(r.contains([h,p],null,v,t)){l.push({pointNumber:v,lon:f[0],lat:f[1]});c.selected=1}else{c.selected=0}}}return l}},{"../../constants/numerical":763,"../scatter/subtypes":1227}],1253:[function(e,t,r){"use strict";var a=e("@plotly/d3");var n=e("../../components/drawing");var i=e("../../components/color");var o=e("../scatter/style");var s=o.stylePoints;var l=o.styleText;t.exports=function e(t,r){if(r)u(t,r)};function u(e,t){var r=t[0].trace;var o=t[0].node3;o.style("opacity",t[0].trace.opacity);s(o,r,e);l(o,r,e);o.selectAll("path.js-line").style("fill","none").each((function(e){var t=a.select(this);var r=e.trace;var o=r.line||{};t.call(i.stroke,o.color).call(n.dashLine,o.dash||"",o.width||0);if(r.fill!=="none"){t.call(i.fill,r.fillcolor)}}))}},{"../../components/color":650,"../../components/drawing":672,"../scatter/style":1226,"@plotly/d3":58}],1254:[function(e,t,r){"use strict";var a=e("../../plots/attributes");var n=e("../scatter/attributes");var i=e("../../plots/cartesian/axis_format_attributes").axisHoverFormat;var o=e("../../components/colorscale/attributes");var s=e("../../lib/sort_object_keys");var l=e("../../lib/extend").extendFlat;var u=e("../../plot_api/edit_types").overrideAll;var c=e("./constants").DASHES;var f=n.line;var h=n.marker;var p=h.line;var v=t.exports=u({x:n.x,x0:n.x0,dx:n.dx,y:n.y,y0:n.y0,dy:n.dy,xperiod:n.xperiod,yperiod:n.yperiod,xperiod0:n.xperiod0,yperiod0:n.yperiod0,xperiodalignment:n.xperiodalignment,yperiodalignment:n.yperiodalignment,xhoverformat:i("x"),yhoverformat:i("y"),text:n.text,hovertext:n.hovertext,textposition:n.textposition,textfont:n.textfont,mode:{valType:"flaglist",flags:["lines","markers","text"],extras:["none"]},line:{color:f.color,width:f.width,shape:{valType:"enumerated",values:["linear","hv","vh","hvh","vhv"],dflt:"linear",editType:"plot"},dash:{valType:"enumerated",values:s(c),dflt:"solid"}},marker:l({},o("marker"),{symbol:h.symbol,size:h.size,sizeref:h.sizeref,sizemin:h.sizemin,sizemode:h.sizemode,opacity:h.opacity,colorbar:h.colorbar,line:l({},o("marker.line"),{width:p.width})}),connectgaps:n.connectgaps,fill:l({},n.fill,{dflt:"none"}),fillcolor:n.fillcolor,selected:{marker:n.selected.marker,textfont:n.selected.textfont},unselected:{marker:n.unselected.marker,textfont:n.unselected.textfont},opacity:a.opacity},"calc","nested");v.x.editType=v.y.editType=v.x0.editType=v.y0.editType="calc+clearAxisTypes";v.hovertemplate=n.hovertemplate;v.texttemplate=n.texttemplate},{"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../lib/sort_object_keys":810,"../../plot_api/edit_types":820,"../../plots/attributes":834,"../../plots/cartesian/axis_format_attributes":841,"../scatter/attributes":1202,"./constants":1256}],1255:[function(e,t,r){"use strict";var a=e("@plotly/point-cluster");var n=e("../../lib");var i=e("../../plots/cartesian/axis_ids");var o=e("../../plots/cartesian/autorange").findExtremes;var s=e("../../plots/cartesian/align_period");var l=e("../scatter/calc");var u=l.calcMarkerSize;var c=l.calcAxisExpansion;var f=l.setFirstScatter;var h=e("../scatter/colorscale_calc");var p=e("./convert");var v=e("./scene_update");var d=e("../../constants/numerical").BADNUM;var m=e("./constants").TOO_MANY_POINTS;t.exports=function e(t,r){var n=t._fullLayout;var o=i.getFromId(t,r.xaxis);var l=i.getFromId(t,r.yaxis);var p=n._plots[r.xaxis+r.yaxis];var x=r._length;var b=x>=m;var _=x*2;var w={};var T;var k=o.makeCalcdata(r,"x");var M=l.makeCalcdata(r,"y");var A=s(r,o,"x",k);var S=s(r,l,"y",M);var E=A.vals;var L=S.vals;r._x=E;r._y=L;if(r.xperiodalignment){r._origX=k;r._xStarts=A.starts;r._xEnds=A.ends}if(r.yperiodalignment){r._origY=M;r._yStarts=S.starts;r._yEnds=S.ends}var C=new Array(_);var I=new Array(x);for(T=0;T<x;T++){C[T*2]=E[T]===d?NaN:E[T];C[T*2+1]=L[T]===d?NaN:L[T];I[T]=T}if(o.type==="log"){for(T=0;T<_;T+=2){C[T]=o.c2l(C[T])}}if(l.type==="log"){for(T=1;T<_;T+=2){C[T]=l.c2l(C[T])}}if(b&&(o.type!=="log"&&l.type!=="log")){w.tree=a(C)}else{w.ids=I}h(t,r);var P=y(t,p,r,C,E,L);var O=v(t,p);f(n,r);var z;if(!b){z=u(r,x)}else if(P.marker){z=P.marker.sizeAvg||Math.max(P.marker.size,3)}c(t,r,o,l,E,L,z);if(P.errorX)g(r,o,P.errorX);if(P.errorY)g(r,l,P.errorY);if(P.fill&&!O.fill2d)O.fill2d=true;if(P.marker&&!O.scatter2d)O.scatter2d=true;if(P.line&&!O.line2d)O.line2d=true;if((P.errorX||P.errorY)&&!O.error2d)O.error2d=true;if(P.text&&!O.glText)O.glText=true;if(P.marker)P.marker.snap=x;O.lineOptions.push(P.line);O.errorXOptions.push(P.errorX);O.errorYOptions.push(P.errorY);O.fillOptions.push(P.fill);O.markerOptions.push(P.marker);O.markerSelectedOptions.push(P.markerSel);O.markerUnselectedOptions.push(P.markerUnsel);O.textOptions.push(P.text);O.textSelectedOptions.push(P.textSel);O.textUnselectedOptions.push(P.textUnsel);O.selectBatch.push([]);O.unselectBatch.push([]);w._scene=O;w.index=O.count;w.x=E;w.y=L;w.positions=C;O.count++;return[{x:false,y:false,t:w,trace:r}]};function g(e,t,r){var a=e._extremes[t._id];var n=o(t,r._bnds,{padded:true});a.min=a.min.concat(n.min);a.max=a.max.concat(n.max)}function y(e,t,r,a,i,o){var s=p.style(e,r);if(s.marker){s.marker.positions=a}if(s.line&&a.length>1){n.extendFlat(s.line,p.linePositions(e,r,a))}if(s.errorX||s.errorY){var l=p.errorBarPositions(e,r,a,i,o);if(s.errorX){n.extendFlat(s.errorX,l.x)}if(s.errorY){n.extendFlat(s.errorY,l.y)}}if(s.text){n.extendFlat(s.text,{positions:a},p.textPosition(e,r,s.text,s.marker));n.extendFlat(s.textSel,{positions:a},p.textPosition(e,r,s.text,s.markerSel));n.extendFlat(s.textUnsel,{positions:a},p.textPosition(e,r,s.text,s.markerUnsel))}return s}},{"../../constants/numerical":763,"../../lib":787,"../../plots/cartesian/align_period":835,"../../plots/cartesian/autorange":837,"../../plots/cartesian/axis_ids":842,"../scatter/calc":1203,"../scatter/colorscale_calc":1205,"./constants":1256,"./convert":1257,"./scene_update":1265,"@plotly/point-cluster":59}],1256:[function(e,t,r){"use strict";var a=20;t.exports={TOO_MANY_POINTS:1e5,SYMBOL_SDF_SIZE:200,SYMBOL_SIZE:a,SYMBOL_STROKE:a/20,DOT_RE:/-dot/,OPEN_RE:/-open/,DASHES:{solid:[1],dot:[1,1],dash:[4,1],longdash:[8,1],dashdot:[4,1,1,1],longdashdot:[8,1,1,1]}}},{}],1257:[function(e,t,r){"use strict";var a=e("fast-isnumeric");var n=e("svg-path-sdf");var i=e("color-normalize");var o=e("../../registry");var s=e("../../lib");var l=e("../../components/drawing");var u=e("../../plots/cartesian/axis_ids");var c=e("../../lib/gl_format_color").formatColor;var f=e("../scatter/subtypes");var h=e("../scatter/make_bubble_size_func");var p=e("./helpers");var v=e("./constants");var d=e("../../constants/interactions").DESELECTDIM;var m={start:1,left:1,end:-1,right:-1,middle:0,center:0,bottom:1,top:-1};var g=e("../../components/fx/helpers").appendArrayPointValue;function y(e,t){var r;var a={marker:undefined,markerSel:undefined,markerUnsel:undefined,line:undefined,fill:undefined,errorX:undefined,errorY:undefined,text:undefined,textSel:undefined,textUnsel:undefined};var n=e._context.plotGlPixelRatio;if(t.visible!==true)return a;if(f.hasText(t)){a.text=x(e,t);a.textSel=w(e,t,t.selected);a.textUnsel=w(e,t,t.unselected)}if(f.hasMarkers(t)){a.marker=b(t);a.markerSel=_(t,t.selected);a.markerUnsel=_(t,t.unselected);if(!t.unselected&&s.isArrayOrTypedArray(t.marker.opacity)){var i=t.marker.opacity;a.markerUnsel.opacity=new Array(i.length);for(r=0;r<i.length;r++){a.markerUnsel.opacity[r]=d*i[r]}}}if(f.hasLines(t)){a.line={overlay:true,thickness:t.line.width*n,color:t.line.color,opacity:t.opacity};var o=(v.DASHES[t.line.dash]||[1]).slice();for(r=0;r<o.length;++r){o[r]*=t.line.width*n}a.line.dashes=o}if(t.error_x&&t.error_x.visible){a.errorX=T(t,t.error_x,n)}if(t.error_y&&t.error_y.visible){a.errorY=T(t,t.error_y,n)}if(!!t.fill&&t.fill!=="none"){a.fill={closed:true,fill:t.fillcolor,thickness:0}}return a}function x(e,t){var r=e._fullLayout;var n=t._length;var i=t.textfont;var o=t.textposition;var l=Array.isArray(o)?o:[o];var u=i.color;var c=i.size;var f=i.family;var h={};var p;var v=e._context.plotGlPixelRatio;var d=t.texttemplate;if(d){h.text=[];var m=r._d3locale;var y=Array.isArray(d);var x=y?Math.min(d.length,n):n;var b=y?function(e){return d[e]}:function(){return d};for(p=0;p<x;p++){var _={i:p};var w=t._module.formatLabels(_,t,r);var T={};g(T,t,p);var k=t._meta||{};h.text.push(s.texttemplateString(b(p),w,m,T,_,k))}}else{if(Array.isArray(t.text)&&t.text.length<n){h.text=t.text.slice()}else{h.text=t.text}}if(Array.isArray(h.text)){for(p=h.text.length;p<n;p++){h.text[p]=""}}h.opacity=t.opacity;h.font={};h.align=[];h.baseline=[];for(p=0;p<l.length;p++){var M=l[p].split(/\s+/);switch(M[1]){case"left":h.align.push("right");break;case"right":h.align.push("left");break;default:h.align.push(M[1])}switch(M[0]){case"top":h.baseline.push("bottom");break;case"bottom":h.baseline.push("top");break;default:h.baseline.push(M[0])}}if(Array.isArray(u)){h.color=new Array(n);for(p=0;p<n;p++){h.color[p]=u[p]}}else{h.color=u}if(s.isArrayOrTypedArray(c)||Array.isArray(f)){h.font=new Array(n);for(p=0;p<n;p++){var A=h.font[p]={};A.size=(s.isTypedArray(c)?c[p]:Array.isArray(c)?a(c[p])?c[p]:0:c)*v;A.family=Array.isArray(f)?f[p]:f}}else{h.font={size:c*v,family:f}}return h}function b(e){var t=e._length;var r=e.marker;var a={};var n;var o=s.isArrayOrTypedArray(r.symbol);var l=s.isArrayOrTypedArray(r.color);var u=s.isArrayOrTypedArray(r.line.color);var f=s.isArrayOrTypedArray(r.opacity);var v=s.isArrayOrTypedArray(r.size);var d=s.isArrayOrTypedArray(r.line.width);var m;if(!o)m=p.isOpenSymbol(r.symbol);if(o||l||u||f){a.colors=new Array(t);a.borderColors=new Array(t);var g=c(r,r.opacity,t);var y=c(r.line,r.opacity,t);if(!Array.isArray(y[0])){var x=y;y=Array(t);for(n=0;n<t;n++){y[n]=x}}if(!Array.isArray(g[0])){var b=g;g=Array(t);for(n=0;n<t;n++){g[n]=b}}a.colors=g;a.borderColors=y;for(n=0;n<t;n++){if(o){var _=r.symbol[n];m=p.isOpenSymbol(_)}if(m){y[n]=g[n].slice();g[n]=g[n].slice();g[n][3]=0}}a.opacity=e.opacity}else{if(m){a.color=i(r.color,"uint8");a.color[3]=0;a.borderColor=i(r.color,"uint8")}else{a.color=i(r.color,"uint8");a.borderColor=i(r.line.color,"uint8")}a.opacity=e.opacity*r.opacity}if(o){a.markers=new Array(t);for(n=0;n<t;n++){a.markers[n]=L(r.symbol[n])}}else{a.marker=L(r.symbol)}var w=1;var T=h(e,w);var k;if(v||d){var M=a.sizes=new Array(t);var A=a.borderSizes=new Array(t);var S=0;var E;if(v){for(n=0;n<t;n++){M[n]=T(r.size[n]);S+=M[n]}E=S/t}else{k=T(r.size);for(n=0;n<t;n++){M[n]=k}}if(d){for(n=0;n<t;n++){A[n]=r.line.width[n]}}else{k=r.line.width;for(n=0;n<t;n++){A[n]=k}}a.sizeAvg=E}else{a.size=T(r&&r.size||10);a.borderSizes=T(r.line.width)}return a}function _(e,t){var r=e.marker;var a={};if(!t)return a;if(t.marker&&t.marker.symbol){a=b(s.extendFlat({},r,t.marker))}else if(t.marker){if(t.marker.size)a.size=t.marker.size;if(t.marker.color)a.colors=t.marker.color;if(t.marker.opacity!==undefined)a.opacity=t.marker.opacity}return a}function w(e,t,r){var a={};if(!r)return a;if(r.textfont){var n={opacity:1,text:t.text,texttemplate:t.texttemplate,textposition:t.textposition,textfont:s.extendFlat({},t.textfont)};if(r.textfont){s.extendFlat(n.textfont,r.textfont)}a=x(e,n)}return a}function T(e,t,r){var a={capSize:t.width*2*r,lineWidth:t.thickness*r,color:t.color};if(t.copy_ystyle){a=e.error_y}return a}var k=v.SYMBOL_SDF_SIZE;var M=v.SYMBOL_SIZE;var A=v.SYMBOL_STROKE;var S={};var E=l.symbolFuncs[0](M*.05);function L(e){if(e==="circle")return null;var t,r;var a=l.symbolNumber(e);var i=l.symbolFuncs[a%100];var o=!!l.symbolNoDot[a%100];var s=!!l.symbolNoFill[a%100];var u=p.isDotSymbol(e);if(S[e])return S[e];if(u&&!o){t=i(M*1.1)+E}else{t=i(M)}r=n(t,{w:k,h:k,viewBox:[-M,-M,M,M],stroke:s?A:-A});S[e]=r;return r||null}function C(e,t,r){var a=r.length;var n=a/2;var i;var o;if(f.hasLines(t)&&n){if(t.line.shape==="hv"){i=[];for(o=0;o<n-1;o++){if(isNaN(r[o*2])||isNaN(r[o*2+1])){i.push(NaN,NaN,NaN,NaN)}else{i.push(r[o*2],r[o*2+1]);if(!isNaN(r[o*2+2])&&!isNaN(r[o*2+3])){i.push(r[o*2+2],r[o*2+1])}else{i.push(NaN,NaN)}}}i.push(r[a-2],r[a-1])}else if(t.line.shape==="hvh"){i=[];for(o=0;o<n-1;o++){if(isNaN(r[o*2])||isNaN(r[o*2+1])||isNaN(r[o*2+2])||isNaN(r[o*2+3])){if(!isNaN(r[o*2])&&!isNaN(r[o*2+1])){i.push(r[o*2],r[o*2+1])}else{i.push(NaN,NaN)}i.push(NaN,NaN)}else{var s=(r[o*2]+r[o*2+2])/2;i.push(r[o*2],r[o*2+1],s,r[o*2+1],s,r[o*2+3])}}i.push(r[a-2],r[a-1])}else if(t.line.shape==="vhv"){i=[];for(o=0;o<n-1;o++){if(isNaN(r[o*2])||isNaN(r[o*2+1])||isNaN(r[o*2+2])||isNaN(r[o*2+3])){if(!isNaN(r[o*2])&&!isNaN(r[o*2+1])){i.push(r[o*2],r[o*2+1])}else{i.push(NaN,NaN)}i.push(NaN,NaN)}else{var l=(r[o*2+1]+r[o*2+3])/2;i.push(r[o*2],r[o*2+1],r[o*2],l,r[o*2+2],l)}}i.push(r[a-2],r[a-1])}else if(t.line.shape==="vh"){i=[];for(o=0;o<n-1;o++){if(isNaN(r[o*2])||isNaN(r[o*2+1])){i.push(NaN,NaN,NaN,NaN)}else{i.push(r[o*2],r[o*2+1]);if(!isNaN(r[o*2+2])&&!isNaN(r[o*2+3])){i.push(r[o*2],r[o*2+3])}else{i.push(NaN,NaN)}}}i.push(r[a-2],r[a-1])}else{i=r}}var u=false;for(o=0;o<i.length;o++){if(isNaN(i[o])){u=true;break}}var c=u||i.length>v.TOO_MANY_POINTS?"rect":f.hasMarkers(t)?"rect":"round";if(u&&t.connectgaps){var h=i[0];var p=i[1];for(o=0;o<i.length;o+=2){if(isNaN(i[o])||isNaN(i[o+1])){i[o]=h;i[o+1]=p}else{h=i[o];p=i[o+1]}}}return{join:c,positions:i}}function I(e,t,r,n,i){var s=o.getComponentMethod("errorbars","makeComputeError");var l=u.getFromId(e,t.xaxis);var c=u.getFromId(e,t.yaxis);var f=r.length/2;var h={};function p(e,n){var i=n._id.charAt(0);var o=t["error_"+i];if(o&&o.visible&&(n.type==="linear"||n.type==="log")){var l=s(o);var u={x:0,y:1}[i];var c={x:[0,1,2,3],y:[2,3,0,1]}[i];var p=new Float64Array(4*f);var v=Infinity;var d=-Infinity;for(var m=0,g=0;m<f;m++,g+=4){var y=e[m];if(a(y)){var x=r[m*2+u];var b=l(y,m);var _=b[0];var w=b[1];if(a(_)&&a(w)){var T=y-_;var k=y+w;p[g+c[0]]=x-n.c2l(T);p[g+c[1]]=n.c2l(k)-x;p[g+c[2]]=0;p[g+c[3]]=0;v=Math.min(v,y-_);d=Math.max(d,y+w)}}}h[i]={positions:r,errors:p,_bnds:[v,d]}}}p(n,l);p(i,c);return h}function P(e,t,r,a){var n=t._length;var i={};var o;if(f.hasMarkers(t)){var s=r.font;var l=r.align;var u=r.baseline;i.offset=new Array(n);for(o=0;o<n;o++){var c=a.sizes?a.sizes[o]:a.size;var h=Array.isArray(s)?s[o].size:s.size;var p=Array.isArray(l)?l.length>1?l[o]:l[0]:l;var v=Array.isArray(u)?u.length>1?u[o]:u[0]:u;var d=m[p];var g=m[v];var y=c?c/.8+1:0;var x=-g*y-g*.5;i.offset[o]=[d*y/h,x/h]}}return i}t.exports={style:y,markerStyle:b,markerSelection:_,linePositions:C,errorBarPositions:I,textPosition:P}},{"../../components/drawing":672,"../../components/fx/helpers":686,"../../constants/interactions":762,"../../lib":787,"../../lib/gl_format_color":783,"../../plots/cartesian/axis_ids":842,"../../registry":915,"../scatter/make_bubble_size_func":1219,"../scatter/subtypes":1227,"./constants":1256,"./helpers":1261,"color-normalize":131,"fast-isnumeric":246,"svg-path-sdf":580}],1258:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("../../registry");var i=e("./helpers");var o=e("./attributes");var s=e("../scatter/constants");var l=e("../scatter/subtypes");var u=e("../scatter/xy_defaults");var c=e("../scatter/period_defaults");var f=e("../scatter/marker_defaults");var h=e("../scatter/line_defaults");var p=e("../scatter/fillcolor_defaults");var v=e("../scatter/text_defaults");t.exports=function e(t,r,d,m){function g(e,n){return a.coerce(t,r,o,e,n)}var y=t.marker?i.isOpenSymbol(t.marker.symbol):false;var x=l.isBubble(t);var b=u(t,r,m,g);if(!b){r.visible=false;return}c(t,r,m,g);g("xhoverformat");g("yhoverformat");var _=b<s.PTS_LINESONLY?"lines+markers":"lines";g("text");g("hovertext");g("hovertemplate");g("mode",_);if(l.hasLines(r)){g("connectgaps");h(t,r,d,m,g);g("line.shape")}if(l.hasMarkers(r)){f(t,r,d,m,g);g("marker.line.width",y||x?1:0)}if(l.hasText(r)){g("texttemplate");v(t,r,m,g)}var w=(r.line||{}).color;var T=(r.marker||{}).color;g("fill");if(r.fill!=="none"){p(t,r,d,g)}var k=n.getComponentMethod("errorbars","supplyDefaults");k(t,r,w||T||d,{axis:"y"});k(t,r,w||T||d,{axis:"x",inherit:"y"});a.coerceSelectionMarkerOpacity(r,g)}},{"../../lib":787,"../../registry":915,"../scatter/constants":1206,"../scatter/fillcolor_defaults":1210,"../scatter/line_defaults":1215,"../scatter/marker_defaults":1221,"../scatter/period_defaults":1222,"../scatter/subtypes":1227,"../scatter/text_defaults":1228,"../scatter/xy_defaults":1229,"./attributes":1254,"./helpers":1261}],1259:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("../../components/color");var i=e("../../constants/interactions").DESELECTDIM;function o(e){var t=e[0];var r=t.trace;var o=t.t;var s=o._scene;var l=o.index;var u=s.selectBatch[l];var c=s.unselectBatch[l];var f=s.textOptions[l];var h=s.textSelectedOptions[l]||{};var p=s.textUnselectedOptions[l]||{};var v=a.extendFlat({},f);var d,m;if(u.length||c.length){var g=h.color;var y=p.color;var x=f.color;var b=Array.isArray(x);v.color=new Array(r._length);for(d=0;d<u.length;d++){m=u[d];v.color[m]=g||(b?x[m]:x)}for(d=0;d<c.length;d++){m=c[d];var _=b?x[m]:x;v.color[m]=y?y:g?_:n.addOpacity(_,i)}}s.glText[l].update(v)}t.exports={styleTextSelection:o}},{"../../components/color":650,"../../constants/interactions":762,"../../lib":787}],1260:[function(e,t,r){"use strict";var a=e("../scatter/format_labels");t.exports=function e(t,r,n){var i=t.i;if(!("x"in t))t.x=r._x[i];if(!("y"in t))t.y=r._y[i];return a(t,r,n)}},{"../scatter/format_labels":1211}],1261:[function(e,t,r){"use strict";var a=e("./constants");r.isOpenSymbol=function(e){return typeof e==="string"?a.OPEN_RE.test(e):e%200>100};r.isDotSymbol=function(e){return typeof e==="string"?a.DOT_RE.test(e):e>200}},{"./constants":1256}],1262:[function(e,t,r){"use strict";var a=e("../../registry");var n=e("../../lib");var i=e("../scatter/get_trace_color");function o(e,t,r,a){var n=e.cd;var i=n[0].t;var o=n[0].trace;var l=e.xa;var u=e.ya;var c=i.x;var f=i.y;var h=l.c2p(t);var p=u.c2p(r);var v=e.distance;var d;if(i.tree){var m=l.p2c(h-v);var g=l.p2c(h+v);var y=u.p2c(p-v);var x=u.p2c(p+v);if(a==="x"){d=i.tree.range(Math.min(m,g),Math.min(u._rl[0],u._rl[1]),Math.max(m,g),Math.max(u._rl[0],u._rl[1]))}else{d=i.tree.range(Math.min(m,g),Math.min(y,x),Math.max(m,g),Math.max(y,x))}}else{d=i.ids}var b,_,w,T,k,M,A,S,E;var L=v;if(a==="x"){var C=!!o.xperiodalignment;var I=!!o.yperiodalignment;for(k=0;k<d.length;k++){b=d[k];w=c[b];M=Math.abs(l.c2p(w)-h);if(C){var P=l.c2p(o._xStarts[b]);var O=l.c2p(o._xEnds[b]);M=h>=Math.min(P,O)&&h<=Math.max(P,O)?0:Infinity}if(M<L){L=M;T=f[b];A=u.c2p(T)-p;if(I){var z=u.c2p(o._yStarts[b]);var D=u.c2p(o._yEnds[b]);A=p>=Math.min(z,D)&&p<=Math.max(z,D)?0:Infinity}E=Math.sqrt(M*M+A*A);_=d[k]}}}else{for(k=d.length-1;k>-1;k--){b=d[k];w=c[b];T=f[b];M=l.c2p(w)-h;A=u.c2p(T)-p;S=Math.sqrt(M*M+A*A);if(S<L){L=E=S;_=b}}}e.index=_;e.distance=L;e.dxy=E;if(_===undefined)return[e];return[s(e,c,f,o)]}function s(e,t,r,o){var s=e.xa;var l=e.ya;var u=e.distance;var c=e.dxy;var f=e.index;var h={pointNumber:f,x:t[f],y:r[f]};h.tx=Array.isArray(o.text)?o.text[f]:o.text;h.htx=Array.isArray(o.hovertext)?o.hovertext[f]:o.hovertext;h.data=Array.isArray(o.customdata)?o.customdata[f]:o.customdata;h.tp=Array.isArray(o.textposition)?o.textposition[f]:o.textposition;var p=o.textfont;if(p){h.ts=n.isArrayOrTypedArray(p.size)?p.size[f]:p.size;h.tc=Array.isArray(p.color)?p.color[f]:p.color;h.tf=Array.isArray(p.family)?p.family[f]:p.family}var v=o.marker;if(v){h.ms=n.isArrayOrTypedArray(v.size)?v.size[f]:v.size;h.mo=n.isArrayOrTypedArray(v.opacity)?v.opacity[f]:v.opacity;h.mx=n.isArrayOrTypedArray(v.symbol)?v.symbol[f]:v.symbol;h.mc=n.isArrayOrTypedArray(v.color)?v.color[f]:v.color}var d=v&&v.line;if(d){h.mlc=Array.isArray(d.color)?d.color[f]:d.color;h.mlw=n.isArrayOrTypedArray(d.width)?d.width[f]:d.width}var m=v&&v.gradient;if(m&&m.type!=="none"){h.mgt=Array.isArray(m.type)?m.type[f]:m.type;h.mgc=Array.isArray(m.color)?m.color[f]:m.color}var g=s.c2p(h.x,true);var y=l.c2p(h.y,true);var x=h.mrc||1;var b=o.hoverlabel;if(b){h.hbg=Array.isArray(b.bgcolor)?b.bgcolor[f]:b.bgcolor;h.hbc=Array.isArray(b.bordercolor)?b.bordercolor[f]:b.bordercolor;h.hts=n.isArrayOrTypedArray(b.font.size)?b.font.size[f]:b.font.size;h.htc=Array.isArray(b.font.color)?b.font.color[f]:b.font.color;h.htf=Array.isArray(b.font.family)?b.font.family[f]:b.font.family;h.hnl=n.isArrayOrTypedArray(b.namelength)?b.namelength[f]:b.namelength}var _=o.hoverinfo;if(_){h.hi=Array.isArray(_)?_[f]:_}var w=o.hovertemplate;if(w){h.ht=Array.isArray(w)?w[f]:w}var T={};T[e.index]=h;var k=o._origX;var M=o._origY;var A=n.extendFlat({},e,{color:i(o,h),x0:g-x,x1:g+x,xLabelVal:k?k[f]:h.x,y0:y-x,y1:y+x,yLabelVal:M?M[f]:h.y,cd:T,distance:u,spikeDistance:c,hovertemplate:h.ht});if(h.htx)A.text=h.htx;else if(h.tx)A.text=h.tx;else if(o.text)A.text=o.text;n.fillText(h,o,A);a.getComponentMethod("errorbars","hoverInfo")(h,o,A);return A}t.exports={hoverPoints:o,calcHover:s}},{"../../lib":787,"../../registry":915,"../scatter/get_trace_color":1212}],1263:[function(e,t,r){"use strict";var a=e("./hover");t.exports={moduleType:"trace",name:"scattergl",basePlotModule:e("../../plots/cartesian"),categories:["gl","regl","cartesian","symbols","errorBarsOK","showLegend","scatter-like"],attributes:e("./attributes"),supplyDefaults:e("./defaults"),crossTraceDefaults:e("../scatter/cross_trace_defaults"),colorbar:e("../scatter/marker_colorbar"),formatLabels:e("./format_labels"),calc:e("./calc"),plot:e("./plot"),hoverPoints:a.hoverPoints,selectPoints:e("./select"),meta:{}}},{"../../plots/cartesian":852,"../scatter/cross_trace_defaults":1208,"../scatter/marker_colorbar":1220,"./attributes":1254,"./calc":1255,"./defaults":1258,"./format_labels":1260,"./hover":1262,"./plot":1264,"./select":1266}],1264:[function(e,t,r){"use strict";var a=e("regl-scatter2d");var n=e("regl-line2d");var i=e("regl-error2d");var o=e("gl-text");var s=e("../../lib");var l=e("../../components/dragelement/helpers").selectMode;var u=e("../../lib/prepare_regl");var c=e("../scatter/subtypes");var f=e("../scatter/link_traces");var h=e("./edit_style").styleTextSelection;function p(e,t,r,a){var n=e._size;var i=e.width*a;var o=e.height*a;var s=n.l*a;var l=n.b*a;var u=n.r*a;var c=n.t*a;var f=n.w*a;var h=n.h*a;return[s+t.domain[0]*f,l+r.domain[0]*h,i-u-(1-t.domain[1])*f,o-c-(1-r.domain[1])*h]}t.exports=function e(t,r,v){if(!v.length)return;var d=t._fullLayout;var m=r._scene;var g=r.xaxis;var y=r.yaxis;var x,b;if(!m)return;var _=u(t,["ANGLE_instanced_arrays","OES_element_index_uint"]);if(!_){m.init();return}var w=m.count;var T=d._glcanvas.data()[0].regl;f(t,r,v);if(m.dirty){if(m.error2d===true){m.error2d=i(T)}if(m.line2d===true){m.line2d=n(T)}if(m.scatter2d===true){m.scatter2d=a(T)}if(m.fill2d===true){m.fill2d=n(T)}if(m.glText===true){m.glText=new Array(w);for(x=0;x<w;x++){m.glText[x]=new o(T)}}if(m.glText){if(w>m.glText.length){var k=w-m.glText.length;for(x=0;x<k;x++){m.glText.push(new o(T))}}else if(w<m.glText.length){var M=m.glText.length-w;var A=m.glText.splice(w,M);A.forEach((function(e){e.destroy()}))}for(x=0;x<w;x++){m.glText[x].update(m.textOptions[x])}}if(m.line2d){m.line2d.update(m.lineOptions);m.lineOptions=m.lineOptions.map((function(e){if(e&&e.positions){var t=e.positions;var r=0;while(r<t.length&&(isNaN(t[r])||isNaN(t[r+1]))){r+=2}var a=t.length-2;while(a>r&&(isNaN(t[a])||isNaN(t[a+1]))){a-=2}e.positions=t.slice(r,a+2)}return e}));m.line2d.update(m.lineOptions)}if(m.error2d){var S=(m.errorXOptions||[]).concat(m.errorYOptions||[]);m.error2d.update(S)}if(m.scatter2d){m.scatter2d.update(m.markerOptions)}m.fillOrder=s.repeat(null,w);if(m.fill2d){m.fillOptions=m.fillOptions.map((function(e,t){var r=v[t];if(!e||!r||!r[0]||!r[0].trace)return;var a=r[0];var n=a.trace;var i=a.t;var o=m.lineOptions[t];var s,l;var u=[];if(n._ownfill)u.push(t);if(n._nexttrace)u.push(t+1);if(u.length)m.fillOrder[t]=u;var c=[];var f=o&&o.positions||i.positions;var h,p;if(n.fill==="tozeroy"){h=0;while(h<f.length&&isNaN(f[h+1])){h+=2}p=f.length-2;while(p>h&&isNaN(f[p+1])){p-=2}if(f[h+1]!==0){c=[f[h],0]}c=c.concat(f.slice(h,p+2));if(f[p+1]!==0){c=c.concat([f[p],0])}}else if(n.fill==="tozerox"){h=0;while(h<f.length&&isNaN(f[h])){h+=2}p=f.length-2;while(p>h&&isNaN(f[p])){p-=2}if(f[h]!==0){c=[0,f[h+1]]}c=c.concat(f.slice(h,p+2));if(f[p]!==0){c=c.concat([0,f[p+1]])}}else if(n.fill==="toself"||n.fill==="tonext"){c=[];s=0;e.splitNull=true;for(l=0;l<f.length;l+=2){if(isNaN(f[l])||isNaN(f[l+1])){c=c.concat(f.slice(s,l));c.push(f[s],f[s+1]);c.push(null,null);s=l+2}}c=c.concat(f.slice(s));if(s){c.push(f[s],f[s+1])}}else{var d=n._nexttrace;if(d){var g=m.lineOptions[t+1];if(g){var y=g.positions;if(n.fill==="tonexty"){c=f.slice();for(t=Math.floor(y.length/2);t--;){var x=y[t*2];var b=y[t*2+1];if(isNaN(x)||isNaN(b))continue;c.push(x,b)}e.fill=d.fillcolor}}}}if(n._prevtrace&&n._prevtrace.fill==="tonext"){var _=m.lineOptions[t-1].positions;var w=c.length/2;s=w;var T=[s];for(l=0;l<_.length;l+=2){if(isNaN(_[l])||isNaN(_[l+1])){T.push(l/2+w+1);s=l+2}}c=c.concat(_);e.hole=T}e.fillmode=n.fill;e.opacity=n.opacity;e.positions=c;return e}));m.fill2d.update(m.fillOptions)}}var E=d.dragmode;var L=l(E);var C=d.clickmode.indexOf("select")>-1;for(x=0;x<w;x++){var I=v[x][0];var P=I.trace;var O=I.t;var z=O.index;var D=P._length;var R=O.x;var F=O.y;if(P.selectedpoints||L||C){if(!L)L=true;if(P.selectedpoints){var B=m.selectBatch[z]=s.selIndices2selPoints(P);var N={};for(b=0;b<B.length;b++){N[B[b]]=1}var j=[];for(b=0;b<D;b++){if(!N[b])j.push(b)}m.unselectBatch[z]=j}var U=O.xpx=new Array(D);var V=O.ypx=new Array(D);for(b=0;b<D;b++){U[b]=g.c2p(R[b]);V[b]=y.c2p(F[b])}}else{O.xpx=O.ypx=null}}if(L){if(!m.select2d){m.select2d=a(d._glcanvas.data()[1].regl)}if(m.scatter2d){var H=new Array(w);for(x=0;x<w;x++){H[x]=m.selectBatch[x].length||m.unselectBatch[x].length?m.markerUnselectedOptions[x]:{}}m.scatter2d.update(H)}if(m.select2d){m.select2d.update(m.markerOptions);m.select2d.update(m.markerSelectedOptions)}if(m.glText){v.forEach((function(e){var t=((e||[])[0]||{}).trace||{};if(c.hasText(t)){h(e)}}))}}else{if(m.scatter2d){m.scatter2d.update(m.markerOptions)}}var q={viewport:p(d,g,y,t._context.plotGlPixelRatio),range:[(g._rl||g.range)[0],(y._rl||y.range)[0],(g._rl||g.range)[1],(y._rl||y.range)[1]]};var G=s.repeat(q,m.count);if(m.fill2d){m.fill2d.update(G)}if(m.line2d){m.line2d.update(G)}if(m.error2d){m.error2d.update(G.concat(G))}if(m.scatter2d){m.scatter2d.update(G)}if(m.select2d){m.select2d.update(G)}if(m.glText){m.glText.forEach((function(e){e.update(q)}))}}},{"../../components/dragelement/helpers":668,"../../lib":787,"../../lib/prepare_regl":800,"../scatter/link_traces":1218,"../scatter/subtypes":1227,"./edit_style":1259,"gl-text":347,"regl-error2d":522,"regl-line2d":523,"regl-scatter2d":524}],1265:[function(e,t,r){"use strict";var a=e("../../lib");t.exports=function e(t,r){var n=r._scene;var i={count:0,dirty:true,lineOptions:[],fillOptions:[],markerOptions:[],markerSelectedOptions:[],markerUnselectedOptions:[],errorXOptions:[],errorYOptions:[],textOptions:[],textSelectedOptions:[],textUnselectedOptions:[],selectBatch:[],unselectBatch:[]};var o={fill2d:false,scatter2d:false,error2d:false,line2d:false,glText:false,select2d:false};if(!r._scene){n=r._scene={};n.init=function e(){a.extendFlat(n,o,i)};n.init();n.update=function e(t){var r=a.repeat(t,n.count);if(n.fill2d)n.fill2d.update(r);if(n.scatter2d)n.scatter2d.update(r);if(n.line2d)n.line2d.update(r);if(n.error2d)n.error2d.update(r.concat(r));if(n.select2d)n.select2d.update(r);if(n.glText){for(var i=0;i<n.count;i++){n.glText[i].update(t)}}};n.draw=function e(){var t=n.count;var r=n.fill2d;var i=n.error2d;var o=n.line2d;var s=n.scatter2d;var l=n.glText;var u=n.select2d;var c=n.selectBatch;var f=n.unselectBatch;for(var h=0;h<t;h++){if(r&&n.fillOrder[h]){r.draw(n.fillOrder[h])}if(o&&n.lineOptions[h]){o.draw(h)}if(i){if(n.errorXOptions[h])i.draw(h);if(n.errorYOptions[h])i.draw(h+t)}if(s&&n.markerOptions[h]){if(f[h].length){var p=a.repeat([],n.count);p[h]=f[h];s.draw(p)}else if(!c[h].length){s.draw(h)}}if(l[h]&&n.textOptions[h]){l[h].render()}}if(u){u.draw(c)}n.dirty=false};n.destroy=function e(){if(n.fill2d&&n.fill2d.destroy)n.fill2d.destroy();if(n.scatter2d&&n.scatter2d.destroy)n.scatter2d.destroy();if(n.error2d&&n.error2d.destroy)n.error2d.destroy();if(n.line2d&&n.line2d.destroy)n.line2d.destroy();if(n.select2d&&n.select2d.destroy)n.select2d.destroy();if(n.glText){n.glText.forEach((function(e){if(e.destroy)e.destroy()}))}n.lineOptions=null;n.fillOptions=null;n.markerOptions=null;n.markerSelectedOptions=null;n.markerUnselectedOptions=null;n.errorXOptions=null;n.errorYOptions=null;n.textOptions=null;n.textSelectedOptions=null;n.textUnselectedOptions=null;n.selectBatch=null;n.unselectBatch=null;r._scene=null}}if(!n.dirty){a.extendFlat(n,i)}return n}},{"../../lib":787}],1266:[function(e,t,r){"use strict";var a=e("../scatter/subtypes");var n=e("./edit_style").styleTextSelection;t.exports=function e(t,r){var i=t.cd;var o=t.xaxis;var s=t.yaxis;var l=[];var u=i[0].trace;var c=i[0].t;var f=u._length;var h=c.x;var p=c.y;var v=c._scene;var d=c.index;if(!v)return l;var m=a.hasText(u);var g=a.hasMarkers(u);var y=!g&&!m;if(u.visible!==true||y)return l;var x=[];var b=[];if(r!==false&&!r.degenerate){for(var _=0;_<f;_++){if(r.contains([c.xpx[_],c.ypx[_]],false,_,t)){x.push(_);l.push({pointNumber:_,x:o.c2d(h[_]),y:s.c2d(p[_])})}else{b.push(_)}}}if(g){var w=v.scatter2d;if(!x.length&&!b.length){var T=new Array(v.count);T[d]=v.markerOptions[d];w.update.apply(w,T)}else if(!v.selectBatch[d].length&&!v.unselectBatch[d].length){var k=new Array(v.count);k[d]=v.markerUnselectedOptions[d];w.update.apply(w,k)}}v.selectBatch[d]=x;v.unselectBatch[d]=b;if(m){n(i)}return l}},{"../scatter/subtypes":1227,"./edit_style":1259}],1267:[function(e,t,r){"use strict";var a=e("../../plots/template_attributes").hovertemplateAttrs;var n=e("../../plots/template_attributes").texttemplateAttrs;var i=e("../scattergeo/attributes");var o=e("../scatter/attributes");var s=e("../../plots/mapbox/layout_attributes");var l=e("../../plots/attributes");var u=e("../../components/colorscale/attributes");var c=e("../../lib/extend").extendFlat;var f=e("../../plot_api/edit_types").overrideAll;var h=i.line;var p=i.marker;t.exports=f({lon:i.lon,lat:i.lat,mode:c({},o.mode,{dflt:"markers"}),text:c({},o.text,{}),texttemplate:n({editType:"plot"},{keys:["lat","lon","text"]}),hovertext:c({},o.hovertext,{}),line:{color:h.color,width:h.width},connectgaps:o.connectgaps,marker:c({symbol:{valType:"string",dflt:"circle",arrayOk:true},angle:{valType:"number",dflt:"auto",arrayOk:true},allowoverlap:{valType:"boolean",dflt:false},opacity:p.opacity,size:p.size,sizeref:p.sizeref,sizemin:p.sizemin,sizemode:p.sizemode},u("marker")),fill:i.fill,fillcolor:o.fillcolor,textfont:s.layers.symbol.textfont,textposition:s.layers.symbol.textposition,below:{valType:"string"},selected:{marker:o.selected.marker},unselected:{marker:o.unselected.marker},hoverinfo:c({},l.hoverinfo,{flags:["lon","lat","text","name"]}),hovertemplate:a()},"calc","nested")},{"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../plot_api/edit_types":820,"../../plots/attributes":834,"../../plots/mapbox/layout_attributes":897,"../../plots/template_attributes":910,"../scatter/attributes":1202,"../scattergeo/attributes":1244}],1268:[function(e,t,r){"use strict";var a=e("fast-isnumeric");var n=e("../../lib");var i=e("../../constants/numerical").BADNUM;var o=e("../../lib/geojson_utils");var s=e("../../components/colorscale");var l=e("../../components/drawing");var u=e("../scatter/make_bubble_size_func");var c=e("../scatter/subtypes");var f=e("../../plots/mapbox/convert_text_opts");var h=e("../../components/fx/helpers").appendArrayPointValue;var p=e("../../lib/svg_text_utils").NEWLINES;var v=e("../../lib/svg_text_utils").BR_TAG_ALL;t.exports=function e(t,r){var a=r[0].trace;var i=a.visible===true&&a._length!==0;var s=a.fill!=="none";var l=c.hasLines(a);var u=c.hasMarkers(a);var h=c.hasText(a);var p=u&&a.marker.symbol==="circle";var v=u&&a.marker.symbol!=="circle";var y=d();var x=d();var b=d();var _=d();var w={fill:y,line:x,circle:b,symbol:_};if(!i)return w;var T;if(s||l){T=o.calcTraceToLineCoords(r)}if(s){y.geojson=o.makePolygon(T);y.layout.visibility="visible";n.extendFlat(y.paint,{"fill-color":a.fillcolor})}if(l){x.geojson=o.makeLine(T);x.layout.visibility="visible";n.extendFlat(x.paint,{"line-width":a.line.width,"line-color":a.line.color,"line-opacity":a.opacity})}if(p){var k=m(r);b.geojson=k.geojson;b.layout.visibility="visible";n.extendFlat(b.paint,{"circle-color":k.mcc,"circle-radius":k.mrc,"circle-opacity":k.mo})}if(v||h){_.geojson=g(r,t);n.extendFlat(_.layout,{visibility:"visible","icon-image":"{symbol}-15","text-field":"{text}"});if(v){n.extendFlat(_.layout,{"icon-size":a.marker.size/10});if("angle"in a.marker&&a.marker.angle!=="auto"){n.extendFlat(_.layout,{"icon-rotate":{type:"identity",property:"angle"},"icon-rotation-alignment":"map"})}_.layout["icon-allow-overlap"]=a.marker.allowoverlap;n.extendFlat(_.paint,{"icon-opacity":a.opacity*a.marker.opacity,"icon-color":a.marker.color})}if(h){var M=(a.marker||{}).size;var A=f(a.textposition,M);n.extendFlat(_.layout,{"text-size":a.textfont.size,"text-anchor":A.anchor,"text-offset":A.offset});n.extendFlat(_.paint,{"text-color":a.textfont.color,"text-opacity":a.opacity})}}return w};function d(){return{geojson:o.makeBlank(),layout:{visibility:"none"},paint:{}}}function m(e){var t=e[0].trace;var r=t.marker;var i=t.selectedpoints;var o=n.isArrayOrTypedArray(r.color);var c=n.isArrayOrTypedArray(r.size);var f=n.isArrayOrTypedArray(r.opacity);var h;function p(e){return t.opacity*e}function v(e){return e/2}var d;if(o){if(s.hasColorscale(t,"marker")){d=s.makeColorScaleFuncFromTrace(r)}else{d=n.identity}}var m;if(c){m=u(t)}var g;if(f){g=function(e){var t=a(e)?+n.constrain(e,0,1):0;return p(t)}}var y=[];for(h=0;h<e.length;h++){var x=e[h];var _=x.lonlat;if(b(_))continue;var w={};if(d)w.mcc=x.mcc=d(x.mc);if(m)w.mrc=x.mrc=m(x.ms);if(g)w.mo=g(x.mo);if(i)w.selected=x.selected||0;y.push({type:"Feature",geometry:{type:"Point",coordinates:_},properties:w})}var T;if(i){T=l.makeSelectedPointStyleFns(t);for(h=0;h<y.length;h++){var k=y[h].properties;if(T.selectedOpacityFn){k.mo=p(T.selectedOpacityFn(k))}if(T.selectedColorFn){k.mcc=T.selectedColorFn(k)}if(T.selectedSizeFn){k.mrc=T.selectedSizeFn(k)}}}return{geojson:{type:"FeatureCollection",features:y},mcc:o||T&&T.selectedColorFn?{type:"identity",property:"mcc"}:r.color,mrc:c||T&&T.selectedSizeFn?{type:"identity",property:"mrc"}:v(r.size),mo:f||T&&T.selectedOpacityFn?{type:"identity",property:"mo"}:p(r.opacity)}}function g(e,t){var r=t._fullLayout;var a=e[0].trace;var i=a.marker||{};var o=i.symbol;var s=i.angle;var l=o!=="circle"?y(o):x;var u=s!=="auto"?y(s,true):x;var f=c.hasText(a)?y(a.text):x;var d=[];for(var m=0;m<e.length;m++){var g=e[m];if(b(g.lonlat))continue;var _=a.texttemplate;var w;if(_){var T=Array.isArray(_)?_[m]||"":_;var k=a._module.formatLabels(g,a,r);var M={};h(M,a,g.i);var A=a._meta||{};w=n.texttemplateString(T,k,r._d3locale,M,g,A)}else{w=f(m)}if(w){w=w.replace(p,"").replace(v,"\n")}d.push({type:"Feature",geometry:{type:"Point",coordinates:g.lonlat},properties:{symbol:l(m),angle:u(m),text:w}})}return{type:"FeatureCollection",features:d}}function y(e,t){if(n.isArrayOrTypedArray(e)){if(t){return function(t){return a(e[t])?+e[t]:0}}return function(t){return e[t]}}else if(e){return function(){return e}}else{return x}}function x(){return""}function b(e){return e[0]===i}},{"../../components/colorscale":662,"../../components/drawing":672,"../../components/fx/helpers":686,"../../constants/numerical":763,"../../lib":787,"../../lib/geojson_utils":781,"../../lib/svg_text_utils":813,"../../plots/mapbox/convert_text_opts":894,"../scatter/make_bubble_size_func":1219,"../scatter/subtypes":1227,"fast-isnumeric":246}],1269:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("../scatter/subtypes");var i=e("../scatter/marker_defaults");var o=e("../scatter/line_defaults");var s=e("../scatter/text_defaults");var l=e("../scatter/fillcolor_defaults");var u=e("./attributes");t.exports=function e(t,r,f,h){function p(e,n){return a.coerce(t,r,u,e,n)}var v=c(t,r,p);if(!v){r.visible=false;return}p("text");p("texttemplate");p("hovertext");p("hovertemplate");p("mode");p("below");if(n.hasLines(r)){o(t,r,f,h,p,{noDash:true});p("connectgaps")}if(n.hasMarkers(r)){i(t,r,f,h,p,{noLine:true});p("marker.allowoverlap");p("marker.angle");var d=r.marker;if(d.symbol!=="circle"){if(a.isArrayOrTypedArray(d.size))d.size=d.size[0];if(a.isArrayOrTypedArray(d.color))d.color=d.color[0]}}if(n.hasText(r)){s(t,r,h,p,{noSelect:true})}p("fill");if(r.fill!=="none"){l(t,r,f,p)}a.coerceSelectionMarkerOpacity(r,p)};function c(e,t,r){var a=r("lon")||[];var n=r("lat")||[];var i=Math.min(a.length,n.length);t._length=i;return i}},{"../../lib":787,"../scatter/fillcolor_defaults":1210,"../scatter/line_defaults":1215,"../scatter/marker_defaults":1221,"../scatter/subtypes":1227,"../scatter/text_defaults":1228,"./attributes":1267}],1270:[function(e,t,r){"use strict";t.exports=function e(t,r){t.lon=r.lon;t.lat=r.lat;return t}},{}],1271:[function(e,t,r){"use strict";var a=e("../../plots/cartesian/axes");t.exports=function e(t,r,n){var i={};var o=n[r.subplot]._subplot;var s=o.mockAxis;var l=t.lonlat;i.lonLabel=a.tickText(s,s.c2l(l[0]),true).text;i.latLabel=a.tickText(s,s.c2l(l[1]),true).text;return i}},{"../../plots/cartesian/axes":838}],1272:[function(e,t,r){"use strict";var a=e("../../components/fx");var n=e("../../lib");var i=e("../scatter/get_trace_color");var o=n.fillText;var s=e("../../constants/numerical").BADNUM;function l(e,t,r){var o=e.cd;var l=o[0].trace;var c=e.xa;var f=e.ya;var h=e.subplot;var p=t>=0?Math.floor((t+180)/360):Math.ceil((t-180)/360);var v=p*360;var d=t-v;function m(e){var t=e.lonlat;if(t[0]===s)return Infinity;var a=n.modHalf(t[0],360);var i=t[1];var o=h.project([a,i]);var l=o.x-c.c2p([d,i]);var u=o.y-f.c2p([a,r]);var p=Math.max(3,e.mrc||0);return Math.max(Math.sqrt(l*l+u*u)-p,1-3/p)}a.getClosest(o,m,e);if(e.index===false)return;var g=o[e.index];var y=g.lonlat;var x=[n.modHalf(y[0],360)+v,y[1]];var b=c.c2p(x);var _=f.c2p(x);var w=g.mrc||1;e.x0=b-w;e.x1=b+w;e.y0=_-w;e.y1=_+w;var T={};T[l.subplot]={_subplot:h};var k=l._module.formatLabels(g,l,T);e.lonLabel=k.lonLabel;e.latLabel=k.latLabel;e.color=i(l,g);e.extraText=u(l,g,o[0].t.labels);e.hovertemplate=l.hovertemplate;return[e]}function u(e,t,r){if(e.hovertemplate)return;var a=t.hi||e.hoverinfo;var n=a.split("+");var i=n.indexOf("all")!==-1;var s=n.indexOf("lon")!==-1;var l=n.indexOf("lat")!==-1;var u=t.lonlat;var c=[];function f(e){return e+"°"}if(i||s&&l){c.push("("+f(u[1])+", "+f(u[0])+")")}else if(s){c.push(r.lon+f(u[0]))}else if(l){c.push(r.lat+f(u[1]))}if(i||n.indexOf("text")!==-1){o(t,e,c)}return c.join("<br>")}t.exports={hoverPoints:l,getExtraText:u}},{"../../components/fx":690,"../../constants/numerical":763,"../../lib":787,"../scatter/get_trace_color":1212}],1273:[function(e,t,r){"use strict";t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),colorbar:e("../scatter/marker_colorbar"),formatLabels:e("./format_labels"),calc:e("../scattergeo/calc"),plot:e("./plot"),hoverPoints:e("./hover").hoverPoints,eventData:e("./event_data"),selectPoints:e("./select"),styleOnSelect:function(e,t){if(t){var r=t[0].trace;r._glTrace.update(t)}},moduleType:"trace",name:"scattermapbox",basePlotModule:e("../../plots/mapbox"),categories:["mapbox","gl","symbols","showLegend","scatter-like"],meta:{}}},{"../../plots/mapbox":895,"../scatter/marker_colorbar":1220,"../scattergeo/calc":1245,"./attributes":1267,"./defaults":1269,"./event_data":1270,"./format_labels":1271,"./hover":1272,"./plot":1274,"./select":1275}],1274:[function(e,t,r){"use strict";var a=e("./convert");var n=e("../../plots/mapbox/constants").traceLayerPrefix;var i=["fill","line","circle","symbol"];function o(e,t){this.type="scattermapbox";this.subplot=e;this.uid=t;this.sourceIds={fill:"source-"+t+"-fill",line:"source-"+t+"-line",circle:"source-"+t+"-circle",symbol:"source-"+t+"-symbol"};this.layerIds={fill:n+t+"-fill",line:n+t+"-line",circle:n+t+"-circle",symbol:n+t+"-symbol"};this.below=null}var s=o.prototype;s.addSource=function(e,t){this.subplot.map.addSource(this.sourceIds[e],{type:"geojson",data:t.geojson})};s.setSourceData=function(e,t){this.subplot.map.getSource(this.sourceIds[e]).setData(t.geojson)};s.addLayer=function(e,t,r){this.subplot.addLayer({type:e,id:this.layerIds[e],source:this.sourceIds[e],layout:t.layout,paint:t.paint},r)};s.update=function e(t){var r=this.subplot;var n=r.map;var o=a(r.gd,t);var s=r.belowLookup["trace-"+this.uid];var l,u,c;if(s!==this.below){for(l=i.length-1;l>=0;l--){u=i[l];n.removeLayer(this.layerIds[u])}for(l=0;l<i.length;l++){u=i[l];c=o[u];this.addLayer(u,c,s)}this.below=s}for(l=0;l<i.length;l++){u=i[l];c=o[u];r.setOptions(this.layerIds[u],"setLayoutProperty",c.layout);if(c.layout.visibility==="visible"){this.setSourceData(u,c);r.setOptions(this.layerIds[u],"setPaintProperty",c.paint)}}t[0].trace._glTrace=this};s.dispose=function e(){var t=this.subplot.map;for(var r=i.length-1;r>=0;r--){var a=i[r];t.removeLayer(this.layerIds[a]);t.removeSource(this.sourceIds[a])}};t.exports=function e(t,r){var n=r[0].trace;var s=new o(t,n.uid);var l=a(t.gd,r);var u=s.below=t.belowLookup["trace-"+n.uid];for(var c=0;c<i.length;c++){var f=i[c];var h=l[f];s.addSource(f,h);s.addLayer(f,h,u)}r[0].trace._glTrace=s;return s}},{"../../plots/mapbox/constants":893,"./convert":1268}],1275:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("../scatter/subtypes");var i=e("../../constants/numerical").BADNUM;t.exports=function e(t,r){var o=t.cd;var s=t.xaxis;var l=t.yaxis;var u=[];var c=o[0].trace;var f;if(!n.hasMarkers(c))return[];if(r===false){for(f=0;f<o.length;f++){o[f].selected=0}}else{for(f=0;f<o.length;f++){var h=o[f];var p=h.lonlat;if(p[0]!==i){var v=[a.modHalf(p[0],360),p[1]];var d=[s.c2p(v),l.c2p(v)];if(r.contains(d,null,f,t)){u.push({pointNumber:f,lon:p[0],lat:p[1]});h.selected=1}else{h.selected=0}}}}return u}},{"../../constants/numerical":763,"../../lib":787,"../scatter/subtypes":1227}],1276:[function(e,t,r){"use strict";var a=e("../../plots/template_attributes").hovertemplateAttrs;var n=e("../../plots/template_attributes").texttemplateAttrs;var i=e("../../lib/extend").extendFlat;var o=e("../scatter/attributes");var s=e("../../plots/attributes");var l=o.line;t.exports={mode:o.mode,r:{valType:"data_array",editType:"calc+clearAxisTypes"},theta:{valType:"data_array",editType:"calc+clearAxisTypes"},r0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dr:{valType:"number",dflt:1,editType:"calc"},theta0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dtheta:{valType:"number",editType:"calc"},thetaunit:{valType:"enumerated",values:["radians","degrees","gradians"],dflt:"degrees",editType:"calc+clearAxisTypes"},text:o.text,texttemplate:n({editType:"plot"},{keys:["r","theta","text"]}),hovertext:o.hovertext,line:{color:l.color,width:l.width,dash:l.dash,shape:i({},l.shape,{values:["linear","spline"]}),smoothing:l.smoothing,editType:"calc"},connectgaps:o.connectgaps,marker:o.marker,cliponaxis:i({},o.cliponaxis,{dflt:false}),textposition:o.textposition,textfont:o.textfont,fill:i({},o.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:o.fillcolor,hoverinfo:i({},s.hoverinfo,{flags:["r","theta","text","name"]}),hoveron:o.hoveron,hovertemplate:a(),selected:o.selected,unselected:o.unselected}},{"../../lib/extend":777,"../../plots/attributes":834,"../../plots/template_attributes":910,"../scatter/attributes":1202}],1277:[function(e,t,r){"use strict";var a=e("fast-isnumeric");var n=e("../../constants/numerical").BADNUM;var i=e("../../plots/cartesian/axes");var o=e("../scatter/colorscale_calc");var s=e("../scatter/arrays_to_calcdata");var l=e("../scatter/calc_selection");var u=e("../scatter/calc").calcMarkerSize;t.exports=function e(t,r){var c=t._fullLayout;var f=r.subplot;var h=c[f].radialaxis;var p=c[f].angularaxis;var v=h.makeCalcdata(r,"r");var d=p.makeCalcdata(r,"theta");var m=r._length;var g=new Array(m);for(var y=0;y<m;y++){var x=v[y];var b=d[y];var _=g[y]={};if(a(x)&&a(b)){_.r=x;_.theta=b}else{_.r=n}}var w=u(r,m);r._extremes.x=i.findExtremes(h,v,{ppad:w});o(t,r);s(g,r);l(g,r);return g}},{"../../constants/numerical":763,"../../plots/cartesian/axes":838,"../scatter/arrays_to_calcdata":1201,"../scatter/calc":1203,"../scatter/calc_selection":1204,"../scatter/colorscale_calc":1205,"fast-isnumeric":246}],1278:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("../scatter/subtypes");var i=e("../scatter/marker_defaults");var o=e("../scatter/line_defaults");var s=e("../scatter/line_shape_defaults");var l=e("../scatter/text_defaults");var u=e("../scatter/fillcolor_defaults");var c=e("../scatter/constants").PTS_LINESONLY;var f=e("./attributes");function h(e,t,r,h){function v(r,n){return a.coerce(e,t,f,r,n)}var d=p(e,t,h,v);if(!d){t.visible=false;return}v("thetaunit");v("mode",d<c?"lines+markers":"lines");v("text");v("hovertext");if(t.hoveron!=="fills")v("hovertemplate");if(n.hasLines(t)){o(e,t,r,h,v);s(e,t,v);v("connectgaps")}if(n.hasMarkers(t)){i(e,t,r,h,v,{gradient:true})}if(n.hasText(t)){v("texttemplate");l(e,t,h,v)}var m=[];if(n.hasMarkers(t)||n.hasText(t)){v("cliponaxis");v("marker.maxdisplayed");m.push("points")}v("fill");if(t.fill!=="none"){u(e,t,r,v);if(!n.hasLines(t))s(e,t,v)}if(t.fill==="tonext"||t.fill==="toself"){m.push("fills")}v("hoveron",m.join("+")||"points");a.coerceSelectionMarkerOpacity(t,v)}function p(e,t,r,a){var n=a("r");var i=a("theta");var o;if(n){if(i){o=Math.min(n.length,i.length)}else{o=n.length;a("theta0");a("dtheta")}}else{if(!i)return 0;o=t.theta.length;a("r0");a("dr")}t._length=o;return o}t.exports={handleRThetaDefaults:p,supplyDefaults:h}},{"../../lib":787,"../scatter/constants":1206,"../scatter/fillcolor_defaults":1210,"../scatter/line_defaults":1215,"../scatter/line_shape_defaults":1217,"../scatter/marker_defaults":1221,"../scatter/subtypes":1227,"../scatter/text_defaults":1228,"./attributes":1276}],1279:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("../../plots/cartesian/axes");t.exports=function e(t,r,i){var o={};var s=i[r.subplot]._subplot;var l;var u;if(!s){s=i[r.subplot];l=s.radialaxis;u=s.angularaxis}else{l=s.radialAxis;u=s.angularAxis}var c=l.c2l(t.r);o.rLabel=n.tickText(l,c,true).text;var f=u.thetaunit==="degrees"?a.rad2deg(t.theta):t.theta;o.thetaLabel=n.tickText(u,f,true).text;return o}},{"../../lib":787,"../../plots/cartesian/axes":838}],1280:[function(e,t,r){"use strict";var a=e("../scatter/hover");function n(e,t,r,n){var o=a(e,t,r,n);if(!o||o[0].index===false)return;var s=o[0];if(s.index===undefined){return o}var l=e.subplot;var u=s.cd[s.index];var c=s.trace;if(!l.isPtInside(u))return;s.xLabelVal=undefined;s.yLabelVal=undefined;i(u,c,l,s);s.hovertemplate=c.hovertemplate;return o}function i(e,t,r,a){var n=r.radialAxis;var i=r.angularAxis;n._hovertitle="r";i._hovertitle="θ";var o={};o[t.subplot]={_subplot:r};var s=t._module.formatLabels(e,t,o);a.rLabel=s.rLabel;a.thetaLabel=s.thetaLabel;var l=e.hi||t.hoverinfo;var u=[];function c(e,t){u.push(e._hovertitle+": "+t)}if(!t.hovertemplate){var f=l.split("+");if(f.indexOf("all")!==-1)f=["r","theta","text"];if(f.indexOf("r")!==-1)c(n,a.rLabel);if(f.indexOf("theta")!==-1)c(i,a.thetaLabel);if(f.indexOf("text")!==-1&&a.text){u.push(a.text);delete a.text}a.extraText=u.join("<br>")}}t.exports={hoverPoints:n,makeHoverPointText:i}},{"../scatter/hover":1213}],1281:[function(e,t,r){"use strict";t.exports={moduleType:"trace",name:"scatterpolar",basePlotModule:e("../../plots/polar"),categories:["polar","symbols","showLegend","scatter-like"],attributes:e("./attributes"),supplyDefaults:e("./defaults").supplyDefaults,colorbar:e("../scatter/marker_colorbar"),formatLabels:e("./format_labels"),calc:e("./calc"),plot:e("./plot"),style:e("../scatter/style").style,styleOnSelect:e("../scatter/style").styleOnSelect,hoverPoints:e("./hover").hoverPoints,selectPoints:e("../scatter/select"),meta:{}}},{"../../plots/polar":904,"../scatter/marker_colorbar":1220,"../scatter/select":1224,"../scatter/style":1226,"./attributes":1276,"./calc":1277,"./defaults":1278,"./format_labels":1279,"./hover":1280,"./plot":1282}],1282:[function(e,t,r){"use strict";var a=e("../scatter/plot");var n=e("../../constants/numerical").BADNUM;t.exports=function e(t,r,i){var o=r.layers.frontplot.select("g.scatterlayer");var s={xaxis:r.xaxis,yaxis:r.yaxis,plot:r.framework,layerClipId:r._hasClipOnAxisFalse?r.clipIds.forTraces:null};var l=r.radialAxis;var u=r.angularAxis;for(var c=0;c<i.length;c++){var f=i[c];for(var h=0;h<f.length;h++){var p=f[h];var v=p.r;if(v===n){p.x=p.y=n}else{var d=l.c2g(v);var m=u.c2g(p.theta);p.x=d*Math.cos(m);p.y=d*Math.sin(m)}}}a(t,s,i,o)}},{"../../constants/numerical":763,"../scatter/plot":1223}],1283:[function(e,t,r){"use strict";var a=e("../scatterpolar/attributes");var n=e("../scattergl/attributes");var i=e("../../plots/template_attributes").texttemplateAttrs;t.exports={mode:a.mode,r:a.r,theta:a.theta,r0:a.r0,dr:a.dr,theta0:a.theta0,dtheta:a.dtheta,thetaunit:a.thetaunit,text:a.text,texttemplate:i({editType:"plot"},{keys:["r","theta","text"]}),hovertext:a.hovertext,hovertemplate:a.hovertemplate,line:n.line,connectgaps:n.connectgaps,marker:n.marker,fill:n.fill,fillcolor:n.fillcolor,textposition:n.textposition,textfont:n.textfont,hoverinfo:a.hoverinfo,selected:a.selected,unselected:a.unselected}},{"../../plots/template_attributes":910,"../scattergl/attributes":1254,"../scatterpolar/attributes":1276}],1284:[function(e,t,r){"use strict";var a=e("../scatter/colorscale_calc");var n=e("../scatter/calc").calcMarkerSize;var i=e("../scattergl/convert");var o=e("../../plots/cartesian/axes");var s=e("../scattergl/constants").TOO_MANY_POINTS;t.exports=function e(t,r){var l=t._fullLayout;var u=r.subplot;var c=l[u].radialaxis;var f=l[u].angularaxis;var h=r._r=c.makeCalcdata(r,"r");var p=r._theta=f.makeCalcdata(r,"theta");var v=r._length;var d={};if(v<h.length)h=h.slice(0,v);if(v<p.length)p=p.slice(0,v);d.r=h;d.theta=p;a(t,r);var m=d.opts=i.style(t,r);var g;if(v<s){g=n(r,v)}else if(m.marker){g=2*(m.marker.sizeAvg||Math.max(m.marker.size,3))}r._extremes.x=o.findExtremes(c,h,{ppad:g});return[{x:false,y:false,t:d,trace:r}]}},{"../../plots/cartesian/axes":838,"../scatter/calc":1203,"../scatter/colorscale_calc":1205,"../scattergl/constants":1256,"../scattergl/convert":1257}],1285:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("../scatter/subtypes");var i=e("../scatterpolar/defaults").handleRThetaDefaults;var o=e("../scatter/marker_defaults");var s=e("../scatter/line_defaults");var l=e("../scatter/text_defaults");var u=e("../scatter/fillcolor_defaults");var c=e("../scatter/constants").PTS_LINESONLY;var f=e("./attributes");t.exports=function e(t,r,h,p){function v(e,n){return a.coerce(t,r,f,e,n)}var d=i(t,r,p,v);if(!d){r.visible=false;return}v("thetaunit");v("mode",d<c?"lines+markers":"lines");v("text");v("hovertext");if(r.hoveron!=="fills")v("hovertemplate");if(n.hasLines(r)){s(t,r,h,p,v);v("connectgaps")}if(n.hasMarkers(r)){o(t,r,h,p,v)}if(n.hasText(r)){v("texttemplate");l(t,r,p,v)}v("fill");if(r.fill!=="none"){u(t,r,h,v)}a.coerceSelectionMarkerOpacity(r,v)}},{"../../lib":787,"../scatter/constants":1206,"../scatter/fillcolor_defaults":1210,"../scatter/line_defaults":1215,"../scatter/marker_defaults":1221,"../scatter/subtypes":1227,"../scatter/text_defaults":1228,"../scatterpolar/defaults":1278,"./attributes":1283}],1286:[function(e,t,r){"use strict";var a=e("../scatterpolar/format_labels");t.exports=function e(t,r,n){var i=t.i;if(!("r"in t))t.r=r._r[i];if(!("theta"in t))t.theta=r._theta[i];return a(t,r,n)}},{"../scatterpolar/format_labels":1279}],1287:[function(e,t,r){"use strict";var a=e("../scattergl/hover");var n=e("../scatterpolar/hover").makeHoverPointText;function i(e,t,r,i){var o=e.cd;var s=o[0].t;var l=s.r;var u=s.theta;var c=a.hoverPoints(e,t,r,i);if(!c||c[0].index===false)return;var f=c[0];if(f.index===undefined){return c}var h=e.subplot;var p=f.cd[f.index];var v=f.trace;p.r=l[f.index];p.theta=u[f.index];if(!h.isPtInside(p))return;f.xLabelVal=undefined;f.yLabelVal=undefined;n(p,v,h,f);return c}t.exports={hoverPoints:i}},{"../scattergl/hover":1262,"../scatterpolar/hover":1280}],1288:[function(e,t,r){"use strict";t.exports={moduleType:"trace",name:"scatterpolargl",basePlotModule:e("../../plots/polar"),categories:["gl","regl","polar","symbols","showLegend","scatter-like"],attributes:e("./attributes"),supplyDefaults:e("./defaults"),colorbar:e("../scatter/marker_colorbar"),formatLabels:e("./format_labels"),calc:e("./calc"),plot:e("./plot"),hoverPoints:e("./hover").hoverPoints,selectPoints:e("../scattergl/select"),meta:{}}},{"../../plots/polar":904,"../scatter/marker_colorbar":1220,"../scattergl/select":1266,"./attributes":1283,"./calc":1284,"./defaults":1285,"./format_labels":1286,"./hover":1287,"./plot":1289}],1289:[function(e,t,r){"use strict";var a=e("@plotly/point-cluster");var n=e("fast-isnumeric");var i=e("../scattergl/plot");var o=e("../scattergl/scene_update");var s=e("../scattergl/convert");var l=e("../../lib");var u=e("../scattergl/constants").TOO_MANY_POINTS;t.exports=function e(t,r,c){if(!c.length)return;var f=r.radialAxis;var h=r.angularAxis;var p=o(t,r);c.forEach((function(e){if(!e||!e[0]||!e[0].trace)return;var i=e[0];var o=i.trace;var c=i.t;var v=o._length;var d=c.r;var m=c.theta;var g=c.opts;var y;var x=d.slice();var b=m.slice();for(y=0;y<d.length;y++){if(!r.isPtInside({r:d[y],theta:m[y]})){x[y]=NaN;b[y]=NaN}}var _=new Array(v*2);var w=Array(v);var T=Array(v);for(y=0;y<v;y++){var k=x[y];var M,A;if(n(k)){var S=f.c2g(k);var E=h.c2g(b[y],o.thetaunit);M=S*Math.cos(E);A=S*Math.sin(E)}else{M=A=NaN}w[y]=_[y*2]=M;T[y]=_[y*2+1]=A}c.tree=a(_);if(g.marker&&v>=u){g.marker.cluster=c.tree}if(g.marker){g.markerSel.positions=g.markerUnsel.positions=g.marker.positions=_}if(g.line&&_.length>1){l.extendFlat(g.line,s.linePositions(t,o,_))}if(g.text){l.extendFlat(g.text,{positions:_},s.textPosition(t,o,g.text,g.marker));l.extendFlat(g.textSel,{positions:_},s.textPosition(t,o,g.text,g.markerSel));l.extendFlat(g.textUnsel,{positions:_},s.textPosition(t,o,g.text,g.markerUnsel))}if(g.fill&&!p.fill2d)p.fill2d=true;if(g.marker&&!p.scatter2d)p.scatter2d=true;if(g.line&&!p.line2d)p.line2d=true;if(g.text&&!p.glText)p.glText=true;p.lineOptions.push(g.line);p.fillOptions.push(g.fill);p.markerOptions.push(g.marker);p.markerSelectedOptions.push(g.markerSel);p.markerUnselectedOptions.push(g.markerUnsel);p.textOptions.push(g.text);p.textSelectedOptions.push(g.textSel);p.textUnselectedOptions.push(g.textUnsel);p.selectBatch.push([]);p.unselectBatch.push([]);c.x=w;c.y=T;c.rawx=w;c.rawy=T;c.r=d;c.theta=m;c.positions=_;c._scene=p;c.index=p.count;p.count++}));return i(t,r,c)}},{"../../lib":787,"../scattergl/constants":1256,"../scattergl/convert":1257,"../scattergl/plot":1264,"../scattergl/scene_update":1265,"@plotly/point-cluster":59,"fast-isnumeric":246}],1290:[function(e,t,r){"use strict";var a=e("../../plots/template_attributes").hovertemplateAttrs;var n=e("../../plots/template_attributes").texttemplateAttrs;var i=e("../scatter/attributes");var o=e("../../plots/attributes");var s=e("../../components/colorscale/attributes");var l=e("../../components/drawing/attributes").dash;var u=e("../../lib/extend").extendFlat;var c=i.marker;var f=i.line;var h=c.line;t.exports={a:{valType:"data_array",editType:"calc"},b:{valType:"data_array",editType:"calc"},c:{valType:"data_array",editType:"calc"},sum:{valType:"number",dflt:0,min:0,editType:"calc"},mode:u({},i.mode,{dflt:"markers"}),text:u({},i.text,{}),texttemplate:n({editType:"plot"},{keys:["a","b","c","text"]}),hovertext:u({},i.hovertext,{}),line:{color:f.color,width:f.width,dash:l,shape:u({},f.shape,{values:["linear","spline"]}),smoothing:f.smoothing,editType:"calc"},connectgaps:i.connectgaps,cliponaxis:i.cliponaxis,fill:u({},i.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:i.fillcolor,marker:u({symbol:c.symbol,opacity:c.opacity,maxdisplayed:c.maxdisplayed,size:c.size,sizeref:c.sizeref,sizemin:c.sizemin,sizemode:c.sizemode,line:u({width:h.width,editType:"calc"},s("marker.line")),gradient:c.gradient,editType:"calc"},s("marker")),textfont:i.textfont,textposition:i.textposition,selected:i.selected,unselected:i.unselected,hoverinfo:u({},o.hoverinfo,{flags:["a","b","c","text","name"]}),hoveron:i.hoveron,hovertemplate:a()}},{"../../components/colorscale/attributes":657,"../../components/drawing/attributes":671,"../../lib/extend":777,"../../plots/attributes":834,"../../plots/template_attributes":910,"../scatter/attributes":1202}],1291:[function(e,t,r){"use strict";var a=e("fast-isnumeric");var n=e("../scatter/colorscale_calc");var i=e("../scatter/arrays_to_calcdata");var o=e("../scatter/calc_selection");var s=e("../scatter/calc").calcMarkerSize;var l=["a","b","c"];var u={a:["b","c"],b:["a","c"],c:["a","b"]};t.exports=function e(t,r){var c=t._fullLayout[r.subplot];var f=c.sum;var h=r.sum||f;var p={a:r.a,b:r.b,c:r.c};var v,d,m,g,y,x;for(v=0;v<l.length;v++){m=l[v];if(p[m])continue;y=p[u[m][0]];x=p[u[m][1]];g=new Array(y.length);for(d=0;d<y.length;d++){g[d]=h-y[d]-x[d]}p[m]=g}var b=r._length;var _=new Array(b);var w,T,k,M,A,S;for(v=0;v<b;v++){w=p.a[v];T=p.b[v];k=p.c[v];if(a(w)&&a(T)&&a(k)){w=+w;T=+T;k=+k;M=f/(w+T+k);if(M!==1){w*=M;T*=M;k*=M}S=w;A=k-T;_[v]={x:A,y:S,a:w,b:T,c:k}}else _[v]={x:false,y:false}}s(r,b);n(t,r);i(_,r);o(_,r);return _}},{"../scatter/arrays_to_calcdata":1201,"../scatter/calc":1203,"../scatter/calc_selection":1204,"../scatter/colorscale_calc":1205,"fast-isnumeric":246}],1292:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("../scatter/constants");var i=e("../scatter/subtypes");var o=e("../scatter/marker_defaults");var s=e("../scatter/line_defaults");var l=e("../scatter/line_shape_defaults");var u=e("../scatter/text_defaults");var c=e("../scatter/fillcolor_defaults");var f=e("./attributes");t.exports=function e(t,r,h,p){function v(e,n){return a.coerce(t,r,f,e,n)}var d=v("a");var m=v("b");var g=v("c");var y;if(d){y=d.length;if(m){y=Math.min(y,m.length);if(g)y=Math.min(y,g.length)}else if(g)y=Math.min(y,g.length);else y=0}else if(m&&g){y=Math.min(m.length,g.length)}if(!y){r.visible=false;return}r._length=y;v("sum");v("text");v("hovertext");if(r.hoveron!=="fills")v("hovertemplate");var x=y<n.PTS_LINESONLY?"lines+markers":"lines";v("mode",x);if(i.hasLines(r)){s(t,r,h,p,v);l(t,r,v);v("connectgaps")}if(i.hasMarkers(r)){o(t,r,h,p,v,{gradient:true})}if(i.hasText(r)){v("texttemplate");u(t,r,p,v)}var b=[];if(i.hasMarkers(r)||i.hasText(r)){v("cliponaxis");v("marker.maxdisplayed");b.push("points")}v("fill");if(r.fill!=="none"){c(t,r,h,v);if(!i.hasLines(r))l(t,r,v)}if(r.fill==="tonext"||r.fill==="toself"){b.push("fills")}v("hoveron",b.join("+")||"points");a.coerceSelectionMarkerOpacity(r,v)}},{"../../lib":787,"../scatter/constants":1206,"../scatter/fillcolor_defaults":1210,"../scatter/line_defaults":1215,"../scatter/line_shape_defaults":1217,"../scatter/marker_defaults":1221,"../scatter/subtypes":1227,"../scatter/text_defaults":1228,"./attributes":1290}],1293:[function(e,t,r){"use strict";t.exports=function e(t,r,a,n,i){if(r.xa)t.xaxis=r.xa;if(r.ya)t.yaxis=r.ya;if(n[i]){var o=n[i];t.a=o.a;t.b=o.b;t.c=o.c}else{t.a=r.a;t.b=r.b;t.c=r.c}return t}},{}],1294:[function(e,t,r){"use strict";var a=e("../../plots/cartesian/axes");t.exports=function e(t,r,n){var i={};var o=n[r.subplot]._subplot;i.aLabel=a.tickText(o.aaxis,t.a,true).text;i.bLabel=a.tickText(o.baxis,t.b,true).text;i.cLabel=a.tickText(o.caxis,t.c,true).text;return i}},{"../../plots/cartesian/axes":838}],1295:[function(e,t,r){"use strict";var a=e("../scatter/hover");t.exports=function e(t,r,n,i){var o=a(t,r,n,i);if(!o||o[0].index===false)return;var s=o[0];if(s.index===undefined){var l=1-s.y0/t.ya._length;var u=t.xa._length;var c=u*l/2;var f=u-c;s.x0=Math.max(Math.min(s.x0,f),c);s.x1=Math.max(Math.min(s.x1,f),c);return o}var h=s.cd[s.index];var p=s.trace;var v=s.subplot;s.a=h.a;s.b=h.b;s.c=h.c;s.xLabelVal=undefined;s.yLabelVal=undefined;var d={};d[p.subplot]={_subplot:v};var m=p._module.formatLabels(h,p,d);s.aLabel=m.aLabel;s.bLabel=m.bLabel;s.cLabel=m.cLabel;var g=h.hi||p.hoverinfo;var y=[];function x(e,t){y.push(e._hovertitle+": "+t)}if(!p.hovertemplate){var b=g.split("+");if(b.indexOf("all")!==-1)b=["a","b","c"];if(b.indexOf("a")!==-1)x(v.aaxis,s.aLabel);if(b.indexOf("b")!==-1)x(v.baxis,s.bLabel);if(b.indexOf("c")!==-1)x(v.caxis,s.cLabel)}s.extraText=y.join("<br>");s.hovertemplate=p.hovertemplate;return o}},{"../scatter/hover":1213}],1296:[function(e,t,r){"use strict";t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),colorbar:e("../scatter/marker_colorbar"),formatLabels:e("./format_labels"),calc:e("./calc"),plot:e("./plot"),style:e("../scatter/style").style,styleOnSelect:e("../scatter/style").styleOnSelect,hoverPoints:e("./hover"),selectPoints:e("../scatter/select"),eventData:e("./event_data"),moduleType:"trace",name:"scatterternary",basePlotModule:e("../../plots/ternary"),categories:["ternary","symbols","showLegend","scatter-like"],meta:{}}},{"../../plots/ternary":911,"../scatter/marker_colorbar":1220,"../scatter/select":1224,"../scatter/style":1226,"./attributes":1290,"./calc":1291,"./defaults":1292,"./event_data":1293,"./format_labels":1294,"./hover":1295,"./plot":1297}],1297:[function(e,t,r){"use strict";var a=e("../scatter/plot");t.exports=function e(t,r,n){var i=r.plotContainer;i.select(".scatterlayer").selectAll("*").remove();var o={xaxis:r.xaxis,yaxis:r.yaxis,plot:i,layerClipId:r._hasClipOnAxisFalse?r.clipIdRelative:null};var s=r.layers.frontplot.select("g.scatterlayer");a(t,o,n,s)}},{"../scatter/plot":1223}],1298:[function(e,t,r){"use strict";var a=e("../scatter/attributes");var n=e("../../components/colorscale/attributes");var i=e("../../plots/cartesian/axis_format_attributes").axisHoverFormat;var o=e("../../plots/template_attributes").hovertemplateAttrs;var s=e("../scattergl/attributes");var l=e("../../plots/cartesian/constants").idRegex;var u=e("../../plot_api/plot_template").templatedArray;var c=e("../../lib/extend").extendFlat;var f=a.marker;var h=f.line;var p=c(n("marker.line",{editTypeOverride:"calc"}),{width:c({},h.width,{editType:"calc"}),editType:"calc"});var v=c(n("marker"),{symbol:f.symbol,size:c({},f.size,{editType:"markerSize"}),sizeref:f.sizeref,sizemin:f.sizemin,sizemode:f.sizemode,opacity:f.opacity,colorbar:f.colorbar,line:p,editType:"calc"});v.color.editType=v.cmin.editType=v.cmax.editType="style";function d(e){return{valType:"info_array",freeLength:true,editType:"calc",items:{valType:"subplotid",regex:l[e],editType:"plot"}}}t.exports={dimensions:u("dimension",{visible:{valType:"boolean",dflt:true,editType:"calc"},label:{valType:"string",editType:"calc"},values:{valType:"data_array",editType:"calc+clearAxisTypes"},axis:{type:{valType:"enumerated",values:["linear","log","date","category"],editType:"calc+clearAxisTypes"},matches:{valType:"boolean",dflt:false,editType:"calc"},editType:"calc+clearAxisTypes"},editType:"calc+clearAxisTypes"}),text:c({},s.text,{}),hovertext:c({},s.hovertext,{}),hovertemplate:o(),xhoverformat:i("x"),yhoverformat:i("y"),marker:v,xaxes:d("x"),yaxes:d("y"),diagonal:{visible:{valType:"boolean",dflt:true,editType:"calc"},editType:"calc"},showupperhalf:{valType:"boolean",dflt:true,editType:"calc"},showlowerhalf:{valType:"boolean",dflt:true,editType:"calc"},selected:{marker:s.selected.marker,editType:"calc"},unselected:{marker:s.unselected.marker,editType:"calc"},opacity:s.opacity}},{"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../plot_api/plot_template":827,"../../plots/cartesian/axis_format_attributes":841,"../../plots/cartesian/constants":845,"../../plots/template_attributes":910,"../scatter/attributes":1202,"../scattergl/attributes":1254}],1299:[function(e,t,r){"use strict";var a=e("regl-line2d");var n=e("../../registry");var i=e("../../lib/prepare_regl");var o=e("../../plots/get_data").getModuleCalcData;var s=e("../../plots/cartesian");var l=e("../../plots/cartesian/axis_ids").getFromId;var u=e("../../plots/cartesian/axes").shouldShowZeroLine;var c="splom";function f(e){var t=e._fullLayout;var r=n.getModule(c);var a=o(e.calcdata,r)[0];var s=i(e,["ANGLE_instanced_arrays","OES_element_index_uint"]);if(!s)return;if(t._hasOnlyLargeSploms){v(e)}r.plot(e,{},a)}function h(e){var t=e.calcdata;var r=e._fullLayout;if(r._hasOnlyLargeSploms){v(e)}for(var a=0;a<t.length;a++){var n=t[a][0];var i=n.trace;var o=r._splomScenes[i.uid];if(i.type==="splom"&&o&&o.matrix){p(e,i,o)}}}function p(e,t,r){var a=r.matrixOptions.data.length;var n=t._visibleDims;var i=r.viewOpts.ranges=new Array(a);for(var o=0;o<n.length;o++){var s=n[o];var u=i[o]=new Array(4);var c=l(e,t._diag[s][0]);if(c){u[0]=c.r2l(c.range[0]);u[2]=c.r2l(c.range[1])}var f=l(e,t._diag[s][1]);if(f){u[1]=f.r2l(f.range[0]);u[3]=f.r2l(f.range[1])}}if(r.selectBatch.length||r.unselectBatch.length){r.matrix.update({ranges:i},{ranges:i})}else{r.matrix.update({ranges:i})}}function v(e){var t=e._fullLayout;var r=t._glcanvas.data()[0].regl;var n=t._splomGrid;if(!n){n=t._splomGrid=a(r)}n.update(d(e))}function d(e){var t=e._context.plotGlPixelRatio;var r=e._fullLayout;var a=r._size;var n=[0,0,r.width*t,r.height*t];var i={};var o;function s(e,r,a,o,s,l){a*=t;o*=t;s*=t;l*=t;var u=r[e+"color"];var c=r[e+"width"];var f=String(u+c);if(f in i){i[f].data.push(NaN,NaN,a,o,s,l)}else{i[f]={data:[a,o,s,l],join:"rect",thickness:c*t,color:u,viewport:n,range:n,overlay:false}}}for(o in r._splomSubplots){var l=r._plots[o];var c=l.xaxis;var f=l.yaxis;var h=c._gridVals;var p=f._gridVals;var v=c._offset;var d=c._length;var m=f._length;var g=a.b+f.domain[0]*a.h;var y=-f._m;var x=-y*f.r2l(f.range[0],f.calendar);var b,_;if(c.showgrid){for(o=0;o<h.length;o++){b=v+c.l2p(h[o].x);s("grid",c,b,g,b,g+m)}}if(f.showgrid){for(o=0;o<p.length;o++){_=g+x+y*p[o].x;s("grid",f,v,_,v+d,_)}}if(u(e,c,f)){b=v+c.l2p(0);s("zeroline",c,b,g,b,g+m)}if(u(e,f,c)){_=g+x+0;s("zeroline",f,v,_,v+d,_)}}var w=[];for(o in i){w.push(i[o])}return w}function m(e,t,r,a){var n={};var i;if(a._splomScenes){for(i=0;i<e.length;i++){var o=e[i];if(o.type==="splom"){n[o.uid]=1}}for(i=0;i<r.length;i++){var l=r[i];if(!n[l.uid]){var u=a._splomScenes[l.uid];if(u&&u.destroy)u.destroy();a._splomScenes[l.uid]=null;delete a._splomScenes[l.uid]}}}if(Object.keys(a._splomScenes||{}).length===0){delete a._splomScenes}if(a._splomGrid&&(!t._hasOnlyLargeSploms&&a._hasOnlyLargeSploms)){a._splomGrid.destroy();a._splomGrid=null;delete a._splomGrid}s.clean(e,t,r,a)}t.exports={name:c,attr:s.attr,attrRegex:s.attrRegex,layoutAttributes:s.layoutAttributes,supplyLayoutDefaults:s.supplyLayoutDefaults,drawFramework:s.drawFramework,plot:f,drag:h,updateGrid:v,clean:m,updateFx:s.updateFx,toSVG:s.toSVG}},{"../../lib/prepare_regl":800,"../../plots/cartesian":852,"../../plots/cartesian/axes":838,"../../plots/cartesian/axis_ids":842,"../../plots/get_data":875,"../../registry":915,"regl-line2d":523}],1300:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("../../plots/cartesian/axis_ids");var i=e("../scatter/calc").calcMarkerSize;var o=e("../scatter/calc").calcAxisExpansion;var s=e("../scatter/colorscale_calc");var l=e("../scattergl/convert").markerSelection;var u=e("../scattergl/convert").markerStyle;var c=e("./scene_update");var f=e("../../constants/numerical").BADNUM;var h=e("../scattergl/constants").TOO_MANY_POINTS;t.exports=function e(t,r){var p=r.dimensions;var v=r._length;var d={};var m=d.cdata=[];var g=d.data=[];var y=r._visibleDims=[];var x,b,_,w,T;function k(e,t){var n=e.makeCalcdata({v:t.values,vcalendar:r.calendar},"v");for(var i=0;i<n.length;i++){n[i]=n[i]===f?NaN:n[i]}m.push(n);g.push(e.type==="log"?a.simpleMap(n,e.c2l):n)}for(x=0;x<p.length;x++){_=p[x];if(_.visible){w=n.getFromId(t,r._diag[x][0]);T=n.getFromId(t,r._diag[x][1]);if(w&&T&&w.type!==T.type){a.log("Skipping splom dimension "+x+" with conflicting axis types");continue}if(w){k(w,_);if(T&&T.type==="category"){T._categories=w._categories.slice()}}else{k(T,_)}y.push(x)}}s(t,r);a.extendFlat(d,u(r));var M=m.length;var A=M*v>h;var S;if(A){S=d.sizeAvg||Math.max(d.size,3)}else{S=i(r,v)}for(b=0;b<y.length;b++){x=y[b];_=p[x];w=n.getFromId(t,r._diag[x][0])||{};T=n.getFromId(t,r._diag[x][1])||{};o(t,r,w,T,m[b],m[b],S)}var E=c(t,r);if(!E.matrix)E.matrix=true;E.matrixOptions=d;E.selectedOptions=l(r,r.selected);E.unselectedOptions=l(r,r.unselected);return[{x:false,y:false,t:{},trace:r}]}},{"../../constants/numerical":763,"../../lib":787,"../../plots/cartesian/axis_ids":842,"../scatter/calc":1203,"../scatter/colorscale_calc":1205,"../scattergl/constants":1256,"../scattergl/convert":1257,"./scene_update":1307}],1301:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("../../plots/array_container_defaults");var i=e("./attributes");var o=e("../scatter/subtypes");var s=e("../scatter/marker_defaults");var l=e("../parcoords/merge_length");var u=e("../scattergl/helpers").isOpenSymbol;t.exports=function e(t,r,h,p){function v(e,n){return a.coerce(t,r,i,e,n)}var d=n(t,r,{name:"dimensions",handleItemDefaults:c});var m=v("diagonal.visible");var g=v("showupperhalf");var y=v("showlowerhalf");var x=l(r,d,"values");if(!x||!m&&!g&&!y){r.visible=false;return}v("text");v("hovertext");v("hovertemplate");v("xhoverformat");v("yhoverformat");s(t,r,h,p,v);var b=u(r.marker.symbol);var _=o.isBubble(r);v("marker.line.width",b||_?1:0);f(t,r,p,v);a.coerceSelectionMarkerOpacity(r,v)};function c(e,t){function r(r,n){return a.coerce(e,t,i.dimensions,r,n)}r("label");var n=r("values");if(!(n&&n.length))t.visible=false;else r("visible");r("axis.type");r("axis.matches")}function f(e,t,r,a){var n=t.dimensions;var i=n.length;var o=t.showupperhalf;var s=t.showlowerhalf;var l=t.diagonal.visible;var u,c;var f=new Array(i);var h=new Array(i);for(u=0;u<i;u++){var p=u?u+1:"";f[u]="x"+p;h[u]="y"+p}var v=a("xaxes",f);var d=a("yaxes",h);var m=t._diag=new Array(i);t._xaxes={};t._yaxes={};var g=[];var y=[];function x(e,a,n,i){if(!e)return;var o=e.charAt(0);var s=r._splomAxes[o];t["_"+o+"axes"][e]=1;i.push(e);if(!(e in s)){var l=s[e]={};if(n){l.label=n.label||"";if(n.visible&&n.axis){if(n.axis.type)l.type=n.axis.type;if(n.axis.matches)l.matches=a}}}}var b=!l&&!s;var _=!l&&!o;t._axesDim={};for(u=0;u<i;u++){var w=n[u];var T=u===0;var k=u===i-1;var M=T&&b||k&&_?undefined:v[u];var A=T&&_||k&&b?undefined:d[u];x(M,A,w,g);x(A,M,w,y);m[u]=[M,A];t._axesDim[M]=u;t._axesDim[A]=u}for(u=0;u<g.length;u++){for(c=0;c<y.length;c++){var S=g[u]+y[c];if(u>c&&o){r._splomSubplots[S]=1}else if(u<c&&s){r._splomSubplots[S]=1}else if(u===c&&(l||!s||!o)){r._splomSubplots[S]=1}}}if(!s||!l&&o&&s){r._splomGridDflt.xside="bottom";r._splomGridDflt.yside="left"}}},{"../../lib":787,"../../plots/array_container_defaults":833,"../parcoords/merge_length":1173,"../scatter/marker_defaults":1221,"../scatter/subtypes":1227,"../scattergl/helpers":1261,"./attributes":1298}],1302:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("../scatter/colorscale_calc");var i=e("../scattergl/convert").markerStyle;t.exports=function e(t,r){var o=r.trace;var s=t._fullLayout._splomScenes[o.uid];if(s){n(t,o);a.extendFlat(s.matrixOptions,i(o));var l=a.extendFlat({},s.matrixOptions,s.viewOpts);s.matrix.update(l,null)}}},{"../../lib":787,"../scatter/colorscale_calc":1205,"../scattergl/convert":1257}],1303:[function(e,t,r){"use strict";r.getDimIndex=function e(t,r){var a=r._id;var n=a.charAt(0);var i={x:0,y:1}[n];var o=t._visibleDims;for(var s=0;s<o.length;s++){var l=o[s];if(t._diag[l][i]===a)return s}return false}},{}],1304:[function(e,t,r){"use strict";var a=e("./helpers");var n=e("../scattergl/hover").calcHover;function i(e,t,r){var i=e.cd;var o=i[0].trace;var s=e.scene;var l=s.matrixOptions.cdata;var u=e.xa;var c=e.ya;var f=u.c2p(t);var h=c.c2p(r);var p=e.distance;var v=a.getDimIndex(o,u);var d=a.getDimIndex(o,c);if(v===false||d===false)return[e];var m=l[v];var g=l[d];var y,x;var b=p;for(var _=0;_<m.length;_++){var w=m[_];var T=g[_];var k=u.c2p(w)-f;var M=c.c2p(T)-h;var A=Math.sqrt(k*k+M*M);if(A<b){b=x=A;y=_}}e.index=y;e.distance=b;e.dxy=x;if(y===undefined)return[e];return[n(e,m,g,o)]}t.exports={hoverPoints:i}},{"../scattergl/hover":1262,"./helpers":1303}],1305:[function(e,t,r){"use strict";var a=e("../../registry");var n=e("../../components/grid");t.exports={moduleType:"trace",name:"splom",basePlotModule:e("./base_plot"),categories:["gl","regl","cartesian","symbols","showLegend","scatter-like"],attributes:e("./attributes"),supplyDefaults:e("./defaults"),colorbar:e("../scatter/marker_colorbar"),calc:e("./calc"),plot:e("./plot"),hoverPoints:e("./hover").hoverPoints,selectPoints:e("./select"),editStyle:e("./edit_style"),meta:{}};a.register(n)},{"../../components/grid":694,"../../registry":915,"../scatter/marker_colorbar":1220,"./attributes":1298,"./base_plot":1299,"./calc":1300,"./defaults":1301,"./edit_style":1302,"./hover":1304,"./plot":1306,"./select":1308}],1306:[function(e,t,r){"use strict";var a=e("regl-splom");var n=e("../../lib");var i=e("../../plots/cartesian/axis_ids");var o=e("../../components/dragelement/helpers").selectMode;t.exports=function e(t,r,a){if(!a.length)return;for(var n=0;n<a.length;n++){s(t,a[n][0])}};function s(e,t){var r=e._fullLayout;var s=r._size;var l=t.trace;var u=t.t;var c=r._splomScenes[l.uid];var f=c.matrixOptions;var h=f.cdata;var p=r._glcanvas.data()[0].regl;var v=r.dragmode;var d,m;var g,y,x;if(h.length===0)return;f.lower=l.showupperhalf;f.upper=l.showlowerhalf;f.diagonal=l.diagonal.visible;var b=l._visibleDims;var _=h.length;var w=c.viewOpts={};w.ranges=new Array(_);w.domains=new Array(_);for(x=0;x<b.length;x++){g=b[x];var T=w.ranges[x]=new Array(4);var k=w.domains[x]=new Array(4);d=i.getFromId(e,l._diag[g][0]);if(d){T[0]=d._rl[0];T[2]=d._rl[1];k[0]=d.domain[0];k[2]=d.domain[1]}m=i.getFromId(e,l._diag[g][1]);if(m){T[1]=m._rl[0];T[3]=m._rl[1];k[1]=m.domain[0];k[3]=m.domain[1]}}var M=e._context.plotGlPixelRatio;var A=s.l*M;var S=s.b*M;var E=s.w*M;var L=s.h*M;w.viewport=[A,S,E+A,L+S];if(c.matrix===true){c.matrix=a(p)}var C=r.clickmode.indexOf("select")>-1;var I=o(v)||!!l.selectedpoints||C;var P=true;if(I){var O=l._length;if(l.selectedpoints){c.selectBatch=l.selectedpoints;var z=l.selectedpoints;var D={};for(g=0;g<z.length;g++){D[z[g]]=true}var R=[];for(g=0;g<O;g++){if(!D[g])R.push(g)}c.unselectBatch=R}var F=u.xpx=new Array(_);var B=u.ypx=new Array(_);for(x=0;x<b.length;x++){g=b[x];d=i.getFromId(e,l._diag[g][0]);if(d){F[x]=new Array(O);for(y=0;y<O;y++){F[x][y]=d.c2p(h[x][y])}}m=i.getFromId(e,l._diag[g][1]);if(m){B[x]=new Array(O);for(y=0;y<O;y++){B[x][y]=m.c2p(h[x][y])}}}if(c.selectBatch.length||c.unselectBatch.length){var N=n.extendFlat({},f,c.unselectedOptions,w);var j=n.extendFlat({},f,c.selectedOptions,w);c.matrix.update(N,j);P=false}}else{u.xpx=u.ypx=null}if(P){var U=n.extendFlat({},f,w);c.matrix.update(U,null)}}},{"../../components/dragelement/helpers":668,"../../lib":787,"../../plots/cartesian/axis_ids":842,"regl-splom":525}],1307:[function(e,t,r){"use strict";var a=e("../../lib");t.exports=function e(t,r){var n=t._fullLayout;var i=r.uid;var o=n._splomScenes;if(!o)o=n._splomScenes={};var s={dirty:true,selectBatch:[],unselectBatch:[]};var l={matrix:false,selectBatch:[],unselectBatch:[]};var u=o[r.uid];if(!u){u=o[i]=a.extendFlat({},s,l);u.draw=function e(){if(u.matrix&&u.matrix.draw){if(u.selectBatch.length||u.unselectBatch.length){u.matrix.draw(u.unselectBatch,u.selectBatch)}else{u.matrix.draw()}}u.dirty=false};u.destroy=function e(){if(u.matrix&&u.matrix.destroy){u.matrix.destroy()}u.matrixOptions=null;u.selectBatch=null;u.unselectBatch=null;u=null}}if(!u.dirty){a.extendFlat(u,s)}return u}},{"../../lib":787}],1308:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("../scatter/subtypes");var i=e("./helpers");t.exports=function e(t,r){var o=t.cd;var s=o[0].trace;var l=o[0].t;var u=t.scene;var c=u.matrixOptions.cdata;var f=t.xaxis;var h=t.yaxis;var p=[];if(!u)return p;var v=!n.hasMarkers(s)&&!n.hasText(s);if(s.visible!==true||v)return p;var d=i.getDimIndex(s,f);var m=i.getDimIndex(s,h);if(d===false||m===false)return p;var g=l.xpx[d];var y=l.ypx[m];var x=c[d];var b=c[m];var _=[];var w=[];if(r!==false&&!r.degenerate){for(var T=0;T<x.length;T++){if(r.contains([g[T],y[T]],null,T,t)){_.push(T);p.push({pointNumber:T,x:x[T],y:b[T]})}else{w.push(T)}}}var k=u.matrixOptions;if(!_.length&&!w.length){u.matrix.update(k,null)}else if(!u.selectBatch.length&&!u.unselectBatch.length){u.matrix.update(u.unselectedOptions,a.extendFlat({},k,u.selectedOptions,u.viewOpts))}u.selectBatch=_;u.unselectBatch=w;return p}},{"../../lib":787,"../scatter/subtypes":1227,"./helpers":1303}],1309:[function(e,t,r){"use strict";var a=e("../../components/colorscale/attributes");var n=e("../../plots/cartesian/axis_format_attributes").axisHoverFormat;var i=e("../../plots/template_attributes").hovertemplateAttrs;var o=e("../mesh3d/attributes");var s=e("../../plots/attributes");var l=e("../../lib/extend").extendFlat;var u={x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},u:{valType:"data_array",editType:"calc"},v:{valType:"data_array",editType:"calc"},w:{valType:"data_array",editType:"calc"},starts:{x:{valType:"data_array",editType:"calc"},y:{valType:"data_array",editType:"calc"},z:{valType:"data_array",editType:"calc"},editType:"calc"},maxdisplayed:{valType:"integer",min:0,dflt:1e3,editType:"calc"},sizeref:{valType:"number",editType:"calc",min:0,dflt:1},text:{valType:"string",dflt:"",editType:"calc"},hovertext:{valType:"string",dflt:"",editType:"calc"},hovertemplate:i({editType:"calc"},{keys:["tubex","tubey","tubez","tubeu","tubev","tubew","norm","divergence"]}),uhoverformat:n("u",1),vhoverformat:n("v",1),whoverformat:n("w",1),xhoverformat:n("x"),yhoverformat:n("y"),zhoverformat:n("z"),showlegend:l({},s.showlegend,{dflt:false})};l(u,a("",{colorAttr:"u/v/w norm",showScaleDflt:true,editTypeOverride:"calc"}));var c=["opacity","lightposition","lighting"];c.forEach((function(e){u[e]=o[e]}));u.hoverinfo=l({},s.hoverinfo,{editType:"calc",flags:["x","y","z","u","v","w","norm","divergence","text","name"],dflt:"x+y+z+norm+text+name"});u.transforms=undefined;t.exports=u},{"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../plots/attributes":834,"../../plots/cartesian/axis_format_attributes":841,"../../plots/template_attributes":910,"../mesh3d/attributes":1143}],1310:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("../../components/colorscale/calc");function i(e,t){t._len=Math.min(t.u.length,t.v.length,t.w.length,t.x.length,t.y.length,t.z.length);t._u=l(t.u,t._len);t._v=l(t.v,t._len);t._w=l(t.w,t._len);t._x=l(t.x,t._len);t._y=l(t.y,t._len);t._z=l(t.z,t._len);var r=o(t);t._gridFill=r.fill;t._Xs=r.Xs;t._Ys=r.Ys;t._Zs=r.Zs;t._len=r.len;var a=0;var i,s,u;if(t.starts){i=l(t.starts.x||[]);s=l(t.starts.y||[]);u=l(t.starts.z||[]);a=Math.min(i.length,s.length,u.length)}t._startsX=i||[];t._startsY=s||[];t._startsZ=u||[];var c=0;var f=Infinity;var h;for(h=0;h<t._len;h++){var p=t._u[h];var v=t._v[h];var d=t._w[h];var m=Math.sqrt(p*p+v*v+d*d);c=Math.max(c,m);f=Math.min(f,m)}n(e,t,{vals:[f,c],containerStr:"",cLetter:"c"});for(h=0;h<a;h++){var g=i[h];r.xMax=Math.max(r.xMax,g);r.xMin=Math.min(r.xMin,g);var y=s[h];r.yMax=Math.max(r.yMax,y);r.yMin=Math.min(r.yMin,y);var x=u[h];r.zMax=Math.max(r.zMax,x);r.zMin=Math.min(r.zMin,x)}t._slen=a;t._normMax=c;t._xbnds=[r.xMin,r.xMax];t._ybnds=[r.yMin,r.yMax];t._zbnds=[r.zMin,r.zMax]}function o(e){var t=e._x;var r=e._y;var n=e._z;var i=e._len;var o,l,u;var c=-Infinity;var f=Infinity;var h=-Infinity;var p=Infinity;var v=-Infinity;var d=Infinity;var m="";var g;var y;var x;var b,_;var w,T;var k,M;if(i){b=t[0];w=r[0];k=n[0]}if(i>1){_=t[i-1];T=r[i-1];M=n[i-1]}for(o=0;o<i;o++){c=Math.max(c,t[o]);f=Math.min(f,t[o]);h=Math.max(h,r[o]);p=Math.min(p,r[o]);v=Math.max(v,n[o]);d=Math.min(d,n[o]);if(!g&&t[o]!==b){g=true;m+="x"}if(!y&&r[o]!==w){y=true;m+="y"}if(!x&&n[o]!==k){x=true;m+="z"}}if(!g)m+="x";if(!y)m+="y";if(!x)m+="z";var A=s(e._x);var S=s(e._y);var E=s(e._z);m=m.replace("x",(b>_?"-":"+")+"x");m=m.replace("y",(w>T?"-":"+")+"y");m=m.replace("z",(k>M?"-":"+")+"z");var L=function(){i=0;A=[];S=[];E=[]};if(!i||i<A.length*S.length*E.length)L();var C=function(e){return e==="x"?t:e==="y"?r:n};var I=function(e){return e==="x"?A:e==="y"?S:E};var P=function(e){return e[i-1]<e[0]?-1:1};var O=C(m[1]);var z=C(m[3]);var D=C(m[5]);var R=I(m[1]).length;var F=I(m[3]).length;var B=I(m[5]).length;var N=false;var j=function(e,t,r){return R*(F*e+t)+r};var U=P(C(m[1]));var V=P(C(m[3]));var H=P(C(m[5]));for(o=0;o<B-1;o++){for(l=0;l<F-1;l++){for(u=0;u<R-1;u++){var q=j(o,l,u);var G=j(o,l,u+1);var Y=j(o,l+1,u);var W=j(o+1,l,u);if(!(O[q]*U<O[G]*U)||!(z[q]*V<z[Y]*V)||!(D[q]*H<D[W]*H)){N=true}if(N)break}if(N)break}if(N)break}if(N){a.warn("Encountered arbitrary coordinates! Unable to input data grid.");L()}return{xMin:f,yMin:p,zMin:d,xMax:c,yMax:h,zMax:v,Xs:A,Ys:S,Zs:E,len:i,fill:m}}function s(e){return a.distinctVals(e).vals}function l(e,t){if(t===undefined)t=e.length;if(a.isTypedArray(e))return e.subarray(0,t);var r=[];for(var n=0;n<t;n++){r[n]=+e[n]}return r}t.exports={calc:i,filter:l,processGrid:o}},{"../../components/colorscale/calc":658,"../../lib":787}],1311:[function(e,t,r){"use strict";var a=e("gl-streamtube3d");var n=a.createTubeMesh;var i=e("../../lib");var o=e("../../lib/gl_format_color").parseColorScale;var s=e("../../components/colorscale").extractOpts;var l=e("../../plots/gl3d/zip3");var u={xaxis:0,yaxis:1,zaxis:2};function c(e,t){this.scene=e;this.uid=t;this.mesh=null;this.data=null}var f=c.prototype;f.handlePick=function(e){var t=this.scene.fullSceneLayout;var r=this.scene.dataScale;function a(e,a){var n=t[a];var i=r[u[a]];return n.l2c(e)/i}if(e.object===this.mesh){var n=e.data.position;var i=e.data.velocity;e.traceCoordinate=[a(n[0],"xaxis"),a(n[1],"yaxis"),a(n[2],"zaxis"),a(i[0],"xaxis"),a(i[1],"yaxis"),a(i[2],"zaxis"),e.data.intensity*this.data._normMax,e.data.divergence];e.textLabel=this.data.hovertext||this.data.text;return true}};function h(e){var t=e.length;var r;if(t>2){r=e.slice(1,t-1)}else if(t===2){r=[(e[0]+e[1])/2]}else{r=e}return r}function p(e){var t=e.length;if(t===1){return[.5,.5]}else{return[e[1]-e[0],e[t-1]-e[t-2]]}}function v(e,t){var r=e.fullSceneLayout;var n=e.dataScale;var c=t._len;var f={};function v(e,t){var a=r[t];var o=n[u[t]];return i.simpleMap(e,(function(e){return a.d2l(e)*o}))}f.vectors=l(v(t._u,"xaxis"),v(t._v,"yaxis"),v(t._w,"zaxis"),c);if(!c){return{positions:[],cells:[]}}var d=v(t._Xs,"xaxis");var m=v(t._Ys,"yaxis");var g=v(t._Zs,"zaxis");f.meshgrid=[d,m,g];f.gridFill=t._gridFill;var y=t._slen;if(y){f.startingPositions=l(v(t._startsX,"xaxis"),v(t._startsY,"yaxis"),v(t._startsZ,"zaxis"))}else{var x=m[0];var b=h(d);var _=h(g);var w=new Array(b.length*_.length);var T=0;for(var k=0;k<b.length;k++){for(var M=0;M<_.length;M++){w[T++]=[b[k],x,_[M]]}}f.startingPositions=w}f.colormap=o(t);f.tubeSize=t.sizeref;f.maxLength=t.maxdisplayed;var A=v(t._xbnds,"xaxis");var S=v(t._ybnds,"yaxis");var E=v(t._zbnds,"zaxis");var L=p(d);var C=p(m);var I=p(g);var P=[[A[0]-L[0],S[0]-C[0],E[0]-I[0]],[A[1]+L[1],S[1]+C[1],E[1]+I[1]]];var O=a(f,P);var z=s(t);O.vertexIntensityBounds=[z.min/t._normMax,z.max/t._normMax];var D=t.lightposition;O.lightPosition=[D.x,D.y,D.z];O.ambient=t.lighting.ambient;O.diffuse=t.lighting.diffuse;O.specular=t.lighting.specular;O.roughness=t.lighting.roughness;O.fresnel=t.lighting.fresnel;O.opacity=t.opacity;t._pad=O.tubeScale*t.sizeref*2;return O}f.update=function(e){this.data=e;var t=v(this.scene,e);this.mesh.update(t)};f.dispose=function(){this.scene.glplot.remove(this.mesh);this.mesh.dispose()};function d(e,t){var r=e.glplot.gl;var a=v(e,t);var i=n(r,a);var o=new c(e,t.uid);o.mesh=i;o.data=t;i._trace=o;e.glplot.add(i);return o}t.exports=d},{"../../components/colorscale":662,"../../lib":787,"../../lib/gl_format_color":783,"../../plots/gl3d/zip3":891,"gl-streamtube3d":344}],1312:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("../../components/colorscale/defaults");var i=e("./attributes");t.exports=function e(t,r,o,s){function l(e,n){return a.coerce(t,r,i,e,n)}var u=l("u");var c=l("v");var f=l("w");var h=l("x");var p=l("y");var v=l("z");if(!u||!u.length||!c||!c.length||!f||!f.length||!h||!h.length||!p||!p.length||!v||!v.length){r.visible=false;return}l("starts.x");l("starts.y");l("starts.z");l("maxdisplayed");l("sizeref");l("lighting.ambient");l("lighting.diffuse");l("lighting.specular");l("lighting.roughness");l("lighting.fresnel");l("lightposition.x");l("lightposition.y");l("lightposition.z");n(t,r,s,l,{prefix:"",cLetter:"c"});l("text");l("hovertext");l("hovertemplate");l("uhoverformat");l("vhoverformat");l("whoverformat");l("xhoverformat");l("yhoverformat");l("zhoverformat");r._length=null}},{"../../components/colorscale/defaults":660,"../../lib":787,"./attributes":1309}],1313:[function(e,t,r){"use strict";t.exports={moduleType:"trace",name:"streamtube",basePlotModule:e("../../plots/gl3d"),categories:["gl3d","showLegend"],attributes:e("./attributes"),supplyDefaults:e("./defaults"),colorbar:{min:"cmin",max:"cmax"},calc:e("./calc").calc,plot:e("./convert"),eventData:function(e,t){e.tubex=e.x;e.tubey=e.y;e.tubez=e.z;e.tubeu=t.traceCoordinate[3];e.tubev=t.traceCoordinate[4];e.tubew=t.traceCoordinate[5];e.norm=t.traceCoordinate[6];e.divergence=t.traceCoordinate[7];delete e.x;delete e.y;delete e.z;return e},meta:{}}},{"../../plots/gl3d":880,"./attributes":1309,"./calc":1310,"./convert":1311,"./defaults":1312}],1314:[function(e,t,r){"use strict";var a=e("../../plots/attributes");var n=e("../../plots/template_attributes").hovertemplateAttrs;var i=e("../../plots/template_attributes").texttemplateAttrs;var o=e("../../components/colorscale/attributes");var s=e("../../plots/domain").attributes;var l=e("../pie/attributes");var u=e("./constants");var c=e("../../lib/extend").extendFlat;t.exports={labels:{valType:"data_array",editType:"calc"},parents:{valType:"data_array",editType:"calc"},values:{valType:"data_array",editType:"calc"},branchvalues:{valType:"enumerated",values:["remainder","total"],dflt:"remainder",editType:"calc"},count:{valType:"flaglist",flags:["branches","leaves"],dflt:"leaves",editType:"calc"},level:{valType:"any",editType:"plot",anim:true},maxdepth:{valType:"integer",editType:"plot",dflt:-1},marker:c({colors:{valType:"data_array",editType:"calc"},line:{color:c({},l.marker.line.color,{dflt:null}),width:c({},l.marker.line.width,{dflt:1}),editType:"calc"},editType:"calc"},o("marker",{colorAttr:"colors",anim:false})),leaf:{opacity:{valType:"number",editType:"style",min:0,max:1},editType:"plot"},text:l.text,textinfo:{valType:"flaglist",flags:["label","text","value","current path","percent root","percent entry","percent parent"],extras:["none"],editType:"plot"},texttemplate:i({editType:"plot"},{keys:u.eventDataKeys.concat(["label","value"])}),hovertext:l.hovertext,hoverinfo:c({},a.hoverinfo,{flags:["label","text","value","name","current path","percent root","percent entry","percent parent"],dflt:"label+text+value+name"}),hovertemplate:n({},{keys:u.eventDataKeys}),textfont:l.textfont,insidetextorientation:l.insidetextorientation,insidetextfont:l.insidetextfont,outsidetextfont:c({},l.outsidetextfont,{}),rotation:{valType:"angle",dflt:0,editType:"plot"},sort:l.sort,root:{color:{valType:"color",editType:"calc",dflt:"rgba(0,0,0,0)"},editType:"calc"},domain:s({name:"sunburst",trace:true,editType:"calc"})}},{"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../plots/attributes":834,"../../plots/domain":866,"../../plots/template_attributes":910,"../pie/attributes":1176,"./constants":1317}],1315:[function(e,t,r){"use strict";var a=e("../../plots/plots");r.name="sunburst";r.plot=function(e,t,n,i){a.plotBasePlot(r.name,e,t,n,i)};r.clean=function(e,t,n,i){a.cleanBasePlot(r.name,e,t,n,i)}},{"../../plots/plots":901}],1316:[function(e,t,r){"use strict";var a=e("d3-hierarchy");var n=e("fast-isnumeric");var i=e("../../lib");var o=e("../../components/colorscale").makeColorScaleFuncFromTrace;var s=e("../pie/calc").makePullColorFn;var l=e("../pie/calc").generateExtendedColors;var u=e("../../components/colorscale").calc;var c=e("../../constants/numerical").ALMOST_EQUAL;var f={};var h={};var p={};r.calc=function(e,t){var r=e._fullLayout;var l=t.ids;var f=i.isArrayOrTypedArray(l);var h=t.labels;var p=t.parents;var d=t.values;var m=i.isArrayOrTypedArray(d);var g=[];var y={};var x={};var b=function(e,t){if(y[e])y[e].push(t);else y[e]=[t];x[t]=1};var _=function(e){return e||typeof e==="number"};var w=function(e){return!m||n(d[e])&&d[e]>=0};var T;var k;var M;if(f){T=Math.min(l.length,p.length);k=function(e){return _(l[e])&&w(e)};M=function(e){return String(l[e])}}else{T=Math.min(h.length,p.length);k=function(e){return _(h[e])&&w(e)};M=function(e){return String(h[e])}}if(m)T=Math.min(T,d.length);for(var A=0;A<T;A++){if(k(A)){var S=M(A);var E=_(p[A])?String(p[A]):"";var L={i:A,id:S,pid:E,label:_(h[A])?String(h[A]):""};if(m)L.v=+d[A];g.push(L);b(E,S)}}if(!y[""]){var C=[];var I;for(I in y){if(!x[I]){C.push(I)}}if(C.length===1){I=C[0];g.unshift({hasImpliedRoot:true,id:I,pid:"",label:I})}else{return i.warn(["Multiple implied roots, cannot build",t.type,"hierarchy of",t.name+".","These roots include:",C.join(", ")].join(" "))}}else if(y[""].length>1){var P=i.randstr();for(var O=0;O<g.length;O++){if(g[O].pid===""){g[O].pid=P}}g.unshift({hasMultipleRoots:true,id:P,pid:"",label:""})}var z;try{z=a.stratify().id((function(e){return e.id})).parentId((function(e){return e.pid}))(g)}catch(U){return i.warn(["Failed to build",t.type,"hierarchy of",t.name+".","Error:",U.message].join(" "))}var D=a.hierarchy(z);var R=false;if(m){switch(t.branchvalues){case"remainder":D.sum((function(e){return e.data.v}));break;case"total":D.each((function(e){var r=e.data.data;var a=r.v;if(e.children){var n=e.children.reduce((function(e,t){return e+t.data.data.v}),0);if(r.hasImpliedRoot||r.hasMultipleRoots){a=n}if(a<n*c){R=true;return i.warn(["Total value for node",e.data.data.id,"of",t.name,"is smaller than the sum of its children.","\nparent value =",a,"\nchildren sum =",n].join(" "))}}e.value=a}));break}}else{v(D,t,{branches:t.count.indexOf("branches")!==-1,leaves:t.count.indexOf("leaves")!==-1})}if(R)return;if(t.sort){D.sort((function(e,t){return t.value-e.value}))}var F;var B;var N=t.marker.colors||[];var j=!!N.length;if(t._hasColorscale){if(!j){N=m?t.values:t._values}u(e,t,{vals:N,containerStr:"marker",cLetter:"c"});B=o(t.marker)}else{F=s(r["_"+t.type+"colormap"])}D.each((function(e){var r=e.data.data;r.color=t._hasColorscale?B(N[r.i]):F(N[r.i],r.id)}));g[0].hierarchy=D;return g};r._runCrossTraceCalc=function(e,t){var r=t._fullLayout;var a=t.calcdata;var n=r[e+"colorway"];var i=r["_"+e+"colormap"];if(r["extend"+e+"colors"]){n=l(n,e==="icicle"?p:e==="treemap"?h:f)}var o=0;var s;function u(e){var t=e.data.data;var r=t.id;if(t.color===false){if(i[r]){t.color=i[r]}else if(e.parent){if(e.parent.parent){t.color=e.parent.data.data.color}else{i[r]=t.color=n[o%n.length];o++}}else{t.color=s}}}for(var c=0;c<a.length;c++){var v=a[c];var d=v[0];if(d.trace.type===e&&d.hierarchy){s=d.trace.root.color;d.hierarchy.each(u)}}};r.crossTraceCalc=function(e){return r._runCrossTraceCalc("sunburst",e)};function v(e,t,r){var a=0;var n=e.children;if(n){var i=n.length;for(var o=0;o<i;o++){a+=v(n[o],t,r)}if(r.branches)a++}else{if(r.leaves)a++}e.value=e.data.data.value=a;if(!t._values)t._values=[];t._values[e.data.data.i]=a;return a}},{"../../components/colorscale":662,"../../constants/numerical":763,"../../lib":787,"../pie/calc":1178,"d3-hierarchy":167,"fast-isnumeric":246}],1317:[function(e,t,r){"use strict";t.exports={CLICK_TRANSITION_TIME:750,CLICK_TRANSITION_EASING:"linear",eventDataKeys:["currentPath","root","entry","percentRoot","percentEntry","percentParent"]}},{}],1318:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("./attributes");var i=e("../../plots/domain").defaults;var o=e("../bar/defaults").handleText;var s=e("../../components/colorscale");var l=s.hasColorscale;var u=s.handleDefaults;t.exports=function e(t,r,s,c){function f(e,i){return a.coerce(t,r,n,e,i)}var h=f("labels");var p=f("parents");if(!h||!h.length||!p||!p.length){r.visible=false;return}var v=f("values");if(v&&v.length){f("branchvalues")}else{f("count")}f("level");f("maxdepth");var d=f("marker.line.width");if(d)f("marker.line.color",c.paper_bgcolor);f("marker.colors");var m=r._hasColorscale=l(t,"marker","colors")||(t.marker||{}).coloraxis;if(m){u(t,r,c,f,{prefix:"marker.",cLetter:"c"})}f("leaf.opacity",m?1:.7);var g=f("text");f("texttemplate");if(!r.texttemplate)f("textinfo",Array.isArray(g)?"text+label":"label");f("hovertext");f("hovertemplate");var y="auto";o(t,r,c,f,y,{moduleHasSelected:false,moduleHasUnselected:false,moduleHasConstrain:false,moduleHasCliponaxis:false,moduleHasTextangle:false,moduleHasInsideanchor:false});f("insidetextorientation");f("sort");f("rotation");f("root.color");i(r,c,f);r._length=null}},{"../../components/colorscale":662,"../../lib":787,"../../plots/domain":866,"../bar/defaults":929,"./attributes":1314}],1319:[function(e,t,r){"use strict";var a=e("@plotly/d3");var n=e("../../registry");var i=e("../../components/fx/helpers").appendArrayPointValue;var o=e("../../components/fx");var s=e("../../lib");var l=e("../../lib/events");var u=e("./helpers");var c=e("../pie/helpers");var f=c.formatPieValue;t.exports=function e(t,r,i,c,p){var v=c[0];var d=v.trace;var m=v.hierarchy;var g=d.type==="sunburst";var y=d.type==="treemap"||d.type==="icicle";if(!("_hasHoverLabel"in d))d._hasHoverLabel=false;if(!("_hasHoverEvent"in d))d._hasHoverEvent=false;var x=function(e){var n=i._fullLayout;if(i._dragging||n.hovermode===false)return;var l=i._fullData[d.index];var c=e.data.data;var x=c.i;var b=u.isHierarchyRoot(e);var _=u.getParent(m,e);var w=u.getValue(e);var T=function(e){return s.castOption(l,x,e)};var k=T("hovertemplate");var M=o.castHoverinfo(l,n,x);var A=n.separators;var S;if(k||M&&M!=="none"&&M!=="skip"){var E;var L;if(g){E=v.cx+e.pxmid[0]*(1-e.rInscribed);L=v.cy+e.pxmid[1]*(1-e.rInscribed)}if(y){E=e._hoverX;L=e._hoverY}var C={};var I=[];var P=[];var O=function(e){return I.indexOf(e)!==-1};if(M){I=M==="all"?l._module.attributes.hoverinfo.flags:M.split("+")}C.label=c.label;if(O("label")&&C.label)P.push(C.label);if(c.hasOwnProperty("v")){C.value=c.v;C.valueLabel=f(C.value,A);if(O("value"))P.push(C.valueLabel)}C.currentPath=e.currentPath=u.getPath(e.data);if(O("current path")&&!b){P.push(C.currentPath)}var z;var D=[];var R=function(){if(D.indexOf(z)===-1){P.push(z);D.push(z)}};C.percentParent=e.percentParent=w/u.getValue(_);C.parent=e.parentString=u.getPtLabel(_);if(O("percent parent")){z=u.formatPercent(C.percentParent,A)+" of "+C.parent;R()}C.percentEntry=e.percentEntry=w/u.getValue(r);C.entry=e.entry=u.getPtLabel(r);if(O("percent entry")&&!b&&!e.onPathbar){z=u.formatPercent(C.percentEntry,A)+" of "+C.entry;R()}C.percentRoot=e.percentRoot=w/u.getValue(m);C.root=e.root=u.getPtLabel(m);if(O("percent root")&&!b){z=u.formatPercent(C.percentRoot,A)+" of "+C.root;R()}C.text=T("hovertext")||T("text");if(O("text")){z=C.text;if(s.isValidTextValue(z))P.push(z)}S=[h(e,l,p.eventDataKeys)];var F={trace:l,y:L,_x0:e._x0,_x1:e._x1,_y0:e._y0,_y1:e._y1,text:P.join("<br>"),name:k||O("name")?l.name:undefined,color:T("hoverlabel.bgcolor")||c.color,borderColor:T("hoverlabel.bordercolor"),fontFamily:T("hoverlabel.font.family"),fontSize:T("hoverlabel.font.size"),fontColor:T("hoverlabel.font.color"),nameLength:T("hoverlabel.namelength"),textAlign:T("hoverlabel.align"),hovertemplate:k,hovertemplateLabels:C,eventData:S};if(g){F.x0=E-e.rInscribed*e.rpx1;F.x1=E+e.rInscribed*e.rpx1;F.idealAlign=e.pxmid[0]<0?"left":"right"}if(y){F.x=E;F.idealAlign=E<0?"left":"right"}var B=[];o.loneHover(F,{container:n._hoverlayer.node(),outerContainer:n._paper.node(),gd:i,inOut_bbox:B});S[0].bbox=B[0];d._hasHoverLabel=true}if(y){var N=t.select("path.surface");p.styleOne(N,e,l,{hovered:true})}d._hasHoverEvent=true;i.emit("plotly_hover",{points:S||[h(e,l,p.eventDataKeys)],event:a.event})};var b=function(e){var r=i._fullLayout;var n=i._fullData[d.index];var s=a.select(this).datum();if(d._hasHoverEvent){e.originalEvent=a.event;i.emit("plotly_unhover",{points:[h(s,n,p.eventDataKeys)],event:a.event});d._hasHoverEvent=false}if(d._hasHoverLabel){o.loneUnhover(r._hoverlayer.node());d._hasHoverLabel=false}if(y){var l=t.select("path.surface");p.styleOne(l,s,n,{hovered:false})}};var _=function(e){var t=i._fullLayout;var r=i._fullData[d.index];var s=g&&(u.isHierarchyRoot(e)||u.isLeaf(e));var c=u.getPtId(e);var f=u.isEntry(e)?u.findEntryWithChild(m,c):u.findEntryWithLevel(m,c);var v=u.getPtId(f);var y={points:[h(e,r,p.eventDataKeys)],event:a.event};if(!s)y.nextLevel=v;var x=l.triggerHandler(i,"plotly_"+d.type+"click",y);if(x!==false&&t.hovermode){i._hoverdata=[h(e,r,p.eventDataKeys)];o.click(i,a.event)}if(s)return;if(x===false)return;if(i._dragging)return;if(i._transitioning)return;n.call("_storeDirectGUIEdit",r,t._tracePreGUI[r.uid],{level:r.level});var b={data:[{level:v}],traces:[d.index]};var _={frame:{redraw:false,duration:p.transitionTime},transition:{duration:p.transitionTime,easing:p.transitionEasing},mode:"immediate",fromcurrent:true};o.loneUnhover(t._hoverlayer.node());n.call("animate",i,b,_)};t.on("mouseover",x);t.on("mouseout",b);t.on("click",_)};function h(e,t,r){var a=e.data.data;var n={curveNumber:t.index,pointNumber:a.i,data:t._input,fullData:t};for(var o=0;o<r.length;o++){var s=r[o];if(s in e)n[s]=e[s]}if("parentString"in e&&!u.isHierarchyRoot(e))n.parent=e.parentString;i(n,t,a.i);return n}},{"../../components/fx":690,"../../components/fx/helpers":686,"../../lib":787,"../../lib/events":776,"../../registry":915,"../pie/helpers":1181,"./helpers":1320,"@plotly/d3":58}],1320:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("../../components/color");var i=e("../../lib/setcursor");var o=e("../pie/helpers");r.findEntryWithLevel=function(e,t){var a;if(t){e.eachAfter((function(e){if(r.getPtId(e)===t){return a=e.copy()}}))}return a||e};r.findEntryWithChild=function(e,t){var a;e.eachAfter((function(e){var n=e.children||[];for(var i=0;i<n.length;i++){var o=n[i];if(r.getPtId(o)===t){return a=e.copy()}}}));return a||e};r.isEntry=function(e){return!e.parent};r.isLeaf=function(e){return!e.children};r.getPtId=function(e){return e.data.data.id};r.getPtLabel=function(e){return e.data.data.label};r.getValue=function(e){return e.value};r.isHierarchyRoot=function(e){return u(e)===""};r.setSliceCursor=function(e,t,a){var n=a.isTransitioning;if(!n){var o=e.datum();n=a.hideOnRoot&&r.isHierarchyRoot(o)||a.hideOnLeaves&&r.isLeaf(o)}i(e,n?null:"pointer")};function s(e,t,a){return{color:r.getOutsideTextFontKey("color",e,t,a),family:r.getOutsideTextFontKey("family",e,t,a),size:r.getOutsideTextFontKey("size",e,t,a)}}function l(e,t,i,o){var s=(o||{}).onPathbar;var l=t.data.data;var u=l.i;var c=a.castOption(e,u,(s?"pathbar.textfont":"insidetextfont")+".color");if(!c&&e._input.textfont){c=a.castOption(e._input,u,"textfont.color")}return{color:c||n.contrast(l.color),family:r.getInsideTextFontKey("family",e,t,i,o),size:r.getInsideTextFontKey("size",e,t,i,o)}}r.getInsideTextFontKey=function(e,t,r,n,i){var o=(i||{}).onPathbar;var s=o?"pathbar.textfont":"insidetextfont";var l=r.data.data.i;return a.castOption(t,l,s+"."+e)||a.castOption(t,l,"textfont."+e)||n.size};r.getOutsideTextFontKey=function(e,t,r,n){var i=r.data.data.i;return a.castOption(t,i,"outsidetextfont."+e)||a.castOption(t,i,"textfont."+e)||n.size};r.isOutsideText=function(e,t){return!e._hasColorscale&&r.isHierarchyRoot(t)};r.determineTextFont=function(e,t,a,n){return r.isOutsideText(e,t)?s(e,t,a):l(e,t,a,n)};r.hasTransition=function(e){return!!(e&&e.duration>0)};r.getMaxDepth=function(e){return e.maxdepth>=0?e.maxdepth:Infinity};r.isHeader=function(e,t){return!(r.isLeaf(e)||e.depth===t._maxDepth-1)};function u(e){return e.data.data.pid}r.getParent=function(e,t){return r.findEntryWithLevel(e,u(t))};r.listPath=function(e,t){var a=e.parent;if(!a)return[];var n=t?[a.data[t]]:[a];return r.listPath(a,t).concat(n)};r.getPath=function(e){return r.listPath(e,"label").join("/")+"/"};r.formatValue=o.formatPieValue;r.formatPercent=function(e,t){var r=a.formatPercent(e,0);if(r==="0%")r=o.formatPiePercent(e,t);return r}},{"../../components/color":650,"../../lib":787,"../../lib/setcursor":808,"../pie/helpers":1181}],1321:[function(e,t,r){"use strict";t.exports={moduleType:"trace",name:"sunburst",basePlotModule:e("./base_plot"),categories:[],animatable:true,attributes:e("./attributes"),layoutAttributes:e("./layout_attributes"),supplyDefaults:e("./defaults"),supplyLayoutDefaults:e("./layout_defaults"),calc:e("./calc").calc,crossTraceCalc:e("./calc").crossTraceCalc,plot:e("./plot").plot,style:e("./style").style,colorbar:e("../scatter/marker_colorbar"),meta:{}}},{"../scatter/marker_colorbar":1220,"./attributes":1314,"./base_plot":1315,"./calc":1316,"./defaults":1318,"./layout_attributes":1322,"./layout_defaults":1323,"./plot":1324,"./style":1325}],1322:[function(e,t,r){"use strict";t.exports={sunburstcolorway:{valType:"colorlist",editType:"calc"},extendsunburstcolors:{valType:"boolean",dflt:true,editType:"calc"}}},{}],1323:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("./layout_attributes");t.exports=function e(t,r){function i(e,i){return a.coerce(t,r,n,e,i)}i("sunburstcolorway",r.colorway);i("extendsunburstcolors")}},{"../../lib":787,"./layout_attributes":1322}],1324:[function(e,t,r){"use strict";var a=e("@plotly/d3");var n=e("d3-hierarchy");var i=e("d3-interpolate").interpolate;var o=e("../../components/drawing");var s=e("../../lib");var l=e("../../lib/svg_text_utils");var u=e("../bar/uniform_text");var c=u.recordMinTextSize;var f=u.clearMinTextSize;var h=e("../pie/plot");var p=e("../pie/helpers").getRotationAngle;var v=h.computeTransform;var d=h.transformInsideText;var m=e("./style").styleOne;var g=e("../bar/style").resizeText;var y=e("./fx");var x=e("./constants");var b=e("./helpers");r.plot=function(e,t,r,n){var i=e._fullLayout;var o=i._sunburstlayer;var s,l;var u=!r;var c=!i.uniformtext.mode&&b.hasTransition(r);f("sunburst",i);s=o.selectAll("g.trace.sunburst").data(t,(function(e){return e[0].trace.uid}));s.enter().append("g").classed("trace",true).classed("sunburst",true).attr("stroke-linejoin","round");s.order();if(c){if(n){l=n()}var h=a.transition().duration(r.duration).ease(r.easing).each("end",(function(){l&&l()})).each("interrupt",(function(){l&&l()}));h.each((function(){o.selectAll("g.trace").each((function(t){_(e,t,this,r)}))}))}else{s.each((function(t){_(e,t,this,r)}));if(i.uniformtext.mode){g(e,i._sunburstlayer.selectAll(".trace"),"sunburst")}}if(u){s.exit().remove()}};function _(e,t,n,u){var f=e._fullLayout;var h=!f.uniformtext.mode&&b.hasTransition(u);var g=a.select(n);var _=g.selectAll("g.slice");var M=t[0];var A=M.trace;var S=M.hierarchy;var E=b.findEntryWithLevel(S,A.level);var L=b.getMaxDepth(A);var C=f._size;var I=A.domain;var P=C.w*(I.x[1]-I.x[0]);var O=C.h*(I.y[1]-I.y[0]);var z=.5*Math.min(P,O);var D=M.cx=C.l+C.w*(I.x[1]+I.x[0])/2;var R=M.cy=C.t+C.h*(1-I.y[0])-O/2;if(!E){return _.remove()}var F=null;var B={};if(h){_.each((function(e){B[b.getPtId(e)]={rpx0:e.rpx0,rpx1:e.rpx1,x0:e.x0,x1:e.x1,transform:e.transform};if(!F&&b.isEntry(e)){F=e}}))}var N=w(E).descendants();var j=E.height+1;var U=0;var V=L;if(M.hasMultipleRoots&&b.isHierarchyRoot(E)){N=N.slice(1);j-=1;U=1;V+=1}N=N.filter((function(e){return e.y1<=V}));var H=p(A.rotation);if(H){N.forEach((function(e){e.x0+=H;e.x1+=H}))}var q=Math.min(j,L);var G=function(e){return(e-U)/q*z};var Y=function(e,t){return[e*Math.cos(t),-e*Math.sin(t)]};var W=function(e){return s.pathAnnulus(e.rpx0,e.rpx1,e.x0,e.x1,D,R)};var X=function(e){return D+k(e)[0]*(e.transform.rCenter||0)+(e.transform.x||0)};var Z=function(e){return R+k(e)[1]*(e.transform.rCenter||0)+(e.transform.y||0)};_=_.data(N,b.getPtId);_.enter().append("g").classed("slice",true);if(h){_.exit().transition().each((function(){var e=a.select(this);var t=e.select("path.surface");t.transition().attrTween("d",(function(e){var t=$(e);return function(e){return W(t(e))}}));var r=e.select("g.slicetext");r.attr("opacity",0)})).remove()}else{_.exit().remove()}_.order();var J=null;if(h&&F){var K=b.getPtId(F);_.each((function(e){if(J===null&&b.getPtId(e)===K){J=e.x1}}))}var Q=_;if(h){Q=Q.transition().each("end",(function(){var t=a.select(this);b.setSliceCursor(t,e,{hideOnRoot:true,hideOnLeaves:true,isTransitioning:false})}))}Q.each((function(n){var i=a.select(this);var u=s.ensureSingle(i,"path","surface",(function(e){e.style("pointer-events","all")}));n.rpx0=G(n.y0);n.rpx1=G(n.y1);n.xmid=(n.x0+n.x1)/2;n.pxmid=Y(n.rpx1,n.xmid);n.midangle=-(n.xmid-Math.PI/2);n.startangle=-(n.x0-Math.PI/2);n.stopangle=-(n.x1-Math.PI/2);n.halfangle=.5*Math.min(s.angleDelta(n.x0,n.x1)||Math.PI,Math.PI);n.ring=1-n.rpx0/n.rpx1;n.rInscribed=T(n,A);if(h){u.transition().attrTween("d",(function(e){var t=ee(e);return function(e){return W(t(e))}}))}else{u.attr("d",W)}i.call(y,E,e,t,{eventDataKeys:x.eventDataKeys,transitionTime:x.CLICK_TRANSITION_TIME,transitionEasing:x.CLICK_TRANSITION_EASING}).call(b.setSliceCursor,e,{hideOnRoot:true,hideOnLeaves:true,isTransitioning:e._transitioning});u.call(m,n,A);var p=s.ensureSingle(i,"g","slicetext");var g=s.ensureSingle(p,"text","",(function(e){e.attr("data-notex",1)}));var _=s.ensureUniformFontSize(e,b.determineTextFont(A,n,f.font));g.text(r.formatSliceLabel(n,E,A,t,f)).classed("slicetext",true).attr("text-anchor","middle").call(o.font,_).call(l.convertToTspans,e);var w=o.bBox(g.node());n.transform=d(w,n,M);n.transform.targetX=X(n);n.transform.targetY=Z(n);var k=function(e,t){var r=e.transform;v(r,t);r.fontSize=_.size;c(A.type,r,f);return s.getTextTransform(r)};if(h){g.transition().attrTween("transform",(function(e){var t=te(e);return function(e){return k(t(e),w)}}))}else{g.attr("transform",k(n,w))}}));function $(e){var t=b.getPtId(e);var r=B[t];var a=B[b.getPtId(E)];var n;if(a){var o=(e.x1>a.x1?2*Math.PI:0)+H;n=e.rpx1<a.rpx1?{x0:e.x0,x1:e.x1,rpx0:0,rpx1:0}:{x0:o,x1:o,rpx0:e.rpx0,rpx1:e.rpx1}}else{var s;var l=b.getPtId(e.parent);_.each((function(e){if(b.getPtId(e)===l){return s=e}}));var u=s.children;var c;u.forEach((function(e,r){if(b.getPtId(e)===t){return c=r}}));var f=u.length;var h=i(s.x0,s.x1);n={rpx0:z,rpx1:z,x0:h(c/f),x1:h((c+1)/f)}}return i(r,n)}function ee(e){var t=B[b.getPtId(e)];var r;var a={x0:e.x0,x1:e.x1,rpx0:e.rpx0,rpx1:e.rpx1};if(t){r=t}else{if(F){if(e.parent){if(J){var n=(e.x1>J?2*Math.PI:0)+H;r={x0:n,x1:n}}else{r={rpx0:z,rpx1:z};s.extendFlat(r,re(e))}}else{r={rpx0:0,rpx1:0}}}else{r={x0:H,x1:H}}}return i(r,a)}function te(e){var t=B[b.getPtId(e)];var r;var a=e.transform;if(t){r=t}else{r={rpx1:e.rpx1,transform:{textPosAngle:a.textPosAngle,scale:0,rotate:a.rotate,rCenter:a.rCenter,x:a.x,y:a.y}};if(F){if(e.parent){if(J){var n=e.x1>J?2*Math.PI:0;r.x0=r.x1=n}else{s.extendFlat(r,re(e))}}else{r.x0=r.x1=H}}else{r.x0=r.x1=H}}var o=i(r.transform.textPosAngle,e.transform.textPosAngle);var l=i(r.rpx1,e.rpx1);var u=i(r.x0,e.x0);var h=i(r.x1,e.x1);var p=i(r.transform.scale,a.scale);var v=i(r.transform.rotate,a.rotate);var d=a.rCenter===0?3:r.transform.rCenter===0?1/3:1;var m=i(r.transform.rCenter,a.rCenter);var g=function(e){return m(Math.pow(e,d))};return function(e){var t=l(e);var r=u(e);var n=h(e);var i=g(e);var s=Y(t,(r+n)/2);var d=o(e);var m={pxmid:s,rpx1:t,transform:{textPosAngle:d,rCenter:i,x:a.x,y:a.y}};c(A.type,a,f);return{transform:{targetX:X(m),targetY:Z(m),scale:p(e),rotate:v(e),rCenter:i}}}}function re(e){var t=e.parent;var r=B[b.getPtId(t)];var a={};if(r){var n=t.children;var o=n.indexOf(e);var s=n.length;var l=i(r.x0,r.x1);a.x0=l(o/s);a.x1=l(o/s)}else{a.x0=a.x1=0}return a}}function w(e){return n.partition().size([2*Math.PI,e.height+1])(e)}r.formatSliceLabel=function(e,t,r,a,n){var i=r.texttemplate;var o=r.textinfo;if(!i&&(!o||o==="none")){return""}var l=n.separators;var u=a[0];var c=e.data.data;var f=u.hierarchy;var h=b.isHierarchyRoot(e);var p=b.getParent(f,e);var v=b.getValue(e);if(!i){var d=o.split("+");var m=function(e){return d.indexOf(e)!==-1};var g=[];var y;if(m("label")&&c.label){g.push(c.label)}if(c.hasOwnProperty("v")&&m("value")){g.push(b.formatValue(c.v,l))}if(!h){if(m("current path")){g.push(b.getPath(e.data))}var x=0;if(m("percent parent"))x++;if(m("percent entry"))x++;if(m("percent root"))x++;var _=x>1;if(x){var w;var T=function(e){y=b.formatPercent(w,l);if(_)y+=" of "+e;g.push(y)};if(m("percent parent")&&!h){w=v/b.getValue(p);T("parent")}if(m("percent entry")){w=v/b.getValue(t);T("entry")}if(m("percent root")){w=v/b.getValue(f);T("root")}}}if(m("text")){y=s.castOption(r,c.i,"text");if(s.isValidTextValue(y))g.push(y)}return g.join("<br>")}var k=s.castOption(r,c.i,"texttemplate");if(!k)return"";var M={};if(c.label)M.label=c.label;if(c.hasOwnProperty("v")){M.value=c.v;M.valueLabel=b.formatValue(c.v,l)}M.currentPath=b.getPath(e.data);if(!h){M.percentParent=v/b.getValue(p);M.percentParentLabel=b.formatPercent(M.percentParent,l);M.parent=b.getPtLabel(p)}M.percentEntry=v/b.getValue(t);M.percentEntryLabel=b.formatPercent(M.percentEntry,l);M.entry=b.getPtLabel(t);M.percentRoot=v/b.getValue(f);M.percentRootLabel=b.formatPercent(M.percentRoot,l);M.root=b.getPtLabel(f);if(c.hasOwnProperty("color")){M.color=c.color}var A=s.castOption(r,c.i,"text");if(s.isValidTextValue(A)||A==="")M.text=A;M.customdata=s.castOption(r,c.i,"customdata");return s.texttemplateString(k,M,n._d3locale,M,r._meta||{})};function T(e){if(e.rpx0===0&&s.isFullCircle([e.x0,e.x1])){return 1}else{return Math.max(0,Math.min(1/(1+1/Math.sin(e.halfangle)),e.ring/2))}}function k(e){return M(e.rpx1,e.transform.textPosAngle)}function M(e,t){return[e*Math.sin(t),-e*Math.cos(t)]}},{"../../components/drawing":672,"../../lib":787,"../../lib/svg_text_utils":813,"../bar/style":939,"../bar/uniform_text":941,"../pie/helpers":1181,"../pie/plot":1185,"./constants":1317,"./fx":1319,"./helpers":1320,"./style":1325,"@plotly/d3":58,"d3-hierarchy":167,"d3-interpolate":168}],1325:[function(e,t,r){"use strict";var a=e("@plotly/d3");var n=e("../../components/color");var i=e("../../lib");var o=e("../bar/uniform_text").resizeText;function s(e){var t=e._fullLayout._sunburstlayer.selectAll(".trace");o(e,t,"sunburst");t.each((function(e){var t=a.select(this);var r=e[0];var n=r.trace;t.style("opacity",n.opacity);t.selectAll("path.surface").each((function(e){a.select(this).call(l,e,n)}))}))}function l(e,t,r){var a=t.data.data;var o=!t.children;var s=a.i;var l=i.castOption(r,s,"marker.line.color")||n.defaultLine;var u=i.castOption(r,s,"marker.line.width")||0;e.style("stroke-width",u).call(n.fill,a.color).call(n.stroke,l).style("opacity",o?r.leaf.opacity:null)}t.exports={style:s,styleOne:l}},{"../../components/color":650,"../../lib":787,"../bar/uniform_text":941,"@plotly/d3":58}],1326:[function(e,t,r){"use strict";var a=e("../../components/color");var n=e("../../components/colorscale/attributes");var i=e("../../plots/cartesian/axis_format_attributes").axisHoverFormat;var o=e("../../plots/template_attributes").hovertemplateAttrs;var s=e("../../plots/attributes");var l=e("../../lib/extend").extendFlat;var u=e("../../plot_api/edit_types").overrideAll;function c(e){return{valType:"boolean",dflt:false}}function f(e){return{show:{valType:"boolean",dflt:false},start:{valType:"number",dflt:null,editType:"plot"},end:{valType:"number",dflt:null,editType:"plot"},size:{valType:"number",dflt:null,min:0,editType:"plot"},project:{x:c("x"),y:c("y"),z:c("z")},color:{valType:"color",dflt:a.defaultLine},usecolormap:{valType:"boolean",dflt:false},width:{valType:"number",min:1,max:16,dflt:2},highlight:{valType:"boolean",dflt:true},highlightcolor:{valType:"color",dflt:a.defaultLine},highlightwidth:{valType:"number",min:1,max:16,dflt:2}}}var h=t.exports=u(l({z:{valType:"data_array"},x:{valType:"data_array"},y:{valType:"data_array"},text:{valType:"string",dflt:"",arrayOk:true},hovertext:{valType:"string",dflt:"",arrayOk:true},hovertemplate:o(),xhoverformat:i("x"),yhoverformat:i("y"),zhoverformat:i("z"),connectgaps:{valType:"boolean",dflt:false,editType:"calc"},surfacecolor:{valType:"data_array"}},n("",{colorAttr:"z or surfacecolor",showScaleDflt:true,autoColorDflt:false,editTypeOverride:"calc"}),{contours:{x:f("x"),y:f("y"),z:f("z")},hidesurface:{valType:"boolean",dflt:false},lightposition:{x:{valType:"number",min:-1e5,max:1e5,dflt:10},y:{valType:"number",min:-1e5,max:1e5,dflt:1e4},z:{valType:"number",min:-1e5,max:1e5,dflt:0}},lighting:{ambient:{valType:"number",min:0,max:1,dflt:.8},diffuse:{valType:"number",min:0,max:1,dflt:.8},specular:{valType:"number",min:0,max:2,dflt:.05},roughness:{valType:"number",min:0,max:1,dflt:.5},fresnel:{valType:"number",min:0,max:5,dflt:.2}},opacity:{valType:"number",min:0,max:1,dflt:1},opacityscale:{valType:"any",editType:"calc"},_deprecated:{zauto:l({},n.zauto,{}),zmin:l({},n.zmin,{}),zmax:l({},n.zmax,{})},hoverinfo:l({},s.hoverinfo),showlegend:l({},s.showlegend,{dflt:false})}),"calc","nested");h.x.editType=h.y.editType=h.z.editType="calc+clearAxisTypes";h.transforms=undefined},{"../../components/color":650,"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../plot_api/edit_types":820,"../../plots/attributes":834,"../../plots/cartesian/axis_format_attributes":841,"../../plots/template_attributes":910}],1327:[function(e,t,r){"use strict";var a=e("../../components/colorscale/calc");t.exports=function e(t,r){if(r.surfacecolor){a(t,r,{vals:r.surfacecolor,containerStr:"",cLetter:"c"})}else{a(t,r,{vals:r.z,containerStr:"",cLetter:"c"})}}},{"../../components/colorscale/calc":658}],1328:[function(e,t,r){"use strict";var a=e("gl-surface3d");var n=e("ndarray");var i=e("ndarray-linear-interpolate").d2;var o=e("../heatmap/interp2d");var s=e("../heatmap/find_empties");var l=e("../../lib").isArrayOrTypedArray;var u=e("../../lib/gl_format_color").parseColorScale;var c=e("../../lib/str2rgbarray");var f=e("../../components/colorscale").extractOpts;function h(e,t,r){this.scene=e;this.uid=r;this.surface=t;this.data=null;this.showContour=[false,false,false];this.contourStart=[null,null,null];this.contourEnd=[null,null,null];this.contourSize=[0,0,0];this.minValues=[Infinity,Infinity,Infinity];this.maxValues=[-Infinity,-Infinity,-Infinity];this.dataScaleX=1;this.dataScaleY=1;this.refineData=true;this.objectOffset=[0,0,0]}var p=h.prototype;p.getXat=function(e,t,r,a){var n=!l(this.data.x)?e:l(this.data.x[0])?this.data.x[t][e]:this.data.x[e];return r===undefined?n:a.d2l(n,0,r)};p.getYat=function(e,t,r,a){var n=!l(this.data.y)?t:l(this.data.y[0])?this.data.y[t][e]:this.data.y[t];return r===undefined?n:a.d2l(n,0,r)};p.getZat=function(e,t,r,a){var n=this.data.z[t][e];if(n===null&&this.data.connectgaps&&this.data._interpolatedZ){n=this.data._interpolatedZ[t][e]}return r===undefined?n:a.d2l(n,0,r)};p.handlePick=function(e){if(e.object===this.surface){var t=(e.data.index[0]-1)/this.dataScaleX-1;var r=(e.data.index[1]-1)/this.dataScaleY-1;var a=Math.max(Math.min(Math.round(t),this.data.z[0].length-1),0);var n=Math.max(Math.min(Math.round(r),this.data._ylength-1),0);e.index=[a,n];e.traceCoordinate=[this.getXat(a,n),this.getYat(a,n),this.getZat(a,n)];e.dataCoordinate=[this.getXat(a,n,this.data.xcalendar,this.scene.fullSceneLayout.xaxis),this.getYat(a,n,this.data.ycalendar,this.scene.fullSceneLayout.yaxis),this.getZat(a,n,this.data.zcalendar,this.scene.fullSceneLayout.zaxis)];for(var i=0;i<3;i++){var o=e.dataCoordinate[i];if(o!==null&&o!==undefined){e.dataCoordinate[i]*=this.scene.dataScale[i]}}var s=this.data.hovertext||this.data.text;if(Array.isArray(s)&&s[n]&&s[n][a]!==undefined){e.textLabel=s[n][a]}else if(s){e.textLabel=s}else{e.textLabel=""}e.data.dataCoordinate=e.dataCoordinate.slice();this.surface.highlight(e.data);this.scene.glplot.spikes.position=e.dataCoordinate;return true}};function v(e){var t=e[0].rgb;var r=e[e.length-1].rgb;return t[0]===r[0]&&t[1]===r[1]&&t[2]===r[2]&&t[3]===r[3]}var d=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997,1009,1013,1019,1021,1031,1033,1039,1049,1051,1061,1063,1069,1087,1091,1093,1097,1103,1109,1117,1123,1129,1151,1153,1163,1171,1181,1187,1193,1201,1213,1217,1223,1229,1231,1237,1249,1259,1277,1279,1283,1289,1291,1297,1301,1303,1307,1319,1321,1327,1361,1367,1373,1381,1399,1409,1423,1427,1429,1433,1439,1447,1451,1453,1459,1471,1481,1483,1487,1489,1493,1499,1511,1523,1531,1543,1549,1553,1559,1567,1571,1579,1583,1597,1601,1607,1609,1613,1619,1621,1627,1637,1657,1663,1667,1669,1693,1697,1699,1709,1721,1723,1733,1741,1747,1753,1759,1777,1783,1787,1789,1801,1811,1823,1831,1847,1861,1867,1871,1873,1877,1879,1889,1901,1907,1913,1931,1933,1949,1951,1973,1979,1987,1993,1997,1999,2003,2011,2017,2027,2029,2039,2053,2063,2069,2081,2083,2087,2089,2099,2111,2113,2129,2131,2137,2141,2143,2153,2161,2179,2203,2207,2213,2221,2237,2239,2243,2251,2267,2269,2273,2281,2287,2293,2297,2309,2311,2333,2339,2341,2347,2351,2357,2371,2377,2381,2383,2389,2393,2399,2411,2417,2423,2437,2441,2447,2459,2467,2473,2477,2503,2521,2531,2539,2543,2549,2551,2557,2579,2591,2593,2609,2617,2621,2633,2647,2657,2659,2663,2671,2677,2683,2687,2689,2693,2699,2707,2711,2713,2719,2729,2731,2741,2749,2753,2767,2777,2789,2791,2797,2801,2803,2819,2833,2837,2843,2851,2857,2861,2879,2887,2897,2903,2909,2917,2927,2939,2953,2957,2963,2969,2971,2999];function m(e,t){if(e<t)return 0;var r=0;while(Math.floor(e%t)===0){e/=t;r++}return r}function g(e){var t=[];for(var r=0;r<d.length;r++){var a=d[r];t.push(m(e,a))}return t}function y(e){var t=g(e);var r=e;for(var a=0;a<d.length;a++){if(t[a]>0){r=d[a];break}}return r}function x(e,t){if(e<1||t<1)return undefined;var r=g(e);var a=g(t);var n=1;for(var i=0;i<d.length;i++){n*=Math.pow(d[i],Math.max(r[i],a[i]))}return n}function b(e){if(e.length===0)return undefined;var t=1;for(var r=0;r<e.length;r++){t=x(t,e[r])}return t}p.calcXnums=function(e){var t;var r=[];for(t=1;t<e;t++){var a=this.getXat(t-1,0);var n=this.getXat(t,0);if(n!==a&&a!==undefined&&a!==null&&n!==undefined&&n!==null){r[t-1]=Math.abs(n-a)}else{r[t-1]=0}}var i=0;for(t=1;t<e;t++){i+=r[t-1]}for(t=1;t<e;t++){if(r[t-1]===0){r[t-1]=1}else{r[t-1]=Math.round(i/r[t-1])}}return r};p.calcYnums=function(e){var t;var r=[];for(t=1;t<e;t++){var a=this.getYat(0,t-1);var n=this.getYat(0,t);if(n!==a&&a!==undefined&&a!==null&&n!==undefined&&n!==null){r[t-1]=Math.abs(n-a)}else{r[t-1]=0}}var i=0;for(t=1;t<e;t++){i+=r[t-1]}for(t=1;t<e;t++){if(r[t-1]===0){r[t-1]=1}else{r[t-1]=Math.round(i/r[t-1])}}return r};var _=[1,2,4,6,12,24,36,48,60,120,180,240,360,720,840,1260];var w=_[9];var T=_[13];p.estimateScale=function(e,t){var r=t===0?this.calcXnums(e):this.calcYnums(e);var a=1+b(r);while(a<w){a*=2}while(a>T){a--;a/=y(a);a++;if(a<w){a=T}}var n=Math.round(a/e);return n>1?n:1};function k(e,t,r){var a=r[8]+r[2]*t[0]+r[5]*t[1];e[0]=(r[6]+r[0]*t[0]+r[3]*t[1])/a;e[1]=(r[7]+r[1]*t[0]+r[4]*t[1])/a;return e}function M(e,t,r){A(e,t,k,r);return e}function A(e,t,r,a){var n=[0,0];var o=e.shape[0];var s=e.shape[1];for(var l=0;l<o;l++){for(var u=0;u<s;u++){r(n,[l,u],a);e.set(l,u,i(t,n[0],n[1]))}}return e}p.refineCoords=function(e){var t=this.dataScaleX;var r=this.dataScaleY;var a=e[0].shape[0];var i=e[0].shape[1];var o=Math.floor(e[0].shape[0]*t+1)|0;var s=Math.floor(e[0].shape[1]*r+1)|0;var l=1+a+1;var u=1+i+1;var c=n(new Float32Array(l*u),[l,u]);var f=[1/t,0,0,0,1/r,0,0,0,1];for(var h=0;h<e.length;++h){this.surface.padField(c,e[h]);var p=n(new Float32Array(o*s),[o,s]);M(p,c,f);e[h]=p}};function S(e,t){var r=false;for(var a=0;a<e.length;a++){if(t===e[a]){r=true;break}}if(r===false)e.push(t)}p.setContourLevels=function(){var e=[[],[],[]];var t=[false,false,false];var r=false;var a,n,i;for(a=0;a<3;++a){if(this.showContour[a]){r=true;if(this.contourSize[a]>0&&this.contourStart[a]!==null&&this.contourEnd[a]!==null&&this.contourEnd[a]>this.contourStart[a]){t[a]=true;for(n=this.contourStart[a];n<this.contourEnd[a];n+=this.contourSize[a]){i=n*this.scene.dataScale[a];S(e[a],i)}}}}if(r){var o=[[],[],[]];for(a=0;a<3;++a){if(this.showContour[a]){o[a]=t[a]?e[a]:this.scene.contourLevels[a]}}this.surface.update({levels:o})}};p.update=function(e){var t=this.scene;var r=t.fullSceneLayout;var a=this.surface;var i=u(e);var l=t.dataScale;var h=e.z[0].length;var p=e._ylength;var d=t.contourLevels;this.data=e;var m,g,y,x;var b=[];for(m=0;m<3;m++){b[m]=[];for(g=0;g<h;g++){b[m][g]=[]}}for(g=0;g<h;g++){for(y=0;y<p;y++){b[0][g][y]=this.getXat(g,y,e.xcalendar,r.xaxis);b[1][g][y]=this.getYat(g,y,e.ycalendar,r.yaxis);b[2][g][y]=this.getZat(g,y,e.zcalendar,r.zaxis)}}if(e.connectgaps){e._emptypoints=s(b[2]);o(b[2],e._emptypoints);e._interpolatedZ=[];for(g=0;g<h;g++){e._interpolatedZ[g]=[];for(y=0;y<p;y++){e._interpolatedZ[g][y]=b[2][g][y]}}}for(m=0;m<3;m++){for(g=0;g<h;g++){for(y=0;y<p;y++){x=b[m][g][y];if(x===null||x===undefined){b[m][g][y]=NaN}else{x=b[m][g][y]*=l[m]}}}}for(m=0;m<3;m++){for(g=0;g<h;g++){for(y=0;y<p;y++){x=b[m][g][y];if(x!==null&&x!==undefined){if(this.minValues[m]>x){this.minValues[m]=x}if(this.maxValues[m]<x){this.maxValues[m]=x}}}}}for(m=0;m<3;m++){this.objectOffset[m]=.5*(this.minValues[m]+this.maxValues[m])}for(m=0;m<3;m++){for(g=0;g<h;g++){for(y=0;y<p;y++){x=b[m][g][y];if(x!==null&&x!==undefined){b[m][g][y]-=this.objectOffset[m]}}}}var _=[n(new Float32Array(h*p),[h,p]),n(new Float32Array(h*p),[h,p]),n(new Float32Array(h*p),[h,p])];for(m=0;m<3;m++){for(g=0;g<h;g++){for(y=0;y<p;y++){_[m].set(g,y,b[m][g][y])}}}b=[];var w={colormap:i,levels:[[],[],[]],showContour:[true,true,true],showSurface:!e.hidesurface,contourProject:[[false,false,false],[false,false,false],[false,false,false]],contourWidth:[1,1,1],contourColor:[[1,1,1,1],[1,1,1,1],[1,1,1,1]],contourTint:[1,1,1],dynamicColor:[[1,1,1,1],[1,1,1,1],[1,1,1,1]],dynamicWidth:[1,1,1],dynamicTint:[1,1,1],opacityscale:e.opacityscale,opacity:e.opacity};var k=f(e);w.intensityBounds=[k.min,k.max];if(e.surfacecolor){var M=n(new Float32Array(h*p),[h,p]);for(g=0;g<h;g++){for(y=0;y<p;y++){M.set(g,y,e.surfacecolor[y][g])}}_.push(M)}else{w.intensityBounds[0]*=l[2];w.intensityBounds[1]*=l[2]}if(T<_[0].shape[0]||T<_[0].shape[1]){this.refineData=false}if(this.refineData===true){this.dataScaleX=this.estimateScale(_[0].shape[0],0);this.dataScaleY=this.estimateScale(_[0].shape[1],1);if(this.dataScaleX!==1||this.dataScaleY!==1){this.refineCoords(_)}}if(e.surfacecolor){w.intensity=_.pop()}var A=[true,true,true];var S=["x","y","z"];for(m=0;m<3;++m){var E=e.contours[S[m]];A[m]=E.highlight;w.showContour[m]=E.show||E.highlight;if(!w.showContour[m])continue;w.contourProject[m]=[E.project.x,E.project.y,E.project.z];if(E.show){this.showContour[m]=true;w.levels[m]=d[m];a.highlightColor[m]=w.contourColor[m]=c(E.color);if(E.usecolormap){a.highlightTint[m]=w.contourTint[m]=0}else{a.highlightTint[m]=w.contourTint[m]=1}w.contourWidth[m]=E.width;this.contourStart[m]=E.start;this.contourEnd[m]=E.end;this.contourSize[m]=E.size}else{this.showContour[m]=false;this.contourStart[m]=null;this.contourEnd[m]=null;this.contourSize[m]=0}if(E.highlight){w.dynamicColor[m]=c(E.highlightcolor);w.dynamicWidth[m]=E.highlightwidth}}if(v(i)){w.vertexColor=true}w.objectOffset=this.objectOffset;w.coords=_;a.update(w);a.visible=e.visible;a.enableDynamic=A;a.enableHighlight=A;a.snapToData=true;if("lighting"in e){a.ambientLight=e.lighting.ambient;a.diffuseLight=e.lighting.diffuse;a.specularLight=e.lighting.specular;a.roughness=e.lighting.roughness;a.fresnel=e.lighting.fresnel}if("lightposition"in e){a.lightPosition=[e.lightposition.x,e.lightposition.y,e.lightposition.z]}};p.dispose=function(){this.scene.glplot.remove(this.surface);this.surface.dispose()};function E(e,t){var r=e.glplot.gl;var n=a({gl:r});var i=new h(e,n,t.uid);n._trace=i;i.update(t);e.glplot.add(n);return i}t.exports=E},{"../../components/colorscale":662,"../../lib":787,"../../lib/gl_format_color":783,"../../lib/str2rgbarray":812,"../heatmap/find_empties":1075,"../heatmap/interp2d":1078,"gl-surface3d":346,ndarray:472,"ndarray-linear-interpolate":466}],1329:[function(e,t,r){"use strict";var a=e("../../registry");var n=e("../../lib");var i=e("../../components/colorscale/defaults");var o=e("./attributes");var s=.1;function l(e,t){var r=[];var a=32;for(var n=0;n<a;n++){var i=n/(a-1);var o=t+(1-t)*(1-Math.pow(Math.sin(e*i*Math.PI),2));r.push([i,Math.max(0,Math.min(1,o))])}return r}function u(e){var t=0;if(!Array.isArray(e)||e.length<2)return false;if(!e[0]||!e[e.length-1])return false;if(+e[0][0]!==0||+e[e.length-1][0]!==1)return false;for(var r=0;r<e.length;r++){var a=e[r];if(a.length!==2||+a[0]<t){return false}t=+a[0]}return true}function c(e,t,r,s){var l,u;function c(r,a){return n.coerce(e,t,o,r,a)}var p=c("x");var v=c("y");var d=c("z");if(!d||!d.length||(p?p.length<1:false)||(v?v.length<1:false)){t.visible=false;return}t._xlength=Array.isArray(p)&&n.isArrayOrTypedArray(p[0])?d.length:d[0].length;t._ylength=d.length;var m=a.getComponentMethod("calendars","handleTraceDefaults");m(e,t,["x","y","z"],s);c("text");c("hovertext");c("hovertemplate");c("xhoverformat");c("yhoverformat");c("zhoverformat");["lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lightposition.x","lightposition.y","lightposition.z","hidesurface","connectgaps","opacity"].forEach((function(e){c(e)}));var g=c("surfacecolor");var y=["x","y","z"];for(l=0;l<3;++l){var x="contours."+y[l];var b=c(x+".show");var _=c(x+".highlight");if(b||_){for(u=0;u<3;++u){c(x+".project."+y[u])}}if(b){c(x+".color");c(x+".width");c(x+".usecolormap")}if(_){c(x+".highlightcolor");c(x+".highlightwidth")}c(x+".start");c(x+".end");c(x+".size")}if(!g){h(e,"zmin","cmin");h(e,"zmax","cmax");h(e,"zauto","cauto")}i(e,t,s,c,{prefix:"",cLetter:"c"});f(e,t,s,c);t._length=null}function f(e,t,r,a){var n=a("opacityscale");if(n==="max"){t.opacityscale=[[0,s],[1,1]]}else if(n==="min"){t.opacityscale=[[0,1],[1,s]]}else if(n==="extremes"){t.opacityscale=l(1,s)}else if(!u(n)){t.opacityscale=undefined}}function h(e,t,r){if(t in e&&!(r in e)){e[r]=e[t]}}t.exports={supplyDefaults:c,opacityscaleDefaults:f}},{"../../components/colorscale/defaults":660,"../../lib":787,"../../registry":915,"./attributes":1326}],1330:[function(e,t,r){"use strict";t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults").supplyDefaults,colorbar:{min:"cmin",max:"cmax"},calc:e("./calc"),plot:e("./convert"),moduleType:"trace",name:"surface",basePlotModule:e("../../plots/gl3d"),categories:["gl3d","2dMap","showLegend"],meta:{}}},{"../../plots/gl3d":880,"./attributes":1326,"./calc":1327,"./convert":1328,"./defaults":1329}],1331:[function(e,t,r){"use strict";var a=e("../../components/annotations/attributes");var n=e("../../lib/extend").extendFlat;var i=e("../../plot_api/edit_types").overrideAll;var o=e("../../plots/font_attributes");var s=e("../../plots/domain").attributes;var l=e("../../plots/cartesian/axis_format_attributes").descriptionOnlyNumbers;var u=t.exports=i({domain:s({name:"table",trace:true}),columnwidth:{valType:"number",arrayOk:true,dflt:null},columnorder:{valType:"data_array"},header:{values:{valType:"data_array",dflt:[]},format:{valType:"data_array",dflt:[],description:l("cell value")},prefix:{valType:"string",arrayOk:true,dflt:null},suffix:{valType:"string",arrayOk:true,dflt:null},height:{valType:"number",dflt:28},align:n({},a.align,{arrayOk:true}),line:{width:{valType:"number",arrayOk:true,dflt:1},color:{valType:"color",arrayOk:true,dflt:"grey"}},fill:{color:{valType:"color",arrayOk:true,dflt:"white"}},font:n({},o({arrayOk:true}))},cells:{values:{valType:"data_array",dflt:[]},format:{valType:"data_array",dflt:[],description:l("cell value")},prefix:{valType:"string",arrayOk:true,dflt:null},suffix:{valType:"string",arrayOk:true,dflt:null},height:{valType:"number",dflt:20},align:n({},a.align,{arrayOk:true}),line:{width:{valType:"number",arrayOk:true,dflt:1},color:{valType:"color",arrayOk:true,dflt:"grey"}},fill:{color:{valType:"color",arrayOk:true,dflt:"white"}},font:n({},o({arrayOk:true}))}},"calc","from-root");u.transforms=undefined},{"../../components/annotations/attributes":633,"../../lib/extend":777,"../../plot_api/edit_types":820,"../../plots/cartesian/axis_format_attributes":841,"../../plots/domain":866,"../../plots/font_attributes":867}],1332:[function(e,t,r){"use strict";var a=e("../../plots/get_data").getModuleCalcData;var n=e("./plot");var i="table";r.name=i;r.plot=function(e){var t=a(e.calcdata,i)[0];if(t.length)n(e,t)};r.clean=function(e,t,r,a){var n=a._has&&a._has(i);var o=t._has&&t._has(i);if(n&&!o){a._paperdiv.selectAll(".table").remove()}}},{"../../plots/get_data":875,"./plot":1339}],1333:[function(e,t,r){"use strict";var a=e("../../lib/gup").wrap;t.exports=function e(){return a({})}},{"../../lib/gup":784}],1334:[function(e,t,r){"use strict";t.exports={cellPad:8,columnExtentOffset:10,columnTitleOffset:28,emptyHeaderHeight:16,latexCheck:/^\$.*\$$/,goldenRatio:1.618,lineBreaker:"<br>",maxDimensionCount:60,overdrag:45,releaseTransitionDuration:120,releaseTransitionEase:"cubic-out",scrollbarCaptureWidth:18,scrollbarHideDelay:1e3,scrollbarHideDuration:1e3,scrollbarOffset:5,scrollbarWidth:8,transitionDuration:100,transitionEase:"cubic-out",uplift:5,wrapSpacer:" ",wrapSplitCharacter:" ",cn:{table:"table",tableControlView:"table-control-view",scrollBackground:"scroll-background",yColumn:"y-column",columnBlock:"column-block",scrollAreaClip:"scroll-area-clip",scrollAreaClipRect:"scroll-area-clip-rect",columnBoundary:"column-boundary",columnBoundaryClippath:"column-boundary-clippath",columnBoundaryRect:"column-boundary-rect",columnCells:"column-cells",columnCell:"column-cell",cellRect:"cell-rect",cellText:"cell-text",cellTextHolder:"cell-text-holder",scrollbarKit:"scrollbar-kit",scrollbar:"scrollbar",scrollbarSlider:"scrollbar-slider",scrollbarGlyph:"scrollbar-glyph",scrollbarCaptureZone:"scrollbar-capture-zone"}}},{}],1335:[function(e,t,r){"use strict";var a=e("./constants");var n=e("../../lib/extend").extendFlat;var i=e("fast-isnumeric");t.exports=function e(t,r){var p=l(r.cells.values);var v=function(e){return e.slice(r.header.values.length,e.length)};var d=l(r.header.values);if(d.length&&!d[0].length){d[0]=[""];d=l(d)}var m=d.concat(v(p).map((function(){return u((d[0]||[""]).length)})));var g=r.domain;var y=Math.floor(t._fullLayout._size.w*(g.x[1]-g.x[0]));var x=Math.floor(t._fullLayout._size.h*(g.y[1]-g.y[0]));var b=r.header.values.length?m[0].map((function(){return r.header.height})):[a.emptyHeaderHeight];var _=p.length?p[0].map((function(){return r.cells.height})):[];var w=b.reduce(s,0);var T=x-w;var k=T+a.uplift;var M=h(_,k);var A=h(b,w);var S=f(A,[]);var E=f(M,S);var L={};var C=r._fullInput.columnorder.concat(v(p.map((function(e,t){return t}))));var I=m.map((function(e,t){var a=Array.isArray(r.columnwidth)?r.columnwidth[Math.min(t,r.columnwidth.length-1)]:r.columnwidth;return i(a)?Number(a):1}));var P=I.reduce(s,0);I=I.map((function(e){return e/P*y}));var O=Math.max(o(r.header.line.width),o(r.cells.line.width));var z={key:r.uid+t._context.staticPlot,translateX:g.x[0]*t._fullLayout._size.w,translateY:t._fullLayout._size.h*(1-g.y[1]),size:t._fullLayout._size,width:y,maxLineWidth:O,height:x,columnOrder:C,groupHeight:x,rowBlocks:E,headerRowBlocks:S,scrollY:0,cells:n({},r.cells,{values:p}),headerCells:n({},r.header,{values:m}),gdColumns:m.map((function(e){return e[0]})),gdColumnsOriginalOrder:m.map((function(e){return e[0]})),prevPages:[0,0],scrollbarState:{scrollbarScrollInProgress:false},columns:m.map((function(e,t){var r=L[e];L[e]=(r||0)+1;var a=e+"__"+L[e];return{key:a,label:e,specIndex:t,xIndex:C[t],xScale:c,x:undefined,calcdata:undefined,columnWidth:I[t]}}))};z.columns.forEach((function(e){e.calcdata=z;e.x=c(e)}));return z};function o(e){if(Array.isArray(e)){var t=0;for(var r=0;r<e.length;r++){t=Math.max(t,o(e[r]))}return t}return e}function s(e,t){return e+t}function l(e){var t=e.slice();var r=Infinity;var a=0;var n;for(n=0;n<t.length;n++){if(!Array.isArray(t[n]))t[n]=[t[n]];r=Math.min(r,t[n].length);a=Math.max(a,t[n].length)}if(r!==a){for(n=0;n<t.length;n++){var i=a-t[n].length;if(i)t[n]=t[n].concat(u(i))}}return t}function u(e){var t=new Array(e);for(var r=0;r<e;r++)t[r]="";return t}function c(e){return e.calcdata.columns.reduce((function(t,r){return r.xIndex<e.xIndex?t+r.columnWidth:t}),0)}function f(e,t){var r=Object.keys(e);return r.map((function(r){return n({},e[r],{auxiliaryBlocks:t})}))}function h(e,t){var r={};var a;var n=0;var i=0;var o=p();var s=0;var l=0;for(var u=0;u<e.length;u++){a=e[u];o.rows.push({rowIndex:u,rowHeight:a});i+=a;if(i>=t||u===e.length-1){r[n]=o;o.key=l++;o.firstRowIndex=s;o.lastRowIndex=u;o=p();n+=i;s=u+1;i=0}}return r}function p(){return{firstRowIndex:null,lastRowIndex:null,rows:[]}}},{"../../lib/extend":777,"./constants":1334,"fast-isnumeric":246}],1336:[function(e,t,r){"use strict";var a=e("../../lib/extend").extendFlat;r.splitToPanels=function(e){var t=[0,0];var r=a({},e,{key:"header",type:"header",page:0,prevPages:t,currentRepaint:[null,null],dragHandle:true,values:e.calcdata.headerCells.values[e.specIndex],rowBlocks:e.calcdata.headerRowBlocks,calcdata:a({},e.calcdata,{cells:e.calcdata.headerCells})});var n=a({},e,{key:"cells1",type:"cells",page:0,prevPages:t,currentRepaint:[null,null],dragHandle:false,values:e.calcdata.cells.values[e.specIndex],rowBlocks:e.calcdata.rowBlocks});var i=a({},e,{key:"cells2",type:"cells",page:1,prevPages:t,currentRepaint:[null,null],dragHandle:false,values:e.calcdata.cells.values[e.specIndex],rowBlocks:e.calcdata.rowBlocks});return[n,i,r]};r.splitToCells=function(e){var t=n(e);return(e.values||[]).slice(t[0],t[1]).map((function(r,a){var n=typeof r==="string"&&r.match(/[<$&> ]/)?"_keybuster_"+Math.random():"";return{keyWithinBlock:a+n,key:t[0]+a,column:e,calcdata:e.calcdata,page:e.page,rowBlocks:e.rowBlocks,value:r}}))};function n(e){var t=e.rowBlocks[e.page];var r=t?t.rows[0].rowIndex:0;var a=t?r+t.rows.length:0;return[r,a]}},{"../../lib/extend":777}],1337:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("./attributes");var i=e("../../plots/domain").defaults;function o(e,t){var r=e.columnorder||[];var a=e.header.values.length;var n=r.slice(0,a);var i=n.slice().sort((function(e,t){return e-t}));var o=n.map((function(e){return i.indexOf(e)}));for(var s=o.length;s<a;s++){o.push(s)}t("columnorder",o)}t.exports=function e(t,r,s,l){function u(e,i){return a.coerce(t,r,n,e,i)}i(r,l,u);u("columnwidth");u("header.values");u("header.format");u("header.align");u("header.prefix");u("header.suffix");u("header.height");u("header.line.width");u("header.line.color");u("header.fill.color");a.coerceFont(u,"header.font",a.extendFlat({},l.font));o(r,u);u("cells.values");u("cells.format");u("cells.align");u("cells.prefix");u("cells.suffix");u("cells.height");u("cells.line.width");u("cells.line.color");u("cells.fill.color");a.coerceFont(u,"cells.font",a.extendFlat({},l.font));r._length=null}},{"../../lib":787,"../../plots/domain":866,"./attributes":1331}],1338:[function(e,t,r){"use strict";t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),calc:e("./calc"),plot:e("./plot"),moduleType:"trace",name:"table",basePlotModule:e("./base_plot"),categories:["noOpacity"],meta:{}}},{"./attributes":1331,"./base_plot":1332,"./calc":1333,"./defaults":1337,"./plot":1339}],1339:[function(e,t,r){"use strict";var a=e("./constants");var n=e("@plotly/d3");var i=e("../../lib");var o=i.numberFormat;var s=e("../../lib/gup");var l=e("../../components/drawing");var u=e("../../lib/svg_text_utils");var c=e("../../lib").raiseToTop;var f=e("../../lib").strTranslate;var h=e("../../lib").cancelTransition;var p=e("./data_preparation_helper");var v=e("./data_split_helpers");var d=e("../../components/color");t.exports=function e(t,r){var i=!t._context.staticPlot;var o=t._fullLayout._paper.selectAll("."+a.cn.table).data(r.map((function(e){var r=s.unwrap(e);var a=r.trace;return p(t,a)})),s.keyFun);o.exit().remove();o.enter().append("g").classed(a.cn.table,true).attr("overflow","visible").style("box-sizing","content-box").style("position","absolute").style("left",0).style("overflow","visible").style("shape-rendering","crispEdges").style("pointer-events","all");o.attr("width",(function(e){return e.width+e.size.l+e.size.r})).attr("height",(function(e){return e.height+e.size.t+e.size.b})).attr("transform",(function(e){return f(e.translateX,e.translateY)}));var u=o.selectAll("."+a.cn.tableControlView).data(s.repeat,s.keyFun);var d=u.enter().append("g").classed(a.cn.tableControlView,true).style("box-sizing","content-box");if(i){var w="onwheel"in document?"wheel":"mousewheel";d.on("mousemove",(function(e){u.filter((function(t){return e===t})).call(b,t)})).on(w,(function(e){if(e.scrollbarState.wheeling)return;e.scrollbarState.wheeling=true;var r=e.scrollY+n.event.deltaY;var a=U(t,u,null,r)(e);if(!a){n.event.stopPropagation();n.event.preventDefault()}e.scrollbarState.wheeling=false})).call(b,t,true)}u.attr("transform",(function(e){return f(e.size.l,e.size.t)}));var T=u.selectAll("."+a.cn.scrollBackground).data(s.repeat,s.keyFun);T.enter().append("rect").classed(a.cn.scrollBackground,true).attr("fill","none");T.attr("width",(function(e){return e.width})).attr("height",(function(e){return e.height}));u.each((function(e){l.setClipUrl(n.select(this),g(t,e),t)}));var k=u.selectAll("."+a.cn.yColumn).data((function(e){return e.columns}),s.keyFun);k.enter().append("g").classed(a.cn.yColumn,true);k.exit().remove();k.attr("transform",(function(e){return f(e.x,0)}));if(i){k.call(n.behavior.drag().origin((function(e){var r=n.select(this);D(r,e,-a.uplift);c(this);e.calcdata.columnDragInProgress=true;b(u.filter((function(t){return e.calcdata.key===t.key})),t);return e})).on("drag",(function(e){var t=n.select(this);var r=function(t){return(e===t?n.event.x:t.x)+t.columnWidth/2};e.x=Math.max(-a.overdrag,Math.min(e.calcdata.width+a.overdrag-e.columnWidth,n.event.x));var i=x(k).filter((function(t){return t.calcdata.key===e.calcdata.key}));var o=i.sort((function(e,t){return r(e)-r(t)}));o.forEach((function(t,r){t.xIndex=r;t.x=e===t?t.x:t.xScale(t)}));k.filter((function(t){return e!==t})).transition().ease(a.transitionEase).duration(a.transitionDuration).attr("transform",(function(e){return f(e.x,0)}));t.call(h).attr("transform",f(e.x,-a.uplift))})).on("dragend",(function(e){var r=n.select(this);var a=e.calcdata;e.x=e.xScale(e);e.calcdata.columnDragInProgress=false;D(r,e,0);O(t,a,a.columns.map((function(e){return e.xIndex})))})))}k.each((function(e){l.setClipUrl(n.select(this),y(t,e),t)}));var M=k.selectAll("."+a.cn.columnBlock).data(v.splitToPanels,s.keyFun);M.enter().append("g").classed(a.cn.columnBlock,true).attr("id",(function(e){return e.key}));M.style("cursor",(function(e){return e.dragHandle?"ew-resize":e.calcdata.scrollbarState.barWiggleRoom?"ns-resize":"default"}));var A=M.filter(F);var S=M.filter(R);if(i){S.call(n.behavior.drag().origin((function(e){n.event.stopPropagation();return e})).on("drag",U(t,u,-1)).on("dragend",(function(){})))}_(t,u,A,M);_(t,u,S,M);var E=u.selectAll("."+a.cn.scrollAreaClip).data(s.repeat,s.keyFun);E.enter().append("clipPath").classed(a.cn.scrollAreaClip,true).attr("id",(function(e){return g(t,e)}));var L=E.selectAll("."+a.cn.scrollAreaClipRect).data(s.repeat,s.keyFun);L.enter().append("rect").classed(a.cn.scrollAreaClipRect,true).attr("x",-a.overdrag).attr("y",-a.uplift).attr("fill","none");L.attr("width",(function(e){return e.width+2*a.overdrag})).attr("height",(function(e){return e.height+a.uplift}));var C=k.selectAll("."+a.cn.columnBoundary).data(s.repeat,s.keyFun);C.enter().append("g").classed(a.cn.columnBoundary,true);var I=k.selectAll("."+a.cn.columnBoundaryClippath).data(s.repeat,s.keyFun);I.enter().append("clipPath").classed(a.cn.columnBoundaryClippath,true);I.attr("id",(function(e){return y(t,e)}));var P=I.selectAll("."+a.cn.columnBoundaryRect).data(s.repeat,s.keyFun);P.enter().append("rect").classed(a.cn.columnBoundaryRect,true).attr("fill","none");P.attr("width",(function(e){return e.columnWidth+2*m(e)})).attr("height",(function(e){return e.calcdata.height+2*m(e)+a.uplift})).attr("x",(function(e){return-m(e)})).attr("y",(function(e){return-m(e)}));j(null,S,u)};function m(e){return Math.ceil(e.calcdata.maxLineWidth/2)}function g(e,t){return"clip"+e._fullLayout._uid+"_scrollAreaBottomClip_"+t.key}function y(e,t){return"clip"+e._fullLayout._uid+"_columnBoundaryClippath_"+t.calcdata.key+"_"+t.specIndex}function x(e){return[].concat.apply([],e.map((function(e){return e}))).map((function(e){return e.__data__}))}function b(e,t,r){function i(e){var t=e.rowBlocks;return W(t,t.length-1)+(t.length?X(t[t.length-1],Infinity):1)}var o=e.selectAll("."+a.cn.scrollbarKit).data(s.repeat,s.keyFun);o.enter().append("g").classed(a.cn.scrollbarKit,true).style("shape-rendering","geometricPrecision");o.each((function(e){var t=e.scrollbarState;t.totalHeight=i(e);t.scrollableAreaHeight=e.groupHeight-B(e);t.currentlyVisibleHeight=Math.min(t.totalHeight,t.scrollableAreaHeight);t.ratio=t.currentlyVisibleHeight/t.totalHeight;t.barLength=Math.max(t.ratio*t.currentlyVisibleHeight,a.goldenRatio*a.scrollbarWidth);t.barWiggleRoom=t.currentlyVisibleHeight-t.barLength;t.wiggleRoom=Math.max(0,t.totalHeight-t.scrollableAreaHeight);t.topY=t.barWiggleRoom===0?0:e.scrollY/t.wiggleRoom*t.barWiggleRoom;t.bottomY=t.topY+t.barLength;t.dragMultiplier=t.wiggleRoom/t.barWiggleRoom})).attr("transform",(function(e){var t=e.width+a.scrollbarWidth/2+a.scrollbarOffset;return f(t,B(e))}));var l=o.selectAll("."+a.cn.scrollbar).data(s.repeat,s.keyFun);l.enter().append("g").classed(a.cn.scrollbar,true);var u=l.selectAll("."+a.cn.scrollbarSlider).data(s.repeat,s.keyFun);u.enter().append("g").classed(a.cn.scrollbarSlider,true);u.attr("transform",(function(e){return f(0,e.scrollbarState.topY||0)}));var c=u.selectAll("."+a.cn.scrollbarGlyph).data(s.repeat,s.keyFun);c.enter().append("line").classed(a.cn.scrollbarGlyph,true).attr("stroke","black").attr("stroke-width",a.scrollbarWidth).attr("stroke-linecap","round").attr("y1",a.scrollbarWidth/2);c.attr("y2",(function(e){return e.scrollbarState.barLength-a.scrollbarWidth/2})).attr("stroke-opacity",(function(e){return e.columnDragInProgress||!e.scrollbarState.barWiggleRoom||r?0:.4}));c.transition().delay(0).duration(0);c.transition().delay(a.scrollbarHideDelay).duration(a.scrollbarHideDuration).attr("stroke-opacity",0);var h=l.selectAll("."+a.cn.scrollbarCaptureZone).data(s.repeat,s.keyFun);h.enter().append("line").classed(a.cn.scrollbarCaptureZone,true).attr("stroke","white").attr("stroke-opacity",.01).attr("stroke-width",a.scrollbarCaptureWidth).attr("stroke-linecap","butt").attr("y1",0).on("mousedown",(function(r){var a=n.event.y;var i=this.getBoundingClientRect();var o=r.scrollbarState;var s=a-i.top;var l=n.scale.linear().domain([0,o.scrollableAreaHeight]).range([0,o.totalHeight]).clamp(true);if(!(o.topY<=s&&s<=o.bottomY)){U(t,e,null,l(s-o.barLength/2))(r)}})).call(n.behavior.drag().origin((function(e){n.event.stopPropagation();e.scrollbarState.scrollbarScrollInProgress=true;return e})).on("drag",U(t,e)).on("dragend",(function(){})));h.attr("y2",(function(e){return e.scrollbarState.scrollableAreaHeight}));if(t._context.staticPlot){c.remove();h.remove()}}function _(e,t,r,a){var n=w(r);var i=T(n);S(i);var o=k(i);L(o);var s=A(i);var l=M(s);E(l);C(l,t,a,e);Y(i)}function w(e){var t=e.selectAll("."+a.cn.columnCells).data(s.repeat,s.keyFun);t.enter().append("g").classed(a.cn.columnCells,true);t.exit().remove();return t}function T(e){var t=e.selectAll("."+a.cn.columnCell).data(v.splitToCells,(function(e){return e.keyWithinBlock}));t.enter().append("g").classed(a.cn.columnCell,true);t.exit().remove();return t}function k(e){var t=e.selectAll("."+a.cn.cellRect).data(s.repeat,(function(e){return e.keyWithinBlock}));t.enter().append("rect").classed(a.cn.cellRect,true);return t}function M(e){var t=e.selectAll("."+a.cn.cellText).data(s.repeat,(function(e){return e.keyWithinBlock}));t.enter().append("text").classed(a.cn.cellText,true).style("cursor",(function(){return"auto"})).on("mousedown",(function(){n.event.stopPropagation()}));return t}function A(e){var t=e.selectAll("."+a.cn.cellTextHolder).data(s.repeat,(function(e){return e.keyWithinBlock}));t.enter().append("g").classed(a.cn.cellTextHolder,true).style("shape-rendering","geometricPrecision");return t}function S(e){e.each((function(e,t){var r=e.calcdata.cells.font;var a=e.column.specIndex;var n={size:z(r.size,a,t),color:z(r.color,a,t),family:z(r.family,a,t)};e.rowNumber=e.key;e.align=z(e.calcdata.cells.align,a,t);e.cellBorderWidth=z(e.calcdata.cells.line.width,a,t);e.font=n}))}function E(e){e.each((function(e){l.font(n.select(this),e.font)}))}function L(e){e.attr("width",(function(e){return e.column.columnWidth})).attr("stroke-width",(function(e){return e.cellBorderWidth})).each((function(e){var t=n.select(this);d.stroke(t,z(e.calcdata.cells.line.color,e.column.specIndex,e.rowNumber));d.fill(t,z(e.calcdata.cells.fill.color,e.column.specIndex,e.rowNumber))}))}function C(e,t,r,i){e.text((function(e){var t=e.column.specIndex;var r=e.rowNumber;var n=e.value;var i=typeof n==="string";var s=i&&n.match(/<br>/i);var l=!i||s;e.mayHaveMarkup=i&&n.match(/[<&>]/);var u=I(n);e.latex=u;var c=u?"":z(e.calcdata.cells.prefix,t,r)||"";var f=u?"":z(e.calcdata.cells.suffix,t,r)||"";var h=u?null:z(e.calcdata.cells.format,t,r)||null;var p=c+(h?o(h)(e.value):e.value)+f;var v;e.wrappingNeeded=!e.wrapped&&!l&&!u&&(v=P(p));e.cellHeightMayIncrease=s||u||e.mayHaveMarkup||(v===void 0?P(p):v);e.needsConvertToTspans=e.mayHaveMarkup||e.wrappingNeeded||e.latex;var d;if(e.wrappingNeeded){var m=a.wrapSplitCharacter===" "?p.replace(/<a href=/gi,"<a_href="):p;var g=m.split(a.wrapSplitCharacter);var y=a.wrapSplitCharacter===" "?g.map((function(e){return e.replace(/<a_href=/gi,"<a href=")})):g;e.fragments=y.map((function(e){return{text:e,width:null}}));e.fragments.push({fragment:a.wrapSpacer,width:null});d=y.join(a.lineBreaker)+a.lineBreaker+a.wrapSpacer}else{delete e.fragments;d=p}return d})).attr("dy",(function(e){return e.needsConvertToTspans?0:"0.75em"})).each((function(e){var o=this;var s=n.select(o);var l=e.wrappingNeeded?H:q;if(e.needsConvertToTspans){u.convertToTspans(s,i,l(r,o,t,i,e))}else{n.select(o.parentNode).attr("transform",(function(e){return f(G(e),a.cellPad)})).attr("text-anchor",(function(e){return{left:"start",center:"middle",right:"end"}[e.align]}))}}))}function I(e){return typeof e==="string"&&e.match(a.latexCheck)}function P(e){return e.indexOf(a.wrapSplitCharacter)!==-1}function O(e,t,r){var a=t.gdColumnsOriginalOrder;t.gdColumns.sort((function(e,t){return r[a.indexOf(e)]-r[a.indexOf(t)]}));t.columnorder=r;e.emit("plotly_restyle")}function z(e,t,r){if(Array.isArray(e)){var a=e[Math.min(t,e.length-1)];if(Array.isArray(a)){return a[Math.min(r,a.length-1)]}else{return a}}else{return e}}function D(e,t,r){e.transition().ease(a.releaseTransitionEase).duration(a.releaseTransitionDuration).attr("transform",f(t.x,r))}function R(e){return e.type==="cells"}function F(e){return e.type==="header"}function B(e){var t=e.rowBlocks.length?e.rowBlocks[0].auxiliaryBlocks:[];return t.reduce((function(e,t){return e+X(t,Infinity)}),0)}function N(e,t,r){var a=[];var n=0;for(var i=0;i<e.length;i++){var o=e[i];var s=o.rows;var l=0;for(var u=0;u<s.length;u++){l+=s[u].rowHeight}o.allRowsHeight=l;var c=n+l;var f=t;var h=f+r;if(f<c&&h>n){a.push(i)}n+=l}return a}function j(e,t,r){var a=x(t)[0];if(a===undefined)return;var n=a.rowBlocks;var i=a.calcdata;var o=W(n,n.length);var s=a.calcdata.groupHeight-B(a);var l=i.scrollY=Math.max(0,Math.min(o-s,i.scrollY));var u=N(n,l,s);if(u.length===1){if(u[0]===n.length-1){u.unshift(u[0]-1)}else{u.push(u[0]+1)}}if(u[0]%2){u.reverse()}t.each((function(e,t){e.page=u[t];e.scrollY=l}));t.attr("transform",(function(e){var t=W(e.rowBlocks,e.page)-e.scrollY;return f(0,t)}));if(e){V(e,r,t,u,a.prevPages,a,0);V(e,r,t,u,a.prevPages,a,1);b(r,e)}}function U(e,t,r,i){return function o(s){var l=s.calcdata?s.calcdata:s;var u=t.filter((function(e){return l.key===e.key}));var c=r||l.scrollbarState.dragMultiplier;var f=l.scrollY;l.scrollY=i===void 0?l.scrollY+c*n.event.dy:i;var h=u.selectAll("."+a.cn.yColumn).selectAll("."+a.cn.columnBlock).filter(R);j(e,h,u);return l.scrollY===f}}function V(e,t,r,a,n,i,o){var s=a[o]!==n[o];if(s){clearTimeout(i.currentRepaint[o]);i.currentRepaint[o]=setTimeout((function(){var i=r.filter((function(e,t){return t===o&&a[t]!==n[t]}));_(e,t,i,r);n[o]=a[o]}))}}function H(e,t,r,i){return function o(){var s=n.select(t.parentNode);s.each((function(e){var t=e.fragments;s.selectAll("tspan.line").each((function(e,r){t[r].width=this.getComputedTextLength()}));var r=t[t.length-1].width;var n=t.slice(0,-1);var i=[];var o,l;var u=0;var c=e.column.columnWidth-2*a.cellPad;e.value="";while(n.length){o=n.shift();l=o.width+r;if(u+l>c){e.value+=i.join(a.wrapSpacer)+a.lineBreaker;i=[];u=0}i.push(o.text);u+=l}if(u){e.value+=i.join(a.wrapSpacer)}e.wrapped=true}));s.selectAll("tspan.line").remove();C(s.select("."+a.cn.cellText),r,e,i);n.select(t.parentNode.parentNode).call(Y)}}function q(e,t,r,i,o){return function s(){if(o.settledY)return;var l=n.select(t.parentNode);var u=J(o);var c=o.key-u.firstRowIndex;var h=u.rows[c].rowHeight;var p=o.cellHeightMayIncrease?t.parentNode.getBoundingClientRect().height+2*a.cellPad:h;var v=Math.max(p,h);var d=v-u.rows[c].rowHeight;if(d){u.rows[c].rowHeight=v;e.selectAll("."+a.cn.columnCell).call(Y);j(null,e.filter(R),0);b(r,i,true)}l.attr("transform",(function(){var e=this;var t=e.parentNode;var r=t.getBoundingClientRect();var i=n.select(e.parentNode).select("."+a.cn.cellRect).node().getBoundingClientRect();var s=e.transform.baseVal.consolidate();var l=i.top-r.top+(s?s.matrix.f:a.cellPad);return f(G(o,n.select(e.parentNode).select("."+a.cn.cellTextHolder).node().getBoundingClientRect().width),l)}));o.settledY=true}}function G(e,t){switch(e.align){case"left":return a.cellPad;case"right":return e.column.columnWidth-(t||0)-a.cellPad;case"center":return(e.column.columnWidth-(t||0))/2;default:return a.cellPad}}function Y(e){e.attr("transform",(function(e){var t=e.rowBlocks[0].auxiliaryBlocks.reduce((function(e,t){return e+X(t,Infinity)}),0);var r=J(e);var a=X(r,e.key);var n=a+t;return f(0,n)})).selectAll("."+a.cn.cellRect).attr("height",(function(e){return K(J(e),e.key).rowHeight}))}function W(e,t){var r=0;for(var a=t-1;a>=0;a--){r+=Z(e[a])}return r}function X(e,t){var r=0;for(var a=0;a<e.rows.length&&e.rows[a].rowIndex<t;a++){r+=e.rows[a].rowHeight}return r}function Z(e){var t=e.allRowsHeight;if(t!==void 0){return t}var r=0;for(var a=0;a<e.rows.length;a++){r+=e.rows[a].rowHeight}e.allRowsHeight=r;return r}function J(e){return e.rowBlocks[e.page]}function K(e,t){return e.rows[t-e.firstRowIndex]}},{"../../components/color":650,"../../components/drawing":672,"../../lib":787,"../../lib/gup":784,"../../lib/svg_text_utils":813,"./constants":1334,"./data_preparation_helper":1335,"./data_split_helpers":1336,"@plotly/d3":58}],1340:[function(e,t,r){"use strict";var a=e("../../plots/template_attributes").hovertemplateAttrs;var n=e("../../plots/template_attributes").texttemplateAttrs;var i=e("../../components/colorscale/attributes");var o=e("../../plots/domain").attributes;var s=e("../pie/attributes");var l=e("../sunburst/attributes");var u=e("./constants");var c=e("../../lib/extend").extendFlat;t.exports={labels:l.labels,parents:l.parents,values:l.values,branchvalues:l.branchvalues,count:l.count,level:l.level,maxdepth:l.maxdepth,tiling:{packing:{valType:"enumerated",values:["squarify","binary","dice","slice","slice-dice","dice-slice"],dflt:"squarify",editType:"plot"},squarifyratio:{valType:"number",min:1,dflt:1,editType:"plot"},flip:{valType:"flaglist",flags:["x","y"],dflt:"",editType:"plot"},pad:{valType:"number",min:0,dflt:3,editType:"plot"},editType:"calc"},marker:c({pad:{t:{valType:"number",min:0,editType:"plot"},l:{valType:"number",min:0,editType:"plot"},r:{valType:"number",min:0,editType:"plot"},b:{valType:"number",min:0,editType:"plot"},editType:"calc"},colors:l.marker.colors,depthfade:{valType:"enumerated",values:[true,false,"reversed"],editType:"style"},line:l.marker.line,editType:"calc"},i("marker",{colorAttr:"colors",anim:false})),pathbar:{visible:{valType:"boolean",dflt:true,editType:"plot"},side:{valType:"enumerated",values:["top","bottom"],dflt:"top",editType:"plot"},edgeshape:{valType:"enumerated",values:[">","<","|","/","\\"],dflt:">",editType:"plot"},thickness:{valType:"number",min:12,editType:"plot"},textfont:c({},s.textfont,{}),editType:"calc"},text:s.text,textinfo:l.textinfo,texttemplate:n({editType:"plot"},{keys:u.eventDataKeys.concat(["label","value"])}),hovertext:s.hovertext,hoverinfo:l.hoverinfo,hovertemplate:a({},{keys:u.eventDataKeys}),textfont:s.textfont,insidetextfont:s.insidetextfont,outsidetextfont:c({},s.outsidetextfont,{}),textposition:{valType:"enumerated",values:["top left","top center","top right","middle left","middle center","middle right","bottom left","bottom center","bottom right"],dflt:"top left",editType:"plot"},sort:s.sort,root:l.root,domain:o({name:"treemap",trace:true,editType:"calc"})}},{"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../plots/domain":866,"../../plots/template_attributes":910,"../pie/attributes":1176,"../sunburst/attributes":1314,"./constants":1343}],1341:[function(e,t,r){"use strict";var a=e("../../plots/plots");r.name="treemap";r.plot=function(e,t,n,i){a.plotBasePlot(r.name,e,t,n,i)};r.clean=function(e,t,n,i){a.cleanBasePlot(r.name,e,t,n,i)}},{"../../plots/plots":901}],1342:[function(e,t,r){"use strict";var a=e("../sunburst/calc");r.calc=function(e,t){return a.calc(e,t)};r.crossTraceCalc=function(e){return a._runCrossTraceCalc("treemap",e)}},{"../sunburst/calc":1316}],1343:[function(e,t,r){"use strict";t.exports={CLICK_TRANSITION_TIME:750,CLICK_TRANSITION_EASING:"poly",eventDataKeys:["currentPath","root","entry","percentRoot","percentEntry","percentParent"],gapWithPathbar:1}},{}],1344:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("./attributes");var i=e("../../components/color");var o=e("../../plots/domain").defaults;var s=e("../bar/defaults").handleText;var l=e("../bar/constants").TEXTPAD;var u=e("../../components/colorscale");var c=u.hasColorscale;var f=u.handleDefaults;t.exports=function e(t,r,u,h){function p(e,i){return a.coerce(t,r,n,e,i)}var v=p("labels");var d=p("parents");if(!v||!v.length||!d||!d.length){r.visible=false;return}var m=p("values");if(m&&m.length){p("branchvalues")}else{p("count")}p("level");p("maxdepth");var g=p("tiling.packing");if(g==="squarify"){p("tiling.squarifyratio")}p("tiling.flip");p("tiling.pad");var y=p("text");p("texttemplate");if(!r.texttemplate)p("textinfo",Array.isArray(y)?"text+label":"label");p("hovertext");p("hovertemplate");var x=p("pathbar.visible");var b="auto";s(t,r,h,p,b,{hasPathbar:x,moduleHasSelected:false,moduleHasUnselected:false,moduleHasConstrain:false,moduleHasCliponaxis:false,moduleHasTextangle:false,moduleHasInsideanchor:false});p("textposition");var _=r.textposition.indexOf("bottom")!==-1;var w=p("marker.line.width");if(w)p("marker.line.color",h.paper_bgcolor);var T=p("marker.colors");var k=r._hasColorscale=c(t,"marker","colors")||(t.marker||{}).coloraxis;if(k){f(t,r,h,p,{prefix:"marker.",cLetter:"c"})}else{p("marker.depthfade",!(T||[]).length)}var M=r.textfont.size*2;p("marker.pad.t",_?M/4:M);p("marker.pad.l",M/4);p("marker.pad.r",M/4);p("marker.pad.b",_?M:M/4);r._hovered={marker:{line:{width:2,color:i.contrast(h.paper_bgcolor)}}};if(x){p("pathbar.thickness",r.pathbar.textfont.size+2*l);p("pathbar.side");p("pathbar.edgeshape")}p("sort");p("root.color");o(r,h,p);r._length=null}},{"../../components/color":650,"../../components/colorscale":662,"../../lib":787,"../../plots/domain":866,"../bar/constants":927,"../bar/defaults":929,"./attributes":1340}],1345:[function(e,t,r){"use strict";var a=e("@plotly/d3");var n=e("../sunburst/helpers");var i=e("../bar/uniform_text");var o=i.clearMinTextSize;var s=e("../bar/style").resizeText;var l=e("./plot_one");t.exports=function e(t,r,i,u,c){var f=c.type;var h=c.drawDescendants;var p=t._fullLayout;var v=p["_"+f+"layer"];var d,m;var g=!i;o(f,p);d=v.selectAll("g.trace."+f).data(r,(function(e){return e[0].trace.uid}));d.enter().append("g").classed("trace",true).classed(f,true);d.order();if(!p.uniformtext.mode&&n.hasTransition(i)){if(u){m=u()}var y=a.transition().duration(i.duration).ease(i.easing).each("end",(function(){m&&m()})).each("interrupt",(function(){m&&m()}));y.each((function(){v.selectAll("g.trace").each((function(e){l(t,e,this,i,h)}))}))}else{d.each((function(e){l(t,e,this,i,h)}));if(p.uniformtext.mode){s(t,v.selectAll(".trace"),f)}}if(g){d.exit().remove()}}},{"../bar/style":939,"../bar/uniform_text":941,"../sunburst/helpers":1320,"./plot_one":1354,"@plotly/d3":58}],1346:[function(e,t,r){"use strict";var a=e("@plotly/d3");var n=e("../../lib");var i=e("../../components/drawing");var o=e("../../lib/svg_text_utils");var s=e("./partition");var l=e("./style").styleOne;var u=e("./constants");var c=e("../sunburst/helpers");var f=e("../sunburst/fx");var h=true;t.exports=function e(t,r,p,v,d){var m=d.barDifY;var g=d.width;var y=d.height;var x=d.viewX;var b=d.viewY;var _=d.pathSlice;var w=d.toMoveInsideSlice;var T=d.strTransform;var k=d.hasTransition;var M=d.handleSlicesExit;var A=d.makeUpdateSliceInterpolator;var S=d.makeUpdateTextInterpolator;var E={};var L=t._fullLayout;var C=r[0];var I=C.trace;var P=C.hierarchy;var O=g/I._entryDepth;var z=c.listPath(p.data,"id");var D=s(P.copy(),[g,y],{packing:"dice",pad:{inner:0,top:0,left:0,right:0,bottom:0}}).descendants();D=D.filter((function(e){var t=z.indexOf(e.data.id);if(t===-1)return false;e.x0=O*t;e.x1=O*(t+1);e.y0=m;e.y1=m+y;e.onPathbar=true;return true}));D.reverse();v=v.data(D,c.getPtId);v.enter().append("g").classed("pathbar",true);M(v,h,E,[g,y],_);v.order();var R=v;if(k){R=R.transition().each("end",(function(){var e=a.select(this);c.setSliceCursor(e,t,{hideOnRoot:false,hideOnLeaves:false,isTransitioning:false})}))}R.each((function(e){e._x0=x(e.x0);e._x1=x(e.x1);e._y0=b(e.y0);e._y1=b(e.y1);e._hoverX=x(e.x1-Math.min(g,y)/2);e._hoverY=b(e.y1-y/2);var s=a.select(this);var v=n.ensureSingle(s,"path","surface",(function(e){e.style("pointer-events","all")}));if(k){v.transition().attrTween("d",(function(e){var t=A(e,h,E,[g,y]);return function(e){return _(t(e))}}))}else{v.attr("d",_)}s.call(f,p,t,r,{styleOne:l,eventDataKeys:u.eventDataKeys,transitionTime:u.CLICK_TRANSITION_TIME,transitionEasing:u.CLICK_TRANSITION_EASING}).call(c.setSliceCursor,t,{hideOnRoot:false,hideOnLeaves:false,isTransitioning:t._transitioning});v.call(l,e,I,{hovered:false});e._text=(c.getPtLabel(e)||"").split("<br>").join(" ")||"";var d=n.ensureSingle(s,"g","slicetext");var m=n.ensureSingle(d,"text","",(function(e){e.attr("data-notex",1)}));var M=n.ensureUniformFontSize(t,c.determineTextFont(I,e,L.font,{onPathbar:true}));m.text(e._text||" ").classed("slicetext",true).attr("text-anchor","start").call(i.font,M).call(o.convertToTspans,t);e.textBB=i.bBox(m.node());e.transform=w(e,{fontSize:M.size,onPathbar:true});e.transform.fontSize=M.size;if(k){m.transition().attrTween("transform",(function(e){var t=S(e,h,E,[g,y]);return function(e){return T(t(e))}}))}else{m.attr("transform",T(e))}}))}},{"../../components/drawing":672,"../../lib":787,"../../lib/svg_text_utils":813,"../sunburst/fx":1319,"../sunburst/helpers":1320,"./constants":1343,"./partition":1352,"./style":1355,"@plotly/d3":58}],1347:[function(e,t,r){"use strict";var a=e("@plotly/d3");var n=e("../../lib");var i=e("../../components/drawing");var o=e("../../lib/svg_text_utils");var s=e("./partition");var l=e("./style").styleOne;var u=e("./constants");var c=e("../sunburst/helpers");var f=e("../sunburst/fx");var h=e("../sunburst/plot").formatSliceLabel;var p=false;t.exports=function e(t,r,v,d,m){var g=m.width;var y=m.height;var x=m.viewX;var b=m.viewY;var _=m.pathSlice;var w=m.toMoveInsideSlice;var T=m.strTransform;var k=m.hasTransition;var M=m.handleSlicesExit;var A=m.makeUpdateSliceInterpolator;var S=m.makeUpdateTextInterpolator;var E=m.prevEntry;var L={};var C=t._fullLayout;var I=r[0];var P=I.trace;var O=P.textposition.indexOf("left")!==-1;var z=P.textposition.indexOf("right")!==-1;var D=P.textposition.indexOf("bottom")!==-1;var R=!D&&!P.marker.pad.t||D&&!P.marker.pad.b;var F=s(v,[g,y],{packing:P.tiling.packing,squarifyratio:P.tiling.squarifyratio,flipX:P.tiling.flip.indexOf("x")>-1,flipY:P.tiling.flip.indexOf("y")>-1,pad:{inner:P.tiling.pad,top:P.marker.pad.t,left:P.marker.pad.l,right:P.marker.pad.r,bottom:P.marker.pad.b}});var B=F.descendants();var N=Infinity;var j=-Infinity;B.forEach((function(e){var t=e.depth;if(t>=P._maxDepth){e.x0=e.x1=(e.x0+e.x1)/2;e.y0=e.y1=(e.y0+e.y1)/2}else{N=Math.min(N,t);j=Math.max(j,t)}}));d=d.data(B,c.getPtId);P._maxVisibleLayers=isFinite(j)?j-N+1:0;d.enter().append("g").classed("slice",true);M(d,p,L,[g,y],_);d.order();var U=null;if(k&&E){var V=c.getPtId(E);d.each((function(e){if(U===null&&c.getPtId(e)===V){U={x0:e.x0,x1:e.x1,y0:e.y0,y1:e.y1}}}))}var H=function(){return U||{x0:0,x1:g,y0:0,y1:y}};var q=d;if(k){q=q.transition().each("end",(function(){var e=a.select(this);c.setSliceCursor(e,t,{hideOnRoot:true,hideOnLeaves:false,isTransitioning:false})}))}q.each((function(e){var s=c.isHeader(e,P);e._x0=x(e.x0);e._x1=x(e.x1);e._y0=b(e.y0);e._y1=b(e.y1);e._hoverX=x(e.x1-P.marker.pad.r),e._hoverY=D?b(e.y1-P.marker.pad.b/2):b(e.y0+P.marker.pad.t/2);var d=a.select(this);var m=n.ensureSingle(d,"path","surface",(function(e){e.style("pointer-events","all")}));if(k){m.transition().attrTween("d",(function(e){var t=A(e,p,H(),[g,y]);return function(e){return _(t(e))}}))}else{m.attr("d",_)}d.call(f,v,t,r,{styleOne:l,eventDataKeys:u.eventDataKeys,transitionTime:u.CLICK_TRANSITION_TIME,transitionEasing:u.CLICK_TRANSITION_EASING}).call(c.setSliceCursor,t,{isTransitioning:t._transitioning});m.call(l,e,P,{hovered:false});if(e.x0===e.x1||e.y0===e.y1){e._text=""}else{if(s){e._text=R?"":c.getPtLabel(e)||""}else{e._text=h(e,v,P,r,C)||""}}var M=n.ensureSingle(d,"g","slicetext");var E=n.ensureSingle(M,"text","",(function(e){e.attr("data-notex",1)}));var L=n.ensureUniformFontSize(t,c.determineTextFont(P,e,C.font));E.text(e._text||" ").classed("slicetext",true).attr("text-anchor",z?"end":O||s?"start":"middle").call(i.font,L).call(o.convertToTspans,t);e.textBB=i.bBox(E.node());e.transform=w(e,{fontSize:L.size,isHeader:s});e.transform.fontSize=L.size;if(k){E.transition().attrTween("transform",(function(e){var t=S(e,p,H(),[g,y]);return function(e){return T(t(e))}}))}else{E.attr("transform",T(e))}}));return U}},{"../../components/drawing":672,"../../lib":787,"../../lib/svg_text_utils":813,"../sunburst/fx":1319,"../sunburst/helpers":1320,"../sunburst/plot":1324,"./constants":1343,"./partition":1352,"./style":1355,"@plotly/d3":58}],1348:[function(e,t,r){"use strict";t.exports=function e(t,r,a){var n;if(a.swapXY){n=t.x0;t.x0=t.y0;t.y0=n;n=t.x1;t.x1=t.y1;t.y1=n}if(a.flipX){n=t.x0;t.x0=r[0]-t.x1;t.x1=r[0]-n}if(a.flipY){n=t.y0;t.y0=r[1]-t.y1;t.y1=r[1]-n}var i=t.children;if(i){for(var o=0;o<i.length;o++){e(i[o],r,a)}}}},{}],1349:[function(e,t,r){"use strict";t.exports={moduleType:"trace",name:"treemap",basePlotModule:e("./base_plot"),categories:[],animatable:true,attributes:e("./attributes"),layoutAttributes:e("./layout_attributes"),supplyDefaults:e("./defaults"),supplyLayoutDefaults:e("./layout_defaults"),calc:e("./calc").calc,crossTraceCalc:e("./calc").crossTraceCalc,plot:e("./plot"),style:e("./style").style,colorbar:e("../scatter/marker_colorbar"),meta:{}}},{"../scatter/marker_colorbar":1220,"./attributes":1340,"./base_plot":1341,"./calc":1342,"./defaults":1344,"./layout_attributes":1350,"./layout_defaults":1351,"./plot":1353,"./style":1355}],1350:[function(e,t,r){"use strict";t.exports={treemapcolorway:{valType:"colorlist",editType:"calc"},extendtreemapcolors:{valType:"boolean",dflt:true,editType:"calc"}}},{}],1351:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("./layout_attributes");t.exports=function e(t,r){function i(e,i){return a.coerce(t,r,n,e,i)}i("treemapcolorway",r.colorway);i("extendtreemapcolors")}},{"../../lib":787,"./layout_attributes":1350}],1352:[function(e,t,r){"use strict";var a=e("d3-hierarchy");var n=e("./flip_tree");t.exports=function e(t,r,o){var s=o.flipX;var l=o.flipY;var u=o.packing==="dice-slice";var c=o.pad[l?"bottom":"top"];var f=o.pad[s?"right":"left"];var h=o.pad[s?"left":"right"];var p=o.pad[l?"top":"bottom"];var v;if(u){v=f;f=c;c=v;v=h;h=p;p=v}var d=a.treemap().tile(i(o.packing,o.squarifyratio)).paddingInner(o.pad.inner).paddingLeft(f).paddingRight(h).paddingTop(c).paddingBottom(p).size(u?[r[1],r[0]]:r)(t);if(u||s||l){n(d,r,{swapXY:u,flipX:s,flipY:l})}return d};function i(e,t){switch(e){case"squarify":return a.treemapSquarify.ratio(t);case"binary":return a.treemapBinary;case"dice":return a.treemapDice;case"slice":return a.treemapSlice;default:return a.treemapSliceDice}}},{"./flip_tree":1348,"d3-hierarchy":167}],1353:[function(e,t,r){"use strict";var a=e("./draw");var n=e("./draw_descendants");t.exports=function e(t,r,i,o){return a(t,r,i,o,{type:"treemap",drawDescendants:n})}},{"./draw":1345,"./draw_descendants":1347}],1354:[function(e,t,r){"use strict";var a=e("@plotly/d3");var n=e("d3-interpolate").interpolate;var i=e("../sunburst/helpers");var o=e("../../lib");var s=e("../bar/constants").TEXTPAD;var l=e("../bar/plot");var u=l.toMoveInsideBar;var c=e("../bar/uniform_text");var f=c.recordMinTextSize;var h=e("./constants");var p=e("./draw_ancestors");function v(e){return i.isHierarchyRoot(e)?"":i.getPtId(e)}t.exports=function e(t,r,l,c,d){var m=t._fullLayout;var g=r[0];var y=g.trace;var x=y.type;var b=x==="icicle";var _=g.hierarchy;var w=i.findEntryWithLevel(_,y.level);var T=a.select(l);var k=T.selectAll("g.pathbar");var M=T.selectAll("g.slice");if(!w){k.remove();M.remove();return}var A=i.isHierarchyRoot(w);var S=!m.uniformtext.mode&&i.hasTransition(c);var E=i.getMaxDepth(y);var L=function(e){return e.data.depth-w.data.depth<E};var C=m._size;var I=y.domain;var P=C.w*(I.x[1]-I.x[0]);var O=C.h*(I.y[1]-I.y[0]);var z=P;var D=y.pathbar.thickness;var R=y.marker.line.width+h.gapWithPathbar;var F=!y.pathbar.visible?0:y.pathbar.side.indexOf("bottom")>-1?O+R:-(D+R);var B={x0:z,x1:z,y0:F,y1:F+D};var N=function(e,t,r){var a=y.tiling.pad;var n=function(e){return e-a<=t.x0};var i=function(e){return e+a>=t.x1};var o=function(e){return e-a<=t.y0};var s=function(e){return e+a>=t.y1};if(e.x0===t.x0&&e.x1===t.x1&&e.y0===t.y0&&e.y1===t.y1){return{x0:e.x0,x1:e.x1,y0:e.y0,y1:e.y1}}return{x0:n(e.x0-a)?0:i(e.x0-a)?r[0]:e.x0,x1:n(e.x1+a)?0:i(e.x1+a)?r[0]:e.x1,y0:o(e.y0-a)?0:s(e.y0-a)?r[1]:e.y0,y1:o(e.y1+a)?0:s(e.y1+a)?r[1]:e.y1}};var j=null;var U={};var V={};var H=null;var q=function(e,t){return t?U[v(e)]:V[v(e)]};var G=function(e,t,r,a){if(t){return U[v(_)]||B}else{var n=V[y.level]||r;if(L(e)){return N(e,n,a)}}return{}};if(g.hasMultipleRoots&&A){E++}y._maxDepth=E;y._backgroundColor=m.paper_bgcolor;y._entryDepth=w.data.depth;y._atRootLevel=A;var Y=-P/2+C.l+C.w*(I.x[1]+I.x[0])/2;var W=-O/2+C.t+C.h*(1-(I.y[1]+I.y[0])/2);var X=function(e){return Y+e};var Z=function(e){return W+e};var J=Z(0);var K=X(0);var Q=function(e){return K+e};var $=function(e){return J+e};function ee(e,t){return e+","+t}var te=Q(0);var re=function(e){e.x=Math.max(te,e.x)};var ae=y.pathbar.edgeshape;var ne=function(e){var t=Q(Math.max(Math.min(e.x0,e.x0),0));var r=Q(Math.min(Math.max(e.x1,e.x1),z));var a=$(e.y0);var n=$(e.y1);var i=D/2;var o={};var s={};o.x=t;s.x=r;o.y=s.y=(a+n)/2;var l={x:t,y:a};var u={x:r,y:a};var c={x:r,y:n};var f={x:t,y:n};if(ae===">"){l.x-=i;u.x-=i;c.x-=i;f.x-=i}else if(ae==="/"){c.x-=i;f.x-=i;o.x-=i/2;s.x-=i/2}else if(ae==="\\"){l.x-=i;u.x-=i;o.x-=i/2;s.x-=i/2}else if(ae==="<"){o.x-=i;s.x-=i}re(l);re(f);re(o);re(u);re(c);re(s);return"M"+ee(l.x,l.y)+"L"+ee(u.x,u.y)+"L"+ee(s.x,s.y)+"L"+ee(c.x,c.y)+"L"+ee(f.x,f.y)+"L"+ee(o.x,o.y)+"Z"};var ie=function(e){var t=X(e.x0);var r=X(e.x1);var a=Z(e.y0);var n=Z(e.y1);var i=r-t;var o=n-a;if(!i||!o)return"";var s=0;var l=i>2*s&&o>2*s?s:0;var u=function(e,t){return l?"a"+ee(l,l)+" 0 0 1 "+ee(e,t):""};return"M"+ee(t,a+l)+u(l,-l)+"L"+ee(r-l,a)+u(l,l)+"L"+ee(r,n-l)+u(-l,l)+"L"+ee(t+l,n)+u(-l,-l)+"Z"};var oe=function(e,t){var r=e.x0;var a=e.x1;var n=e.y0;var i=e.y1;var o=e.textBB;var l=function(e){return y.textposition.indexOf(e)!==-1};var c=l("bottom");var h=l("top")||t.isHeader&&!c;var p=h?"start":c?"end":"middle";var v=l("right");var d=l("left")||t.onPathbar;var g=d?-1:v?1:0;var x=y[b?"tiling":"marker"].pad;if(t.isHeader){r+=(b?x:x.l)-s;a-=(b?x:x.r)-s;if(r>=a){var _=(r+a)/2;r=_;a=_}var w;if(c){w=i-(b?x:x.b);if(n<w&&w<i)n=w}else{w=n+(b?x:x.t);if(n<w&&w<i)i=w}}var T=u(r,a,n,i,o,{isHorizontal:false,constrained:true,angle:0,anchor:p,leftToRight:g});T.fontSize=t.fontSize;T.targetX=X(T.targetX);T.targetY=Z(T.targetY);if(isNaN(T.targetX)||isNaN(T.targetY)){return{}}if(r!==a&&n!==i){f(y.type,T,m)}return{scale:T.scale,rotate:T.rotate,textX:T.textX,textY:T.textY,anchorX:T.anchorX,anchorY:T.anchorY,targetX:T.targetX,targetY:T.targetY}};var se=function(e,t){var r;var a=0;var n=e;while(!r&&a<E){a++;n=n.parent;if(n){r=q(n,t)}else a=E}return r||{}};var le=function(e,t,r,a){var i=q(e,t);var o;if(t){o=B}else{var s=q(w,t);if(s){o=N(e,s,a)}else{o={}}}return n(i,o)};var ue=function(e,t,r,a,i){var s=q(e,t);var l;if(s){l=s}else{if(t){l=B}else{if(j){if(e.parent){var u=H||r;if(u&&!t){l=N(e,u,a)}else{l={};o.extendFlat(l,se(e,t))}}else{l=o.extendFlat({},e);if(b){if(i.orientation==="h"){if(i.flipX)l.x0=e.x1;else l.x1=0}else{if(i.flipY)l.y0=e.y1;else l.y1=0}}}}else{l={}}}}return n(l,{x0:e.x0,x1:e.x1,y0:e.y0,y1:e.y1})};var ce=function(e,t,r,a){var s=q(e,t);var l={};var u=G(e,t,r,a);o.extendFlat(l,{transform:oe({x0:u.x0,x1:u.x1,y0:u.y0,y1:u.y1,textBB:e.textBB,_text:e._text},{isHeader:i.isHeader(e,y)})});if(s){l=s}else{if(e.parent){o.extendFlat(l,se(e,t))}}var c=e.transform;if(e.x0!==e.x1&&e.y0!==e.y1){f(y.type,c,m)}return n(l,{transform:{scale:c.scale,rotate:c.rotate,textX:c.textX,textY:c.textY,anchorX:c.anchorX,anchorY:c.anchorY,targetX:c.targetX,targetY:c.targetY}})};var fe=function(e,t,r,n,i){var o=n[0];var s=n[1];if(S){e.exit().transition().each((function(){var e=a.select(this);var n=e.select("path.surface");n.transition().attrTween("d",(function(e){var a=le(e,t,r,[o,s]);return function(e){return i(a(e))}}));var l=e.select("g.slicetext");l.attr("opacity",0)})).remove()}else{e.exit().remove()}};var he=function(e){var t=e.transform;if(e.x0!==e.x1&&e.y0!==e.y1){f(y.type,t,m)}return o.getTextTransform({textX:t.textX,textY:t.textY,anchorX:t.anchorX,anchorY:t.anchorY,targetX:t.targetX,targetY:t.targetY,scale:t.scale,rotate:t.rotate})};if(S){k.each((function(e){U[v(e)]={x0:e.x0,x1:e.x1,y0:e.y0,y1:e.y1};if(e.transform){U[v(e)].transform={textX:e.transform.textX,textY:e.transform.textY,anchorX:e.transform.anchorX,anchorY:e.transform.anchorY,targetX:e.transform.targetX,targetY:e.transform.targetY,scale:e.transform.scale,rotate:e.transform.rotate}}}));M.each((function(e){V[v(e)]={x0:e.x0,x1:e.x1,y0:e.y0,y1:e.y1};if(e.transform){V[v(e)].transform={textX:e.transform.textX,textY:e.transform.textY,anchorX:e.transform.anchorX,anchorY:e.transform.anchorY,targetX:e.transform.targetX,targetY:e.transform.targetY,scale:e.transform.scale,rotate:e.transform.rotate}}if(!j&&i.isEntry(e)){j=e}}))}H=d(t,r,w,M,{width:P,height:O,viewX:X,viewY:Z,pathSlice:ie,toMoveInsideSlice:oe,prevEntry:j,makeUpdateSliceInterpolator:ue,makeUpdateTextInterpolator:ce,handleSlicesExit:fe,hasTransition:S,strTransform:he});if(y.pathbar.visible){p(t,r,w,k,{barDifY:F,width:z,height:D,viewX:Q,viewY:$,pathSlice:ne,toMoveInsideSlice:oe,makeUpdateSliceInterpolator:ue,makeUpdateTextInterpolator:ce,handleSlicesExit:fe,hasTransition:S,strTransform:he})}else{k.remove()}}},{"../../lib":787,"../bar/constants":927,"../bar/plot":936,"../bar/uniform_text":941,"../sunburst/helpers":1320,"./constants":1343,"./draw_ancestors":1346,"@plotly/d3":58,"d3-interpolate":168}],1355:[function(e,t,r){"use strict";var a=e("@plotly/d3");var n=e("../../components/color");var i=e("../../lib");var o=e("../sunburst/helpers");var s=e("../bar/uniform_text").resizeText;function l(e){var t=e._fullLayout._treemaplayer.selectAll(".trace");s(e,t,"treemap");t.each((function(e){var t=a.select(this);var r=e[0];var n=r.trace;t.style("opacity",n.opacity);t.selectAll("path.surface").each((function(e){a.select(this).call(u,e,n,{hovered:false})}))}))}function u(e,t,r,a){var s=(a||{}).hovered;var l=t.data.data;var u=l.i;var c;var f;var h=l.color;var p=o.isHierarchyRoot(t);var v=1;if(s){c=r._hovered.marker.line.color;f=r._hovered.marker.line.width}else{if(p&&h===r.root.color){v=100;c="rgba(0,0,0,0)";f=0}else{c=i.castOption(r,u,"marker.line.color")||n.defaultLine;f=i.castOption(r,u,"marker.line.width")||0;if(!r._hasColorscale&&!t.onPathbar){var d=r.marker.depthfade;if(d){var m=n.combine(n.addOpacity(r._backgroundColor,.75),h);var g;if(d===true){var y=o.getMaxDepth(r);if(isFinite(y)){if(o.isLeaf(t)){g=0}else{g=r._maxVisibleLayers-(t.data.depth-r._entryDepth)}}else{g=t.data.height+1}}else{g=t.data.depth-r._entryDepth;if(!r._atRootLevel)g++}if(g>0){for(var x=0;x<g;x++){var b=.5*x/g;h=n.combine(n.addOpacity(m,b),h)}}}}}}e.style("stroke-width",f).call(n.fill,h).call(n.stroke,c).style("opacity",v)}t.exports={style:l,styleOne:u}},{"../../components/color":650,"../../lib":787,"../bar/uniform_text":941,"../sunburst/helpers":1320,"@plotly/d3":58}],1356:[function(e,t,r){"use strict";var a=e("../box/attributes");var n=e("../../lib/extend").extendFlat;var i=e("../../plots/cartesian/axis_format_attributes").axisHoverFormat;t.exports={y:a.y,x:a.x,x0:a.x0,y0:a.y0,xhoverformat:i("x"),yhoverformat:i("y"),name:n({},a.name,{}),orientation:n({},a.orientation,{}),bandwidth:{valType:"number",min:0,editType:"calc"},scalegroup:{valType:"string",dflt:"",editType:"calc"},scalemode:{valType:"enumerated",values:["width","count"],dflt:"width",editType:"calc"},spanmode:{valType:"enumerated",values:["soft","hard","manual"],dflt:"soft",editType:"calc"},span:{valType:"info_array",items:[{valType:"any",editType:"calc"},{valType:"any",editType:"calc"}],editType:"calc"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,dflt:2,editType:"style"},editType:"plot"},fillcolor:a.fillcolor,points:n({},a.boxpoints,{}),jitter:n({},a.jitter,{}),pointpos:n({},a.pointpos,{}),width:n({},a.width,{}),marker:a.marker,text:a.text,hovertext:a.hovertext,hovertemplate:a.hovertemplate,box:{visible:{valType:"boolean",dflt:false,editType:"plot"},width:{valType:"number",min:0,max:1,dflt:.25,editType:"plot"},fillcolor:{valType:"color",editType:"style"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,editType:"style"},editType:"style"},editType:"plot"},meanline:{visible:{valType:"boolean",dflt:false,editType:"plot"},color:{valType:"color",editType:"style"},width:{valType:"number",min:0,editType:"style"},editType:"plot"},side:{valType:"enumerated",values:["both","positive","negative"],dflt:"both",editType:"calc"},offsetgroup:a.offsetgroup,alignmentgroup:a.alignmentgroup,selected:a.selected,unselected:a.unselected,hoveron:{valType:"flaglist",flags:["violins","points","kde"],dflt:"violins+points+kde",extras:["all"],editType:"style"}}},{"../../lib/extend":777,"../../plots/cartesian/axis_format_attributes":841,"../box/attributes":950}],1357:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("../../plots/cartesian/axes");var i=e("../box/calc");var o=e("./helpers");var s=e("../../constants/numerical").BADNUM;t.exports=function e(t,r){var s=i(t,r);if(s[0].t.empty)return s;var l=t._fullLayout;var f=n.getFromId(t,r[r.orientation==="h"?"xaxis":"yaxis"]);var h=Infinity;var p=-Infinity;var v=0;var d=0;for(var m=0;m<s.length;m++){var g=s[m];var y=g.pts.map(o.extractVal);var x=g.bandwidth=u(r,g,y);var b=g.span=c(r,g,f,x);if(g.min===g.max&&x===0){b=g.span=[g.min,g.max];g.density=[{v:1,t:b[0]}];g.bandwidth=x;v=Math.max(v,1)}else{var _=b[1]-b[0];var w=Math.ceil(_/(x/3));var T=_/w;if(!isFinite(T)||!isFinite(w)){a.error("Something went wrong with computing the violin span");s[0].t.empty=true;return s}var k=o.makeKDE(g,r,y);g.density=new Array(w);for(var M=0,A=b[0];A<b[1]+T/2;M++,A+=T){var S=k(A);g.density[M]={v:S,t:A};v=Math.max(v,S)}}d=Math.max(d,y.length);h=Math.min(h,b[0]);p=Math.max(p,b[1])}var E=n.findExtremes(f,[h,p],{padded:true});r._extremes[f._id]=E;if(r.width){s[0].t.maxKDE=v}else{var L=l._violinScaleGroupStats;var C=r.scalegroup;var I=L[C];if(I){I.maxKDE=Math.max(I.maxKDE,v);I.maxCount=Math.max(I.maxCount,d)}else{L[C]={maxKDE:v,maxCount:d}}}s[0].t.labels.kde=a._(t,"kde:");return s};function l(e,t,r){var a=Math.min(t,r/1.349);return 1.059*a*Math.pow(e,-.2)}function u(e,t,r){var n=t.max-t.min;if(!n){if(e.bandwidth){return e.bandwidth}else{return 0}}if(e.bandwidth){return Math.max(e.bandwidth,n/1e4)}else{var i=r.length;var o=a.stdev(r,i-1,t.mean);return Math.max(l(i,o,t.q3-t.q1),n/100)}}function c(e,t,r,a){var i=e.spanmode;var o=e.span||[];var l=[t.min,t.max];var u=[t.min-2*a,t.max+2*a];var c;function f(a){var n=o[a];var i=r.type==="multicategory"?r.r2c(n):r.d2c(n,0,e[t.valLetter+"calendar"]);return i===s?u[a]:i}if(i==="soft"){c=u}else if(i==="hard"){c=l}else{c=[f(0),f(1)]}var h={type:"linear",range:c};n.setConvert(h);h.cleanRange();return c}},{"../../constants/numerical":763,"../../lib":787,"../../plots/cartesian/axes":838,"../box/calc":951,"./helpers":1360}],1358:[function(e,t,r){"use strict";var a=e("../box/cross_trace_calc").setPositionOffset;var n=["v","h"];t.exports=function e(t,r){var i=t.calcdata;var o=r.xaxis;var s=r.yaxis;for(var l=0;l<n.length;l++){var u=n[l];var c=u==="h"?s:o;var f=[];for(var h=0;h<i.length;h++){var p=i[h];var v=p[0].t;var d=p[0].trace;if(d.visible===true&&d.type==="violin"&&!v.empty&&d.orientation===u&&d.xaxis===o._id&&d.yaxis===s._id){f.push(h)}}a("violin",t,f,c)}}},{"../box/cross_trace_calc":952}],1359:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("../../components/color");var i=e("../box/defaults");var o=e("./attributes");t.exports=function e(t,r,s,l){function u(e,n){return a.coerce(t,r,o,e,n)}function c(e,n){return a.coerce2(t,r,o,e,n)}i.handleSampleDefaults(t,r,u,l);if(r.visible===false)return;u("bandwidth");u("side");var f=u("width");if(!f){u("scalegroup",r.name);u("scalemode")}var h=u("span");var p;if(Array.isArray(h))p="manual";u("spanmode",p);var v=u("line.color",(t.marker||{}).color||s);var d=u("line.width");var m=u("fillcolor",n.addOpacity(r.line.color,.5));i.handlePointsDefaults(t,r,u,{prefix:""});var g=c("box.width");var y=c("box.fillcolor",m);var x=c("box.line.color",v);var b=c("box.line.width",d);var _=u("box.visible",Boolean(g||y||x||b));if(!_)r.box={visible:false};var w=c("meanline.color",v);var T=c("meanline.width",d);var k=u("meanline.visible",Boolean(w||T));if(!k)r.meanline={visible:false}}},{"../../components/color":650,"../../lib":787,"../box/defaults":953,"./attributes":1356}],1360:[function(e,t,r){"use strict";var a=e("../../lib");var n={gaussian:function(e){return 1/Math.sqrt(2*Math.PI)*Math.exp(-.5*e*e)}};r.makeKDE=function(e,t,r){var a=r.length;var i=n.gaussian;var o=e.bandwidth;var s=1/(a*o);return function(e){var t=0;for(var n=0;n<a;n++){t+=i((e-r[n])/o)}return s*t}};r.getPositionOnKdePath=function(e,t,r){var n,i;if(t.orientation==="h"){n="y";i="x"}else{n="x";i="y"}var o=a.findPointOnPath(e.path,r,i,{pathLength:e.pathLength});var s=e.posCenterPx;var l=o[n];var u=t.side==="both"?2*s-l:s;return[l,u]};r.getKdeValue=function(e,t,a){var n=e.pts.map(r.extractVal);var i=r.makeKDE(e,t,n);return i(a)/e.posDensityScale};r.extractVal=function(e){return e.v}},{"../../lib":787}],1361:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("../../plots/cartesian/axes");var i=e("../box/hover");var o=e("./helpers");t.exports=function e(t,r,s,l,u){if(!u)u={};var c=u.hoverLayer;var f=t.cd;var h=f[0].trace;var p=h.hoveron;var v=p.indexOf("violins")!==-1;var d=p.indexOf("kde")!==-1;var m=[];var g;var y;if(v||d){var x=i.hoverOnBoxes(t,r,s,l);if(d&&x.length>0){var b=t.xa;var _=t.ya;var w,T,k,M,A;if(h.orientation==="h"){A=r;w="y";k=_;T="x";M=b}else{A=s;w="x";k=b;T="y";M=_}var S=f[t.index];if(A>=S.span[0]&&A<=S.span[1]){var E=a.extendFlat({},t);var L=M.c2p(A,true);var C=o.getKdeValue(S,h,A);var I=o.getPositionOnKdePath(S,h,L);var P=k._offset;var O=k._length;E[w+"0"]=I[0];E[w+"1"]=I[1];E[T+"0"]=E[T+"1"]=L;E[T+"Label"]=T+": "+n.hoverLabelText(M,A,h[T+"hoverformat"])+", "+f[0].t.labels.kde+" "+C.toFixed(3);E.spikeDistance=x[0].spikeDistance;var z=w+"Spike";E[z]=x[0][z];x[0].spikeDistance=undefined;x[0][z]=undefined;E.hovertemplate=false;m.push(E);y={stroke:t.color};y[w+"1"]=a.constrain(P+I[0],P,P+O);y[w+"2"]=a.constrain(P+I[1],P,P+O);y[T+"1"]=y[T+"2"]=M._offset+L}}if(v){m=m.concat(x)}}if(p.indexOf("points")!==-1){g=i.hoverOnPoints(t,r,s)}var D=c.selectAll(".violinline-"+h.uid).data(y?[0]:[]);D.enter().append("line").classed("violinline-"+h.uid,true).attr("stroke-width",1.5);D.exit().remove();D.attr(y);if(l==="closest"){if(g)return[g];return m}if(g){m.push(g);return m}return m}},{"../../lib":787,"../../plots/cartesian/axes":838,"../box/hover":955,"./helpers":1360}],1362:[function(e,t,r){"use strict";t.exports={attributes:e("./attributes"),layoutAttributes:e("./layout_attributes"),supplyDefaults:e("./defaults"),crossTraceDefaults:e("../box/defaults").crossTraceDefaults,supplyLayoutDefaults:e("./layout_defaults"),calc:e("./calc"),crossTraceCalc:e("./cross_trace_calc"),plot:e("./plot"),style:e("./style"),styleOnSelect:e("../scatter/style").styleOnSelect,hoverPoints:e("./hover"),selectPoints:e("../box/select"),moduleType:"trace",name:"violin",basePlotModule:e("../../plots/cartesian"),categories:["cartesian","svg","symbols","oriented","box-violin","showLegend","violinLayout","zoomScale"],meta:{}}},{"../../plots/cartesian":852,"../box/defaults":953,"../box/select":960,"../scatter/style":1226,"./attributes":1356,"./calc":1357,"./cross_trace_calc":1358,"./defaults":1359,"./hover":1361,"./layout_attributes":1363,"./layout_defaults":1364,"./plot":1365,"./style":1366}],1363:[function(e,t,r){"use strict";var a=e("../box/layout_attributes");var n=e("../../lib").extendFlat;t.exports={violinmode:n({},a.boxmode,{}),violingap:n({},a.boxgap,{}),violingroupgap:n({},a.boxgroupgap,{})}},{"../../lib":787,"../box/layout_attributes":957}],1364:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("./layout_attributes");var i=e("../box/layout_defaults");t.exports=function e(t,r,o){function s(e,i){return a.coerce(t,r,n,e,i)}i._supply(t,r,o,s,"violin")}},{"../../lib":787,"../box/layout_defaults":958,"./layout_attributes":1363}],1365:[function(e,t,r){"use strict";var a=e("@plotly/d3");var n=e("../../lib");var i=e("../../components/drawing");var o=e("../box/plot");var s=e("../scatter/line_points");var l=e("./helpers");t.exports=function e(t,r,u,c){var f=t._fullLayout;var h=r.xaxis;var p=r.yaxis;function v(e){var t=s(e,{xaxis:h,yaxis:p,connectGaps:true,baseTolerance:.75,shape:"spline",simplify:true,linearized:true});return i.smoothopen(t[0],1)}n.makeTraceGroups(c,u,"trace violins").each((function(e){var t=a.select(this);var i=e[0];var s=i.t;var u=i.trace;if(u.visible!==true||s.empty){t.remove();return}var c=s.bPos;var d=s.bdPos;var m=r[s.valLetter+"axis"];var g=r[s.posLetter+"axis"];var y=u.side==="both";var x=y||u.side==="positive";var b=y||u.side==="negative";var _=t.selectAll("path.violin").data(n.identity);_.enter().append("path").style("vector-effect","non-scaling-stroke").attr("class","violin");_.exit().remove();_.each((function(e){var t=a.select(this);var r=e.density;var n=r.length;var i=g.c2l(e.pos+c,true);var o=g.l2p(i);var l;if(u.width){l=s.maxKDE/d}else{var h=f._violinScaleGroupStats[u.scalegroup];l=u.scalemode==="count"?h.maxKDE/d*(h.maxCount/e.pts.length):h.maxKDE/d}var p,_,w;var T,k,M,A;if(x){M=new Array(n);for(T=0;T<n;T++){A=M[T]={};A[s.posLetter]=i+r[T].v/l;A[s.valLetter]=m.c2l(r[T].t,true)}p=v(M)}if(b){M=new Array(n);for(k=0,T=n-1;k<n;k++,T--){A=M[k]={};A[s.posLetter]=i-r[T].v/l;A[s.valLetter]=m.c2l(r[T].t,true)}_=v(M)}if(y){w=p+"L"+_.substr(1)+"Z"}else{var S=[o,m.c2p(r[0].t)];var E=[o,m.c2p(r[n-1].t)];if(u.orientation==="h"){S.reverse();E.reverse()}if(x){w="M"+S+"L"+p.substr(1)+"L"+E}else{w="M"+E+"L"+_.substr(1)+"L"+S}}t.attr("d",w);e.posCenterPx=o;e.posDensityScale=l*d;e.path=t.node();e.pathLength=e.path.getTotalLength()/(y?2:1)}));var w=u.box;var T=w.width;var k=(w.line||{}).width;var M;var A;if(y){M=d*T;A=0}else if(x){M=[0,d*T/2];A=k*{x:1,y:-1}[s.posLetter]}else{M=[d*T/2,0];A=k*{x:-1,y:1}[s.posLetter]}o.plotBoxAndWhiskers(t,{pos:g,val:m},u,{bPos:c,bdPos:M,bPosPxOffset:A});o.plotBoxMean(t,{pos:g,val:m},u,{bPos:c,bdPos:M,bPosPxOffset:A});var S;if(!u.box.visible&&u.meanline.visible){S=n.identity}var E=t.selectAll("path.meanline").data(S||[]);E.enter().append("path").attr("class","meanline").style("fill","none").style("vector-effect","non-scaling-stroke");E.exit().remove();E.each((function(e){var t=m.c2p(e.mean,true);var r=l.getPositionOnKdePath(e,u,t);a.select(this).attr("d",u.orientation==="h"?"M"+t+","+r[0]+"V"+r[1]:"M"+r[0]+","+t+"H"+r[1])}));o.plotPoints(t,{x:h,y:p},u,s)}))}},{"../../components/drawing":672,"../../lib":787,"../box/plot":959,"../scatter/line_points":1216,"./helpers":1360,"@plotly/d3":58}],1366:[function(e,t,r){"use strict";var a=e("@plotly/d3");var n=e("../../components/color");var i=e("../scatter/style").stylePoints;t.exports=function e(t){var r=a.select(t).selectAll("g.trace.violins");r.style("opacity",(function(e){return e[0].trace.opacity}));r.each((function(e){var r=e[0].trace;var o=a.select(this);var s=r.box||{};var l=s.line||{};var u=r.meanline||{};var c=u.width;o.selectAll("path.violin").style("stroke-width",r.line.width+"px").call(n.stroke,r.line.color).call(n.fill,r.fillcolor);o.selectAll("path.box").style("stroke-width",l.width+"px").call(n.stroke,l.color).call(n.fill,s.fillcolor);var f={"stroke-width":c+"px","stroke-dasharray":2*c+"px,"+c+"px"};o.selectAll("path.mean").style(f).call(n.stroke,u.color);o.selectAll("path.meanline").style(f).call(n.stroke,u.color);i(o,r,t)}))}},{"../../components/color":650,"../scatter/style":1226,"@plotly/d3":58}],1367:[function(e,t,r){"use strict";var a=e("../../components/colorscale/attributes");var n=e("../isosurface/attributes");var i=e("../surface/attributes");var o=e("../../plots/attributes");var s=e("../../lib/extend").extendFlat;var l=e("../../plot_api/edit_types").overrideAll;var u=t.exports=l(s({x:n.x,y:n.y,z:n.z,value:n.value,isomin:n.isomin,isomax:n.isomax,surface:n.surface,spaceframe:{show:{valType:"boolean",dflt:false},fill:{valType:"number",min:0,max:1,dflt:1}},slices:n.slices,caps:n.caps,text:n.text,hovertext:n.hovertext,xhoverformat:n.xhoverformat,yhoverformat:n.yhoverformat,zhoverformat:n.zhoverformat,valuehoverformat:n.valuehoverformat,hovertemplate:n.hovertemplate},a("",{colorAttr:"`value`",showScaleDflt:true,editTypeOverride:"calc"}),{colorbar:n.colorbar,opacity:n.opacity,opacityscale:i.opacityscale,lightposition:n.lightposition,lighting:n.lighting,flatshading:n.flatshading,contour:n.contour,hoverinfo:s({},o.hoverinfo),showlegend:s({},o.showlegend,{dflt:false})}),"calc","nested");u.x.editType=u.y.editType=u.z.editType=u.value.editType="calc+clearAxisTypes";u.transforms=undefined},{"../../components/colorscale/attributes":657,"../../lib/extend":777,"../../plot_api/edit_types":820,"../../plots/attributes":834,"../isosurface/attributes":1138,"../surface/attributes":1326}],1368:[function(e,t,r){"use strict";var a=e("gl-mesh3d");var n=e("../../lib/gl_format_color").parseColorScale;var i=e("../../lib/str2rgbarray");var o=e("../../components/colorscale").extractOpts;var s=e("../../plots/gl3d/zip3");var l=e("../isosurface/convert").findNearestOnAxis;var u=e("../isosurface/convert").generateIsoMeshes;function c(e,t,r){this.scene=e;this.uid=r;this.mesh=t;this.name="";this.data=null;this.showContour=false}var f=c.prototype;f.handlePick=function(e){if(e.object===this.mesh){var t=e.data.index;var r=this.data._meshX[t];var a=this.data._meshY[t];var n=this.data._meshZ[t];var i=this.data._Ys.length;var o=this.data._Zs.length;var s=l(r,this.data._Xs).id;var u=l(a,this.data._Ys).id;var c=l(n,this.data._Zs).id;var f=e.index=c+o*u+o*i*s;e.traceCoordinate=[this.data._meshX[f],this.data._meshY[f],this.data._meshZ[f],this.data._value[f]];var h=this.data.hovertext||this.data.text;if(Array.isArray(h)&&h[f]!==undefined){e.textLabel=h[f]}else if(h){e.textLabel=h}return true}};f.update=function(e){var t=this.scene;var r=t.fullSceneLayout;this.data=u(e);function a(e,t,r,a){return t.map((function(t){return e.d2l(t,0,a)*r}))}var l=s(a(r.xaxis,e._meshX,t.dataScale[0],e.xcalendar),a(r.yaxis,e._meshY,t.dataScale[1],e.ycalendar),a(r.zaxis,e._meshZ,t.dataScale[2],e.zcalendar));var c=s(e._meshI,e._meshJ,e._meshK);var f={positions:l,cells:c,lightPosition:[e.lightposition.x,e.lightposition.y,e.lightposition.z],ambient:e.lighting.ambient,diffuse:e.lighting.diffuse,specular:e.lighting.specular,roughness:e.lighting.roughness,fresnel:e.lighting.fresnel,vertexNormalsEpsilon:e.lighting.vertexnormalsepsilon,faceNormalsEpsilon:e.lighting.facenormalsepsilon,opacity:e.opacity,opacityscale:e.opacityscale,contourEnable:e.contour.show,contourColor:i(e.contour.color).slice(0,3),contourWidth:e.contour.width,useFacetNormals:e.flatshading};var h=o(e);f.vertexIntensity=e._meshIntensity;f.vertexIntensityBounds=[h.min,h.max];f.colormap=n(e);this.mesh.update(f)};f.dispose=function(){this.scene.glplot.remove(this.mesh);this.mesh.dispose()};function h(e,t){var r=e.glplot.gl;var n=a({gl:r});var i=new c(e,n,t.uid);n._trace=i;i.update(t);e.glplot.add(n);return i}t.exports=h},{"../../components/colorscale":662,"../../lib/gl_format_color":783,"../../lib/str2rgbarray":812,"../../plots/gl3d/zip3":891,"../isosurface/convert":1140,"gl-mesh3d":309}],1369:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("./attributes");var i=e("../isosurface/defaults").supplyIsoDefaults;var o=e("../surface/defaults").opacityscaleDefaults;t.exports=function e(t,r,s,l){function u(e,i){return a.coerce(t,r,n,e,i)}i(t,r,s,l,u);o(t,r,l,u)}},{"../../lib":787,"../isosurface/defaults":1141,"../surface/defaults":1329,"./attributes":1367}],1370:[function(e,t,r){"use strict";t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),calc:e("../isosurface/calc"),colorbar:{min:"cmin",max:"cmax"},plot:e("./convert"),moduleType:"trace",name:"volume",basePlotModule:e("../../plots/gl3d"),categories:["gl3d","showLegend"],meta:{}}},{"../../plots/gl3d":880,"../isosurface/calc":1139,"./attributes":1367,"./convert":1368,"./defaults":1369}],1371:[function(e,t,r){"use strict";var a=e("../bar/attributes");var n=e("../scatter/attributes").line;var i=e("../../plots/attributes");var o=e("../../plots/cartesian/axis_format_attributes").axisHoverFormat;var s=e("../../plots/template_attributes").hovertemplateAttrs;var l=e("../../plots/template_attributes").texttemplateAttrs;var u=e("./constants");var c=e("../../lib/extend").extendFlat;var f=e("../../components/color");function h(e){return{marker:{color:c({},a.marker.color,{arrayOk:false,editType:"style"}),line:{color:c({},a.marker.line.color,{arrayOk:false,editType:"style"}),width:c({},a.marker.line.width,{arrayOk:false,editType:"style"}),editType:"style"},editType:"style"},editType:"style"}}t.exports={measure:{valType:"data_array",dflt:[],editType:"calc"},base:{valType:"number",dflt:null,arrayOk:false,editType:"calc"},x:a.x,x0:a.x0,dx:a.dx,y:a.y,y0:a.y0,dy:a.dy,xperiod:a.xperiod,yperiod:a.yperiod,xperiod0:a.xperiod0,yperiod0:a.yperiod0,xperiodalignment:a.xperiodalignment,yperiodalignment:a.yperiodalignment,xhoverformat:o("x"),yhoverformat:o("y"),hovertext:a.hovertext,hovertemplate:s({},{keys:u.eventDataKeys}),hoverinfo:c({},i.hoverinfo,{flags:["name","x","y","text","initial","delta","final"]}),textinfo:{valType:"flaglist",flags:["label","text","initial","delta","final"],extras:["none"],editType:"plot",arrayOk:false},texttemplate:l({editType:"plot"},{keys:u.eventDataKeys.concat(["label"])}),text:a.text,textposition:a.textposition,insidetextanchor:a.insidetextanchor,textangle:a.textangle,textfont:a.textfont,insidetextfont:a.insidetextfont,outsidetextfont:a.outsidetextfont,constraintext:a.constraintext,cliponaxis:a.cliponaxis,orientation:a.orientation,offset:a.offset,width:a.width,increasing:h("increasing"),decreasing:h("decreasing"),totals:h("intermediate sums and total"),connector:{line:{color:c({},n.color,{dflt:f.defaultLine}),width:c({},n.width,{editType:"plot"}),dash:n.dash,editType:"plot"},mode:{valType:"enumerated",values:["spanning","between"],dflt:"between",editType:"plot"},visible:{valType:"boolean",dflt:true,editType:"plot"},editType:"plot"},offsetgroup:a.offsetgroup,alignmentgroup:a.alignmentgroup}},{"../../components/color":650,"../../lib/extend":777,"../../plots/attributes":834,"../../plots/cartesian/axis_format_attributes":841,"../../plots/template_attributes":910,"../bar/attributes":925,"../scatter/attributes":1202,"./constants":1373}],1372:[function(e,t,r){"use strict";var a=e("../../plots/cartesian/axes");var n=e("../../plots/cartesian/align_period");var i=e("../../lib").mergeArray;var o=e("../scatter/calc_selection");var s=e("../../constants/numerical").BADNUM;function l(e){return e==="a"||e==="absolute"}function u(e){return e==="t"||e==="total"}t.exports=function e(t,r){var c=a.getFromId(t,r.xaxis||"x");var f=a.getFromId(t,r.yaxis||"y");var h,p,v,d,m,g;if(r.orientation==="h"){h=c.makeCalcdata(r,"x");v=f.makeCalcdata(r,"y");d=n(r,f,"y",v);m=!!r.yperiodalignment;g="y"}else{h=f.makeCalcdata(r,"y");v=c.makeCalcdata(r,"x");d=n(r,c,"x",v);m=!!r.xperiodalignment;g="x"}p=d.vals;var y=Math.min(p.length,h.length);var x=new Array(y);var b=0;var _;var w=false;for(var T=0;T<y;T++){var k=h[T]||0;var M=false;if(h[T]!==s||u(r.measure[T])||l(r.measure[T])){if(T+1<y&&(h[T+1]!==s||u(r.measure[T+1])||l(r.measure[T+1]))){M=true}}var A=x[T]={i:T,p:p[T],s:k,rawS:k,cNext:M};if(l(r.measure[T])){b=A.s;A.isSum=true;A.dir="totals";A.s=b}else if(u(r.measure[T])){A.isSum=true;A.dir="totals";A.s=b}else{A.isSum=false;A.dir=A.rawS<0?"decreasing":"increasing";_=A.s;A.s=b+_;b+=_}if(A.dir==="totals"){w=true}if(m){x[T].orig_p=v[T];x[T][g+"End"]=d.ends[T];x[T][g+"Start"]=d.starts[T]}if(r.ids){A.id=String(r.ids[T])}A.v=(r.base||0)+b}if(x.length)x[0].hasTotals=w;i(r.text,x,"tx");i(r.hovertext,x,"htx");o(x,r);return x}},{"../../constants/numerical":763,"../../lib":787,"../../plots/cartesian/align_period":835,"../../plots/cartesian/axes":838,"../scatter/calc_selection":1204}],1373:[function(e,t,r){"use strict";t.exports={eventDataKeys:["initial","delta","final"]}},{}],1374:[function(e,t,r){"use strict";var a=e("../bar/cross_trace_calc").setGroupPositions;t.exports=function e(t,r){var n=t._fullLayout;var i=t._fullData;var o=t.calcdata;var s=r.xaxis;var l=r.yaxis;var u=[];var c=[];var f=[];var h,p;for(p=0;p<i.length;p++){var v=i[p];if(v.visible===true&&v.xaxis===s._id&&v.yaxis===l._id&&v.type==="waterfall"){h=o[p];if(v.orientation==="h"){f.push(h)}else{c.push(h)}u.push(h)}}var d={mode:n.waterfallmode,norm:n.waterfallnorm,gap:n.waterfallgap,groupgap:n.waterfallgroupgap};a(t,s,l,c,d);a(t,l,s,f,d);for(p=0;p<u.length;p++){h=u[p];for(var m=0;m<h.length;m++){var g=h[m];if(g.isSum===false){g.s0+=m===0?0:h[m-1].s}if(m+1<h.length){h[m].nextP0=h[m+1].p0;h[m].nextS0=h[m+1].s0}}}}},{"../bar/cross_trace_calc":928}],1375:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("../bar/defaults").handleGroupingDefaults;var i=e("../bar/defaults").handleText;var o=e("../scatter/xy_defaults");var s=e("../scatter/period_defaults");var l=e("./attributes");var u=e("../../components/color");var c=e("../../constants/delta.js");var f=c.INCREASING.COLOR;var h=c.DECREASING.COLOR;var p="#4499FF";function v(e,t,r){e(t+".marker.color",r);e(t+".marker.line.color",u.defaultLine);e(t+".marker.line.width")}function d(e,t,r,n){function u(r,n){return a.coerce(e,t,l,r,n)}var c=o(e,t,n,u);if(!c){t.visible=false;return}s(e,t,n,u);u("xhoverformat");u("yhoverformat");u("measure");u("orientation",t.x&&!t.y?"h":"v");u("base");u("offset");u("width");u("text");u("hovertext");u("hovertemplate");var d=u("textposition");i(e,t,n,u,d,{moduleHasSelected:false,moduleHasUnselected:false,moduleHasConstrain:true,moduleHasCliponaxis:true,moduleHasTextangle:true,moduleHasInsideanchor:true});if(t.textposition!=="none"){u("texttemplate");if(!t.texttemplate)u("textinfo")}v(u,"increasing",f);v(u,"decreasing",h);v(u,"totals",p);var m=u("connector.visible");if(m){u("connector.mode");var g=u("connector.line.width");if(g){u("connector.line.color");u("connector.line.dash")}}}function m(e,t){var r,i;function o(e){return a.coerce(i._input,i,l,e)}if(t.waterfallmode==="group"){for(var s=0;s<e.length;s++){i=e[s];r=i._input;n(r,i,t,o)}}}t.exports={supplyDefaults:d,crossTraceDefaults:m}},{"../../components/color":650,"../../constants/delta.js":757,"../../lib":787,"../bar/defaults":929,"../scatter/period_defaults":1222,"../scatter/xy_defaults":1229,"./attributes":1371}],1376:[function(e,t,r){"use strict";t.exports=function e(t,r){t.x="xVal"in r?r.xVal:r.x;t.y="yVal"in r?r.yVal:r.y;if("initial"in r)t.initial=r.initial;if("delta"in r)t.delta=r.delta;if("final"in r)t.final=r.final;if(r.xa)t.xaxis=r.xa;if(r.ya)t.yaxis=r.ya;return t}},{}],1377:[function(e,t,r){"use strict";var a=e("../../plots/cartesian/axes").hoverLabelText;var n=e("../../components/color").opacity;var i=e("../bar/hover").hoverOnBars;var o=e("../../constants/delta.js");var s={increasing:o.INCREASING.SYMBOL,decreasing:o.DECREASING.SYMBOL};t.exports=function e(t,r,n,o,u){var c=i(t,r,n,o,u);if(!c)return;var f=c.cd;var h=f[0].trace;var p=h.orientation==="h";var v=p?"x":"y";var d=p?t.xa:t.ya;function m(e){return a(d,e,h[v+"hoverformat"])}var g=c.index;var y=f[g];var x=y.isSum?y.b+y.s:y.rawS;if(!y.isSum){c.initial=y.b+y.s-x;c.delta=x;c.final=c.initial+c.delta;var b=m(Math.abs(c.delta));c.deltaLabel=x<0?"("+b+")":b;c.finalLabel=m(c.final);c.initialLabel=m(c.initial)}var _=y.hi||h.hoverinfo;var w=[];if(_&&_!=="none"&&_!=="skip"){var T=_==="all";var k=_.split("+");var M=function(e){return T||k.indexOf(e)!==-1};if(!y.isSum){if(M("final")&&(p?!M("x"):!M("y"))){w.push(c.finalLabel)}if(M("delta")){if(x<0){w.push(c.deltaLabel+" "+s.decreasing)}else{w.push(c.deltaLabel+" "+s.increasing)}}if(M("initial")){w.push("Initial: "+c.initialLabel)}}}if(w.length)c.extraText=w.join("<br>");c.color=l(h,y);return[c]};function l(e,t){var r=e[t.dir].marker;var a=r.color;var i=r.line.color;var o=r.line.width;if(n(a))return a;else if(n(i)&&o)return i}},{"../../components/color":650,"../../constants/delta.js":757,"../../plots/cartesian/axes":838,"../bar/hover":932}],1378:[function(e,t,r){"use strict";t.exports={attributes:e("./attributes"),layoutAttributes:e("./layout_attributes"),supplyDefaults:e("./defaults").supplyDefaults,crossTraceDefaults:e("./defaults").crossTraceDefaults,supplyLayoutDefaults:e("./layout_defaults"),calc:e("./calc"),crossTraceCalc:e("./cross_trace_calc"),plot:e("./plot"),style:e("./style").style,hoverPoints:e("./hover"),eventData:e("./event_data"),selectPoints:e("../bar/select"),moduleType:"trace",name:"waterfall",basePlotModule:e("../../plots/cartesian"),categories:["bar-like","cartesian","svg","oriented","showLegend","zoomScale"],meta:{}}},{"../../plots/cartesian":852,"../bar/select":937,"./attributes":1371,"./calc":1372,"./cross_trace_calc":1374,"./defaults":1375,"./event_data":1376,"./hover":1377,"./layout_attributes":1379,"./layout_defaults":1380,"./plot":1381,"./style":1382}],1379:[function(e,t,r){"use strict";t.exports={waterfallmode:{valType:"enumerated",values:["group","overlay"],dflt:"group",editType:"calc"},waterfallgap:{valType:"number",min:0,max:1,editType:"calc"},waterfallgroupgap:{valType:"number",min:0,max:1,dflt:0,editType:"calc"}}},{}],1380:[function(e,t,r){"use strict";var a=e("../../lib");var n=e("./layout_attributes");t.exports=function(e,t,r){var i=false;function o(r,i){return a.coerce(e,t,n,r,i)}for(var s=0;s<r.length;s++){var l=r[s];if(l.visible&&l.type==="waterfall"){i=true;break}}if(i){o("waterfallmode");o("waterfallgap",.2);o("waterfallgroupgap")}}},{"../../lib":787,"./layout_attributes":1379}],1381:[function(e,t,r){"use strict";var a=e("@plotly/d3");var n=e("../../lib");var i=e("../../components/drawing");var o=e("../../constants/numerical").BADNUM;var s=e("../bar/plot");var l=e("../bar/uniform_text").clearMinTextSize;t.exports=function e(t,r,a,n){var i=t._fullLayout;l("waterfall",i);s.plot(t,r,a,n,{mode:i.waterfallmode,norm:i.waterfallmode,gap:i.waterfallgap,groupgap:i.waterfallgroupgap});u(t,r,a,n)};function u(e,t,r,s){var l=t.xaxis;var u=t.yaxis;n.makeTraceGroups(s,r,"trace bars").each((function(r){var s=a.select(this);var f=r[0].trace;var h=n.ensureSingle(s,"g","lines");if(!f.connector||!f.connector.visible){h.remove();return}var p=f.orientation==="h";var v=f.connector.mode;var d=h.selectAll("g.line").data(n.identity);d.enter().append("g").classed("line",true);d.exit().remove();var m=d.size();d.each((function(r,s){if(s!==m-1&&!r.cNext)return;var f=c(r,l,u,p);var h=f[0];var d=f[1];var g="";if(h[0]!==o&&d[0]!==o&&h[1]!==o&&d[1]!==o){if(v==="spanning"){if(!r.isSum&&s>0){if(p){g+="M"+h[0]+","+d[1]+"V"+d[0]}else{g+="M"+h[1]+","+d[0]+"H"+h[0]}}}if(v!=="between"){if(r.isSum||s<m-1){if(p){g+="M"+h[1]+","+d[0]+"V"+d[1]}else{g+="M"+h[0]+","+d[1]+"H"+h[1]}}}if(h[2]!==o&&d[2]!==o){if(p){g+="M"+h[1]+","+d[1]+"V"+d[2]}else{g+="M"+h[1]+","+d[1]+"H"+h[2]}}}if(g==="")g="M0,0Z";n.ensureSingle(a.select(this),"path").attr("d",g).call(i.setClipUrl,t.layerClipId,e)}))}))}function c(e,t,r,a){var n=[];var i=[];var o=a?t:r;var s=a?r:t;n[0]=o.c2p(e.s0,true);i[0]=s.c2p(e.p0,true);n[1]=o.c2p(e.s1,true);i[1]=s.c2p(e.p1,true);n[2]=o.c2p(e.nextS0,true);i[2]=s.c2p(e.nextP0,true);return a?[n,i]:[i,n]}},{"../../components/drawing":672,"../../constants/numerical":763,"../../lib":787,"../bar/plot":936,"../bar/uniform_text":941,"@plotly/d3":58}],1382:[function(e,t,r){"use strict";var a=e("@plotly/d3");var n=e("../../components/drawing");var i=e("../../components/color");var o=e("../../constants/interactions").DESELECTDIM;var s=e("../bar/style");var l=e("../bar/uniform_text").resizeText;var u=s.styleTextPoints;function c(e,t,r){var s=r?r:a.select(e).selectAll("g.waterfalllayer").selectAll("g.trace");l(e,s,"waterfall");s.style("opacity",(function(e){return e[0].trace.opacity}));s.each((function(t){var r=a.select(this);var s=t[0].trace;r.selectAll(".point > path").each((function(e){if(!e.isBlank){var t=s[e.dir].marker;a.select(this).call(i.fill,t.color).call(i.stroke,t.line.color).call(n.dashLine,t.line.dash,t.line.width).style("opacity",s.selectedpoints&&!e.selected?o:1)}}));u(r,s,e);r.selectAll(".lines").each((function(){var e=s.connector.line;n.lineGroupStyle(a.select(this).selectAll("path"),e.width,e.color,e.dash)}))}))}t.exports={style:c}},{"../../components/color":650,"../../components/drawing":672,"../../constants/interactions":762,"../bar/style":939,"../bar/uniform_text":941,"@plotly/d3":58}],1383:[function(e,t,r){"use strict";var a=e("../plots/cartesian/axes");var n=e("../lib");var i=e("../plot_api/plot_schema");var o=e("./helpers").pointsAccessorFunction;var s=e("../constants/numerical").BADNUM;r.moduleType="transform";r.name="aggregate";var l=r.attributes={enabled:{valType:"boolean",dflt:true,editType:"calc"},groups:{valType:"string",strict:true,noBlank:true,arrayOk:true,dflt:"x",editType:"calc"},aggregations:{_isLinkedToArray:"aggregation",target:{valType:"string",editType:"calc"},func:{valType:"enumerated",values:["count","sum","avg","median","mode","rms","stddev","min","max","first","last","change","range"],dflt:"first",editType:"calc"},funcmode:{valType:"enumerated",values:["sample","population"],dflt:"sample",editType:"calc"},enabled:{valType:"boolean",dflt:true,editType:"calc"},editType:"calc"},editType:"calc"};var u=l.aggregations;r.supplyDefaults=function(e,t){var r={};var a;function o(t,a){return n.coerce(e,r,l,t,a)}var s=o("enabled");if(!s)return r;var c=i.findArrayAttributes(t);var f={};for(a=0;a<c.length;a++)f[c[a]]=1;var h=o("groups");if(!Array.isArray(h)){if(!f[h]){r.enabled=false;return r}f[h]=0}var p=e.aggregations||[];var v=r.aggregations=new Array(p.length);var d;function m(e,t){return n.coerce(p[a],d,u,e,t)}for(a=0;a<p.length;a++){d={_index:a};var g=m("target");var y=m("func");var x=m("enabled");if(x&&g&&(f[g]||y==="count"&&f[g]===undefined)){if(y==="stddev")m("funcmode");f[g]=0;v[a]=d}else v[a]={enabled:false,_index:a}}for(a=0;a<c.length;a++){if(f[c[a]]){v.push({target:c[a],func:u.func.dflt,enabled:true,_index:-1})}}return r};r.calcTransform=function(e,t,r){if(!r.enabled)return;var a=r.groups;var i=n.getTargetArray(t,{target:a});if(!i)return;var s,l,u,f;var h={};var p={};var v=[];var d=o(t.transforms,r);var m=i.length;if(t._length)m=Math.min(m,t._length);for(s=0;s<m;s++){l=i[s];u=h[l];if(u===undefined){h[l]=v.length;f=[s];v.push(f);p[h[l]]=d(s)}else{v[u].push(s);p[h[l]]=(p[h[l]]||[]).concat(d(s))}}r._indexToPoints=p;var g=r.aggregations;for(s=0;s<g.length;s++){c(e,t,v,g[s])}if(typeof a==="string"){c(e,t,v,{target:a,func:"first",enabled:true})}t._length=v.length};function c(e,t,r,i){if(!i.enabled)return;var o=i.target;var s=n.nestedProperty(t,o);var l=s.get();var u=a.getDataConversions(e,t,o,l);var c=f(i,u);var h=new Array(r.length);for(var p=0;p<r.length;p++){h[p]=c(l,r[p])}s.set(h);if(i.func==="count"){n.pushUnique(t._arrayAttrs,o)}}function f(e,t){var r=e.func;var a=t.d2c;var i=t.c2d;switch(r){case"count":return h;case"first":return p;case"last":return v;case"sum":return function(e,t){var r=0;for(var n=0;n<t.length;n++){var o=a(e[t[n]]);if(o!==s)r+=o}return i(r)};case"avg":return function(e,t){var r=0;var n=0;for(var o=0;o<t.length;o++){var l=a(e[t[o]]);if(l!==s){r+=l;n++}}return n?i(r/n):s};case"min":return function(e,t){var r=Infinity;for(var n=0;n<t.length;n++){var o=a(e[t[n]]);if(o!==s)r=Math.min(r,o)}return r===Infinity?s:i(r)};case"max":return function(e,t){var r=-Infinity;for(var n=0;n<t.length;n++){var o=a(e[t[n]]);if(o!==s)r=Math.max(r,o)}return r===-Infinity?s:i(r)};case"range":return function(e,t){var r=Infinity;var n=-Infinity;for(var o=0;o<t.length;o++){var l=a(e[t[o]]);if(l!==s){r=Math.min(r,l);n=Math.max(n,l)}}return n===-Infinity||r===Infinity?s:i(n-r)};case"change":return function(e,t){var r=a(e[t[0]]);var n=a(e[t[t.length-1]]);return r===s||n===s?s:i(n-r)};case"median":return function(e,t){var r=[];for(var o=0;o<t.length;o++){var l=a(e[t[o]]);if(l!==s)r.push(l)}if(!r.length)return s;r.sort(n.sorterAsc);var u=(r.length-1)/2;return i((r[Math.floor(u)]+r[Math.ceil(u)])/2)};case"mode":return function(e,t){var r={};var n=0;var o=s;for(var l=0;l<t.length;l++){var u=a(e[t[l]]);if(u!==s){var c=r[u]=(r[u]||0)+1;if(c>n){n=c;o=u}}}return n?i(o):s};case"rms":return function(e,t){var r=0;var n=0;for(var o=0;o<t.length;o++){var l=a(e[t[o]]);if(l!==s){r+=l*l;n++}}return n?i(Math.sqrt(r/n)):s};case"stddev":return function(t,r){var n=0;var i=0;var o=1;var l=s;var u;for(u=0;u<r.length&&l===s;u++){l=a(t[r[u]])}if(l===s)return s;for(;u<r.length;u++){var c=a(t[r[u]]);if(c!==s){var f=c-l;n+=f;i+=f*f;o++}}var h=e.funcmode==="sample"?o-1:o;if(!h)return 0;return Math.sqrt((i-n*n/o)/h)}}}function h(e,t){return t.length}function p(e,t){return e[t[0]]}function v(e,t){return e[t[t.length-1]]}},{"../constants/numerical":763,"../lib":787,"../plot_api/plot_schema":826,"../plots/cartesian/axes":838,"./helpers":1386}],1384:[function(e,t,r){"use strict";var a=e("../lib");var n=e("../registry");var i=e("../plots/cartesian/axes");var o=e("./helpers").pointsAccessorFunction;var s=e("../constants/filter_ops");var l=s.COMPARISON_OPS;var u=s.INTERVAL_OPS;var c=s.SET_OPS;r.moduleType="transform";r.name="filter";r.attributes={enabled:{valType:"boolean",dflt:true,editType:"calc"},target:{valType:"string",strict:true,noBlank:true,arrayOk:true,dflt:"x",editType:"calc"},operation:{valType:"enumerated",values:[].concat(l).concat(u).concat(c),dflt:"=",editType:"calc"},value:{valType:"any",dflt:0,editType:"calc"},preservegaps:{valType:"boolean",dflt:false,editType:"calc"},editType:"calc"};r.supplyDefaults=function(e){var t={};function i(n,i){return a.coerce(e,t,r.attributes,n,i)}var o=i("enabled");if(o){var s=i("target");if(a.isArrayOrTypedArray(s)&&s.length===0){t.enabled=false;return t}i("preservegaps");i("operation");i("value");var l=n.getComponentMethod("calendars","handleDefaults");l(e,t,"valuecalendar",null);l(e,t,"targetcalendar",null)}return t};r.calcTransform=function(e,t,r){if(!r.enabled)return;var n=a.getTargetArray(t,r);if(!n)return;var s=r.target;var l=n.length;if(t._length)l=Math.min(l,t._length);var u=r.targetcalendar;var c=t._arrayAttrs;var h=r.preservegaps;if(typeof s==="string"){var p=a.nestedProperty(t,s+"calendar").get();if(p)u=p}var v=i.getDataToCoordFunc(e,t,s,n);var d=f(r,v,u);var m={};var g={};var y=0;function x(e,r){for(var n=0;n<c.length;n++){var i=a.nestedProperty(t,c[n]);e(i,r)}}var b;var _;if(h){b=function(e){m[e.astr]=a.extendDeep([],e.get());e.set(new Array(l))};_=function(e,t){var r=m[e.astr][t];e.get()[t]=r}}else{b=function(e){m[e.astr]=a.extendDeep([],e.get());e.set([])};_=function(e,t){var r=m[e.astr][t];e.get().push(r)}}x(b);var w=o(t.transforms,r);for(var T=0;T<l;T++){var k=d(n[T]);if(k){x(_,T);g[y++]=w(T)}else if(h)y++}r._indexToPoints=g;t._length=y};function f(e,t,r){var a=e.operation;var n=e.value;var i=Array.isArray(n);function o(e){return e.indexOf(a)!==-1}var s=function(r){return t(r,0,e.valuecalendar)};var f=function(e){return t(e,0,r)};var h;if(o(l)){h=i?s(n[0]):s(n)}else if(o(u)){h=i?[s(n[0]),s(n[1])]:[s(n),s(n)]}else if(o(c)){h=i?n.map(s):[s(n)]}switch(a){case"=":return function(e){return f(e)===h};case"!=":return function(e){return f(e)!==h};case"<":return function(e){return f(e)<h};case"<=":return function(e){return f(e)<=h};case">":return function(e){return f(e)>h};case">=":return function(e){return f(e)>=h};case"[]":return function(e){var t=f(e);return t>=h[0]&&t<=h[1]};case"()":return function(e){var t=f(e);return t>h[0]&&t<h[1]};case"[)":return function(e){var t=f(e);return t>=h[0]&&t<h[1]};case"(]":return function(e){var t=f(e);return t>h[0]&&t<=h[1]};case"][":return function(e){var t=f(e);return t<=h[0]||t>=h[1]};case")(":return function(e){var t=f(e);return t<h[0]||t>h[1]};case"](":return function(e){var t=f(e);return t<=h[0]||t>h[1]};case")[":return function(e){var t=f(e);return t<h[0]||t>=h[1]};case"{}":return function(e){return h.indexOf(f(e))!==-1};case"}{":return function(e){return h.indexOf(f(e))===-1}}}},{"../constants/filter_ops":759,"../lib":787,"../plots/cartesian/axes":838,"../registry":915,"./helpers":1386}],1385:[function(e,t,r){"use strict";var a=e("../lib");var n=e("../plot_api/plot_schema");var i=e("../plots/plots");var o=e("./helpers").pointsAccessorFunction;r.moduleType="transform";r.name="groupby";r.attributes={enabled:{valType:"boolean",dflt:true,editType:"calc"},groups:{valType:"data_array",dflt:[],editType:"calc"},nameformat:{valType:"string",editType:"calc"},styles:{_isLinkedToArray:"style",target:{valType:"string",editType:"calc"},value:{valType:"any",dflt:{},editType:"calc",_compareAsJSON:true},editType:"calc"},editType:"calc"};r.supplyDefaults=function(e,t,n){var i;var o={};function s(t,n){return a.coerce(e,o,r.attributes,t,n)}var l=s("enabled");if(!l)return o;s("groups");s("nameformat",n._dataLength>1?"%{group} (%{trace})":"%{group}");var u=e.styles;var c=o.styles=[];if(u){for(i=0;i<u.length;i++){var f=c[i]={};a.coerce(u[i],c[i],r.attributes.styles,"target");var h=a.coerce(u[i],c[i],r.attributes.styles,"value");if(a.isPlainObject(h))f.value=a.extendDeep({},h);else if(h)delete f.value}}return o};r.transform=function(e,t){var r,a,n;var i=[];for(a=0;a<e.length;a++){r=s(e[a],t);for(n=0;n<r.length;n++){i.push(r[n])}}return i};function s(e,t){var r,s,l,u,c,f,h,p,v;var d;var m=t.transform;var g=t.transformIndex;var y=e.transforms[g].groups;var x=o(e.transforms,m);if(!a.isArrayOrTypedArray(y)||y.length===0){return[e]}var b=a.filterUnique(y);var _=new Array(b.length);var w=y.length;var T=n.findArrayAttributes(e);var k=m.styles||[];var M={};for(r=0;r<k.length;r++){M[k[r].target]=k[r].value}if(m.styles){d=a.keyedContainer(m,"styles","target","value.name")}var A={};var S={};for(r=0;r<b.length;r++){f=b[r];A[f]=r;S[f]=0;h=_[r]=a.extendDeepNoArrays({},e);h._group=f;h.transforms[g]._indexToPoints={};var E=null;if(d){E=d.get(f)}if(E||E===""){h.name=E}else{h.name=a.templateString(m.nameformat,{trace:e.name,group:f})}p=h.transforms;h.transforms=[];for(s=0;s<p.length;s++){h.transforms[s]=a.extendDeepNoArrays({},p[s])}for(s=0;s<T.length;s++){a.nestedProperty(h,T[s]).set([])}}for(l=0;l<T.length;l++){u=T[l];for(s=0,v=[];s<b.length;s++){v[s]=a.nestedProperty(_[s],u).get()}c=a.nestedProperty(e,u).get();for(s=0;s<w;s++){v[A[y[s]]].push(c[s])}}for(s=0;s<w;s++){h=_[A[y[s]]];var L=h.transforms[g]._indexToPoints;L[S[y[s]]]=x(s);S[y[s]]++}for(r=0;r<b.length;r++){f=b[r];h=_[r];i.clearExpandedTraceDefaultColors(h);h=a.extendDeepNoArrays(h,M[f]||{})}return _}},{"../lib":787,"../plot_api/plot_schema":826,"../plots/plots":901,"./helpers":1386}],1386:[function(e,t,r){"use strict";r.pointsAccessorFunction=function(e,t){var r;var a;for(var n=0;n<e.length;n++){r=e[n];if(r===t)break;if(!r._indexToPoints||r.enabled===false)continue;a=r._indexToPoints}var i=a?function(e){return a[e]}:function(e){return[e]};return i}},{}],1387:[function(e,t,r){"use strict";var a=e("../lib");var n=e("../plots/cartesian/axes");var i=e("./helpers").pointsAccessorFunction;var o=e("../constants/numerical").BADNUM;r.moduleType="transform";r.name="sort";r.attributes={enabled:{valType:"boolean",dflt:true,editType:"calc"},target:{valType:"string",strict:true,noBlank:true,arrayOk:true,dflt:"x",editType:"calc"},order:{valType:"enumerated",values:["ascending","descending"],dflt:"ascending",editType:"calc"},editType:"calc"};r.supplyDefaults=function(e){var t={};function n(n,i){return a.coerce(e,t,r.attributes,n,i)}var i=n("enabled");if(i){n("target");n("order")}return t};r.calcTransform=function(e,t,r){if(!r.enabled)return;var o=a.getTargetArray(t,r);if(!o)return;var l=r.target;var u=o.length;if(t._length)u=Math.min(u,t._length);var c=t._arrayAttrs;var f=n.getDataToCoordFunc(e,t,l,o);var h=s(r,o,f,u);var p=i(t.transforms,r);var v={};var d,m;for(d=0;d<c.length;d++){var g=a.nestedProperty(t,c[d]);var y=g.get();var x=new Array(u);for(m=0;m<u;m++){x[m]=y[h[m]]}g.set(x)}for(m=0;m<u;m++){v[m]=p(h[m])}r._indexToPoints=v;t._length=u};function s(e,t,r,a){var n=new Array(a);var i=new Array(a);var o;for(o=0;o<a;o++){n[o]={v:t[o],i:o}}n.sort(l(e,r));for(o=0;o<a;o++){i[o]=n[o].i}return i}function l(e,t){switch(e.order){case"ascending":return function(e,r){var a=t(e.v);var n=t(r.v);if(a===o){return 1}if(n===o){return-1}return a-n};case"descending":return function(e,r){var a=t(e.v);var n=t(r.v);if(a===o){return 1}if(n===o){return-1}return n-a}}}},{"../constants/numerical":763,"../lib":787,"../plots/cartesian/axes":838,"./helpers":1386}],1388:[function(e,t,r){"use strict";r.version="2.5.1"},{}]},{},[27])(27)}))}).call(this,r("yLpj"))}}]);
//# sourceMappingURL=0.4fcd9331646d87b188d9.js.map